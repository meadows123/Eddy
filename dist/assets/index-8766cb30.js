function AU(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var us=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function SQ(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var NU={exports:{}},HS={},kU={exports:{}},Vr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I0=Symbol.for("react.element"),EQ=Symbol.for("react.portal"),TQ=Symbol.for("react.fragment"),jQ=Symbol.for("react.strict_mode"),CQ=Symbol.for("react.profiler"),PQ=Symbol.for("react.provider"),AQ=Symbol.for("react.context"),NQ=Symbol.for("react.forward_ref"),kQ=Symbol.for("react.suspense"),MQ=Symbol.for("react.memo"),IQ=Symbol.for("react.lazy"),SL=Symbol.iterator;function OQ(e){return e===null||typeof e!="object"?null:(e=SL&&e[SL]||e["@@iterator"],typeof e=="function"?e:null)}var MU={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},IU=Object.assign,OU={};function lg(e,t,r){this.props=e,this.context=t,this.refs=OU,this.updater=r||MU}lg.prototype.isReactComponent={};lg.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};lg.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function RU(){}RU.prototype=lg.prototype;function Tk(e,t,r){this.props=e,this.context=t,this.refs=OU,this.updater=r||MU}var jk=Tk.prototype=new RU;jk.constructor=Tk;IU(jk,lg.prototype);jk.isPureReactComponent=!0;var EL=Array.isArray,DU=Object.prototype.hasOwnProperty,Ck={current:null},LU={key:!0,ref:!0,__self:!0,__source:!0};function BU(e,t,r){var n,i={},o=null,h=null;if(t!=null)for(n in t.ref!==void 0&&(h=t.ref),t.key!==void 0&&(o=""+t.key),t)DU.call(t,n)&&!LU.hasOwnProperty(n)&&(i[n]=t[n]);var s=arguments.length-2;if(s===1)i.children=r;else if(1<s){for(var p=Array(s),y=0;y<s;y++)p[y]=arguments[y+2];i.children=p}if(e&&e.defaultProps)for(n in s=e.defaultProps,s)i[n]===void 0&&(i[n]=s[n]);return{$$typeof:I0,type:e,key:o,ref:h,props:i,_owner:Ck.current}}function RQ(e,t){return{$$typeof:I0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Pk(e){return typeof e=="object"&&e!==null&&e.$$typeof===I0}function DQ(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var TL=/\/+/g;function Ej(e,t){return typeof e=="object"&&e!==null&&e.key!=null?DQ(""+e.key):t.toString(36)}function Mw(e,t,r,n,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var h=!1;if(e===null)h=!0;else switch(o){case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case I0:case EQ:h=!0}}if(h)return h=e,i=i(h),e=n===""?"."+Ej(h,0):n,EL(i)?(r="",e!=null&&(r=e.replace(TL,"$&/")+"/"),Mw(i,t,r,"",function(y){return y})):i!=null&&(Pk(i)&&(i=RQ(i,r+(!i.key||h&&h.key===i.key?"":(""+i.key).replace(TL,"$&/")+"/")+e)),t.push(i)),1;if(h=0,n=n===""?".":n+":",EL(e))for(var s=0;s<e.length;s++){o=e[s];var p=n+Ej(o,s);h+=Mw(o,t,r,p,i)}else if(p=OQ(e),typeof p=="function")for(e=p.call(e),s=0;!(o=e.next()).done;)o=o.value,p=n+Ej(o,s++),h+=Mw(o,t,r,p,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return h}function O_(e,t,r){if(e==null)return e;var n=[],i=0;return Mw(e,n,"","",function(o){return t.call(r,o,i++)}),n}function LQ(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Hs={current:null},Iw={transition:null},BQ={ReactCurrentDispatcher:Hs,ReactCurrentBatchConfig:Iw,ReactCurrentOwner:Ck};function zU(){throw Error("act(...) is not supported in production builds of React.")}Vr.Children={map:O_,forEach:function(e,t,r){O_(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return O_(e,function(){t++}),t},toArray:function(e){return O_(e,function(t){return t})||[]},only:function(e){if(!Pk(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Vr.Component=lg;Vr.Fragment=TQ;Vr.Profiler=CQ;Vr.PureComponent=Tk;Vr.StrictMode=jQ;Vr.Suspense=kQ;Vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BQ;Vr.act=zU;Vr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=IU({},e.props),i=e.key,o=e.ref,h=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,h=Ck.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(p in t)DU.call(t,p)&&!LU.hasOwnProperty(p)&&(n[p]=t[p]===void 0&&s!==void 0?s[p]:t[p])}var p=arguments.length-2;if(p===1)n.children=r;else if(1<p){s=Array(p);for(var y=0;y<p;y++)s[y]=arguments[y+2];n.children=s}return{$$typeof:I0,type:e.type,key:i,ref:o,props:n,_owner:h}};Vr.createContext=function(e){return e={$$typeof:AQ,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:PQ,_context:e},e.Consumer=e};Vr.createElement=BU;Vr.createFactory=function(e){var t=BU.bind(null,e);return t.type=e,t};Vr.createRef=function(){return{current:null}};Vr.forwardRef=function(e){return{$$typeof:NQ,render:e}};Vr.isValidElement=Pk;Vr.lazy=function(e){return{$$typeof:IQ,_payload:{_status:-1,_result:e},_init:LQ}};Vr.memo=function(e,t){return{$$typeof:MQ,type:e,compare:t===void 0?null:t}};Vr.startTransition=function(e){var t=Iw.transition;Iw.transition={};try{e()}finally{Iw.transition=t}};Vr.unstable_act=zU;Vr.useCallback=function(e,t){return Hs.current.useCallback(e,t)};Vr.useContext=function(e){return Hs.current.useContext(e)};Vr.useDebugValue=function(){};Vr.useDeferredValue=function(e){return Hs.current.useDeferredValue(e)};Vr.useEffect=function(e,t){return Hs.current.useEffect(e,t)};Vr.useId=function(){return Hs.current.useId()};Vr.useImperativeHandle=function(e,t,r){return Hs.current.useImperativeHandle(e,t,r)};Vr.useInsertionEffect=function(e,t){return Hs.current.useInsertionEffect(e,t)};Vr.useLayoutEffect=function(e,t){return Hs.current.useLayoutEffect(e,t)};Vr.useMemo=function(e,t){return Hs.current.useMemo(e,t)};Vr.useReducer=function(e,t,r){return Hs.current.useReducer(e,t,r)};Vr.useRef=function(e){return Hs.current.useRef(e)};Vr.useState=function(e){return Hs.current.useState(e)};Vr.useSyncExternalStore=function(e,t,r){return Hs.current.useSyncExternalStore(e,t,r)};Vr.useTransition=function(){return Hs.current.useTransition()};Vr.version="18.3.1";kU.exports=Vr;var I=kU.exports;const je=Sn(I),Ak=AU({__proto__:null,default:je},[I]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zQ=I,$Q=Symbol.for("react.element"),FQ=Symbol.for("react.fragment"),UQ=Object.prototype.hasOwnProperty,VQ=zQ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qQ={key:!0,ref:!0,__self:!0,__source:!0};function $U(e,t,r){var n,i={},o=null,h=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(h=t.ref);for(n in t)UQ.call(t,n)&&!qQ.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:$Q,type:e,key:o,ref:h,props:i,_owner:VQ.current}}HS.Fragment=FQ;HS.jsx=$U;HS.jsxs=$U;NU.exports=HS;var l=NU.exports,uP={},FU={exports:{}},za={},UU={exports:{}},VU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(me,ke){var Ne=me.length;me.push(ke);e:for(;0<Ne;){var Be=Ne-1>>>1,We=me[Be];if(0<i(We,ke))me[Be]=ke,me[Ne]=We,Ne=Be;else break e}}function r(me){return me.length===0?null:me[0]}function n(me){if(me.length===0)return null;var ke=me[0],Ne=me.pop();if(Ne!==ke){me[0]=Ne;e:for(var Be=0,We=me.length,ut=We>>>1;Be<ut;){var nt=2*(Be+1)-1,Pt=me[nt],It=nt+1,at=me[It];if(0>i(Pt,Ne))It<We&&0>i(at,Pt)?(me[Be]=at,me[It]=Ne,Be=It):(me[Be]=Pt,me[nt]=Ne,Be=nt);else if(It<We&&0>i(at,Ne))me[Be]=at,me[It]=Ne,Be=It;else break e}}return ke}function i(me,ke){var Ne=me.sortIndex-ke.sortIndex;return Ne!==0?Ne:me.id-ke.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var h=Date,s=h.now();e.unstable_now=function(){return h.now()-s}}var p=[],y=[],b=1,_=null,E=3,C=!1,k=!1,N=!1,O=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(me){for(var ke=r(y);ke!==null;){if(ke.callback===null)n(y);else if(ke.startTime<=me)n(y),ke.sortIndex=ke.expirationTime,t(p,ke);else break;ke=r(y)}}function q(me){if(N=!1,B(me),!k)if(r(p)!==null)k=!0,be(F);else{var ke=r(y);ke!==null&&Ae(q,ke.startTime-me)}}function F(me,ke){k=!1,N&&(N=!1,R(re),re=-1),C=!0;var Ne=E;try{for(B(ke),_=r(p);_!==null&&(!(_.expirationTime>ke)||me&&!oe());){var Be=_.callback;if(typeof Be=="function"){_.callback=null,E=_.priorityLevel;var We=Be(_.expirationTime<=ke);ke=e.unstable_now(),typeof We=="function"?_.callback=We:_===r(p)&&n(p),B(ke)}else n(p);_=r(p)}if(_!==null)var ut=!0;else{var nt=r(y);nt!==null&&Ae(q,nt.startTime-ke),ut=!1}return ut}finally{_=null,E=Ne,C=!1}}var H=!1,Z=null,re=-1,W=5,te=-1;function oe(){return!(e.unstable_now()-te<W)}function ie(){if(Z!==null){var me=e.unstable_now();te=me;var ke=!0;try{ke=Z(!0,me)}finally{ke?ue():(H=!1,Z=null)}}else H=!1}var ue;if(typeof L=="function")ue=function(){L(ie)};else if(typeof MessageChannel<"u"){var _e=new MessageChannel,xe=_e.port2;_e.port1.onmessage=ie,ue=function(){xe.postMessage(null)}}else ue=function(){O(ie,0)};function be(me){Z=me,H||(H=!0,ue())}function Ae(me,ke){re=O(function(){me(e.unstable_now())},ke)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(me){me.callback=null},e.unstable_continueExecution=function(){k||C||(k=!0,be(F))},e.unstable_forceFrameRate=function(me){0>me||125<me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<me?Math.floor(1e3/me):5},e.unstable_getCurrentPriorityLevel=function(){return E},e.unstable_getFirstCallbackNode=function(){return r(p)},e.unstable_next=function(me){switch(E){case 1:case 2:case 3:var ke=3;break;default:ke=E}var Ne=E;E=ke;try{return me()}finally{E=Ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(me,ke){switch(me){case 1:case 2:case 3:case 4:case 5:break;default:me=3}var Ne=E;E=me;try{return ke()}finally{E=Ne}},e.unstable_scheduleCallback=function(me,ke,Ne){var Be=e.unstable_now();switch(typeof Ne=="object"&&Ne!==null?(Ne=Ne.delay,Ne=typeof Ne=="number"&&0<Ne?Be+Ne:Be):Ne=Be,me){case 1:var We=-1;break;case 2:We=250;break;case 5:We=1073741823;break;case 4:We=1e4;break;default:We=5e3}return We=Ne+We,me={id:b++,callback:ke,priorityLevel:me,startTime:Ne,expirationTime:We,sortIndex:-1},Ne>Be?(me.sortIndex=Ne,t(y,me),r(p)===null&&me===r(y)&&(N?(R(re),re=-1):N=!0,Ae(q,Ne-Be))):(me.sortIndex=We,t(p,me),k||C||(k=!0,be(F))),me},e.unstable_shouldYield=oe,e.unstable_wrapCallback=function(me){var ke=E;return function(){var Ne=E;E=ke;try{return me.apply(this,arguments)}finally{E=Ne}}}})(VU);UU.exports=VU;var WQ=UU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GQ=I,Da=WQ;function Rt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qU=new Set,wx={};function gf(e,t){_m(e,t),_m(e+"Capture",t)}function _m(e,t){for(wx[e]=t,e=0;e<t.length;e++)qU.add(t[e])}var Rc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dP=Object.prototype.hasOwnProperty,HQ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jL={},CL={};function XQ(e){return dP.call(CL,e)?!0:dP.call(jL,e)?!1:HQ.test(e)?CL[e]=!0:(jL[e]=!0,!1)}function KQ(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ZQ(e,t,r,n){if(t===null||typeof t>"u"||KQ(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Xs(e,t,r,n,i,o,h){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=h}var fs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){fs[e]=new Xs(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];fs[t]=new Xs(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){fs[e]=new Xs(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){fs[e]=new Xs(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){fs[e]=new Xs(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){fs[e]=new Xs(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){fs[e]=new Xs(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){fs[e]=new Xs(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){fs[e]=new Xs(e,5,!1,e.toLowerCase(),null,!1,!1)});var Nk=/[\-:]([a-z])/g;function kk(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Nk,kk);fs[t]=new Xs(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Nk,kk);fs[t]=new Xs(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Nk,kk);fs[t]=new Xs(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){fs[e]=new Xs(e,1,!1,e.toLowerCase(),null,!1,!1)});fs.xlinkHref=new Xs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){fs[e]=new Xs(e,1,!1,e.toLowerCase(),null,!0,!0)});function Mk(e,t,r,n){var i=fs.hasOwnProperty(t)?fs[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ZQ(t,r,i,n)&&(r=null),n||i===null?XQ(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Zc=GQ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R_=Symbol.for("react.element"),Vp=Symbol.for("react.portal"),qp=Symbol.for("react.fragment"),Ik=Symbol.for("react.strict_mode"),hP=Symbol.for("react.profiler"),WU=Symbol.for("react.provider"),GU=Symbol.for("react.context"),Ok=Symbol.for("react.forward_ref"),fP=Symbol.for("react.suspense"),pP=Symbol.for("react.suspense_list"),Rk=Symbol.for("react.memo"),Uu=Symbol.for("react.lazy"),HU=Symbol.for("react.offscreen"),PL=Symbol.iterator;function pv(e){return e===null||typeof e!="object"?null:(e=PL&&e[PL]||e["@@iterator"],typeof e=="function"?e:null)}var ci=Object.assign,Tj;function Uv(e){if(Tj===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Tj=t&&t[1]||""}return`
`+Tj+e}var jj=!1;function Cj(e,t){if(!e||jj)return"";jj=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(y){var n=y}Reflect.construct(e,[],t)}else{try{t.call()}catch(y){n=y}e.call(t.prototype)}else{try{throw Error()}catch(y){n=y}e()}}catch(y){if(y&&n&&typeof y.stack=="string"){for(var i=y.stack.split(`
`),o=n.stack.split(`
`),h=i.length-1,s=o.length-1;1<=h&&0<=s&&i[h]!==o[s];)s--;for(;1<=h&&0<=s;h--,s--)if(i[h]!==o[s]){if(h!==1||s!==1)do if(h--,s--,0>s||i[h]!==o[s]){var p=`
`+i[h].replace(" at new "," at ");return e.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",e.displayName)),p}while(1<=h&&0<=s);break}}}finally{jj=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Uv(e):""}function YQ(e){switch(e.tag){case 5:return Uv(e.type);case 16:return Uv("Lazy");case 13:return Uv("Suspense");case 19:return Uv("SuspenseList");case 0:case 2:case 15:return e=Cj(e.type,!1),e;case 11:return e=Cj(e.type.render,!1),e;case 1:return e=Cj(e.type,!0),e;default:return""}}function mP(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case qp:return"Fragment";case Vp:return"Portal";case hP:return"Profiler";case Ik:return"StrictMode";case fP:return"Suspense";case pP:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case GU:return(e.displayName||"Context")+".Consumer";case WU:return(e._context.displayName||"Context")+".Provider";case Ok:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Rk:return t=e.displayName||null,t!==null?t:mP(e.type)||"Memo";case Uu:t=e._payload,e=e._init;try{return mP(e(t))}catch{}}return null}function JQ(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mP(t);case 8:return t===Ik?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function pd(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function XU(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function QQ(e){var t=XU(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(h){n=""+h,o.call(this,h)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(h){n=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function D_(e){e._valueTracker||(e._valueTracker=QQ(e))}function KU(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=XU(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Qw(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function gP(e,t){var r=t.checked;return ci({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function AL(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=pd(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ZU(e,t){t=t.checked,t!=null&&Mk(e,"checked",t,!1)}function yP(e,t){ZU(e,t);var r=pd(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?vP(e,t.type,r):t.hasOwnProperty("defaultValue")&&vP(e,t.type,pd(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function NL(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function vP(e,t,r){(t!=="number"||Qw(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Vv=Array.isArray;function cm(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+pd(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function xP(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Rt(91));return ci({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function kL(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Rt(92));if(Vv(r)){if(1<r.length)throw Error(Rt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:pd(r)}}function YU(e,t){var r=pd(t.value),n=pd(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function ML(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function JU(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bP(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?JU(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var L_,QU=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(L_=L_||document.createElement("div"),L_.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=L_.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Sx(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Yv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eee=["Webkit","ms","Moz","O"];Object.keys(Yv).forEach(function(e){eee.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Yv[t]=Yv[e]})});function e6(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Yv.hasOwnProperty(e)&&Yv[e]?(""+t).trim():t+"px"}function t6(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=e6(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var tee=ci({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _P(e,t){if(t){if(tee[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Rt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Rt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Rt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Rt(62))}}function wP(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var SP=null;function Dk(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var EP=null,um=null,dm=null;function IL(e){if(e=D0(e)){if(typeof EP!="function")throw Error(Rt(280));var t=e.stateNode;t&&(t=JS(t),EP(e.stateNode,e.type,t))}}function r6(e){um?dm?dm.push(e):dm=[e]:um=e}function n6(){if(um){var e=um,t=dm;if(dm=um=null,IL(e),t)for(e=0;e<t.length;e++)IL(t[e])}}function i6(e,t){return e(t)}function s6(){}var Pj=!1;function a6(e,t,r){if(Pj)return e(t,r);Pj=!0;try{return i6(e,t,r)}finally{Pj=!1,(um!==null||dm!==null)&&(s6(),n6())}}function Ex(e,t){var r=e.stateNode;if(r===null)return null;var n=JS(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Rt(231,t,typeof r));return r}var TP=!1;if(Rc)try{var mv={};Object.defineProperty(mv,"passive",{get:function(){TP=!0}}),window.addEventListener("test",mv,mv),window.removeEventListener("test",mv,mv)}catch{TP=!1}function ree(e,t,r,n,i,o,h,s,p){var y=Array.prototype.slice.call(arguments,3);try{t.apply(r,y)}catch(b){this.onError(b)}}var Jv=!1,e1=null,t1=!1,jP=null,nee={onError:function(e){Jv=!0,e1=e}};function iee(e,t,r,n,i,o,h,s,p){Jv=!1,e1=null,ree.apply(nee,arguments)}function see(e,t,r,n,i,o,h,s,p){if(iee.apply(this,arguments),Jv){if(Jv){var y=e1;Jv=!1,e1=null}else throw Error(Rt(198));t1||(t1=!0,jP=y)}}function yf(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function o6(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function OL(e){if(yf(e)!==e)throw Error(Rt(188))}function aee(e){var t=e.alternate;if(!t){if(t=yf(e),t===null)throw Error(Rt(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var o=i.alternate;if(o===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return OL(i),e;if(o===n)return OL(i),t;o=o.sibling}throw Error(Rt(188))}if(r.return!==n.return)r=i,n=o;else{for(var h=!1,s=i.child;s;){if(s===r){h=!0,r=i,n=o;break}if(s===n){h=!0,n=i,r=o;break}s=s.sibling}if(!h){for(s=o.child;s;){if(s===r){h=!0,r=o,n=i;break}if(s===n){h=!0,n=o,r=i;break}s=s.sibling}if(!h)throw Error(Rt(189))}}if(r.alternate!==n)throw Error(Rt(190))}if(r.tag!==3)throw Error(Rt(188));return r.stateNode.current===r?e:t}function l6(e){return e=aee(e),e!==null?c6(e):null}function c6(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=c6(e);if(t!==null)return t;e=e.sibling}return null}var u6=Da.unstable_scheduleCallback,RL=Da.unstable_cancelCallback,oee=Da.unstable_shouldYield,lee=Da.unstable_requestPaint,mi=Da.unstable_now,cee=Da.unstable_getCurrentPriorityLevel,Lk=Da.unstable_ImmediatePriority,d6=Da.unstable_UserBlockingPriority,r1=Da.unstable_NormalPriority,uee=Da.unstable_LowPriority,h6=Da.unstable_IdlePriority,XS=null,Dl=null;function dee(e){if(Dl&&typeof Dl.onCommitFiberRoot=="function")try{Dl.onCommitFiberRoot(XS,e,void 0,(e.current.flags&128)===128)}catch{}}var ol=Math.clz32?Math.clz32:pee,hee=Math.log,fee=Math.LN2;function pee(e){return e>>>=0,e===0?32:31-(hee(e)/fee|0)|0}var B_=64,z_=4194304;function qv(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function n1(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,h=r&268435455;if(h!==0){var s=h&~i;s!==0?n=qv(s):(o&=h,o!==0&&(n=qv(o)))}else h=r&~i,h!==0?n=qv(h):o!==0&&(n=qv(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ol(t),i=1<<r,n|=e[r],t&=~i;return n}function mee(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gee(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var h=31-ol(o),s=1<<h,p=i[h];p===-1?(!(s&r)||s&n)&&(i[h]=mee(s,t)):p<=t&&(e.expiredLanes|=s),o&=~s}}function CP(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function f6(){var e=B_;return B_<<=1,!(B_&4194240)&&(B_=64),e}function Aj(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function O0(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ol(t),e[t]=r}function yee(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-ol(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}function Bk(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ol(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var wn=0;function p6(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var m6,zk,g6,y6,v6,PP=!1,$_=[],td=null,rd=null,nd=null,Tx=new Map,jx=new Map,Hu=[],vee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function DL(e,t){switch(e){case"focusin":case"focusout":td=null;break;case"dragenter":case"dragleave":rd=null;break;case"mouseover":case"mouseout":nd=null;break;case"pointerover":case"pointerout":Tx.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":jx.delete(t.pointerId)}}function gv(e,t,r,n,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},t!==null&&(t=D0(t),t!==null&&zk(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function xee(e,t,r,n,i){switch(t){case"focusin":return td=gv(td,e,t,r,n,i),!0;case"dragenter":return rd=gv(rd,e,t,r,n,i),!0;case"mouseover":return nd=gv(nd,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return Tx.set(o,gv(Tx.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,jx.set(o,gv(jx.get(o)||null,e,t,r,n,i)),!0}return!1}function x6(e){var t=zh(e.target);if(t!==null){var r=yf(t);if(r!==null){if(t=r.tag,t===13){if(t=o6(r),t!==null){e.blockedOn=t,v6(e.priority,function(){g6(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ow(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=AP(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);SP=n,r.target.dispatchEvent(n),SP=null}else return t=D0(r),t!==null&&zk(t),e.blockedOn=r,!1;t.shift()}return!0}function LL(e,t,r){Ow(e)&&r.delete(t)}function bee(){PP=!1,td!==null&&Ow(td)&&(td=null),rd!==null&&Ow(rd)&&(rd=null),nd!==null&&Ow(nd)&&(nd=null),Tx.forEach(LL),jx.forEach(LL)}function yv(e,t){e.blockedOn===t&&(e.blockedOn=null,PP||(PP=!0,Da.unstable_scheduleCallback(Da.unstable_NormalPriority,bee)))}function Cx(e){function t(i){return yv(i,e)}if(0<$_.length){yv($_[0],e);for(var r=1;r<$_.length;r++){var n=$_[r];n.blockedOn===e&&(n.blockedOn=null)}}for(td!==null&&yv(td,e),rd!==null&&yv(rd,e),nd!==null&&yv(nd,e),Tx.forEach(t),jx.forEach(t),r=0;r<Hu.length;r++)n=Hu[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Hu.length&&(r=Hu[0],r.blockedOn===null);)x6(r),r.blockedOn===null&&Hu.shift()}var hm=Zc.ReactCurrentBatchConfig,i1=!0;function _ee(e,t,r,n){var i=wn,o=hm.transition;hm.transition=null;try{wn=1,$k(e,t,r,n)}finally{wn=i,hm.transition=o}}function wee(e,t,r,n){var i=wn,o=hm.transition;hm.transition=null;try{wn=4,$k(e,t,r,n)}finally{wn=i,hm.transition=o}}function $k(e,t,r,n){if(i1){var i=AP(e,t,r,n);if(i===null)zj(e,t,n,s1,r),DL(e,n);else if(xee(i,e,t,r,n))n.stopPropagation();else if(DL(e,n),t&4&&-1<vee.indexOf(e)){for(;i!==null;){var o=D0(i);if(o!==null&&m6(o),o=AP(e,t,r,n),o===null&&zj(e,t,n,s1,r),o===i)break;i=o}i!==null&&n.stopPropagation()}else zj(e,t,n,null,r)}}var s1=null;function AP(e,t,r,n){if(s1=null,e=Dk(n),e=zh(e),e!==null)if(t=yf(e),t===null)e=null;else if(r=t.tag,r===13){if(e=o6(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return s1=e,null}function b6(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cee()){case Lk:return 1;case d6:return 4;case r1:case uee:return 16;case h6:return 536870912;default:return 16}default:return 16}}var Yu=null,Fk=null,Rw=null;function _6(){if(Rw)return Rw;var e,t=Fk,r=t.length,n,i="value"in Yu?Yu.value:Yu.textContent,o=i.length;for(e=0;e<r&&t[e]===i[e];e++);var h=r-e;for(n=1;n<=h&&t[r-n]===i[o-n];n++);return Rw=i.slice(e,1<n?1-n:void 0)}function Dw(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function F_(){return!0}function BL(){return!1}function $a(e){function t(r,n,i,o,h){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=o,this.target=h,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?F_:BL,this.isPropagationStopped=BL,this}return ci(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=F_)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=F_)},persist:function(){},isPersistent:F_}),t}var cg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uk=$a(cg),R0=ci({},cg,{view:0,detail:0}),See=$a(R0),Nj,kj,vv,KS=ci({},R0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vk,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==vv&&(vv&&e.type==="mousemove"?(Nj=e.screenX-vv.screenX,kj=e.screenY-vv.screenY):kj=Nj=0,vv=e),Nj)},movementY:function(e){return"movementY"in e?e.movementY:kj}}),zL=$a(KS),Eee=ci({},KS,{dataTransfer:0}),Tee=$a(Eee),jee=ci({},R0,{relatedTarget:0}),Mj=$a(jee),Cee=ci({},cg,{animationName:0,elapsedTime:0,pseudoElement:0}),Pee=$a(Cee),Aee=ci({},cg,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Nee=$a(Aee),kee=ci({},cg,{data:0}),$L=$a(kee),Mee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Iee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Oee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ree(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Oee[e])?!!t[e]:!1}function Vk(){return Ree}var Dee=ci({},R0,{key:function(e){if(e.key){var t=Mee[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Dw(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Iee[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vk,charCode:function(e){return e.type==="keypress"?Dw(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Dw(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Lee=$a(Dee),Bee=ci({},KS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),FL=$a(Bee),zee=ci({},R0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vk}),$ee=$a(zee),Fee=ci({},cg,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uee=$a(Fee),Vee=ci({},KS,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qee=$a(Vee),Wee=[9,13,27,32],qk=Rc&&"CompositionEvent"in window,Qv=null;Rc&&"documentMode"in document&&(Qv=document.documentMode);var Gee=Rc&&"TextEvent"in window&&!Qv,w6=Rc&&(!qk||Qv&&8<Qv&&11>=Qv),UL=String.fromCharCode(32),VL=!1;function S6(e,t){switch(e){case"keyup":return Wee.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function E6(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Wp=!1;function Hee(e,t){switch(e){case"compositionend":return E6(t);case"keypress":return t.which!==32?null:(VL=!0,UL);case"textInput":return e=t.data,e===UL&&VL?null:e;default:return null}}function Xee(e,t){if(Wp)return e==="compositionend"||!qk&&S6(e,t)?(e=_6(),Rw=Fk=Yu=null,Wp=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return w6&&t.locale!=="ko"?null:t.data;default:return null}}var Kee={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qL(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Kee[e.type]:t==="textarea"}function T6(e,t,r,n){r6(n),t=a1(t,"onChange"),0<t.length&&(r=new Uk("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ex=null,Px=null;function Zee(e){D6(e,0)}function ZS(e){var t=Xp(e);if(KU(t))return e}function Yee(e,t){if(e==="change")return t}var j6=!1;if(Rc){var Ij;if(Rc){var Oj="oninput"in document;if(!Oj){var WL=document.createElement("div");WL.setAttribute("oninput","return;"),Oj=typeof WL.oninput=="function"}Ij=Oj}else Ij=!1;j6=Ij&&(!document.documentMode||9<document.documentMode)}function GL(){ex&&(ex.detachEvent("onpropertychange",C6),Px=ex=null)}function C6(e){if(e.propertyName==="value"&&ZS(Px)){var t=[];T6(t,Px,e,Dk(e)),a6(Zee,t)}}function Jee(e,t,r){e==="focusin"?(GL(),ex=t,Px=r,ex.attachEvent("onpropertychange",C6)):e==="focusout"&&GL()}function Qee(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ZS(Px)}function ete(e,t){if(e==="click")return ZS(t)}function tte(e,t){if(e==="input"||e==="change")return ZS(t)}function rte(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ul=typeof Object.is=="function"?Object.is:rte;function Ax(e,t){if(ul(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!dP.call(t,i)||!ul(e[i],t[i]))return!1}return!0}function HL(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function XL(e,t){var r=HL(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=HL(r)}}function P6(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?P6(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function A6(){for(var e=window,t=Qw();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Qw(e.document)}return t}function Wk(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function nte(e){var t=A6(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&P6(r.ownerDocument.documentElement,r)){if(n!==null&&Wk(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=n.end===void 0?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=XL(r,o);var h=XL(r,n);i&&h&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==h.node||e.focusOffset!==h.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(h.node,h.offset)):(t.setEnd(h.node,h.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ite=Rc&&"documentMode"in document&&11>=document.documentMode,Gp=null,NP=null,tx=null,kP=!1;function KL(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;kP||Gp==null||Gp!==Qw(n)||(n=Gp,"selectionStart"in n&&Wk(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),tx&&Ax(tx,n)||(tx=n,n=a1(NP,"onSelect"),0<n.length&&(t=new Uk("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Gp)))}function U_(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Hp={animationend:U_("Animation","AnimationEnd"),animationiteration:U_("Animation","AnimationIteration"),animationstart:U_("Animation","AnimationStart"),transitionend:U_("Transition","TransitionEnd")},Rj={},N6={};Rc&&(N6=document.createElement("div").style,"AnimationEvent"in window||(delete Hp.animationend.animation,delete Hp.animationiteration.animation,delete Hp.animationstart.animation),"TransitionEvent"in window||delete Hp.transitionend.transition);function YS(e){if(Rj[e])return Rj[e];if(!Hp[e])return e;var t=Hp[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in N6)return Rj[e]=t[r];return e}var k6=YS("animationend"),M6=YS("animationiteration"),I6=YS("animationstart"),O6=YS("transitionend"),R6=new Map,ZL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sd(e,t){R6.set(e,t),gf(t,[e])}for(var Dj=0;Dj<ZL.length;Dj++){var Lj=ZL[Dj],ste=Lj.toLowerCase(),ate=Lj[0].toUpperCase()+Lj.slice(1);Sd(ste,"on"+ate)}Sd(k6,"onAnimationEnd");Sd(M6,"onAnimationIteration");Sd(I6,"onAnimationStart");Sd("dblclick","onDoubleClick");Sd("focusin","onFocus");Sd("focusout","onBlur");Sd(O6,"onTransitionEnd");_m("onMouseEnter",["mouseout","mouseover"]);_m("onMouseLeave",["mouseout","mouseover"]);_m("onPointerEnter",["pointerout","pointerover"]);_m("onPointerLeave",["pointerout","pointerover"]);gf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gf("onBeforeInput",["compositionend","keypress","textInput","paste"]);gf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ote=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wv));function YL(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,see(n,t,void 0,e),e.currentTarget=null}function D6(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var h=n.length-1;0<=h;h--){var s=n[h],p=s.instance,y=s.currentTarget;if(s=s.listener,p!==o&&i.isPropagationStopped())break e;YL(i,s,y),o=p}else for(h=0;h<n.length;h++){if(s=n[h],p=s.instance,y=s.currentTarget,s=s.listener,p!==o&&i.isPropagationStopped())break e;YL(i,s,y),o=p}}}if(t1)throw e=jP,t1=!1,jP=null,e}function Un(e,t){var r=t[DP];r===void 0&&(r=t[DP]=new Set);var n=e+"__bubble";r.has(n)||(L6(t,e,2,!1),r.add(n))}function Bj(e,t,r){var n=0;t&&(n|=4),L6(r,e,n,t)}var V_="_reactListening"+Math.random().toString(36).slice(2);function Nx(e){if(!e[V_]){e[V_]=!0,qU.forEach(function(r){r!=="selectionchange"&&(ote.has(r)||Bj(r,!1,e),Bj(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[V_]||(t[V_]=!0,Bj("selectionchange",!1,t))}}function L6(e,t,r,n){switch(b6(t)){case 1:var i=_ee;break;case 4:i=wee;break;default:i=$k}r=i.bind(null,t,r,e),i=void 0,!TP||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function zj(e,t,r,n,i){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var h=n.tag;if(h===3||h===4){var s=n.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(h===4)for(h=n.return;h!==null;){var p=h.tag;if((p===3||p===4)&&(p=h.stateNode.containerInfo,p===i||p.nodeType===8&&p.parentNode===i))return;h=h.return}for(;s!==null;){if(h=zh(s),h===null)return;if(p=h.tag,p===5||p===6){n=o=h;continue e}s=s.parentNode}}n=n.return}a6(function(){var y=o,b=Dk(r),_=[];e:{var E=R6.get(e);if(E!==void 0){var C=Uk,k=e;switch(e){case"keypress":if(Dw(r)===0)break e;case"keydown":case"keyup":C=Lee;break;case"focusin":k="focus",C=Mj;break;case"focusout":k="blur",C=Mj;break;case"beforeblur":case"afterblur":C=Mj;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=zL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Tee;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=$ee;break;case k6:case M6:case I6:C=Pee;break;case O6:C=Uee;break;case"scroll":C=See;break;case"wheel":C=qee;break;case"copy":case"cut":case"paste":C=Nee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=FL}var N=(t&4)!==0,O=!N&&e==="scroll",R=N?E!==null?E+"Capture":null:E;N=[];for(var L=y,B;L!==null;){B=L;var q=B.stateNode;if(B.tag===5&&q!==null&&(B=q,R!==null&&(q=Ex(L,R),q!=null&&N.push(kx(L,q,B)))),O)break;L=L.return}0<N.length&&(E=new C(E,k,null,r,b),_.push({event:E,listeners:N}))}}if(!(t&7)){e:{if(E=e==="mouseover"||e==="pointerover",C=e==="mouseout"||e==="pointerout",E&&r!==SP&&(k=r.relatedTarget||r.fromElement)&&(zh(k)||k[Dc]))break e;if((C||E)&&(E=b.window===b?b:(E=b.ownerDocument)?E.defaultView||E.parentWindow:window,C?(k=r.relatedTarget||r.toElement,C=y,k=k?zh(k):null,k!==null&&(O=yf(k),k!==O||k.tag!==5&&k.tag!==6)&&(k=null)):(C=null,k=y),C!==k)){if(N=zL,q="onMouseLeave",R="onMouseEnter",L="mouse",(e==="pointerout"||e==="pointerover")&&(N=FL,q="onPointerLeave",R="onPointerEnter",L="pointer"),O=C==null?E:Xp(C),B=k==null?E:Xp(k),E=new N(q,L+"leave",C,r,b),E.target=O,E.relatedTarget=B,q=null,zh(b)===y&&(N=new N(R,L+"enter",k,r,b),N.target=B,N.relatedTarget=O,q=N),O=q,C&&k)t:{for(N=C,R=k,L=0,B=N;B;B=Pp(B))L++;for(B=0,q=R;q;q=Pp(q))B++;for(;0<L-B;)N=Pp(N),L--;for(;0<B-L;)R=Pp(R),B--;for(;L--;){if(N===R||R!==null&&N===R.alternate)break t;N=Pp(N),R=Pp(R)}N=null}else N=null;C!==null&&JL(_,E,C,N,!1),k!==null&&O!==null&&JL(_,O,k,N,!0)}}e:{if(E=y?Xp(y):window,C=E.nodeName&&E.nodeName.toLowerCase(),C==="select"||C==="input"&&E.type==="file")var F=Yee;else if(qL(E))if(j6)F=tte;else{F=Qee;var H=Jee}else(C=E.nodeName)&&C.toLowerCase()==="input"&&(E.type==="checkbox"||E.type==="radio")&&(F=ete);if(F&&(F=F(e,y))){T6(_,F,r,b);break e}H&&H(e,E,y),e==="focusout"&&(H=E._wrapperState)&&H.controlled&&E.type==="number"&&vP(E,"number",E.value)}switch(H=y?Xp(y):window,e){case"focusin":(qL(H)||H.contentEditable==="true")&&(Gp=H,NP=y,tx=null);break;case"focusout":tx=NP=Gp=null;break;case"mousedown":kP=!0;break;case"contextmenu":case"mouseup":case"dragend":kP=!1,KL(_,r,b);break;case"selectionchange":if(ite)break;case"keydown":case"keyup":KL(_,r,b)}var Z;if(qk)e:{switch(e){case"compositionstart":var re="onCompositionStart";break e;case"compositionend":re="onCompositionEnd";break e;case"compositionupdate":re="onCompositionUpdate";break e}re=void 0}else Wp?S6(e,r)&&(re="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(re="onCompositionStart");re&&(w6&&r.locale!=="ko"&&(Wp||re!=="onCompositionStart"?re==="onCompositionEnd"&&Wp&&(Z=_6()):(Yu=b,Fk="value"in Yu?Yu.value:Yu.textContent,Wp=!0)),H=a1(y,re),0<H.length&&(re=new $L(re,e,null,r,b),_.push({event:re,listeners:H}),Z?re.data=Z:(Z=E6(r),Z!==null&&(re.data=Z)))),(Z=Gee?Hee(e,r):Xee(e,r))&&(y=a1(y,"onBeforeInput"),0<y.length&&(b=new $L("onBeforeInput","beforeinput",null,r,b),_.push({event:b,listeners:y}),b.data=Z))}D6(_,t)})}function kx(e,t,r){return{instance:e,listener:t,currentTarget:r}}function a1(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Ex(e,r),o!=null&&n.unshift(kx(e,o,i)),o=Ex(e,t),o!=null&&n.push(kx(e,o,i))),e=e.return}return n}function Pp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function JL(e,t,r,n,i){for(var o=t._reactName,h=[];r!==null&&r!==n;){var s=r,p=s.alternate,y=s.stateNode;if(p!==null&&p===n)break;s.tag===5&&y!==null&&(s=y,i?(p=Ex(r,o),p!=null&&h.unshift(kx(r,p,s))):i||(p=Ex(r,o),p!=null&&h.push(kx(r,p,s)))),r=r.return}h.length!==0&&e.push({event:t,listeners:h})}var lte=/\r\n?/g,cte=/\u0000|\uFFFD/g;function QL(e){return(typeof e=="string"?e:""+e).replace(lte,`
`).replace(cte,"")}function q_(e,t,r){if(t=QL(t),QL(e)!==t&&r)throw Error(Rt(425))}function o1(){}var MP=null,IP=null;function OP(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var RP=typeof setTimeout=="function"?setTimeout:void 0,ute=typeof clearTimeout=="function"?clearTimeout:void 0,e3=typeof Promise=="function"?Promise:void 0,dte=typeof queueMicrotask=="function"?queueMicrotask:typeof e3<"u"?function(e){return e3.resolve(null).then(e).catch(hte)}:RP;function hte(e){setTimeout(function(){throw e})}function $j(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Cx(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Cx(t)}function id(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function t3(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ug=Math.random().toString(36).slice(2),Ml="__reactFiber$"+ug,Mx="__reactProps$"+ug,Dc="__reactContainer$"+ug,DP="__reactEvents$"+ug,fte="__reactListeners$"+ug,pte="__reactHandles$"+ug;function zh(e){var t=e[Ml];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Dc]||r[Ml]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=t3(e);e!==null;){if(r=e[Ml])return r;e=t3(e)}return t}e=r,r=e.parentNode}return null}function D0(e){return e=e[Ml]||e[Dc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Xp(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Rt(33))}function JS(e){return e[Mx]||null}var LP=[],Kp=-1;function Ed(e){return{current:e}}function Wn(e){0>Kp||(e.current=LP[Kp],LP[Kp]=null,Kp--)}function Bn(e,t){Kp++,LP[Kp]=e.current,e.current=t}var md={},Ms=Ed(md),da=Ed(!1),ef=md;function wm(e,t){var r=e.type.contextTypes;if(!r)return md;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in r)i[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function ha(e){return e=e.childContextTypes,e!=null}function l1(){Wn(da),Wn(Ms)}function r3(e,t,r){if(Ms.current!==md)throw Error(Rt(168));Bn(Ms,t),Bn(da,r)}function B6(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Rt(108,JQ(e)||"Unknown",i));return ci({},r,n)}function c1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||md,ef=Ms.current,Bn(Ms,e),Bn(da,da.current),!0}function n3(e,t,r){var n=e.stateNode;if(!n)throw Error(Rt(169));r?(e=B6(e,t,ef),n.__reactInternalMemoizedMergedChildContext=e,Wn(da),Wn(Ms),Bn(Ms,e)):Wn(da),Bn(da,r)}var xc=null,QS=!1,Fj=!1;function z6(e){xc===null?xc=[e]:xc.push(e)}function mte(e){QS=!0,z6(e)}function Td(){if(!Fj&&xc!==null){Fj=!0;var e=0,t=wn;try{var r=xc;for(wn=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}xc=null,QS=!1}catch(i){throw xc!==null&&(xc=xc.slice(e+1)),u6(Lk,Td),i}finally{wn=t,Fj=!1}}return null}var Zp=[],Yp=0,u1=null,d1=0,so=[],ao=0,tf=null,_c=1,wc="";function Ph(e,t){Zp[Yp++]=d1,Zp[Yp++]=u1,u1=e,d1=t}function $6(e,t,r){so[ao++]=_c,so[ao++]=wc,so[ao++]=tf,tf=e;var n=_c;e=wc;var i=32-ol(n)-1;n&=~(1<<i),r+=1;var o=32-ol(t)+i;if(30<o){var h=i-i%5;o=(n&(1<<h)-1).toString(32),n>>=h,i-=h,_c=1<<32-ol(t)+i|r<<i|n,wc=o+e}else _c=1<<o|r<<i|n,wc=e}function Gk(e){e.return!==null&&(Ph(e,1),$6(e,1,0))}function Hk(e){for(;e===u1;)u1=Zp[--Yp],Zp[Yp]=null,d1=Zp[--Yp],Zp[Yp]=null;for(;e===tf;)tf=so[--ao],so[ao]=null,wc=so[--ao],so[ao]=null,_c=so[--ao],so[ao]=null}var Oa=null,Ia=null,Xn=!1,el=null;function F6(e,t){var r=co(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function i3(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Oa=e,Ia=id(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Oa=e,Ia=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=tf!==null?{id:_c,overflow:wc}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=co(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Oa=e,Ia=null,!0):!1;default:return!1}}function BP(e){return(e.mode&1)!==0&&(e.flags&128)===0}function zP(e){if(Xn){var t=Ia;if(t){var r=t;if(!i3(e,t)){if(BP(e))throw Error(Rt(418));t=id(r.nextSibling);var n=Oa;t&&i3(e,t)?F6(n,r):(e.flags=e.flags&-4097|2,Xn=!1,Oa=e)}}else{if(BP(e))throw Error(Rt(418));e.flags=e.flags&-4097|2,Xn=!1,Oa=e}}}function s3(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Oa=e}function W_(e){if(e!==Oa)return!1;if(!Xn)return s3(e),Xn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!OP(e.type,e.memoizedProps)),t&&(t=Ia)){if(BP(e))throw U6(),Error(Rt(418));for(;t;)F6(e,t),t=id(t.nextSibling)}if(s3(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Rt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ia=id(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ia=null}}else Ia=Oa?id(e.stateNode.nextSibling):null;return!0}function U6(){for(var e=Ia;e;)e=id(e.nextSibling)}function Sm(){Ia=Oa=null,Xn=!1}function Xk(e){el===null?el=[e]:el.push(e)}var gte=Zc.ReactCurrentBatchConfig;function xv(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Rt(309));var n=r.stateNode}if(!n)throw Error(Rt(147,e));var i=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(h){var s=i.refs;h===null?delete s[o]:s[o]=h},t._stringRef=o,t)}if(typeof e!="string")throw Error(Rt(284));if(!r._owner)throw Error(Rt(290,e))}return e}function G_(e,t){throw e=Object.prototype.toString.call(t),Error(Rt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function a3(e){var t=e._init;return t(e._payload)}function V6(e){function t(R,L){if(e){var B=R.deletions;B===null?(R.deletions=[L],R.flags|=16):B.push(L)}}function r(R,L){if(!e)return null;for(;L!==null;)t(R,L),L=L.sibling;return null}function n(R,L){for(R=new Map;L!==null;)L.key!==null?R.set(L.key,L):R.set(L.index,L),L=L.sibling;return R}function i(R,L){return R=ld(R,L),R.index=0,R.sibling=null,R}function o(R,L,B){return R.index=B,e?(B=R.alternate,B!==null?(B=B.index,B<L?(R.flags|=2,L):B):(R.flags|=2,L)):(R.flags|=1048576,L)}function h(R){return e&&R.alternate===null&&(R.flags|=2),R}function s(R,L,B,q){return L===null||L.tag!==6?(L=Xj(B,R.mode,q),L.return=R,L):(L=i(L,B),L.return=R,L)}function p(R,L,B,q){var F=B.type;return F===qp?b(R,L,B.props.children,q,B.key):L!==null&&(L.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Uu&&a3(F)===L.type)?(q=i(L,B.props),q.ref=xv(R,L,B),q.return=R,q):(q=Vw(B.type,B.key,B.props,null,R.mode,q),q.ref=xv(R,L,B),q.return=R,q)}function y(R,L,B,q){return L===null||L.tag!==4||L.stateNode.containerInfo!==B.containerInfo||L.stateNode.implementation!==B.implementation?(L=Kj(B,R.mode,q),L.return=R,L):(L=i(L,B.children||[]),L.return=R,L)}function b(R,L,B,q,F){return L===null||L.tag!==7?(L=Kh(B,R.mode,q,F),L.return=R,L):(L=i(L,B),L.return=R,L)}function _(R,L,B){if(typeof L=="string"&&L!==""||typeof L=="number")return L=Xj(""+L,R.mode,B),L.return=R,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case R_:return B=Vw(L.type,L.key,L.props,null,R.mode,B),B.ref=xv(R,null,L),B.return=R,B;case Vp:return L=Kj(L,R.mode,B),L.return=R,L;case Uu:var q=L._init;return _(R,q(L._payload),B)}if(Vv(L)||pv(L))return L=Kh(L,R.mode,B,null),L.return=R,L;G_(R,L)}return null}function E(R,L,B,q){var F=L!==null?L.key:null;if(typeof B=="string"&&B!==""||typeof B=="number")return F!==null?null:s(R,L,""+B,q);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case R_:return B.key===F?p(R,L,B,q):null;case Vp:return B.key===F?y(R,L,B,q):null;case Uu:return F=B._init,E(R,L,F(B._payload),q)}if(Vv(B)||pv(B))return F!==null?null:b(R,L,B,q,null);G_(R,B)}return null}function C(R,L,B,q,F){if(typeof q=="string"&&q!==""||typeof q=="number")return R=R.get(B)||null,s(L,R,""+q,F);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case R_:return R=R.get(q.key===null?B:q.key)||null,p(L,R,q,F);case Vp:return R=R.get(q.key===null?B:q.key)||null,y(L,R,q,F);case Uu:var H=q._init;return C(R,L,B,H(q._payload),F)}if(Vv(q)||pv(q))return R=R.get(B)||null,b(L,R,q,F,null);G_(L,q)}return null}function k(R,L,B,q){for(var F=null,H=null,Z=L,re=L=0,W=null;Z!==null&&re<B.length;re++){Z.index>re?(W=Z,Z=null):W=Z.sibling;var te=E(R,Z,B[re],q);if(te===null){Z===null&&(Z=W);break}e&&Z&&te.alternate===null&&t(R,Z),L=o(te,L,re),H===null?F=te:H.sibling=te,H=te,Z=W}if(re===B.length)return r(R,Z),Xn&&Ph(R,re),F;if(Z===null){for(;re<B.length;re++)Z=_(R,B[re],q),Z!==null&&(L=o(Z,L,re),H===null?F=Z:H.sibling=Z,H=Z);return Xn&&Ph(R,re),F}for(Z=n(R,Z);re<B.length;re++)W=C(Z,R,re,B[re],q),W!==null&&(e&&W.alternate!==null&&Z.delete(W.key===null?re:W.key),L=o(W,L,re),H===null?F=W:H.sibling=W,H=W);return e&&Z.forEach(function(oe){return t(R,oe)}),Xn&&Ph(R,re),F}function N(R,L,B,q){var F=pv(B);if(typeof F!="function")throw Error(Rt(150));if(B=F.call(B),B==null)throw Error(Rt(151));for(var H=F=null,Z=L,re=L=0,W=null,te=B.next();Z!==null&&!te.done;re++,te=B.next()){Z.index>re?(W=Z,Z=null):W=Z.sibling;var oe=E(R,Z,te.value,q);if(oe===null){Z===null&&(Z=W);break}e&&Z&&oe.alternate===null&&t(R,Z),L=o(oe,L,re),H===null?F=oe:H.sibling=oe,H=oe,Z=W}if(te.done)return r(R,Z),Xn&&Ph(R,re),F;if(Z===null){for(;!te.done;re++,te=B.next())te=_(R,te.value,q),te!==null&&(L=o(te,L,re),H===null?F=te:H.sibling=te,H=te);return Xn&&Ph(R,re),F}for(Z=n(R,Z);!te.done;re++,te=B.next())te=C(Z,R,re,te.value,q),te!==null&&(e&&te.alternate!==null&&Z.delete(te.key===null?re:te.key),L=o(te,L,re),H===null?F=te:H.sibling=te,H=te);return e&&Z.forEach(function(ie){return t(R,ie)}),Xn&&Ph(R,re),F}function O(R,L,B,q){if(typeof B=="object"&&B!==null&&B.type===qp&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case R_:e:{for(var F=B.key,H=L;H!==null;){if(H.key===F){if(F=B.type,F===qp){if(H.tag===7){r(R,H.sibling),L=i(H,B.props.children),L.return=R,R=L;break e}}else if(H.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Uu&&a3(F)===H.type){r(R,H.sibling),L=i(H,B.props),L.ref=xv(R,H,B),L.return=R,R=L;break e}r(R,H);break}else t(R,H);H=H.sibling}B.type===qp?(L=Kh(B.props.children,R.mode,q,B.key),L.return=R,R=L):(q=Vw(B.type,B.key,B.props,null,R.mode,q),q.ref=xv(R,L,B),q.return=R,R=q)}return h(R);case Vp:e:{for(H=B.key;L!==null;){if(L.key===H)if(L.tag===4&&L.stateNode.containerInfo===B.containerInfo&&L.stateNode.implementation===B.implementation){r(R,L.sibling),L=i(L,B.children||[]),L.return=R,R=L;break e}else{r(R,L);break}else t(R,L);L=L.sibling}L=Kj(B,R.mode,q),L.return=R,R=L}return h(R);case Uu:return H=B._init,O(R,L,H(B._payload),q)}if(Vv(B))return k(R,L,B,q);if(pv(B))return N(R,L,B,q);G_(R,B)}return typeof B=="string"&&B!==""||typeof B=="number"?(B=""+B,L!==null&&L.tag===6?(r(R,L.sibling),L=i(L,B),L.return=R,R=L):(r(R,L),L=Xj(B,R.mode,q),L.return=R,R=L),h(R)):r(R,L)}return O}var Em=V6(!0),q6=V6(!1),h1=Ed(null),f1=null,Jp=null,Kk=null;function Zk(){Kk=Jp=f1=null}function Yk(e){var t=h1.current;Wn(h1),e._currentValue=t}function $P(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function fm(e,t){f1=e,Kk=Jp=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ca=!0),e.firstContext=null)}function go(e){var t=e._currentValue;if(Kk!==e)if(e={context:e,memoizedValue:t,next:null},Jp===null){if(f1===null)throw Error(Rt(308));Jp=e,f1.dependencies={lanes:0,firstContext:e}}else Jp=Jp.next=e;return t}var $h=null;function Jk(e){$h===null?$h=[e]:$h.push(e)}function W6(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,Jk(t)):(r.next=i.next,i.next=r),t.interleaved=r,Lc(e,n)}function Lc(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Vu=!1;function Qk(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function G6(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function sd(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,en&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Lc(e,r)}return i=n.interleaved,i===null?(t.next=t,Jk(n)):(t.next=i.next,i.next=t),n.interleaved=t,Lc(e,r)}function Lw(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Bk(e,r)}}function o3(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var h={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?i=o=h:o=o.next=h,r=r.next}while(r!==null);o===null?i=o=t:o=o.next=t}else i=o=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function p1(e,t,r,n){var i=e.updateQueue;Vu=!1;var o=i.firstBaseUpdate,h=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var p=s,y=p.next;p.next=null,h===null?o=y:h.next=y,h=p;var b=e.alternate;b!==null&&(b=b.updateQueue,s=b.lastBaseUpdate,s!==h&&(s===null?b.firstBaseUpdate=y:s.next=y,b.lastBaseUpdate=p))}if(o!==null){var _=i.baseState;h=0,b=y=p=null,s=o;do{var E=s.lane,C=s.eventTime;if((n&E)===E){b!==null&&(b=b.next={eventTime:C,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var k=e,N=s;switch(E=t,C=r,N.tag){case 1:if(k=N.payload,typeof k=="function"){_=k.call(C,_,E);break e}_=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=N.payload,E=typeof k=="function"?k.call(C,_,E):k,E==null)break e;_=ci({},_,E);break e;case 2:Vu=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,E=i.effects,E===null?i.effects=[s]:E.push(s))}else C={eventTime:C,lane:E,tag:s.tag,payload:s.payload,callback:s.callback,next:null},b===null?(y=b=C,p=_):b=b.next=C,h|=E;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;E=s,s=E.next,E.next=null,i.lastBaseUpdate=E,i.shared.pending=null}}while(1);if(b===null&&(p=_),i.baseState=p,i.firstBaseUpdate=y,i.lastBaseUpdate=b,t=i.shared.interleaved,t!==null){i=t;do h|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);nf|=h,e.lanes=h,e.memoizedState=_}}function l3(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Rt(191,i));i.call(n)}}}var L0={},Ll=Ed(L0),Ix=Ed(L0),Ox=Ed(L0);function Fh(e){if(e===L0)throw Error(Rt(174));return e}function eM(e,t){switch(Bn(Ox,t),Bn(Ix,e),Bn(Ll,L0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:bP(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=bP(t,e)}Wn(Ll),Bn(Ll,t)}function Tm(){Wn(Ll),Wn(Ix),Wn(Ox)}function H6(e){Fh(Ox.current);var t=Fh(Ll.current),r=bP(t,e.type);t!==r&&(Bn(Ix,e),Bn(Ll,r))}function tM(e){Ix.current===e&&(Wn(Ll),Wn(Ix))}var ai=Ed(0);function m1(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Uj=[];function rM(){for(var e=0;e<Uj.length;e++)Uj[e]._workInProgressVersionPrimary=null;Uj.length=0}var Bw=Zc.ReactCurrentDispatcher,Vj=Zc.ReactCurrentBatchConfig,rf=0,li=null,zi=null,Qi=null,g1=!1,rx=!1,Rx=0,yte=0;function Es(){throw Error(Rt(321))}function nM(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ul(e[r],t[r]))return!1;return!0}function iM(e,t,r,n,i,o){if(rf=o,li=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Bw.current=e===null||e.memoizedState===null?_te:wte,e=r(n,i),rx){o=0;do{if(rx=!1,Rx=0,25<=o)throw Error(Rt(301));o+=1,Qi=zi=null,t.updateQueue=null,Bw.current=Ste,e=r(n,i)}while(rx)}if(Bw.current=y1,t=zi!==null&&zi.next!==null,rf=0,Qi=zi=li=null,g1=!1,t)throw Error(Rt(300));return e}function sM(){var e=Rx!==0;return Rx=0,e}function Nl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qi===null?li.memoizedState=Qi=e:Qi=Qi.next=e,Qi}function yo(){if(zi===null){var e=li.alternate;e=e!==null?e.memoizedState:null}else e=zi.next;var t=Qi===null?li.memoizedState:Qi.next;if(t!==null)Qi=t,zi=e;else{if(e===null)throw Error(Rt(310));zi=e,e={memoizedState:zi.memoizedState,baseState:zi.baseState,baseQueue:zi.baseQueue,queue:zi.queue,next:null},Qi===null?li.memoizedState=Qi=e:Qi=Qi.next=e}return Qi}function Dx(e,t){return typeof t=="function"?t(e):t}function qj(e){var t=yo(),r=t.queue;if(r===null)throw Error(Rt(311));r.lastRenderedReducer=e;var n=zi,i=n.baseQueue,o=r.pending;if(o!==null){if(i!==null){var h=i.next;i.next=o.next,o.next=h}n.baseQueue=i=o,r.pending=null}if(i!==null){o=i.next,n=n.baseState;var s=h=null,p=null,y=o;do{var b=y.lane;if((rf&b)===b)p!==null&&(p=p.next={lane:0,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null}),n=y.hasEagerState?y.eagerState:e(n,y.action);else{var _={lane:b,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null};p===null?(s=p=_,h=n):p=p.next=_,li.lanes|=b,nf|=b}y=y.next}while(y!==null&&y!==o);p===null?h=n:p.next=s,ul(n,t.memoizedState)||(ca=!0),t.memoizedState=n,t.baseState=h,t.baseQueue=p,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do o=i.lane,li.lanes|=o,nf|=o,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Wj(e){var t=yo(),r=t.queue;if(r===null)throw Error(Rt(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,o=t.memoizedState;if(i!==null){r.pending=null;var h=i=i.next;do o=e(o,h.action),h=h.next;while(h!==i);ul(o,t.memoizedState)||(ca=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function X6(){}function K6(e,t){var r=li,n=yo(),i=t(),o=!ul(n.memoizedState,i);if(o&&(n.memoizedState=i,ca=!0),n=n.queue,aM(J6.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||Qi!==null&&Qi.memoizedState.tag&1){if(r.flags|=2048,Lx(9,Y6.bind(null,r,n,i,t),void 0,null),es===null)throw Error(Rt(349));rf&30||Z6(r,t,i)}return i}function Z6(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=li.updateQueue,t===null?(t={lastEffect:null,stores:null},li.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Y6(e,t,r,n){t.value=r,t.getSnapshot=n,Q6(t)&&eV(e)}function J6(e,t,r){return r(function(){Q6(t)&&eV(e)})}function Q6(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ul(e,r)}catch{return!0}}function eV(e){var t=Lc(e,1);t!==null&&ll(t,e,1,-1)}function c3(e){var t=Nl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dx,lastRenderedState:e},t.queue=e,e=e.dispatch=bte.bind(null,li,e),[t.memoizedState,e]}function Lx(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=li.updateQueue,t===null?(t={lastEffect:null,stores:null},li.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function tV(){return yo().memoizedState}function zw(e,t,r,n){var i=Nl();li.flags|=e,i.memoizedState=Lx(1|t,r,void 0,n===void 0?null:n)}function eE(e,t,r,n){var i=yo();n=n===void 0?null:n;var o=void 0;if(zi!==null){var h=zi.memoizedState;if(o=h.destroy,n!==null&&nM(n,h.deps)){i.memoizedState=Lx(t,r,o,n);return}}li.flags|=e,i.memoizedState=Lx(1|t,r,o,n)}function u3(e,t){return zw(8390656,8,e,t)}function aM(e,t){return eE(2048,8,e,t)}function rV(e,t){return eE(4,2,e,t)}function nV(e,t){return eE(4,4,e,t)}function iV(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function sV(e,t,r){return r=r!=null?r.concat([e]):null,eE(4,4,iV.bind(null,t,e),r)}function oM(){}function aV(e,t){var r=yo();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&nM(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function oV(e,t){var r=yo();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&nM(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function lV(e,t,r){return rf&21?(ul(r,t)||(r=f6(),li.lanes|=r,nf|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ca=!0),e.memoizedState=r)}function vte(e,t){var r=wn;wn=r!==0&&4>r?r:4,e(!0);var n=Vj.transition;Vj.transition={};try{e(!1),t()}finally{wn=r,Vj.transition=n}}function cV(){return yo().memoizedState}function xte(e,t,r){var n=od(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},uV(e))dV(t,r);else if(r=W6(e,t,r,n),r!==null){var i=Vs();ll(r,e,n,i),hV(r,t,n)}}function bte(e,t,r){var n=od(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(uV(e))dV(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var h=t.lastRenderedState,s=o(h,r);if(i.hasEagerState=!0,i.eagerState=s,ul(s,h)){var p=t.interleaved;p===null?(i.next=i,Jk(t)):(i.next=p.next,p.next=i),t.interleaved=i;return}}catch{}finally{}r=W6(e,t,i,n),r!==null&&(i=Vs(),ll(r,e,n,i),hV(r,t,n))}}function uV(e){var t=e.alternate;return e===li||t!==null&&t===li}function dV(e,t){rx=g1=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function hV(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Bk(e,r)}}var y1={readContext:go,useCallback:Es,useContext:Es,useEffect:Es,useImperativeHandle:Es,useInsertionEffect:Es,useLayoutEffect:Es,useMemo:Es,useReducer:Es,useRef:Es,useState:Es,useDebugValue:Es,useDeferredValue:Es,useTransition:Es,useMutableSource:Es,useSyncExternalStore:Es,useId:Es,unstable_isNewReconciler:!1},_te={readContext:go,useCallback:function(e,t){return Nl().memoizedState=[e,t===void 0?null:t],e},useContext:go,useEffect:u3,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,zw(4194308,4,iV.bind(null,t,e),r)},useLayoutEffect:function(e,t){return zw(4194308,4,e,t)},useInsertionEffect:function(e,t){return zw(4,2,e,t)},useMemo:function(e,t){var r=Nl();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Nl();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=xte.bind(null,li,e),[n.memoizedState,e]},useRef:function(e){var t=Nl();return e={current:e},t.memoizedState=e},useState:c3,useDebugValue:oM,useDeferredValue:function(e){return Nl().memoizedState=e},useTransition:function(){var e=c3(!1),t=e[0];return e=vte.bind(null,e[1]),Nl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=li,i=Nl();if(Xn){if(r===void 0)throw Error(Rt(407));r=r()}else{if(r=t(),es===null)throw Error(Rt(349));rf&30||Z6(n,t,r)}i.memoizedState=r;var o={value:r,getSnapshot:t};return i.queue=o,u3(J6.bind(null,n,o,e),[e]),n.flags|=2048,Lx(9,Y6.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=Nl(),t=es.identifierPrefix;if(Xn){var r=wc,n=_c;r=(n&~(1<<32-ol(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Rx++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=yte++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},wte={readContext:go,useCallback:aV,useContext:go,useEffect:aM,useImperativeHandle:sV,useInsertionEffect:rV,useLayoutEffect:nV,useMemo:oV,useReducer:qj,useRef:tV,useState:function(){return qj(Dx)},useDebugValue:oM,useDeferredValue:function(e){var t=yo();return lV(t,zi.memoizedState,e)},useTransition:function(){var e=qj(Dx)[0],t=yo().memoizedState;return[e,t]},useMutableSource:X6,useSyncExternalStore:K6,useId:cV,unstable_isNewReconciler:!1},Ste={readContext:go,useCallback:aV,useContext:go,useEffect:aM,useImperativeHandle:sV,useInsertionEffect:rV,useLayoutEffect:nV,useMemo:oV,useReducer:Wj,useRef:tV,useState:function(){return Wj(Dx)},useDebugValue:oM,useDeferredValue:function(e){var t=yo();return zi===null?t.memoizedState=e:lV(t,zi.memoizedState,e)},useTransition:function(){var e=Wj(Dx)[0],t=yo().memoizedState;return[e,t]},useMutableSource:X6,useSyncExternalStore:K6,useId:cV,unstable_isNewReconciler:!1};function Xo(e,t){if(e&&e.defaultProps){t=ci({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function FP(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ci({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var tE={isMounted:function(e){return(e=e._reactInternals)?yf(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Vs(),i=od(e),o=Pc(n,i);o.payload=t,r!=null&&(o.callback=r),t=sd(e,o,i),t!==null&&(ll(t,e,i,n),Lw(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Vs(),i=od(e),o=Pc(n,i);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=sd(e,o,i),t!==null&&(ll(t,e,i,n),Lw(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Vs(),n=od(e),i=Pc(r,n);i.tag=2,t!=null&&(i.callback=t),t=sd(e,i,n),t!==null&&(ll(t,e,n,r),Lw(t,e,n))}};function d3(e,t,r,n,i,o,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,h):t.prototype&&t.prototype.isPureReactComponent?!Ax(r,n)||!Ax(i,o):!0}function fV(e,t,r){var n=!1,i=md,o=t.contextType;return typeof o=="object"&&o!==null?o=go(o):(i=ha(t)?ef:Ms.current,n=t.contextTypes,o=(n=n!=null)?wm(e,i):md),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=tE,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function h3(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&tE.enqueueReplaceState(t,t.state,null)}function UP(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},Qk(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=go(o):(o=ha(t)?ef:Ms.current,i.context=wm(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(FP(e,t,o,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&tE.enqueueReplaceState(i,i.state,null),p1(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function jm(e,t){try{var r="",n=t;do r+=YQ(n),n=n.return;while(n);var i=r}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function Gj(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function VP(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Ete=typeof WeakMap=="function"?WeakMap:Map;function pV(e,t,r){r=Pc(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){x1||(x1=!0,QP=n),VP(e,t)},r}function mV(e,t,r){r=Pc(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){VP(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){VP(e,t),typeof n!="function"&&(ad===null?ad=new Set([this]):ad.add(this));var h=t.stack;this.componentDidCatch(t.value,{componentStack:h!==null?h:""})}),r}function f3(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Ete;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Bte.bind(null,e,t,r),t.then(e,e))}function p3(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function m3(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Pc(-1,1),t.tag=2,sd(r,t,1))),r.lanes|=1),e)}var Tte=Zc.ReactCurrentOwner,ca=!1;function Fs(e,t,r,n){t.child=e===null?q6(t,null,r,n):Em(t,e.child,r,n)}function g3(e,t,r,n,i){r=r.render;var o=t.ref;return fm(t,i),n=iM(e,t,r,n,o,i),r=sM(),e!==null&&!ca?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Bc(e,t,i)):(Xn&&r&&Gk(t),t.flags|=1,Fs(e,t,n,i),t.child)}function y3(e,t,r,n,i){if(e===null){var o=r.type;return typeof o=="function"&&!mM(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,gV(e,t,o,n,i)):(e=Vw(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var h=o.memoizedProps;if(r=r.compare,r=r!==null?r:Ax,r(h,n)&&e.ref===t.ref)return Bc(e,t,i)}return t.flags|=1,e=ld(o,n),e.ref=t.ref,e.return=t,t.child=e}function gV(e,t,r,n,i){if(e!==null){var o=e.memoizedProps;if(Ax(o,n)&&e.ref===t.ref)if(ca=!1,t.pendingProps=n=o,(e.lanes&i)!==0)e.flags&131072&&(ca=!0);else return t.lanes=e.lanes,Bc(e,t,i)}return qP(e,t,r,n,i)}function yV(e,t,r){var n=t.pendingProps,i=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bn(em,Aa),Aa|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Bn(em,Aa),Aa|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,Bn(em,Aa),Aa|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,Bn(em,Aa),Aa|=n;return Fs(e,t,i,r),t.child}function vV(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function qP(e,t,r,n,i){var o=ha(r)?ef:Ms.current;return o=wm(t,o),fm(t,i),r=iM(e,t,r,n,o,i),n=sM(),e!==null&&!ca?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Bc(e,t,i)):(Xn&&n&&Gk(t),t.flags|=1,Fs(e,t,r,i),t.child)}function v3(e,t,r,n,i){if(ha(r)){var o=!0;c1(t)}else o=!1;if(fm(t,i),t.stateNode===null)$w(e,t),fV(t,r,n),UP(t,r,n,i),n=!0;else if(e===null){var h=t.stateNode,s=t.memoizedProps;h.props=s;var p=h.context,y=r.contextType;typeof y=="object"&&y!==null?y=go(y):(y=ha(r)?ef:Ms.current,y=wm(t,y));var b=r.getDerivedStateFromProps,_=typeof b=="function"||typeof h.getSnapshotBeforeUpdate=="function";_||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(s!==n||p!==y)&&h3(t,h,n,y),Vu=!1;var E=t.memoizedState;h.state=E,p1(t,n,h,i),p=t.memoizedState,s!==n||E!==p||da.current||Vu?(typeof b=="function"&&(FP(t,r,b,n),p=t.memoizedState),(s=Vu||d3(t,r,s,n,E,p,y))?(_||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=p),h.props=n,h.state=p,h.context=y,n=s):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{h=t.stateNode,G6(e,t),s=t.memoizedProps,y=t.type===t.elementType?s:Xo(t.type,s),h.props=y,_=t.pendingProps,E=h.context,p=r.contextType,typeof p=="object"&&p!==null?p=go(p):(p=ha(r)?ef:Ms.current,p=wm(t,p));var C=r.getDerivedStateFromProps;(b=typeof C=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(s!==_||E!==p)&&h3(t,h,n,p),Vu=!1,E=t.memoizedState,h.state=E,p1(t,n,h,i);var k=t.memoizedState;s!==_||E!==k||da.current||Vu?(typeof C=="function"&&(FP(t,r,C,n),k=t.memoizedState),(y=Vu||d3(t,r,y,n,E,k,p)||!1)?(b||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(n,k,p),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(n,k,p)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||s===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=k),h.props=n,h.state=k,h.context=p,n=y):(typeof h.componentDidUpdate!="function"||s===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),n=!1)}return WP(e,t,r,n,o,i)}function WP(e,t,r,n,i,o){vV(e,t);var h=(t.flags&128)!==0;if(!n&&!h)return i&&n3(t,r,!1),Bc(e,t,o);n=t.stateNode,Tte.current=t;var s=h&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&h?(t.child=Em(t,e.child,null,o),t.child=Em(t,null,s,o)):Fs(e,t,s,o),t.memoizedState=n.state,i&&n3(t,r,!0),t.child}function xV(e){var t=e.stateNode;t.pendingContext?r3(e,t.pendingContext,t.pendingContext!==t.context):t.context&&r3(e,t.context,!1),eM(e,t.containerInfo)}function x3(e,t,r,n,i){return Sm(),Xk(i),t.flags|=256,Fs(e,t,r,n),t.child}var GP={dehydrated:null,treeContext:null,retryLane:0};function HP(e){return{baseLanes:e,cachePool:null,transitions:null}}function bV(e,t,r){var n=t.pendingProps,i=ai.current,o=!1,h=(t.flags&128)!==0,s;if((s=h)||(s=e!==null&&e.memoizedState===null?!1:(i&2)!==0),s?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Bn(ai,i&1),e===null)return zP(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(h=n.children,e=n.fallback,o?(n=t.mode,o=t.child,h={mode:"hidden",children:h},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=h):o=iE(h,n,0,null),e=Kh(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=HP(r),t.memoizedState=GP,e):lM(t,h));if(i=e.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return jte(e,t,h,n,s,i,r);if(o){o=n.fallback,h=t.mode,i=e.child,s=i.sibling;var p={mode:"hidden",children:n.children};return!(h&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=p,t.deletions=null):(n=ld(i,p),n.subtreeFlags=i.subtreeFlags&14680064),s!==null?o=ld(s,o):(o=Kh(o,h,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,h=e.child.memoizedState,h=h===null?HP(r):{baseLanes:h.baseLanes|r,cachePool:null,transitions:h.transitions},o.memoizedState=h,o.childLanes=e.childLanes&~r,t.memoizedState=GP,n}return o=e.child,e=o.sibling,n=ld(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function lM(e,t){return t=iE({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function H_(e,t,r,n){return n!==null&&Xk(n),Em(t,e.child,null,r),e=lM(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function jte(e,t,r,n,i,o,h){if(r)return t.flags&256?(t.flags&=-257,n=Gj(Error(Rt(422))),H_(e,t,h,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,i=t.mode,n=iE({mode:"visible",children:n.children},i,0,null),o=Kh(o,i,h,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&Em(t,e.child,null,h),t.child.memoizedState=HP(h),t.memoizedState=GP,o);if(!(t.mode&1))return H_(e,t,h,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var s=n.dgst;return n=s,o=Error(Rt(419)),n=Gj(o,n,void 0),H_(e,t,h,n)}if(s=(h&e.childLanes)!==0,ca||s){if(n=es,n!==null){switch(h&-h){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|h)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Lc(e,i),ll(n,e,i,-1))}return pM(),n=Gj(Error(Rt(421))),H_(e,t,h,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=zte.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,Ia=id(i.nextSibling),Oa=t,Xn=!0,el=null,e!==null&&(so[ao++]=_c,so[ao++]=wc,so[ao++]=tf,_c=e.id,wc=e.overflow,tf=t),t=lM(t,n.children),t.flags|=4096,t)}function b3(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),$P(e.return,t,r)}function Hj(e,t,r,n,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function _V(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(Fs(e,t,n.children,r),n=ai.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&b3(e,r,t);else if(e.tag===19)b3(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Bn(ai,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&m1(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Hj(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&m1(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Hj(t,!0,r,null,o);break;case"together":Hj(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $w(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Bc(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),nf|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Rt(153));if(t.child!==null){for(e=t.child,r=ld(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ld(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Cte(e,t,r){switch(t.tag){case 3:xV(t),Sm();break;case 5:H6(t);break;case 1:ha(t.type)&&c1(t);break;case 4:eM(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Bn(h1,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Bn(ai,ai.current&1),t.flags|=128,null):r&t.child.childLanes?bV(e,t,r):(Bn(ai,ai.current&1),e=Bc(e,t,r),e!==null?e.sibling:null);Bn(ai,ai.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return _V(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Bn(ai,ai.current),n)break;return null;case 22:case 23:return t.lanes=0,yV(e,t,r)}return Bc(e,t,r)}var wV,XP,SV,EV;wV=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};XP=function(){};SV=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Fh(Ll.current);var o=null;switch(r){case"input":i=gP(e,i),n=gP(e,n),o=[];break;case"select":i=ci({},i,{value:void 0}),n=ci({},n,{value:void 0}),o=[];break;case"textarea":i=xP(e,i),n=xP(e,n),o=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=o1)}_P(r,n);var h;r=null;for(y in i)if(!n.hasOwnProperty(y)&&i.hasOwnProperty(y)&&i[y]!=null)if(y==="style"){var s=i[y];for(h in s)s.hasOwnProperty(h)&&(r||(r={}),r[h]="")}else y!=="dangerouslySetInnerHTML"&&y!=="children"&&y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(wx.hasOwnProperty(y)?o||(o=[]):(o=o||[]).push(y,null));for(y in n){var p=n[y];if(s=i!=null?i[y]:void 0,n.hasOwnProperty(y)&&p!==s&&(p!=null||s!=null))if(y==="style")if(s){for(h in s)!s.hasOwnProperty(h)||p&&p.hasOwnProperty(h)||(r||(r={}),r[h]="");for(h in p)p.hasOwnProperty(h)&&s[h]!==p[h]&&(r||(r={}),r[h]=p[h])}else r||(o||(o=[]),o.push(y,r)),r=p;else y==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,s=s?s.__html:void 0,p!=null&&s!==p&&(o=o||[]).push(y,p)):y==="children"?typeof p!="string"&&typeof p!="number"||(o=o||[]).push(y,""+p):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&(wx.hasOwnProperty(y)?(p!=null&&y==="onScroll"&&Un("scroll",e),o||s===p||(o=[])):(o=o||[]).push(y,p))}r&&(o=o||[]).push("style",r);var y=o;(t.updateQueue=y)&&(t.flags|=4)}};EV=function(e,t,r,n){r!==n&&(t.flags|=4)};function bv(e,t){if(!Xn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ts(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Pte(e,t,r){var n=t.pendingProps;switch(Hk(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ts(t),null;case 1:return ha(t.type)&&l1(),Ts(t),null;case 3:return n=t.stateNode,Tm(),Wn(da),Wn(Ms),rM(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(W_(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,el!==null&&(rA(el),el=null))),XP(e,t),Ts(t),null;case 5:tM(t);var i=Fh(Ox.current);if(r=t.type,e!==null&&t.stateNode!=null)SV(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Rt(166));return Ts(t),null}if(e=Fh(Ll.current),W_(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[Ml]=t,n[Mx]=o,e=(t.mode&1)!==0,r){case"dialog":Un("cancel",n),Un("close",n);break;case"iframe":case"object":case"embed":Un("load",n);break;case"video":case"audio":for(i=0;i<Wv.length;i++)Un(Wv[i],n);break;case"source":Un("error",n);break;case"img":case"image":case"link":Un("error",n),Un("load",n);break;case"details":Un("toggle",n);break;case"input":AL(n,o),Un("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Un("invalid",n);break;case"textarea":kL(n,o),Un("invalid",n)}_P(r,o),i=null;for(var h in o)if(o.hasOwnProperty(h)){var s=o[h];h==="children"?typeof s=="string"?n.textContent!==s&&(o.suppressHydrationWarning!==!0&&q_(n.textContent,s,e),i=["children",s]):typeof s=="number"&&n.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&q_(n.textContent,s,e),i=["children",""+s]):wx.hasOwnProperty(h)&&s!=null&&h==="onScroll"&&Un("scroll",n)}switch(r){case"input":D_(n),NL(n,o,!0);break;case"textarea":D_(n),ML(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=o1)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{h=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=JU(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=h.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=h.createElement(r,{is:n.is}):(e=h.createElement(r),r==="select"&&(h=e,n.multiple?h.multiple=!0:n.size&&(h.size=n.size))):e=h.createElementNS(e,r),e[Ml]=t,e[Mx]=n,wV(e,t,!1,!1),t.stateNode=e;e:{switch(h=wP(r,n),r){case"dialog":Un("cancel",e),Un("close",e),i=n;break;case"iframe":case"object":case"embed":Un("load",e),i=n;break;case"video":case"audio":for(i=0;i<Wv.length;i++)Un(Wv[i],e);i=n;break;case"source":Un("error",e),i=n;break;case"img":case"image":case"link":Un("error",e),Un("load",e),i=n;break;case"details":Un("toggle",e),i=n;break;case"input":AL(e,n),i=gP(e,n),Un("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=ci({},n,{value:void 0}),Un("invalid",e);break;case"textarea":kL(e,n),i=xP(e,n),Un("invalid",e);break;default:i=n}_P(r,i),s=i;for(o in s)if(s.hasOwnProperty(o)){var p=s[o];o==="style"?t6(e,p):o==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&QU(e,p)):o==="children"?typeof p=="string"?(r!=="textarea"||p!=="")&&Sx(e,p):typeof p=="number"&&Sx(e,""+p):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(wx.hasOwnProperty(o)?p!=null&&o==="onScroll"&&Un("scroll",e):p!=null&&Mk(e,o,p,h))}switch(r){case"input":D_(e),NL(e,n,!1);break;case"textarea":D_(e),ML(e);break;case"option":n.value!=null&&e.setAttribute("value",""+pd(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?cm(e,!!n.multiple,o,!1):n.defaultValue!=null&&cm(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=o1)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ts(t),null;case 6:if(e&&t.stateNode!=null)EV(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Rt(166));if(r=Fh(Ox.current),Fh(Ll.current),W_(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ml]=t,(o=n.nodeValue!==r)&&(e=Oa,e!==null))switch(e.tag){case 3:q_(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&q_(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ml]=t,t.stateNode=n}return Ts(t),null;case 13:if(Wn(ai),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Xn&&Ia!==null&&t.mode&1&&!(t.flags&128))U6(),Sm(),t.flags|=98560,o=!1;else if(o=W_(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(Rt(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Rt(317));o[Ml]=t}else Sm(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ts(t),o=!1}else el!==null&&(rA(el),el=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ai.current&1?$i===0&&($i=3):pM())),t.updateQueue!==null&&(t.flags|=4),Ts(t),null);case 4:return Tm(),XP(e,t),e===null&&Nx(t.stateNode.containerInfo),Ts(t),null;case 10:return Yk(t.type._context),Ts(t),null;case 17:return ha(t.type)&&l1(),Ts(t),null;case 19:if(Wn(ai),o=t.memoizedState,o===null)return Ts(t),null;if(n=(t.flags&128)!==0,h=o.rendering,h===null)if(n)bv(o,!1);else{if($i!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(h=m1(e),h!==null){for(t.flags|=128,bv(o,!1),n=h.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,h=o.alternate,h===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,e=h.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Bn(ai,ai.current&1|2),t.child}e=e.sibling}o.tail!==null&&mi()>Cm&&(t.flags|=128,n=!0,bv(o,!1),t.lanes=4194304)}else{if(!n)if(e=m1(h),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),bv(o,!0),o.tail===null&&o.tailMode==="hidden"&&!h.alternate&&!Xn)return Ts(t),null}else 2*mi()-o.renderingStartTime>Cm&&r!==1073741824&&(t.flags|=128,n=!0,bv(o,!1),t.lanes=4194304);o.isBackwards?(h.sibling=t.child,t.child=h):(r=o.last,r!==null?r.sibling=h:t.child=h,o.last=h)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=mi(),t.sibling=null,r=ai.current,Bn(ai,n?r&1|2:r&1),t):(Ts(t),null);case 22:case 23:return fM(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Aa&1073741824&&(Ts(t),t.subtreeFlags&6&&(t.flags|=8192)):Ts(t),null;case 24:return null;case 25:return null}throw Error(Rt(156,t.tag))}function Ate(e,t){switch(Hk(t),t.tag){case 1:return ha(t.type)&&l1(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Tm(),Wn(da),Wn(Ms),rM(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return tM(t),null;case 13:if(Wn(ai),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Rt(340));Sm()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Wn(ai),null;case 4:return Tm(),null;case 10:return Yk(t.type._context),null;case 22:case 23:return fM(),null;case 24:return null;default:return null}}var X_=!1,Ps=!1,Nte=typeof WeakSet=="function"?WeakSet:Set,er=null;function Qp(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){hi(e,t,n)}else r.current=null}function KP(e,t,r){try{r()}catch(n){hi(e,t,n)}}var _3=!1;function kte(e,t){if(MP=i1,e=A6(),Wk(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var h=0,s=-1,p=-1,y=0,b=0,_=e,E=null;t:for(;;){for(var C;_!==r||i!==0&&_.nodeType!==3||(s=h+i),_!==o||n!==0&&_.nodeType!==3||(p=h+n),_.nodeType===3&&(h+=_.nodeValue.length),(C=_.firstChild)!==null;)E=_,_=C;for(;;){if(_===e)break t;if(E===r&&++y===i&&(s=h),E===o&&++b===n&&(p=h),(C=_.nextSibling)!==null)break;_=E,E=_.parentNode}_=C}r=s===-1||p===-1?null:{start:s,end:p}}else r=null}r=r||{start:0,end:0}}else r=null;for(IP={focusedElem:e,selectionRange:r},i1=!1,er=t;er!==null;)if(t=er,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,er=e;else for(;er!==null;){t=er;try{var k=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var N=k.memoizedProps,O=k.memoizedState,R=t.stateNode,L=R.getSnapshotBeforeUpdate(t.elementType===t.type?N:Xo(t.type,N),O);R.__reactInternalSnapshotBeforeUpdate=L}break;case 3:var B=t.stateNode.containerInfo;B.nodeType===1?B.textContent="":B.nodeType===9&&B.documentElement&&B.removeChild(B.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Rt(163))}}catch(q){hi(t,t.return,q)}if(e=t.sibling,e!==null){e.return=t.return,er=e;break}er=t.return}return k=_3,_3=!1,k}function nx(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&KP(t,r,o)}i=i.next}while(i!==n)}}function rE(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ZP(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function TV(e){var t=e.alternate;t!==null&&(e.alternate=null,TV(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ml],delete t[Mx],delete t[DP],delete t[fte],delete t[pte])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function jV(e){return e.tag===5||e.tag===3||e.tag===4}function w3(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||jV(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function YP(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=o1));else if(n!==4&&(e=e.child,e!==null))for(YP(e,t,r),e=e.sibling;e!==null;)YP(e,t,r),e=e.sibling}function JP(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(JP(e,t,r),e=e.sibling;e!==null;)JP(e,t,r),e=e.sibling}var os=null,Ko=!1;function Iu(e,t,r){for(r=r.child;r!==null;)CV(e,t,r),r=r.sibling}function CV(e,t,r){if(Dl&&typeof Dl.onCommitFiberUnmount=="function")try{Dl.onCommitFiberUnmount(XS,r)}catch{}switch(r.tag){case 5:Ps||Qp(r,t);case 6:var n=os,i=Ko;os=null,Iu(e,t,r),os=n,Ko=i,os!==null&&(Ko?(e=os,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):os.removeChild(r.stateNode));break;case 18:os!==null&&(Ko?(e=os,r=r.stateNode,e.nodeType===8?$j(e.parentNode,r):e.nodeType===1&&$j(e,r),Cx(e)):$j(os,r.stateNode));break;case 4:n=os,i=Ko,os=r.stateNode.containerInfo,Ko=!0,Iu(e,t,r),os=n,Ko=i;break;case 0:case 11:case 14:case 15:if(!Ps&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var o=i,h=o.destroy;o=o.tag,h!==void 0&&(o&2||o&4)&&KP(r,t,h),i=i.next}while(i!==n)}Iu(e,t,r);break;case 1:if(!Ps&&(Qp(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){hi(r,t,s)}Iu(e,t,r);break;case 21:Iu(e,t,r);break;case 22:r.mode&1?(Ps=(n=Ps)||r.memoizedState!==null,Iu(e,t,r),Ps=n):Iu(e,t,r);break;default:Iu(e,t,r)}}function S3(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Nte),t.forEach(function(n){var i=$te.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Vo(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var o=e,h=t,s=h;e:for(;s!==null;){switch(s.tag){case 5:os=s.stateNode,Ko=!1;break e;case 3:os=s.stateNode.containerInfo,Ko=!0;break e;case 4:os=s.stateNode.containerInfo,Ko=!0;break e}s=s.return}if(os===null)throw Error(Rt(160));CV(o,h,i),os=null,Ko=!1;var p=i.alternate;p!==null&&(p.return=null),i.return=null}catch(y){hi(i,t,y)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)PV(t,e),t=t.sibling}function PV(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Vo(t,e),Al(e),n&4){try{nx(3,e,e.return),rE(3,e)}catch(N){hi(e,e.return,N)}try{nx(5,e,e.return)}catch(N){hi(e,e.return,N)}}break;case 1:Vo(t,e),Al(e),n&512&&r!==null&&Qp(r,r.return);break;case 5:if(Vo(t,e),Al(e),n&512&&r!==null&&Qp(r,r.return),e.flags&32){var i=e.stateNode;try{Sx(i,"")}catch(N){hi(e,e.return,N)}}if(n&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,h=r!==null?r.memoizedProps:o,s=e.type,p=e.updateQueue;if(e.updateQueue=null,p!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&ZU(i,o),wP(s,h);var y=wP(s,o);for(h=0;h<p.length;h+=2){var b=p[h],_=p[h+1];b==="style"?t6(i,_):b==="dangerouslySetInnerHTML"?QU(i,_):b==="children"?Sx(i,_):Mk(i,b,_,y)}switch(s){case"input":yP(i,o);break;case"textarea":YU(i,o);break;case"select":var E=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var C=o.value;C!=null?cm(i,!!o.multiple,C,!1):E!==!!o.multiple&&(o.defaultValue!=null?cm(i,!!o.multiple,o.defaultValue,!0):cm(i,!!o.multiple,o.multiple?[]:"",!1))}i[Mx]=o}catch(N){hi(e,e.return,N)}}break;case 6:if(Vo(t,e),Al(e),n&4){if(e.stateNode===null)throw Error(Rt(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(N){hi(e,e.return,N)}}break;case 3:if(Vo(t,e),Al(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Cx(t.containerInfo)}catch(N){hi(e,e.return,N)}break;case 4:Vo(t,e),Al(e);break;case 13:Vo(t,e),Al(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(dM=mi())),n&4&&S3(e);break;case 22:if(b=r!==null&&r.memoizedState!==null,e.mode&1?(Ps=(y=Ps)||b,Vo(t,e),Ps=y):Vo(t,e),Al(e),n&8192){if(y=e.memoizedState!==null,(e.stateNode.isHidden=y)&&!b&&e.mode&1)for(er=e,b=e.child;b!==null;){for(_=er=b;er!==null;){switch(E=er,C=E.child,E.tag){case 0:case 11:case 14:case 15:nx(4,E,E.return);break;case 1:Qp(E,E.return);var k=E.stateNode;if(typeof k.componentWillUnmount=="function"){n=E,r=E.return;try{t=n,k.props=t.memoizedProps,k.state=t.memoizedState,k.componentWillUnmount()}catch(N){hi(n,r,N)}}break;case 5:Qp(E,E.return);break;case 22:if(E.memoizedState!==null){T3(_);continue}}C!==null?(C.return=E,er=C):T3(_)}b=b.sibling}e:for(b=null,_=e;;){if(_.tag===5){if(b===null){b=_;try{i=_.stateNode,y?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=_.stateNode,p=_.memoizedProps.style,h=p!=null&&p.hasOwnProperty("display")?p.display:null,s.style.display=e6("display",h))}catch(N){hi(e,e.return,N)}}}else if(_.tag===6){if(b===null)try{_.stateNode.nodeValue=y?"":_.memoizedProps}catch(N){hi(e,e.return,N)}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===e)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===e)break e;for(;_.sibling===null;){if(_.return===null||_.return===e)break e;b===_&&(b=null),_=_.return}b===_&&(b=null),_.sibling.return=_.return,_=_.sibling}}break;case 19:Vo(t,e),Al(e),n&4&&S3(e);break;case 21:break;default:Vo(t,e),Al(e)}}function Al(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(jV(r)){var n=r;break e}r=r.return}throw Error(Rt(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Sx(i,""),n.flags&=-33);var o=w3(e);JP(e,o,i);break;case 3:case 4:var h=n.stateNode.containerInfo,s=w3(e);YP(e,s,h);break;default:throw Error(Rt(161))}}catch(p){hi(e,e.return,p)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Mte(e,t,r){er=e,AV(e)}function AV(e,t,r){for(var n=(e.mode&1)!==0;er!==null;){var i=er,o=i.child;if(i.tag===22&&n){var h=i.memoizedState!==null||X_;if(!h){var s=i.alternate,p=s!==null&&s.memoizedState!==null||Ps;s=X_;var y=Ps;if(X_=h,(Ps=p)&&!y)for(er=i;er!==null;)h=er,p=h.child,h.tag===22&&h.memoizedState!==null?j3(i):p!==null?(p.return=h,er=p):j3(i);for(;o!==null;)er=o,AV(o),o=o.sibling;er=i,X_=s,Ps=y}E3(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,er=o):E3(e)}}function E3(e){for(;er!==null;){var t=er;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ps||rE(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ps)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Xo(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&l3(t,o,n);break;case 3:var h=t.updateQueue;if(h!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}l3(t,h,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var p=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&r.focus();break;case"img":p.src&&(r.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var y=t.alternate;if(y!==null){var b=y.memoizedState;if(b!==null){var _=b.dehydrated;_!==null&&Cx(_)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Rt(163))}Ps||t.flags&512&&ZP(t)}catch(E){hi(t,t.return,E)}}if(t===e){er=null;break}if(r=t.sibling,r!==null){r.return=t.return,er=r;break}er=t.return}}function T3(e){for(;er!==null;){var t=er;if(t===e){er=null;break}var r=t.sibling;if(r!==null){r.return=t.return,er=r;break}er=t.return}}function j3(e){for(;er!==null;){var t=er;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{rE(4,t)}catch(p){hi(t,r,p)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(p){hi(t,i,p)}}var o=t.return;try{ZP(t)}catch(p){hi(t,o,p)}break;case 5:var h=t.return;try{ZP(t)}catch(p){hi(t,h,p)}}}catch(p){hi(t,t.return,p)}if(t===e){er=null;break}var s=t.sibling;if(s!==null){s.return=t.return,er=s;break}er=t.return}}var Ite=Math.ceil,v1=Zc.ReactCurrentDispatcher,cM=Zc.ReactCurrentOwner,ho=Zc.ReactCurrentBatchConfig,en=0,es=null,Ai=null,hs=0,Aa=0,em=Ed(0),$i=0,Bx=null,nf=0,nE=0,uM=0,ix=null,oa=null,dM=0,Cm=1/0,yc=null,x1=!1,QP=null,ad=null,K_=!1,Ju=null,b1=0,sx=0,eA=null,Fw=-1,Uw=0;function Vs(){return en&6?mi():Fw!==-1?Fw:Fw=mi()}function od(e){return e.mode&1?en&2&&hs!==0?hs&-hs:gte.transition!==null?(Uw===0&&(Uw=f6()),Uw):(e=wn,e!==0||(e=window.event,e=e===void 0?16:b6(e.type)),e):1}function ll(e,t,r,n){if(50<sx)throw sx=0,eA=null,Error(Rt(185));O0(e,r,n),(!(en&2)||e!==es)&&(e===es&&(!(en&2)&&(nE|=r),$i===4&&Xu(e,hs)),fa(e,n),r===1&&en===0&&!(t.mode&1)&&(Cm=mi()+500,QS&&Td()))}function fa(e,t){var r=e.callbackNode;gee(e,t);var n=n1(e,e===es?hs:0);if(n===0)r!==null&&RL(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&RL(r),t===1)e.tag===0?mte(C3.bind(null,e)):z6(C3.bind(null,e)),dte(function(){!(en&6)&&Td()}),r=null;else{switch(p6(n)){case 1:r=Lk;break;case 4:r=d6;break;case 16:r=r1;break;case 536870912:r=h6;break;default:r=r1}r=LV(r,NV.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function NV(e,t){if(Fw=-1,Uw=0,en&6)throw Error(Rt(327));var r=e.callbackNode;if(pm()&&e.callbackNode!==r)return null;var n=n1(e,e===es?hs:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=_1(e,n);else{t=n;var i=en;en|=2;var o=MV();(es!==e||hs!==t)&&(yc=null,Cm=mi()+500,Xh(e,t));do try{Dte();break}catch(s){kV(e,s)}while(1);Zk(),v1.current=o,en=i,Ai!==null?t=0:(es=null,hs=0,t=$i)}if(t!==0){if(t===2&&(i=CP(e),i!==0&&(n=i,t=tA(e,i))),t===1)throw r=Bx,Xh(e,0),Xu(e,n),fa(e,mi()),r;if(t===6)Xu(e,n);else{if(i=e.current.alternate,!(n&30)&&!Ote(i)&&(t=_1(e,n),t===2&&(o=CP(e),o!==0&&(n=o,t=tA(e,o))),t===1))throw r=Bx,Xh(e,0),Xu(e,n),fa(e,mi()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Rt(345));case 2:Ah(e,oa,yc);break;case 3:if(Xu(e,n),(n&130023424)===n&&(t=dM+500-mi(),10<t)){if(n1(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Vs(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=RP(Ah.bind(null,e,oa,yc),t);break}Ah(e,oa,yc);break;case 4:if(Xu(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var h=31-ol(n);o=1<<h,h=t[h],h>i&&(i=h),n&=~o}if(n=i,n=mi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ite(n/1960))-n,10<n){e.timeoutHandle=RP(Ah.bind(null,e,oa,yc),n);break}Ah(e,oa,yc);break;case 5:Ah(e,oa,yc);break;default:throw Error(Rt(329))}}}return fa(e,mi()),e.callbackNode===r?NV.bind(null,e):null}function tA(e,t){var r=ix;return e.current.memoizedState.isDehydrated&&(Xh(e,t).flags|=256),e=_1(e,t),e!==2&&(t=oa,oa=r,t!==null&&rA(t)),e}function rA(e){oa===null?oa=e:oa.push.apply(oa,e)}function Ote(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!ul(o(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xu(e,t){for(t&=~uM,t&=~nE,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ol(t),n=1<<r;e[r]=-1,t&=~n}}function C3(e){if(en&6)throw Error(Rt(327));pm();var t=n1(e,0);if(!(t&1))return fa(e,mi()),null;var r=_1(e,t);if(e.tag!==0&&r===2){var n=CP(e);n!==0&&(t=n,r=tA(e,n))}if(r===1)throw r=Bx,Xh(e,0),Xu(e,t),fa(e,mi()),r;if(r===6)throw Error(Rt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ah(e,oa,yc),fa(e,mi()),null}function hM(e,t){var r=en;en|=1;try{return e(t)}finally{en=r,en===0&&(Cm=mi()+500,QS&&Td())}}function sf(e){Ju!==null&&Ju.tag===0&&!(en&6)&&pm();var t=en;en|=1;var r=ho.transition,n=wn;try{if(ho.transition=null,wn=1,e)return e()}finally{wn=n,ho.transition=r,en=t,!(en&6)&&Td()}}function fM(){Aa=em.current,Wn(em)}function Xh(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,ute(r)),Ai!==null)for(r=Ai.return;r!==null;){var n=r;switch(Hk(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&l1();break;case 3:Tm(),Wn(da),Wn(Ms),rM();break;case 5:tM(n);break;case 4:Tm();break;case 13:Wn(ai);break;case 19:Wn(ai);break;case 10:Yk(n.type._context);break;case 22:case 23:fM()}r=r.return}if(es=e,Ai=e=ld(e.current,null),hs=Aa=t,$i=0,Bx=null,uM=nE=nf=0,oa=ix=null,$h!==null){for(t=0;t<$h.length;t++)if(r=$h[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,o=r.pending;if(o!==null){var h=o.next;o.next=i,n.next=h}r.pending=n}$h=null}return e}function kV(e,t){do{var r=Ai;try{if(Zk(),Bw.current=y1,g1){for(var n=li.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}g1=!1}if(rf=0,Qi=zi=li=null,rx=!1,Rx=0,cM.current=null,r===null||r.return===null){$i=1,Bx=t,Ai=null;break}e:{var o=e,h=r.return,s=r,p=t;if(t=hs,s.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var y=p,b=s,_=b.tag;if(!(b.mode&1)&&(_===0||_===11||_===15)){var E=b.alternate;E?(b.updateQueue=E.updateQueue,b.memoizedState=E.memoizedState,b.lanes=E.lanes):(b.updateQueue=null,b.memoizedState=null)}var C=p3(h);if(C!==null){C.flags&=-257,m3(C,h,s,o,t),C.mode&1&&f3(o,y,t),t=C,p=y;var k=t.updateQueue;if(k===null){var N=new Set;N.add(p),t.updateQueue=N}else k.add(p);break e}else{if(!(t&1)){f3(o,y,t),pM();break e}p=Error(Rt(426))}}else if(Xn&&s.mode&1){var O=p3(h);if(O!==null){!(O.flags&65536)&&(O.flags|=256),m3(O,h,s,o,t),Xk(jm(p,s));break e}}o=p=jm(p,s),$i!==4&&($i=2),ix===null?ix=[o]:ix.push(o),o=h;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var R=pV(o,p,t);o3(o,R);break e;case 1:s=p;var L=o.type,B=o.stateNode;if(!(o.flags&128)&&(typeof L.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(ad===null||!ad.has(B)))){o.flags|=65536,t&=-t,o.lanes|=t;var q=mV(o,s,t);o3(o,q);break e}}o=o.return}while(o!==null)}OV(r)}catch(F){t=F,Ai===r&&r!==null&&(Ai=r=r.return);continue}break}while(1)}function MV(){var e=v1.current;return v1.current=y1,e===null?y1:e}function pM(){($i===0||$i===3||$i===2)&&($i=4),es===null||!(nf&268435455)&&!(nE&268435455)||Xu(es,hs)}function _1(e,t){var r=en;en|=2;var n=MV();(es!==e||hs!==t)&&(yc=null,Xh(e,t));do try{Rte();break}catch(i){kV(e,i)}while(1);if(Zk(),en=r,v1.current=n,Ai!==null)throw Error(Rt(261));return es=null,hs=0,$i}function Rte(){for(;Ai!==null;)IV(Ai)}function Dte(){for(;Ai!==null&&!oee();)IV(Ai)}function IV(e){var t=DV(e.alternate,e,Aa);e.memoizedProps=e.pendingProps,t===null?OV(e):Ai=t,cM.current=null}function OV(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Ate(r,t),r!==null){r.flags&=32767,Ai=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{$i=6,Ai=null;return}}else if(r=Pte(r,t,Aa),r!==null){Ai=r;return}if(t=t.sibling,t!==null){Ai=t;return}Ai=t=e}while(t!==null);$i===0&&($i=5)}function Ah(e,t,r){var n=wn,i=ho.transition;try{ho.transition=null,wn=1,Lte(e,t,r,n)}finally{ho.transition=i,wn=n}return null}function Lte(e,t,r,n){do pm();while(Ju!==null);if(en&6)throw Error(Rt(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Rt(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(yee(e,o),e===es&&(Ai=es=null,hs=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||K_||(K_=!0,LV(r1,function(){return pm(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=ho.transition,ho.transition=null;var h=wn;wn=1;var s=en;en|=4,cM.current=null,kte(e,r),PV(r,e),nte(IP),i1=!!MP,IP=MP=null,e.current=r,Mte(r),lee(),en=s,wn=h,ho.transition=o}else e.current=r;if(K_&&(K_=!1,Ju=e,b1=i),o=e.pendingLanes,o===0&&(ad=null),dee(r.stateNode),fa(e,mi()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(x1)throw x1=!1,e=QP,QP=null,e;return b1&1&&e.tag!==0&&pm(),o=e.pendingLanes,o&1?e===eA?sx++:(sx=0,eA=e):sx=0,Td(),null}function pm(){if(Ju!==null){var e=p6(b1),t=ho.transition,r=wn;try{if(ho.transition=null,wn=16>e?16:e,Ju===null)var n=!1;else{if(e=Ju,Ju=null,b1=0,en&6)throw Error(Rt(331));var i=en;for(en|=4,er=e.current;er!==null;){var o=er,h=o.child;if(er.flags&16){var s=o.deletions;if(s!==null){for(var p=0;p<s.length;p++){var y=s[p];for(er=y;er!==null;){var b=er;switch(b.tag){case 0:case 11:case 15:nx(8,b,o)}var _=b.child;if(_!==null)_.return=b,er=_;else for(;er!==null;){b=er;var E=b.sibling,C=b.return;if(TV(b),b===y){er=null;break}if(E!==null){E.return=C,er=E;break}er=C}}}var k=o.alternate;if(k!==null){var N=k.child;if(N!==null){k.child=null;do{var O=N.sibling;N.sibling=null,N=O}while(N!==null)}}er=o}}if(o.subtreeFlags&2064&&h!==null)h.return=o,er=h;else e:for(;er!==null;){if(o=er,o.flags&2048)switch(o.tag){case 0:case 11:case 15:nx(9,o,o.return)}var R=o.sibling;if(R!==null){R.return=o.return,er=R;break e}er=o.return}}var L=e.current;for(er=L;er!==null;){h=er;var B=h.child;if(h.subtreeFlags&2064&&B!==null)B.return=h,er=B;else e:for(h=L;er!==null;){if(s=er,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:rE(9,s)}}catch(F){hi(s,s.return,F)}if(s===h){er=null;break e}var q=s.sibling;if(q!==null){q.return=s.return,er=q;break e}er=s.return}}if(en=i,Td(),Dl&&typeof Dl.onPostCommitFiberRoot=="function")try{Dl.onPostCommitFiberRoot(XS,e)}catch{}n=!0}return n}finally{wn=r,ho.transition=t}}return!1}function P3(e,t,r){t=jm(r,t),t=pV(e,t,1),e=sd(e,t,1),t=Vs(),e!==null&&(O0(e,1,t),fa(e,t))}function hi(e,t,r){if(e.tag===3)P3(e,e,r);else for(;t!==null;){if(t.tag===3){P3(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ad===null||!ad.has(n))){e=jm(r,e),e=mV(t,e,1),t=sd(t,e,1),e=Vs(),t!==null&&(O0(t,1,e),fa(t,e));break}}t=t.return}}function Bte(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Vs(),e.pingedLanes|=e.suspendedLanes&r,es===e&&(hs&r)===r&&($i===4||$i===3&&(hs&130023424)===hs&&500>mi()-dM?Xh(e,0):uM|=r),fa(e,t)}function RV(e,t){t===0&&(e.mode&1?(t=z_,z_<<=1,!(z_&130023424)&&(z_=4194304)):t=1);var r=Vs();e=Lc(e,t),e!==null&&(O0(e,t,r),fa(e,r))}function zte(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),RV(e,r)}function $te(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Rt(314))}n!==null&&n.delete(t),RV(e,r)}var DV;DV=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||da.current)ca=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ca=!1,Cte(e,t,r);ca=!!(e.flags&131072)}else ca=!1,Xn&&t.flags&1048576&&$6(t,d1,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;$w(e,t),e=t.pendingProps;var i=wm(t,Ms.current);fm(t,r),i=iM(null,t,n,e,i,r);var o=sM();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ha(n)?(o=!0,c1(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Qk(t),i.updater=tE,t.stateNode=i,i._reactInternals=t,UP(t,n,e,r),t=WP(null,t,n,!0,o,r)):(t.tag=0,Xn&&o&&Gk(t),Fs(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch($w(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Ute(n),e=Xo(n,e),i){case 0:t=qP(null,t,n,e,r);break e;case 1:t=v3(null,t,n,e,r);break e;case 11:t=g3(null,t,n,e,r);break e;case 14:t=y3(null,t,n,Xo(n.type,e),r);break e}throw Error(Rt(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Xo(n,i),qP(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Xo(n,i),v3(e,t,n,i,r);case 3:e:{if(xV(t),e===null)throw Error(Rt(387));n=t.pendingProps,o=t.memoizedState,i=o.element,G6(e,t),p1(t,n,null,r);var h=t.memoizedState;if(n=h.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=jm(Error(Rt(423)),t),t=x3(e,t,n,r,i);break e}else if(n!==i){i=jm(Error(Rt(424)),t),t=x3(e,t,n,r,i);break e}else for(Ia=id(t.stateNode.containerInfo.firstChild),Oa=t,Xn=!0,el=null,r=q6(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Sm(),n===i){t=Bc(e,t,r);break e}Fs(e,t,n,r)}t=t.child}return t;case 5:return H6(t),e===null&&zP(t),n=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,h=i.children,OP(n,i)?h=null:o!==null&&OP(n,o)&&(t.flags|=32),vV(e,t),Fs(e,t,h,r),t.child;case 6:return e===null&&zP(t),null;case 13:return bV(e,t,r);case 4:return eM(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Em(t,null,n,r):Fs(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Xo(n,i),g3(e,t,n,i,r);case 7:return Fs(e,t,t.pendingProps,r),t.child;case 8:return Fs(e,t,t.pendingProps.children,r),t.child;case 12:return Fs(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,o=t.memoizedProps,h=i.value,Bn(h1,n._currentValue),n._currentValue=h,o!==null)if(ul(o.value,h)){if(o.children===i.children&&!da.current){t=Bc(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var s=o.dependencies;if(s!==null){h=o.child;for(var p=s.firstContext;p!==null;){if(p.context===n){if(o.tag===1){p=Pc(-1,r&-r),p.tag=2;var y=o.updateQueue;if(y!==null){y=y.shared;var b=y.pending;b===null?p.next=p:(p.next=b.next,b.next=p),y.pending=p}}o.lanes|=r,p=o.alternate,p!==null&&(p.lanes|=r),$P(o.return,r,t),s.lanes|=r;break}p=p.next}}else if(o.tag===10)h=o.type===t.type?null:o.child;else if(o.tag===18){if(h=o.return,h===null)throw Error(Rt(341));h.lanes|=r,s=h.alternate,s!==null&&(s.lanes|=r),$P(h,r,t),h=o.sibling}else h=o.child;if(h!==null)h.return=o;else for(h=o;h!==null;){if(h===t){h=null;break}if(o=h.sibling,o!==null){o.return=h.return,h=o;break}h=h.return}o=h}Fs(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,fm(t,r),i=go(i),n=n(i),t.flags|=1,Fs(e,t,n,r),t.child;case 14:return n=t.type,i=Xo(n,t.pendingProps),i=Xo(n.type,i),y3(e,t,n,i,r);case 15:return gV(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Xo(n,i),$w(e,t),t.tag=1,ha(n)?(e=!0,c1(t)):e=!1,fm(t,r),fV(t,n,i),UP(t,n,i,r),WP(null,t,n,!0,e,r);case 19:return _V(e,t,r);case 22:return yV(e,t,r)}throw Error(Rt(156,t.tag))};function LV(e,t){return u6(e,t)}function Fte(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function co(e,t,r,n){return new Fte(e,t,r,n)}function mM(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ute(e){if(typeof e=="function")return mM(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ok)return 11;if(e===Rk)return 14}return 2}function ld(e,t){var r=e.alternate;return r===null?(r=co(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Vw(e,t,r,n,i,o){var h=2;if(n=e,typeof e=="function")mM(e)&&(h=1);else if(typeof e=="string")h=5;else e:switch(e){case qp:return Kh(r.children,i,o,t);case Ik:h=8,i|=8;break;case hP:return e=co(12,r,t,i|2),e.elementType=hP,e.lanes=o,e;case fP:return e=co(13,r,t,i),e.elementType=fP,e.lanes=o,e;case pP:return e=co(19,r,t,i),e.elementType=pP,e.lanes=o,e;case HU:return iE(r,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case WU:h=10;break e;case GU:h=9;break e;case Ok:h=11;break e;case Rk:h=14;break e;case Uu:h=16,n=null;break e}throw Error(Rt(130,e==null?e:typeof e,""))}return t=co(h,r,t,i),t.elementType=e,t.type=n,t.lanes=o,t}function Kh(e,t,r,n){return e=co(7,e,n,t),e.lanes=r,e}function iE(e,t,r,n){return e=co(22,e,n,t),e.elementType=HU,e.lanes=r,e.stateNode={isHidden:!1},e}function Xj(e,t,r){return e=co(6,e,null,t),e.lanes=r,e}function Kj(e,t,r){return t=co(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vte(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Aj(0),this.expirationTimes=Aj(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Aj(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function gM(e,t,r,n,i,o,h,s,p){return e=new Vte(e,t,r,s,p),t===1?(t=1,o===!0&&(t|=8)):t=0,o=co(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qk(o),e}function qte(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vp,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function BV(e){if(!e)return md;e=e._reactInternals;e:{if(yf(e)!==e||e.tag!==1)throw Error(Rt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ha(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Rt(171))}if(e.tag===1){var r=e.type;if(ha(r))return B6(e,r,t)}return t}function zV(e,t,r,n,i,o,h,s,p){return e=gM(r,n,!0,e,i,o,h,s,p),e.context=BV(null),r=e.current,n=Vs(),i=od(r),o=Pc(n,i),o.callback=t??null,sd(r,o,i),e.current.lanes=i,O0(e,i,n),fa(e,n),e}function sE(e,t,r,n){var i=t.current,o=Vs(),h=od(i);return r=BV(r),t.context===null?t.context=r:t.pendingContext=r,t=Pc(o,h),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=sd(i,t,h),e!==null&&(ll(e,i,h,o),Lw(e,i,h)),h}function w1(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function A3(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function yM(e,t){A3(e,t),(e=e.alternate)&&A3(e,t)}function Wte(){return null}var $V=typeof reportError=="function"?reportError:function(e){console.error(e)};function vM(e){this._internalRoot=e}aE.prototype.render=vM.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Rt(409));sE(e,t,null,null)};aE.prototype.unmount=vM.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;sf(function(){sE(null,e,null,null)}),t[Dc]=null}};function aE(e){this._internalRoot=e}aE.prototype.unstable_scheduleHydration=function(e){if(e){var t=y6();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Hu.length&&t!==0&&t<Hu[r].priority;r++);Hu.splice(r,0,e),r===0&&x6(e)}};function xM(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function oE(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function N3(){}function Gte(e,t,r,n,i){if(i){if(typeof n=="function"){var o=n;n=function(){var y=w1(h);o.call(y)}}var h=zV(t,n,e,0,null,!1,!1,"",N3);return e._reactRootContainer=h,e[Dc]=h.current,Nx(e.nodeType===8?e.parentNode:e),sf(),h}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var s=n;n=function(){var y=w1(p);s.call(y)}}var p=gM(e,0,!1,null,null,!1,!1,"",N3);return e._reactRootContainer=p,e[Dc]=p.current,Nx(e.nodeType===8?e.parentNode:e),sf(function(){sE(t,p,r,n)}),p}function lE(e,t,r,n,i){var o=r._reactRootContainer;if(o){var h=o;if(typeof i=="function"){var s=i;i=function(){var p=w1(h);s.call(p)}}sE(t,h,e,i)}else h=Gte(r,t,e,i,n);return w1(h)}m6=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=qv(t.pendingLanes);r!==0&&(Bk(t,r|1),fa(t,mi()),!(en&6)&&(Cm=mi()+500,Td()))}break;case 13:sf(function(){var n=Lc(e,1);if(n!==null){var i=Vs();ll(n,e,1,i)}}),yM(e,1)}};zk=function(e){if(e.tag===13){var t=Lc(e,134217728);if(t!==null){var r=Vs();ll(t,e,134217728,r)}yM(e,134217728)}};g6=function(e){if(e.tag===13){var t=od(e),r=Lc(e,t);if(r!==null){var n=Vs();ll(r,e,t,n)}yM(e,t)}};y6=function(){return wn};v6=function(e,t){var r=wn;try{return wn=e,t()}finally{wn=r}};EP=function(e,t,r){switch(t){case"input":if(yP(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=JS(n);if(!i)throw Error(Rt(90));KU(n),yP(n,i)}}}break;case"textarea":YU(e,r);break;case"select":t=r.value,t!=null&&cm(e,!!r.multiple,t,!1)}};i6=hM;s6=sf;var Hte={usingClientEntryPoint:!1,Events:[D0,Xp,JS,r6,n6,hM]},_v={findFiberByHostInstance:zh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Xte={bundleType:_v.bundleType,version:_v.version,rendererPackageName:_v.rendererPackageName,rendererConfig:_v.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zc.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=l6(e),e===null?null:e.stateNode},findFiberByHostInstance:_v.findFiberByHostInstance||Wte,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Z_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Z_.isDisabled&&Z_.supportsFiber)try{XS=Z_.inject(Xte),Dl=Z_}catch{}}za.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Hte;za.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xM(t))throw Error(Rt(200));return qte(e,t,null,r)};za.createRoot=function(e,t){if(!xM(e))throw Error(Rt(299));var r=!1,n="",i=$V;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=gM(e,1,!1,null,null,r,!1,n,i),e[Dc]=t.current,Nx(e.nodeType===8?e.parentNode:e),new vM(t)};za.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Rt(188)):(e=Object.keys(e).join(","),Error(Rt(268,e)));return e=l6(t),e=e===null?null:e.stateNode,e};za.flushSync=function(e){return sf(e)};za.hydrate=function(e,t,r){if(!oE(t))throw Error(Rt(200));return lE(null,e,t,!0,r)};za.hydrateRoot=function(e,t,r){if(!xM(e))throw Error(Rt(405));var n=r!=null&&r.hydratedSources||null,i=!1,o="",h=$V;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),t=zV(t,null,e,1,r??null,i,!1,o,h),e[Dc]=t.current,Nx(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new aE(t)};za.render=function(e,t,r){if(!oE(t))throw Error(Rt(200));return lE(null,e,t,!1,r)};za.unmountComponentAtNode=function(e){if(!oE(e))throw Error(Rt(40));return e._reactRootContainer?(sf(function(){lE(null,null,e,!1,function(){e._reactRootContainer=null,e[Dc]=null})}),!0):!1};za.unstable_batchedUpdates=hM;za.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!oE(r))throw Error(Rt(200));if(e==null||e._reactInternals===void 0)throw Error(Rt(38));return lE(e,t,r,!1,n)};za.version="18.3.1-next-f1338f8080-20240426";function FV(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(FV)}catch(e){console.error(e)}}FV(),FU.exports=za;var Yc=FU.exports;const Kte=Sn(Yc);var k3=Yc;uP.createRoot=k3.createRoot,uP.hydrateRoot=k3.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zx(){return zx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zx.apply(this,arguments)}var Qu;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Qu||(Qu={}));const M3="popstate";function Zte(e){e===void 0&&(e={});function t(n,i){let{pathname:o,search:h,hash:s}=n.location;return nA("",{pathname:o,search:h,hash:s},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:S1(i)}return Jte(t,r,null,e)}function yi(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function UV(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Yte(){return Math.random().toString(36).substr(2,8)}function I3(e,t){return{usr:e.state,key:e.key,idx:t}}function nA(e,t,r,n){return r===void 0&&(r=null),zx({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?dg(t):t,{state:r,key:t&&t.key||n||Yte()})}function S1(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function dg(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Jte(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:o=!1}=n,h=i.history,s=Qu.Pop,p=null,y=b();y==null&&(y=0,h.replaceState(zx({},h.state,{idx:y}),""));function b(){return(h.state||{idx:null}).idx}function _(){s=Qu.Pop;let O=b(),R=O==null?null:O-y;y=O,p&&p({action:s,location:N.location,delta:R})}function E(O,R){s=Qu.Push;let L=nA(N.location,O,R);r&&r(L,O),y=b()+1;let B=I3(L,y),q=N.createHref(L);try{h.pushState(B,"",q)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;i.location.assign(q)}o&&p&&p({action:s,location:N.location,delta:1})}function C(O,R){s=Qu.Replace;let L=nA(N.location,O,R);r&&r(L,O),y=b();let B=I3(L,y),q=N.createHref(L);h.replaceState(B,"",q),o&&p&&p({action:s,location:N.location,delta:0})}function k(O){let R=i.location.origin!=="null"?i.location.origin:i.location.href,L=typeof O=="string"?O:S1(O);return L=L.replace(/ $/,"%20"),yi(R,"No window.location.(origin|href) available to create URL for href: "+L),new URL(L,R)}let N={get action(){return s},get location(){return e(i,h)},listen(O){if(p)throw new Error("A history only accepts one active listener");return i.addEventListener(M3,_),p=O,()=>{i.removeEventListener(M3,_),p=null}},createHref(O){return t(i,O)},createURL:k,encodeLocation(O){let R=k(O);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:E,replace:C,go(O){return h.go(O)}};return N}var O3;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(O3||(O3={}));function Qte(e,t,r){return r===void 0&&(r="/"),ere(e,t,r,!1)}function ere(e,t,r,n){let i=typeof t=="string"?dg(t):t,o=bM(i.pathname||"/",r);if(o==null)return null;let h=VV(e);tre(h);let s=null;for(let p=0;s==null&&p<h.length;++p){let y=hre(o);s=ure(h[p],y,n)}return s}function VV(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(o,h,s)=>{let p={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:h,route:o};p.relativePath.startsWith("/")&&(yi(p.relativePath.startsWith(n),'Absolute route path "'+p.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),p.relativePath=p.relativePath.slice(n.length));let y=cd([n,p.relativePath]),b=r.concat(p);o.children&&o.children.length>0&&(yi(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),VV(o.children,t,b,y)),!(o.path==null&&!o.index)&&t.push({path:y,score:lre(y,o.index),routesMeta:b})};return e.forEach((o,h)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))i(o,h);else for(let p of qV(o.path))i(o,h,p)}),t}function qV(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return i?[o,""]:[o];let h=qV(n.join("/")),s=[];return s.push(...h.map(p=>p===""?o:[o,p].join("/"))),i&&s.push(...h),s.map(p=>e.startsWith("/")&&p===""?"/":p)}function tre(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:cre(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const rre=/^:[\w-]+$/,nre=3,ire=2,sre=1,are=10,ore=-2,R3=e=>e==="*";function lre(e,t){let r=e.split("/"),n=r.length;return r.some(R3)&&(n+=ore),t&&(n+=ire),r.filter(i=>!R3(i)).reduce((i,o)=>i+(rre.test(o)?nre:o===""?sre:are),n)}function cre(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function ure(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,i={},o="/",h=[];for(let s=0;s<n.length;++s){let p=n[s],y=s===n.length-1,b=o==="/"?t:t.slice(o.length)||"/",_=D3({path:p.relativePath,caseSensitive:p.caseSensitive,end:y},b),E=p.route;if(!_&&y&&r&&!n[n.length-1].route.index&&(_=D3({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},b)),!_)return null;Object.assign(i,_.params),h.push({params:i,pathname:cd([o,_.pathname]),pathnameBase:gre(cd([o,_.pathnameBase])),route:E}),_.pathnameBase!=="/"&&(o=cd([o,_.pathnameBase]))}return h}function D3(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=dre(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let o=i[0],h=o.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:n.reduce((y,b,_)=>{let{paramName:E,isOptional:C}=b;if(E==="*"){let N=s[_]||"";h=o.slice(0,o.length-N.length).replace(/(.)\/+$/,"$1")}const k=s[_];return C&&!k?y[E]=void 0:y[E]=(k||"").replace(/%2F/g,"/"),y},{}),pathname:o,pathnameBase:h,pattern:e}}function dre(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),UV(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,s,p)=>(n.push({paramName:s,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function hre(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return UV(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function bM(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function fre(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?dg(e):e;return{pathname:r?r.startsWith("/")?r:pre(r,t):t,search:yre(n),hash:vre(i)}}function pre(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Zj(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function mre(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function _M(e,t){let r=mre(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function wM(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=dg(e):(i=zx({},e),yi(!i.pathname||!i.pathname.includes("?"),Zj("?","pathname","search",i)),yi(!i.pathname||!i.pathname.includes("#"),Zj("#","pathname","hash",i)),yi(!i.search||!i.search.includes("#"),Zj("#","search","hash",i)));let o=e===""||i.pathname==="",h=o?"/":i.pathname,s;if(h==null)s=r;else{let _=t.length-1;if(!n&&h.startsWith("..")){let E=h.split("/");for(;E[0]==="..";)E.shift(),_-=1;i.pathname=E.join("/")}s=_>=0?t[_]:"/"}let p=fre(i,s),y=h&&h!=="/"&&h.endsWith("/"),b=(o||h===".")&&r.endsWith("/");return!p.pathname.endsWith("/")&&(y||b)&&(p.pathname+="/"),p}const cd=e=>e.join("/").replace(/\/\/+/g,"/"),gre=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),yre=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,vre=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function xre(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const WV=["post","put","patch","delete"];new Set(WV);const bre=["get",...WV];new Set(bre);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $x(){return $x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$x.apply(this,arguments)}const SM=I.createContext(null),_re=I.createContext(null),jd=I.createContext(null),cE=I.createContext(null),Jc=I.createContext({outlet:null,matches:[],isDataRoute:!1}),GV=I.createContext(null);function wre(e,t){let{relative:r}=t===void 0?{}:t;hg()||yi(!1);let{basename:n,navigator:i}=I.useContext(jd),{hash:o,pathname:h,search:s}=XV(e,{relative:r}),p=h;return n!=="/"&&(p=h==="/"?n:cd([n,h])),i.createHref({pathname:p,search:s,hash:o})}function hg(){return I.useContext(cE)!=null}function Gl(){return hg()||yi(!1),I.useContext(cE).location}function HV(e){I.useContext(jd).static||I.useLayoutEffect(e)}function ts(){let{isDataRoute:e}=I.useContext(Jc);return e?Rre():Sre()}function Sre(){hg()||yi(!1);let e=I.useContext(SM),{basename:t,future:r,navigator:n}=I.useContext(jd),{matches:i}=I.useContext(Jc),{pathname:o}=Gl(),h=JSON.stringify(_M(i,r.v7_relativeSplatPath)),s=I.useRef(!1);return HV(()=>{s.current=!0}),I.useCallback(function(y,b){if(b===void 0&&(b={}),!s.current)return;if(typeof y=="number"){n.go(y);return}let _=wM(y,JSON.parse(h),o,b.relative==="path");e==null&&t!=="/"&&(_.pathname=_.pathname==="/"?t:cd([t,_.pathname])),(b.replace?n.replace:n.push)(_,b.state,b)},[t,n,h,o,e])}function uE(){let{matches:e}=I.useContext(Jc),t=e[e.length-1];return t?t.params:{}}function XV(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=I.useContext(jd),{matches:i}=I.useContext(Jc),{pathname:o}=Gl(),h=JSON.stringify(_M(i,n.v7_relativeSplatPath));return I.useMemo(()=>wM(e,JSON.parse(h),o,r==="path"),[e,h,o,r])}function Ere(e,t){return Tre(e,t)}function Tre(e,t,r,n){hg()||yi(!1);let{navigator:i}=I.useContext(jd),{matches:o}=I.useContext(Jc),h=o[o.length-1],s=h?h.params:{};h&&h.pathname;let p=h?h.pathnameBase:"/";h&&h.route;let y=Gl(),b;if(t){var _;let O=typeof t=="string"?dg(t):t;p==="/"||(_=O.pathname)!=null&&_.startsWith(p)||yi(!1),b=O}else b=y;let E=b.pathname||"/",C=E;if(p!=="/"){let O=p.replace(/^\//,"").split("/");C="/"+E.replace(/^\//,"").split("/").slice(O.length).join("/")}let k=Qte(e,{pathname:C}),N=Nre(k&&k.map(O=>Object.assign({},O,{params:Object.assign({},s,O.params),pathname:cd([p,i.encodeLocation?i.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?p:cd([p,i.encodeLocation?i.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),o,r,n);return t&&N?I.createElement(cE.Provider,{value:{location:$x({pathname:"/",search:"",hash:"",state:null,key:"default"},b),navigationType:Qu.Pop}},N):N}function jre(){let e=Ore(),t=xre(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},o=null;return I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},t),r?I.createElement("pre",{style:i},r):null,o)}const Cre=I.createElement(jre,null);class Pre extends I.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?I.createElement(Jc.Provider,{value:this.props.routeContext},I.createElement(GV.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Are(e){let{routeContext:t,match:r,children:n}=e,i=I.useContext(SM);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),I.createElement(Jc.Provider,{value:t},n)}function Nre(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var o;if(!r)return null;if(r.errors)e=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let h=e,s=(i=r)==null?void 0:i.errors;if(s!=null){let b=h.findIndex(_=>_.route.id&&(s==null?void 0:s[_.route.id])!==void 0);b>=0||yi(!1),h=h.slice(0,Math.min(h.length,b+1))}let p=!1,y=-1;if(r&&n&&n.v7_partialHydration)for(let b=0;b<h.length;b++){let _=h[b];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(y=b),_.route.id){let{loaderData:E,errors:C}=r,k=_.route.loader&&E[_.route.id]===void 0&&(!C||C[_.route.id]===void 0);if(_.route.lazy||k){p=!0,y>=0?h=h.slice(0,y+1):h=[h[0]];break}}}return h.reduceRight((b,_,E)=>{let C,k=!1,N=null,O=null;r&&(C=s&&_.route.id?s[_.route.id]:void 0,N=_.route.errorElement||Cre,p&&(y<0&&E===0?(Dre("route-fallback",!1),k=!0,O=null):y===E&&(k=!0,O=_.route.hydrateFallbackElement||null)));let R=t.concat(h.slice(0,E+1)),L=()=>{let B;return C?B=N:k?B=O:_.route.Component?B=I.createElement(_.route.Component,null):_.route.element?B=_.route.element:B=b,I.createElement(Are,{match:_,routeContext:{outlet:b,matches:R,isDataRoute:r!=null},children:B})};return r&&(_.route.ErrorBoundary||_.route.errorElement||E===0)?I.createElement(Pre,{location:r.location,revalidation:r.revalidation,component:N,error:C,children:L(),routeContext:{outlet:null,matches:R,isDataRoute:!0}}):L()},null)}var KV=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(KV||{}),E1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(E1||{});function kre(e){let t=I.useContext(SM);return t||yi(!1),t}function Mre(e){let t=I.useContext(_re);return t||yi(!1),t}function Ire(e){let t=I.useContext(Jc);return t||yi(!1),t}function ZV(e){let t=Ire(),r=t.matches[t.matches.length-1];return r.route.id||yi(!1),r.route.id}function Ore(){var e;let t=I.useContext(GV),r=Mre(E1.UseRouteError),n=ZV(E1.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Rre(){let{router:e}=kre(KV.UseNavigateStable),t=ZV(E1.UseNavigateStable),r=I.useRef(!1);return HV(()=>{r.current=!0}),I.useCallback(function(i,o){o===void 0&&(o={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,$x({fromRouteId:t},o)))},[e,t])}const L3={};function Dre(e,t,r){!t&&!L3[e]&&(L3[e]=!0)}function Lre(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function Bre(e){let{to:t,replace:r,state:n,relative:i}=e;hg()||yi(!1);let{future:o,static:h}=I.useContext(jd),{matches:s}=I.useContext(Jc),{pathname:p}=Gl(),y=ts(),b=wM(t,_M(s,o.v7_relativeSplatPath),p,i==="path"),_=JSON.stringify(b);return I.useEffect(()=>y(JSON.parse(_),{replace:r,state:n,relative:i}),[y,_,i,r,n]),null}function Ir(e){yi(!1)}function zre(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Qu.Pop,navigator:o,static:h=!1,future:s}=e;hg()&&yi(!1);let p=t.replace(/^\/*/,"/"),y=I.useMemo(()=>({basename:p,navigator:o,static:h,future:$x({v7_relativeSplatPath:!1},s)}),[p,s,o,h]);typeof n=="string"&&(n=dg(n));let{pathname:b="/",search:_="",hash:E="",state:C=null,key:k="default"}=n,N=I.useMemo(()=>{let O=bM(b,p);return O==null?null:{location:{pathname:O,search:_,hash:E,state:C,key:k},navigationType:i}},[p,b,_,E,C,k,i]);return N==null?null:I.createElement(jd.Provider,{value:y},I.createElement(cE.Provider,{children:r,value:N}))}function $re(e){let{children:t,location:r}=e;return Ere(iA(t),r)}new Promise(()=>{});function iA(e,t){t===void 0&&(t=[]);let r=[];return I.Children.forEach(e,(n,i)=>{if(!I.isValidElement(n))return;let o=[...t,i];if(n.type===I.Fragment){r.push.apply(r,iA(n.props.children,o));return}n.type!==Ir&&yi(!1),!n.props.index||!n.props.children||yi(!1);let h={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(h.children=iA(n.props.children,o)),r.push(h)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sA(){return sA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sA.apply(this,arguments)}function Fre(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Ure(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Vre(e,t){return e.button===0&&(!t||t==="_self")&&!Ure(e)}function aA(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function qre(e,t){let r=aA(e);return t&&t.forEach((n,i)=>{r.has(i)||t.getAll(i).forEach(o=>{r.append(i,o)})}),r}const Wre=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Gre="6";try{window.__reactRouterVersion=Gre}catch{}const Hre="startTransition",B3=Ak[Hre];function Xre(e){let{basename:t,children:r,future:n,window:i}=e,o=I.useRef();o.current==null&&(o.current=Zte({window:i,v5Compat:!0}));let h=o.current,[s,p]=I.useState({action:h.action,location:h.location}),{v7_startTransition:y}=n||{},b=I.useCallback(_=>{y&&B3?B3(()=>p(_)):p(_)},[p,y]);return I.useLayoutEffect(()=>h.listen(b),[h,b]),I.useEffect(()=>Lre(n),[n]),I.createElement(zre,{basename:t,children:r,location:s.location,navigationType:s.action,navigator:h,future:n})}const Kre=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Zre=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Nn=I.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:o,replace:h,state:s,target:p,to:y,preventScrollReset:b,viewTransition:_}=t,E=Fre(t,Wre),{basename:C}=I.useContext(jd),k,N=!1;if(typeof y=="string"&&Zre.test(y)&&(k=y,Kre))try{let B=new URL(window.location.href),q=y.startsWith("//")?new URL(B.protocol+y):new URL(y),F=bM(q.pathname,C);q.origin===B.origin&&F!=null?y=F+q.search+q.hash:N=!0}catch{}let O=wre(y,{relative:i}),R=Yre(y,{replace:h,state:s,target:p,preventScrollReset:b,relative:i,viewTransition:_});function L(B){n&&n(B),B.defaultPrevented||R(B)}return I.createElement("a",sA({},E,{href:k||O,onClick:N||o?n:L,ref:r,target:p}))});var z3;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(z3||(z3={}));var $3;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})($3||($3={}));function Yre(e,t){let{target:r,replace:n,state:i,preventScrollReset:o,relative:h,viewTransition:s}=t===void 0?{}:t,p=ts(),y=Gl(),b=XV(e,{relative:h});return I.useCallback(_=>{if(Vre(_,r)){_.preventDefault();let E=n!==void 0?n:S1(y)===S1(b);p(e,{replace:E,state:i,preventScrollReset:o,relative:h,viewTransition:s})}},[y,p,b,n,i,r,e,o,h,s])}function EM(e){let t=I.useRef(aA(e)),r=I.useRef(!1),n=Gl(),i=I.useMemo(()=>qre(n.search,r.current?null:t.current),[n.search]),o=ts(),h=I.useCallback((s,p)=>{const y=aA(typeof s=="function"?s(i):s);r.current=!0,o("?"+y,p)},[o,i]);return[i,h]}function YV(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=YV(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Jr(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=YV(e))&&(n&&(n+=" "),n+=t);return n}function Jre(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=JV(t))&&(n&&(n+=" "),n+=r);return n}function JV(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=JV(e[n]))&&(r&&(r+=" "),r+=t);return r}var TM="-";function Qre(e){var t=tne(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,i=n===void 0?{}:n;function o(s){var p=s.split(TM);return p[0]===""&&p.length!==1&&p.shift(),QV(p,t)||ene(s)}function h(s,p){var y=r[s]||[];return p&&i[s]?[].concat(y,i[s]):y}return{getClassGroupId:o,getConflictingClassGroupIds:h}}function QV(e,t){var h;if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),i=n?QV(e.slice(1),n):void 0;if(i)return i;if(t.validators.length!==0){var o=e.join(TM);return(h=t.validators.find(function(s){var p=s.validator;return p(o)}))==null?void 0:h.classGroupId}}var F3=/^\[(.+)\]$/;function ene(e){if(F3.test(e)){var t=F3.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function tne(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},i=nne(Object.entries(e.classGroups),r);return i.forEach(function(o){var h=o[0],s=o[1];oA(s,n,h,t)}),n}function oA(e,t,r,n){e.forEach(function(i){if(typeof i=="string"){var o=i===""?t:U3(t,i);o.classGroupId=r;return}if(typeof i=="function"){if(rne(i)){oA(i(n),t,r,n);return}t.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(function(h){var s=h[0],p=h[1];oA(p,U3(t,s),r,n)})})}function U3(e,t){var r=e;return t.split(TM).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function rne(e){return e.isThemeGetter}function nne(e,t){return t?e.map(function(r){var n=r[0],i=r[1],o=i.map(function(h){return typeof h=="string"?t+h:typeof h=="object"?Object.fromEntries(Object.entries(h).map(function(s){var p=s[0],y=s[1];return[t+p,y]})):h});return[n,o]}):e}function ine(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function i(o,h){r.set(o,h),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(h){var s=r.get(h);if(s!==void 0)return s;if((s=n.get(h))!==void 0)return i(h,s),s},set:function(h,s){r.has(h)?r.set(h,s):i(h,s)}}}var e8="!";function sne(e){var t=e.separator||":",r=t.length===1,n=t[0],i=t.length;return function(h){for(var s=[],p=0,y=0,b,_=0;_<h.length;_++){var E=h[_];if(p===0){if(E===n&&(r||h.slice(_,_+i)===t)){s.push(h.slice(y,_)),y=_+i;continue}if(E==="/"){b=_;continue}}E==="["?p++:E==="]"&&p--}var C=s.length===0?h:h.substring(y),k=C.startsWith(e8),N=k?C.substring(1):C,O=b&&b>y?b-y:void 0;return{modifiers:s,hasImportantModifier:k,baseClassName:N,maybePostfixModifierPosition:O}}}function ane(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var i=n[0]==="[";i?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function one(e){return{cache:ine(e.cacheSize),splitModifiers:sne(e),...Qre(e)}}var lne=/\s+/;function cne(e,t){var r=t.splitModifiers,n=t.getClassGroupId,i=t.getConflictingClassGroupIds,o=new Set;return e.trim().split(lne).map(function(h){var s=r(h),p=s.modifiers,y=s.hasImportantModifier,b=s.baseClassName,_=s.maybePostfixModifierPosition,E=n(_?b.substring(0,_):b),C=!!_;if(!E){if(!_)return{isTailwindClass:!1,originalClassName:h};if(E=n(b),!E)return{isTailwindClass:!1,originalClassName:h};C=!1}var k=ane(p).join(":"),N=y?k+e8:k;return{isTailwindClass:!0,modifierId:N,classGroupId:E,originalClassName:h,hasPostfixModifier:C}}).reverse().filter(function(h){if(!h.isTailwindClass)return!0;var s=h.modifierId,p=h.classGroupId,y=h.hasPostfixModifier,b=s+p;return o.has(b)?!1:(o.add(b),i(p,y).forEach(function(_){return o.add(s+_)}),!0)}).reverse().map(function(h){return h.originalClassName}).join(" ")}function une(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i,o,h=s;function s(y){var b=t[0],_=t.slice(1),E=_.reduce(function(C,k){return k(C)},b());return n=one(E),i=n.cache.get,o=n.cache.set,h=p,p(y)}function p(y){var b=i(y);if(b)return b;var _=cne(y,n);return o(y,_),_}return function(){return h(Jre.apply(null,arguments))}}function Fn(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var t8=/^\[(?:([a-z-]+):)?(.+)\]$/i,dne=/^\d+\/\d+$/,hne=new Set(["px","full","screen"]),fne=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,pne=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,mne=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function qo(e){return Uh(e)||hne.has(e)||dne.test(e)||lA(e)}function lA(e){return vf(e,"length",_ne)}function gne(e){return vf(e,"size",r8)}function yne(e){return vf(e,"position",r8)}function vne(e){return vf(e,"url",wne)}function Y_(e){return vf(e,"number",Uh)}function Uh(e){return!Number.isNaN(Number(e))}function xne(e){return e.endsWith("%")&&Uh(e.slice(0,-1))}function wv(e){return V3(e)||vf(e,"number",V3)}function Gr(e){return t8.test(e)}function Sv(){return!0}function Ou(e){return fne.test(e)}function bne(e){return vf(e,"",Sne)}function vf(e,t,r){var n=t8.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function _ne(e){return pne.test(e)}function r8(){return!1}function wne(e){return e.startsWith("url(")}function V3(e){return Number.isInteger(Number(e))}function Sne(e){return mne.test(e)}function Ene(){var e=Fn("colors"),t=Fn("spacing"),r=Fn("blur"),n=Fn("brightness"),i=Fn("borderColor"),o=Fn("borderRadius"),h=Fn("borderSpacing"),s=Fn("borderWidth"),p=Fn("contrast"),y=Fn("grayscale"),b=Fn("hueRotate"),_=Fn("invert"),E=Fn("gap"),C=Fn("gradientColorStops"),k=Fn("gradientColorStopPositions"),N=Fn("inset"),O=Fn("margin"),R=Fn("opacity"),L=Fn("padding"),B=Fn("saturate"),q=Fn("scale"),F=Fn("sepia"),H=Fn("skew"),Z=Fn("space"),re=Fn("translate"),W=function(){return["auto","contain","none"]},te=function(){return["auto","hidden","clip","visible","scroll"]},oe=function(){return["auto",Gr,t]},ie=function(){return[Gr,t]},ue=function(){return["",qo]},_e=function(){return["auto",Uh,Gr]},xe=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},be=function(){return["solid","dashed","dotted","double","none"]},Ae=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},me=function(){return["start","end","center","between","around","evenly","stretch"]},ke=function(){return["","0",Gr]},Ne=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},Be=function(){return[Uh,Y_]},We=function(){return[Uh,Gr]};return{cacheSize:500,theme:{colors:[Sv],spacing:[qo],blur:["none","",Ou,Gr],brightness:Be(),borderColor:[e],borderRadius:["none","","full",Ou,Gr],borderSpacing:ie(),borderWidth:ue(),contrast:Be(),grayscale:ke(),hueRotate:We(),invert:ke(),gap:ie(),gradientColorStops:[e],gradientColorStopPositions:[xne,lA],inset:oe(),margin:oe(),opacity:Be(),padding:ie(),saturate:Be(),scale:Be(),sepia:ke(),skew:We(),space:ie(),translate:ie()},classGroups:{aspect:[{aspect:["auto","square","video",Gr]}],container:["container"],columns:[{columns:[Ou]}],"break-after":[{"break-after":Ne()}],"break-before":[{"break-before":Ne()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(xe(),[Gr])}],overflow:[{overflow:te()}],"overflow-x":[{"overflow-x":te()}],"overflow-y":[{"overflow-y":te()}],overscroll:[{overscroll:W()}],"overscroll-x":[{"overscroll-x":W()}],"overscroll-y":[{"overscroll-y":W()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[N]}],"inset-x":[{"inset-x":[N]}],"inset-y":[{"inset-y":[N]}],start:[{start:[N]}],end:[{end:[N]}],top:[{top:[N]}],right:[{right:[N]}],bottom:[{bottom:[N]}],left:[{left:[N]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",wv]}],basis:[{basis:oe()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Gr]}],grow:[{grow:ke()}],shrink:[{shrink:ke()}],order:[{order:["first","last","none",wv]}],"grid-cols":[{"grid-cols":[Sv]}],"col-start-end":[{col:["auto",{span:["full",wv]},Gr]}],"col-start":[{"col-start":_e()}],"col-end":[{"col-end":_e()}],"grid-rows":[{"grid-rows":[Sv]}],"row-start-end":[{row:["auto",{span:[wv]},Gr]}],"row-start":[{"row-start":_e()}],"row-end":[{"row-end":_e()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Gr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Gr]}],gap:[{gap:[E]}],"gap-x":[{"gap-x":[E]}],"gap-y":[{"gap-y":[E]}],"justify-content":[{justify:["normal"].concat(me())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(me(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(me(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[L]}],px:[{px:[L]}],py:[{py:[L]}],ps:[{ps:[L]}],pe:[{pe:[L]}],pt:[{pt:[L]}],pr:[{pr:[L]}],pb:[{pb:[L]}],pl:[{pl:[L]}],m:[{m:[O]}],mx:[{mx:[O]}],my:[{my:[O]}],ms:[{ms:[O]}],me:[{me:[O]}],mt:[{mt:[O]}],mr:[{mr:[O]}],mb:[{mb:[O]}],ml:[{ml:[O]}],"space-x":[{"space-x":[Z]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Z]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Gr,t]}],"min-w":[{"min-w":["min","max","fit",Gr,qo]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Ou]},Ou,Gr]}],h:[{h:[Gr,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Gr,qo]}],"max-h":[{"max-h":[Gr,t,"min","max","fit"]}],"font-size":[{text:["base",Ou,lA]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Y_]}],"font-family":[{font:[Sv]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Gr]}],"line-clamp":[{"line-clamp":["none",Uh,Y_]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Gr,qo]}],"list-image":[{"list-image":["none",Gr]}],"list-style-type":[{list:["none","disc","decimal",Gr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[R]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[R]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(be(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",qo]}],"underline-offset":[{"underline-offset":["auto",Gr,qo]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:ie()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Gr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Gr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[R]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(xe(),[yne])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",gne]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},vne]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[k]}],"gradient-via-pos":[{via:[k]}],"gradient-to-pos":[{to:[k]}],"gradient-from":[{from:[C]}],"gradient-via":[{via:[C]}],"gradient-to":[{to:[C]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[R]}],"border-style":[{border:[].concat(be(),["hidden"])}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[R]}],"divide-style":[{divide:be()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:[""].concat(be())}],"outline-offset":[{"outline-offset":[Gr,qo]}],"outline-w":[{outline:[qo]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:ue()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[R]}],"ring-offset-w":[{"ring-offset":[qo]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ou,bne]}],"shadow-color":[{shadow:[Sv]}],opacity:[{opacity:[R]}],"mix-blend":[{"mix-blend":Ae()}],"bg-blend":[{"bg-blend":Ae()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[p]}],"drop-shadow":[{"drop-shadow":["","none",Ou,Gr]}],grayscale:[{grayscale:[y]}],"hue-rotate":[{"hue-rotate":[b]}],invert:[{invert:[_]}],saturate:[{saturate:[B]}],sepia:[{sepia:[F]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[p]}],"backdrop-grayscale":[{"backdrop-grayscale":[y]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[b]}],"backdrop-invert":[{"backdrop-invert":[_]}],"backdrop-opacity":[{"backdrop-opacity":[R]}],"backdrop-saturate":[{"backdrop-saturate":[B]}],"backdrop-sepia":[{"backdrop-sepia":[F]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Gr]}],duration:[{duration:We()}],ease:[{ease:["linear","in","out","in-out",Gr]}],delay:[{delay:We()}],animate:[{animate:["none","spin","ping","pulse","bounce",Gr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[q]}],"scale-x":[{"scale-x":[q]}],"scale-y":[{"scale-y":[q]}],rotate:[{rotate:[wv,Gr]}],"translate-x":[{"translate-x":[re]}],"translate-y":[{"translate-y":[re]}],"skew-x":[{"skew-x":[H]}],"skew-y":[{"skew-y":[H]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Gr]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Gr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ie()}],"scroll-mx":[{"scroll-mx":ie()}],"scroll-my":[{"scroll-my":ie()}],"scroll-ms":[{"scroll-ms":ie()}],"scroll-me":[{"scroll-me":ie()}],"scroll-mt":[{"scroll-mt":ie()}],"scroll-mr":[{"scroll-mr":ie()}],"scroll-mb":[{"scroll-mb":ie()}],"scroll-ml":[{"scroll-ml":ie()}],"scroll-p":[{"scroll-p":ie()}],"scroll-px":[{"scroll-px":ie()}],"scroll-py":[{"scroll-py":ie()}],"scroll-ps":[{"scroll-ps":ie()}],"scroll-pe":[{"scroll-pe":ie()}],"scroll-pt":[{"scroll-pt":ie()}],"scroll-pr":[{"scroll-pr":ie()}],"scroll-pb":[{"scroll-pb":ie()}],"scroll-pl":[{"scroll-pl":ie()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Gr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[qo,Y_]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var Tne=une(Ene);function Pr(...e){return Tne(Jr(e))}function Zt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(i){if(e==null||e(i),r===!1||!i.defaultPrevented)return t==null?void 0:t(i)}}function q3(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function dE(...e){return t=>{let r=!1;const n=e.map(i=>{const o=q3(i,t);return!r&&typeof o=="function"&&(r=!0),o});if(r)return()=>{for(let i=0;i<n.length;i++){const o=n[i];typeof o=="function"?o():q3(e[i],null)}}}}function Qr(...e){return I.useCallback(dE(...e),e)}function jne(e,t){const r=I.createContext(t),n=o=>{const{children:h,...s}=o,p=I.useMemo(()=>s,Object.values(s));return l.jsx(r.Provider,{value:p,children:h})};n.displayName=e+"Provider";function i(o){const h=I.useContext(r);if(h)return h;if(t!==void 0)return t;throw new Error(`\`${o}\` must be used within \`${e}\``)}return[n,i]}function xo(e,t=[]){let r=[];function n(o,h){const s=I.createContext(h),p=r.length;r=[...r,h];const y=_=>{var R;const{scope:E,children:C,...k}=_,N=((R=E==null?void 0:E[e])==null?void 0:R[p])||s,O=I.useMemo(()=>k,Object.values(k));return l.jsx(N.Provider,{value:O,children:C})};y.displayName=o+"Provider";function b(_,E){var N;const C=((N=E==null?void 0:E[e])==null?void 0:N[p])||s,k=I.useContext(C);if(k)return k;if(h!==void 0)return h;throw new Error(`\`${_}\` must be used within \`${o}\``)}return[y,b]}const i=()=>{const o=r.map(h=>I.createContext(h));return function(s){const p=(s==null?void 0:s[e])||o;return I.useMemo(()=>({[`__scope${e}`]:{...s,[e]:p}}),[s,p])}};return i.scopeName=e,[n,Cne(i,...t)]}function Cne(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const h=n.reduce((s,{useScope:p,scopeName:y})=>{const _=p(o)[`__scope${y}`];return{...s,..._}},{});return I.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}function af(e){const t=Ane(e),r=I.forwardRef((n,i)=>{const{children:o,...h}=n,s=I.Children.toArray(o),p=s.find(kne);if(p){const y=p.props.children,b=s.map(_=>_===p?I.Children.count(y)>1?I.Children.only(null):I.isValidElement(y)?y.props.children:null:_);return l.jsx(t,{...h,ref:i,children:I.isValidElement(y)?I.cloneElement(y,void 0,b):null})}return l.jsx(t,{...h,ref:i,children:o})});return r.displayName=`${e}.Slot`,r}var Pne=af("Slot");function Ane(e){const t=I.forwardRef((r,n)=>{const{children:i,...o}=r;if(I.isValidElement(i)){const h=Ine(i),s=Mne(o,i.props);return i.type!==I.Fragment&&(s.ref=n?dE(n,h):h),I.cloneElement(i,s)}return I.Children.count(i)>1?I.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Nne=Symbol("radix.slottable");function kne(e){return I.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Nne}function Mne(e,t){const r={...t};for(const n in t){const i=e[n],o=t[n];/^on[A-Z]/.test(n)?i&&o?r[n]=(...s)=>{const p=o(...s);return i(...s),p}:i&&(r[n]=i):n==="style"?r[n]={...i,...o}:n==="className"&&(r[n]=[i,o].filter(Boolean).join(" "))}return{...e,...r}}function Ine(e){var n,i;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function hE(e){const t=e+"CollectionProvider",[r,n]=xo(t),[i,o]=r(t,{collectionRef:{current:null},itemMap:new Map}),h=N=>{const{scope:O,children:R}=N,L=je.useRef(null),B=je.useRef(new Map).current;return l.jsx(i,{scope:O,itemMap:B,collectionRef:L,children:R})};h.displayName=t;const s=e+"CollectionSlot",p=af(s),y=je.forwardRef((N,O)=>{const{scope:R,children:L}=N,B=o(s,R),q=Qr(O,B.collectionRef);return l.jsx(p,{ref:q,children:L})});y.displayName=s;const b=e+"CollectionItemSlot",_="data-radix-collection-item",E=af(b),C=je.forwardRef((N,O)=>{const{scope:R,children:L,...B}=N,q=je.useRef(null),F=Qr(O,q),H=o(b,R);return je.useEffect(()=>(H.itemMap.set(q,{ref:q,...B}),()=>void H.itemMap.delete(q))),l.jsx(E,{[_]:"",ref:F,children:L})});C.displayName=b;function k(N){const O=o(e+"CollectionConsumer",N);return je.useCallback(()=>{const L=O.collectionRef.current;if(!L)return[];const B=Array.from(L.querySelectorAll(`[${_}]`));return Array.from(O.itemMap.values()).sort((H,Z)=>B.indexOf(H.ref.current)-B.indexOf(Z.ref.current))},[O.collectionRef,O.itemMap])}return[{Provider:h,Slot:y,ItemSlot:C},k,n]}var One=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],fr=One.reduce((e,t)=>{const r=af(`Primitive.${t}`),n=I.forwardRef((i,o)=>{const{asChild:h,...s}=i,p=h?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),l.jsx(p,{...s,ref:o})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function jM(e,t){e&&Yc.flushSync(()=>e.dispatchEvent(t))}function pa(e){const t=I.useRef(e);return I.useEffect(()=>{t.current=e}),I.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Rne(e,t=globalThis==null?void 0:globalThis.document){const r=pa(e);I.useEffect(()=>{const n=i=>{i.key==="Escape"&&r(i)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var Dne="DismissableLayer",cA="dismissableLayer.update",Lne="dismissableLayer.pointerDownOutside",Bne="dismissableLayer.focusOutside",W3,n8=I.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),B0=I.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:h,onDismiss:s,...p}=e,y=I.useContext(n8),[b,_]=I.useState(null),E=(b==null?void 0:b.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,C]=I.useState({}),k=Qr(t,Z=>_(Z)),N=Array.from(y.layers),[O]=[...y.layersWithOutsidePointerEventsDisabled].slice(-1),R=N.indexOf(O),L=b?N.indexOf(b):-1,B=y.layersWithOutsidePointerEventsDisabled.size>0,q=L>=R,F=$ne(Z=>{const re=Z.target,W=[...y.branches].some(te=>te.contains(re));!q||W||(i==null||i(Z),h==null||h(Z),Z.defaultPrevented||s==null||s())},E),H=Fne(Z=>{const re=Z.target;[...y.branches].some(te=>te.contains(re))||(o==null||o(Z),h==null||h(Z),Z.defaultPrevented||s==null||s())},E);return Rne(Z=>{L===y.layers.size-1&&(n==null||n(Z),!Z.defaultPrevented&&s&&(Z.preventDefault(),s()))},E),I.useEffect(()=>{if(b)return r&&(y.layersWithOutsidePointerEventsDisabled.size===0&&(W3=E.body.style.pointerEvents,E.body.style.pointerEvents="none"),y.layersWithOutsidePointerEventsDisabled.add(b)),y.layers.add(b),G3(),()=>{r&&y.layersWithOutsidePointerEventsDisabled.size===1&&(E.body.style.pointerEvents=W3)}},[b,E,r,y]),I.useEffect(()=>()=>{b&&(y.layers.delete(b),y.layersWithOutsidePointerEventsDisabled.delete(b),G3())},[b,y]),I.useEffect(()=>{const Z=()=>C({});return document.addEventListener(cA,Z),()=>document.removeEventListener(cA,Z)},[]),l.jsx(fr.div,{...p,ref:k,style:{pointerEvents:B?q?"auto":"none":void 0,...e.style},onFocusCapture:Zt(e.onFocusCapture,H.onFocusCapture),onBlurCapture:Zt(e.onBlurCapture,H.onBlurCapture),onPointerDownCapture:Zt(e.onPointerDownCapture,F.onPointerDownCapture)})});B0.displayName=Dne;var zne="DismissableLayerBranch",i8=I.forwardRef((e,t)=>{const r=I.useContext(n8),n=I.useRef(null),i=Qr(t,n);return I.useEffect(()=>{const o=n.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),l.jsx(fr.div,{...e,ref:i})});i8.displayName=zne;function $ne(e,t=globalThis==null?void 0:globalThis.document){const r=pa(e),n=I.useRef(!1),i=I.useRef(()=>{});return I.useEffect(()=>{const o=s=>{if(s.target&&!n.current){let p=function(){s8(Lne,r,y,{discrete:!0})};const y={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=p,t.addEventListener("click",i.current,{once:!0})):p()}else t.removeEventListener("click",i.current);n.current=!1},h=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(h),t.removeEventListener("pointerdown",o),t.removeEventListener("click",i.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function Fne(e,t=globalThis==null?void 0:globalThis.document){const r=pa(e),n=I.useRef(!1);return I.useEffect(()=>{const i=o=>{o.target&&!n.current&&s8(Bne,r,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function G3(){const e=new CustomEvent(cA);document.dispatchEvent(e)}function s8(e,t,r,{discrete:n}){const i=r.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?jM(i,o):i.dispatchEvent(o)}var Une=B0,Vne=i8,ps=globalThis!=null&&globalThis.document?I.useLayoutEffect:()=>{},qne="Portal",fE=I.forwardRef((e,t)=>{var s;const{container:r,...n}=e,[i,o]=I.useState(!1);ps(()=>o(!0),[]);const h=r||i&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return h?Kte.createPortal(l.jsx(fr.div,{...n,ref:t}),h):null});fE.displayName=qne;function Wne(e,t){return I.useReducer((r,n)=>t[r][n]??r,e)}var Hl=e=>{const{present:t,children:r}=e,n=Gne(t),i=typeof r=="function"?r({present:n.isPresent}):I.Children.only(r),o=Qr(n.ref,Hne(i));return typeof r=="function"||n.isPresent?I.cloneElement(i,{ref:o}):null};Hl.displayName="Presence";function Gne(e){const[t,r]=I.useState(),n=I.useRef(null),i=I.useRef(e),o=I.useRef("none"),h=e?"mounted":"unmounted",[s,p]=Wne(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return I.useEffect(()=>{const y=J_(n.current);o.current=s==="mounted"?y:"none"},[s]),ps(()=>{const y=n.current,b=i.current;if(b!==e){const E=o.current,C=J_(y);e?p("MOUNT"):C==="none"||(y==null?void 0:y.display)==="none"?p("UNMOUNT"):p(b&&E!==C?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,p]),ps(()=>{if(t){let y;const b=t.ownerDocument.defaultView??window,_=C=>{const N=J_(n.current).includes(C.animationName);if(C.target===t&&N&&(p("ANIMATION_END"),!i.current)){const O=t.style.animationFillMode;t.style.animationFillMode="forwards",y=b.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=O)})}},E=C=>{C.target===t&&(o.current=J_(n.current))};return t.addEventListener("animationstart",E),t.addEventListener("animationcancel",_),t.addEventListener("animationend",_),()=>{b.clearTimeout(y),t.removeEventListener("animationstart",E),t.removeEventListener("animationcancel",_),t.removeEventListener("animationend",_)}}else p("ANIMATION_END")},[t,p]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:I.useCallback(y=>{n.current=y?getComputedStyle(y):null,r(y)},[])}}function J_(e){return(e==null?void 0:e.animationName)||"none"}function Hne(e){var n,i;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Xne=Ak[" useInsertionEffect ".trim().toString()]||ps;function zc({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[i,o,h]=Kne({defaultProp:t,onChange:r}),s=e!==void 0,p=s?e:i;{const b=I.useRef(e!==void 0);I.useEffect(()=>{const _=b.current;_!==s&&console.warn(`${n} is changing from ${_?"controlled":"uncontrolled"} to ${s?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),b.current=s},[s,n])}const y=I.useCallback(b=>{var _;if(s){const E=Zne(b)?b(e):b;E!==e&&((_=h.current)==null||_.call(h,E))}else o(b)},[s,e,o,h]);return[p,y]}function Kne({defaultProp:e,onChange:t}){const[r,n]=I.useState(e),i=I.useRef(r),o=I.useRef(t);return Xne(()=>{o.current=t},[t]),I.useEffect(()=>{var h;i.current!==r&&((h=o.current)==null||h.call(o,r),i.current=r)},[r,i]),[r,n,o]}function Zne(e){return typeof e=="function"}var a8=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Yne="VisuallyHidden",CM=I.forwardRef((e,t)=>l.jsx(fr.span,{...e,ref:t,style:{...a8,...e.style}}));CM.displayName=Yne;var PM="ToastProvider",[AM,Jne,Qne]=hE("Toast"),[o8,LUe]=xo("Toast",[Qne]),[eie,pE]=o8(PM),l8=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:i="right",swipeThreshold:o=50,children:h}=e,[s,p]=I.useState(null),[y,b]=I.useState(0),_=I.useRef(!1),E=I.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${PM}\`. Expected non-empty \`string\`.`),l.jsx(AM.Provider,{scope:t,children:l.jsx(eie,{scope:t,label:r,duration:n,swipeDirection:i,swipeThreshold:o,toastCount:y,viewport:s,onViewportChange:p,onToastAdd:I.useCallback(()=>b(C=>C+1),[]),onToastRemove:I.useCallback(()=>b(C=>C-1),[]),isFocusedToastEscapeKeyDownRef:_,isClosePausedRef:E,children:h})})};l8.displayName=PM;var c8="ToastViewport",tie=["F8"],uA="toast.viewportPause",dA="toast.viewportResume",u8=I.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=tie,label:i="Notifications ({hotkey})",...o}=e,h=pE(c8,r),s=Jne(r),p=I.useRef(null),y=I.useRef(null),b=I.useRef(null),_=I.useRef(null),E=Qr(t,_,h.onViewportChange),C=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),k=h.toastCount>0;I.useEffect(()=>{const O=R=>{var B;n.length!==0&&n.every(q=>R[q]||R.code===q)&&((B=_.current)==null||B.focus())};return document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)},[n]),I.useEffect(()=>{const O=p.current,R=_.current;if(k&&O&&R){const L=()=>{if(!h.isClosePausedRef.current){const H=new CustomEvent(uA);R.dispatchEvent(H),h.isClosePausedRef.current=!0}},B=()=>{if(h.isClosePausedRef.current){const H=new CustomEvent(dA);R.dispatchEvent(H),h.isClosePausedRef.current=!1}},q=H=>{!O.contains(H.relatedTarget)&&B()},F=()=>{O.contains(document.activeElement)||B()};return O.addEventListener("focusin",L),O.addEventListener("focusout",q),O.addEventListener("pointermove",L),O.addEventListener("pointerleave",F),window.addEventListener("blur",L),window.addEventListener("focus",B),()=>{O.removeEventListener("focusin",L),O.removeEventListener("focusout",q),O.removeEventListener("pointermove",L),O.removeEventListener("pointerleave",F),window.removeEventListener("blur",L),window.removeEventListener("focus",B)}}},[k,h.isClosePausedRef]);const N=I.useCallback(({tabbingDirection:O})=>{const L=s().map(B=>{const q=B.ref.current,F=[q,...pie(q)];return O==="forwards"?F:F.reverse()});return(O==="forwards"?L.reverse():L).flat()},[s]);return I.useEffect(()=>{const O=_.current;if(O){const R=L=>{var F,H,Z;const B=L.altKey||L.ctrlKey||L.metaKey;if(L.key==="Tab"&&!B){const re=document.activeElement,W=L.shiftKey;if(L.target===O&&W){(F=y.current)==null||F.focus();return}const ie=N({tabbingDirection:W?"backwards":"forwards"}),ue=ie.findIndex(_e=>_e===re);Yj(ie.slice(ue+1))?L.preventDefault():W?(H=y.current)==null||H.focus():(Z=b.current)==null||Z.focus()}};return O.addEventListener("keydown",R),()=>O.removeEventListener("keydown",R)}},[s,N]),l.jsxs(Vne,{ref:p,role:"region","aria-label":i.replace("{hotkey}",C),tabIndex:-1,style:{pointerEvents:k?void 0:"none"},children:[k&&l.jsx(hA,{ref:y,onFocusFromOutsideViewport:()=>{const O=N({tabbingDirection:"forwards"});Yj(O)}}),l.jsx(AM.Slot,{scope:r,children:l.jsx(fr.ol,{tabIndex:-1,...o,ref:E})}),k&&l.jsx(hA,{ref:b,onFocusFromOutsideViewport:()=>{const O=N({tabbingDirection:"backwards"});Yj(O)}})]})});u8.displayName=c8;var d8="ToastFocusProxy",hA=I.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...i}=e,o=pE(d8,r);return l.jsx(CM,{"aria-hidden":!0,tabIndex:0,...i,ref:t,style:{position:"fixed"},onFocus:h=>{var y;const s=h.relatedTarget;!((y=o.viewport)!=null&&y.contains(s))&&n()}})});hA.displayName=d8;var z0="Toast",rie="toast.swipeStart",nie="toast.swipeMove",iie="toast.swipeCancel",sie="toast.swipeEnd",h8=I.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:i,onOpenChange:o,...h}=e,[s,p]=zc({prop:n,defaultProp:i??!0,onChange:o,caller:z0});return l.jsx(Hl,{present:r||s,children:l.jsx(lie,{open:s,...h,ref:t,onClose:()=>p(!1),onPause:pa(e.onPause),onResume:pa(e.onResume),onSwipeStart:Zt(e.onSwipeStart,y=>{y.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Zt(e.onSwipeMove,y=>{const{x:b,y:_}=y.detail.delta;y.currentTarget.setAttribute("data-swipe","move"),y.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${b}px`),y.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${_}px`)}),onSwipeCancel:Zt(e.onSwipeCancel,y=>{y.currentTarget.setAttribute("data-swipe","cancel"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),y.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),y.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Zt(e.onSwipeEnd,y=>{const{x:b,y:_}=y.detail.delta;y.currentTarget.setAttribute("data-swipe","end"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),y.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${b}px`),y.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${_}px`),p(!1)})})})});h8.displayName=z0;var[aie,oie]=o8(z0,{onClose(){}}),lie=I.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:i,open:o,onClose:h,onEscapeKeyDown:s,onPause:p,onResume:y,onSwipeStart:b,onSwipeMove:_,onSwipeCancel:E,onSwipeEnd:C,...k}=e,N=pE(z0,r),[O,R]=I.useState(null),L=Qr(t,_e=>R(_e)),B=I.useRef(null),q=I.useRef(null),F=i||N.duration,H=I.useRef(0),Z=I.useRef(F),re=I.useRef(0),{onToastAdd:W,onToastRemove:te}=N,oe=pa(()=>{var xe;(O==null?void 0:O.contains(document.activeElement))&&((xe=N.viewport)==null||xe.focus()),h()}),ie=I.useCallback(_e=>{!_e||_e===1/0||(window.clearTimeout(re.current),H.current=new Date().getTime(),re.current=window.setTimeout(oe,_e))},[oe]);I.useEffect(()=>{const _e=N.viewport;if(_e){const xe=()=>{ie(Z.current),y==null||y()},be=()=>{const Ae=new Date().getTime()-H.current;Z.current=Z.current-Ae,window.clearTimeout(re.current),p==null||p()};return _e.addEventListener(uA,be),_e.addEventListener(dA,xe),()=>{_e.removeEventListener(uA,be),_e.removeEventListener(dA,xe)}}},[N.viewport,F,p,y,ie]),I.useEffect(()=>{o&&!N.isClosePausedRef.current&&ie(F)},[o,F,N.isClosePausedRef,ie]),I.useEffect(()=>(W(),()=>te()),[W,te]);const ue=I.useMemo(()=>O?x8(O):null,[O]);return N.viewport?l.jsxs(l.Fragment,{children:[ue&&l.jsx(cie,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:ue}),l.jsx(aie,{scope:r,onClose:oe,children:Yc.createPortal(l.jsx(AM.ItemSlot,{scope:r,children:l.jsx(Une,{asChild:!0,onEscapeKeyDown:Zt(s,()=>{N.isFocusedToastEscapeKeyDownRef.current||oe(),N.isFocusedToastEscapeKeyDownRef.current=!1}),children:l.jsx(fr.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":N.swipeDirection,...k,ref:L,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Zt(e.onKeyDown,_e=>{_e.key==="Escape"&&(s==null||s(_e.nativeEvent),_e.nativeEvent.defaultPrevented||(N.isFocusedToastEscapeKeyDownRef.current=!0,oe()))}),onPointerDown:Zt(e.onPointerDown,_e=>{_e.button===0&&(B.current={x:_e.clientX,y:_e.clientY})}),onPointerMove:Zt(e.onPointerMove,_e=>{if(!B.current)return;const xe=_e.clientX-B.current.x,be=_e.clientY-B.current.y,Ae=!!q.current,me=["left","right"].includes(N.swipeDirection),ke=["left","up"].includes(N.swipeDirection)?Math.min:Math.max,Ne=me?ke(0,xe):0,Be=me?0:ke(0,be),We=_e.pointerType==="touch"?10:2,ut={x:Ne,y:Be},nt={originalEvent:_e,delta:ut};Ae?(q.current=ut,Q_(nie,_,nt,{discrete:!1})):H3(ut,N.swipeDirection,We)?(q.current=ut,Q_(rie,b,nt,{discrete:!1}),_e.target.setPointerCapture(_e.pointerId)):(Math.abs(xe)>We||Math.abs(be)>We)&&(B.current=null)}),onPointerUp:Zt(e.onPointerUp,_e=>{const xe=q.current,be=_e.target;if(be.hasPointerCapture(_e.pointerId)&&be.releasePointerCapture(_e.pointerId),q.current=null,B.current=null,xe){const Ae=_e.currentTarget,me={originalEvent:_e,delta:xe};H3(xe,N.swipeDirection,N.swipeThreshold)?Q_(sie,C,me,{discrete:!0}):Q_(iie,E,me,{discrete:!0}),Ae.addEventListener("click",ke=>ke.preventDefault(),{once:!0})}})})})}),N.viewport)})]}):null}),cie=e=>{const{__scopeToast:t,children:r,...n}=e,i=pE(z0,t),[o,h]=I.useState(!1),[s,p]=I.useState(!1);return hie(()=>h(!0)),I.useEffect(()=>{const y=window.setTimeout(()=>p(!0),1e3);return()=>window.clearTimeout(y)},[]),s?null:l.jsx(fE,{asChild:!0,children:l.jsx(CM,{...n,children:o&&l.jsxs(l.Fragment,{children:[i.label," ",r]})})})},uie="ToastTitle",f8=I.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return l.jsx(fr.div,{...n,ref:t})});f8.displayName=uie;var die="ToastDescription",p8=I.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return l.jsx(fr.div,{...n,ref:t})});p8.displayName=die;var m8="ToastAction",g8=I.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?l.jsx(v8,{altText:r,asChild:!0,children:l.jsx(NM,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${m8}\`. Expected non-empty \`string\`.`),null)});g8.displayName=m8;var y8="ToastClose",NM=I.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,i=oie(y8,r);return l.jsx(v8,{asChild:!0,children:l.jsx(fr.button,{type:"button",...n,ref:t,onClick:Zt(e.onClick,i.onClose)})})});NM.displayName=y8;var v8=I.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...i}=e;return l.jsx(fr.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...i,ref:t})});function x8(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),fie(n)){const i=n.ariaHidden||n.hidden||n.style.display==="none",o=n.dataset.radixToastAnnounceExclude==="";if(!i)if(o){const h=n.dataset.radixToastAnnounceAlt;h&&t.push(h)}else t.push(...x8(n))}}),t}function Q_(e,t,r,{discrete:n}){const i=r.originalEvent.currentTarget,o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?jM(i,o):i.dispatchEvent(o)}var H3=(e,t,r=0)=>{const n=Math.abs(e.x),i=Math.abs(e.y),o=n>i;return t==="left"||t==="right"?o&&n>r:!o&&i>r};function hie(e=()=>{}){const t=pa(e);ps(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function fie(e){return e.nodeType===e.ELEMENT_NODE}function pie(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Yj(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var mie=l8,b8=u8,_8=h8,w8=f8,S8=p8,E8=g8,T8=NM;const X3=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,K3=Jr,mE=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return K3(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:i,defaultVariants:o}=t,h=Object.keys(i).map(y=>{const b=r==null?void 0:r[y],_=o==null?void 0:o[y];if(b===null)return null;const E=X3(b)||X3(_);return i[y][E]}),s=r&&Object.entries(r).reduce((y,b)=>{let[_,E]=b;return E===void 0||(y[_]=E),y},{}),p=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((y,b)=>{let{class:_,className:E,...C}=b;return Object.entries(C).every(k=>{let[N,O]=k;return Array.isArray(O)?O.includes({...o,...s}[N]):{...o,...s}[N]===O})?[...y,_,E]:y},[]);return K3(e,h,p,r==null?void 0:r.class,r==null?void 0:r.className)};var gie={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const yie=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Xt=(e,t)=>{const r=I.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:h,children:s,...p},y)=>I.createElement("svg",{ref:y,...gie,width:i,height:i,stroke:n,strokeWidth:h?Number(o)*24/Number(i):o,className:`lucide lucide-${yie(e)}`,...p},[...t.map(([b,_])=>I.createElement(b,_)),...(Array.isArray(s)?s:[s])||[]]));return r.displayName=`${e}`,r},Z3=Xt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),$0=Xt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),vie=Xt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),gE=Xt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Bl=Xt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),xie=Xt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),Y3=Xt("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),j8=Xt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),fA=Xt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),$c=Xt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),bie=Xt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),_ie=Xt("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),ma=Xt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Pm=Xt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),tm=Xt("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),C8=Xt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),wie=Xt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Sie=Xt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Eie=Xt("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]),ml=Xt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Tie=Xt("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]),jie=Xt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Fc=Xt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),P8=Xt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Zh=Xt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),cl=Xt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),J3=Xt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Cie=Xt("FilterX",[["path",{d:"M13.013 3H2l8 9.46V19l4 2v-8.54l.9-1.055",key:"1fi1da"}],["path",{d:"m22 3-5 5",key:"12jva0"}],["path",{d:"m17 3 5 5",key:"k36vhe"}]]),Pie=Xt("Gem",[["path",{d:"M6 3h12l4 6-10 13L2 9Z",key:"1pcd5k"}],["path",{d:"M11 3 8 9l4 13 4-13-3-6",key:"1fcu3u"}],["path",{d:"M2 9h20",key:"16fsjt"}]]),A8=Xt("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),N8=Xt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),Fx=Xt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Q3=Xt("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),e4=Xt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),pA=Xt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Aie=Xt("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Nie=Xt("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),Ux=Xt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),mA=Xt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Vx=Xt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),qs=Xt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),kie=Xt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),k8=Xt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),M8=Xt("Music2",[["circle",{cx:"8",cy:"18",r:"4",key:"1fc0mg"}],["path",{d:"M12 18V2l7 4",key:"g04rme"}]]),I8=Xt("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),t4=Xt("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),Mie=Xt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),Am=Xt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),yE=Xt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Iie=Xt("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),Fp=Xt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]),kM=Xt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),r4=Xt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),gd=Xt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ax=Xt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Yh=Xt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Oie=Xt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),gA=Xt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),T1=Xt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Rie=Xt("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Gs=Xt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),yd=Xt("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),Die=Xt("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]),O8=Xt("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Lie=Xt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Bie=Xt("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]),MM=Xt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),vE=Xt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),zie=Xt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),$ie=Xt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Kn=Xt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Is=Xt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),xE=Xt("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]),Sc=Xt("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),j1=Xt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Nm=Xt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),R8=Xt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Fie=mie,D8=je.forwardRef(({className:e,...t},r)=>l.jsx(b8,{ref:r,className:Pr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));D8.displayName=b8.displayName;const Uie=mE("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),L8=je.forwardRef(({className:e,variant:t,...r},n)=>l.jsx(_8,{ref:n,className:Pr(Uie({variant:t}),e),...r}));L8.displayName=_8.displayName;const Vie=je.forwardRef(({className:e,...t},r)=>l.jsx(E8,{ref:r,className:Pr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));Vie.displayName=E8.displayName;const B8=je.forwardRef(({className:e,...t},r)=>l.jsx(T8,{ref:r,className:Pr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:l.jsx(Nm,{className:"h-4 w-4"})}));B8.displayName=T8.displayName;const z8=je.forwardRef(({className:e,...t},r)=>l.jsx(w8,{ref:r,className:Pr("text-sm font-semibold",e),...t}));z8.displayName=w8.displayName;const $8=je.forwardRef(({className:e,...t},r)=>l.jsx(S8,{ref:r,className:Pr("text-sm opacity-90",e),...t}));$8.displayName=S8.displayName;const qie=1;let Jj=0;function Wie(){return Jj=(Jj+1)%Number.MAX_VALUE,Jj.toString()}const zs={state:{toasts:[]},listeners:[],getState:()=>zs.state,setState:e=>{typeof e=="function"?zs.state=e(zs.state):zs.state={...zs.state,...e},zs.listeners.forEach(t=>t(zs.state))},subscribe:e=>(zs.listeners.push(e),()=>{zs.listeners=zs.listeners.filter(t=>t!==e)})},Mr=({...e})=>{const t=Wie(),r=i=>zs.setState(o=>({...o,toasts:o.toasts.map(h=>h.id===t?{...h,...i}:h)})),n=()=>zs.setState(i=>({...i,toasts:i.toasts.filter(o=>o.id!==t)}));return zs.setState(i=>({...i,toasts:[{...e,id:t,dismiss:n},...i.toasts].slice(0,qie)})),{id:t,dismiss:n,update:r}};function Ui(){const[e,t]=I.useState(zs.getState());return I.useEffect(()=>zs.subscribe(n=>{t(n)}),[]),I.useEffect(()=>{const r=[];return e.toasts.forEach(n=>{if(n.duration===1/0)return;const i=setTimeout(()=>{n.dismiss()},n.duration||5e3);r.push(i)}),()=>{r.forEach(n=>clearTimeout(n))}},[e.toasts]),{toast:Mr,toasts:e.toasts}}function Gie(){const{toasts:e}=Ui();return l.jsxs(Fie,{children:[e.map(({id:t,title:r,description:n,action:i,...o})=>l.jsxs(L8,{...o,children:[l.jsxs("div",{className:"grid gap-1",children:[r&&l.jsx(z8,{children:r}),n&&l.jsx($8,{children:n})]}),i,l.jsx(B8,{})]},t)),l.jsx(D8,{})]})}const Hie=mE("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),xt=je.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...i},o)=>{const h=n?Pne:"button";return l.jsx(h,{className:Pr(Hie({variant:t,size:r,className:e})),ref:o,...i})});xt.displayName="Button";var Xie=I.createContext(void 0);function F0(e){const t=I.useContext(Xie);return e||t||"ltr"}var Qj=0;function IM(){I.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??n4()),document.body.insertAdjacentElement("beforeend",e[1]??n4()),Qj++,()=>{Qj===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Qj--}},[])}function n4(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var eC="focusScope.autoFocusOnMount",tC="focusScope.autoFocusOnUnmount",i4={bubbles:!1,cancelable:!0},Kie="FocusScope",bE=I.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...h}=e,[s,p]=I.useState(null),y=pa(i),b=pa(o),_=I.useRef(null),E=Qr(t,N=>p(N)),C=I.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;I.useEffect(()=>{if(n){let N=function(B){if(C.paused||!s)return;const q=B.target;s.contains(q)?_.current=q:Du(_.current,{select:!0})},O=function(B){if(C.paused||!s)return;const q=B.relatedTarget;q!==null&&(s.contains(q)||Du(_.current,{select:!0}))},R=function(B){if(document.activeElement===document.body)for(const F of B)F.removedNodes.length>0&&Du(s)};document.addEventListener("focusin",N),document.addEventListener("focusout",O);const L=new MutationObserver(R);return s&&L.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",N),document.removeEventListener("focusout",O),L.disconnect()}}},[n,s,C.paused]),I.useEffect(()=>{if(s){a4.add(C);const N=document.activeElement;if(!s.contains(N)){const R=new CustomEvent(eC,i4);s.addEventListener(eC,y),s.dispatchEvent(R),R.defaultPrevented||(Zie(tse(F8(s)),{select:!0}),document.activeElement===N&&Du(s))}return()=>{s.removeEventListener(eC,y),setTimeout(()=>{const R=new CustomEvent(tC,i4);s.addEventListener(tC,b),s.dispatchEvent(R),R.defaultPrevented||Du(N??document.body,{select:!0}),s.removeEventListener(tC,b),a4.remove(C)},0)}}},[s,y,b,C]);const k=I.useCallback(N=>{if(!r&&!n||C.paused)return;const O=N.key==="Tab"&&!N.altKey&&!N.ctrlKey&&!N.metaKey,R=document.activeElement;if(O&&R){const L=N.currentTarget,[B,q]=Yie(L);B&&q?!N.shiftKey&&R===q?(N.preventDefault(),r&&Du(B,{select:!0})):N.shiftKey&&R===B&&(N.preventDefault(),r&&Du(q,{select:!0})):R===L&&N.preventDefault()}},[r,n,C.paused]);return l.jsx(fr.div,{tabIndex:-1,...h,ref:E,onKeyDown:k})});bE.displayName=Kie;function Zie(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Du(n,{select:t}),document.activeElement!==r)return}function Yie(e){const t=F8(e),r=s4(t,e),n=s4(t.reverse(),e);return[r,n]}function F8(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function s4(e,t){for(const r of e)if(!Jie(r,{upTo:t}))return r}function Jie(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Qie(e){return e instanceof HTMLInputElement&&"select"in e}function Du(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Qie(e)&&t&&e.select()}}var a4=ese();function ese(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=o4(e,t),e.unshift(t)},remove(t){var r;e=o4(e,t),(r=e[0])==null||r.resume()}}}function o4(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function tse(e){return e.filter(t=>t.tagName!=="A")}var rse=Ak[" useId ".trim().toString()]||(()=>{}),nse=0;function zl(e){const[t,r]=I.useState(rse());return ps(()=>{e||r(n=>n??String(nse++))},[e]),e||(t?`radix-${t}`:"")}const ise=["top","right","bottom","left"],vd=Math.min,ka=Math.max,C1=Math.round,ew=Math.floor,$l=e=>({x:e,y:e}),sse={left:"right",right:"left",bottom:"top",top:"bottom"},ase={start:"end",end:"start"};function yA(e,t,r){return ka(e,vd(t,r))}function Uc(e,t){return typeof e=="function"?e(t):e}function Vc(e){return e.split("-")[0]}function fg(e){return e.split("-")[1]}function OM(e){return e==="x"?"y":"x"}function RM(e){return e==="y"?"height":"width"}function Ol(e){return["top","bottom"].includes(Vc(e))?"y":"x"}function DM(e){return OM(Ol(e))}function ose(e,t,r){r===void 0&&(r=!1);const n=fg(e),i=DM(e),o=RM(i);let h=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(h=P1(h)),[h,P1(h)]}function lse(e){const t=P1(e);return[vA(e),t,vA(t)]}function vA(e){return e.replace(/start|end/g,t=>ase[t])}function cse(e,t,r){const n=["left","right"],i=["right","left"],o=["top","bottom"],h=["bottom","top"];switch(e){case"top":case"bottom":return r?t?i:n:t?n:i;case"left":case"right":return t?o:h;default:return[]}}function use(e,t,r,n){const i=fg(e);let o=cse(Vc(e),r==="start",n);return i&&(o=o.map(h=>h+"-"+i),t&&(o=o.concat(o.map(vA)))),o}function P1(e){return e.replace(/left|right|bottom|top/g,t=>sse[t])}function dse(e){return{top:0,right:0,bottom:0,left:0,...e}}function U8(e){return typeof e!="number"?dse(e):{top:e,right:e,bottom:e,left:e}}function A1(e){const{x:t,y:r,width:n,height:i}=e;return{width:n,height:i,top:r,left:t,right:t+n,bottom:r+i,x:t,y:r}}function l4(e,t,r){let{reference:n,floating:i}=e;const o=Ol(t),h=DM(t),s=RM(h),p=Vc(t),y=o==="y",b=n.x+n.width/2-i.width/2,_=n.y+n.height/2-i.height/2,E=n[s]/2-i[s]/2;let C;switch(p){case"top":C={x:b,y:n.y-i.height};break;case"bottom":C={x:b,y:n.y+n.height};break;case"right":C={x:n.x+n.width,y:_};break;case"left":C={x:n.x-i.width,y:_};break;default:C={x:n.x,y:n.y}}switch(fg(t)){case"start":C[h]-=E*(r&&y?-1:1);break;case"end":C[h]+=E*(r&&y?-1:1);break}return C}const hse=async(e,t,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:o=[],platform:h}=r,s=o.filter(Boolean),p=await(h.isRTL==null?void 0:h.isRTL(t));let y=await h.getElementRects({reference:e,floating:t,strategy:i}),{x:b,y:_}=l4(y,n,p),E=n,C={},k=0;for(let N=0;N<s.length;N++){const{name:O,fn:R}=s[N],{x:L,y:B,data:q,reset:F}=await R({x:b,y:_,initialPlacement:n,placement:E,strategy:i,middlewareData:C,rects:y,platform:h,elements:{reference:e,floating:t}});b=L??b,_=B??_,C={...C,[O]:{...C[O],...q}},F&&k<=50&&(k++,typeof F=="object"&&(F.placement&&(E=F.placement),F.rects&&(y=F.rects===!0?await h.getElementRects({reference:e,floating:t,strategy:i}):F.rects),{x:b,y:_}=l4(y,E,p)),N=-1)}return{x:b,y:_,placement:E,strategy:i,middlewareData:C}};async function qx(e,t){var r;t===void 0&&(t={});const{x:n,y:i,platform:o,rects:h,elements:s,strategy:p}=e,{boundary:y="clippingAncestors",rootBoundary:b="viewport",elementContext:_="floating",altBoundary:E=!1,padding:C=0}=Uc(t,e),k=U8(C),O=s[E?_==="floating"?"reference":"floating":_],R=A1(await o.getClippingRect({element:(r=await(o.isElement==null?void 0:o.isElement(O)))==null||r?O:O.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:y,rootBoundary:b,strategy:p})),L=_==="floating"?{x:n,y:i,width:h.floating.width,height:h.floating.height}:h.reference,B=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),q=await(o.isElement==null?void 0:o.isElement(B))?await(o.getScale==null?void 0:o.getScale(B))||{x:1,y:1}:{x:1,y:1},F=A1(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:L,offsetParent:B,strategy:p}):L);return{top:(R.top-F.top+k.top)/q.y,bottom:(F.bottom-R.bottom+k.bottom)/q.y,left:(R.left-F.left+k.left)/q.x,right:(F.right-R.right+k.right)/q.x}}const fse=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:i,rects:o,platform:h,elements:s,middlewareData:p}=t,{element:y,padding:b=0}=Uc(e,t)||{};if(y==null)return{};const _=U8(b),E={x:r,y:n},C=DM(i),k=RM(C),N=await h.getDimensions(y),O=C==="y",R=O?"top":"left",L=O?"bottom":"right",B=O?"clientHeight":"clientWidth",q=o.reference[k]+o.reference[C]-E[C]-o.floating[k],F=E[C]-o.reference[C],H=await(h.getOffsetParent==null?void 0:h.getOffsetParent(y));let Z=H?H[B]:0;(!Z||!await(h.isElement==null?void 0:h.isElement(H)))&&(Z=s.floating[B]||o.floating[k]);const re=q/2-F/2,W=Z/2-N[k]/2-1,te=vd(_[R],W),oe=vd(_[L],W),ie=te,ue=Z-N[k]-oe,_e=Z/2-N[k]/2+re,xe=yA(ie,_e,ue),be=!p.arrow&&fg(i)!=null&&_e!==xe&&o.reference[k]/2-(_e<ie?te:oe)-N[k]/2<0,Ae=be?_e<ie?_e-ie:_e-ue:0;return{[C]:E[C]+Ae,data:{[C]:xe,centerOffset:_e-xe-Ae,...be&&{alignmentOffset:Ae}},reset:be}}}),pse=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:i,middlewareData:o,rects:h,initialPlacement:s,platform:p,elements:y}=t,{mainAxis:b=!0,crossAxis:_=!0,fallbackPlacements:E,fallbackStrategy:C="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:N=!0,...O}=Uc(e,t);if((r=o.arrow)!=null&&r.alignmentOffset)return{};const R=Vc(i),L=Ol(s),B=Vc(s)===s,q=await(p.isRTL==null?void 0:p.isRTL(y.floating)),F=E||(B||!N?[P1(s)]:lse(s)),H=k!=="none";!E&&H&&F.push(...use(s,N,k,q));const Z=[s,...F],re=await qx(t,O),W=[];let te=((n=o.flip)==null?void 0:n.overflows)||[];if(b&&W.push(re[R]),_){const _e=ose(i,h,q);W.push(re[_e[0]],re[_e[1]])}if(te=[...te,{placement:i,overflows:W}],!W.every(_e=>_e<=0)){var oe,ie;const _e=(((oe=o.flip)==null?void 0:oe.index)||0)+1,xe=Z[_e];if(xe&&(!(_==="alignment"?L!==Ol(xe):!1)||te.every(me=>me.overflows[0]>0&&Ol(me.placement)===L)))return{data:{index:_e,overflows:te},reset:{placement:xe}};let be=(ie=te.filter(Ae=>Ae.overflows[0]<=0).sort((Ae,me)=>Ae.overflows[1]-me.overflows[1])[0])==null?void 0:ie.placement;if(!be)switch(C){case"bestFit":{var ue;const Ae=(ue=te.filter(me=>{if(H){const ke=Ol(me.placement);return ke===L||ke==="y"}return!0}).map(me=>[me.placement,me.overflows.filter(ke=>ke>0).reduce((ke,Ne)=>ke+Ne,0)]).sort((me,ke)=>me[1]-ke[1])[0])==null?void 0:ue[0];Ae&&(be=Ae);break}case"initialPlacement":be=s;break}if(i!==be)return{reset:{placement:be}}}return{}}}};function c4(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function u4(e){return ise.some(t=>e[t]>=0)}const mse=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...i}=Uc(e,t);switch(n){case"referenceHidden":{const o=await qx(t,{...i,elementContext:"reference"}),h=c4(o,r.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:u4(h)}}}case"escaped":{const o=await qx(t,{...i,altBoundary:!0}),h=c4(o,r.floating);return{data:{escapedOffsets:h,escaped:u4(h)}}}default:return{}}}}};async function gse(e,t){const{placement:r,platform:n,elements:i}=e,o=await(n.isRTL==null?void 0:n.isRTL(i.floating)),h=Vc(r),s=fg(r),p=Ol(r)==="y",y=["left","top"].includes(h)?-1:1,b=o&&p?-1:1,_=Uc(t,e);let{mainAxis:E,crossAxis:C,alignmentAxis:k}=typeof _=="number"?{mainAxis:_,crossAxis:0,alignmentAxis:null}:{mainAxis:_.mainAxis||0,crossAxis:_.crossAxis||0,alignmentAxis:_.alignmentAxis};return s&&typeof k=="number"&&(C=s==="end"?k*-1:k),p?{x:C*b,y:E*y}:{x:E*y,y:C*b}}const yse=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:i,y:o,placement:h,middlewareData:s}=t,p=await gse(t,e);return h===((r=s.offset)==null?void 0:r.placement)&&(n=s.arrow)!=null&&n.alignmentOffset?{}:{x:i+p.x,y:o+p.y,data:{...p,placement:h}}}}},vse=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:i}=t,{mainAxis:o=!0,crossAxis:h=!1,limiter:s={fn:O=>{let{x:R,y:L}=O;return{x:R,y:L}}},...p}=Uc(e,t),y={x:r,y:n},b=await qx(t,p),_=Ol(Vc(i)),E=OM(_);let C=y[E],k=y[_];if(o){const O=E==="y"?"top":"left",R=E==="y"?"bottom":"right",L=C+b[O],B=C-b[R];C=yA(L,C,B)}if(h){const O=_==="y"?"top":"left",R=_==="y"?"bottom":"right",L=k+b[O],B=k-b[R];k=yA(L,k,B)}const N=s.fn({...t,[E]:C,[_]:k});return{...N,data:{x:N.x-r,y:N.y-n,enabled:{[E]:o,[_]:h}}}}}},xse=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:i,rects:o,middlewareData:h}=t,{offset:s=0,mainAxis:p=!0,crossAxis:y=!0}=Uc(e,t),b={x:r,y:n},_=Ol(i),E=OM(_);let C=b[E],k=b[_];const N=Uc(s,t),O=typeof N=="number"?{mainAxis:N,crossAxis:0}:{mainAxis:0,crossAxis:0,...N};if(p){const B=E==="y"?"height":"width",q=o.reference[E]-o.floating[B]+O.mainAxis,F=o.reference[E]+o.reference[B]-O.mainAxis;C<q?C=q:C>F&&(C=F)}if(y){var R,L;const B=E==="y"?"width":"height",q=["top","left"].includes(Vc(i)),F=o.reference[_]-o.floating[B]+(q&&((R=h.offset)==null?void 0:R[_])||0)+(q?0:O.crossAxis),H=o.reference[_]+o.reference[B]+(q?0:((L=h.offset)==null?void 0:L[_])||0)-(q?O.crossAxis:0);k<F?k=F:k>H&&(k=H)}return{[E]:C,[_]:k}}}},bse=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:i,rects:o,platform:h,elements:s}=t,{apply:p=()=>{},...y}=Uc(e,t),b=await qx(t,y),_=Vc(i),E=fg(i),C=Ol(i)==="y",{width:k,height:N}=o.floating;let O,R;_==="top"||_==="bottom"?(O=_,R=E===(await(h.isRTL==null?void 0:h.isRTL(s.floating))?"start":"end")?"left":"right"):(R=_,O=E==="end"?"top":"bottom");const L=N-b.top-b.bottom,B=k-b.left-b.right,q=vd(N-b[O],L),F=vd(k-b[R],B),H=!t.middlewareData.shift;let Z=q,re=F;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(re=B),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(Z=L),H&&!E){const te=ka(b.left,0),oe=ka(b.right,0),ie=ka(b.top,0),ue=ka(b.bottom,0);C?re=k-2*(te!==0||oe!==0?te+oe:ka(b.left,b.right)):Z=N-2*(ie!==0||ue!==0?ie+ue:ka(b.top,b.bottom))}await p({...t,availableWidth:re,availableHeight:Z});const W=await h.getDimensions(s.floating);return k!==W.width||N!==W.height?{reset:{rects:!0}}:{}}}};function _E(){return typeof window<"u"}function pg(e){return V8(e)?(e.nodeName||"").toLowerCase():"#document"}function Ra(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Xl(e){var t;return(t=(V8(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function V8(e){return _E()?e instanceof Node||e instanceof Ra(e).Node:!1}function dl(e){return _E()?e instanceof Element||e instanceof Ra(e).Element:!1}function ql(e){return _E()?e instanceof HTMLElement||e instanceof Ra(e).HTMLElement:!1}function d4(e){return!_E()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ra(e).ShadowRoot}function U0(e){const{overflow:t,overflowX:r,overflowY:n,display:i}=hl(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(i)}function _se(e){return["table","td","th"].includes(pg(e))}function wE(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function LM(e){const t=BM(),r=dl(e)?hl(e):e;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function wse(e){let t=xd(e);for(;ql(t)&&!km(t);){if(LM(t))return t;if(wE(t))return null;t=xd(t)}return null}function BM(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function km(e){return["html","body","#document"].includes(pg(e))}function hl(e){return Ra(e).getComputedStyle(e)}function SE(e){return dl(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function xd(e){if(pg(e)==="html")return e;const t=e.assignedSlot||e.parentNode||d4(e)&&e.host||Xl(e);return d4(t)?t.host:t}function q8(e){const t=xd(e);return km(t)?e.ownerDocument?e.ownerDocument.body:e.body:ql(t)&&U0(t)?t:q8(t)}function Wx(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const i=q8(e),o=i===((n=e.ownerDocument)==null?void 0:n.body),h=Ra(i);if(o){const s=xA(h);return t.concat(h,h.visualViewport||[],U0(i)?i:[],s&&r?Wx(s):[])}return t.concat(i,Wx(i,[],r))}function xA(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function W8(e){const t=hl(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const i=ql(e),o=i?e.offsetWidth:r,h=i?e.offsetHeight:n,s=C1(r)!==o||C1(n)!==h;return s&&(r=o,n=h),{width:r,height:n,$:s}}function zM(e){return dl(e)?e:e.contextElement}function mm(e){const t=zM(e);if(!ql(t))return $l(1);const r=t.getBoundingClientRect(),{width:n,height:i,$:o}=W8(t);let h=(o?C1(r.width):r.width)/n,s=(o?C1(r.height):r.height)/i;return(!h||!Number.isFinite(h))&&(h=1),(!s||!Number.isFinite(s))&&(s=1),{x:h,y:s}}const Sse=$l(0);function G8(e){const t=Ra(e);return!BM()||!t.visualViewport?Sse:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Ese(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ra(e)?!1:t}function of(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect(),o=zM(e);let h=$l(1);t&&(n?dl(n)&&(h=mm(n)):h=mm(e));const s=Ese(o,r,n)?G8(o):$l(0);let p=(i.left+s.x)/h.x,y=(i.top+s.y)/h.y,b=i.width/h.x,_=i.height/h.y;if(o){const E=Ra(o),C=n&&dl(n)?Ra(n):n;let k=E,N=xA(k);for(;N&&n&&C!==k;){const O=mm(N),R=N.getBoundingClientRect(),L=hl(N),B=R.left+(N.clientLeft+parseFloat(L.paddingLeft))*O.x,q=R.top+(N.clientTop+parseFloat(L.paddingTop))*O.y;p*=O.x,y*=O.y,b*=O.x,_*=O.y,p+=B,y+=q,k=Ra(N),N=xA(k)}}return A1({width:b,height:_,x:p,y})}function $M(e,t){const r=SE(e).scrollLeft;return t?t.left+r:of(Xl(e)).left+r}function H8(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),i=n.left+t.scrollLeft-(r?0:$M(e,n)),o=n.top+t.scrollTop;return{x:i,y:o}}function Tse(e){let{elements:t,rect:r,offsetParent:n,strategy:i}=e;const o=i==="fixed",h=Xl(n),s=t?wE(t.floating):!1;if(n===h||s&&o)return r;let p={scrollLeft:0,scrollTop:0},y=$l(1);const b=$l(0),_=ql(n);if((_||!_&&!o)&&((pg(n)!=="body"||U0(h))&&(p=SE(n)),ql(n))){const C=of(n);y=mm(n),b.x=C.x+n.clientLeft,b.y=C.y+n.clientTop}const E=h&&!_&&!o?H8(h,p,!0):$l(0);return{width:r.width*y.x,height:r.height*y.y,x:r.x*y.x-p.scrollLeft*y.x+b.x+E.x,y:r.y*y.y-p.scrollTop*y.y+b.y+E.y}}function jse(e){return Array.from(e.getClientRects())}function Cse(e){const t=Xl(e),r=SE(e),n=e.ownerDocument.body,i=ka(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),o=ka(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let h=-r.scrollLeft+$M(e);const s=-r.scrollTop;return hl(n).direction==="rtl"&&(h+=ka(t.clientWidth,n.clientWidth)-i),{width:i,height:o,x:h,y:s}}function Pse(e,t){const r=Ra(e),n=Xl(e),i=r.visualViewport;let o=n.clientWidth,h=n.clientHeight,s=0,p=0;if(i){o=i.width,h=i.height;const y=BM();(!y||y&&t==="fixed")&&(s=i.offsetLeft,p=i.offsetTop)}return{width:o,height:h,x:s,y:p}}function Ase(e,t){const r=of(e,!0,t==="fixed"),n=r.top+e.clientTop,i=r.left+e.clientLeft,o=ql(e)?mm(e):$l(1),h=e.clientWidth*o.x,s=e.clientHeight*o.y,p=i*o.x,y=n*o.y;return{width:h,height:s,x:p,y}}function h4(e,t,r){let n;if(t==="viewport")n=Pse(e,r);else if(t==="document")n=Cse(Xl(e));else if(dl(t))n=Ase(t,r);else{const i=G8(e);n={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return A1(n)}function X8(e,t){const r=xd(e);return r===t||!dl(r)||km(r)?!1:hl(r).position==="fixed"||X8(r,t)}function Nse(e,t){const r=t.get(e);if(r)return r;let n=Wx(e,[],!1).filter(s=>dl(s)&&pg(s)!=="body"),i=null;const o=hl(e).position==="fixed";let h=o?xd(e):e;for(;dl(h)&&!km(h);){const s=hl(h),p=LM(h);!p&&s.position==="fixed"&&(i=null),(o?!p&&!i:!p&&s.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||U0(h)&&!p&&X8(e,h))?n=n.filter(b=>b!==h):i=s,h=xd(h)}return t.set(e,n),n}function kse(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e;const h=[...r==="clippingAncestors"?wE(t)?[]:Nse(t,this._c):[].concat(r),n],s=h[0],p=h.reduce((y,b)=>{const _=h4(t,b,i);return y.top=ka(_.top,y.top),y.right=vd(_.right,y.right),y.bottom=vd(_.bottom,y.bottom),y.left=ka(_.left,y.left),y},h4(t,s,i));return{width:p.right-p.left,height:p.bottom-p.top,x:p.left,y:p.top}}function Mse(e){const{width:t,height:r}=W8(e);return{width:t,height:r}}function Ise(e,t,r){const n=ql(t),i=Xl(t),o=r==="fixed",h=of(e,!0,o,t);let s={scrollLeft:0,scrollTop:0};const p=$l(0);function y(){p.x=$M(i)}if(n||!n&&!o)if((pg(t)!=="body"||U0(i))&&(s=SE(t)),n){const C=of(t,!0,o,t);p.x=C.x+t.clientLeft,p.y=C.y+t.clientTop}else i&&y();o&&!n&&i&&y();const b=i&&!n&&!o?H8(i,s):$l(0),_=h.left+s.scrollLeft-p.x-b.x,E=h.top+s.scrollTop-p.y-b.y;return{x:_,y:E,width:h.width,height:h.height}}function rC(e){return hl(e).position==="static"}function f4(e,t){if(!ql(e)||hl(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Xl(e)===r&&(r=r.ownerDocument.body),r}function K8(e,t){const r=Ra(e);if(wE(e))return r;if(!ql(e)){let i=xd(e);for(;i&&!km(i);){if(dl(i)&&!rC(i))return i;i=xd(i)}return r}let n=f4(e,t);for(;n&&_se(n)&&rC(n);)n=f4(n,t);return n&&km(n)&&rC(n)&&!LM(n)?r:n||wse(e)||r}const Ose=async function(e){const t=this.getOffsetParent||K8,r=this.getDimensions,n=await r(e.floating);return{reference:Ise(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Rse(e){return hl(e).direction==="rtl"}const Dse={convertOffsetParentRelativeRectToViewportRelativeRect:Tse,getDocumentElement:Xl,getClippingRect:kse,getOffsetParent:K8,getElementRects:Ose,getClientRects:jse,getDimensions:Mse,getScale:mm,isElement:dl,isRTL:Rse};function Z8(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Lse(e,t){let r=null,n;const i=Xl(e);function o(){var s;clearTimeout(n),(s=r)==null||s.disconnect(),r=null}function h(s,p){s===void 0&&(s=!1),p===void 0&&(p=1),o();const y=e.getBoundingClientRect(),{left:b,top:_,width:E,height:C}=y;if(s||t(),!E||!C)return;const k=ew(_),N=ew(i.clientWidth-(b+E)),O=ew(i.clientHeight-(_+C)),R=ew(b),B={rootMargin:-k+"px "+-N+"px "+-O+"px "+-R+"px",threshold:ka(0,vd(1,p))||1};let q=!0;function F(H){const Z=H[0].intersectionRatio;if(Z!==p){if(!q)return h();Z?h(!1,Z):n=setTimeout(()=>{h(!1,1e-7)},1e3)}Z===1&&!Z8(y,e.getBoundingClientRect())&&h(),q=!1}try{r=new IntersectionObserver(F,{...B,root:i.ownerDocument})}catch{r=new IntersectionObserver(F,B)}r.observe(e)}return h(!0),o}function Bse(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:p=!1}=n,y=zM(e),b=i||o?[...y?Wx(y):[],...Wx(t)]:[];b.forEach(R=>{i&&R.addEventListener("scroll",r,{passive:!0}),o&&R.addEventListener("resize",r)});const _=y&&s?Lse(y,r):null;let E=-1,C=null;h&&(C=new ResizeObserver(R=>{let[L]=R;L&&L.target===y&&C&&(C.unobserve(t),cancelAnimationFrame(E),E=requestAnimationFrame(()=>{var B;(B=C)==null||B.observe(t)})),r()}),y&&!p&&C.observe(y),C.observe(t));let k,N=p?of(e):null;p&&O();function O(){const R=of(e);N&&!Z8(N,R)&&r(),N=R,k=requestAnimationFrame(O)}return r(),()=>{var R;b.forEach(L=>{i&&L.removeEventListener("scroll",r),o&&L.removeEventListener("resize",r)}),_==null||_(),(R=C)==null||R.disconnect(),C=null,p&&cancelAnimationFrame(k)}}const zse=yse,$se=vse,Fse=pse,Use=bse,Vse=mse,p4=fse,qse=xse,Wse=(e,t,r)=>{const n=new Map,i={platform:Dse,...r},o={...i.platform,_c:n};return hse(e,t,{...i,platform:o})};var Gse=typeof document<"u",Hse=function(){},qw=Gse?I.useLayoutEffect:Hse;function N1(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!N1(e[n],t[n]))return!1;return!0}if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){const o=i[n];if(!(o==="_owner"&&e.$$typeof)&&!N1(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function Y8(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function m4(e,t){const r=Y8(e);return Math.round(t*r)/r}function nC(e){const t=I.useRef(e);return qw(()=>{t.current=e}),t}function Xse(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:o,floating:h}={},transform:s=!0,whileElementsMounted:p,open:y}=e,[b,_]=I.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[E,C]=I.useState(n);N1(E,n)||C(n);const[k,N]=I.useState(null),[O,R]=I.useState(null),L=I.useCallback(me=>{me!==H.current&&(H.current=me,N(me))},[]),B=I.useCallback(me=>{me!==Z.current&&(Z.current=me,R(me))},[]),q=o||k,F=h||O,H=I.useRef(null),Z=I.useRef(null),re=I.useRef(b),W=p!=null,te=nC(p),oe=nC(i),ie=nC(y),ue=I.useCallback(()=>{if(!H.current||!Z.current)return;const me={placement:t,strategy:r,middleware:E};oe.current&&(me.platform=oe.current),Wse(H.current,Z.current,me).then(ke=>{const Ne={...ke,isPositioned:ie.current!==!1};_e.current&&!N1(re.current,Ne)&&(re.current=Ne,Yc.flushSync(()=>{_(Ne)}))})},[E,t,r,oe,ie]);qw(()=>{y===!1&&re.current.isPositioned&&(re.current.isPositioned=!1,_(me=>({...me,isPositioned:!1})))},[y]);const _e=I.useRef(!1);qw(()=>(_e.current=!0,()=>{_e.current=!1}),[]),qw(()=>{if(q&&(H.current=q),F&&(Z.current=F),q&&F){if(te.current)return te.current(q,F,ue);ue()}},[q,F,ue,te,W]);const xe=I.useMemo(()=>({reference:H,floating:Z,setReference:L,setFloating:B}),[L,B]),be=I.useMemo(()=>({reference:q,floating:F}),[q,F]),Ae=I.useMemo(()=>{const me={position:r,left:0,top:0};if(!be.floating)return me;const ke=m4(be.floating,b.x),Ne=m4(be.floating,b.y);return s?{...me,transform:"translate("+ke+"px, "+Ne+"px)",...Y8(be.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:ke,top:Ne}},[r,s,be.floating,b.x,b.y]);return I.useMemo(()=>({...b,update:ue,refs:xe,elements:be,floatingStyles:Ae}),[b,ue,xe,be,Ae])}const Kse=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:i}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?p4({element:n.current,padding:i}).fn(r):{}:n?p4({element:n,padding:i}).fn(r):{}}}},Zse=(e,t)=>({...zse(e),options:[e,t]}),Yse=(e,t)=>({...$se(e),options:[e,t]}),Jse=(e,t)=>({...qse(e),options:[e,t]}),Qse=(e,t)=>({...Fse(e),options:[e,t]}),eae=(e,t)=>({...Use(e),options:[e,t]}),tae=(e,t)=>({...Vse(e),options:[e,t]}),rae=(e,t)=>({...Kse(e),options:[e,t]});var nae="Arrow",J8=I.forwardRef((e,t)=>{const{children:r,width:n=10,height:i=5,...o}=e;return l.jsx(fr.svg,{...o,ref:t,width:n,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:l.jsx("polygon",{points:"0,0 30,0 15,10"})})});J8.displayName=nae;var iae=J8;function FM(e){const[t,r]=I.useState(void 0);return ps(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let h,s;if("borderBoxSize"in o){const p=o.borderBoxSize,y=Array.isArray(p)?p[0]:p;h=y.inlineSize,s=y.blockSize}else h=e.offsetWidth,s=e.offsetHeight;r({width:h,height:s})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var UM="Popper",[Q8,EE]=xo(UM),[sae,eq]=Q8(UM),tq=e=>{const{__scopePopper:t,children:r}=e,[n,i]=I.useState(null);return l.jsx(sae,{scope:t,anchor:n,onAnchorChange:i,children:r})};tq.displayName=UM;var rq="PopperAnchor",nq=I.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...i}=e,o=eq(rq,r),h=I.useRef(null),s=Qr(t,h);return I.useEffect(()=>{o.onAnchorChange((n==null?void 0:n.current)||h.current)}),n?null:l.jsx(fr.div,{...i,ref:s})});nq.displayName=rq;var VM="PopperContent",[aae,oae]=Q8(VM),iq=I.forwardRef((e,t)=>{var at,Ut,ct,gt,it,rt;const{__scopePopper:r,side:n="bottom",sideOffset:i=0,align:o="center",alignOffset:h=0,arrowPadding:s=0,avoidCollisions:p=!0,collisionBoundary:y=[],collisionPadding:b=0,sticky:_="partial",hideWhenDetached:E=!1,updatePositionStrategy:C="optimized",onPlaced:k,...N}=e,O=eq(VM,r),[R,L]=I.useState(null),B=Qr(t,rr=>L(rr)),[q,F]=I.useState(null),H=FM(q),Z=(H==null?void 0:H.width)??0,re=(H==null?void 0:H.height)??0,W=n+(o!=="center"?"-"+o:""),te=typeof b=="number"?b:{top:0,right:0,bottom:0,left:0,...b},oe=Array.isArray(y)?y:[y],ie=oe.length>0,ue={padding:te,boundary:oe.filter(cae),altBoundary:ie},{refs:_e,floatingStyles:xe,placement:be,isPositioned:Ae,middlewareData:me}=Xse({strategy:"fixed",placement:W,whileElementsMounted:(...rr)=>Bse(...rr,{animationFrame:C==="always"}),elements:{reference:O.anchor},middleware:[Zse({mainAxis:i+re,alignmentAxis:h}),p&&Yse({mainAxis:!0,crossAxis:!1,limiter:_==="partial"?Jse():void 0,...ue}),p&&Qse({...ue}),eae({...ue,apply:({elements:rr,rects:ir,availableWidth:or,availableHeight:Sr})=>{const{width:tn,height:Mn}=ir.reference,vn=rr.floating.style;vn.setProperty("--radix-popper-available-width",`${or}px`),vn.setProperty("--radix-popper-available-height",`${Sr}px`),vn.setProperty("--radix-popper-anchor-width",`${tn}px`),vn.setProperty("--radix-popper-anchor-height",`${Mn}px`)}}),q&&rae({element:q,padding:s}),uae({arrowWidth:Z,arrowHeight:re}),E&&tae({strategy:"referenceHidden",...ue})]}),[ke,Ne]=oq(be),Be=pa(k);ps(()=>{Ae&&(Be==null||Be())},[Ae,Be]);const We=(at=me.arrow)==null?void 0:at.x,ut=(Ut=me.arrow)==null?void 0:Ut.y,nt=((ct=me.arrow)==null?void 0:ct.centerOffset)!==0,[Pt,It]=I.useState();return ps(()=>{R&&It(window.getComputedStyle(R).zIndex)},[R]),l.jsx("div",{ref:_e.setFloating,"data-radix-popper-content-wrapper":"",style:{...xe,transform:Ae?xe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Pt,"--radix-popper-transform-origin":[(gt=me.transformOrigin)==null?void 0:gt.x,(it=me.transformOrigin)==null?void 0:it.y].join(" "),...((rt=me.hide)==null?void 0:rt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:l.jsx(aae,{scope:r,placedSide:ke,onArrowChange:F,arrowX:We,arrowY:ut,shouldHideArrow:nt,children:l.jsx(fr.div,{"data-side":ke,"data-align":Ne,...N,ref:B,style:{...N.style,animation:Ae?void 0:"none"}})})})});iq.displayName=VM;var sq="PopperArrow",lae={top:"bottom",right:"left",bottom:"top",left:"right"},aq=I.forwardRef(function(t,r){const{__scopePopper:n,...i}=t,o=oae(sq,n),h=lae[o.placedSide];return l.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:l.jsx(iae,{...i,ref:r,style:{...i.style,display:"block"}})})});aq.displayName=sq;function cae(e){return e!==null}var uae=e=>({name:"transformOrigin",options:e,fn(t){var O,R,L;const{placement:r,rects:n,middlewareData:i}=t,h=((O=i.arrow)==null?void 0:O.centerOffset)!==0,s=h?0:e.arrowWidth,p=h?0:e.arrowHeight,[y,b]=oq(r),_={start:"0%",center:"50%",end:"100%"}[b],E=(((R=i.arrow)==null?void 0:R.x)??0)+s/2,C=(((L=i.arrow)==null?void 0:L.y)??0)+p/2;let k="",N="";return y==="bottom"?(k=h?_:`${E}px`,N=`${-p}px`):y==="top"?(k=h?_:`${E}px`,N=`${n.floating.height+p}px`):y==="right"?(k=`${-p}px`,N=h?_:`${C}px`):y==="left"&&(k=`${n.floating.width+p}px`,N=h?_:`${C}px`),{data:{x:k,y:N}}}});function oq(e){const[t,r="center"]=e.split("-");return[t,r]}var lq=tq,cq=nq,uq=iq,dq=aq,iC="rovingFocusGroup.onEntryFocus",dae={bubbles:!1,cancelable:!0},V0="RovingFocusGroup",[bA,hq,hae]=hE(V0),[fae,mg]=xo(V0,[hae]),[pae,mae]=fae(V0),fq=I.forwardRef((e,t)=>l.jsx(bA.Provider,{scope:e.__scopeRovingFocusGroup,children:l.jsx(bA.Slot,{scope:e.__scopeRovingFocusGroup,children:l.jsx(gae,{...e,ref:t})})}));fq.displayName=V0;var gae=I.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:i=!1,dir:o,currentTabStopId:h,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:p,onEntryFocus:y,preventScrollOnEntryFocus:b=!1,..._}=e,E=I.useRef(null),C=Qr(t,E),k=F0(o),[N,O]=zc({prop:h,defaultProp:s??null,onChange:p,caller:V0}),[R,L]=I.useState(!1),B=pa(y),q=hq(r),F=I.useRef(!1),[H,Z]=I.useState(0);return I.useEffect(()=>{const re=E.current;if(re)return re.addEventListener(iC,B),()=>re.removeEventListener(iC,B)},[B]),l.jsx(pae,{scope:r,orientation:n,dir:k,loop:i,currentTabStopId:N,onItemFocus:I.useCallback(re=>O(re),[O]),onItemShiftTab:I.useCallback(()=>L(!0),[]),onFocusableItemAdd:I.useCallback(()=>Z(re=>re+1),[]),onFocusableItemRemove:I.useCallback(()=>Z(re=>re-1),[]),children:l.jsx(fr.div,{tabIndex:R||H===0?-1:0,"data-orientation":n,..._,ref:C,style:{outline:"none",...e.style},onMouseDown:Zt(e.onMouseDown,()=>{F.current=!0}),onFocus:Zt(e.onFocus,re=>{const W=!F.current;if(re.target===re.currentTarget&&W&&!R){const te=new CustomEvent(iC,dae);if(re.currentTarget.dispatchEvent(te),!te.defaultPrevented){const oe=q().filter(be=>be.focusable),ie=oe.find(be=>be.active),ue=oe.find(be=>be.id===N),xe=[ie,ue,...oe].filter(Boolean).map(be=>be.ref.current);gq(xe,b)}}F.current=!1}),onBlur:Zt(e.onBlur,()=>L(!1))})})}),pq="RovingFocusGroupItem",mq=I.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:i=!1,tabStopId:o,children:h,...s}=e,p=zl(),y=o||p,b=mae(pq,r),_=b.currentTabStopId===y,E=hq(r),{onFocusableItemAdd:C,onFocusableItemRemove:k,currentTabStopId:N}=b;return I.useEffect(()=>{if(n)return C(),()=>k()},[n,C,k]),l.jsx(bA.ItemSlot,{scope:r,id:y,focusable:n,active:i,children:l.jsx(fr.span,{tabIndex:_?0:-1,"data-orientation":b.orientation,...s,ref:t,onMouseDown:Zt(e.onMouseDown,O=>{n?b.onItemFocus(y):O.preventDefault()}),onFocus:Zt(e.onFocus,()=>b.onItemFocus(y)),onKeyDown:Zt(e.onKeyDown,O=>{if(O.key==="Tab"&&O.shiftKey){b.onItemShiftTab();return}if(O.target!==O.currentTarget)return;const R=xae(O,b.orientation,b.dir);if(R!==void 0){if(O.metaKey||O.ctrlKey||O.altKey||O.shiftKey)return;O.preventDefault();let B=E().filter(q=>q.focusable).map(q=>q.ref.current);if(R==="last")B.reverse();else if(R==="prev"||R==="next"){R==="prev"&&B.reverse();const q=B.indexOf(O.currentTarget);B=b.loop?bae(B,q+1):B.slice(q+1)}setTimeout(()=>gq(B))}}),children:typeof h=="function"?h({isCurrentTabStop:_,hasTabStop:N!=null}):h})})});mq.displayName=pq;var yae={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function vae(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function xae(e,t,r){const n=vae(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return yae[n]}function gq(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function bae(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var qM=fq,WM=mq,_ae=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Ap=new WeakMap,tw=new WeakMap,rw={},sC=0,yq=function(e){return e&&(e.host||yq(e.parentNode))},wae=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=yq(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Sae=function(e,t,r,n){var i=wae(t,Array.isArray(e)?e:[e]);rw[r]||(rw[r]=new WeakMap);var o=rw[r],h=[],s=new Set,p=new Set(i),y=function(_){!_||s.has(_)||(s.add(_),y(_.parentNode))};i.forEach(y);var b=function(_){!_||p.has(_)||Array.prototype.forEach.call(_.children,function(E){if(s.has(E))b(E);else try{var C=E.getAttribute(n),k=C!==null&&C!=="false",N=(Ap.get(E)||0)+1,O=(o.get(E)||0)+1;Ap.set(E,N),o.set(E,O),h.push(E),N===1&&k&&tw.set(E,!0),O===1&&E.setAttribute(r,"true"),k||E.setAttribute(n,"true")}catch(R){console.error("aria-hidden: cannot operate on ",E,R)}})};return b(t),s.clear(),sC++,function(){h.forEach(function(_){var E=Ap.get(_)-1,C=o.get(_)-1;Ap.set(_,E),o.set(_,C),E||(tw.has(_)||_.removeAttribute(n),tw.delete(_)),C||_.removeAttribute(r)}),sC--,sC||(Ap=new WeakMap,Ap=new WeakMap,tw=new WeakMap,rw={})}},GM=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),i=t||_ae(e);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live], script"))),Sae(n,i,r,"aria-hidden")):function(){return null}},Il=function(){return Il=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},Il.apply(this,arguments)};function vq(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Eae(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,o;n<i;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}var Ww="right-scroll-bar-position",Gw="width-before-scroll-bar",Tae="with-scroll-bars-hidden",jae="--removed-body-scroll-bar-size";function aC(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Cae(e,t){var r=I.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=t,r.facade}var Pae=typeof window<"u"?I.useLayoutEffect:I.useEffect,g4=new WeakMap;function Aae(e,t){var r=Cae(t||null,function(n){return e.forEach(function(i){return aC(i,n)})});return Pae(function(){var n=g4.get(r);if(n){var i=new Set(n),o=new Set(e),h=r.current;i.forEach(function(s){o.has(s)||aC(s,null)}),o.forEach(function(s){i.has(s)||aC(s,h)})}g4.set(r,e)},[e]),r}function Nae(e){return e}function kae(e,t){t===void 0&&(t=Nae);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(o){var h=t(o,n);return r.push(h),function(){r=r.filter(function(s){return s!==h})}},assignSyncMedium:function(o){for(n=!0;r.length;){var h=r;r=[],h.forEach(o)}r={push:function(s){return o(s)},filter:function(){return r}}},assignMedium:function(o){n=!0;var h=[];if(r.length){var s=r;r=[],s.forEach(o),h=r}var p=function(){var b=h;h=[],b.forEach(o)},y=function(){return Promise.resolve().then(p)};y(),r={push:function(b){h.push(b),y()},filter:function(b){return h=h.filter(b),r}}}};return i}function Mae(e){e===void 0&&(e={});var t=kae(null);return t.options=Il({async:!0,ssr:!1},e),t}var xq=function(e){var t=e.sideCar,r=vq(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return I.createElement(n,Il({},r))};xq.isSideCarExport=!0;function Iae(e,t){return e.useMedium(t),xq}var bq=Mae(),oC=function(){},TE=I.forwardRef(function(e,t){var r=I.useRef(null),n=I.useState({onScrollCapture:oC,onWheelCapture:oC,onTouchMoveCapture:oC}),i=n[0],o=n[1],h=e.forwardProps,s=e.children,p=e.className,y=e.removeScrollBar,b=e.enabled,_=e.shards,E=e.sideCar,C=e.noRelative,k=e.noIsolation,N=e.inert,O=e.allowPinchZoom,R=e.as,L=R===void 0?"div":R,B=e.gapMode,q=vq(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),F=E,H=Aae([r,t]),Z=Il(Il({},q),i);return I.createElement(I.Fragment,null,b&&I.createElement(F,{sideCar:bq,removeScrollBar:y,shards:_,noRelative:C,noIsolation:k,inert:N,setCallbacks:o,allowPinchZoom:!!O,lockRef:r,gapMode:B}),h?I.cloneElement(I.Children.only(s),Il(Il({},Z),{ref:H})):I.createElement(L,Il({},Z,{className:p,ref:H}),s))});TE.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};TE.classNames={fullWidth:Gw,zeroRight:Ww};var y4,Oae=function(){if(y4)return y4;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Rae(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Oae();return t&&e.setAttribute("nonce",t),e}function Dae(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Lae(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Bae=function(){var e=0,t=null;return{add:function(r){e==0&&(t=Rae())&&(Dae(t,r),Lae(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},zae=function(){var e=Bae();return function(t,r){I.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},_q=function(){var e=zae(),t=function(r){var n=r.styles,i=r.dynamic;return e(n,i),null};return t},$ae={left:0,top:0,right:0,gap:0},lC=function(e){return parseInt(e||"",10)||0},Fae=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[lC(r),lC(n),lC(i)]},Uae=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return $ae;var t=Fae(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Vae=_q(),gm="data-scroll-locked",qae=function(e,t,r,n){var i=e.left,o=e.top,h=e.right,s=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(Tae,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(s,"px ").concat(n,`;
  }
  body[`).concat(gm,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(h,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(s,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ww,` {
    right: `).concat(s,"px ").concat(n,`;
  }
  
  .`).concat(Gw,` {
    margin-right: `).concat(s,"px ").concat(n,`;
  }
  
  .`).concat(Ww," .").concat(Ww,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Gw," .").concat(Gw,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(gm,`] {
    `).concat(jae,": ").concat(s,`px;
  }
`)},v4=function(){var e=parseInt(document.body.getAttribute(gm)||"0",10);return isFinite(e)?e:0},Wae=function(){I.useEffect(function(){return document.body.setAttribute(gm,(v4()+1).toString()),function(){var e=v4()-1;e<=0?document.body.removeAttribute(gm):document.body.setAttribute(gm,e.toString())}},[])},Gae=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,i=n===void 0?"margin":n;Wae();var o=I.useMemo(function(){return Uae(i)},[i]);return I.createElement(Vae,{styles:qae(o,!t,i,r?"":"!important")})},_A=!1;if(typeof window<"u")try{var nw=Object.defineProperty({},"passive",{get:function(){return _A=!0,!0}});window.addEventListener("test",nw,nw),window.removeEventListener("test",nw,nw)}catch{_A=!1}var Np=_A?{passive:!1}:!1,Hae=function(e){return e.tagName==="TEXTAREA"},wq=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Hae(e)&&r[t]==="visible")},Xae=function(e){return wq(e,"overflowY")},Kae=function(e){return wq(e,"overflowX")},x4=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var i=Sq(e,n);if(i){var o=Eq(e,n),h=o[1],s=o[2];if(h>s)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Zae=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Yae=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},Sq=function(e,t){return e==="v"?Xae(t):Kae(t)},Eq=function(e,t){return e==="v"?Zae(t):Yae(t)},Jae=function(e,t){return e==="h"&&t==="rtl"?-1:1},Qae=function(e,t,r,n,i){var o=Jae(e,window.getComputedStyle(t).direction),h=o*n,s=r.target,p=t.contains(s),y=!1,b=h>0,_=0,E=0;do{if(!s)break;var C=Eq(e,s),k=C[0],N=C[1],O=C[2],R=N-O-o*k;(k||R)&&Sq(e,s)&&(_+=R,E+=k);var L=s.parentNode;s=L&&L.nodeType===Node.DOCUMENT_FRAGMENT_NODE?L.host:L}while(!p&&s!==document.body||p&&(t.contains(s)||t===s));return(b&&(i&&Math.abs(_)<1||!i&&h>_)||!b&&(i&&Math.abs(E)<1||!i&&-h>E))&&(y=!0),y},iw=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},b4=function(e){return[e.deltaX,e.deltaY]},_4=function(e){return e&&"current"in e?e.current:e},eoe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},toe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},roe=0,kp=[];function noe(e){var t=I.useRef([]),r=I.useRef([0,0]),n=I.useRef(),i=I.useState(roe++)[0],o=I.useState(_q)[0],h=I.useRef(e);I.useEffect(function(){h.current=e},[e]),I.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var N=Eae([e.lockRef.current],(e.shards||[]).map(_4),!0).filter(Boolean);return N.forEach(function(O){return O.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),N.forEach(function(O){return O.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var s=I.useCallback(function(N,O){if("touches"in N&&N.touches.length===2||N.type==="wheel"&&N.ctrlKey)return!h.current.allowPinchZoom;var R=iw(N),L=r.current,B="deltaX"in N?N.deltaX:L[0]-R[0],q="deltaY"in N?N.deltaY:L[1]-R[1],F,H=N.target,Z=Math.abs(B)>Math.abs(q)?"h":"v";if("touches"in N&&Z==="h"&&H.type==="range")return!1;var re=x4(Z,H);if(!re)return!0;if(re?F=Z:(F=Z==="v"?"h":"v",re=x4(Z,H)),!re)return!1;if(!n.current&&"changedTouches"in N&&(B||q)&&(n.current=F),!F)return!0;var W=n.current||F;return Qae(W,O,N,W==="h"?B:q,!0)},[]),p=I.useCallback(function(N){var O=N;if(!(!kp.length||kp[kp.length-1]!==o)){var R="deltaY"in O?b4(O):iw(O),L=t.current.filter(function(F){return F.name===O.type&&(F.target===O.target||O.target===F.shadowParent)&&eoe(F.delta,R)})[0];if(L&&L.should){O.cancelable&&O.preventDefault();return}if(!L){var B=(h.current.shards||[]).map(_4).filter(Boolean).filter(function(F){return F.contains(O.target)}),q=B.length>0?s(O,B[0]):!h.current.noIsolation;q&&O.cancelable&&O.preventDefault()}}},[]),y=I.useCallback(function(N,O,R,L){var B={name:N,delta:O,target:R,should:L,shadowParent:ioe(R)};t.current.push(B),setTimeout(function(){t.current=t.current.filter(function(q){return q!==B})},1)},[]),b=I.useCallback(function(N){r.current=iw(N),n.current=void 0},[]),_=I.useCallback(function(N){y(N.type,b4(N),N.target,s(N,e.lockRef.current))},[]),E=I.useCallback(function(N){y(N.type,iw(N),N.target,s(N,e.lockRef.current))},[]);I.useEffect(function(){return kp.push(o),e.setCallbacks({onScrollCapture:_,onWheelCapture:_,onTouchMoveCapture:E}),document.addEventListener("wheel",p,Np),document.addEventListener("touchmove",p,Np),document.addEventListener("touchstart",b,Np),function(){kp=kp.filter(function(N){return N!==o}),document.removeEventListener("wheel",p,Np),document.removeEventListener("touchmove",p,Np),document.removeEventListener("touchstart",b,Np)}},[]);var C=e.removeScrollBar,k=e.inert;return I.createElement(I.Fragment,null,k?I.createElement(o,{styles:toe(i)}):null,C?I.createElement(Gae,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function ioe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const soe=Iae(bq,noe);var Tq=I.forwardRef(function(e,t){return I.createElement(TE,Il({},e,{ref:t,sideCar:soe}))});Tq.classNames=TE.classNames;const HM=Tq;var wA=["Enter"," "],aoe=["ArrowDown","PageUp","Home"],jq=["ArrowUp","PageDown","End"],ooe=[...aoe,...jq],loe={ltr:[...wA,"ArrowRight"],rtl:[...wA,"ArrowLeft"]},coe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},q0="Menu",[Gx,uoe,doe]=hE(q0),[xf,Cq]=xo(q0,[doe,EE,mg]),jE=EE(),Pq=mg(),[hoe,gg]=xf(q0),[foe,W0]=xf(q0),Aq=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:i,onOpenChange:o,modal:h=!0}=e,s=jE(t),[p,y]=I.useState(null),b=I.useRef(!1),_=pa(o),E=F0(i);return I.useEffect(()=>{const C=()=>{b.current=!0,document.addEventListener("pointerdown",k,{capture:!0,once:!0}),document.addEventListener("pointermove",k,{capture:!0,once:!0})},k=()=>b.current=!1;return document.addEventListener("keydown",C,{capture:!0}),()=>{document.removeEventListener("keydown",C,{capture:!0}),document.removeEventListener("pointerdown",k,{capture:!0}),document.removeEventListener("pointermove",k,{capture:!0})}},[]),l.jsx(lq,{...s,children:l.jsx(hoe,{scope:t,open:r,onOpenChange:_,content:p,onContentChange:y,children:l.jsx(foe,{scope:t,onClose:I.useCallback(()=>_(!1),[_]),isUsingKeyboardRef:b,dir:E,modal:h,children:n})})})};Aq.displayName=q0;var poe="MenuAnchor",XM=I.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,i=jE(r);return l.jsx(cq,{...i,...n,ref:t})});XM.displayName=poe;var moe="MenuPortal",[BUe,Nq]=xf(moe,{forceMount:void 0}),fo="MenuContent",[goe,KM]=xf(fo),kq=I.forwardRef((e,t)=>{const r=Nq(fo,e.__scopeMenu),{forceMount:n=r.forceMount,...i}=e,o=gg(fo,e.__scopeMenu),h=W0(fo,e.__scopeMenu);return l.jsx(Gx.Provider,{scope:e.__scopeMenu,children:l.jsx(Hl,{present:n||o.open,children:l.jsx(Gx.Slot,{scope:e.__scopeMenu,children:h.modal?l.jsx(yoe,{...i,ref:t}):l.jsx(voe,{...i,ref:t})})})})}),yoe=I.forwardRef((e,t)=>{const r=gg(fo,e.__scopeMenu),n=I.useRef(null),i=Qr(t,n);return I.useEffect(()=>{const o=n.current;if(o)return GM(o)},[]),l.jsx(ZM,{...e,ref:i,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Zt(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),voe=I.forwardRef((e,t)=>{const r=gg(fo,e.__scopeMenu);return l.jsx(ZM,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),xoe=af("MenuContent.ScrollLock"),ZM=I.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:h,disableOutsidePointerEvents:s,onEntryFocus:p,onEscapeKeyDown:y,onPointerDownOutside:b,onFocusOutside:_,onInteractOutside:E,onDismiss:C,disableOutsideScroll:k,...N}=e,O=gg(fo,r),R=W0(fo,r),L=jE(r),B=Pq(r),q=uoe(r),[F,H]=I.useState(null),Z=I.useRef(null),re=Qr(t,Z,O.onContentChange),W=I.useRef(0),te=I.useRef(""),oe=I.useRef(0),ie=I.useRef(null),ue=I.useRef("right"),_e=I.useRef(0),xe=k?HM:I.Fragment,be=k?{as:xoe,allowPinchZoom:!0}:void 0,Ae=ke=>{var at,Ut;const Ne=te.current+ke,Be=q().filter(ct=>!ct.disabled),We=document.activeElement,ut=(at=Be.find(ct=>ct.ref.current===We))==null?void 0:at.textValue,nt=Be.map(ct=>ct.textValue),Pt=koe(nt,Ne,ut),It=(Ut=Be.find(ct=>ct.textValue===Pt))==null?void 0:Ut.ref.current;(function ct(gt){te.current=gt,window.clearTimeout(W.current),gt!==""&&(W.current=window.setTimeout(()=>ct(""),1e3))})(Ne),It&&setTimeout(()=>It.focus())};I.useEffect(()=>()=>window.clearTimeout(W.current),[]),IM();const me=I.useCallback(ke=>{var Be,We;return ue.current===((Be=ie.current)==null?void 0:Be.side)&&Ioe(ke,(We=ie.current)==null?void 0:We.area)},[]);return l.jsx(goe,{scope:r,searchRef:te,onItemEnter:I.useCallback(ke=>{me(ke)&&ke.preventDefault()},[me]),onItemLeave:I.useCallback(ke=>{var Ne;me(ke)||((Ne=Z.current)==null||Ne.focus(),H(null))},[me]),onTriggerLeave:I.useCallback(ke=>{me(ke)&&ke.preventDefault()},[me]),pointerGraceTimerRef:oe,onPointerGraceIntentChange:I.useCallback(ke=>{ie.current=ke},[]),children:l.jsx(xe,{...be,children:l.jsx(bE,{asChild:!0,trapped:i,onMountAutoFocus:Zt(o,ke=>{var Ne;ke.preventDefault(),(Ne=Z.current)==null||Ne.focus({preventScroll:!0})}),onUnmountAutoFocus:h,children:l.jsx(B0,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:y,onPointerDownOutside:b,onFocusOutside:_,onInteractOutside:E,onDismiss:C,children:l.jsx(qM,{asChild:!0,...B,dir:R.dir,orientation:"vertical",loop:n,currentTabStopId:F,onCurrentTabStopIdChange:H,onEntryFocus:Zt(p,ke=>{R.isUsingKeyboardRef.current||ke.preventDefault()}),preventScrollOnEntryFocus:!0,children:l.jsx(uq,{role:"menu","aria-orientation":"vertical","data-state":Hq(O.open),"data-radix-menu-content":"",dir:R.dir,...L,...N,ref:re,style:{outline:"none",...N.style},onKeyDown:Zt(N.onKeyDown,ke=>{const Be=ke.target.closest("[data-radix-menu-content]")===ke.currentTarget,We=ke.ctrlKey||ke.altKey||ke.metaKey,ut=ke.key.length===1;Be&&(ke.key==="Tab"&&ke.preventDefault(),!We&&ut&&Ae(ke.key));const nt=Z.current;if(ke.target!==nt||!ooe.includes(ke.key))return;ke.preventDefault();const It=q().filter(at=>!at.disabled).map(at=>at.ref.current);jq.includes(ke.key)&&It.reverse(),Aoe(It)}),onBlur:Zt(e.onBlur,ke=>{ke.currentTarget.contains(ke.target)||(window.clearTimeout(W.current),te.current="")}),onPointerMove:Zt(e.onPointerMove,Hx(ke=>{const Ne=ke.target,Be=_e.current!==ke.clientX;if(ke.currentTarget.contains(Ne)&&Be){const We=ke.clientX>_e.current?"right":"left";ue.current=We,_e.current=ke.clientX}}))})})})})})})});kq.displayName=fo;var boe="MenuGroup",YM=I.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(fr.div,{role:"group",...n,ref:t})});YM.displayName=boe;var _oe="MenuLabel",Mq=I.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(fr.div,{...n,ref:t})});Mq.displayName=_oe;var k1="MenuItem",w4="menu.itemSelect",CE=I.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...i}=e,o=I.useRef(null),h=W0(k1,e.__scopeMenu),s=KM(k1,e.__scopeMenu),p=Qr(t,o),y=I.useRef(!1),b=()=>{const _=o.current;if(!r&&_){const E=new CustomEvent(w4,{bubbles:!0,cancelable:!0});_.addEventListener(w4,C=>n==null?void 0:n(C),{once:!0}),jM(_,E),E.defaultPrevented?y.current=!1:h.onClose()}};return l.jsx(Iq,{...i,ref:p,disabled:r,onClick:Zt(e.onClick,b),onPointerDown:_=>{var E;(E=e.onPointerDown)==null||E.call(e,_),y.current=!0},onPointerUp:Zt(e.onPointerUp,_=>{var E;y.current||(E=_.currentTarget)==null||E.click()}),onKeyDown:Zt(e.onKeyDown,_=>{const E=s.searchRef.current!=="";r||E&&_.key===" "||wA.includes(_.key)&&(_.currentTarget.click(),_.preventDefault())})})});CE.displayName=k1;var Iq=I.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:i,...o}=e,h=KM(k1,r),s=Pq(r),p=I.useRef(null),y=Qr(t,p),[b,_]=I.useState(!1),[E,C]=I.useState("");return I.useEffect(()=>{const k=p.current;k&&C((k.textContent??"").trim())},[o.children]),l.jsx(Gx.ItemSlot,{scope:r,disabled:n,textValue:i??E,children:l.jsx(WM,{asChild:!0,...s,focusable:!n,children:l.jsx(fr.div,{role:"menuitem","data-highlighted":b?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...o,ref:y,onPointerMove:Zt(e.onPointerMove,Hx(k=>{n?h.onItemLeave(k):(h.onItemEnter(k),k.defaultPrevented||k.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Zt(e.onPointerLeave,Hx(k=>h.onItemLeave(k))),onFocus:Zt(e.onFocus,()=>_(!0)),onBlur:Zt(e.onBlur,()=>_(!1))})})})}),woe="MenuCheckboxItem",Oq=I.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...i}=e;return l.jsx(zq,{scope:e.__scopeMenu,checked:r,children:l.jsx(CE,{role:"menuitemcheckbox","aria-checked":M1(r)?"mixed":r,...i,ref:t,"data-state":QM(r),onSelect:Zt(i.onSelect,()=>n==null?void 0:n(M1(r)?!0:!r),{checkForDefaultPrevented:!1})})})});Oq.displayName=woe;var Rq="MenuRadioGroup",[Soe,Eoe]=xf(Rq,{value:void 0,onValueChange:()=>{}}),Dq=I.forwardRef((e,t)=>{const{value:r,onValueChange:n,...i}=e,o=pa(n);return l.jsx(Soe,{scope:e.__scopeMenu,value:r,onValueChange:o,children:l.jsx(YM,{...i,ref:t})})});Dq.displayName=Rq;var Lq="MenuRadioItem",Bq=I.forwardRef((e,t)=>{const{value:r,...n}=e,i=Eoe(Lq,e.__scopeMenu),o=r===i.value;return l.jsx(zq,{scope:e.__scopeMenu,checked:o,children:l.jsx(CE,{role:"menuitemradio","aria-checked":o,...n,ref:t,"data-state":QM(o),onSelect:Zt(n.onSelect,()=>{var h;return(h=i.onValueChange)==null?void 0:h.call(i,r)},{checkForDefaultPrevented:!1})})})});Bq.displayName=Lq;var JM="MenuItemIndicator",[zq,Toe]=xf(JM,{checked:!1}),$q=I.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...i}=e,o=Toe(JM,r);return l.jsx(Hl,{present:n||M1(o.checked)||o.checked===!0,children:l.jsx(fr.span,{...i,ref:t,"data-state":QM(o.checked)})})});$q.displayName=JM;var joe="MenuSeparator",Fq=I.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(fr.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});Fq.displayName=joe;var Coe="MenuArrow",Uq=I.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,i=jE(r);return l.jsx(dq,{...i,...n,ref:t})});Uq.displayName=Coe;var Poe="MenuSub",[zUe,Vq]=xf(Poe),Gv="MenuSubTrigger",qq=I.forwardRef((e,t)=>{const r=gg(Gv,e.__scopeMenu),n=W0(Gv,e.__scopeMenu),i=Vq(Gv,e.__scopeMenu),o=KM(Gv,e.__scopeMenu),h=I.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:p}=o,y={__scopeMenu:e.__scopeMenu},b=I.useCallback(()=>{h.current&&window.clearTimeout(h.current),h.current=null},[]);return I.useEffect(()=>b,[b]),I.useEffect(()=>{const _=s.current;return()=>{window.clearTimeout(_),p(null)}},[s,p]),l.jsx(XM,{asChild:!0,...y,children:l.jsx(Iq,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":i.contentId,"data-state":Hq(r.open),...e,ref:dE(t,i.onTriggerChange),onClick:_=>{var E;(E=e.onClick)==null||E.call(e,_),!(e.disabled||_.defaultPrevented)&&(_.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Zt(e.onPointerMove,Hx(_=>{o.onItemEnter(_),!_.defaultPrevented&&!e.disabled&&!r.open&&!h.current&&(o.onPointerGraceIntentChange(null),h.current=window.setTimeout(()=>{r.onOpenChange(!0),b()},100))})),onPointerLeave:Zt(e.onPointerLeave,Hx(_=>{var C,k;b();const E=(C=r.content)==null?void 0:C.getBoundingClientRect();if(E){const N=(k=r.content)==null?void 0:k.dataset.side,O=N==="right",R=O?-5:5,L=E[O?"left":"right"],B=E[O?"right":"left"];o.onPointerGraceIntentChange({area:[{x:_.clientX+R,y:_.clientY},{x:L,y:E.top},{x:B,y:E.top},{x:B,y:E.bottom},{x:L,y:E.bottom}],side:N}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(_),_.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:Zt(e.onKeyDown,_=>{var C;const E=o.searchRef.current!=="";e.disabled||E&&_.key===" "||loe[n.dir].includes(_.key)&&(r.onOpenChange(!0),(C=r.content)==null||C.focus(),_.preventDefault())})})})});qq.displayName=Gv;var Wq="MenuSubContent",Gq=I.forwardRef((e,t)=>{const r=Nq(fo,e.__scopeMenu),{forceMount:n=r.forceMount,...i}=e,o=gg(fo,e.__scopeMenu),h=W0(fo,e.__scopeMenu),s=Vq(Wq,e.__scopeMenu),p=I.useRef(null),y=Qr(t,p);return l.jsx(Gx.Provider,{scope:e.__scopeMenu,children:l.jsx(Hl,{present:n||o.open,children:l.jsx(Gx.Slot,{scope:e.__scopeMenu,children:l.jsx(ZM,{id:s.contentId,"aria-labelledby":s.triggerId,...i,ref:y,align:"start",side:h.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:b=>{var _;h.isUsingKeyboardRef.current&&((_=p.current)==null||_.focus()),b.preventDefault()},onCloseAutoFocus:b=>b.preventDefault(),onFocusOutside:Zt(e.onFocusOutside,b=>{b.target!==s.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:Zt(e.onEscapeKeyDown,b=>{h.onClose(),b.preventDefault()}),onKeyDown:Zt(e.onKeyDown,b=>{var C;const _=b.currentTarget.contains(b.target),E=coe[h.dir].includes(b.key);_&&E&&(o.onOpenChange(!1),(C=s.trigger)==null||C.focus(),b.preventDefault())})})})})})});Gq.displayName=Wq;function Hq(e){return e?"open":"closed"}function M1(e){return e==="indeterminate"}function QM(e){return M1(e)?"indeterminate":e?"checked":"unchecked"}function Aoe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function Noe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function koe(e,t,r){const i=t.length>1&&Array.from(t).every(y=>y===t[0])?t[0]:t,o=r?e.indexOf(r):-1;let h=Noe(e,Math.max(o,0));i.length===1&&(h=h.filter(y=>y!==r));const p=h.find(y=>y.toLowerCase().startsWith(i.toLowerCase()));return p!==r?p:void 0}function Moe(e,t){const{x:r,y:n}=e;let i=!1;for(let o=0,h=t.length-1;o<t.length;h=o++){const s=t[o],p=t[h],y=s.x,b=s.y,_=p.x,E=p.y;b>n!=E>n&&r<(_-y)*(n-b)/(E-b)+y&&(i=!i)}return i}function Ioe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return Moe(r,t)}function Hx(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Ooe=Aq,Roe=XM,Doe=kq,Loe=YM,Boe=Mq,zoe=CE,$oe=Oq,Foe=Dq,Uoe=Bq,Voe=$q,qoe=Fq,Woe=Uq,Goe=qq,Hoe=Gq,PE="DropdownMenu",[Xoe,$Ue]=xo(PE,[Cq]),ya=Cq(),[Koe,Xq]=Xoe(PE),Kq=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:i,defaultOpen:o,onOpenChange:h,modal:s=!0}=e,p=ya(t),y=I.useRef(null),[b,_]=zc({prop:i,defaultProp:o??!1,onChange:h,caller:PE});return l.jsx(Koe,{scope:t,triggerId:zl(),triggerRef:y,contentId:zl(),open:b,onOpenChange:_,onOpenToggle:I.useCallback(()=>_(E=>!E),[_]),modal:s,children:l.jsx(Ooe,{...p,open:b,onOpenChange:_,dir:n,modal:s,children:r})})};Kq.displayName=PE;var Zq="DropdownMenuTrigger",Yq=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...i}=e,o=Xq(Zq,r),h=ya(r);return l.jsx(Roe,{asChild:!0,...h,children:l.jsx(fr.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...i,ref:dE(t,o.triggerRef),onPointerDown:Zt(e.onPointerDown,s=>{!n&&s.button===0&&s.ctrlKey===!1&&(o.onOpenToggle(),o.open||s.preventDefault())}),onKeyDown:Zt(e.onKeyDown,s=>{n||(["Enter"," "].includes(s.key)&&o.onOpenToggle(),s.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});Yq.displayName=Zq;var Jq="DropdownMenuContent",Qq=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xq(Jq,r),o=ya(r),h=I.useRef(!1);return l.jsx(Doe,{id:i.contentId,"aria-labelledby":i.triggerId,...o,...n,ref:t,onCloseAutoFocus:Zt(e.onCloseAutoFocus,s=>{var p;h.current||(p=i.triggerRef.current)==null||p.focus(),h.current=!1,s.preventDefault()}),onInteractOutside:Zt(e.onInteractOutside,s=>{const p=s.detail.originalEvent,y=p.button===0&&p.ctrlKey===!0,b=p.button===2||y;(!i.modal||b)&&(h.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Qq.displayName=Jq;var Zoe="DropdownMenuGroup",Yoe=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=ya(r);return l.jsx(Loe,{...i,...n,ref:t})});Yoe.displayName=Zoe;var Joe="DropdownMenuLabel",eW=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=ya(r);return l.jsx(Boe,{...i,...n,ref:t})});eW.displayName=Joe;var Qoe="DropdownMenuItem",tW=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=ya(r);return l.jsx(zoe,{...i,...n,ref:t})});tW.displayName=Qoe;var ele="DropdownMenuCheckboxItem",tle=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=ya(r);return l.jsx($oe,{...i,...n,ref:t})});tle.displayName=ele;var rle="DropdownMenuRadioGroup",nle=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=ya(r);return l.jsx(Foe,{...i,...n,ref:t})});nle.displayName=rle;var ile="DropdownMenuRadioItem",sle=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=ya(r);return l.jsx(Uoe,{...i,...n,ref:t})});sle.displayName=ile;var ale="DropdownMenuItemIndicator",ole=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=ya(r);return l.jsx(Voe,{...i,...n,ref:t})});ole.displayName=ale;var lle="DropdownMenuSeparator",rW=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=ya(r);return l.jsx(qoe,{...i,...n,ref:t})});rW.displayName=lle;var cle="DropdownMenuArrow",ule=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=ya(r);return l.jsx(Woe,{...i,...n,ref:t})});ule.displayName=cle;var dle="DropdownMenuSubTrigger",hle=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=ya(r);return l.jsx(Goe,{...i,...n,ref:t})});hle.displayName=dle;var fle="DropdownMenuSubContent",ple=I.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=ya(r);return l.jsx(Hoe,{...i,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});ple.displayName=fle;var mle=Kq,gle=Yq,yle=Qq,vle=eW,xle=tW,ble=rW;const _le=mle,wle=gle,Sle=yle,cC=xle,Ele=vle,S4=ble,Tle="modulepreload",jle=function(e){return"/"+e},E4={},Os=function(t,r,n){if(!r||r.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(r.map(o=>{if(o=jle(o),o in E4)return;E4[o]=!0;const h=o.endsWith(".css"),s=h?'[rel="stylesheet"]':"";if(!!n)for(let b=i.length-1;b>=0;b--){const _=i[b];if(_.href===o&&(!h||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${s}`))return;const y=document.createElement("link");if(y.rel=h?"stylesheet":Tle,h||(y.as="script",y.crossOrigin=""),y.href=o,document.head.appendChild(y),h)return new Promise((b,_)=>{y.addEventListener("load",b),y.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=o,window.dispatchEvent(h),!h.defaultPrevented)throw o})},Cle=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Os(()=>Promise.resolve().then(()=>yg),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class eI extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Ple extends eI{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class T4 extends eI{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class j4 extends eI{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var SA;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(SA||(SA={}));var Ale=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(h){h(o)})}return new(r||(r=Promise))(function(o,h){function s(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?o(b.value):i(b.value).then(s,p)}y((n=n.apply(e,t||[])).next())})};class Nle{constructor(t,{headers:r={},customFetch:n,region:i=SA.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=Cle(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Ale(this,void 0,void 0,function*(){try{const{headers:i,method:o,body:h}=r;let s={},{region:p}=r;p||(p=this.region);const y=new URL(`${this.url}/${t}`);p&&p!=="any"&&(s["x-region"]=p,y.searchParams.set("forceFunctionRegion",p));let b;h&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(s["Content-Type"]="application/octet-stream",b=h):typeof h=="string"?(s["Content-Type"]="text/plain",b=h):typeof FormData<"u"&&h instanceof FormData?b=h:(s["Content-Type"]="application/json",b=JSON.stringify(h)));const _=yield this.fetch(y.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},s),this.headers),i),body:b}).catch(N=>{throw new Ple(N)}),E=_.headers.get("x-relay-error");if(E&&E==="true")throw new T4(_);if(!_.ok)throw new j4(_);let C=((n=_.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),k;return C==="application/json"?k=yield _.json():C==="application/octet-stream"?k=yield _.blob():C==="text/event-stream"?k=_:C==="multipart/form-data"?k=yield _.formData():k=yield _.text(),{data:k,error:null,response:_}}catch(i){return{data:null,error:i,response:i instanceof j4||i instanceof T4?i.context:void 0}}})}}var la={},tI={},AE={},G0={},NE={},kE={},kle=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Mm=kle();const Mle=Mm.fetch,nW=Mm.fetch.bind(Mm),iW=Mm.Headers,Ile=Mm.Request,Ole=Mm.Response,yg=Object.freeze(Object.defineProperty({__proto__:null,Headers:iW,Request:Ile,Response:Ole,default:nW,fetch:Mle},Symbol.toStringTag,{value:"Module"})),Rle=SQ(yg);var ME={};Object.defineProperty(ME,"__esModule",{value:!0});let Dle=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};ME.default=Dle;var sW=us&&us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(kE,"__esModule",{value:!0});const Lle=sW(Rle),Ble=sW(ME);let zle=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Lle.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var h,s,p;let y=null,b=null,_=null,E=o.status,C=o.statusText;if(o.ok){if(this.method!=="HEAD"){const R=await o.text();R===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?b=R:b=JSON.parse(R))}const N=(h=this.headers.Prefer)===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),O=(s=o.headers.get("content-range"))===null||s===void 0?void 0:s.split("/");N&&O&&O.length>1&&(_=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(y={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,_=null,E=406,C="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const N=await o.text();try{y=JSON.parse(N),Array.isArray(y)&&o.status===404&&(b=[],y=null,E=200,C="OK")}catch{o.status===404&&N===""?(E=204,C="No Content"):y={message:N}}if(y&&this.isMaybeSingle&&(!((p=y==null?void 0:y.details)===null||p===void 0)&&p.includes("0 rows"))&&(y=null,E=200,C="OK"),y&&this.shouldThrowOnError)throw new Ble.default(y)}return{error:y,data:b,count:_,status:E,statusText:C}});return this.shouldThrowOnError||(i=i.catch(o=>{var h,s,p;return{error:{message:`${(h=o==null?void 0:o.name)!==null&&h!==void 0?h:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(s=o==null?void 0:o.stack)!==null&&s!==void 0?s:""}`,hint:"",code:`${(p=o==null?void 0:o.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,r)}returns(){return this}overrideTypes(){return this}};kE.default=zle;var $le=us&&us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(NE,"__esModule",{value:!0});const Fle=$le(kE);let Ule=class extends Fle.default{select(t){let r=!1;const n=(t??"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:i,referencedTable:o=i}={}){const h=o?`${o}.order`:"order",s=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${s?`${s},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:i=n}={}){const o=typeof i>"u"?"offset":`${i}.offset`,h=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${t}`),this.url.searchParams.set(h,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:o=!1,format:h="text"}={}){var s;const p=[t?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,o?"wal":null].filter(Boolean).join("|"),y=(s=this.headers.Accept)!==null&&s!==void 0?s:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${h}; for="${y}"; options=${p};`,h==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};NE.default=Ule;var Vle=us&&us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(G0,"__esModule",{value:!0});const qle=Vle(NE);let Wle=class extends qle.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:i}={}){let o="";i==="plain"?o="pl":i==="phrase"?o="ph":i==="websearch"&&(o="w");const h=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${o}fts${h}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};G0.default=Wle;var Gle=us&&us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(AE,"__esModule",{value:!0});const Ev=Gle(G0);let Hle=class{constructor(t,{headers:r={},schema:n,fetch:i}){this.url=t,this.headers=r,this.schema=n,this.fetch=i}select(t,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let o=!1;const h=(t??"*").split("").map(s=>/\s/.test(s)&&!o?"":(s==='"'&&(o=!o),s)).join("");return this.url.searchParams.set("select",h),n&&(this.headers.Prefer=`count=${n}`),new Ev.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const i="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),r&&o.push(`count=${r}`),n||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const h=t.reduce((s,p)=>s.concat(Object.keys(p)),[]);if(h.length>0){const s=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",s.join(","))}}return new Ev.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:o=!0}={}){const h="POST",s=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&s.push(this.headers.Prefer),i&&s.push(`count=${i}`),o||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const p=t.reduce((y,b)=>y.concat(Object.keys(b)),[]);if(p.length>0){const y=[...new Set(p)].map(b=>`"${b}"`);this.url.searchParams.set("columns",y.join(","))}}return new Ev.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),this.headers.Prefer=i.join(","),new Ev.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Ev.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};AE.default=Hle;var IE={},OE={};Object.defineProperty(OE,"__esModule",{value:!0});OE.version=void 0;OE.version="0.0.0-automated";Object.defineProperty(IE,"__esModule",{value:!0});IE.DEFAULT_HEADERS=void 0;const Xle=OE;IE.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Xle.version}`};var aW=us&&us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tI,"__esModule",{value:!0});const Kle=aW(AE),Zle=aW(G0),Yle=IE;let Jle=class oW{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},Yle.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=i}from(t){const r=new URL(`${this.url}/${t}`);return new Kle.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new oW(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:o}={}){let h;const s=new URL(`${this.url}/rpc/${t}`);let p;n||i?(h=n?"HEAD":"GET",Object.entries(r).filter(([b,_])=>_!==void 0).map(([b,_])=>[b,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([b,_])=>{s.searchParams.append(b,_)})):(h="POST",p=r);const y=Object.assign({},this.headers);return o&&(y.Prefer=`count=${o}`),new Zle.default({method:h,url:s,headers:y,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}};tI.default=Jle;var vg=us&&us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(la,"__esModule",{value:!0});la.PostgrestError=la.PostgrestBuilder=la.PostgrestTransformBuilder=la.PostgrestFilterBuilder=la.PostgrestQueryBuilder=la.PostgrestClient=void 0;const lW=vg(tI);la.PostgrestClient=lW.default;const cW=vg(AE);la.PostgrestQueryBuilder=cW.default;const uW=vg(G0);la.PostgrestFilterBuilder=uW.default;const dW=vg(NE);la.PostgrestTransformBuilder=dW.default;const hW=vg(kE);la.PostgrestBuilder=hW.default;const fW=vg(ME);la.PostgrestError=fW.default;var Qle=la.default={PostgrestClient:lW.default,PostgrestQueryBuilder:cW.default,PostgrestFilterBuilder:uW.default,PostgrestTransformBuilder:dW.default,PostgrestBuilder:hW.default,PostgrestError:fW.default};const{PostgrestClient:ece,PostgrestQueryBuilder:GUe,PostgrestFilterBuilder:HUe,PostgrestTransformBuilder:XUe,PostgrestBuilder:KUe,PostgrestError:ZUe}=Qle;function tce(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const rce=tce(),nce="2.11.15",ice=`realtime-js/${nce}`,sce="1.0.0",pW=1e4,ace=1e3;var ox;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ox||(ox={}));var js;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(js||(js={}));var Zo;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Zo||(Zo={}));var EA;(function(e){e.websocket="websocket"})(EA||(EA={}));var Bh;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Bh||(Bh={}));class oce{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),o=r.getUint8(2);let h=this.HEADER_LENGTH+2;const s=n.decode(t.slice(h,h+i));h=h+i;const p=n.decode(t.slice(h,h+o));h=h+o;const y=JSON.parse(n.decode(t.slice(h,t.byteLength)));return{ref:null,topic:s,event:p,payload:y}}}class mW{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Rn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Rn||(Rn={}));const C4=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((o,h)=>(o[h]=lce(h,e,t,i),o),{})},lce=(e,t,r,n)=>{const i=t.find(s=>s.name===e),o=i==null?void 0:i.type,h=r[e];return o&&!n.includes(o)?gW(o,h):TA(h)},gW=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return hce(t,r)}switch(e){case Rn.bool:return cce(t);case Rn.float4:case Rn.float8:case Rn.int2:case Rn.int4:case Rn.int8:case Rn.numeric:case Rn.oid:return uce(t);case Rn.json:case Rn.jsonb:return dce(t);case Rn.timestamp:return fce(t);case Rn.abstime:case Rn.date:case Rn.daterange:case Rn.int4range:case Rn.int8range:case Rn.money:case Rn.reltime:case Rn.text:case Rn.time:case Rn.timestamptz:case Rn.timetz:case Rn.tsrange:case Rn.tstzrange:return TA(t);default:return TA(t)}},TA=e=>e,cce=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},uce=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},dce=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},hce=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let o;const h=e.slice(1,r);try{o=JSON.parse("["+h+"]")}catch{o=h?h.split(","):[]}return o.map(s=>gW(t,s))}return e},fce=e=>typeof e=="string"?e.replace(" ","T"):e,yW=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class uC{constructor(t,r,n={},i=pW){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var P4;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(P4||(P4={}));class lx{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:o,onLeave:h,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lx.syncState(this.state,i,o,h),this.pendingDiffs.forEach(p=>{this.state=lx.syncDiff(this.state,p,o,h)}),this.pendingDiffs=[],s()}),this.channel._on(n.diff,{},i=>{const{onJoin:o,onLeave:h,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=lx.syncDiff(this.state,i,o,h),s())}),this.onJoin((i,o,h)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:h})}),this.onLeave((i,o,h)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const o=this.cloneDeep(t),h=this.transformState(r),s={},p={};return this.map(o,(y,b)=>{h[y]||(p[y]=b)}),this.map(h,(y,b)=>{const _=o[y];if(_){const E=b.map(O=>O.presence_ref),C=_.map(O=>O.presence_ref),k=b.filter(O=>C.indexOf(O.presence_ref)<0),N=_.filter(O=>E.indexOf(O.presence_ref)<0);k.length>0&&(s[y]=k),N.length>0&&(p[y]=N)}else s[y]=b}),this.syncDiff(o,{joins:s,leaves:p},n,i)}static syncDiff(t,r,n,i){const{joins:o,leaves:h}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(o,(s,p)=>{var y;const b=(y=t[s])!==null&&y!==void 0?y:[];if(t[s]=this.cloneDeep(p),b.length>0){const _=t[s].map(C=>C.presence_ref),E=b.filter(C=>_.indexOf(C.presence_ref)<0);t[s].unshift(...E)}n(s,b,p)}),this.map(h,(s,p)=>{let y=t[s];if(!y)return;const b=p.map(_=>_.presence_ref);y=y.filter(_=>b.indexOf(_.presence_ref)<0),t[s]=y,i(s,y,p),y.length===0&&delete t[s]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var A4;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(A4||(A4={}));var N4;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(N4||(N4={}));var vc;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(vc||(vc={}));class rI{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=js.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new uC(this,Zo.join,this.params,this.timeout),this.rejoinTimer=new mW(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=js.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=js.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=js.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=js.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Zo.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new lx(this),this.broadcastEndpointURL=yW(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==js.closed){const{config:{broadcast:o,presence:h,private:s}}=this.params;this._onError(b=>t==null?void 0:t(vc.CHANNEL_ERROR,b)),this._onClose(()=>t==null?void 0:t(vc.CLOSED));const p={},y={broadcast:o,presence:h,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(b=>b.filter))!==null&&i!==void 0?i:[],private:s};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:y},p)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:b})=>{var _;if(this.socket.setAuth(),b===void 0){t==null||t(vc.SUBSCRIBED);return}else{const E=this.bindings.postgres_changes,C=(_=E==null?void 0:E.length)!==null&&_!==void 0?_:0,k=[];for(let N=0;N<C;N++){const O=E[N],{filter:{event:R,schema:L,table:B,filter:q}}=O,F=b&&b[N];if(F&&F.event===R&&F.schema===L&&F.table===B&&F.filter===q)k.push(Object.assign(Object.assign({},O),{id:F.id}));else{this.unsubscribe(),this.state=js.errored,t==null||t(vc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,t&&t(vc.SUBSCRIBED);return}}).receive("error",b=>{this.state=js.errored,t==null||t(vc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(vc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){const{event:o,payload:h}=t,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:h,private:this.private}]})};try{const y=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=y.body)===null||i===void 0?void 0:i.cancel()),y.ok?"ok":"error"}catch(y){return y.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var h,s,p;const y=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((p=(s=(h=this.params)===null||h===void 0?void 0:h.config)===null||s===void 0?void 0:s.broadcast)===null||p===void 0)&&p.ack)&&o("ok"),y.receive("ok",()=>o("ok")),y.receive("error",()=>o("error")),y.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=js.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Zo.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new uC(this,Zo.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const i=new AbortController,o=setTimeout(()=>i.abort(),n),h=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(o),h}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new uC(this,t,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,o;const h=t.toLocaleLowerCase(),{close:s,error:p,leave:y,join:b}=Zo;if(n&&[s,p,y,b].indexOf(h)>=0&&n!==this._joinRef())return;let E=this._onMessage(h,r,n);if(r&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(C=>{var k,N,O;return((k=C.filter)===null||k===void 0?void 0:k.event)==="*"||((O=(N=C.filter)===null||N===void 0?void 0:N.event)===null||O===void 0?void 0:O.toLocaleLowerCase())===h}).map(C=>C.callback(E,n)):(o=this.bindings[h])===null||o===void 0||o.filter(C=>{var k,N,O,R,L,B;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in C){const q=C.id,F=(k=C.filter)===null||k===void 0?void 0:k.event;return q&&((N=r.ids)===null||N===void 0?void 0:N.includes(q))&&(F==="*"||(F==null?void 0:F.toLocaleLowerCase())===((O=r.data)===null||O===void 0?void 0:O.type.toLocaleLowerCase()))}else{const q=(L=(R=C==null?void 0:C.filter)===null||R===void 0?void 0:R.event)===null||L===void 0?void 0:L.toLocaleLowerCase();return q==="*"||q===((B=r==null?void 0:r.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return C.type.toLocaleLowerCase()===h}).map(C=>{if(typeof E=="object"&&"ids"in E){const k=E.data,{schema:N,table:O,commit_timestamp:R,type:L,errors:B}=k;E=Object.assign(Object.assign({},{schema:N,table:O,commit_timestamp:R,eventType:L,new:{},old:{},errors:B}),this._getPayloadRecords(k))}C.callback(E,n)})}_isClosed(){return this.state===js.closed}_isJoined(){return this.state===js.joined}_isJoining(){return this.state===js.joining}_isLeaving(){return this.state===js.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),o={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&rI.isEqual(i.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Zo.close,{},t)}_onError(t){this._on(Zo.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=js.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=C4(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=C4(t.columns,t.old_record)),r}}const k4=()=>{},pce=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class mce{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=pW,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=k4,this.ref=0,this.logger=k4,this.conn=null,this.sendBuffer=[],this.serializer=new oce,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=o=>{let h;return o?h=o:typeof fetch>"u"?h=(...s)=>Os(()=>Promise.resolve().then(()=>yg),void 0).then(({default:p})=>p(...s)):h=fetch,(...s)=>h(...s)},this.endPoint=`${t}/${EA.websocket}`,this.httpEndpoint=yW(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(o,h)=>h(JSON.stringify(o)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new mW(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=rce),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:sce}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ox.connecting:return Bh.Connecting;case ox.open:return Bh.Open;case ox.closing:return Bh.Closing;default:return Bh.Closed}}isConnected(){return this.connectionState()===Bh.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(o=>o.topic===n);if(i)return i;{const o=new rI(`realtime:${t}`,r,this);return this.channels.push(o),o}}push(t){const{topic:r,event:n,payload:i,ref:o}=t,h=()=>{this.encode(t,s=>{var p;(p=this.conn)===null||p===void 0||p.send(s)})};this.log("push",`${r} ${n} (${o})`,i),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:ice};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Zo.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(ace,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:i,payload:o,ref:h}=r;n==="phoenix"&&i==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),h&&h===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${n} ${i} ${h&&"("+h+")"||""}`,o),Array.from(this.channels).filter(s=>s._isMember(n)).forEach(s=>s._trigger(i,o,h)),this.stateChangeCallbacks.message.forEach(s=>s(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Zo.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([pce],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class nI extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Yi(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class gce extends nI{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class jA extends nI{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var yce=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(h){h(o)})}return new(r||(r=Promise))(function(o,h){function s(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?o(b.value):i(b.value).then(s,p)}y((n=n.apply(e,t||[])).next())})};const vW=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Os(()=>Promise.resolve().then(()=>yg),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},vce=()=>yce(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Os(()=>Promise.resolve().then(()=>yg),void 0)).Response:Response}),CA=e=>{if(Array.isArray(e))return e.map(r=>CA(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[i]=CA(n)}),t};var bf=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(h){h(o)})}return new(r||(r=Promise))(function(o,h){function s(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?o(b.value):i(b.value).then(s,p)}y((n=n.apply(e,t||[])).next())})};const dC=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),xce=(e,t,r)=>bf(void 0,void 0,void 0,function*(){const n=yield vce();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{t(new gce(dC(i),e.status||500))}).catch(i=>{t(new jA(dC(i),i))}):t(new jA(dC(e),e))}),bce=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),r))};function H0(e,t,r,n,i,o){return bf(this,void 0,void 0,function*(){return new Promise((h,s)=>{e(r,bce(t,n,i,o)).then(p=>{if(!p.ok)throw p;return n!=null&&n.noResolveJson?p:p.json()}).then(p=>h(p)).catch(p=>xce(p,s,n))})})}function I1(e,t,r,n){return bf(this,void 0,void 0,function*(){return H0(e,"GET",t,r,n)})}function qu(e,t,r,n,i){return bf(this,void 0,void 0,function*(){return H0(e,"POST",t,n,i,r)})}function _ce(e,t,r,n,i){return bf(this,void 0,void 0,function*(){return H0(e,"PUT",t,n,i,r)})}function wce(e,t,r,n){return bf(this,void 0,void 0,function*(){return H0(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function xW(e,t,r,n,i){return bf(this,void 0,void 0,function*(){return H0(e,"DELETE",t,n,i,r)})}var aa=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(h){h(o)})}return new(r||(r=Promise))(function(o,h){function s(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?o(b.value):i(b.value).then(s,p)}y((n=n.apply(e,t||[])).next())})};const Sce={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},M4={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ece{constructor(t,r={},n,i){this.url=t,this.headers=r,this.bucketId=n,this.fetch=vW(i)}uploadOrUpdate(t,r,n,i){return aa(this,void 0,void 0,function*(){try{let o;const h=Object.assign(Object.assign({},M4),i);let s=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(h.upsert)});const p=h.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",h.cacheControl),p&&o.append("metadata",this.encodeMetadata(p)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",h.cacheControl),p&&o.append("metadata",this.encodeMetadata(p))):(o=n,s["cache-control"]=`max-age=${h.cacheControl}`,s["content-type"]=h.contentType,p&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(p)))),i!=null&&i.headers&&(s=Object.assign(Object.assign({},s),i.headers));const y=this._removeEmptyFolders(r),b=this._getFinalPath(y),_=yield this.fetch(`${this.url}/object/${b}`,Object.assign({method:t,body:o,headers:s},h!=null&&h.duplex?{duplex:h.duplex}:{})),E=yield _.json();return _.ok?{data:{path:y,id:E.Id,fullPath:E.Key},error:null}:{data:null,error:E}}catch(o){if(Yi(o))return{data:null,error:o};throw o}})}upload(t,r,n){return aa(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return aa(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(t),h=this._getFinalPath(o),s=new URL(this.url+`/object/upload/sign/${h}`);s.searchParams.set("token",r);try{let p;const y=Object.assign({upsert:M4.upsert},i),b=Object.assign(Object.assign({},this.headers),{"x-upsert":String(y.upsert)});typeof Blob<"u"&&n instanceof Blob?(p=new FormData,p.append("cacheControl",y.cacheControl),p.append("",n)):typeof FormData<"u"&&n instanceof FormData?(p=n,p.append("cacheControl",y.cacheControl)):(p=n,b["cache-control"]=`max-age=${y.cacheControl}`,b["content-type"]=y.contentType);const _=yield this.fetch(s.toString(),{method:"PUT",body:p,headers:b}),E=yield _.json();return _.ok?{data:{path:o,fullPath:E.Key},error:null}:{data:null,error:E}}catch(p){if(Yi(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(t,r){return aa(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const o=yield qu(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),h=new URL(this.url+o.url),s=h.searchParams.get("token");if(!s)throw new nI("No token returned by API");return{data:{signedUrl:h.toString(),path:t,token:s},error:null}}catch(n){if(Yi(n))return{data:null,error:n};throw n}})}update(t,r,n){return aa(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return aa(this,void 0,void 0,function*(){try{return{data:yield qu(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(Yi(i))return{data:null,error:i};throw i}})}copy(t,r,n){return aa(this,void 0,void 0,function*(){try{return{data:{path:(yield qu(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(Yi(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return aa(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),o=yield qu(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const h=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${h}`)},{data:o,error:null}}catch(i){if(Yi(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return aa(this,void 0,void 0,function*(){try{const i=yield qu(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(h=>Object.assign(Object.assign({},h),{signedUrl:h.signedURL?encodeURI(`${this.url}${h.signedURL}${o}`):null})),error:null}}catch(i){if(Yi(i))return{data:null,error:i};throw i}})}download(t,r){return aa(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),h=o?`?${o}`:"";try{const s=this._getFinalPath(t);return{data:yield(yield I1(this.fetch,`${this.url}/${i}/${s}${h}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(s){if(Yi(s))return{data:null,error:s};throw s}})}info(t){return aa(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield I1(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:CA(n),error:null}}catch(n){if(Yi(n))return{data:null,error:n};throw n}})}exists(t){return aa(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield wce(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Yi(n)&&n instanceof jA){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],o=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&i.push(o);const s=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",p=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});p!==""&&i.push(p);let y=i.join("&");return y!==""&&(y=`?${y}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${n}${y}`)}}}remove(t){return aa(this,void 0,void 0,function*(){try{return{data:yield xW(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Yi(r))return{data:null,error:r};throw r}})}list(t,r,n){return aa(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Sce),r),{prefix:t||""});return{data:yield qu(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(Yi(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Tce="2.7.1",jce={"X-Client-Info":`storage-js/${Tce}`};var Mp=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(h){h(o)})}return new(r||(r=Promise))(function(o,h){function s(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?o(b.value):i(b.value).then(s,p)}y((n=n.apply(e,t||[])).next())})};class Cce{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},jce),r),this.fetch=vW(n)}listBuckets(){return Mp(this,void 0,void 0,function*(){try{return{data:yield I1(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Yi(t))return{data:null,error:t};throw t}})}getBucket(t){return Mp(this,void 0,void 0,function*(){try{return{data:yield I1(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Yi(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Mp(this,void 0,void 0,function*(){try{return{data:yield qu(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Yi(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Mp(this,void 0,void 0,function*(){try{return{data:yield _ce(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Yi(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Mp(this,void 0,void 0,function*(){try{return{data:yield qu(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Yi(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Mp(this,void 0,void 0,function*(){try{return{data:yield xW(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Yi(r))return{data:null,error:r};throw r}})}}class Pce extends Cce{constructor(t,r={},n){super(t,r,n)}from(t){return new Ece(this.url,this.headers,t,this.fetch)}}const Ace="2.50.3";let Hv="";typeof Deno<"u"?Hv="deno":typeof document<"u"?Hv="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Hv="react-native":Hv="node";const Nce={"X-Client-Info":`supabase-js-${Hv}/${Ace}`},kce={headers:Nce},Mce={schema:"public"},Ice={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Oce={};var Rce=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(h){h(o)})}return new(r||(r=Promise))(function(o,h){function s(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?o(b.value):i(b.value).then(s,p)}y((n=n.apply(e,t||[])).next())})};const Dce=e=>{let t;return e?t=e:typeof fetch>"u"?t=nW:t=fetch,(...r)=>t(...r)},Lce=()=>typeof Headers>"u"?iW:Headers,Bce=(e,t,r)=>{const n=Dce(r),i=Lce();return(o,h)=>Rce(void 0,void 0,void 0,function*(){var s;const p=(s=yield t())!==null&&s!==void 0?s:e;let y=new i(h==null?void 0:h.headers);return y.has("apikey")||y.set("apikey",e),y.has("Authorization")||y.set("Authorization",`Bearer ${p}`),n(o,Object.assign(Object.assign({},h),{headers:y}))})};var zce=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(h){h(o)})}return new(r||(r=Promise))(function(o,h){function s(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?o(b.value):i(b.value).then(s,p)}y((n=n.apply(e,t||[])).next())})};function $ce(e){return e.endsWith("/")?e:e+"/"}function Fce(e,t){var r,n;const{db:i,auth:o,realtime:h,global:s}=e,{db:p,auth:y,realtime:b,global:_}=t,E={db:Object.assign(Object.assign({},p),i),auth:Object.assign(Object.assign({},y),o),realtime:Object.assign(Object.assign({},b),h),global:Object.assign(Object.assign(Object.assign({},_),s),{headers:Object.assign(Object.assign({},(r=_==null?void 0:_.headers)!==null&&r!==void 0?r:{}),(n=s==null?void 0:s.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>zce(this,void 0,void 0,function*(){return""})};return e.accessToken?E.accessToken=e.accessToken:delete E.accessToken,E}const bW="2.70.0",Up=30*1e3,PA=3,hC=PA*Up,Uce="http://localhost:9999",Vce="supabase.auth.token",qce={"X-Client-Info":`gotrue-js/${bW}`},AA="X-Supabase-Api-Version",_W={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Wce=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Gce=6e5;class iI extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function kr(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Hce extends iI{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Xce(e){return kr(e)&&e.name==="AuthApiError"}class wW extends iI{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Cd extends iI{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Lu extends Cd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Kce(e){return kr(e)&&e.name==="AuthSessionMissingError"}class sw extends Cd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class aw extends Cd{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ow extends Cd{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Zce(e){return kr(e)&&e.name==="AuthImplicitGrantRedirectError"}class I4 extends Cd{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class NA extends Cd{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function fC(e){return kr(e)&&e.name==="AuthRetryableFetchError"}class O4 extends Cd{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class cx extends Cd{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const O1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),R4=` 	
\r=`.split(""),Yce=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<R4.length;t+=1)e[R4[t].charCodeAt(0)]=-2;for(let t=0;t<O1.length;t+=1)e[O1[t].charCodeAt(0)]=t;return e})();function D4(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(O1[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(O1[n]),t.queuedBits-=6}}function SW(e,t,r){const n=Yce[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function L4(e){const t=[],r=h=>{t.push(String.fromCodePoint(h))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},o=h=>{eue(h,n,r)};for(let h=0;h<e.length;h+=1)SW(e.charCodeAt(h),i,o);return t.join("")}function Jce(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Qce(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}Jce(n,t)}}function eue(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function tue(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)SW(e.charCodeAt(i),r,n);return new Uint8Array(t)}function rue(e){const t=[];return Qce(e,r=>t.push(r)),new Uint8Array(t)}function nue(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>D4(i,r,n)),D4(null,r,n),t.join("")}function iue(e){return Math.round(Date.now()/1e3)+e}function sue(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Go=()=>typeof window<"u"&&typeof document<"u",Eh={tested:!1,writable:!1},ux=()=>{if(!Go())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Eh.tested)return Eh.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Eh.tested=!0,Eh.writable=!0}catch{Eh.tested=!0,Eh.writable=!1}return Eh.writable};function aue(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,o)=>{t[o]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const EW=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Os(()=>Promise.resolve().then(()=>yg),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},oue=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",TW=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},lw=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},cw=async(e,t)=>{await e.removeItem(t)};class RE{constructor(){this.promise=new RE.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}RE.promiseConstructor=Promise;function pC(e){const t=e.split(".");if(t.length!==3)throw new cx("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Wce.test(t[n]))throw new cx("JWT not in base64url format");return{header:JSON.parse(L4(t[0])),payload:JSON.parse(L4(t[1])),signature:tue(t[2]),raw:{header:t[0],payload:t[1]}}}async function lue(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function cue(e,t){return new Promise((n,i)=>{(async()=>{for(let o=0;o<1/0;o++)try{const h=await e(o);if(!t(o,null,h)){n(h);return}}catch(h){if(!t(o,h)){i(h);return}}})()})}function uue(e){return("0"+e.toString(16)).substr(-2)}function due(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let o=0;o<56;o++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,uue).join("")}async function hue(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(o=>String.fromCharCode(o)).join("")}async function fue(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await hue(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ip(e,t,r=!1){const n=due();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await TW(e,`${t}-code-verifier`,i);const o=await fue(n);return[o,n===o?"plain":"s256"]}const pue=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function mue(e){const t=e.headers.get(AA);if(!t||!t.match(pue))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function gue(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function yue(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const vue=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Op(e){if(!vue.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var xue=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const Nh=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),bue=[502,503,504];async function B4(e){var t;if(!oue(e))throw new NA(Nh(e),0);if(bue.includes(e.status))throw new NA(Nh(e),e.status);let r;try{r=await e.json()}catch(o){throw new wW(Nh(o),o)}let n;const i=mue(e);if(i&&i.getTime()>=_W["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new O4(Nh(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Lu}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,h)=>o&&typeof h=="string",!0))throw new O4(Nh(r),e.status,r.weak_password.reasons);throw new Hce(Nh(r),e.status||500,n)}const _ue=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Ur(e,t,r,n){var i;const o=Object.assign({},n==null?void 0:n.headers);o[AA]||(o[AA]=_W["2024-01-01"].name),n!=null&&n.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const h=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(h.redirect_to=n.redirectTo);const s=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",p=await wue(e,t,r+s,{headers:o,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(p):{data:Object.assign({},p),error:null}}async function wue(e,t,r,n,i,o){const h=_ue(t,n,i,o);let s;try{s=await e(r,Object.assign({},h))}catch(p){throw console.error(p),new NA(Nh(p),0)}if(s.ok||await B4(s),n!=null&&n.noResolveJson)return s;try{return await s.json()}catch(p){await B4(p)}}function gc(e){var t;let r=null;jue(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=iue(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function z4(e){const t=gc(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ku(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Sue(e){return{data:e,error:null}}function Eue(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:o}=e,h=xue(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),s={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:o},p=Object.assign({},h);return{data:{properties:s,user:p},error:null}}function Tue(e){return e}function jue(e){return e.access_token&&e.refresh_token&&e.expires_in}const mC=["global","local","others"];var Cue=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class Pue{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=EW(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=mC[0]){if(mC.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${mC.join(", ")}`);try{return await Ur(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(kr(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ur(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ku})}catch(n){if(kr(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Cue(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Ur(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Eue,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(kr(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ur(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ku})}catch(r){if(kr(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,o,h,s,p;try{const y={nextPage:null,lastPage:0,total:0},b=await Ur(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:Tue});if(b.error)throw b.error;const _=await b.json(),E=(h=b.headers.get("x-total-count"))!==null&&h!==void 0?h:0,C=(p=(s=b.headers.get("link"))===null||s===void 0?void 0:s.split(","))!==null&&p!==void 0?p:[];return C.length>0&&(C.forEach(k=>{const N=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(k.split(";")[1].split("=")[1]);y[`${O}Page`]=N}),y.total=parseInt(E)),{data:Object.assign(Object.assign({},_),y),error:null}}catch(y){if(kr(y))return{data:{users:[]},error:y};throw y}}async getUserById(t){Op(t);try{return await Ur(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ku})}catch(r){if(kr(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Op(t);try{return await Ur(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ku})}catch(n){if(kr(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Op(t);try{return await Ur(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ku})}catch(n){if(kr(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Op(t.userId);try{const{data:r,error:n}=await Ur(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(kr(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Op(t.userId),Op(t.id);try{return{data:await Ur(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(kr(r))return{data:null,error:r};throw r}}}const Aue={getItem:e=>ux()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{ux()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{ux()&&globalThis.localStorage.removeItem(e)}};function $4(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function Nue(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Rp={debug:!!(globalThis&&ux()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class jW extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class kue extends jW{}async function Mue(e,t,r){Rp.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Rp.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Rp.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{Rp.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Rp.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new kue(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Rp.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Nue();const Iue={url:Uce,storageKey:Vce,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:qce,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function F4(e,t,r){return await r()}class Xx{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Xx.nextInstanceID,Xx.nextInstanceID+=1,this.instanceID>0&&Go()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Iue),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Pue({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=EW(i.fetch),this.lock=i.lock||F4,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Go()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Mue:this.lock=F4,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:ux()?this.storage=Aue:(this.memoryStorage={},this.storage=$4(this.memoryStorage)):(this.memoryStorage={},this.storage=$4(this.memoryStorage)),Go()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${bW}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=aue(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Go()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:o}=await this._getSessionFromURL(r,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Zce(o)){const p=(t=o.details)===null||t===void 0?void 0:t.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:h,redirectType:s}=i;return this._debug("#_initialize()","detected session in URL",h,"redirect type",s),await this._saveSession(h),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return kr(r)?{error:r}:{error:new wW("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const o=await Ur(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:gc}),{data:h,error:s}=o;if(s||!h)return{data:{user:null,session:null},error:s};const p=h.session,y=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:y,session:p},error:null}}catch(o){if(kr(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(t){var r,n,i;try{let o;if("email"in t){const{email:b,password:_,options:E}=t;let C=null,k=null;this.flowType==="pkce"&&([C,k]=await Ip(this.storage,this.storageKey)),o=await Ur(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:b,password:_,data:(r=E==null?void 0:E.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:C,code_challenge_method:k},xform:gc})}else if("phone"in t){const{phone:b,password:_,options:E}=t;o=await Ur(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:_,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},channel:(i=E==null?void 0:E.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:gc})}else throw new aw("You must provide either an email or phone number and a password");const{data:h,error:s}=o;if(s||!h)return{data:{user:null,session:null},error:s};const p=h.session,y=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:y,session:p},error:null}}catch(o){if(kr(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(t){try{let r;if("email"in t){const{email:o,password:h,options:s}=t;r=await Ur(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:h,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:z4})}else if("phone"in t){const{phone:o,password:h,options:s}=t;r=await Ur(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:h,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:z4})}else throw new aw("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new sw}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(kr(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,i,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,i,o,h,s,p,y,b,_,E,C;let k,N;if("message"in t)k=t.message,N=t.signature;else{const{chain:O,wallet:R,statement:L,options:B}=t;let q;if(Go())if(typeof R=="object")q=R;else{const H=window;if("solana"in H&&typeof H.solana=="object"&&("signIn"in H.solana&&typeof H.solana.signIn=="function"||"signMessage"in H.solana&&typeof H.solana.signMessage=="function"))q=H.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!(B!=null&&B.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");q=R}const F=new URL((r=B==null?void 0:B.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in q&&q.signIn){const H=await q.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B==null?void 0:B.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),L?{statement:L}:null));let Z;if(Array.isArray(H)&&H[0]&&typeof H[0]=="object")Z=H[0];else if(H&&typeof H=="object"&&"signedMessage"in H&&"signature"in H)Z=H;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Z&&"signature"in Z&&(typeof Z.signedMessage=="string"||Z.signedMessage instanceof Uint8Array)&&Z.signature instanceof Uint8Array)k=typeof Z.signedMessage=="string"?Z.signedMessage:new TextDecoder().decode(Z.signedMessage),N=Z.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in q)||typeof q.signMessage!="function"||!("publicKey"in q)||typeof q!="object"||!q.publicKey||!("toBase58"in q.publicKey)||typeof q.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");k=[`${F.host} wants you to sign in with your Solana account:`,q.publicKey.toBase58(),...L?["",L,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(i=(n=B==null?void 0:B.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((o=B==null?void 0:B.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((h=B==null?void 0:B.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((s=B==null?void 0:B.signInWithSolana)===null||s===void 0)&&s.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((p=B==null?void 0:B.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((y=B==null?void 0:B.signInWithSolana)===null||y===void 0)&&y.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((_=(b=B==null?void 0:B.signInWithSolana)===null||b===void 0?void 0:b.resources)===null||_===void 0)&&_.length?["Resources",...B.signInWithSolana.resources.map(Z=>`- ${Z}`)]:[]].join(`
`);const H=await q.signMessage(new TextEncoder().encode(k),"utf8");if(!H||!(H instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");N=H}}try{const{data:O,error:R}=await Ur(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:k,signature:nue(N)},!((E=t.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(C=t.options)===null||C===void 0?void 0:C.captchaToken}}:null),xform:gc});if(R)throw R;return!O||!O.session||!O.user?{data:{user:null,session:null},error:new sw}:(O.session&&(await this._saveSession(O.session),await this._notifyAllSubscribers("SIGNED_IN",O.session)),{data:Object.assign({},O),error:R})}catch(O){if(kr(O))return{data:{user:null,session:null},error:O};throw O}}async _exchangeCodeForSession(t){const r=await lw(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:o,error:h}=await Ur(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:gc});if(await cw(this.storage,`${this.storageKey}-code-verifier`),h)throw h;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new sw}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:i??null}),error:h})}catch(o){if(kr(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:o,nonce:h}=t,s=await Ur(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:o,nonce:h,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:gc}),{data:p,error:y}=s;return y?{data:{user:null,session:null},error:y}:!p||!p.session||!p.user?{data:{user:null,session:null},error:new sw}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),{data:p,error:y})}catch(r){if(kr(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,i,o,h;try{if("email"in t){const{email:s,options:p}=t;let y=null,b=null;this.flowType==="pkce"&&([y,b]=await Ip(this.storage,this.storageKey));const{error:_}=await Ur(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},create_user:(n=p==null?void 0:p.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:y,code_challenge_method:b},redirectTo:p==null?void 0:p.emailRedirectTo});return{data:{user:null,session:null},error:_}}if("phone"in t){const{phone:s,options:p}=t,{data:y,error:b}=await Ur(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:s,data:(i=p==null?void 0:p.data)!==null&&i!==void 0?i:{},create_user:(o=p==null?void 0:p.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},channel:(h=p==null?void 0:p.channel)!==null&&h!==void 0?h:"sms"}});return{data:{user:null,session:null,messageId:y==null?void 0:y.message_id},error:b}}throw new aw("You must provide either an email or phone number.")}catch(s){if(kr(s))return{data:{user:null,session:null},error:s};throw s}}async verifyOtp(t){var r,n;try{let i,o;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,o=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:h,error:s}=await Ur(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:i,xform:gc});if(s)throw s;if(!h)throw new Error("An error occurred on token verification.");const p=h.session,y=h.user;return p!=null&&p.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),{data:{user:y,session:p},error:null}}catch(i){if(kr(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(t){var r,n,i;try{let o=null,h=null;return this.flowType==="pkce"&&([o,h]=await Ip(this.storage,this.storageKey)),await Ur(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:h}),headers:this.headers,xform:Sue})}catch(o){if(kr(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Lu;const{error:i}=await Ur(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(t){if(kr(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:o}=t,{error:h}=await Ur(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:h}}else if("phone"in t){const{phone:n,type:i,options:o}=t,{data:h,error:s}=await Ur(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:s}}throw new aw("You must provide either an email or phone number and a type")}catch(r){if(kr(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await lw(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<hC:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let h=this.suppressGetSessionWarning;t=new Proxy(t,{get:(p,y,b)=>(!h&&y==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),h=!0,this.suppressGetSessionWarning=!0),Reflect.get(p,y,b))})}return{data:{session:t},error:null}}const{session:i,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{session:null},error:o}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ur(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ku}):await this._useSession(async r=>{var n,i,o;const{data:h,error:s}=r;if(s)throw s;return!(!((n=h.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Lu}:await Ur(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(i=h.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0,xform:Ku})})}catch(r){if(kr(r))return Kce(r)&&(await this._removeSession(),await cw(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:o}=n;if(o)throw o;if(!i.session)throw new Lu;const h=i.session;let s=null,p=null;this.flowType==="pkce"&&t.email!=null&&([s,p]=await Ip(this.storage,this.storageKey));const{data:y,error:b}=await Ur(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:s,code_challenge_method:p}),jwt:h.access_token,xform:Ku});if(b)throw b;return h.user=y.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),{data:{user:h.user},error:null}})}catch(n){if(kr(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Lu;const r=Date.now()/1e3;let n=r,i=!0,o=null;const{payload:h}=pC(t.access_token);if(h.exp&&(n=h.exp,i=n<=r),i){const{session:s,error:p}=await this._callRefreshToken(t.refresh_token);if(p)return{data:{user:null,session:null},error:p};if(!s)return{data:{user:null,session:null},error:null};o=s}else{const{data:s,error:p}=await this._getUser(t.access_token);if(p)throw p;o={access_token:t.access_token,refresh_token:t.refresh_token,user:s.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(r){if(kr(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:h,error:s}=r;if(s)throw s;t=(n=h.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Lu;const{session:i,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{user:null,session:null},error:o}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(kr(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Go())throw new ow("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ow(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new I4("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ow("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new I4("No code detected.");const{data:L,error:B}=await this._exchangeCodeForSession(t.code);if(B)throw B;const q=new URL(window.location.href);return q.searchParams.delete("code"),window.history.replaceState(window.history.state,"",q.toString()),{data:{session:L.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:o,refresh_token:h,expires_in:s,expires_at:p,token_type:y}=t;if(!o||!s||!h||!y)throw new ow("No session defined in URL");const b=Math.round(Date.now()/1e3),_=parseInt(s);let E=b+_;p&&(E=parseInt(p));const C=E-b;C*1e3<=Up&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${C}s, should have been closer to ${_}s`);const k=E-_;b-k>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",k,E,b):b-k<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",k,E,b);const{data:N,error:O}=await this._getUser(o);if(O)throw O;const R={provider_token:n,provider_refresh_token:i,access_token:o,expires_in:_,expires_at:E,refresh_token:h,token_type:y,user:N.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:R,redirectType:t.type},error:null}}catch(n){if(kr(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await lw(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:o}=r;if(o)return{error:o};const h=(n=i.session)===null||n===void 0?void 0:n.access_token;if(h){const{error:s}=await this.admin.signOut(h,t);if(s&&!(Xce(s)&&(s.status===404||s.status===401||s.status===403)))return{error:s}}return t!=="others"&&(await this._removeSession(),await cw(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=sue(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:o},error:h}=r;if(h)throw h;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Ip(this.storage,this.storageKey,!0));try{return await Ur(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(kr(o))return{data:null,error:o};throw o}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(kr(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:i}=await this._useSession(async o=>{var h,s,p,y,b;const{data:_,error:E}=o;if(E)throw E;const C=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(h=t.options)===null||h===void 0?void 0:h.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(p=t.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Ur(this.fetch,"GET",C,{headers:this.headers,jwt:(b=(y=_.session)===null||y===void 0?void 0:y.access_token)!==null&&b!==void 0?b:void 0})});if(i)throw i;return Go()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(kr(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:o,error:h}=r;if(h)throw h;return await Ur(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(kr(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await cue(async i=>(i>0&&await lue(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Ur(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:gc})),(i,o)=>{const h=200*Math.pow(2,i);return o&&fC(o)&&Date.now()+h-n<Up})}catch(n){if(this._debug(r,"error",n),kr(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Go()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await lw(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<hC;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${hC}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),fC(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Lu;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new RE;const{data:o,error:h}=await this._refreshAccessToken(t);if(h)throw h;if(!o.session)throw new Lu;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const s={session:o.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(o){if(this._debug(i,"error",o),kr(o)){const h={session:null,error:o};return fC(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(h),h}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const o=[],h=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(t,r)}catch(p){o.push(p)}});if(await Promise.all(h),o.length>0){for(let s=0;s<o.length;s+=1)console.error(o[s]);throw o[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await TW(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await cw(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Go()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Up);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Up);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Up}ms, refresh threshold is ${PA} ticks`),i<=PA&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof jW)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Go()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,h]=await Ip(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(h)}`});i.push(s.toString())}if(n!=null&&n.queryParams){const o=new URLSearchParams(n.queryParams);i.push(o.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:o}=r;return o?{data:null,error:o}:await Ur(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(kr(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:o,error:h}=r;if(h)return{data:null,error:h};const s=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:p,error:y}=await Ur(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token});return y?{data:null,error:y}:(t.factorType==="totp"&&(!((i=p==null?void 0:p.totp)===null||i===void 0)&&i.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),{data:p,error:null})})}catch(r){if(kr(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:o}=r;if(o)return{data:null,error:o};const{data:h,error:s}=await Ur(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+h.expires_in},h)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",h),{data:h,error:s})})}catch(r){if(kr(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:o}=r;return o?{data:null,error:o}:await Ur(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(kr(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],i=n.filter(h=>h.factor_type==="totp"&&h.status==="verified"),o=n.filter(h=>h.factor_type==="phone"&&h.status==="verified");return{data:{all:n,totp:i,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:i},error:o}=t;if(o)return{data:null,error:o};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=pC(i.access_token);let s=null;h.aal&&(s=h.aal);let p=s;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(_=>_.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(p="aal2");const b=h.amr||[];return{data:{currentLevel:s,nextLevel:p,currentAuthenticationMethods:b},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(h=>h.kid===t);if(n||(n=this.jwks.keys.find(h=>h.kid===t),n&&this.jwks_cached_at+Gce>Date.now()))return n;const{data:i,error:o}=await Ur(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;if(!i.keys||i.keys.length===0)throw new cx("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),n=i.keys.find(h=>h.kid===t),!n)throw new cx("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:C,error:k}=await this.getSession();if(k||!C.session)return{data:null,error:k};n=C.session.access_token}const{header:i,payload:o,signature:h,raw:{header:s,payload:p}}=pC(n);if(gue(o.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:C}=await this.getUser(n);if(C)throw C;return{data:{claims:o,header:i,signature:h},error:null}}const y=yue(i.alg),b=await this.fetchJwk(i.kid,r),_=await crypto.subtle.importKey("jwk",b,y,!0,["verify"]);if(!await crypto.subtle.verify(y,_,h,rue(`${s}.${p}`)))throw new cx("Invalid JWT signature");return{data:{claims:o,header:i,signature:h},error:null}}catch(n){if(kr(n))return{data:null,error:n};throw n}}}Xx.nextInstanceID=0;const Oue=Xx;class Rue extends Oue{constructor(t){super(t)}}var Due=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(h){h(o)})}return new(r||(r=Promise))(function(o,h){function s(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?o(b.value):i(b.value).then(s,p)}y((n=n.apply(e,t||[])).next())})};class Lue{constructor(t,r,n){var i,o,h;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const s=$ce(t),p=new URL(s);this.realtimeUrl=new URL("realtime/v1",p),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",p),this.storageUrl=new URL("storage/v1",p),this.functionsUrl=new URL("functions/v1",p);const y=`sb-${p.hostname.split(".")[0]}-auth-token`,b={db:Mce,realtime:Oce,auth:Object.assign(Object.assign({},Ice),{storageKey:y}),global:kce},_=Fce(n??{},b);this.storageKey=(i=_.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=_.global.headers)!==null&&o!==void 0?o:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(E,C)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(C)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((h=_.auth)!==null&&h!==void 0?h:{},this.headers,_.global.fetch),this.fetch=Bce(r,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new ece(new URL("rest/v1",p).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),_.accessToken||this._listenForAuthEvents()}get functions(){return new Nle(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Pce(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Due(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:o,flowType:h,lock:s,debug:p},y,b){const _={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Rue({url:this.authUrl.href,headers:Object.assign(Object.assign({},_),y),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,flowType:h,lock:s,debug:p,fetch:b,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new mce(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Bue=(e,t,r)=>new Lue(e,t,r),zue="https://agydpkzfucicraedllgl.supabase.co",$ue="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFneWRwa3pmdWNpY3JhZWRsbGdsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAwOTc2MTQsImV4cCI6MjA2NTY3MzYxNH0.17dtpVvgbEHwneo05as2Sp_pBAxTThdlwxTucV_j02U",Ve=Bue(zue,$ue);Ve.auth.getSession().then(({data:e,error:t})=>{t?console.error("Supabase connection error:",t.message):console.log("Supabase connected successfully")});const CW=I.createContext({}),Fue=({children:e})=>{const[t,r]=I.useState(null),[n,i]=I.useState(!0);I.useEffect(()=>{Ve.auth.getSession().then(({data:{session:s}})=>{r((s==null?void 0:s.user)??null),i(!1)});const{data:{subscription:h}}=Ve.auth.onAuthStateChange((s,p)=>{r((p==null?void 0:p.user)??null),i(!1)});return()=>h.unsubscribe()},[]);const o={signUp:h=>Ve.auth.signUp(h),signIn:h=>Ve.auth.signInWithPassword(h),signOut:()=>Ve.auth.signOut(),user:t};return l.jsx(CW.Provider,{value:o,children:!n&&e})},Pd=()=>I.useContext(CW),Uue=()=>{const[e,t]=I.useState(!1),[r,n]=I.useState(!1),i=Gl(),o=ts(),{signOut:h,user:s}=Pd(),p=i.pathname.includes("/venue-owner");I.useEffect(()=>{console.log(" Navigation Debug Info:"),console.log(" Current path:",i.pathname),console.log(" User:",s),console.log(" Is Owner:",p),console.log(" Logo loaded:",r)},[i.pathname,s,p,r]);const y=async()=>{try{await h(),t(!1),o("/")}catch(C){console.error("Error logging out:",C)}},b=[{name:"Home",path:"/home",icon:e4},{name:"Explore",path:"/explore",icon:Tie},{name:"Venues",path:"/venues",icon:$c},...s?[{name:"My Bookings",path:"/bookings",icon:ma}]:[]],E=p?[{name:"Dashboard",path:"/venue-owner/dashboard",icon:e4},{name:"Bookings",path:"/venue-owner/bookings",icon:ma},{name:"Tables",path:"/venue-owner/tables",icon:$c},{name:"Analytics",path:"/venue-owner/analytics",icon:Yh}]:b;return l.jsx("nav",{className:"bg-white border-b border-brand-burgundy/10",children:l.jsxs("div",{className:"container mx-auto px-4",children:[l.jsxs("div",{className:"flex justify-between items-center h-16",children:[l.jsx(Nn,{to:"/",className:"flex items-center space-x-2",children:l.jsx("img",{src:"/logos/Logo1-Trans-new.png",alt:"Eddys Members",className:"h-8 w-auto object-contain sm:h-10",style:{maxWidth:"150px",minHeight:"32px"},onError:C=>{console.log(" Navigation logo failed to load from:",C.target.src),C.target.src.includes("Logo1-Trans-new.png")?C.target.src="/logos/Logo1-Trans.png":C.target.src.includes("Logo1-Trans.png")?C.target.src="/logos/Logo-Trans.png":(C.target.style.display="none",C.target.nextSibling.style.display="inline")},onLoad:C=>{console.log(" Navigation logo loaded successfully from:",C.target.src),n(!0)}})}),l.jsxs("div",{className:"hidden md:flex items-center space-x-8",children:[E.map(C=>l.jsxs(Nn,{to:C.path,className:`flex items-center space-x-2 text-sm font-medium transition-colors
                  ${i.pathname===C.path?"text-brand-gold":"text-brand-burgundy/70 hover:text-brand-gold"}`,children:[l.jsx(C.icon,{className:"h-4 w-4"}),l.jsx("span",{children:C.name})]},C.path)),!p&&l.jsxs(Nn,{to:"/profile",className:`flex items-center space-x-2 text-sm font-medium transition-colors
                  ${i.pathname==="/profile"?"text-brand-gold":"text-brand-burgundy/70 hover:text-brand-gold"}`,children:[l.jsx(Kn,{className:"h-4 w-4"}),l.jsx("span",{children:"Profile"})]})]}),l.jsx("div",{className:"hidden md:flex items-center space-x-4",children:s?l.jsxs(_le,{children:[l.jsx(wle,{asChild:!0,children:l.jsx(xt,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:l.jsx(Kn,{className:"h-4 w-4"})})}),l.jsxs(Sle,{className:"w-56",align:"end",children:[l.jsx(Ele,{children:"My Account"}),l.jsx(S4,{}),l.jsx(cC,{children:l.jsxs(Nn,{to:p?"/venue-owner/dashboard":"/profile",className:"flex items-center w-full",children:[l.jsx(Kn,{className:"mr-2 h-4 w-4"}),p?"Dashboard":"Profile"]})}),l.jsx(cC,{children:l.jsxs(Nn,{to:p?"/venue-owner/settings":"/settings",className:"flex items-center w-full",children:[l.jsx(Yh,{className:"mr-2 h-4 w-4"}),"Settings"]})}),l.jsx(S4,{}),l.jsx(cC,{children:l.jsxs("button",{onClick:y,className:"flex items-center w-full text-red-600",children:[l.jsx(mA,{className:"mr-2 h-4 w-4"}),"Log out"]})})]})]}):l.jsx("div",{className:"flex items-center space-x-2",children:l.jsx(Nn,{to:"/profile",children:l.jsx(xt,{variant:"outline",size:"sm",className:"border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10",children:"Sign In"})})})}),l.jsx("button",{className:"md:hidden p-2 text-brand-burgundy",onClick:()=>t(!e),children:e?l.jsx(Nm,{className:"h-6 w-6"}):l.jsx(kie,{className:"h-6 w-6"})})]}),e&&l.jsx("div",{className:"md:hidden py-4 border-t border-brand-burgundy/10",children:l.jsxs("div",{className:"flex flex-col space-y-4",children:[E.map(C=>l.jsxs(Nn,{to:C.path,className:`flex items-center space-x-2 text-sm font-medium transition-colors
                    ${i.pathname===C.path?"text-brand-gold":"text-brand-burgundy/70 hover:text-brand-gold"}`,onClick:()=>t(!1),children:[l.jsx(C.icon,{className:"h-4 w-4"}),l.jsx("span",{children:C.name})]},C.path)),s?l.jsxs("div",{className:"pt-4 border-t border-brand-burgundy/10",children:[l.jsxs(Nn,{to:p?"/venue-owner/dashboard":"/profile",className:"flex items-center space-x-2 text-sm font-medium text-brand-burgundy/70 hover:text-brand-gold",onClick:()=>t(!1),children:[l.jsx(Kn,{className:"h-4 w-4"}),l.jsx("span",{children:p?"Dashboard":"Profile"})]}),l.jsxs(Nn,{to:p?"/venue-owner/settings":"/settings",className:"flex items-center space-x-2 text-sm font-medium text-brand-burgundy/70 hover:text-brand-gold mt-4",onClick:()=>t(!1),children:[l.jsx(Yh,{className:"h-4 w-4"}),l.jsx("span",{children:"Settings"})]}),l.jsxs("button",{onClick:y,className:"flex items-center space-x-2 text-sm font-medium text-red-600 mt-4",children:[l.jsx(mA,{className:"h-4 w-4"}),l.jsx("span",{children:"Log out"})]})]}):l.jsx("div",{className:"pt-4 border-t border-brand-burgundy/10",children:l.jsxs(Nn,{to:p?"/venue-owner/login":"/profile",className:"flex items-center space-x-2 text-sm font-medium text-brand-burgundy/70 hover:text-brand-gold",onClick:()=>t(!1),children:[l.jsx(Kn,{className:"h-4 w-4"}),l.jsx("span",{children:p?"Venue Login":"Sign In"})]})})]})})]})})},Vue=()=>I.useCallback(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})},[]),que=()=>{const e=new Date().getFullYear(),t=Vue(),r=()=>{t()};return l.jsx("footer",{className:"bg-brand-burgundy text-brand-cream py-12",children:l.jsxs("div",{className:"container mx-auto px-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[l.jsxs("div",{children:[l.jsx("div",{className:"mb-4",children:l.jsx("img",{src:"/logos/Logo1-Trans.png",alt:"Eddys Members",className:"h-12 w-auto object-contain",style:{maxWidth:"180px",minHeight:"48px"},onError:n=>{console.log(" Footer logo failed to load from:",n.target.src),n.target.src.includes("Logo1-Trans.png")?n.target.src="/logos/Logo-Trans.png":n.target.src.includes("Logo-Trans.png")?n.target.src="/logos/Logo1-Trans-new.png":n.target.style.display="none"},onLoad:n=>{console.log(" Footer logo loaded successfully from:",n.target.src),console.log(" Footer logo dimensions:",n.target.naturalWidth,"x",n.target.naturalHeight),console.log(" Footer logo display size:",n.target.width,"x",n.target.height)}})}),l.jsx("p",{className:"text-brand-cream/80 mb-4",children:"Your premier destination for exclusive venue bookings."}),l.jsxs("div",{className:"flex gap-4",children:[l.jsx("a",{href:"https://www.instagram.com/eddy.members?igsh=aXZmNXBocTE2Mmxx",target:"_blank",rel:"noopener noreferrer",className:"text-brand-cream/80 hover:text-white transition-colors",children:l.jsx(Aie,{className:"w-5 h-5"})}),l.jsx("a",{href:"https://tiktok.com",target:"_blank",rel:"noopener noreferrer",className:"text-brand-cream/80 hover:text-white transition-colors",children:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.10z"})})})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-lg font-semibold mb-4 text-white",children:"Quick Links"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsx("li",{children:l.jsx(Nn,{to:"/venues",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Venues"})}),l.jsx("li",{children:l.jsx(Nn,{to:"/about",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"About Us"})}),l.jsx("li",{children:l.jsx(Nn,{to:"/faq",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"FAQ"})})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-lg font-semibold mb-4 text-white",children:"For Venues"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsx("li",{children:l.jsx(Nn,{to:"/venue-owner/login",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Venue Login"})}),l.jsx("li",{children:l.jsx(Nn,{to:"/venue-owner/register",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Join as Partner"})})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-lg font-semibold mb-4 text-white",children:"Contact Info"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsx("li",{children:l.jsx("a",{href:"mailto:info@oneeddy.com",className:"text-brand-cream/80 hover:text-white transition-colors",children:"info@oneeddy.com"})}),l.jsx("li",{children:l.jsx(Nn,{to:"/contact",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Contact"})}),l.jsx("li",{children:l.jsx(Nn,{to:"/privacy",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Privacy Policy"})}),l.jsx("li",{children:l.jsx(Nn,{to:"/terms",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Terms of Service"})})]})]})]}),l.jsx("div",{className:"border-t border-brand-cream/10 mt-8 pt-8 text-center text-brand-cream/60",children:l.jsxs("p",{children:[" ",e," Eddys Members. All rights reserved. Built in memory of Eddy."]})})]})})},Wue=()=>{const{pathname:e}=Gl();return I.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})},[e]),null},sI=I.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),DE=I.createContext({}),LE=I.createContext(null),BE=typeof document<"u",xg=BE?I.useLayoutEffect:I.useEffect,PW=I.createContext({strict:!1}),aI=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Gue="framerAppearId",AW="data-"+aI(Gue);function Hue(e,t,r,n){const{visualElement:i}=I.useContext(DE),o=I.useContext(PW),h=I.useContext(LE),s=I.useContext(sI).reducedMotion,p=I.useRef();n=n||o.renderer,!p.current&&n&&(p.current=n(e,{visualState:t,parent:i,props:r,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:s}));const y=p.current;I.useInsertionEffect(()=>{y&&y.update(r,h)});const b=I.useRef(!!(r[AW]&&!window.HandoffComplete));return xg(()=>{y&&(y.render(),b.current&&y.animationState&&y.animationState.animateChanges())}),I.useEffect(()=>{y&&(y.updateFeatures(),!b.current&&y.animationState&&y.animationState.animateChanges(),b.current&&(b.current=!1,window.HandoffComplete=!0))}),y}function rm(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Xue(e,t,r){return I.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):rm(r)&&(r.current=n))},[t])}function Kx(e){return typeof e=="string"||Array.isArray(e)}function zE(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const oI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],lI=["initial",...oI];function $E(e){return zE(e.animate)||lI.some(t=>Kx(e[t]))}function NW(e){return!!($E(e)||e.variants)}function Kue(e,t){if($E(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Kx(r)?r:void 0,animate:Kx(n)?n:void 0}}return e.inherit!==!1?t:{}}function Zue(e){const{initial:t,animate:r}=Kue(e,I.useContext(DE));return I.useMemo(()=>({initial:t,animate:r}),[U4(t),U4(r)])}function U4(e){return Array.isArray(e)?e.join(" "):e}const V4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Zx={};for(const e in V4)Zx[e]={isEnabled:t=>V4[e].some(r=>!!t[r])};function Yue(e){for(const t in e)Zx[t]={...Zx[t],...e[t]}}const cI=I.createContext({}),kW=I.createContext({}),Jue=Symbol.for("motionComponentSymbol");function Que({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:i}){e&&Yue(e);function o(s,p){let y;const b={...I.useContext(sI),...s,layoutId:ede(s)},{isStatic:_}=b,E=Zue(s),C=n(s,_);if(!_&&BE){E.visualElement=Hue(i,C,b,t);const k=I.useContext(kW),N=I.useContext(PW).strict;E.visualElement&&(y=E.visualElement.loadFeatures(b,N,e,k))}return I.createElement(DE.Provider,{value:E},y&&E.visualElement?I.createElement(y,{visualElement:E.visualElement,...b}):null,r(i,s,Xue(C,E.visualElement,p),C,_,E.visualElement))}const h=I.forwardRef(o);return h[Jue]=i,h}function ede({layoutId:e}){const t=I.useContext(cI).id;return t&&e!==void 0?t+"-"+e:e}function tde(e){function t(n,i={}){return Que(e(n,i))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,i)=>(r.has(i)||r.set(i,t(i)),r.get(i))})}const rde=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function uI(e){return typeof e!="string"||e.includes("-")?!1:!!(rde.indexOf(e)>-1||/[A-Z]/.test(e))}const R1={};function nde(e){Object.assign(R1,e)}const X0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_f=new Set(X0);function MW(e,{layout:t,layoutId:r}){return _f.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!R1[e]||e==="opacity")}const ga=e=>!!(e&&e.getVelocity),ide={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},sde=X0.length;function ade(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,i){let o="";for(let h=0;h<sde;h++){const s=X0[h];if(e[s]!==void 0){const p=ide[s]||s;o+=`${p}(${e[s]}) `}}return t&&!e.z&&(o+="translateZ(0)"),o=o.trim(),i?o=i(e,n?"":o):r&&n&&(o="none"),o}const IW=e=>t=>typeof t=="string"&&t.startsWith(e),OW=IW("--"),kA=IW("var(--"),ode=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,lde=(e,t)=>t&&typeof e=="number"?t.transform(e):e,bd=(e,t,r)=>Math.min(Math.max(r,e),t),wf={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},dx={...wf,transform:e=>bd(0,1,e)},uw={...wf,default:1},hx=e=>Math.round(e*1e5)/1e5,FE=/(-)?([\d]*\.?[\d])+/g,RW=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,cde=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function K0(e){return typeof e=="string"}const Z0=e=>({test:t=>K0(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Bu=Z0("deg"),Fl=Z0("%"),xr=Z0("px"),ude=Z0("vh"),dde=Z0("vw"),q4={...Fl,parse:e=>Fl.parse(e)/100,transform:e=>Fl.transform(e*100)},W4={...wf,transform:Math.round},DW={borderWidth:xr,borderTopWidth:xr,borderRightWidth:xr,borderBottomWidth:xr,borderLeftWidth:xr,borderRadius:xr,radius:xr,borderTopLeftRadius:xr,borderTopRightRadius:xr,borderBottomRightRadius:xr,borderBottomLeftRadius:xr,width:xr,maxWidth:xr,height:xr,maxHeight:xr,size:xr,top:xr,right:xr,bottom:xr,left:xr,padding:xr,paddingTop:xr,paddingRight:xr,paddingBottom:xr,paddingLeft:xr,margin:xr,marginTop:xr,marginRight:xr,marginBottom:xr,marginLeft:xr,rotate:Bu,rotateX:Bu,rotateY:Bu,rotateZ:Bu,scale:uw,scaleX:uw,scaleY:uw,scaleZ:uw,skew:Bu,skewX:Bu,skewY:Bu,distance:xr,translateX:xr,translateY:xr,translateZ:xr,x:xr,y:xr,z:xr,perspective:xr,transformPerspective:xr,opacity:dx,originX:q4,originY:q4,originZ:xr,zIndex:W4,fillOpacity:dx,strokeOpacity:dx,numOctaves:W4};function dI(e,t,r,n){const{style:i,vars:o,transform:h,transformOrigin:s}=e;let p=!1,y=!1,b=!0;for(const _ in t){const E=t[_];if(OW(_)){o[_]=E;continue}const C=DW[_],k=lde(E,C);if(_f.has(_)){if(p=!0,h[_]=k,!b)continue;E!==(C.default||0)&&(b=!1)}else _.startsWith("origin")?(y=!0,s[_]=k):i[_]=k}if(t.transform||(p||n?i.transform=ade(e.transform,r,b,n):i.transform&&(i.transform="none")),y){const{originX:_="50%",originY:E="50%",originZ:C=0}=s;i.transformOrigin=`${_} ${E} ${C}`}}const hI=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function LW(e,t,r){for(const n in t)!ga(t[n])&&!MW(n,r)&&(e[n]=t[n])}function hde({transformTemplate:e},t,r){return I.useMemo(()=>{const n=hI();return dI(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function fde(e,t,r){const n=e.style||{},i={};return LW(i,n,e),Object.assign(i,hde(e,t,r)),e.transformValues?e.transformValues(i):i}function pde(e,t,r){const n={},i=fde(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}const mde=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function D1(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||mde.has(e)}let BW=e=>!D1(e);function gde(e){e&&(BW=t=>t.startsWith("on")?!D1(t):e(t))}try{gde(require("@emotion/is-prop-valid").default)}catch{}function yde(e,t,r){const n={};for(const i in e)i==="values"&&typeof e.values=="object"||(BW(i)||r===!0&&D1(i)||!t&&!D1(i)||e.draggable&&i.startsWith("onDrag"))&&(n[i]=e[i]);return n}function G4(e,t,r){return typeof e=="string"?e:xr.transform(t+r*e)}function vde(e,t,r){const n=G4(t,e.x,e.width),i=G4(r,e.y,e.height);return`${n} ${i}`}const xde={offset:"stroke-dashoffset",array:"stroke-dasharray"},bde={offset:"strokeDashoffset",array:"strokeDasharray"};function _de(e,t,r=1,n=0,i=!0){e.pathLength=1;const o=i?xde:bde;e[o.offset]=xr.transform(-n);const h=xr.transform(t),s=xr.transform(r);e[o.array]=`${h} ${s}`}function fI(e,{attrX:t,attrY:r,attrScale:n,originX:i,originY:o,pathLength:h,pathSpacing:s=1,pathOffset:p=0,...y},b,_,E){if(dI(e,y,b,E),_){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:C,style:k,dimensions:N}=e;C.transform&&(N&&(k.transform=C.transform),delete C.transform),N&&(i!==void 0||o!==void 0||k.transform)&&(k.transformOrigin=vde(N,i!==void 0?i:.5,o!==void 0?o:.5)),t!==void 0&&(C.x=t),r!==void 0&&(C.y=r),n!==void 0&&(C.scale=n),h!==void 0&&_de(C,h,s,p,!1)}const zW=()=>({...hI(),attrs:{}}),pI=e=>typeof e=="string"&&e.toLowerCase()==="svg";function wde(e,t,r,n){const i=I.useMemo(()=>{const o=zW();return fI(o,t,{enableHardwareAcceleration:!1},pI(n),e.transformTemplate),{...o.attrs,style:{...o.style}}},[t]);if(e.style){const o={};LW(o,e.style,e),i.style={...o,...i.style}}return i}function Sde(e=!1){return(r,n,i,{latestValues:o},h)=>{const p=(uI(r)?wde:pde)(n,o,h,r),b={...yde(n,typeof r=="string",e),...p,ref:i},{children:_}=n,E=I.useMemo(()=>ga(_)?_.get():_,[_]);return I.createElement(r,{...b,children:E})}}function $W(e,{style:t,vars:r},n,i){Object.assign(e.style,t,i&&i.getProjectionStyles(n));for(const o in r)e.style.setProperty(o,r[o])}const FW=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function UW(e,t,r,n){$W(e,t,void 0,n);for(const i in t.attrs)e.setAttribute(FW.has(i)?i:aI(i),t.attrs[i])}function mI(e,t){const{style:r}=e,n={};for(const i in r)(ga(r[i])||t.style&&ga(t.style[i])||MW(i,e))&&(n[i]=r[i]);return n}function VW(e,t){const r=mI(e,t);for(const n in e)if(ga(e[n])||ga(t[n])){const i=X0.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[i]=e[n]}return r}function gI(e,t,r,n={},i={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,i)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,i)),t}function bg(e){const t=I.useRef(null);return t.current===null&&(t.current=e()),t.current}const L1=e=>Array.isArray(e),Ede=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),Tde=e=>L1(e)?e[e.length-1]||0:e;function Hw(e){const t=ga(e)?e.get():e;return Ede(t)?t.toValue():t}function jde({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,i,o){const h={latestValues:Cde(n,i,o,e),renderState:t()};return r&&(h.mount=s=>r(n,s,h)),h}const qW=e=>(t,r)=>{const n=I.useContext(DE),i=I.useContext(LE),o=()=>jde(e,t,n,i);return r?o():bg(o)};function Cde(e,t,r,n){const i={},o=n(e,{});for(const E in o)i[E]=Hw(o[E]);let{initial:h,animate:s}=e;const p=$E(e),y=NW(e);t&&y&&!p&&e.inherit!==!1&&(h===void 0&&(h=t.initial),s===void 0&&(s=t.animate));let b=r?r.initial===!1:!1;b=b||h===!1;const _=b?s:h;return _&&typeof _!="boolean"&&!zE(_)&&(Array.isArray(_)?_:[_]).forEach(C=>{const k=gI(e,C);if(!k)return;const{transitionEnd:N,transition:O,...R}=k;for(const L in R){let B=R[L];if(Array.isArray(B)){const q=b?B.length-1:0;B=B[q]}B!==null&&(i[L]=B)}for(const L in N)i[L]=N[L]}),i}const pi=e=>e;class H4{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function Pde(e){let t=new H4,r=new H4,n=0,i=!1,o=!1;const h=new WeakSet,s={schedule:(p,y=!1,b=!1)=>{const _=b&&i,E=_?t:r;return y&&h.add(p),E.add(p)&&_&&i&&(n=t.order.length),p},cancel:p=>{r.remove(p),h.delete(p)},process:p=>{if(i){o=!0;return}if(i=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let y=0;y<n;y++){const b=t.order[y];b(p),h.has(b)&&(s.schedule(b),e())}i=!1,o&&(o=!1,s.process(p))}};return s}const dw=["prepare","read","update","preRender","render","postRender"],Ade=40;function Nde(e,t){let r=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=dw.reduce((_,E)=>(_[E]=Pde(()=>r=!0),_),{}),h=_=>o[_].process(i),s=()=>{const _=performance.now();r=!1,i.delta=n?1e3/60:Math.max(Math.min(_-i.timestamp,Ade),1),i.timestamp=_,i.isProcessing=!0,dw.forEach(h),i.isProcessing=!1,r&&t&&(n=!1,e(s))},p=()=>{r=!0,n=!0,i.isProcessing||e(s)};return{schedule:dw.reduce((_,E)=>{const C=o[E];return _[E]=(k,N=!1,O=!1)=>(r||p(),C.schedule(k,N,O)),_},{}),cancel:_=>dw.forEach(E=>o[E].cancel(_)),state:i,steps:o}}const{schedule:gn,cancel:fl,state:ls,steps:gC}=Nde(typeof requestAnimationFrame<"u"?requestAnimationFrame:pi,!0),kde={useVisualState:qW({scrapeMotionValuesFromProps:VW,createRenderState:zW,onMount:(e,t,{renderState:r,latestValues:n})=>{gn.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),gn.render(()=>{fI(r,n,{enableHardwareAcceleration:!1},pI(t.tagName),e.transformTemplate),UW(t,r)})}})},Mde={useVisualState:qW({scrapeMotionValuesFromProps:mI,createRenderState:hI})};function Ide(e,{forwardMotionProps:t=!1},r,n){return{...uI(e)?kde:Mde,preloadedFeatures:r,useRender:Sde(t),createVisualElement:n,Component:e}}function Ec(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const WW=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function UE(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const Ode=e=>t=>WW(t)&&e(t,UE(t));function Ac(e,t,r,n){return Ec(e,t,Ode(r),n)}const Rde=(e,t)=>r=>t(e(r)),ud=(...e)=>e.reduce(Rde);function GW(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const X4=GW("dragHorizontal"),K4=GW("dragVertical");function HW(e){let t=!1;if(e==="y")t=K4();else if(e==="x")t=X4();else{const r=X4(),n=K4();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function XW(){const e=HW(!0);return e?(e(),!1):!0}class Ad{constructor(t){this.isMounted=!1,this.node=t}update(){}}function Z4(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),i=(o,h)=>{if(o.pointerType==="touch"||XW())return;const s=e.getProps();e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",t),s[n]&&gn.update(()=>s[n](o,h))};return Ac(e.current,r,i,{passive:!e.getProps()[n]})}class Dde extends Ad{mount(){this.unmount=ud(Z4(this.node,!0),Z4(this.node,!1))}unmount(){}}class Lde extends Ad{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ud(Ec(this.node.current,"focus",()=>this.onFocus()),Ec(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const KW=(e,t)=>t?e===t?!0:KW(e,t.parentElement):!1;function yC(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,UE(r))}class Bde extends Ad{constructor(){super(...arguments),this.removeStartListeners=pi,this.removeEndListeners=pi,this.removeAccessibleListeners=pi,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),o=Ac(window,"pointerup",(s,p)=>{if(!this.checkPressEnd())return;const{onTap:y,onTapCancel:b,globalTapTarget:_}=this.node.getProps();gn.update(()=>{!_&&!KW(this.node.current,s.target)?b&&b(s,p):y&&y(s,p)})},{passive:!(n.onTap||n.onPointerUp)}),h=Ac(window,"pointercancel",(s,p)=>this.cancelPress(s,p),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=ud(o,h),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=o=>{if(o.key!=="Enter"||this.isPressing)return;const h=s=>{s.key!=="Enter"||!this.checkPressEnd()||yC("up",(p,y)=>{const{onTap:b}=this.node.getProps();b&&gn.update(()=>b(p,y))})};this.removeEndListeners(),this.removeEndListeners=Ec(this.node.current,"keyup",h),yC("down",(s,p)=>{this.startPress(s,p)})},r=Ec(this.node.current,"keydown",t),n=()=>{this.isPressing&&yC("cancel",(o,h)=>this.cancelPress(o,h))},i=Ec(this.node.current,"blur",n);this.removeAccessibleListeners=ud(r,i)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:i}=this.node.getProps();i&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&gn.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!XW()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&gn.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=Ac(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Ec(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=ud(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const MA=new WeakMap,vC=new WeakMap,zde=e=>{const t=MA.get(e.target);t&&t(e)},$de=e=>{e.forEach(zde)};function Fde({root:e,...t}){const r=e||document;vC.has(r)||vC.set(r,{});const n=vC.get(r),i=JSON.stringify(t);return n[i]||(n[i]=new IntersectionObserver($de,{root:e,...t})),n[i]}function Ude(e,t,r){const n=Fde(t);return MA.set(e,r),n.observe(e),()=>{MA.delete(e),n.unobserve(e)}}const Vde={some:0,all:1};class qde extends Ad{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:i="some",once:o}=t,h={root:r?r.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:Vde[i]},s=p=>{const{isIntersecting:y}=p;if(this.isInView===y||(this.isInView=y,o&&!y&&this.hasEnteredView))return;y&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",y);const{onViewportEnter:b,onViewportLeave:_}=this.node.getProps(),E=y?b:_;E&&E(p)};return Ude(this.node.current,h,s)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(Wde(t,r))&&this.startObserver()}unmount(){}}function Wde({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const Gde={inView:{Feature:qde},tap:{Feature:Bde},focus:{Feature:Lde},hover:{Feature:Dde}};function ZW(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Hde(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function Xde(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function VE(e,t,r){const n=e.getProps();return gI(n,t,r!==void 0?r:n.custom,Hde(e),Xde(e))}let YW=pi,qE=pi;const dd=e=>e*1e3,Nc=e=>e/1e3,Kde={current:!1},JW=e=>Array.isArray(e)&&typeof e[0]=="number";function QW(e){return!!(!e||typeof e=="string"&&eG[e]||JW(e)||Array.isArray(e)&&e.every(QW))}const Xv=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,eG={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Xv([0,.65,.55,1]),circOut:Xv([.55,0,1,.45]),backIn:Xv([.31,.01,.66,-.59]),backOut:Xv([.33,1.53,.69,.99])};function tG(e){if(e)return JW(e)?Xv(e):Array.isArray(e)?e.map(tG):eG[e]}function Zde(e,t,r,{delay:n=0,duration:i,repeat:o=0,repeatType:h="loop",ease:s,times:p}={}){const y={[t]:r};p&&(y.offset=p);const b=tG(s);return Array.isArray(b)&&(y.easing=b),e.animate(y,{delay:n,duration:i,easing:Array.isArray(b)?"linear":b,fill:"both",iterations:o+1,direction:h==="reverse"?"alternate":"normal"})}function Yde(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const rG=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,Jde=1e-7,Qde=12;function ehe(e,t,r,n,i){let o,h,s=0;do h=t+(r-t)/2,o=rG(h,n,i)-e,o>0?r=h:t=h;while(Math.abs(o)>Jde&&++s<Qde);return h}function Y0(e,t,r,n){if(e===t&&r===n)return pi;const i=o=>ehe(o,0,1,e,r);return o=>o===0||o===1?o:rG(i(o),t,n)}const the=Y0(.42,0,1,1),rhe=Y0(0,0,.58,1),nG=Y0(.42,0,.58,1),nhe=e=>Array.isArray(e)&&typeof e[0]!="number",iG=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,sG=e=>t=>1-e(1-t),yI=e=>1-Math.sin(Math.acos(e)),aG=sG(yI),ihe=iG(yI),oG=Y0(.33,1.53,.69,.99),vI=sG(oG),she=iG(vI),ahe=e=>(e*=2)<1?.5*vI(e):.5*(2-Math.pow(2,-10*(e-1))),ohe={linear:pi,easeIn:the,easeInOut:nG,easeOut:rhe,circIn:yI,circInOut:ihe,circOut:aG,backIn:vI,backInOut:she,backOut:oG,anticipate:ahe},Y4=e=>{if(Array.isArray(e)){qE(e.length===4);const[t,r,n,i]=e;return Y0(t,r,n,i)}else if(typeof e=="string")return ohe[e];return e},xI=(e,t)=>r=>!!(K0(r)&&cde.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),lG=(e,t,r)=>n=>{if(!K0(n))return n;const[i,o,h,s]=n.match(FE);return{[e]:parseFloat(i),[t]:parseFloat(o),[r]:parseFloat(h),alpha:s!==void 0?parseFloat(s):1}},lhe=e=>bd(0,255,e),xC={...wf,transform:e=>Math.round(lhe(e))},Vh={test:xI("rgb","red"),parse:lG("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+xC.transform(e)+", "+xC.transform(t)+", "+xC.transform(r)+", "+hx(dx.transform(n))+")"};function che(e){let t="",r="",n="",i="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),i=e.substring(4,5),t+=t,r+=r,n+=n,i+=i),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const IA={test:xI("#"),parse:che,transform:Vh.transform},nm={test:xI("hsl","hue"),parse:lG("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Fl.transform(hx(t))+", "+Fl.transform(hx(r))+", "+hx(dx.transform(n))+")"},$s={test:e=>Vh.test(e)||IA.test(e)||nm.test(e),parse:e=>Vh.test(e)?Vh.parse(e):nm.test(e)?nm.parse(e):IA.parse(e),transform:e=>K0(e)?e:e.hasOwnProperty("red")?Vh.transform(e):nm.transform(e)},oi=(e,t,r)=>-r*e+r*t+e;function bC(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function uhe({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let i=0,o=0,h=0;if(!t)i=o=h=r;else{const s=r<.5?r*(1+t):r+t-r*t,p=2*r-s;i=bC(p,s,e+1/3),o=bC(p,s,e),h=bC(p,s,e-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(h*255),alpha:n}}const _C=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},dhe=[IA,Vh,nm],hhe=e=>dhe.find(t=>t.test(e));function J4(e){const t=hhe(e);let r=t.parse(e);return t===nm&&(r=uhe(r)),r}const cG=(e,t)=>{const r=J4(e),n=J4(t),i={...r};return o=>(i.red=_C(r.red,n.red,o),i.green=_C(r.green,n.green,o),i.blue=_C(r.blue,n.blue,o),i.alpha=oi(r.alpha,n.alpha,o),Vh.transform(i))};function fhe(e){var t,r;return isNaN(e)&&K0(e)&&(((t=e.match(FE))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(RW))===null||r===void 0?void 0:r.length)||0)>0}const uG={regex:ode,countKey:"Vars",token:"${v}",parse:pi},dG={regex:RW,countKey:"Colors",token:"${c}",parse:$s.parse},hG={regex:FE,countKey:"Numbers",token:"${n}",parse:wf.parse};function wC(e,{regex:t,countKey:r,token:n,parse:i}){const o=e.tokenised.match(t);o&&(e["num"+r]=o.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...o.map(i)))}function B1(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&wC(r,uG),wC(r,dG),wC(r,hG),r}function fG(e){return B1(e).values}function pG(e){const{values:t,numColors:r,numVars:n,tokenised:i}=B1(e),o=t.length;return h=>{let s=i;for(let p=0;p<o;p++)p<n?s=s.replace(uG.token,h[p]):p<n+r?s=s.replace(dG.token,$s.transform(h[p])):s=s.replace(hG.token,hx(h[p]));return s}}const phe=e=>typeof e=="number"?0:e;function mhe(e){const t=fG(e);return pG(e)(t.map(phe))}const _d={test:fhe,parse:fG,createTransformer:pG,getAnimatableNone:mhe},mG=(e,t)=>r=>`${r>0?t:e}`;function gG(e,t){return typeof e=="number"?r=>oi(e,t,r):$s.test(e)?cG(e,t):e.startsWith("var(")?mG(e,t):vG(e,t)}const yG=(e,t)=>{const r=[...e],n=r.length,i=e.map((o,h)=>gG(o,t[h]));return o=>{for(let h=0;h<n;h++)r[h]=i[h](o);return r}},ghe=(e,t)=>{const r={...e,...t},n={};for(const i in r)e[i]!==void 0&&t[i]!==void 0&&(n[i]=gG(e[i],t[i]));return i=>{for(const o in n)r[o]=n[o](i);return r}},vG=(e,t)=>{const r=_d.createTransformer(t),n=B1(e),i=B1(t);return n.numVars===i.numVars&&n.numColors===i.numColors&&n.numNumbers>=i.numNumbers?ud(yG(n.values,i.values),r):mG(e,t)},Im=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},Q4=(e,t)=>r=>oi(e,t,r);function yhe(e){return typeof e=="number"?Q4:typeof e=="string"?$s.test(e)?cG:vG:Array.isArray(e)?yG:typeof e=="object"?ghe:Q4}function vhe(e,t,r){const n=[],i=r||yhe(e[0]),o=e.length-1;for(let h=0;h<o;h++){let s=i(e[h],e[h+1]);if(t){const p=Array.isArray(t)?t[h]||pi:t;s=ud(p,s)}n.push(s)}return n}function WE(e,t,{clamp:r=!0,ease:n,mixer:i}={}){const o=e.length;if(qE(o===t.length),o===1)return()=>t[0];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());const h=vhe(t,n,i),s=h.length,p=y=>{let b=0;if(s>1)for(;b<e.length-2&&!(y<e[b+1]);b++);const _=Im(e[b],e[b+1],y);return h[b](_)};return r?y=>p(bd(e[0],e[o-1],y)):p}function xhe(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const i=Im(0,t,n);e.push(oi(r,1,i))}}function xG(e){const t=[0];return xhe(t,e.length-1),t}function bhe(e,t){return e.map(r=>r*t)}function _he(e,t){return e.map(()=>t||nG).splice(0,e.length-1)}function z1({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const i=nhe(n)?n.map(Y4):Y4(n),o={done:!1,value:t[0]},h=bhe(r&&r.length===t.length?r:xG(t),e),s=WE(h,t,{ease:Array.isArray(i)?i:_he(t,i)});return{calculatedDuration:e,next:p=>(o.value=s(p),o.done=p>=e,o)}}function bI(e,t){return t?e*(1e3/t):0}const whe=5;function bG(e,t,r){const n=Math.max(t-whe,0);return bI(r-e(n),t-n)}const SC=.001,She=.01,eB=10,Ehe=.05,The=1;function jhe({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let i,o;YW(e<=dd(eB));let h=1-t;h=bd(Ehe,The,h),e=bd(She,eB,Nc(e)),h<1?(i=y=>{const b=y*h,_=b*e,E=b-r,C=OA(y,h),k=Math.exp(-_);return SC-E/C*k},o=y=>{const _=y*h*e,E=_*r+r,C=Math.pow(h,2)*Math.pow(y,2)*e,k=Math.exp(-_),N=OA(Math.pow(y,2),h);return(-i(y)+SC>0?-1:1)*((E-C)*k)/N}):(i=y=>{const b=Math.exp(-y*e),_=(y-r)*e+1;return-SC+b*_},o=y=>{const b=Math.exp(-y*e),_=(r-y)*(e*e);return b*_});const s=5/e,p=Phe(i,o,s);if(e=dd(e),isNaN(p))return{stiffness:100,damping:10,duration:e};{const y=Math.pow(p,2)*n;return{stiffness:y,damping:h*2*Math.sqrt(n*y),duration:e}}}const Che=12;function Phe(e,t,r){let n=r;for(let i=1;i<Che;i++)n=n-e(n)/t(n);return n}function OA(e,t){return e*Math.sqrt(1-t*t)}const Ahe=["duration","bounce"],Nhe=["stiffness","damping","mass"];function tB(e,t){return t.some(r=>e[r]!==void 0)}function khe(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!tB(e,Nhe)&&tB(e,Ahe)){const r=jhe(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function _G({keyframes:e,restDelta:t,restSpeed:r,...n}){const i=e[0],o=e[e.length-1],h={done:!1,value:i},{stiffness:s,damping:p,mass:y,duration:b,velocity:_,isResolvedFromDuration:E}=khe({...n,velocity:-Nc(n.velocity||0)}),C=_||0,k=p/(2*Math.sqrt(s*y)),N=o-i,O=Nc(Math.sqrt(s/y)),R=Math.abs(N)<5;r||(r=R?.01:2),t||(t=R?.005:.5);let L;if(k<1){const B=OA(O,k);L=q=>{const F=Math.exp(-k*O*q);return o-F*((C+k*O*N)/B*Math.sin(B*q)+N*Math.cos(B*q))}}else if(k===1)L=B=>o-Math.exp(-O*B)*(N+(C+O*N)*B);else{const B=O*Math.sqrt(k*k-1);L=q=>{const F=Math.exp(-k*O*q),H=Math.min(B*q,300);return o-F*((C+k*O*N)*Math.sinh(H)+B*N*Math.cosh(H))/B}}return{calculatedDuration:E&&b||null,next:B=>{const q=L(B);if(E)h.done=B>=b;else{let F=C;B!==0&&(k<1?F=bG(L,B,q):F=0);const H=Math.abs(F)<=r,Z=Math.abs(o-q)<=t;h.done=H&&Z}return h.value=h.done?o:q,h}}}function rB({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:h,min:s,max:p,restDelta:y=.5,restSpeed:b}){const _=e[0],E={done:!1,value:_},C=re=>s!==void 0&&re<s||p!==void 0&&re>p,k=re=>s===void 0?p:p===void 0||Math.abs(s-re)<Math.abs(p-re)?s:p;let N=r*t;const O=_+N,R=h===void 0?O:h(O);R!==O&&(N=R-_);const L=re=>-N*Math.exp(-re/n),B=re=>R+L(re),q=re=>{const W=L(re),te=B(re);E.done=Math.abs(W)<=y,E.value=E.done?R:te};let F,H;const Z=re=>{C(E.value)&&(F=re,H=_G({keyframes:[E.value,k(E.value)],velocity:bG(B,re,E.value),damping:i,stiffness:o,restDelta:y,restSpeed:b}))};return Z(0),{calculatedDuration:null,next:re=>{let W=!1;return!H&&F===void 0&&(W=!0,q(re),Z(re)),F!==void 0&&re>F?H.next(re-F):(!W&&q(re),E)}}}const Mhe=e=>{const t=({timestamp:r})=>e(r);return{start:()=>gn.update(t,!0),stop:()=>fl(t),now:()=>ls.isProcessing?ls.timestamp:performance.now()}},nB=2e4;function iB(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<nB;)t+=r,n=e.next(t);return t>=nB?1/0:t}const Ihe={decay:rB,inertia:rB,tween:z1,keyframes:z1,spring:_G};function $1({autoplay:e=!0,delay:t=0,driver:r=Mhe,keyframes:n,type:i="keyframes",repeat:o=0,repeatDelay:h=0,repeatType:s="loop",onPlay:p,onStop:y,onComplete:b,onUpdate:_,...E}){let C=1,k=!1,N,O;const R=()=>{O=new Promise(Be=>{N=Be})};R();let L;const B=Ihe[i]||z1;let q;B!==z1&&typeof n[0]!="number"&&(q=WE([0,100],n,{clamp:!1}),n=[0,100]);const F=B({...E,keyframes:n});let H;s==="mirror"&&(H=B({...E,keyframes:[...n].reverse(),velocity:-(E.velocity||0)}));let Z="idle",re=null,W=null,te=null;F.calculatedDuration===null&&o&&(F.calculatedDuration=iB(F));const{calculatedDuration:oe}=F;let ie=1/0,ue=1/0;oe!==null&&(ie=oe+h,ue=ie*(o+1)-h);let _e=0;const xe=Be=>{if(W===null)return;C>0&&(W=Math.min(W,Be)),C<0&&(W=Math.min(Be-ue/C,W)),re!==null?_e=re:_e=Math.round(Be-W)*C;const We=_e-t*(C>=0?1:-1),ut=C>=0?We<0:We>ue;_e=Math.max(We,0),Z==="finished"&&re===null&&(_e=ue);let nt=_e,Pt=F;if(o){const ct=Math.min(_e,ue)/ie;let gt=Math.floor(ct),it=ct%1;!it&&ct>=1&&(it=1),it===1&&gt--,gt=Math.min(gt,o+1),!!(gt%2)&&(s==="reverse"?(it=1-it,h&&(it-=h/ie)):s==="mirror"&&(Pt=H)),nt=bd(0,1,it)*ie}const It=ut?{done:!1,value:n[0]}:Pt.next(nt);q&&(It.value=q(It.value));let{done:at}=It;!ut&&oe!==null&&(at=C>=0?_e>=ue:_e<=0);const Ut=re===null&&(Z==="finished"||Z==="running"&&at);return _&&_(It.value),Ut&&me(),It},be=()=>{L&&L.stop(),L=void 0},Ae=()=>{Z="idle",be(),N(),R(),W=te=null},me=()=>{Z="finished",b&&b(),be(),N()},ke=()=>{if(k)return;L||(L=r(xe));const Be=L.now();p&&p(),re!==null?W=Be-re:(!W||Z==="finished")&&(W=Be),Z==="finished"&&R(),te=W,re=null,Z="running",L.start()};e&&ke();const Ne={then(Be,We){return O.then(Be,We)},get time(){return Nc(_e)},set time(Be){Be=dd(Be),_e=Be,re!==null||!L||C===0?re=Be:W=L.now()-Be/C},get duration(){const Be=F.calculatedDuration===null?iB(F):F.calculatedDuration;return Nc(Be)},get speed(){return C},set speed(Be){Be===C||!L||(C=Be,Ne.time=Nc(_e))},get state(){return Z},play:ke,pause:()=>{Z="paused",re=_e},stop:()=>{k=!0,Z!=="idle"&&(Z="idle",y&&y(),Ae())},cancel:()=>{te!==null&&xe(te),Ae()},complete:()=>{Z="finished"},sample:Be=>(W=0,xe(Be))};return Ne}function Ohe(e){let t;return()=>(t===void 0&&(t=e()),t)}const Rhe=Ohe(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Dhe=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),hw=10,Lhe=2e4,Bhe=(e,t)=>t.type==="spring"||e==="backgroundColor"||!QW(t.ease);function zhe(e,t,{onUpdate:r,onComplete:n,...i}){if(!(Rhe()&&Dhe.has(t)&&!i.repeatDelay&&i.repeatType!=="mirror"&&i.damping!==0&&i.type!=="inertia"))return!1;let h=!1,s,p,y=!1;const b=()=>{p=new Promise(B=>{s=B})};b();let{keyframes:_,duration:E=300,ease:C,times:k}=i;if(Bhe(t,i)){const B=$1({...i,repeat:0,delay:0});let q={done:!1,value:_[0]};const F=[];let H=0;for(;!q.done&&H<Lhe;)q=B.sample(H),F.push(q.value),H+=hw;k=void 0,_=F,E=H-hw,C="linear"}const N=Zde(e.owner.current,t,_,{...i,duration:E,ease:C,times:k}),O=()=>{y=!1,N.cancel()},R=()=>{y=!0,gn.update(O),s(),b()};return N.onfinish=()=>{y||(e.set(Yde(_,i)),n&&n(),R())},{then(B,q){return p.then(B,q)},attachTimeline(B){return N.timeline=B,N.onfinish=null,pi},get time(){return Nc(N.currentTime||0)},set time(B){N.currentTime=dd(B)},get speed(){return N.playbackRate},set speed(B){N.playbackRate=B},get duration(){return Nc(E)},play:()=>{h||(N.play(),fl(O))},pause:()=>N.pause(),stop:()=>{if(h=!0,N.playState==="idle")return;const{currentTime:B}=N;if(B){const q=$1({...i,autoplay:!1});e.setWithVelocity(q.sample(B-hw).value,q.sample(B).value,hw)}R()},complete:()=>{y||N.finish()},cancel:R}}function $he({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const i=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:pi,pause:pi,stop:pi,then:o=>(o(),Promise.resolve()),cancel:pi,complete:pi});return t?$1({keyframes:[0,1],duration:0,delay:t,onComplete:i}):i()}const Fhe={type:"spring",stiffness:500,damping:25,restSpeed:10},Uhe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Vhe={type:"keyframes",duration:.8},qhe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Whe=(e,{keyframes:t})=>t.length>2?Vhe:_f.has(e)?e.startsWith("scale")?Uhe(t[1]):Fhe:qhe,RA=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(_d.test(t)||t==="0")&&!t.startsWith("url(")),Ghe=new Set(["brightness","contrast","saturate","opacity"]);function Hhe(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(FE)||[];if(!n)return e;const i=r.replace(n,"");let o=Ghe.has(t)?1:0;return n!==r&&(o*=100),t+"("+o+i+")"}const Xhe=/([a-z-]*)\(.*?\)/g,DA={..._d,getAnimatableNone:e=>{const t=e.match(Xhe);return t?t.map(Hhe).join(" "):e}},Khe={...DW,color:$s,backgroundColor:$s,outlineColor:$s,fill:$s,stroke:$s,borderColor:$s,borderTopColor:$s,borderRightColor:$s,borderBottomColor:$s,borderLeftColor:$s,filter:DA,WebkitFilter:DA},_I=e=>Khe[e];function wG(e,t){let r=_I(e);return r!==DA&&(r=_d),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const SG=e=>/^0[^.\s]+$/.test(e);function Zhe(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||SG(e)}function Yhe(e,t,r,n){const i=RA(t,r);let o;Array.isArray(r)?o=[...r]:o=[null,r];const h=n.from!==void 0?n.from:e.get();let s;const p=[];for(let y=0;y<o.length;y++)o[y]===null&&(o[y]=y===0?h:o[y-1]),Zhe(o[y])&&p.push(y),typeof o[y]=="string"&&o[y]!=="none"&&o[y]!=="0"&&(s=o[y]);if(i&&p.length&&s)for(let y=0;y<p.length;y++){const b=p[y];o[b]=wG(t,s)}return o}function Jhe({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:i,repeat:o,repeatType:h,repeatDelay:s,from:p,elapsed:y,...b}){return!!Object.keys(b).length}function wI(e,t){return e[t]||e.default||e}const Qhe={skipAnimations:!1},SI=(e,t,r,n={})=>i=>{const o=wI(n,e)||{},h=o.delay||n.delay||0;let{elapsed:s=0}=n;s=s-dd(h);const p=Yhe(t,e,r,o),y=p[0],b=p[p.length-1],_=RA(e,y),E=RA(e,b);let C={keyframes:p,velocity:t.getVelocity(),ease:"easeOut",...o,delay:-s,onUpdate:k=>{t.set(k),o.onUpdate&&o.onUpdate(k)},onComplete:()=>{i(),o.onComplete&&o.onComplete()}};if(Jhe(o)||(C={...C,...Whe(e,C)}),C.duration&&(C.duration=dd(C.duration)),C.repeatDelay&&(C.repeatDelay=dd(C.repeatDelay)),!_||!E||Kde.current||o.type===!1||Qhe.skipAnimations)return $he(C);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const k=zhe(t,e,C);if(k)return k}return $1(C)};function F1(e){return!!(ga(e)&&e.add)}const EG=e=>/^\-?\d*\.?\d+$/.test(e);function EI(e,t){e.indexOf(t)===-1&&e.push(t)}function TI(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class jI{constructor(){this.subscriptions=[]}add(t){return EI(this.subscriptions,t),()=>TI(this.subscriptions,t)}notify(t,r,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](t,r,n);else for(let o=0;o<i;o++){const h=this.subscriptions[o];h&&h(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const efe=e=>!isNaN(parseFloat(e)),fx={current:void 0};class tfe{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,i=!0)=>{this.prev=this.current,this.current=n;const{delta:o,timestamp:h}=ls;this.lastUpdated!==h&&(this.timeDelta=o,this.lastUpdated=h,gn.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>gn.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=efe(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new jI);const n=this.events[t].add(r);return t==="change"?()=>{n(),gn.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return fx.current&&fx.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?bI(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function sl(e,t){return new tfe(e,t)}const TG=e=>t=>t.test(e),rfe={test:e=>e==="auto",parse:e=>e},jG=[wf,xr,Fl,Bu,dde,ude,rfe],Tv=e=>jG.find(TG(e)),nfe=[...jG,$s,_d],ife=e=>nfe.find(TG(e));function sfe(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,sl(r))}function CI(e,t){const r=VE(e,t);let{transitionEnd:n={},transition:i={},...o}=r?e.makeTargetAnimatable(r,!1):{};o={...o,...n};for(const h in o){const s=Tde(o[h]);sfe(e,h,s)}}function LA(e,t){[...t].reverse().forEach(n=>{const i=e.getVariant(n);i&&CI(e,i),e.variantChildren&&e.variantChildren.forEach(o=>{LA(o,t)})})}function afe(e,t){if(Array.isArray(t))return LA(e,t);if(typeof t=="string")return LA(e,[t]);CI(e,t)}function ofe(e,t,r){var n,i;const o=Object.keys(t).filter(s=>!e.hasValue(s)),h=o.length;if(h)for(let s=0;s<h;s++){const p=o[s],y=t[p];let b=null;Array.isArray(y)&&(b=y[0]),b===null&&(b=(i=(n=r[p])!==null&&n!==void 0?n:e.readValue(p))!==null&&i!==void 0?i:t[p]),b!=null&&(typeof b=="string"&&(EG(b)||SG(b))?b=parseFloat(b):!ife(b)&&_d.test(y)&&(b=wG(p,y)),e.addValue(p,sl(b,{owner:e})),r[p]===void 0&&(r[p]=b),b!==null&&e.setBaseTarget(p,b))}}function lfe(e,t){return t?(t[e]||t.default||t).from:void 0}function cfe(e,t,r){const n={};for(const i in e){const o=lfe(i,t);if(o!==void 0)n[i]=o;else{const h=r.getValue(i);h&&(n[i]=h.get())}}return n}function ufe({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function dfe(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function CG(e,t,{delay:r=0,transitionOverride:n,type:i}={}){let{transition:o=e.getDefaultTransition(),transitionEnd:h,...s}=e.makeTargetAnimatable(t);const p=e.getValue("willChange");n&&(o=n);const y=[],b=i&&e.animationState&&e.animationState.getState()[i];for(const _ in s){const E=e.getValue(_),C=s[_];if(!E||C===void 0||b&&ufe(b,_))continue;const k={delay:r,elapsed:0,...wI(o||{},_)};if(window.HandoffAppearAnimations){const R=e.getProps()[AW];if(R){const L=window.HandoffAppearAnimations(R,_,E,gn);L!==null&&(k.elapsed=L,k.isHandoff=!0)}}let N=!k.isHandoff&&!dfe(E,C);if(k.type==="spring"&&(E.getVelocity()||k.velocity)&&(N=!1),E.animation&&(N=!1),N)continue;E.start(SI(_,E,C,e.shouldReduceMotion&&_f.has(_)?{type:!1}:k));const O=E.animation;F1(p)&&(p.add(_),O.then(()=>p.remove(_))),y.push(O)}return h&&Promise.all(y).then(()=>{h&&CI(e,h)}),y}function BA(e,t,r={}){const n=VE(e,t,r.custom);let{transition:i=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(i=r.transitionOverride);const o=n?()=>Promise.all(CG(e,n,r)):()=>Promise.resolve(),h=e.variantChildren&&e.variantChildren.size?(p=0)=>{const{delayChildren:y=0,staggerChildren:b,staggerDirection:_}=i;return hfe(e,t,y+p,b,_,r)}:()=>Promise.resolve(),{when:s}=i;if(s){const[p,y]=s==="beforeChildren"?[o,h]:[h,o];return p().then(()=>y())}else return Promise.all([o(),h(r.delay)])}function hfe(e,t,r=0,n=0,i=1,o){const h=[],s=(e.variantChildren.size-1)*n,p=i===1?(y=0)=>y*n:(y=0)=>s-y*n;return Array.from(e.variantChildren).sort(ffe).forEach((y,b)=>{y.notify("AnimationStart",t),h.push(BA(y,t,{...o,delay:r+p(b)}).then(()=>y.notify("AnimationComplete",t)))}),Promise.all(h)}function ffe(e,t){return e.sortNodePosition(t)}function PG(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const i=t.map(o=>BA(e,o,r));n=Promise.all(i)}else if(typeof t=="string")n=BA(e,t,r);else{const i=typeof t=="function"?VE(e,t,r.custom):t;n=Promise.all(CG(e,i,r))}return n.then(()=>e.notify("AnimationComplete",t))}const pfe=[...oI].reverse(),mfe=oI.length;function gfe(e){return t=>Promise.all(t.map(({animation:r,options:n})=>PG(e,r,n)))}function yfe(e){let t=gfe(e);const r=xfe();let n=!0;const i=(p,y)=>{const b=VE(e,y);if(b){const{transition:_,transitionEnd:E,...C}=b;p={...p,...C,...E}}return p};function o(p){t=p(e)}function h(p,y){const b=e.getProps(),_=e.getVariantContext(!0)||{},E=[],C=new Set;let k={},N=1/0;for(let R=0;R<mfe;R++){const L=pfe[R],B=r[L],q=b[L]!==void 0?b[L]:_[L],F=Kx(q),H=L===y?B.isActive:null;H===!1&&(N=R);let Z=q===_[L]&&q!==b[L]&&F;if(Z&&n&&e.manuallyAnimateOnMount&&(Z=!1),B.protectedKeys={...k},!B.isActive&&H===null||!q&&!B.prevProp||zE(q)||typeof q=="boolean")continue;let W=vfe(B.prevProp,q)||L===y&&B.isActive&&!Z&&F||R>N&&F,te=!1;const oe=Array.isArray(q)?q:[q];let ie=oe.reduce(i,{});H===!1&&(ie={});const{prevResolvedValues:ue={}}=B,_e={...ue,...ie},xe=be=>{W=!0,C.has(be)&&(te=!0,C.delete(be)),B.needsAnimating[be]=!0};for(const be in _e){const Ae=ie[be],me=ue[be];if(k.hasOwnProperty(be))continue;let ke=!1;L1(Ae)&&L1(me)?ke=!ZW(Ae,me):ke=Ae!==me,ke?Ae!==void 0?xe(be):C.add(be):Ae!==void 0&&C.has(be)?xe(be):B.protectedKeys[be]=!0}B.prevProp=q,B.prevResolvedValues=ie,B.isActive&&(k={...k,...ie}),n&&e.blockInitialAnimation&&(W=!1),W&&(!Z||te)&&E.push(...oe.map(be=>({animation:be,options:{type:L,...p}})))}if(C.size){const R={};C.forEach(L=>{const B=e.getBaseTarget(L);B!==void 0&&(R[L]=B)}),E.push({animation:R})}let O=!!E.length;return n&&(b.initial===!1||b.initial===b.animate)&&!e.manuallyAnimateOnMount&&(O=!1),n=!1,O?t(E):Promise.resolve()}function s(p,y,b){var _;if(r[p].isActive===y)return Promise.resolve();(_=e.variantChildren)===null||_===void 0||_.forEach(C=>{var k;return(k=C.animationState)===null||k===void 0?void 0:k.setActive(p,y)}),r[p].isActive=y;const E=h(b,p);for(const C in r)r[C].protectedKeys={};return E}return{animateChanges:h,setActive:s,setAnimateFunction:o,getState:()=>r}}function vfe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!ZW(t,e):!1}function Th(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function xfe(){return{animate:Th(!0),whileInView:Th(),whileHover:Th(),whileTap:Th(),whileDrag:Th(),whileFocus:Th(),exit:Th()}}class bfe extends Ad{constructor(t){super(t),t.animationState||(t.animationState=yfe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),zE(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let _fe=0;class wfe extends Ad{constructor(){super(...arguments),this.id=_fe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===i)return;const o=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&o.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const Sfe={animation:{Feature:bfe},exit:{Feature:wfe}},sB=(e,t)=>Math.abs(e-t);function Efe(e,t){const r=sB(e.x,t.x),n=sB(e.y,t.y);return Math.sqrt(r**2+n**2)}class AG{constructor(t,r,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _=TC(this.lastMoveEventInfo,this.history),E=this.startEvent!==null,C=Efe(_.offset,{x:0,y:0})>=3;if(!E&&!C)return;const{point:k}=_,{timestamp:N}=ls;this.history.push({...k,timestamp:N});const{onStart:O,onMove:R}=this.handlers;E||(O&&O(this.lastMoveEvent,_),this.startEvent=this.lastMoveEvent),R&&R(this.lastMoveEvent,_)},this.handlePointerMove=(_,E)=>{this.lastMoveEvent=_,this.lastMoveEventInfo=EC(E,this.transformPagePoint),gn.update(this.updatePoint,!0)},this.handlePointerUp=(_,E)=>{this.end();const{onEnd:C,onSessionEnd:k,resumeAnimation:N}=this.handlers;if(this.dragSnapToOrigin&&N&&N(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const O=TC(_.type==="pointercancel"?this.lastMoveEventInfo:EC(E,this.transformPagePoint),this.history);this.startEvent&&C&&C(_,O),k&&k(_,O)},!WW(t))return;this.dragSnapToOrigin=o,this.handlers=r,this.transformPagePoint=n,this.contextWindow=i||window;const h=UE(t),s=EC(h,this.transformPagePoint),{point:p}=s,{timestamp:y}=ls;this.history=[{...p,timestamp:y}];const{onSessionStart:b}=r;b&&b(t,TC(s,this.history)),this.removeListeners=ud(Ac(this.contextWindow,"pointermove",this.handlePointerMove),Ac(this.contextWindow,"pointerup",this.handlePointerUp),Ac(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),fl(this.updatePoint)}}function EC(e,t){return t?{point:t(e.point)}:e}function aB(e,t){return{x:e.x-t.x,y:e.y-t.y}}function TC({point:e},t){return{point:e,delta:aB(e,NG(t)),offset:aB(e,Tfe(t)),velocity:jfe(t,.1)}}function Tfe(e){return e[0]}function NG(e){return e[e.length-1]}function jfe(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const i=NG(e);for(;r>=0&&(n=e[r],!(i.timestamp-n.timestamp>dd(t)));)r--;if(!n)return{x:0,y:0};const o=Nc(i.timestamp-n.timestamp);if(o===0)return{x:0,y:0};const h={x:(i.x-n.x)/o,y:(i.y-n.y)/o};return h.x===1/0&&(h.x=0),h.y===1/0&&(h.y=0),h}function La(e){return e.max-e.min}function zA(e,t=0,r=.01){return Math.abs(e-t)<=r}function oB(e,t,r,n=.5){e.origin=n,e.originPoint=oi(t.min,t.max,e.origin),e.scale=La(r)/La(t),(zA(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=oi(r.min,r.max,e.origin)-e.originPoint,(zA(e.translate)||isNaN(e.translate))&&(e.translate=0)}function px(e,t,r,n){oB(e.x,t.x,r.x,n?n.originX:void 0),oB(e.y,t.y,r.y,n?n.originY:void 0)}function lB(e,t,r){e.min=r.min+t.min,e.max=e.min+La(t)}function Cfe(e,t,r){lB(e.x,t.x,r.x),lB(e.y,t.y,r.y)}function cB(e,t,r){e.min=t.min-r.min,e.max=e.min+La(t)}function mx(e,t,r){cB(e.x,t.x,r.x),cB(e.y,t.y,r.y)}function Pfe(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?oi(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?oi(r,e,n.max):Math.min(e,r)),e}function uB(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function Afe(e,{top:t,left:r,bottom:n,right:i}){return{x:uB(e.x,r,i),y:uB(e.y,t,n)}}function dB(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function Nfe(e,t){return{x:dB(e.x,t.x),y:dB(e.y,t.y)}}function kfe(e,t){let r=.5;const n=La(e),i=La(t);return i>n?r=Im(t.min,t.max-n,e.min):n>i&&(r=Im(e.min,e.max-i,t.min)),bd(0,1,r)}function Mfe(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const $A=.35;function Ife(e=$A){return e===!1?e=0:e===!0&&(e=$A),{x:hB(e,"left","right"),y:hB(e,"top","bottom")}}function hB(e,t,r){return{min:fB(e,t),max:fB(e,r)}}function fB(e,t){return typeof e=="number"?e:e[t]||0}const pB=()=>({translate:0,scale:1,origin:0,originPoint:0}),im=()=>({x:pB(),y:pB()}),mB=()=>({min:0,max:0}),Ti=()=>({x:mB(),y:mB()});function io(e){return[e("x"),e("y")]}function kG({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function Ofe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Rfe(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function jC(e){return e===void 0||e===1}function FA({scale:e,scaleX:t,scaleY:r}){return!jC(e)||!jC(t)||!jC(r)}function kh(e){return FA(e)||MG(e)||e.z||e.rotate||e.rotateX||e.rotateY}function MG(e){return gB(e.x)||gB(e.y)}function gB(e){return e&&e!=="0%"}function U1(e,t,r){const n=e-r,i=t*n;return r+i}function yB(e,t,r,n,i){return i!==void 0&&(e=U1(e,i,n)),U1(e,r,n)+t}function UA(e,t=0,r=1,n,i){e.min=yB(e.min,t,r,n,i),e.max=yB(e.max,t,r,n,i)}function IG(e,{x:t,y:r}){UA(e.x,t.translate,t.scale,t.originPoint),UA(e.y,r.translate,r.scale,r.originPoint)}function Dfe(e,t,r,n=!1){const i=r.length;if(!i)return;t.x=t.y=1;let o,h;for(let s=0;s<i;s++){o=r[s],h=o.projectionDelta;const p=o.instance;p&&p.style&&p.style.display==="contents"||(n&&o.options.layoutScroll&&o.scroll&&o!==o.root&&sm(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),h&&(t.x*=h.x.scale,t.y*=h.y.scale,IG(e,h)),n&&kh(o.latestValues)&&sm(e,o.latestValues))}t.x=vB(t.x),t.y=vB(t.y)}function vB(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Wu(e,t){e.min=e.min+t,e.max=e.max+t}function xB(e,t,[r,n,i]){const o=t[i]!==void 0?t[i]:.5,h=oi(e.min,e.max,o);UA(e,t[r],t[n],h,t.scale)}const Lfe=["x","scaleX","originX"],Bfe=["y","scaleY","originY"];function sm(e,t){xB(e.x,t,Lfe),xB(e.y,t,Bfe)}function OG(e,t){return kG(Rfe(e.getBoundingClientRect(),t))}function zfe(e,t,r){const n=OG(e,r),{scroll:i}=t;return i&&(Wu(n.x,i.offset.x),Wu(n.y,i.offset.y)),n}const RG=({current:e})=>e?e.ownerDocument.defaultView:null,$fe=new WeakMap;class Ffe{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ti(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=b=>{const{dragSnapToOrigin:_}=this.getProps();_?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(UE(b,"page").point)},o=(b,_)=>{const{drag:E,dragPropagation:C,onDragStart:k}=this.getProps();if(E&&!C&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=HW(E),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),io(O=>{let R=this.getAxisMotionValue(O).get()||0;if(Fl.test(R)){const{projection:L}=this.visualElement;if(L&&L.layout){const B=L.layout.layoutBox[O];B&&(R=La(B)*(parseFloat(R)/100))}}this.originPoint[O]=R}),k&&gn.update(()=>k(b,_),!1,!0);const{animationState:N}=this.visualElement;N&&N.setActive("whileDrag",!0)},h=(b,_)=>{const{dragPropagation:E,dragDirectionLock:C,onDirectionLock:k,onDrag:N}=this.getProps();if(!E&&!this.openGlobalLock)return;const{offset:O}=_;if(C&&this.currentDirection===null){this.currentDirection=Ufe(O),this.currentDirection!==null&&k&&k(this.currentDirection);return}this.updateAxis("x",_.point,O),this.updateAxis("y",_.point,O),this.visualElement.render(),N&&N(b,_)},s=(b,_)=>this.stop(b,_),p=()=>io(b=>{var _;return this.getAnimationState(b)==="paused"&&((_=this.getAxisMotionValue(b).animation)===null||_===void 0?void 0:_.play())}),{dragSnapToOrigin:y}=this.getProps();this.panSession=new AG(t,{onSessionStart:i,onStart:o,onMove:h,onSessionEnd:s,resumeAnimation:p},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:y,contextWindow:RG(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=r;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&gn.update(()=>o(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:i}=this.getProps();if(!n||!fw(t,i,this.currentDirection))return;const o=this.getAxisMotionValue(t);let h=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(h=Pfe(h,this.constraints[t],this.elastic[t])),o.set(h)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,o=this.constraints;r&&rm(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&i?this.constraints=Afe(i.layoutBox,r):this.constraints=!1,this.elastic=Ife(n),o!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&io(h=>{this.getAxisMotionValue(h)&&(this.constraints[h]=Mfe(i.layoutBox[h],this.constraints[h]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!rm(t))return!1;const n=t.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const o=zfe(n,i.root,this.visualElement.getTransformPagePoint());let h=Nfe(i.layout.layoutBox,o);if(r){const s=r(Ofe(h));this.hasMutatedConstraints=!!s,s&&(h=kG(s))}return h}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:i,dragTransition:o,dragSnapToOrigin:h,onDragTransitionEnd:s}=this.getProps(),p=this.constraints||{},y=io(b=>{if(!fw(b,r,this.currentDirection))return;let _=p&&p[b]||{};h&&(_={min:0,max:0});const E=i?200:1e6,C=i?40:1e7,k={type:"inertia",velocity:n?t[b]:0,bounceStiffness:E,bounceDamping:C,timeConstant:750,restDelta:1,restSpeed:10,...o,..._};return this.startAxisValueAnimation(b,k)});return Promise.all(y).then(s)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(SI(t,n,0,r))}stopAnimation(){io(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){io(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),i=n[r];return i||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){io(r=>{const{drag:n}=this.getProps();if(!fw(r,n,this.currentDirection))return;const{projection:i}=this.visualElement,o=this.getAxisMotionValue(r);if(i&&i.layout){const{min:h,max:s}=i.layout.layoutBox[r];o.set(t[r]-oi(h,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!rm(r)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};io(h=>{const s=this.getAxisMotionValue(h);if(s){const p=s.get();i[h]=kfe({min:p,max:p},this.constraints[h])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),io(h=>{if(!fw(h,t,null))return;const s=this.getAxisMotionValue(h),{min:p,max:y}=this.constraints[h];s.set(oi(p,y,i[h]))})}addListeners(){if(!this.visualElement.current)return;$fe.set(this.visualElement,this);const t=this.visualElement.current,r=Ac(t,"pointerdown",p=>{const{drag:y,dragListener:b=!0}=this.getProps();y&&b&&this.start(p)}),n=()=>{const{dragConstraints:p}=this.getProps();rm(p)&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),n();const h=Ec(window,"resize",()=>this.scalePositionWithinConstraints()),s=i.addEventListener("didUpdate",({delta:p,hasLayoutChanged:y})=>{this.isDragging&&y&&(io(b=>{const _=this.getAxisMotionValue(b);_&&(this.originPoint[b]+=p[b].translate,_.set(_.get()+p[b].translate))}),this.visualElement.render())});return()=>{h(),r(),o(),s&&s()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:h=$A,dragMomentum:s=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:i,dragConstraints:o,dragElastic:h,dragMomentum:s}}}function fw(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function Ufe(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class Vfe extends Ad{constructor(t){super(t),this.removeGroupControls=pi,this.removeListeners=pi,this.controls=new Ffe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||pi}unmount(){this.removeGroupControls(),this.removeListeners()}}const bB=e=>(t,r)=>{e&&gn.update(()=>e(t,r))};class qfe extends Ad{constructor(){super(...arguments),this.removePointerDownListener=pi}onPointerDown(t){this.session=new AG(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:RG(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:bB(t),onStart:bB(r),onMove:n,onEnd:(o,h)=>{delete this.session,i&&gn.update(()=>i(o,h))}}}mount(){this.removePointerDownListener=Ac(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Wfe(){const e=I.useContext(LE);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,i=I.useId();return I.useEffect(()=>n(i),[]),!t&&r?[!1,()=>r&&r(i)]:[!0]}const Xw={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function _B(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const jv={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(xr.test(e))e=parseFloat(e);else return e;const r=_B(e,t.target.x),n=_B(e,t.target.y);return`${r}% ${n}%`}},Gfe={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,i=_d.parse(e);if(i.length>5)return n;const o=_d.createTransformer(e),h=typeof i[0]!="number"?1:0,s=r.x.scale*t.x,p=r.y.scale*t.y;i[0+h]/=s,i[1+h]/=p;const y=oi(s,p,.5);return typeof i[2+h]=="number"&&(i[2+h]/=y),typeof i[3+h]=="number"&&(i[3+h]/=y),o(i)}};class Hfe extends je.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:i}=this.props,{projection:o}=t;nde(Xfe),o&&(r.group&&r.group.add(o),n&&n.register&&i&&n.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),Xw.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:i,isPresent:o}=this.props,h=n.projection;return h&&(h.isPresent=o,i||t.layoutDependency!==r||r===void 0?h.willUpdate():this.safeToRemove(),t.isPresent!==o&&(o?h.promote():h.relegate()||gn.postRender(()=>{const s=h.getStack();(!s||!s.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:i}=t;i&&(i.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function DG(e){const[t,r]=Wfe(),n=I.useContext(cI);return je.createElement(Hfe,{...e,layoutGroup:n,switchLayoutGroup:I.useContext(kW),isPresent:t,safeToRemove:r})}const Xfe={borderRadius:{...jv,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:jv,borderTopRightRadius:jv,borderBottomLeftRadius:jv,borderBottomRightRadius:jv,boxShadow:Gfe},LG=["TopLeft","TopRight","BottomLeft","BottomRight"],Kfe=LG.length,wB=e=>typeof e=="string"?parseFloat(e):e,SB=e=>typeof e=="number"||xr.test(e);function Zfe(e,t,r,n,i,o){i?(e.opacity=oi(0,r.opacity!==void 0?r.opacity:1,Yfe(n)),e.opacityExit=oi(t.opacity!==void 0?t.opacity:1,0,Jfe(n))):o&&(e.opacity=oi(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let h=0;h<Kfe;h++){const s=`border${LG[h]}Radius`;let p=EB(t,s),y=EB(r,s);if(p===void 0&&y===void 0)continue;p||(p=0),y||(y=0),p===0||y===0||SB(p)===SB(y)?(e[s]=Math.max(oi(wB(p),wB(y),n),0),(Fl.test(y)||Fl.test(p))&&(e[s]+="%")):e[s]=y}(t.rotate||r.rotate)&&(e.rotate=oi(t.rotate||0,r.rotate||0,n))}function EB(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Yfe=BG(0,.5,aG),Jfe=BG(.5,.95,pi);function BG(e,t,r){return n=>n<e?0:n>t?1:r(Im(e,t,n))}function TB(e,t){e.min=t.min,e.max=t.max}function eo(e,t){TB(e.x,t.x),TB(e.y,t.y)}function jB(e,t,r,n,i){return e-=t,e=U1(e,1/r,n),i!==void 0&&(e=U1(e,1/i,n)),e}function Qfe(e,t=0,r=1,n=.5,i,o=e,h=e){if(Fl.test(t)&&(t=parseFloat(t),t=oi(h.min,h.max,t/100)-h.min),typeof t!="number")return;let s=oi(o.min,o.max,n);e===o&&(s-=t),e.min=jB(e.min,t,r,s,i),e.max=jB(e.max,t,r,s,i)}function CB(e,t,[r,n,i],o,h){Qfe(e,t[r],t[n],t[i],t.scale,o,h)}const epe=["x","scaleX","originX"],tpe=["y","scaleY","originY"];function PB(e,t,r,n){CB(e.x,t,epe,r?r.x:void 0,n?n.x:void 0),CB(e.y,t,tpe,r?r.y:void 0,n?n.y:void 0)}function AB(e){return e.translate===0&&e.scale===1}function zG(e){return AB(e.x)&&AB(e.y)}function rpe(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function $G(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function NB(e){return La(e.x)/La(e.y)}class npe{constructor(){this.members=[]}add(t){EI(this.members,t),t.scheduleRender()}remove(t){if(TI(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(i=>t===i);if(r===0)return!1;let n;for(let i=r;i>=0;i--){const o=this.members[i];if(o.isPresent!==!1){n=o;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:i}=t.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function kB(e,t,r){let n="";const i=e.x.translate/t.x,o=e.y.translate/t.y;if((i||o)&&(n=`translate3d(${i}px, ${o}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:p,rotateX:y,rotateY:b}=r;p&&(n+=`rotate(${p}deg) `),y&&(n+=`rotateX(${y}deg) `),b&&(n+=`rotateY(${b}deg) `)}const h=e.x.scale*t.x,s=e.y.scale*t.y;return(h!==1||s!==1)&&(n+=`scale(${h}, ${s})`),n||"none"}const ipe=(e,t)=>e.depth-t.depth;class spe{constructor(){this.children=[],this.isDirty=!1}add(t){EI(this.children,t),this.isDirty=!0}remove(t){TI(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(ipe),this.isDirty=!1,this.children.forEach(t)}}function ape(e,t){const r=performance.now(),n=({timestamp:i})=>{const o=i-r;o>=t&&(fl(n),e(o-t))};return gn.read(n,!0),()=>fl(n)}function ope(e){window.MotionDebug&&window.MotionDebug.record(e)}function lpe(e){return e instanceof SVGElement&&e.tagName!=="svg"}function cpe(e,t,r){const n=ga(e)?e:sl(e);return n.start(SI("",n,t,r)),n.animation}const MB=["","X","Y","Z"],upe={visibility:"hidden"},IB=1e3;let dpe=0;const Mh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function FG({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(h={},s=t==null?void 0:t()){this.id=dpe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Mh.totalNodes=Mh.resolvedTargetDeltas=Mh.recalculatedProjection=0,this.nodes.forEach(ppe),this.nodes.forEach(xpe),this.nodes.forEach(bpe),this.nodes.forEach(mpe),ope(Mh)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=h,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let p=0;p<this.path.length;p++)this.path[p].shouldResetTransform=!0;this.root===this&&(this.nodes=new spe)}addEventListener(h,s){return this.eventHandlers.has(h)||this.eventHandlers.set(h,new jI),this.eventHandlers.get(h).add(s)}notifyListeners(h,...s){const p=this.eventHandlers.get(h);p&&p.notify(...s)}hasListeners(h){return this.eventHandlers.has(h)}mount(h,s=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=lpe(h),this.instance=h;const{layoutId:p,layout:y,visualElement:b}=this.options;if(b&&!b.current&&b.mount(h),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),s&&(y||p)&&(this.isLayoutDirty=!0),e){let _;const E=()=>this.root.updateBlockedByResize=!1;e(h,()=>{this.root.updateBlockedByResize=!0,_&&_(),_=ape(E,250),Xw.hasAnimatedSinceResize&&(Xw.hasAnimatedSinceResize=!1,this.nodes.forEach(RB))})}p&&this.root.registerSharedNode(p,this),this.options.animate!==!1&&b&&(p||y)&&this.addEventListener("didUpdate",({delta:_,hasLayoutChanged:E,hasRelativeTargetChanged:C,layout:k})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const N=this.options.transition||b.getDefaultTransition()||Tpe,{onLayoutAnimationStart:O,onLayoutAnimationComplete:R}=b.getProps(),L=!this.targetLayout||!$G(this.targetLayout,k)||C,B=!E&&C;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||B||E&&(L||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(_,B);const q={...wI(N,"layout"),onPlay:O,onComplete:R};(b.shouldReduceMotion||this.options.layoutRoot)&&(q.delay=0,q.type=!1),this.startAnimation(q)}else E||RB(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=k})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const h=this.getStack();h&&h.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,fl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(_pe),this.animationId++)}getTransformTemplate(){const{visualElement:h}=this.options;return h&&h.getProps().transformTemplate}willUpdate(h=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let b=0;b<this.path.length;b++){const _=this.path[b];_.shouldResetTransform=!0,_.updateScroll("snapshot"),_.options.layoutRoot&&_.willUpdate(!1)}const{layoutId:s,layout:p}=this.options;if(s===void 0&&!p)return;const y=this.getTransformTemplate();this.prevTransformTemplateValue=y?y(this.latestValues,""):void 0,this.updateSnapshot(),h&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(OB);return}this.isUpdating||this.nodes.forEach(ype),this.isUpdating=!1,this.nodes.forEach(vpe),this.nodes.forEach(hpe),this.nodes.forEach(fpe),this.clearAllSnapshots();const s=performance.now();ls.delta=bd(0,1e3/60,s-ls.timestamp),ls.timestamp=s,ls.isProcessing=!0,gC.update.process(ls),gC.preRender.process(ls),gC.render.process(ls),ls.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(gpe),this.sharedNodes.forEach(wpe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let p=0;p<this.path.length;p++)this.path[p].updateScroll();const h=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ti(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:s}=this.options;s&&s.notify("LayoutMeasure",this.layout.layoutBox,h?h.layoutBox:void 0)}updateScroll(h="measure"){let s=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===h&&(s=!1),s&&(this.scroll={animationId:this.root.animationId,phase:h,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!i)return;const h=this.isLayoutDirty||this.shouldResetTransform,s=this.projectionDelta&&!zG(this.projectionDelta),p=this.getTransformTemplate(),y=p?p(this.latestValues,""):void 0,b=y!==this.prevTransformTemplateValue;h&&(s||kh(this.latestValues)||b)&&(i(this.instance,y),this.shouldResetTransform=!1,this.scheduleRender())}measure(h=!0){const s=this.measurePageBox();let p=this.removeElementScroll(s);return h&&(p=this.removeTransform(p)),jpe(p),{animationId:this.root.animationId,measuredBox:s,layoutBox:p,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:h}=this.options;if(!h)return Ti();const s=h.measureViewportBox(),{scroll:p}=this.root;return p&&(Wu(s.x,p.offset.x),Wu(s.y,p.offset.y)),s}removeElementScroll(h){const s=Ti();eo(s,h);for(let p=0;p<this.path.length;p++){const y=this.path[p],{scroll:b,options:_}=y;if(y!==this.root&&b&&_.layoutScroll){if(b.isRoot){eo(s,h);const{scroll:E}=this.root;E&&(Wu(s.x,-E.offset.x),Wu(s.y,-E.offset.y))}Wu(s.x,b.offset.x),Wu(s.y,b.offset.y)}}return s}applyTransform(h,s=!1){const p=Ti();eo(p,h);for(let y=0;y<this.path.length;y++){const b=this.path[y];!s&&b.options.layoutScroll&&b.scroll&&b!==b.root&&sm(p,{x:-b.scroll.offset.x,y:-b.scroll.offset.y}),kh(b.latestValues)&&sm(p,b.latestValues)}return kh(this.latestValues)&&sm(p,this.latestValues),p}removeTransform(h){const s=Ti();eo(s,h);for(let p=0;p<this.path.length;p++){const y=this.path[p];if(!y.instance||!kh(y.latestValues))continue;FA(y.latestValues)&&y.updateSnapshot();const b=Ti(),_=y.measurePageBox();eo(b,_),PB(s,y.latestValues,y.snapshot?y.snapshot.layoutBox:void 0,b)}return kh(this.latestValues)&&PB(s,this.latestValues),s}setTargetDelta(h){this.targetDelta=h,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(h){this.options={...this.options,...h,crossfade:h.crossfade!==void 0?h.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ls.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(h=!1){var s;const p=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=p.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=p.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=p.isSharedProjectionDirty);const y=!!this.resumingFrom||this!==p;if(!(h||y&&this.isSharedProjectionDirty||this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:_,layoutId:E}=this.options;if(!(!this.layout||!(_||E))){if(this.resolvedRelativeTargetAt=ls.timestamp,!this.targetDelta&&!this.relativeTarget){const C=this.getClosestProjectingParent();C&&C.layout&&this.animationProgress!==1?(this.relativeParent=C,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ti(),this.relativeTargetOrigin=Ti(),mx(this.relativeTargetOrigin,this.layout.layoutBox,C.layout.layoutBox),eo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ti(),this.targetWithTransforms=Ti()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Cfe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):eo(this.target,this.layout.layoutBox),IG(this.target,this.targetDelta)):eo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const C=this.getClosestProjectingParent();C&&!!C.resumingFrom==!!this.resumingFrom&&!C.options.layoutScroll&&C.target&&this.animationProgress!==1?(this.relativeParent=C,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ti(),this.relativeTargetOrigin=Ti(),mx(this.relativeTargetOrigin,this.target,C.target),eo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Mh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||FA(this.parent.latestValues)||MG(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var h;const s=this.getLead(),p=!!this.resumingFrom||this!==s;let y=!0;if((this.isProjectionDirty||!((h=this.parent)===null||h===void 0)&&h.isProjectionDirty)&&(y=!1),p&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(y=!1),this.resolvedRelativeTargetAt===ls.timestamp&&(y=!1),y)return;const{layout:b,layoutId:_}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(b||_))return;eo(this.layoutCorrected,this.layout.layoutBox);const E=this.treeScale.x,C=this.treeScale.y;Dfe(this.layoutCorrected,this.treeScale,this.path,p),s.layout&&!s.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(s.target=s.layout.layoutBox);const{target:k}=s;if(!k){this.projectionTransform&&(this.projectionDelta=im(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=im(),this.projectionDeltaWithTransform=im());const N=this.projectionTransform;px(this.projectionDelta,this.layoutCorrected,k,this.latestValues),this.projectionTransform=kB(this.projectionDelta,this.treeScale),(this.projectionTransform!==N||this.treeScale.x!==E||this.treeScale.y!==C)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",k)),Mh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(h=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),h){const s=this.getStack();s&&s.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(h,s=!1){const p=this.snapshot,y=p?p.latestValues:{},b={...this.latestValues},_=im();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!s;const E=Ti(),C=p?p.source:void 0,k=this.layout?this.layout.source:void 0,N=C!==k,O=this.getStack(),R=!O||O.members.length<=1,L=!!(N&&!R&&this.options.crossfade===!0&&!this.path.some(Epe));this.animationProgress=0;let B;this.mixTargetDelta=q=>{const F=q/1e3;DB(_.x,h.x,F),DB(_.y,h.y,F),this.setTargetDelta(_),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(mx(E,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Spe(this.relativeTarget,this.relativeTargetOrigin,E,F),B&&rpe(this.relativeTarget,B)&&(this.isProjectionDirty=!1),B||(B=Ti()),eo(B,this.relativeTarget)),N&&(this.animationValues=b,Zfe(b,y,this.latestValues,F,L,R)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(h){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(fl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gn.update(()=>{Xw.hasAnimatedSinceResize=!0,this.currentAnimation=cpe(0,IB,{...h,onUpdate:s=>{this.mixTargetDelta(s),h.onUpdate&&h.onUpdate(s)},onComplete:()=>{h.onComplete&&h.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const h=this.getStack();h&&h.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(IB),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const h=this.getLead();let{targetWithTransforms:s,target:p,layout:y,latestValues:b}=h;if(!(!s||!p||!y)){if(this!==h&&this.layout&&y&&UG(this.options.animationType,this.layout.layoutBox,y.layoutBox)){p=this.target||Ti();const _=La(this.layout.layoutBox.x);p.x.min=h.target.x.min,p.x.max=p.x.min+_;const E=La(this.layout.layoutBox.y);p.y.min=h.target.y.min,p.y.max=p.y.min+E}eo(s,p),sm(s,b),px(this.projectionDeltaWithTransform,this.layoutCorrected,s,b)}}registerSharedNode(h,s){this.sharedNodes.has(h)||this.sharedNodes.set(h,new npe),this.sharedNodes.get(h).add(s);const y=s.options.initialPromotionConfig;s.promote({transition:y?y.transition:void 0,preserveFollowOpacity:y&&y.shouldPreserveFollowOpacity?y.shouldPreserveFollowOpacity(s):void 0})}isLead(){const h=this.getStack();return h?h.lead===this:!0}getLead(){var h;const{layoutId:s}=this.options;return s?((h=this.getStack())===null||h===void 0?void 0:h.lead)||this:this}getPrevLead(){var h;const{layoutId:s}=this.options;return s?(h=this.getStack())===null||h===void 0?void 0:h.prevLead:void 0}getStack(){const{layoutId:h}=this.options;if(h)return this.root.sharedNodes.get(h)}promote({needsReset:h,transition:s,preserveFollowOpacity:p}={}){const y=this.getStack();y&&y.promote(this,p),h&&(this.projectionDelta=void 0,this.needsReset=!0),s&&this.setOptions({transition:s})}relegate(){const h=this.getStack();return h?h.relegate(this):!1}resetRotation(){const{visualElement:h}=this.options;if(!h)return;let s=!1;const{latestValues:p}=h;if((p.rotate||p.rotateX||p.rotateY||p.rotateZ)&&(s=!0),!s)return;const y={};for(let b=0;b<MB.length;b++){const _="rotate"+MB[b];p[_]&&(y[_]=p[_],h.setStaticValue(_,0))}h.render();for(const b in y)h.setStaticValue(b,y[b]);h.scheduleRender()}getProjectionStyles(h){var s,p;if(!this.instance||this.isSVG)return;if(!this.isVisible)return upe;const y={visibility:""},b=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,y.opacity="",y.pointerEvents=Hw(h==null?void 0:h.pointerEvents)||"",y.transform=b?b(this.latestValues,""):"none",y;const _=this.getLead();if(!this.projectionDelta||!this.layout||!_.target){const N={};return this.options.layoutId&&(N.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,N.pointerEvents=Hw(h==null?void 0:h.pointerEvents)||""),this.hasProjected&&!kh(this.latestValues)&&(N.transform=b?b({},""):"none",this.hasProjected=!1),N}const E=_.animationValues||_.latestValues;this.applyTransformsToTarget(),y.transform=kB(this.projectionDeltaWithTransform,this.treeScale,E),b&&(y.transform=b(E,y.transform));const{x:C,y:k}=this.projectionDelta;y.transformOrigin=`${C.origin*100}% ${k.origin*100}% 0`,_.animationValues?y.opacity=_===this?(p=(s=E.opacity)!==null&&s!==void 0?s:this.latestValues.opacity)!==null&&p!==void 0?p:1:this.preserveOpacity?this.latestValues.opacity:E.opacityExit:y.opacity=_===this?E.opacity!==void 0?E.opacity:"":E.opacityExit!==void 0?E.opacityExit:0;for(const N in R1){if(E[N]===void 0)continue;const{correct:O,applyTo:R}=R1[N],L=y.transform==="none"?E[N]:O(E[N],_);if(R){const B=R.length;for(let q=0;q<B;q++)y[R[q]]=L}else y[N]=L}return this.options.layoutId&&(y.pointerEvents=_===this?Hw(h==null?void 0:h.pointerEvents)||"":"none"),y}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(h=>{var s;return(s=h.currentAnimation)===null||s===void 0?void 0:s.stop()}),this.root.nodes.forEach(OB),this.root.sharedNodes.clear()}}}function hpe(e){e.updateLayout()}function fpe(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=e.layout,{animationType:o}=e.options,h=r.source!==e.layout.source;o==="size"?io(_=>{const E=h?r.measuredBox[_]:r.layoutBox[_],C=La(E);E.min=n[_].min,E.max=E.min+C}):UG(o,r.layoutBox,n)&&io(_=>{const E=h?r.measuredBox[_]:r.layoutBox[_],C=La(n[_]);E.max=E.min+C,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[_].max=e.relativeTarget[_].min+C)});const s=im();px(s,n,r.layoutBox);const p=im();h?px(p,e.applyTransform(i,!0),r.measuredBox):px(p,n,r.layoutBox);const y=!zG(s);let b=!1;if(!e.resumeFrom){const _=e.getClosestProjectingParent();if(_&&!_.resumeFrom){const{snapshot:E,layout:C}=_;if(E&&C){const k=Ti();mx(k,r.layoutBox,E.layoutBox);const N=Ti();mx(N,n,C.layoutBox),$G(k,N)||(b=!0),_.options.layoutRoot&&(e.relativeTarget=N,e.relativeTargetOrigin=k,e.relativeParent=_)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:p,layoutDelta:s,hasLayoutChanged:y,hasRelativeTargetChanged:b})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function ppe(e){Mh.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function mpe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function gpe(e){e.clearSnapshot()}function OB(e){e.clearMeasurements()}function ype(e){e.isLayoutDirty=!1}function vpe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function RB(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function xpe(e){e.resolveTargetDelta()}function bpe(e){e.calcProjection()}function _pe(e){e.resetRotation()}function wpe(e){e.removeLeadSnapshot()}function DB(e,t,r){e.translate=oi(t.translate,0,r),e.scale=oi(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function LB(e,t,r,n){e.min=oi(t.min,r.min,n),e.max=oi(t.max,r.max,n)}function Spe(e,t,r,n){LB(e.x,t.x,r.x,n),LB(e.y,t.y,r.y,n)}function Epe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Tpe={duration:.45,ease:[.4,0,.1,1]},BB=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),zB=BB("applewebkit/")&&!BB("chrome/")?Math.round:pi;function $B(e){e.min=zB(e.min),e.max=zB(e.max)}function jpe(e){$B(e.x),$B(e.y)}function UG(e,t,r){return e==="position"||e==="preserve-aspect"&&!zA(NB(t),NB(r),.2)}const Cpe=FG({attachResizeListener:(e,t)=>Ec(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),CC={current:void 0},VG=FG({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!CC.current){const e=new Cpe({});e.mount(window),e.setOptions({layoutScroll:!0}),CC.current=e}return CC.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Ppe={pan:{Feature:qfe},drag:{Feature:Vfe,ProjectionNode:VG,MeasureLayout:DG}},Ape=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Npe(e){const t=Ape.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function VA(e,t,r=1){const[n,i]=Npe(e);if(!n)return;const o=window.getComputedStyle(t).getPropertyValue(n);if(o){const h=o.trim();return EG(h)?parseFloat(h):h}else return kA(i)?VA(i,t,r+1):i}function kpe(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(i=>{const o=i.get();if(!kA(o))return;const h=VA(o,n);h&&i.set(h)});for(const i in t){const o=t[i];if(!kA(o))continue;const h=VA(o,n);h&&(t[i]=h,r||(r={}),r[i]===void 0&&(r[i]=o))}return{target:t,transitionEnd:r}}const Mpe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),qG=e=>Mpe.has(e),Ipe=e=>Object.keys(e).some(qG),FB=e=>e===wf||e===xr,UB=(e,t)=>parseFloat(e.split(", ")[t]),VB=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const i=n.match(/^matrix3d\((.+)\)$/);if(i)return UB(i[1],t);{const o=n.match(/^matrix\((.+)\)$/);return o?UB(o[1],e):0}},Ope=new Set(["x","y","z"]),Rpe=X0.filter(e=>!Ope.has(e));function Dpe(e){const t=[];return Rpe.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const Om={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:VB(4,13),y:VB(5,14)};Om.translateX=Om.x;Om.translateY=Om.y;const Lpe=(e,t,r)=>{const n=t.measureViewportBox(),i=t.current,o=getComputedStyle(i),{display:h}=o,s={};h==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(y=>{s[y]=Om[y](n,o)}),t.render();const p=t.measureViewportBox();return r.forEach(y=>{const b=t.getValue(y);b&&b.jump(s[y]),e[y]=Om[y](p,o)}),e},Bpe=(e,t,r={},n={})=>{t={...t},n={...n};const i=Object.keys(t).filter(qG);let o=[],h=!1;const s=[];if(i.forEach(p=>{const y=e.getValue(p);if(!e.hasValue(p))return;let b=r[p],_=Tv(b);const E=t[p];let C;if(L1(E)){const k=E.length,N=E[0]===null?1:0;b=E[N],_=Tv(b);for(let O=N;O<k&&E[O]!==null;O++)C?qE(Tv(E[O])===C):C=Tv(E[O])}else C=Tv(E);if(_!==C)if(FB(_)&&FB(C)){const k=y.get();typeof k=="string"&&y.set(parseFloat(k)),typeof E=="string"?t[p]=parseFloat(E):Array.isArray(E)&&C===xr&&(t[p]=E.map(parseFloat))}else _!=null&&_.transform&&(C!=null&&C.transform)&&(b===0||E===0)?b===0?y.set(C.transform(b)):t[p]=_.transform(E):(h||(o=Dpe(e),h=!0),s.push(p),n[p]=n[p]!==void 0?n[p]:t[p],y.jump(E))}),s.length){const p=s.indexOf("height")>=0?window.pageYOffset:null,y=Lpe(t,e,s);return o.length&&o.forEach(([b,_])=>{e.getValue(b).set(_)}),e.render(),BE&&p!==null&&window.scrollTo({top:p}),{target:y,transitionEnd:n}}else return{target:t,transitionEnd:n}};function zpe(e,t,r,n){return Ipe(t)?Bpe(e,t,r,n):{target:t,transitionEnd:n}}const $pe=(e,t,r,n)=>{const i=kpe(e,t,n);return t=i.target,n=i.transitionEnd,zpe(e,t,r,n)},qA={current:null},WG={current:!1};function Fpe(){if(WG.current=!0,!!BE)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>qA.current=e.matches;e.addListener(t),t()}else qA.current=!1}function Upe(e,t,r){const{willChange:n}=t;for(const i in t){const o=t[i],h=r[i];if(ga(o))e.addValue(i,o),F1(n)&&n.add(i);else if(ga(h))e.addValue(i,sl(o,{owner:e})),F1(n)&&n.remove(i);else if(h!==o)if(e.hasValue(i)){const s=e.getValue(i);!s.hasAnimated&&s.set(o)}else{const s=e.getStaticValue(i);e.addValue(i,sl(s!==void 0?s:o,{owner:e}))}}for(const i in r)t[i]===void 0&&e.removeValue(i);return t}const qB=new WeakMap,GG=Object.keys(Zx),Vpe=GG.length,WB=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],qpe=lI.length;class Wpe{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:i,visualState:o},h={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>gn.render(this.render,!1,!0);const{latestValues:s,renderState:p}=o;this.latestValues=s,this.baseTarget={...s},this.initialValues=r.initial?{...s}:{},this.renderState=p,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=h,this.isControllingVariants=$E(r),this.isVariantNode=NW(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:y,...b}=this.scrapeMotionValuesFromProps(r,{});for(const _ in b){const E=b[_];s[_]!==void 0&&ga(E)&&(E.set(s[_],!1),F1(y)&&y.add(_))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,qB.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),WG.current||Fpe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:qA.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){qB.delete(this.current),this.projection&&this.projection.unmount(),fl(this.notifyUpdate),fl(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=_f.has(t),i=r.on("change",h=>{this.latestValues[t]=h,this.props.onUpdate&&gn.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),o=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{i(),o()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,i,o){let h,s;for(let p=0;p<Vpe;p++){const y=GG[p],{isEnabled:b,Feature:_,ProjectionNode:E,MeasureLayout:C}=Zx[y];E&&(h=E),b(r)&&(!this.features[y]&&_&&(this.features[y]=new _(this)),C&&(s=C))}if((this.type==="html"||this.type==="svg")&&!this.projection&&h){this.projection=new h(this.latestValues,this.parent&&this.parent.projection);const{layoutId:p,layout:y,drag:b,dragConstraints:_,layoutScroll:E,layoutRoot:C}=r;this.projection.setOptions({layoutId:p,layout:y,alwaysMeasureLayout:!!b||_&&rm(_),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof y=="string"?y:"both",initialPromotionConfig:o,layoutScroll:E,layoutRoot:C})}return s}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ti()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<WB.length;n++){const i=WB[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const o=t["on"+i];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=Upe(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<qpe;n++){const i=lI[n],o=this.props[i];(Kx(o)||o===!1)&&(r[i]=o)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=sl(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,i=typeof n=="string"||typeof n=="object"?(r=gI(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&i!==void 0)return i;const o=this.getBaseTargetFromProps(this.props,t);return o!==void 0&&!ga(o)?o:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new jI),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class HG extends Wpe{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:i},o){let h=cfe(n,t||{},this);if(i&&(r&&(r=i(r)),n&&(n=i(n)),h&&(h=i(h))),o){ofe(this,n,h);const s=$pe(this,n,h,r);r=s.transitionEnd,n=s.target}return{transition:t,transitionEnd:r,...n}}}function Gpe(e){return window.getComputedStyle(e)}class Hpe extends HG{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(_f.has(r)){const n=_I(r);return n&&n.default||0}else{const n=Gpe(t),i=(OW(r)?n.getPropertyValue(r):n[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:r}){return OG(t,r)}build(t,r,n,i){dI(t,r,n,i.transformTemplate)}scrapeMotionValuesFromProps(t,r){return mI(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ga(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,i){$W(t,r,n,i)}}class Xpe extends HG{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(_f.has(r)){const n=_I(r);return n&&n.default||0}return r=FW.has(r)?r:aI(r),t.getAttribute(r)}measureInstanceViewportBox(){return Ti()}scrapeMotionValuesFromProps(t,r){return VW(t,r)}build(t,r,n,i){fI(t,r,n,this.isSVGTag,i.transformTemplate)}renderInstance(t,r,n,i){UW(t,r,n,i)}mount(t){this.isSVGTag=pI(t.tagName),super.mount(t)}}const Kpe=(e,t)=>uI(e)?new Xpe(t,{enableHardwareAcceleration:!1}):new Hpe(t,{enableHardwareAcceleration:!0}),Zpe={layout:{ProjectionNode:VG,MeasureLayout:DG}},Ype={...Sfe,...Gde,...Ppe,...Zpe},tt=tde((e,t)=>Ide(e,t,Ype,Kpe));function XG(){const e=I.useRef(!1);return xg(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function Jpe(){const e=XG(),[t,r]=I.useState(0),n=I.useCallback(()=>{e.current&&r(t+1)},[t]);return[I.useCallback(()=>gn.postRender(n),[n]),t]}class Qpe extends I.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function eme({children:e,isPresent:t}){const r=I.useId(),n=I.useRef(null),i=I.useRef({width:0,height:0,top:0,left:0});return I.useInsertionEffect(()=>{const{width:o,height:h,top:s,left:p}=i.current;if(t||!n.current||!o||!h)return;n.current.dataset.motionPopId=r;const y=document.createElement("style");return document.head.appendChild(y),y.sheet&&y.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${h}px !important;
            top: ${s}px !important;
            left: ${p}px !important;
          }
        `),()=>{document.head.removeChild(y)}},[t]),I.createElement(Qpe,{isPresent:t,childRef:n,sizeRef:i},I.cloneElement(e,{ref:n}))}const PC=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:i,presenceAffectsLayout:o,mode:h})=>{const s=bg(tme),p=I.useId(),y=I.useMemo(()=>({id:p,initial:t,isPresent:r,custom:i,onExitComplete:b=>{s.set(b,!0);for(const _ of s.values())if(!_)return;n&&n()},register:b=>(s.set(b,!1),()=>s.delete(b))}),o?void 0:[r]);return I.useMemo(()=>{s.forEach((b,_)=>s.set(_,!1))},[r]),I.useEffect(()=>{!r&&!s.size&&n&&n()},[r]),h==="popLayout"&&(e=I.createElement(eme,{isPresent:r},e)),I.createElement(LE.Provider,{value:y},e)};function tme(){return new Map}function rme(e){return I.useEffect(()=>()=>e(),[])}const Ih=e=>e.key||"";function nme(e,t){e.forEach(r=>{const n=Ih(r);t.set(n,r)})}function ime(e){const t=[];return I.Children.forEach(e,r=>{I.isValidElement(r)&&t.push(r)}),t}const KG=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:i,presenceAffectsLayout:o=!0,mode:h="sync"})=>{const s=I.useContext(cI).forceRender||Jpe()[0],p=XG(),y=ime(e);let b=y;const _=I.useRef(new Map).current,E=I.useRef(b),C=I.useRef(new Map).current,k=I.useRef(!0);if(xg(()=>{k.current=!1,nme(y,C),E.current=b}),rme(()=>{k.current=!0,C.clear(),_.clear()}),k.current)return I.createElement(I.Fragment,null,b.map(L=>I.createElement(PC,{key:Ih(L),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:o,mode:h},L)));b=[...b];const N=E.current.map(Ih),O=y.map(Ih),R=N.length;for(let L=0;L<R;L++){const B=N[L];O.indexOf(B)===-1&&!_.has(B)&&_.set(B,void 0)}return h==="wait"&&_.size&&(b=[]),_.forEach((L,B)=>{if(O.indexOf(B)!==-1)return;const q=C.get(B);if(!q)return;const F=N.indexOf(B);let H=L;if(!H){const Z=()=>{_.delete(B);const re=Array.from(C.keys()).filter(W=>!O.includes(W));if(re.forEach(W=>C.delete(W)),E.current=y.filter(W=>{const te=Ih(W);return te===B||re.includes(te)}),!_.size){if(p.current===!1)return;s(),n&&n()}};H=I.createElement(PC,{key:Ih(q),isPresent:!1,onExitComplete:Z,custom:t,presenceAffectsLayout:o,mode:h},q),_.set(B,H)}b.splice(F,0,H)}),b=b.map(L=>{const B=L.key;return _.has(B)?L:I.createElement(PC,{key:Ih(L),isPresent:!0,presenceAffectsLayout:o,mode:h},L)}),I.createElement(I.Fragment,null,_.size?b:b.map(L=>I.cloneElement(L)))};function sme(e){const t=bg(()=>sl(e)),{isStatic:r}=I.useContext(sI);if(r){const[,n]=I.useState(e);I.useEffect(()=>t.on("change",n),[])}return t}const ame=e=>e&&typeof e=="object"&&e.mix,ome=e=>ame(e)?e.mix:void 0;function lme(...e){const t=!Array.isArray(e[0]),r=t?0:-1,n=e[0+r],i=e[1+r],o=e[2+r],h=e[3+r],s=WE(i,o,{mixer:ome(o[0]),...h});return t?s(n):s}function ZG(e,t){const r=sme(t()),n=()=>r.set(t());return n(),xg(()=>{const i=()=>gn.update(n,!1,!0),o=e.map(h=>h.on("change",i));return()=>{o.forEach(h=>h()),fl(n)}}),r}function cme(e){fx.current=[],e();const t=ZG(fx.current,e);return fx.current=void 0,t}function GB(e,t,r,n){if(typeof e=="function")return cme(e);const i=typeof t=="function"?t:lme(t,r,n);return Array.isArray(e)?HB(e,i):HB([e],([o])=>i(o))}function HB(e,t){const r=bg(()=>[]);return ZG(e,()=>{r.length=0;const n=e.length;for(let i=0;i<n;i++)r[i]=e[i].get();return t(r)})}function YG(e,t,r){var n;if(typeof e=="string"){let i=document;t&&(qE(!!t.current),i=t.current),r?((n=r[e])!==null&&n!==void 0||(r[e]=i.querySelectorAll(e)),e=r[e]):e=i.querySelectorAll(e)}else e instanceof Element&&(e=[e]);return Array.from(e||[])}const Kw=new WeakMap;let zu;function ume(e,t){if(t){const{inlineSize:r,blockSize:n}=t[0];return{width:r,height:n}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function dme({target:e,contentRect:t,borderBoxSize:r}){var n;(n=Kw.get(e))===null||n===void 0||n.forEach(i=>{i({target:e,contentSize:t,get size(){return ume(e,r)}})})}function hme(e){e.forEach(dme)}function fme(){typeof ResizeObserver>"u"||(zu=new ResizeObserver(hme))}function pme(e,t){zu||fme();const r=YG(e);return r.forEach(n=>{let i=Kw.get(n);i||(i=new Set,Kw.set(n,i)),i.add(t),zu==null||zu.observe(n)}),()=>{r.forEach(n=>{const i=Kw.get(n);i==null||i.delete(t),i!=null&&i.size||zu==null||zu.unobserve(n)})}}const Zw=new Set;let gx;function mme(){gx=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};Zw.forEach(r=>r(t))},window.addEventListener("resize",gx)}function gme(e){return Zw.add(e),gx||mme(),()=>{Zw.delete(e),!Zw.size&&gx&&(gx=void 0)}}function yme(e,t){return typeof e=="function"?gme(e):pme(e,t)}const vme=50,XB=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),xme=()=>({time:0,x:XB(),y:XB()}),bme={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function KB(e,t,r,n){const i=r[t],{length:o,position:h}=bme[t],s=i.current,p=r.time;i.current=e["scroll"+h],i.scrollLength=e["scroll"+o]-e["client"+o],i.offset.length=0,i.offset[0]=0,i.offset[1]=i.scrollLength,i.progress=Im(0,i.scrollLength,i.current);const y=n-p;i.velocity=y>vme?0:bI(i.current-s,y)}function _me(e,t,r){KB(e,"x",t,r),KB(e,"y",t,r),t.time=r}function wme(e,t){const r={x:0,y:0};let n=e;for(;n&&n!==t;)if(n instanceof HTMLElement)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;else if(n.tagName==="svg"){const i=n.getBoundingClientRect();n=n.parentElement;const o=n.getBoundingClientRect();r.x+=i.left-o.left,r.y+=i.top-o.top}else if(n instanceof SVGGraphicsElement){const{x:i,y:o}=n.getBBox();r.x+=i,r.y+=o;let h=null,s=n.parentNode;for(;!h;)s.tagName==="svg"&&(h=s),s=n.parentNode;n=h}else break;return r}const Sme={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},WA={start:0,center:.5,end:1};function ZB(e,t,r=0){let n=0;if(WA[e]!==void 0&&(e=WA[e]),typeof e=="string"){const i=parseFloat(e);e.endsWith("px")?n=i:e.endsWith("%")?e=i/100:e.endsWith("vw")?n=i/100*document.documentElement.clientWidth:e.endsWith("vh")?n=i/100*document.documentElement.clientHeight:e=i}return typeof e=="number"&&(n=t*e),r+n}const Eme=[0,0];function Tme(e,t,r,n){let i=Array.isArray(e)?e:Eme,o=0,h=0;return typeof e=="number"?i=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?i=e.split(" "):i=[e,WA[e]?e:"0"]),o=ZB(i[0],r,n),h=ZB(i[1],t),o-h}const jme={x:0,y:0};function Cme(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function Pme(e,t,r){let{offset:n=Sme.All}=r;const{target:i=e,axis:o="y"}=r,h=o==="y"?"height":"width",s=i!==e?wme(i,e):jme,p=i===e?{width:e.scrollWidth,height:e.scrollHeight}:Cme(i),y={width:e.clientWidth,height:e.clientHeight};t[o].offset.length=0;let b=!t[o].interpolate;const _=n.length;for(let E=0;E<_;E++){const C=Tme(n[E],y[h],p[h],s[o]);!b&&C!==t[o].interpolatorOffsets[E]&&(b=!0),t[o].offset[E]=C}b&&(t[o].interpolate=WE(t[o].offset,xG(n)),t[o].interpolatorOffsets=[...t[o].offset]),t[o].progress=t[o].interpolate(t[o].current)}function Ame(e,t=e,r){if(r.x.targetOffset=0,r.y.targetOffset=0,t!==e){let n=t;for(;n&&n!==e;)r.x.targetOffset+=n.offsetLeft,r.y.targetOffset+=n.offsetTop,n=n.offsetParent}r.x.targetLength=t===e?t.scrollWidth:t.clientWidth,r.y.targetLength=t===e?t.scrollHeight:t.clientHeight,r.x.containerLength=e.clientWidth,r.y.containerLength=e.clientHeight}function Nme(e,t,r,n={}){return{measure:()=>Ame(e,n.target,r),update:i=>{_me(e,r,i),(n.offset||n.target)&&Pme(e,r,n)},notify:()=>t(r)}}const Cv=new WeakMap,YB=new WeakMap,AC=new WeakMap,JB=e=>e===document.documentElement?window:e;function kme(e,{container:t=document.documentElement,...r}={}){let n=AC.get(t);n||(n=new Set,AC.set(t,n));const i=xme(),o=Nme(t,e,i,r);if(n.add(o),!Cv.has(t)){const s=()=>{for(const E of n)E.measure()},p=()=>{for(const E of n)E.update(ls.timestamp)},y=()=>{for(const E of n)E.notify()},b=()=>{gn.read(s,!1,!0),gn.read(p,!1,!0),gn.update(y,!1,!0)};Cv.set(t,b);const _=JB(t);window.addEventListener("resize",b,{passive:!0}),t!==document.documentElement&&YB.set(t,yme(t,b)),_.addEventListener("scroll",b,{passive:!0})}const h=Cv.get(t);return gn.read(h,!1,!0),()=>{var s;fl(h);const p=AC.get(t);if(!p||(p.delete(o),p.size))return;const y=Cv.get(t);Cv.delete(t),y&&(JB(t).removeEventListener("scroll",y),(s=YB.get(t))===null||s===void 0||s(),window.removeEventListener("resize",y))}}function QB(e,t){YW(!!(!t||t.current))}const Mme=()=>({scrollX:sl(0),scrollY:sl(0),scrollXProgress:sl(0),scrollYProgress:sl(0)});function Ime({container:e,target:t,layoutEffect:r=!0,...n}={}){const i=bg(Mme);return(r?xg:I.useEffect)(()=>(QB("target",t),QB("container",e),kme(({x:h,y:s})=>{i.scrollX.set(h.current),i.scrollXProgress.set(h.progress),i.scrollY.set(s.current),i.scrollYProgress.set(s.progress)},{...n,container:(e==null?void 0:e.current)||void 0,target:(t==null?void 0:t.current)||void 0})),[e,t,JSON.stringify(n.offset)]),i}function Ome(e){e.values.forEach(t=>t.stop())}function Rme(){const e=new Set,t={subscribe(r){return e.add(r),()=>void e.delete(r)},start(r,n){const i=[];return e.forEach(o=>{i.push(PG(o,r,{transitionOverride:n}))}),Promise.all(i)},set(r){return e.forEach(n=>{afe(n,r)})},stop(){e.forEach(r=>{Ome(r)})},mount(){return()=>{t.stop()}}};return t}function Dme(){const e=bg(Rme);return xg(e.mount,[]),e}const JG=Dme,Lme={some:0,all:1};function Bme(e,t,{root:r,margin:n,amount:i="some"}={}){const o=YG(e),h=new WeakMap,s=y=>{y.forEach(b=>{const _=h.get(b.target);if(b.isIntersecting!==!!_)if(b.isIntersecting){const E=t(b);typeof E=="function"?h.set(b.target,E):p.unobserve(b.target)}else _&&(_(b),h.delete(b.target))})},p=new IntersectionObserver(s,{root:r,rootMargin:n,threshold:typeof i=="number"?i:Lme[i]});return o.forEach(y=>p.observe(y)),()=>p.disconnect()}function zme(e,{root:t,margin:r,amount:n,once:i=!1}={}){const[o,h]=I.useState(!1);return I.useEffect(()=>{if(!e.current||i&&o)return;const s=()=>(h(!0),i?void 0:()=>h(!1)),p={root:t&&t.current||void 0,margin:r,amount:n};return Bme(e.current,s,p)},[t,e,r,i,n]),o}const $me=()=>{const e=Array.from({length:50},(t,r)=>({id:r,x:Math.random()*100,y:Math.random()*100,delay:Math.random()*2,duration:3+Math.random()*2}));return l.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.map(t=>l.jsx(tt.div,{className:"absolute w-1 h-1 bg-white/20 rounded-full",style:{left:`${t.x}%`,top:`${t.y}%`},animate:{y:[0,-30,0],opacity:[0,1,0],scale:[.5,1,.5]},transition:{duration:t.duration,repeat:1/0,delay:t.delay,ease:"easeInOut"}},t.id))})},Fme=()=>l.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[l.jsx(tt.div,{className:"absolute inset-0 opacity-50",animate:{background:["linear-gradient(45deg, #8B1538, #A0263A, #8B1538)","linear-gradient(135deg, #A0263A, #B8344F, #A0263A)","linear-gradient(225deg, #8B1538, #A0263A, #8B1538)"]},transition:{duration:8,repeat:1/0,ease:"easeInOut"}}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-brand-burgundy/90 via-brand-burgundy-light/80 to-brand-burgundy/90"})]}),Ume=({text:e,delay:t=0})=>{const[r,n]=I.useState(""),[i,o]=I.useState(!0);return I.useEffect(()=>{const h=setTimeout(()=>{let s=0;const p=setInterval(()=>{s<=e.length?(n(e.slice(0,s)),s++):(clearInterval(p),o(!1))},100);return()=>clearInterval(p)},t);return()=>clearTimeout(h)},[e,t]),l.jsxs("span",{children:[r,i&&l.jsx(tt.span,{animate:{opacity:[1,0]},transition:{duration:.5,repeat:1/0,ease:"easeInOut"},className:"inline-block w-0.5 h-8 md:h-12 bg-white/90 ml-1"})]})},Vme=()=>{const[e,t]=I.useState(!1),[r,n]=I.useState(!1),i=ts(),o=JG();I.useEffect(()=>{n(!0),o.start({opacity:1,y:0,transition:{duration:1,ease:"easeOut"}})},[o]);const h=[{id:"restaurant",name:"Restaurants",description:"Discover the finest dining experiences in Lagos",icon:xE,color:"from-brand-burgundy to-brand-burgundy/90",count:"50+ venues",features:["Fine Dining","Private Rooms","Chef's Table"]},{id:"club",name:"Clubs",description:"Experience the vibrant nightlife and premium entertainment",icon:I8,color:"from-brand-burgundy/90 to-brand-burgundy/80",count:"30+ venues",features:["VIP Tables","Premium Sound","Top DJs"]},{id:"lounge",name:"Lounges",description:"Relax in sophisticated lounges across the city",icon:$c,color:"from-brand-burgundy/80 to-brand-burgundy/70",count:"25+ venues",features:["Cocktail Bar","Sky Views","Premium Service"]}],s=()=>{t(!0)},p=()=>{i("/venue-owner/login")},y=E=>{i(`/venues?type=${E}`)},b={hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.3,staggerChildren:.2}}},_={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100,damping:10}}};return l.jsx("div",{className:"min-h-screen bg-brand-cream overflow-hidden",children:l.jsx(KG,{mode:"wait",children:e?l.jsxs(tt.section,{className:"relative bg-brand-cream min-h-screen flex items-center overflow-hidden pt-16 pb-16 md:pt-32 md:pb-32",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[l.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[l.jsx(tt.div,{className:"absolute inset-0 opacity-5",animate:{backgroundImage:["radial-gradient(circle at 20% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 80% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 40% 60%, #8B1538 0%, transparent 50%)","radial-gradient(circle at 80% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 20% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 60% 40%, #8B1538 0%, transparent 50%)","radial-gradient(circle at 20% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 80% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 40% 60%, #8B1538 0%, transparent 50%)"]},transition:{duration:10,repeat:1/0,ease:"easeInOut"}}),Array.from({length:8}).map((E,C)=>l.jsx(tt.div,{className:"absolute w-20 h-20 border-2 border-brand-burgundy/10 rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-30,0],x:[0,15,0],rotate:[0,180,360],scale:[1,1.2,1]},transition:{duration:8+Math.random()*4,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},C))]}),l.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[l.jsxs(tt.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"text-center mb-20",children:[l.jsx(tt.div,{className:"inline-block mb-6",animate:{rotate:[0,2,-2,0],scale:[1,1.02,1]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:l.jsxs("span",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-brand-burgundy/10 to-brand-gold/10 backdrop-blur-sm border border-brand-burgundy/20 rounded-full px-6 py-2 text-brand-burgundy/70 font-medium",children:[l.jsx(T1,{className:"w-4 h-4 text-brand-gold"}),"Premium Venue Categories"]})}),l.jsxs(tt.h2,{className:"text-5xl md:text-6xl lg:text-7xl font-heading text-brand-burgundy mb-6 font-bold",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:1,delay:.3},children:["Browse by"," ",l.jsxs(tt.span,{className:"relative inline-block",whileHover:{scale:1.05},children:[l.jsx("span",{className:"text-brand-gold font-extrabold",children:"Category"}),l.jsx(tt.div,{className:"absolute -bottom-2 left-0 right-0 h-1 bg-gradient-to-r from-brand-gold to-brand-burgundy rounded-full",initial:{scaleX:0},animate:{scaleX:1},transition:{duration:1,delay:.8}})]})]}),l.jsx(tt.p,{className:"text-xl md:text-2xl text-brand-burgundy/70 max-w-3xl mx-auto leading-relaxed",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.5},children:"Choose your perfect venue type and discover the best experiences Lagos has to offer"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 lg:gap-12",children:h.map((E,C)=>l.jsx(tt.div,{initial:{opacity:0,y:60,rotateY:-15},animate:{opacity:1,y:0,rotateY:0},transition:{duration:.8,delay:.6+C*.15,ease:"easeOut"},whileHover:{y:-15,scale:1.03,rotateY:5,transition:{duration:.4,ease:"easeOut",type:"spring",stiffness:200}},className:"group cursor-pointer perspective-1000",onClick:()=>y(E.id),style:{perspective:"1000px"},children:l.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl overflow-hidden border-2 border-brand-burgundy/10 group-hover:border-brand-gold/50 group-hover:shadow-3xl transition-all duration-500 transform-gpu",children:[l.jsxs(tt.div,{className:"relative h-80 bg-gradient-to-br from-brand-burgundy/5 to-brand-burgundy/10 flex items-center justify-center overflow-hidden",whileHover:{scale:1.02},transition:{duration:.4},children:[l.jsx(tt.div,{className:"absolute inset-0 opacity-10",animate:{background:["radial-gradient(circle at 0% 0%, rgba(128, 0, 32, 0.1) 0%, transparent 50%)","radial-gradient(circle at 100% 100%, rgba(128, 0, 32, 0.1) 0%, transparent 50%)","radial-gradient(circle at 0% 0%, rgba(128, 0, 32, 0.1) 0%, transparent 50%)"]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}}),Array.from({length:6}).map((k,N)=>l.jsx(tt.div,{className:"absolute w-1 h-1 bg-brand-burgundy/20 rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-15,0],x:[0,5,0],opacity:[.2,.4,.2],scale:[.5,1,.5]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},N)),l.jsx(tt.div,{className:"relative z-10",whileHover:{scale:1.15,rotate:[0,-5,5,0],y:-5},transition:{duration:.4,rotate:{duration:.6}},children:l.jsx(tt.div,{className:"relative",animate:{filter:["drop-shadow(0 0 20px rgba(128, 0, 32, 0.3))","drop-shadow(0 0 30px rgba(128, 0, 32, 0.5))","drop-shadow(0 0 20px rgba(128, 0, 32, 0.3))"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:l.jsx(E.icon,{className:"w-28 h-28 text-brand-burgundy drop-shadow-2xl"})})}),l.jsx(tt.div,{className:"absolute top-6 right-6 bg-brand-burgundy/10 backdrop-blur-sm rounded-2xl px-4 py-2 border border-brand-burgundy/20",initial:{opacity:0,x:30,scale:.8},animate:{opacity:1,x:0,scale:1},transition:{delay:.8+C*.1,duration:.5},whileHover:{scale:1.05,y:-2},children:l.jsx("span",{className:"text-brand-burgundy text-sm font-bold",children:E.count})}),l.jsx(tt.div,{className:"absolute bottom-6 left-6 w-8 h-8 border-l-2 border-b-2 border-brand-burgundy/30",animate:{scale:[1,1.1,1],opacity:[.3,.6,.3]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})]}),l.jsxs(tt.div,{className:"p-8 relative",whileHover:{backgroundColor:"rgba(139, 21, 56, 0.02)"},transition:{duration:.3},children:[l.jsx(tt.h3,{className:"text-3xl md:text-4xl font-bold text-brand-burgundy mb-4 group-hover:text-brand-gold transition-colors duration-300",whileHover:{x:5},children:E.name}),l.jsx(tt.p,{className:"text-brand-burgundy/70 text-lg mb-8 leading-relaxed",initial:{opacity:.7},whileHover:{opacity:1},children:E.description}),l.jsx("div",{className:"space-y-3 mb-8",children:E.features.map((k,N)=>l.jsxs(tt.div,{className:"flex items-center text-brand-burgundy/60 group-hover:text-brand-burgundy/80",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1+C*.1+N*.1},whileHover:{x:5,scale:1.02},children:[l.jsx(tt.div,{className:"mr-3",animate:{rotate:[0,180,360]},transition:{duration:8,repeat:1/0,ease:"linear",delay:N*.2},children:l.jsx(Gs,{className:"w-4 h-4 text-brand-gold fill-brand-gold"})}),l.jsx("span",{className:"font-medium",children:k})]},N))}),l.jsxs(tt.div,{className:"relative overflow-hidden bg-gradient-to-r from-brand-burgundy/5 to-brand-gold/5 rounded-2xl p-4 group-hover:from-brand-burgundy/10 group-hover:to-brand-gold/10 transition-all duration-300",whileHover:{scale:1.02},children:[l.jsx(tt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/20 to-brand-burgundy/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.8}}),l.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[l.jsxs("div",{children:[l.jsxs(tt.span,{className:"font-bold text-brand-burgundy group-hover:text-brand-gold transition-colors duration-300 text-lg",whileHover:{scale:1.05},children:["Explore ",E.name]}),l.jsx("p",{className:"text-sm text-brand-burgundy/60 mt-1",children:"Discover premium venues"})]}),l.jsx(tt.div,{className:"flex items-center justify-center w-12 h-12 bg-brand-burgundy group-hover:bg-brand-gold rounded-full transition-colors duration-300",whileHover:{scale:1.1,rotate:90,boxShadow:"0 8px 25px rgba(139, 21, 56, 0.3)"},whileTap:{scale:.9},children:l.jsx(Bl,{className:"w-5 h-5 text-white group-hover:text-brand-burgundy transition-colors duration-300"})})]})]}),l.jsx(tt.div,{className:"absolute top-4 right-4 w-16 h-16 bg-gradient-to-br from-brand-gold/10 to-brand-burgundy/10 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500",animate:{scale:[1,1.2,1],rotate:[0,180,360]},transition:{duration:8,repeat:1/0,ease:"linear"}})]}),l.jsx(tt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/0 via-brand-gold/5 to-brand-burgundy/0 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-500",initial:{scale:.8,opacity:0},whileHover:{scale:1,opacity:1}})]})},E.id))}),l.jsxs(tt.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:1.2},className:"text-center mt-20",children:[l.jsx(tt.p,{className:"text-brand-burgundy/60 mb-6 text-lg",animate:{opacity:[.6,1,.6]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:"Can't find what you're looking for?"}),l.jsx(tt.button,{whileHover:{scale:1.05,y:-3,boxShadow:"0 15px 35px rgba(139, 21, 56, 0.2)"},whileTap:{scale:.95},onClick:()=>i("/venues"),className:"bg-gradient-to-r from-brand-burgundy to-brand-burgundy-light hover:from-brand-gold hover:to-yellow-500 text-white px-8 py-4 rounded-2xl font-semibold text-lg shadow-xl transition-all duration-300",children:"Browse All Venues"})]})]})]},"categories"):l.jsxs(tt.section,{className:"relative bg-brand-burgundy flex items-center justify-center overflow-hidden min-h-screen pt-16 pb-16 md:pt-32 md:pb-32",initial:{opacity:1},exit:{opacity:0,scale:.95,transition:{duration:.6,ease:"easeInOut"}},children:[l.jsx(Fme,{}),l.jsx($me,{}),l.jsx("div",{className:"container mx-auto px-4 flex flex-col items-center justify-center h-full relative z-10",children:l.jsxs(tt.div,{className:"max-w-5xl w-full text-white text-center",variants:b,initial:"hidden",animate:"visible",children:[l.jsx(tt.div,{variants:_,className:"mb-8 pt-8 pb-4 md:pt-0 md:pb-0",children:l.jsxs(tt.div,{className:"inline-flex items-center gap-3 mb-6",whileHover:{scale:1.05},transition:{type:"spring",stiffness:400,damping:10},children:[l.jsx(tt.div,{className:"p-3 bg-brand-gold rounded-2xl",animate:{rotate:[0,5,-5,0],scale:[1,1.1,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:l.jsx(T1,{className:"w-8 h-8 text-brand-burgundy"})}),l.jsx("span",{className:"text-2xl font-bold tracking-wider text-brand-gold",children:"Eddys members"})]})}),l.jsxs(tt.h1,{variants:_,className:"text-5xl md:text-7xl lg:text-8xl font-heading mb-8 font-bold tracking-tight leading-tight",children:[l.jsx(tt.span,{className:"block mb-4 text-white/90",initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.8,delay:.5},children:"Discover"}),l.jsx(tt.span,{className:"block text-6xl md:text-8xl lg:text-9xl mb-4",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:1,delay:.8},children:l.jsx("span",{className:"text-brand-gold font-extrabold drop-shadow-2xl",children:l.jsx(Ume,{text:"Eddys'",delay:1200})})}),l.jsx(tt.span,{className:"block text-4xl md:text-6xl lg:text-7xl text-white/95",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:1.5},children:"Finest Venues"})]}),l.jsx(tt.p,{variants:_,className:"text-xl md:text-2xl lg:text-3xl mb-12 text-white/80 font-medium max-w-3xl mx-auto leading-relaxed",children:"Book tables, enjoy exclusive experiences, and make unforgettable memories in Lagos' most prestigious venues"}),l.jsxs(tt.div,{variants:_,className:"flex flex-col md:flex-row gap-6 lg:gap-8 justify-center items-center mb-12",children:[l.jsxs(tt.button,{whileHover:{scale:1.05,boxShadow:"0 20px 40px rgba(0,0,0,0.3)",y:-2},whileTap:{scale:.98},onClick:s,className:"group relative overflow-hidden flex items-center gap-4 bg-brand-cream text-brand-burgundy text-xl lg:text-2xl px-10 py-5 rounded-2xl font-semibold shadow-2xl hover:shadow-3xl transition-all duration-300 min-w-[250px] justify-center",children:[l.jsx(tt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/20 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6}}),l.jsx(Kn,{className:"w-6 h-6 group-hover:scale-110 transition-transform duration-200"}),l.jsx("span",{children:"I'm a Customer"}),l.jsx(Bl,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-200"})]}),l.jsxs(tt.button,{whileHover:{scale:1.05,y:-2,boxShadow:"0 20px 40px rgba(255,255,255,0.1)"},whileTap:{scale:.98},onClick:p,className:"group relative overflow-hidden flex items-center gap-4 bg-transparent border-2 border-brand-cream text-brand-cream text-xl lg:text-2xl px-10 py-5 rounded-2xl font-semibold shadow-2xl hover:bg-brand-cream/10 backdrop-blur-sm transition-all duration-300 min-w-[250px] justify-center",children:[l.jsx(tt.div,{className:"absolute inset-0 bg-brand-cream/10",initial:{scale:0,opacity:0},whileHover:{scale:1,opacity:1},transition:{duration:.3}}),l.jsx(yd,{className:"w-6 h-6 group-hover:scale-110 transition-transform duration-200"}),l.jsx("span",{children:"I'm a Venue Owner"}),l.jsx(Bl,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-200"})]})]}),l.jsxs(tt.div,{variants:_,className:"flex flex-wrap justify-center items-center gap-6 md:gap-8 text-white/60 text-sm pt-4 pb-8 md:pt-0 md:pb-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Gs,{className:"w-4 h-4 text-brand-gold fill-brand-gold"}),l.jsx("span",{children:"4.9/5 Customer Rating"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx($c,{className:"w-4 h-4 text-brand-gold"}),l.jsx("span",{children:"100+ Premium Venues"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Is,{className:"w-4 h-4 text-brand-gold"}),l.jsx("span",{children:"50K+ Happy Customers"})]})]})]})})]},"hero")})})},Lt=je.forwardRef(({className:e,type:t,...r},n)=>l.jsx("input",{type:t,className:Pr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...r}));Lt.displayName="Input";var qme="Label",QG=I.forwardRef((e,t)=>l.jsx(fr.label,{...e,ref:t,onMouseDown:r=>{var i;r.target.closest("button, input, select, textarea")||((i=e.onMouseDown)==null||i.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));QG.displayName=qme;var e7=QG;const Wme=mE("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Tt=je.forwardRef(({className:e,...t},r)=>l.jsx(e7,{ref:r,className:Pr(Wme(),e),...t}));Tt.displayName=e7.displayName;function ez(e,[t,r]){return Math.min(r,Math.max(t,e))}function PI(e){const t=I.useRef({value:e,previous:e});return I.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Gme=[" ","Enter","ArrowUp","ArrowDown"],Hme=[" ","Enter"],lf="Select",[GE,HE,Xme]=hE(lf),[_g,JUe]=xo(lf,[Xme,EE]),XE=EE(),[Kme,Nd]=_g(lf),[Zme,Yme]=_g(lf),t7=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:i,onOpenChange:o,value:h,defaultValue:s,onValueChange:p,dir:y,name:b,autoComplete:_,disabled:E,required:C,form:k}=e,N=XE(t),[O,R]=I.useState(null),[L,B]=I.useState(null),[q,F]=I.useState(!1),H=F0(y),[Z,re]=zc({prop:n,defaultProp:i??!1,onChange:o,caller:lf}),[W,te]=zc({prop:h,defaultProp:s,onChange:p,caller:lf}),oe=I.useRef(null),ie=O?k||!!O.closest("form"):!0,[ue,_e]=I.useState(new Set),xe=Array.from(ue).map(be=>be.props.value).join(";");return l.jsx(lq,{...N,children:l.jsxs(Kme,{required:C,scope:t,trigger:O,onTriggerChange:R,valueNode:L,onValueNodeChange:B,valueNodeHasChildren:q,onValueNodeHasChildrenChange:F,contentId:zl(),value:W,onValueChange:te,open:Z,onOpenChange:re,dir:H,triggerPointerDownPosRef:oe,disabled:E,children:[l.jsx(GE.Provider,{scope:t,children:l.jsx(Zme,{scope:e.__scopeSelect,onNativeOptionAdd:I.useCallback(be=>{_e(Ae=>new Set(Ae).add(be))},[]),onNativeOptionRemove:I.useCallback(be=>{_e(Ae=>{const me=new Set(Ae);return me.delete(be),me})},[]),children:r})}),ie?l.jsxs(S7,{"aria-hidden":!0,required:C,tabIndex:-1,name:b,autoComplete:_,value:W,onChange:be=>te(be.target.value),disabled:E,form:k,children:[W===void 0?l.jsx("option",{value:""}):null,Array.from(ue)]},xe):null]})})};t7.displayName=lf;var r7="SelectTrigger",n7=I.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...i}=e,o=XE(r),h=Nd(r7,r),s=h.disabled||n,p=Qr(t,h.onTriggerChange),y=HE(r),b=I.useRef("touch"),[_,E,C]=T7(N=>{const O=y().filter(B=>!B.disabled),R=O.find(B=>B.value===h.value),L=j7(O,N,R);L!==void 0&&h.onValueChange(L.value)}),k=N=>{s||(h.onOpenChange(!0),C()),N&&(h.triggerPointerDownPosRef.current={x:Math.round(N.pageX),y:Math.round(N.pageY)})};return l.jsx(cq,{asChild:!0,...o,children:l.jsx(fr.button,{type:"button",role:"combobox","aria-controls":h.contentId,"aria-expanded":h.open,"aria-required":h.required,"aria-autocomplete":"none",dir:h.dir,"data-state":h.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":E7(h.value)?"":void 0,...i,ref:p,onClick:Zt(i.onClick,N=>{N.currentTarget.focus(),b.current!=="mouse"&&k(N)}),onPointerDown:Zt(i.onPointerDown,N=>{b.current=N.pointerType;const O=N.target;O.hasPointerCapture(N.pointerId)&&O.releasePointerCapture(N.pointerId),N.button===0&&N.ctrlKey===!1&&N.pointerType==="mouse"&&(k(N),N.preventDefault())}),onKeyDown:Zt(i.onKeyDown,N=>{const O=_.current!=="";!(N.ctrlKey||N.altKey||N.metaKey)&&N.key.length===1&&E(N.key),!(O&&N.key===" ")&&Gme.includes(N.key)&&(k(),N.preventDefault())})})})});n7.displayName=r7;var i7="SelectValue",s7=I.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,children:o,placeholder:h="",...s}=e,p=Nd(i7,r),{onValueNodeHasChildrenChange:y}=p,b=o!==void 0,_=Qr(t,p.onValueNodeChange);return ps(()=>{y(b)},[y,b]),l.jsx(fr.span,{...s,ref:_,style:{pointerEvents:"none"},children:E7(p.value)?l.jsx(l.Fragment,{children:h}):o})});s7.displayName=i7;var Jme="SelectIcon",a7=I.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...i}=e;return l.jsx(fr.span,{"aria-hidden":!0,...i,ref:t,children:n||""})});a7.displayName=Jme;var Qme="SelectPortal",o7=e=>l.jsx(fE,{asChild:!0,...e});o7.displayName=Qme;var cf="SelectContent",l7=I.forwardRef((e,t)=>{const r=Nd(cf,e.__scopeSelect),[n,i]=I.useState();if(ps(()=>{i(new DocumentFragment)},[]),!r.open){const o=n;return o?Yc.createPortal(l.jsx(c7,{scope:e.__scopeSelect,children:l.jsx(GE.Slot,{scope:e.__scopeSelect,children:l.jsx("div",{children:e.children})})}),o):null}return l.jsx(u7,{...e,ref:t})});l7.displayName=cf;var Ho=10,[c7,kd]=_g(cf),ege="SelectContentImpl",tge=af("SelectContent.RemoveScroll"),u7=I.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:o,onPointerDownOutside:h,side:s,sideOffset:p,align:y,alignOffset:b,arrowPadding:_,collisionBoundary:E,collisionPadding:C,sticky:k,hideWhenDetached:N,avoidCollisions:O,...R}=e,L=Nd(cf,r),[B,q]=I.useState(null),[F,H]=I.useState(null),Z=Qr(t,at=>q(at)),[re,W]=I.useState(null),[te,oe]=I.useState(null),ie=HE(r),[ue,_e]=I.useState(!1),xe=I.useRef(!1);I.useEffect(()=>{if(B)return GM(B)},[B]),IM();const be=I.useCallback(at=>{const[Ut,...ct]=ie().map(rt=>rt.ref.current),[gt]=ct.slice(-1),it=document.activeElement;for(const rt of at)if(rt===it||(rt==null||rt.scrollIntoView({block:"nearest"}),rt===Ut&&F&&(F.scrollTop=0),rt===gt&&F&&(F.scrollTop=F.scrollHeight),rt==null||rt.focus(),document.activeElement!==it))return},[ie,F]),Ae=I.useCallback(()=>be([re,B]),[be,re,B]);I.useEffect(()=>{ue&&Ae()},[ue,Ae]);const{onOpenChange:me,triggerPointerDownPosRef:ke}=L;I.useEffect(()=>{if(B){let at={x:0,y:0};const Ut=gt=>{var it,rt;at={x:Math.abs(Math.round(gt.pageX)-(((it=ke.current)==null?void 0:it.x)??0)),y:Math.abs(Math.round(gt.pageY)-(((rt=ke.current)==null?void 0:rt.y)??0))}},ct=gt=>{at.x<=10&&at.y<=10?gt.preventDefault():B.contains(gt.target)||me(!1),document.removeEventListener("pointermove",Ut),ke.current=null};return ke.current!==null&&(document.addEventListener("pointermove",Ut),document.addEventListener("pointerup",ct,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Ut),document.removeEventListener("pointerup",ct,{capture:!0})}}},[B,me,ke]),I.useEffect(()=>{const at=()=>me(!1);return window.addEventListener("blur",at),window.addEventListener("resize",at),()=>{window.removeEventListener("blur",at),window.removeEventListener("resize",at)}},[me]);const[Ne,Be]=T7(at=>{const Ut=ie().filter(it=>!it.disabled),ct=Ut.find(it=>it.ref.current===document.activeElement),gt=j7(Ut,at,ct);gt&&setTimeout(()=>gt.ref.current.focus())}),We=I.useCallback((at,Ut,ct)=>{const gt=!xe.current&&!ct;(L.value!==void 0&&L.value===Ut||gt)&&(W(at),gt&&(xe.current=!0))},[L.value]),ut=I.useCallback(()=>B==null?void 0:B.focus(),[B]),nt=I.useCallback((at,Ut,ct)=>{const gt=!xe.current&&!ct;(L.value!==void 0&&L.value===Ut||gt)&&oe(at)},[L.value]),Pt=n==="popper"?GA:d7,It=Pt===GA?{side:s,sideOffset:p,align:y,alignOffset:b,arrowPadding:_,collisionBoundary:E,collisionPadding:C,sticky:k,hideWhenDetached:N,avoidCollisions:O}:{};return l.jsx(c7,{scope:r,content:B,viewport:F,onViewportChange:H,itemRefCallback:We,selectedItem:re,onItemLeave:ut,itemTextRefCallback:nt,focusSelectedItem:Ae,selectedItemText:te,position:n,isPositioned:ue,searchRef:Ne,children:l.jsx(HM,{as:tge,allowPinchZoom:!0,children:l.jsx(bE,{asChild:!0,trapped:L.open,onMountAutoFocus:at=>{at.preventDefault()},onUnmountAutoFocus:Zt(i,at=>{var Ut;(Ut=L.trigger)==null||Ut.focus({preventScroll:!0}),at.preventDefault()}),children:l.jsx(B0,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:h,onFocusOutside:at=>at.preventDefault(),onDismiss:()=>L.onOpenChange(!1),children:l.jsx(Pt,{role:"listbox",id:L.contentId,"data-state":L.open?"open":"closed",dir:L.dir,onContextMenu:at=>at.preventDefault(),...R,...It,onPlaced:()=>_e(!0),ref:Z,style:{display:"flex",flexDirection:"column",outline:"none",...R.style},onKeyDown:Zt(R.onKeyDown,at=>{const Ut=at.ctrlKey||at.altKey||at.metaKey;if(at.key==="Tab"&&at.preventDefault(),!Ut&&at.key.length===1&&Be(at.key),["ArrowUp","ArrowDown","Home","End"].includes(at.key)){let gt=ie().filter(it=>!it.disabled).map(it=>it.ref.current);if(["ArrowUp","End"].includes(at.key)&&(gt=gt.slice().reverse()),["ArrowUp","ArrowDown"].includes(at.key)){const it=at.target,rt=gt.indexOf(it);gt=gt.slice(rt+1)}setTimeout(()=>be(gt)),at.preventDefault()}})})})})})})});u7.displayName=ege;var rge="SelectItemAlignedPosition",d7=I.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...i}=e,o=Nd(cf,r),h=kd(cf,r),[s,p]=I.useState(null),[y,b]=I.useState(null),_=Qr(t,Z=>b(Z)),E=HE(r),C=I.useRef(!1),k=I.useRef(!0),{viewport:N,selectedItem:O,selectedItemText:R,focusSelectedItem:L}=h,B=I.useCallback(()=>{if(o.trigger&&o.valueNode&&s&&y&&N&&O&&R){const Z=o.trigger.getBoundingClientRect(),re=y.getBoundingClientRect(),W=o.valueNode.getBoundingClientRect(),te=R.getBoundingClientRect();if(o.dir!=="rtl"){const it=te.left-re.left,rt=W.left-it,rr=Z.left-rt,ir=Z.width+rr,or=Math.max(ir,re.width),Sr=window.innerWidth-Ho,tn=ez(rt,[Ho,Math.max(Ho,Sr-or)]);s.style.minWidth=ir+"px",s.style.left=tn+"px"}else{const it=re.right-te.right,rt=window.innerWidth-W.right-it,rr=window.innerWidth-Z.right-rt,ir=Z.width+rr,or=Math.max(ir,re.width),Sr=window.innerWidth-Ho,tn=ez(rt,[Ho,Math.max(Ho,Sr-or)]);s.style.minWidth=ir+"px",s.style.right=tn+"px"}const oe=E(),ie=window.innerHeight-Ho*2,ue=N.scrollHeight,_e=window.getComputedStyle(y),xe=parseInt(_e.borderTopWidth,10),be=parseInt(_e.paddingTop,10),Ae=parseInt(_e.borderBottomWidth,10),me=parseInt(_e.paddingBottom,10),ke=xe+be+ue+me+Ae,Ne=Math.min(O.offsetHeight*5,ke),Be=window.getComputedStyle(N),We=parseInt(Be.paddingTop,10),ut=parseInt(Be.paddingBottom,10),nt=Z.top+Z.height/2-Ho,Pt=ie-nt,It=O.offsetHeight/2,at=O.offsetTop+It,Ut=xe+be+at,ct=ke-Ut;if(Ut<=nt){const it=oe.length>0&&O===oe[oe.length-1].ref.current;s.style.bottom="0px";const rt=y.clientHeight-N.offsetTop-N.offsetHeight,rr=Math.max(Pt,It+(it?ut:0)+rt+Ae),ir=Ut+rr;s.style.height=ir+"px"}else{const it=oe.length>0&&O===oe[0].ref.current;s.style.top="0px";const rr=Math.max(nt,xe+N.offsetTop+(it?We:0)+It)+ct;s.style.height=rr+"px",N.scrollTop=Ut-nt+N.offsetTop}s.style.margin=`${Ho}px 0`,s.style.minHeight=Ne+"px",s.style.maxHeight=ie+"px",n==null||n(),requestAnimationFrame(()=>C.current=!0)}},[E,o.trigger,o.valueNode,s,y,N,O,R,o.dir,n]);ps(()=>B(),[B]);const[q,F]=I.useState();ps(()=>{y&&F(window.getComputedStyle(y).zIndex)},[y]);const H=I.useCallback(Z=>{Z&&k.current===!0&&(B(),L==null||L(),k.current=!1)},[B,L]);return l.jsx(ige,{scope:r,contentWrapper:s,shouldExpandOnScrollRef:C,onScrollButtonChange:H,children:l.jsx("div",{ref:p,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:q},children:l.jsx(fr.div,{...i,ref:_,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});d7.displayName=rge;var nge="SelectPopperPosition",GA=I.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:i=Ho,...o}=e,h=XE(r);return l.jsx(uq,{...h,...o,ref:t,align:n,collisionPadding:i,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});GA.displayName=nge;var[ige,AI]=_g(cf,{}),HA="SelectViewport",h7=I.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...i}=e,o=kd(HA,r),h=AI(HA,r),s=Qr(t,o.onViewportChange),p=I.useRef(0);return l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),l.jsx(GE.Slot,{scope:r,children:l.jsx(fr.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Zt(i.onScroll,y=>{const b=y.currentTarget,{contentWrapper:_,shouldExpandOnScrollRef:E}=h;if(E!=null&&E.current&&_){const C=Math.abs(p.current-b.scrollTop);if(C>0){const k=window.innerHeight-Ho*2,N=parseFloat(_.style.minHeight),O=parseFloat(_.style.height),R=Math.max(N,O);if(R<k){const L=R+C,B=Math.min(k,L),q=L-B;_.style.height=B+"px",_.style.bottom==="0px"&&(b.scrollTop=q>0?q:0,_.style.justifyContent="flex-end")}}}p.current=b.scrollTop})})})]})});h7.displayName=HA;var f7="SelectGroup",[sge,age]=_g(f7),oge=I.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=zl();return l.jsx(sge,{scope:r,id:i,children:l.jsx(fr.div,{role:"group","aria-labelledby":i,...n,ref:t})})});oge.displayName=f7;var p7="SelectLabel",m7=I.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=age(p7,r);return l.jsx(fr.div,{id:i.id,...n,ref:t})});m7.displayName=p7;var V1="SelectItem",[lge,g7]=_g(V1),y7=I.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:i=!1,textValue:o,...h}=e,s=Nd(V1,r),p=kd(V1,r),y=s.value===n,[b,_]=I.useState(o??""),[E,C]=I.useState(!1),k=Qr(t,L=>{var B;return(B=p.itemRefCallback)==null?void 0:B.call(p,L,n,i)}),N=zl(),O=I.useRef("touch"),R=()=>{i||(s.onValueChange(n),s.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return l.jsx(lge,{scope:r,value:n,disabled:i,textId:N,isSelected:y,onItemTextChange:I.useCallback(L=>{_(B=>B||((L==null?void 0:L.textContent)??"").trim())},[]),children:l.jsx(GE.ItemSlot,{scope:r,value:n,disabled:i,textValue:b,children:l.jsx(fr.div,{role:"option","aria-labelledby":N,"data-highlighted":E?"":void 0,"aria-selected":y&&E,"data-state":y?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...h,ref:k,onFocus:Zt(h.onFocus,()=>C(!0)),onBlur:Zt(h.onBlur,()=>C(!1)),onClick:Zt(h.onClick,()=>{O.current!=="mouse"&&R()}),onPointerUp:Zt(h.onPointerUp,()=>{O.current==="mouse"&&R()}),onPointerDown:Zt(h.onPointerDown,L=>{O.current=L.pointerType}),onPointerMove:Zt(h.onPointerMove,L=>{var B;O.current=L.pointerType,i?(B=p.onItemLeave)==null||B.call(p):O.current==="mouse"&&L.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Zt(h.onPointerLeave,L=>{var B;L.currentTarget===document.activeElement&&((B=p.onItemLeave)==null||B.call(p))}),onKeyDown:Zt(h.onKeyDown,L=>{var q;((q=p.searchRef)==null?void 0:q.current)!==""&&L.key===" "||(Hme.includes(L.key)&&R(),L.key===" "&&L.preventDefault())})})})})});y7.displayName=V1;var Kv="SelectItemText",v7=I.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,...o}=e,h=Nd(Kv,r),s=kd(Kv,r),p=g7(Kv,r),y=Yme(Kv,r),[b,_]=I.useState(null),E=Qr(t,R=>_(R),p.onItemTextChange,R=>{var L;return(L=s.itemTextRefCallback)==null?void 0:L.call(s,R,p.value,p.disabled)}),C=b==null?void 0:b.textContent,k=I.useMemo(()=>l.jsx("option",{value:p.value,disabled:p.disabled,children:C},p.value),[p.disabled,p.value,C]),{onNativeOptionAdd:N,onNativeOptionRemove:O}=y;return ps(()=>(N(k),()=>O(k)),[N,O,k]),l.jsxs(l.Fragment,{children:[l.jsx(fr.span,{id:p.textId,...o,ref:E}),p.isSelected&&h.valueNode&&!h.valueNodeHasChildren?Yc.createPortal(o.children,h.valueNode):null]})});v7.displayName=Kv;var x7="SelectItemIndicator",b7=I.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return g7(x7,r).isSelected?l.jsx(fr.span,{"aria-hidden":!0,...n,ref:t}):null});b7.displayName=x7;var XA="SelectScrollUpButton",cge=I.forwardRef((e,t)=>{const r=kd(XA,e.__scopeSelect),n=AI(XA,e.__scopeSelect),[i,o]=I.useState(!1),h=Qr(t,n.onScrollButtonChange);return ps(()=>{if(r.viewport&&r.isPositioned){let s=function(){const y=p.scrollTop>0;o(y)};const p=r.viewport;return s(),p.addEventListener("scroll",s),()=>p.removeEventListener("scroll",s)}},[r.viewport,r.isPositioned]),i?l.jsx(_7,{...e,ref:h,onAutoScroll:()=>{const{viewport:s,selectedItem:p}=r;s&&p&&(s.scrollTop=s.scrollTop-p.offsetHeight)}}):null});cge.displayName=XA;var KA="SelectScrollDownButton",uge=I.forwardRef((e,t)=>{const r=kd(KA,e.__scopeSelect),n=AI(KA,e.__scopeSelect),[i,o]=I.useState(!1),h=Qr(t,n.onScrollButtonChange);return ps(()=>{if(r.viewport&&r.isPositioned){let s=function(){const y=p.scrollHeight-p.clientHeight,b=Math.ceil(p.scrollTop)<y;o(b)};const p=r.viewport;return s(),p.addEventListener("scroll",s),()=>p.removeEventListener("scroll",s)}},[r.viewport,r.isPositioned]),i?l.jsx(_7,{...e,ref:h,onAutoScroll:()=>{const{viewport:s,selectedItem:p}=r;s&&p&&(s.scrollTop=s.scrollTop+p.offsetHeight)}}):null});uge.displayName=KA;var _7=I.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...i}=e,o=kd("SelectScrollButton",r),h=I.useRef(null),s=HE(r),p=I.useCallback(()=>{h.current!==null&&(window.clearInterval(h.current),h.current=null)},[]);return I.useEffect(()=>()=>p(),[p]),ps(()=>{var b;const y=s().find(_=>_.ref.current===document.activeElement);(b=y==null?void 0:y.ref.current)==null||b.scrollIntoView({block:"nearest"})},[s]),l.jsx(fr.div,{"aria-hidden":!0,...i,ref:t,style:{flexShrink:0,...i.style},onPointerDown:Zt(i.onPointerDown,()=>{h.current===null&&(h.current=window.setInterval(n,50))}),onPointerMove:Zt(i.onPointerMove,()=>{var y;(y=o.onItemLeave)==null||y.call(o),h.current===null&&(h.current=window.setInterval(n,50))}),onPointerLeave:Zt(i.onPointerLeave,()=>{p()})})}),dge="SelectSeparator",w7=I.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return l.jsx(fr.div,{"aria-hidden":!0,...n,ref:t})});w7.displayName=dge;var ZA="SelectArrow",hge=I.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=XE(r),o=Nd(ZA,r),h=kd(ZA,r);return o.open&&h.position==="popper"?l.jsx(dq,{...i,...n,ref:t}):null});hge.displayName=ZA;var fge="SelectBubbleInput",S7=I.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const i=I.useRef(null),o=Qr(n,i),h=PI(t);return I.useEffect(()=>{const s=i.current;if(!s)return;const p=window.HTMLSelectElement.prototype,b=Object.getOwnPropertyDescriptor(p,"value").set;if(h!==t&&b){const _=new Event("change",{bubbles:!0});b.call(s,t),s.dispatchEvent(_)}},[h,t]),l.jsx(fr.select,{...r,style:{...a8,...r.style},ref:o,defaultValue:t})});S7.displayName=fge;function E7(e){return e===""||e===void 0}function T7(e){const t=pa(e),r=I.useRef(""),n=I.useRef(0),i=I.useCallback(h=>{const s=r.current+h;t(s),function p(y){r.current=y,window.clearTimeout(n.current),y!==""&&(n.current=window.setTimeout(()=>p(""),1e3))}(s)},[t]),o=I.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return I.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,i,o]}function j7(e,t,r){const i=t.length>1&&Array.from(t).every(y=>y===t[0])?t[0]:t,o=r?e.indexOf(r):-1;let h=pge(e,Math.max(o,0));i.length===1&&(h=h.filter(y=>y!==r));const p=h.find(y=>y.textValue.toLowerCase().startsWith(i.toLowerCase()));return p!==r?p:void 0}function pge(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var mge=t7,C7=n7,gge=s7,yge=a7,vge=o7,P7=l7,xge=h7,A7=m7,N7=y7,bge=v7,_ge=b7,k7=w7;const rl=mge,nl=gge,oo=je.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(C7,{ref:n,className:Pr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:[t,l.jsx(yge,{asChild:!0,children:l.jsx(C8,{className:"h-4 w-4 opacity-50"})})]}));oo.displayName=C7.displayName;const lo=je.forwardRef(({className:e,children:t,position:r="popper",...n},i)=>l.jsx(vge,{children:l.jsx(P7,{ref:i,className:Pr("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:l.jsx(xge,{className:Pr("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));lo.displayName=P7.displayName;const wge=je.forwardRef(({className:e,...t},r)=>l.jsx(A7,{ref:r,className:Pr("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));wge.displayName=A7.displayName;const Dn=je.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(N7,{ref:n,className:Pr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(_ge,{children:l.jsx(tm,{className:"h-4 w-4"})})}),l.jsx(bge,{children:t})]}));Dn.displayName=N7.displayName;const Sge=je.forwardRef(({className:e,...t},r)=>l.jsx(k7,{ref:r,className:Pr("-mx-1 my-1 h-px bg-muted",e),...t}));Sge.displayName=k7.displayName;const Ege=mE("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Yr({className:e,variant:t,...r}){return l.jsx("div",{className:Pr(Ege({variant:t}),e),...r})}const Mt=je.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Pr("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Mt.displayName="Card";const Dr=je.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Pr("flex flex-col space-y-1.5 p-6",e),...t}));Dr.displayName="CardHeader";const Lr=je.forwardRef(({className:e,...t},r)=>l.jsx("h3",{ref:r,className:Pr("text-2xl font-semibold leading-none tracking-tight",e),...t}));Lr.displayName="CardTitle";const Tge=je.forwardRef(({className:e,...t},r)=>l.jsx("p",{ref:r,className:Pr("text-sm text-muted-foreground",e),...t}));Tge.displayName="CardDescription";const Ht=je.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Pr("p-6 pt-0",e),...t}));Ht.displayName="CardContent";const NI=je.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Pr("flex items-center p-6 pt-0",e),...t}));NI.displayName="CardFooter";var M7={exports:{}},jge="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Cge=jge,Pge=Cge;function I7(){}function O7(){}O7.resetWarningCache=I7;var Age=function(){function e(n,i,o,h,s,p){if(p!==Pge){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:O7,resetWarningCache:I7};return r.PropTypes=r,r};M7.exports=Age();var Nge=M7.exports;const cr=Sn(Nge);function tz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rz(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tz(Object(r),!0).forEach(function(n){R7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yw(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Yw=function(t){return typeof t}:Yw=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yw(e)}function R7(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D7(e,t){return kge(e)||Mge(e,t)||Ige(e,t)||Oge()}function kge(e){if(Array.isArray(e))return e}function Mge(e,t){var r=e&&(typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"]);if(r!=null){var n=[],i=!0,o=!1,h,s;try{for(r=r.call(e);!(i=(h=r.next()).done)&&(n.push(h.value),!(t&&n.length===t));i=!0);}catch(p){o=!0,s=p}finally{try{!i&&r.return!=null&&r.return()}finally{if(o)throw s}}return n}}function Ige(e,t){if(e){if(typeof e=="string")return nz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nz(e,t)}}function nz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ja=function(t,r,n){var i=!!n,o=je.useRef(n);je.useEffect(function(){o.current=n},[n]),je.useEffect(function(){if(!i||!t)return function(){};var h=function(){o.current&&o.current.apply(o,arguments)};return t.on(r,h),function(){t.off(r,h)}},[i,r,t,o])},YA=function(t){var r=je.useRef(t);return je.useEffect(function(){r.current=t},[t]),r.current},Rm=function(t){return t!==null&&Yw(t)==="object"},Rge=function(t){return Rm(t)&&typeof t.then=="function"},Dge=function(t){return Rm(t)&&typeof t.elements=="function"&&typeof t.createToken=="function"&&typeof t.createPaymentMethod=="function"&&typeof t.confirmCardPayment=="function"},iz="[object Object]",Lge=function e(t,r){if(!Rm(t)||!Rm(r))return t===r;var n=Array.isArray(t),i=Array.isArray(r);if(n!==i)return!1;var o=Object.prototype.toString.call(t)===iz,h=Object.prototype.toString.call(r)===iz;if(o!==h)return!1;if(!o&&!n)return t===r;var s=Object.keys(t),p=Object.keys(r);if(s.length!==p.length)return!1;for(var y={},b=0;b<s.length;b+=1)y[s[b]]=!0;for(var _=0;_<p.length;_+=1)y[p[_]]=!0;var E=Object.keys(y);if(E.length!==s.length)return!1;var C=t,k=r,N=function(R){return e(C[R],k[R])};return E.every(N)},L7=function(t,r,n){return Rm(t)?Object.keys(t).reduce(function(i,o){var h=!Rm(r)||!Lge(t[o],r[o]);return n.includes(o)?(h&&console.warn("Unsupported prop change: options.".concat(o," is not a mutable property.")),i):h?rz(rz({},i||{}),{},R7({},o,t[o])):i},null):null},B7="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",sz=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:B7;if(t===null||Dge(t))return t;throw new Error(r)},Bge=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:B7;if(Rge(t))return{tag:"async",stripePromise:Promise.resolve(t).then(function(i){return sz(i,r)})};var n=sz(t,r);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},zge=function(t){!t||!t._registerWrapper||!t.registerAppInfo||(t._registerWrapper({name:"react-stripe-js",version:"2.8.1"}),t.registerAppInfo({name:"react-stripe-js",version:"2.8.1",url:"https://stripe.com/docs/stripe-js/react"}))},KE=je.createContext(null);KE.displayName="ElementsContext";var z7=function(t,r){if(!t)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(r," in an <Elements> provider."));return t},$7=function(t){var r=t.stripe,n=t.options,i=t.children,o=je.useMemo(function(){return Bge(r)},[r]),h=je.useState(function(){return{stripe:o.tag==="sync"?o.stripe:null,elements:o.tag==="sync"?o.stripe.elements(n):null}}),s=D7(h,2),p=s[0],y=s[1];je.useEffect(function(){var E=!0,C=function(N){y(function(O){return O.stripe?O:{stripe:N,elements:N.elements(n)}})};return o.tag==="async"&&!p.stripe?o.stripePromise.then(function(k){k&&E&&C(k)}):o.tag==="sync"&&!p.stripe&&C(o.stripe),function(){E=!1}},[o,p,n]);var b=YA(r);je.useEffect(function(){b!==null&&b!==r&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[b,r]);var _=YA(n);return je.useEffect(function(){if(p.elements){var E=L7(n,_,["clientSecret","fonts"]);E&&p.elements.update(E)}},[n,_,p.elements]),je.useEffect(function(){zge(p.stripe)},[p.stripe]),je.createElement(KE.Provider,{value:p},i)};$7.propTypes={stripe:cr.any,options:cr.object};var $ge=function(t){var r=je.useContext(KE);return z7(r,t)},Fge=function(){var t=$ge("calls useElements()"),r=t.elements;return r};cr.func.isRequired;var F7=je.createContext(null);F7.displayName="CustomCheckoutSdkContext";var Uge=function(t,r){if(!t)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(r," in an <CustomCheckoutProvider> provider."));return t},Vge=je.createContext(null);Vge.displayName="CustomCheckoutContext";cr.any,cr.shape({clientSecret:cr.string.isRequired,elementsOptions:cr.object}).isRequired;var JA=function(t){var r=je.useContext(F7),n=je.useContext(KE);if(r&&n)throw new Error("You cannot wrap the part of your app that ".concat(t," in both <CustomCheckoutProvider> and <Elements> providers."));return r?Uge(r,t):z7(n,t)},qge=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},ki=function(t,r){var n="".concat(qge(t),"Element"),i=function(p){var y=p.id,b=p.className,_=p.options,E=_===void 0?{}:_,C=p.onBlur,k=p.onFocus,N=p.onReady,O=p.onChange,R=p.onEscape,L=p.onClick,B=p.onLoadError,q=p.onLoaderStart,F=p.onNetworksChange,H=p.onConfirm,Z=p.onCancel,re=p.onShippingAddressChange,W=p.onShippingRateChange,te=JA("mounts <".concat(n,">")),oe="elements"in te?te.elements:null,ie="customCheckoutSdk"in te?te.customCheckoutSdk:null,ue=je.useState(null),_e=D7(ue,2),xe=_e[0],be=_e[1],Ae=je.useRef(null),me=je.useRef(null);ja(xe,"blur",C),ja(xe,"focus",k),ja(xe,"escape",R),ja(xe,"click",L),ja(xe,"loaderror",B),ja(xe,"loaderstart",q),ja(xe,"networkschange",F),ja(xe,"confirm",H),ja(xe,"cancel",Z),ja(xe,"shippingaddresschange",re),ja(xe,"shippingratechange",W),ja(xe,"change",O);var ke;N&&(t==="expressCheckout"?ke=N:ke=function(){N(xe)}),ja(xe,"ready",ke),je.useLayoutEffect(function(){if(Ae.current===null&&me.current!==null&&(oe||ie)){var Be=null;ie?Be=ie.createElement(t,E):oe&&(Be=oe.create(t,E)),Ae.current=Be,be(Be),Be&&Be.mount(me.current)}},[oe,ie,E]);var Ne=YA(E);return je.useEffect(function(){if(Ae.current){var Be=L7(E,Ne,["paymentRequest"]);Be&&"update"in Ae.current&&Ae.current.update(Be)}},[E,Ne]),je.useLayoutEffect(function(){return function(){if(Ae.current&&typeof Ae.current.destroy=="function")try{Ae.current.destroy(),Ae.current=null}catch{}}},[]),je.createElement("div",{id:y,className:b,ref:me})},o=function(p){JA("mounts <".concat(n,">"));var y=p.id,b=p.className;return je.createElement("div",{id:y,className:b})},h=r?o:i;return h.propTypes={id:cr.string,className:cr.string,onChange:cr.func,onBlur:cr.func,onFocus:cr.func,onReady:cr.func,onEscape:cr.func,onClick:cr.func,onLoadError:cr.func,onLoaderStart:cr.func,onNetworksChange:cr.func,onConfirm:cr.func,onCancel:cr.func,onShippingAddressChange:cr.func,onShippingRateChange:cr.func,options:cr.object},h.displayName=n,h.__elementType=t,h},Mi=typeof window>"u",Wge=je.createContext(null);Wge.displayName="EmbeddedCheckoutProviderContext";var Gge=function(){var t=JA("calls useStripe()"),r=t.stripe;return r};ki("auBankAccount",Mi);var az=ki("card",Mi);ki("cardNumber",Mi);ki("cardExpiry",Mi);ki("cardCvc",Mi);ki("fpxBank",Mi);ki("iban",Mi);ki("idealBank",Mi);ki("p24Bank",Mi);ki("epsBank",Mi);ki("payment",Mi);ki("expressCheckout",Mi);ki("currencySelector",Mi);ki("paymentRequestButton",Mi);ki("linkAuthentication",Mi);ki("address",Mi);ki("shippingAddress",Mi);ki("paymentMethodMessaging",Mi);ki("affirmMessage",Mi);ki("afterpayClearpayMessage",Mi);var U7="https://js.stripe.com/v3",Hge=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,oz="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",Xge=function(){for(var t=document.querySelectorAll('script[src^="'.concat(U7,'"]')),r=0;r<t.length;r++){var n=t[r];if(Hge.test(n.src))return n}return null},lz=function(t){var r=t&&!t.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(U7).concat(r);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(n),n},Kge=function(t,r){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:r})},Pv=null,pw=null,mw=null,Zge=function(t){return function(){t(new Error("Failed to load Stripe.js"))}},Yge=function(t,r){return function(){window.Stripe?t(window.Stripe):r(new Error("Stripe.js not available"))}},Jge=function(t){return Pv!==null?Pv:(Pv=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe&&t&&console.warn(oz),window.Stripe){r(window.Stripe);return}try{var i=Xge();if(i&&t)console.warn(oz);else if(!i)i=lz(t);else if(i&&mw!==null&&pw!==null){var o;i.removeEventListener("load",mw),i.removeEventListener("error",pw),(o=i.parentNode)===null||o===void 0||o.removeChild(i),i=lz(t)}mw=Yge(r,n),pw=Zge(n),i.addEventListener("load",mw),i.addEventListener("error",pw)}catch(h){n(h);return}}),Pv.catch(function(r){return Pv=null,Promise.reject(r)}))},Qge=function(t,r,n){if(t===null)return null;var i=t.apply(void 0,r);return Kge(i,n),i},Av,V7=!1,q7=function(){return Av||(Av=Jge(null).catch(function(t){return Av=null,Promise.reject(t)}),Av)};Promise.resolve().then(function(){return q7()}).catch(function(e){V7||console.warn(e)});var W7=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];V7=!0;var i=Date.now();return q7().then(function(o){return Qge(o,r,i)})},ZE="Tabs",[eye,QUe]=xo(ZE,[mg]),G7=mg(),[tye,kI]=eye(ZE),H7=I.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:i,defaultValue:o,orientation:h="horizontal",dir:s,activationMode:p="automatic",...y}=e,b=F0(s),[_,E]=zc({prop:n,onChange:i,defaultProp:o??"",caller:ZE});return l.jsx(tye,{scope:r,baseId:zl(),value:_,onValueChange:E,orientation:h,dir:b,activationMode:p,children:l.jsx(fr.div,{dir:b,"data-orientation":h,...y,ref:t})})});H7.displayName=ZE;var X7="TabsList",K7=I.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...i}=e,o=kI(X7,r),h=G7(r);return l.jsx(qM,{asChild:!0,...h,orientation:o.orientation,dir:o.dir,loop:n,children:l.jsx(fr.div,{role:"tablist","aria-orientation":o.orientation,...i,ref:t})})});K7.displayName=X7;var Z7="TabsTrigger",Y7=I.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:i=!1,...o}=e,h=kI(Z7,r),s=G7(r),p=e9(h.baseId,n),y=t9(h.baseId,n),b=n===h.value;return l.jsx(WM,{asChild:!0,...s,focusable:!i,active:b,children:l.jsx(fr.button,{type:"button",role:"tab","aria-selected":b,"aria-controls":y,"data-state":b?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:p,...o,ref:t,onMouseDown:Zt(e.onMouseDown,_=>{!i&&_.button===0&&_.ctrlKey===!1?h.onValueChange(n):_.preventDefault()}),onKeyDown:Zt(e.onKeyDown,_=>{[" ","Enter"].includes(_.key)&&h.onValueChange(n)}),onFocus:Zt(e.onFocus,()=>{const _=h.activationMode!=="manual";!b&&!i&&_&&h.onValueChange(n)})})})});Y7.displayName=Z7;var J7="TabsContent",Q7=I.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:i,children:o,...h}=e,s=kI(J7,r),p=e9(s.baseId,n),y=t9(s.baseId,n),b=n===s.value,_=I.useRef(b);return I.useEffect(()=>{const E=requestAnimationFrame(()=>_.current=!1);return()=>cancelAnimationFrame(E)},[]),l.jsx(Hl,{present:i||b,children:({present:E})=>l.jsx(fr.div,{"data-state":b?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":p,hidden:!E,id:y,tabIndex:0,...h,ref:t,style:{...e.style,animationDuration:_.current?"0s":void 0},children:E&&o})})});Q7.displayName=J7;function e9(e,t){return`${e}-trigger-${t}`}function t9(e,t){return`${e}-content-${t}`}var rye=H7,r9=K7,n9=Y7,i9=Q7;const wg=rye,Sf=je.forwardRef(({className:e,...t},r)=>l.jsx(r9,{ref:r,className:Pr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Sf.displayName=r9.displayName;const Ci=je.forwardRef(({className:e,...t},r)=>l.jsx(n9,{ref:r,className:Pr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Ci.displayName=n9.displayName;const Pi=je.forwardRef(({className:e,...t},r)=>l.jsx(i9,{ref:r,className:Pr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Pi.displayName=i9.displayName;const nye=async e=>{try{const{data:t,error:r}=await Ve.from("profiles").select("*").eq("id",e).single();if(r)throw r;return t}catch(t){throw console.error("Error fetching user profile:",t),t}},iye=async(e,t)=>{try{const{data:r,error:n}=await Ve.from("profiles").update({first_name:t.firstName,last_name:t.lastName,phone:t.phone,city:t.city,country:t.country}).eq("id",e).single();if(n)throw n}catch(r){throw console.error("Error updating user profile:",r),r}},sye=async e=>{const{data:t,error:r}=await Ve.from("user_preferences").select("*").eq("user_id",e).single();if(r)throw r;return t},aye=async(e,t)=>{const{data:r,error:n}=await Ve.from("user_preferences").update(t).eq("user_id",e).select().single();if(n)throw n;return r},Jw={getSavedVenues:async e=>{const{data:t,error:r}=await Ve.from("saved_venues").select(`
        *,
        venues (*)
      `).eq("user_id",e);if(r)throw r;return t},saveVenue:async(e,t)=>{const{data:r,error:n}=await Ve.from("saved_venues").insert([{user_id:e,venue_id:t}]).select();if(n)throw n;return r},removeSavedVenue:async(e,t)=>{const{error:r}=await Ve.from("saved_venues").delete().eq("user_id",e).eq("venue_id",t);if(r)throw r}},oye={getUserBookings:async e=>{const{data:t,error:r}=await Ve.from("bookings").select(`
        *,
        venues (*)
      `).eq("user_id",e).order("booking_date",{ascending:!1});if(r)throw r;return t},createBooking:async e=>{const{data:t,error:r}=await Ve.from("bookings").insert([e]).select();if(r)throw r;return t},updateBookingStatus:async(e,t)=>{const{data:r,error:n}=await Ve.from("bookings").update({status:t}).eq("id",e).select();if(n)throw n;return r},cancelBooking:async e=>{const{data:t,error:r}=await Ve.from("bookings").update({status:"cancelled"}).eq("id",e).select();if(r)throw r;return t},getVenueBookings:async e=>{const{data:t,error:r}=await Ve.from("bookings").select("*, table:venue_tables(*, venue:venues(*))").eq("venue_id",e);if(r)throw r;return t}},lye=W7("pk_live_51RcBmaD82xmrCdK7zUZNtJKtO1Cx8Vld8hH2sARagshct2ivP38bavj7tP77gIhK8yo4FEwShNPkjX7VRex3rSWw00IYtFuuxt"),MI=async()=>{const{data:{session:e}}=await Ve.auth.getSession();if(!(e!=null&&e.access_token))throw new Error("User not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`}},II=e=>`https://${"https://agydpkzfucicraedllgl.supabase.co".split("//")[1].split(".")[0]}.functions.supabase.co/${e}`;async function cye(e){const t=await MI(),r=II("create-stripe-setup-intent"),n=await fetch(r,{method:"POST",headers:t,body:JSON.stringify({email:e})});if(!n.ok){const o=await n.json();throw new Error(o.error||"Failed to create SetupIntent")}return(await n.json()).clientSecret}async function uye(e){const t=await MI(),r=II("stripe-payment-methods"),n=await fetch(`${r}?email=${encodeURIComponent(e)}`,{method:"GET",headers:t});if(!n.ok){const o=await n.json();throw new Error(o.error||"Failed to fetch payment methods")}return(await n.json()).paymentMethods}async function dye(e){const t=await MI(),r=II("stripe-payment-methods"),n=await fetch(r,{method:"DELETE",headers:t,body:JSON.stringify({id:e})});if(!n.ok){const i=await n.json();throw new Error(i.error||"Failed to remove payment method")}return!0}async function hye(e,t,r){console.log(" [ADMIN EMAIL] Starting venue submission notification...");const n="sales@oneeddy.com",i={serviceId:"service_55v7svp",templateId:"template_wh2h7sn",publicKey:"_DltRvDA4UAiyUt1E"};try{console.log(" EmailJS config check:",{serviceId:i.serviceId?"SET":"MISSING",templateId:i.templateId?"SET":"MISSING",publicKey:i.publicKey?"SET":"MISSING"}),!i.serviceId||!i.templateId||i.publicKey;const o=(await Os(()=>Promise.resolve().then(()=>Ef),void 0)).default;try{o.init(i.publicKey),console.log(" EmailJS initialized successfully")}catch(b){throw console.error(" EmailJS initialization failed:",b),new Error("Failed to initialize EmailJS")}const h={ownerName:t.full_name,ownerEmail:t.email,ownerPhone:t.phone||"Not provided",venueName:e.name,venueDescription:e.description||"No description provided",venueType:e.type||"Not specified",venueCapacity:e.capacity||"Not specified",venueAddress:`${e.address||"Not provided"}, ${e.city||"Not provided"}, ${e.country||"Not provided"}`,venuePhone:e.contact_phone||"Not provided",priceRange:e.price_range||"Not specified",openingHours:e.opening_hours||"Not provided",applicationDate:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),viewUrl:"https://your-production-domain.com/admin/venue-approvals",to_email:n,to_name:"Eddys Members Admin",from_name:"Eddys Members System",reply_to:t.email};console.log(" [VENUE EMAIL] Sending with template data:",{ownerName:h.ownerName,venueName:h.venueName,ownerEmail:h.ownerEmail,viewUrl:h.viewUrl,timestamp:new Date().toISOString()});const s=o.send(i.serviceId,i.templateId,h),p=new Promise((b,_)=>{setTimeout(()=>_(new Error("EmailJS request timed out after 30 seconds")),3e4)}),y=await Promise.race([s,p]);return console.log(" Admin notification sent successfully via EmailJS:",y),{success:!0,result:y}}catch(o){throw console.error(" Error sending admin notification via EmailJS:",o),console.error(" Full error details:",{name:o.name,message:o.message,stack:o.stack}),o}}async function s9(){try{console.log(" Testing EmailJS connectivity...");const e=(await Os(()=>Promise.resolve().then(()=>Ef),void 0)).default,t={serviceId:"service_55v7svp",templateId:"template_wh2h7sn",publicKey:"_DltRvDA4UAiyUt1E"};console.log(" Config check:",{serviceId:t.serviceId?"SET":"MISSING",templateId:t.templateId?"SET":"MISSING",publicKey:t.publicKey?"SET":"MISSING"}),!t.serviceId||!t.templateId||t.publicKey,e.init(t.publicKey);const r=[{name:"Common EmailJS fields",data:{email:"sales@oneeddy.com",name:"Eddys Members Admin",subject:"EmailJS Connection Test",message:"This is a test message to verify EmailJS connectivity."}},{name:"Standard to/from fields",data:{to:"sales@oneeddy.com",from:"Eddys Members Test",subject:"EmailJS Connection Test",message:"This is a test message to verify EmailJS connectivity."}},{name:"User-based fields",data:{user_email:"sales@oneeddy.com",user_name:"Eddys Members Admin",subject:"EmailJS Connection Test",message:"This is a test message to verify EmailJS connectivity."}},{name:"Current approach",data:{to_name:"Eddys Members Admin",to_email:"sales@oneeddy.com",from_name:"Eddys Members Test",reply_to:"noreply@oneeddy.com",subject:"EmailJS Connection Test",message:"This is a test message to verify EmailJS connectivity.",html_message:"<p>This is a <strong>test message</strong> to verify EmailJS connectivity.</p>"}}];for(const n of r)try{console.log(` Trying ${n.name}:`,n.data);const i=await e.send(t.serviceId,t.templateId,n.data);return console.log(` SUCCESS with ${n.name}:`,i),{success:!0,result:i,workingFields:n.name,workingData:n.data}}catch(i){console.log(` Failed with ${n.name}:`,i.message)}throw new Error("All common field variations failed. Check your EmailJS template configuration.")}catch(e){return console.error(" EmailJS connection test failed:",e),{success:!1,error:e.message}}}function fye(){return I.useEffect(()=>{async function e(){const{data:t,error:r}=await Ve.from("venue_owners").select("*");console.log(t,r)}e()},[]),l.jsx("div",{children:"Check the console for venue owners data."})}const pye=Object.freeze(Object.defineProperty({__proto__:null,bookingsApi:oye,createStripeSetupIntent:cye,default:fye,getUserPreferences:sye,getUserProfile:nye,listStripePaymentMethods:uye,notifyAdminOfVenueSubmission:hye,removeStripePaymentMethod:dye,savedVenuesApi:Jw,stripePromise:lye,testEmailJSConnection:s9,updateUserPreferences:aye,updateUserProfile:iye},Symbol.toStringTag,{value:"Module"})),a9=({venue:e})=>{const{user:t}=Pd(),[r,n]=I.useState(!1),[i,o]=I.useState(!1);I.useEffect(()=>{t&&e&&h()},[t,e]);const h=async()=>{try{const y=(await Jw.getSavedVenues(t.id)).some(b=>b.venue_id===e.id);n(y)}catch(p){console.error("Error checking saved status:",p)}},s=async p=>{if(p.preventDefault(),p.stopPropagation(),!t){Mr({title:"Please sign in",description:"You need to be signed in to save venues",variant:"destructive"});return}o(!0);try{r?(await Jw.removeSavedVenue(t.id,e.id),n(!1),Mr({title:"Venue removed",description:`${e.name} has been removed from your saved venues`,className:"bg-red-50 border-red-200"})):(await Jw.saveVenue(t.id,e.id),n(!0),Mr({title:"Venue saved!",description:`${e.name} has been added to your saved venues`,className:"bg-green-50 border-green-200"}))}catch(y){console.error("Error toggling save:",y),Mr({title:"Error",description:"Failed to update saved venues. Please try again.",variant:"destructive"})}finally{o(!1)}};return l.jsx(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},whileHover:{y:-5,boxShadow:"0 10px 20px hsla(var(--primary), 0.1), 0 6px 6px hsla(var(--secondary), 0.05)"},className:"venue-card h-full group",children:l.jsxs(Mt,{className:"overflow-hidden h-full flex flex-col bg-white border-brand-burgundy/10 shadow-lg hover:shadow-xl transition-shadow duration-300 rounded-xl",children:[l.jsxs("div",{className:"relative h-56 overflow-hidden",children:[l.jsx("img",{className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",alt:`${e.name} - ${e.type} in ${e.city}`,src:e.images&&e.images.length>0?e.images[0]:"https://images.unsplash.com/photo-1699990320295-ecd2664079ab"}),l.jsx("button",{onClick:s,disabled:i,className:`absolute top-3 left-3 p-2 rounded-full transition-all duration-200 ${r?"bg-red-500 text-white shadow-lg hover:bg-red-600":"bg-white/90 text-gray-600 hover:bg-white hover:text-red-500 shadow-md"} ${i?"opacity-50 cursor-not-allowed":"hover:scale-110"}`,title:r?"Remove from favorites":"Add to favorites",children:l.jsx(Fx,{className:`h-5 w-5 ${r?"fill-current":""}`})}),l.jsxs("div",{className:"absolute top-3 right-3 flex gap-2",children:[e.tags&&e.tags.slice(0,1).map((p,y)=>l.jsx(Yr,{variant:"secondary",className:"bg-brand-gold text-brand-burgundy backdrop-blur-sm border-brand-gold/50 shadow-md",children:p},y)),l.jsx(Yr,{variant:"default",className:"bg-brand-burgundy text-brand-cream backdrop-blur-sm border-brand-burgundy/50 shadow-md",children:e.price_range||"N/A"})]}),e.isFeatured&&l.jsx("div",{className:"absolute bottom-3 left-3",children:l.jsx(Yr,{className:"bg-brand-gold text-brand-burgundy font-semibold shadow-lg",children:"Featured"})})]}),l.jsxs(Dr,{className:"pb-3 pt-4",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx(Lr,{className:"text-2xl font-heading text-brand-burgundy group-hover:text-brand-gold transition-colors duration-300",children:e.name}),l.jsxs("div",{className:"flex items-center text-sm shrink-0 ml-2 mt-1",children:[l.jsx(Gs,{className:"h-4 w-4 fill-brand-gold text-brand-gold mr-1"}),l.jsx("span",{className:"font-semibold text-brand-burgundy/80",children:e.rating})]})]}),l.jsxs("p",{className:"text-xs text-brand-burgundy/60 flex items-center",children:[l.jsx(qs,{className:"h-3.5 w-3.5 mr-1 text-brand-gold"})," ",e.address]})]}),l.jsxs(Ht,{className:"flex-grow pt-0 pb-4",children:[l.jsx("p",{className:"text-sm text-brand-burgundy/70 mb-4 line-clamp-2 font-body",children:e.description}),l.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-2 text-xs text-brand-burgundy/70 font-body",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(O8,{className:"h-3.5 w-3.5 mr-1.5 text-brand-gold"}),l.jsx("span",{children:e.type})]}),e.capacity&&l.jsxs("div",{className:"flex items-center",children:[l.jsx(Is,{className:"h-3.5 w-3.5 mr-1.5 text-brand-gold"}),l.jsxs("span",{children:["Up to ",e.capacity," guests"]})]}),e.opening_hours&&l.jsxs("div",{className:"flex items-center",children:[l.jsx(ml,{className:"h-3.5 w-3.5 mr-1.5 text-brand-gold"}),l.jsx("span",{children:e.opening_hours})]})]})]}),l.jsx(NI,{className:"pt-2 pb-4 px-4",children:l.jsx(xt,{asChild:!0,className:"w-full bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90 transition-opacity rounded-md font-body py-3",children:l.jsx(Nn,{to:`/venues/${e.id}`,children:"View Details & Book"})})})]})})},mye=({clubId:e,tickets:t,onSelectTicket:r})=>{const{toast:n}=Ui(),[i,o]=I.useState(null),h=s=>{o(s),r(s),n({title:"Ticket selected!",description:`${s.name} ticket has been added to your selection.`})};return l.jsxs("div",{className:"bg-secondary/20 border border-border/50 rounded-lg p-6",children:[l.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center",children:[l.jsx(Bie,{className:"mr-2 h-5 w-5"}),"VIP Tickets"]}),l.jsx("div",{className:"space-y-4",children:t.map(s=>l.jsxs(tt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},whileHover:{y:-2},className:`p-4 rounded-lg border cursor-pointer transition-all ${(i==null?void 0:i.id)===s.id?"border-primary bg-primary/20 neon-border":"border-border/50 hover:border-primary/50"}`,onClick:()=>h(s),children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold text-lg",children:s.name}),l.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),l.jsxs("div",{className:"text-xl font-bold",children:["$",s.price]})]}),l.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:s.features.map((p,y)=>l.jsxs(Yr,{variant:"secondary",className:"flex items-center gap-1",children:[l.jsx(Gs,{className:"h-3 w-3"}),p]},y))}),l.jsxs("div",{className:"flex flex-wrap gap-4 mt-4 text-sm text-muted-foreground",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(ml,{className:"h-4 w-4 mr-1"}),s.entryTime]}),s.maxGuests&&l.jsxs("div",{className:"flex items-center",children:[l.jsx(Is,{className:"h-4 w-4 mr-1"}),"Up to ",s.maxGuests," guests"]})]}),l.jsx(xt,{className:`mt-4 w-full ${(i==null?void 0:i.id)===s.id?"bg-gradient-to-r from-primary to-accent text-accent-foreground":"bg-secondary hover:bg-secondary/80 text-secondary-foreground"}`,variant:(i==null?void 0:i.id)===s.id?"default":"secondary",onClick:p=>{p.stopPropagation(),h(s)},children:(i==null?void 0:i.id)===s.id?"Selected":"Select Ticket"})]},s.id))})]})},gye=({clubId:e,tables:t,onReserve:r,selectedTableId:n})=>{const{toast:i}=Ui(),[o,h]=I.useState(null),[s,p]=I.useState(4),[y,b]=I.useState(""),[_,E]=I.useState(""),C=N=>{h(N)},k=()=>{if(!o||!y||!_||!s){i({title:"Missing information",description:"Please fill in all fields and select a table.",variant:"destructive"});return}r({id:o.id,name:o.table_number,table_number:o.table_number,table_type:o.table_type,price:o.price,date:y,time:_,guestCount:s}),i({title:"Table selected!",description:`Table ${o.table_number} has been added to your selection.`})};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"date",className:"text-brand-burgundy mb-2 block",children:"Date"}),l.jsxs("div",{className:"relative",children:[l.jsx(Lt,{id:"date",type:"date",value:y,onChange:N=>b(N.target.value),className:"pl-10 bg-brand-cream/50 border-brand-burgundy/30 focus:border-brand-burgundy",min:new Date().toISOString().split("T")[0]}),l.jsx(ma,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-brand-burgundy/50"})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"time",className:"text-brand-burgundy mb-2 block",children:"Time"}),l.jsxs("div",{className:"relative",children:[l.jsx(Lt,{id:"time",type:"time",value:_,onChange:N=>E(N.target.value),className:"pl-10 bg-brand-cream/50 border-brand-burgundy/30 focus:border-brand-burgundy"}),l.jsx(ml,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-brand-burgundy/50"})]})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"guests",className:"text-brand-burgundy mb-2 block",children:"Number of Guests"}),l.jsxs("div",{className:"relative",children:[l.jsx(Lt,{id:"guests",type:"number",min:"1",max:"30",value:s,onChange:N=>p(parseInt(N.target.value)),className:"pl-10 bg-brand-cream/50 border-brand-burgundy/30 focus:border-brand-burgundy"}),l.jsx(Is,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-brand-burgundy/50"})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{className:"text-brand-burgundy mb-3 block",children:"Select a Table"}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:t.map(N=>l.jsxs(tt.div,{whileHover:{scale:1.03},whileTap:{scale:.98},onClick:()=>C(N),className:`table-item cursor-pointer p-4 rounded-lg border transition-colors ${(o==null?void 0:o.id)===N.id?"border-brand-burgundy bg-brand-cream text-brand-burgundy":"border-brand-burgundy/30 bg-brand-cream/50 text-brand-burgundy/70 hover:border-brand-burgundy/50"}`,children:[l.jsxs("h4",{className:"font-medium text-sm",children:["Table ",N.table_number]}),l.jsx("p",{className:"text-xs text-brand-burgundy/70 mb-1",children:N.table_type}),l.jsxs("p",{className:"text-xs text-brand-burgundy/70 mb-2",children:["Fits ",N.capacity," people"]}),l.jsxs("p",{className:"text-sm font-bold",children:["",N.price.toLocaleString()]})]},N.id))})]}),l.jsx(xt,{onClick:k,disabled:!o||!y||!_,className:`w-full ${o?"bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90":"bg-brand-cream/50 text-brand-burgundy/50 cursor-not-allowed"}`,children:o?`Reserve Table ${o.table_number} - ${o.price.toLocaleString()}`:"Select a Table"})]})},o9=()=>{const{id:e}=uE(),t=ts(),{toast:r}=Ui(),[n,i]=I.useState(null),[o,h]=I.useState(!0),[s,p]=I.useState(null),[y,b]=I.useState(null),[_,E]=I.useState(!1);I.useEffect(()=>{(async()=>{h(!0);try{const{data:q,error:F}=await Ve.from("venues").select("*").eq("id",e).single();if(F)throw F;const{data:H,error:Z}=await Ve.from("venue_tables").select("*").eq("venue_id",e);Z&&console.error("Error fetching tables:",Z);const{data:re,error:W}=await Ve.from("venue_images").select("*").eq("venue_id",e).order("is_primary",{ascending:!1});W&&console.error("Error fetching images:",W);let te=[];if(re&&re.length>0){const ue=re.find(xe=>xe.is_primary),_e=re.filter(xe=>!xe.is_primary);ue?te=[ue.image_url,..._e.map(xe=>xe.image_url)]:te=re.map(xe=>xe.image_url)}const oe={...q,tables:H||[],images:te,tickets:[]};i(oe);const ie=JSON.parse(localStorage.getItem("lagosvibe_favorites")||"[]");E(ie.includes(e))}catch(q){console.error("Error fetching venue:",q),r({title:"Error",description:"Failed to load venue details. Please try again.",variant:"destructive"})}finally{h(!1)}})()},[e,r]);const C=B=>{p(B),b(null)},k=B=>{b(B),p(null)},N=()=>{if(console.log("handleProceedToBooking called"),console.log("selectedTicket:",s),console.log("selectedTable:",y),!s&&!y){r({title:"Selection Required",description:"Please select a ticket or reserve a table to proceed.",variant:"destructive",className:"bg-red-500 text-white"});return}let B=2;y?B=y.guestCount||y.capacity||2:s&&(B=s.maxGuests||2);const q={venueId:n.id,venueName:n.name,venueImage:n.images&&n.images.length>0?n.images[0]:null,ticket:s,table:y,guests:B,guestCount:B,timestamp:new Date().toISOString()};console.log("Saving booking selection:",q),localStorage.setItem("lagosvibe_booking_selection",JSON.stringify(q));const F=`/checkout/${n.id}`;console.log("Navigating to:",F),t(F)},O=()=>{let B=JSON.parse(localStorage.getItem("lagosvibe_favorites")||"[]");_?(B=B.filter(q=>q!==e),r({title:`${n.name} removed from favorites.`,className:"bg-brand-burgundy text-brand-cream"})):(B.push(e),r({title:`${n.name} added to favorites!`,className:"bg-brand-gold text-brand-burgundy"})),localStorage.setItem("lagosvibe_favorites",JSON.stringify(B)),E(!_)},R=()=>{navigator.share?navigator.share({title:n.name,text:`Check out ${n.name} on LagosVibe!`,url:window.location.href}).then(()=>r({title:"Venue shared!",className:"bg-brand-gold text-brand-burgundy"})).catch(B=>console.log("Error sharing",B)):(navigator.clipboard.writeText(window.location.href),r({title:"Link copied to clipboard!",className:"bg-brand-gold text-brand-burgundy"}))};if(o)return l.jsxs("div",{className:"container py-20 text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold mx-auto"}),l.jsx("p",{className:"mt-4 text-brand-burgundy/70 font-body",children:"Loading Venue Details..."})]});if(!n)return l.jsxs("div",{className:"container py-20 text-center",children:[l.jsx("h2",{className:"text-4xl font-heading mb-4 text-brand-burgundy",children:"Venue Not Found"}),l.jsx("p",{className:"text-lg text-brand-burgundy/70 font-body mb-8",children:"The venue you're looking for doesn't exist or has been removed."}),l.jsx(Nn,{to:"/venues",children:l.jsx(xt,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Back to Venues"})})]});const L=((s==null?void 0:s.price)||0)+((y==null?void 0:y.price)||0);return l.jsxs("div",{className:"bg-brand-cream",children:[l.jsxs(tt.section,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.7},className:"relative h-[50vh] md:h-[60vh] overflow-hidden",children:[l.jsx("img",{className:"w-full h-full object-cover",alt:`Interior or exterior of ${n.name}`,src:n.images&&n.images.length>0?n.images[0]:"https://images.unsplash.com/photo-1632111162953-c58fa2fa1080",onError:B=>{B.target.src="https://images.unsplash.com/photo-1632111162953-c58fa2fa1080"}}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-brand-burgundy/70 via-brand-burgundy/30 to-transparent"}),l.jsxs("div",{className:"absolute bottom-0 left-0 p-6 md:p-12 container",children:[l.jsx(tt.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},className:"text-4xl md:text-6xl font-heading text-white mb-2",children:n.name}),l.jsxs(tt.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center text-brand-gold",children:[l.jsx(Gs,{className:"h-5 w-5 fill-current mr-1"}),l.jsx("span",{className:"text-white font-semibold text-lg",children:n.rating})]}),l.jsxs("span",{className:"text-white/80 text-sm font-body",children:[" ",n.type," in ",n.city]})]})]}),l.jsxs(Nn,{to:"/venues",className:"absolute top-6 left-6 md:top-8 md:left-8 inline-flex items-center text-sm text-white bg-black/30 hover:bg-black/50 px-3 py-2 rounded-full backdrop-blur-sm transition-colors",children:[l.jsx(gE,{className:"mr-2 h-4 w-4"}),"Back to Venues"]})]}),l.jsx("div",{className:"container py-10 md:py-16",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 lg:gap-12",children:[l.jsxs("div",{className:"lg:col-span-2",children:[l.jsxs(Mt,{className:"bg-white p-6 md:p-8 rounded-xl shadow-lg border-brand-burgundy/10 mb-8",children:[l.jsxs("div",{className:"flex justify-between items-start mb-6",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-3xl font-heading text-brand-burgundy mb-1",children:["About ",n.name]}),l.jsx("p",{className:"text-brand-burgundy/70 font-body",children:n.description})]}),l.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[l.jsx(xt,{variant:"outline",size:"icon",onClick:O,className:`border-brand-gold hover:bg-brand-gold/10 ${_?"bg-brand-gold/20 text-brand-gold":"text-brand-gold"}`,children:l.jsx(Fx,{className:`h-5 w-5 ${_?"fill-current":""}`})}),l.jsx(xt,{variant:"outline",size:"icon",onClick:R,className:"text-brand-gold border-brand-gold hover:bg-brand-gold/10",children:l.jsx(Oie,{className:"h-5 w-5"})})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm font-body text-brand-burgundy/80",children:[l.jsxs("div",{className:"flex items-start",children:[l.jsx(qs,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),l.jsx("span",{children:n.address})]}),l.jsx("div",{className:"flex items-start",children:l.jsxs("span",{children:["Price Range: ",n.price_range]})}),l.jsxs("div",{className:"flex items-start",children:[l.jsx(_ie,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),l.jsx("span",{children:n.operatingDays||"Open Daily"})]}),l.jsxs("div",{className:"flex items-start",children:[l.jsx(ml,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),l.jsx("span",{children:n.openingHours})]}),n.phone&&l.jsxs("div",{className:"flex items-start",children:[l.jsx(Am,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),l.jsx("a",{href:`tel:${n.phone}`,className:"hover:text-brand-gold",children:n.phone})]}),l.jsxs("div",{className:"flex items-start",children:[l.jsx(Is,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),l.jsxs("span",{children:["Capacity: ",n.capacity," guests"]})]}),n.dressCode&&l.jsxs("div",{className:"flex items-start",children:[l.jsx(Pm,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"})," ",l.jsxs("span",{children:["Dress Code: ",n.dressCode]})]}),n.ambiance&&l.jsxs("div",{className:"md:col-span-2 flex items-start",children:[l.jsx(Pm,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),l.jsxs("span",{children:["Ambiance: ",n.ambiance]})]})]}),n.cuisine&&n.cuisine.length>0&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("h3",{className:"font-heading text-xl text-brand-burgundy mb-2 flex items-center",children:[l.jsx(xE,{className:"h-5 w-5 mr-2 text-brand-gold"}),"Cuisine"]}),l.jsx("div",{className:"flex flex-wrap gap-2",children:n.cuisine.map(B=>l.jsx(Yr,{variant:"secondary",className:"bg-brand-gold/20 text-brand-burgundy border-brand-gold/30",children:B},B))})]}),n.music&&n.music.length>0&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("h3",{className:"font-heading text-xl text-brand-burgundy mb-2 flex items-center",children:[l.jsx(M8,{className:"h-5 w-5 mr-2 text-brand-gold"}),"Music"]}),l.jsx("div",{className:"flex flex-wrap gap-2",children:n.music.map(B=>l.jsx(Yr,{variant:"secondary",className:"bg-brand-gold/20 text-brand-burgundy border-brand-gold/30",children:B},B))})]})]}),n.images&&n.images.length>0&&l.jsxs(Mt,{className:"bg-white p-6 md:p-8 rounded-xl shadow-lg border-brand-burgundy/10 mb-8",children:[l.jsx("h2",{className:"text-3xl font-heading text-brand-burgundy mb-6",children:"Gallery"}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:n.images.map((B,q)=>l.jsx(tt.div,{className:"aspect-square rounded-lg overflow-hidden shadow-md cursor-pointer hover:shadow-lg transition-shadow",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:l.jsx("img",{className:"w-full h-full object-cover",alt:`${n.name} gallery image ${q+1}`,src:B,onError:F=>{F.target.src="https://images.unsplash.com/photo-1688046671828-c26b7fd54596"}})},q))}),n.images.length>6&&l.jsxs("p",{className:"text-center text-brand-burgundy/60 text-sm mt-4",children:["+ ",n.images.length-6," more photos"]})]}),l.jsxs(Mt,{className:"bg-white p-6 md:p-8 rounded-xl shadow-lg border-brand-burgundy/10",children:[l.jsx("h2",{className:"text-3xl font-heading text-brand-burgundy mb-6",children:"Make a Reservation"}),l.jsxs(wg,{defaultValue:n.tickets&&n.tickets.length>0?"tickets":"tables",className:"font-body",children:[l.jsxs(Sf,{className:"mb-6 bg-brand-cream/60 p-1 rounded-lg",children:[n.tickets&&n.tickets.length>0&&l.jsx(Ci,{value:"tickets",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy data-[state=active]:shadow-md px-6 py-2.5 rounded-md text-brand-burgundy/80",children:"VIP Tickets"}),n.tables&&n.tables.length>0&&l.jsx(Ci,{value:"tables",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy data-[state=active]:shadow-md px-6 py-2.5 rounded-md text-brand-burgundy/80",children:"Table Reservations"})]}),n.tickets&&n.tickets.length>0&&l.jsx(Pi,{value:"tickets",children:l.jsx(mye,{clubId:n.id,tickets:n.tickets,onSelectTicket:C,selectedTicketId:s==null?void 0:s.id})}),n.tables&&n.tables.length>0&&l.jsx(Pi,{value:"tables",children:l.jsx(gye,{clubId:n.id,tables:n.tables,onReserve:k,selectedTableId:y==null?void 0:y.id})})]})]})]}),l.jsx("div",{className:"lg:sticky lg:top-24 h-fit",children:l.jsxs(Mt,{className:"bg-white p-6 rounded-xl shadow-xl border-brand-burgundy/10",children:[l.jsx(Dr,{className:"p-0 mb-4",children:l.jsx(Lr,{className:"text-2xl font-heading text-brand-burgundy",children:"Your Selection"})}),l.jsxs(Ht,{className:"p-0 font-body",children:[!s&&!y&&l.jsx("p",{className:"text-brand-burgundy/70 text-sm",children:"Select a ticket or table to get started."}),s&&l.jsxs("div",{className:"mb-4 pb-4 border-b border-brand-burgundy/10",children:[l.jsx("h4",{className:"font-semibold text-brand-burgundy",children:s.name}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Price: ",s.price.toLocaleString()]})]}),y&&l.jsxs("div",{className:"mb-4 pb-4 border-b border-brand-burgundy/10",children:[l.jsxs("h4",{className:"font-semibold text-brand-burgundy",children:["Table ",y.table_number]}),l.jsx("p",{className:"text-sm text-brand-burgundy/70",children:y.table_type}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Date: ",y.date||"Not set"," | Time: ",y.time||"Not set"]}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Guests: ",y.guestCount||"Not set"]}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Price: ",y.price.toLocaleString()]})]}),L>0&&l.jsxs("div",{className:"text-xl font-heading text-brand-burgundy mb-6",children:["Total: ",l.jsxs("span",{className:"text-brand-gold",children:["",L.toLocaleString()]})]}),l.jsx(xt,{onClick:N,disabled:!s&&!y,className:"w-full bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90 py-3 text-base rounded-md",children:"Proceed to Booking"})]})]})})]})})]})},yye=["all","Lagos Island","Victoria Island","Lekki","Ikeja","Surulere"],vye=["all","Restaurant","Club","Lounge"],xye=[{value:"4.5",label:"4.5+ Stars"},{value:"4.0",label:"4.0+ Stars"},{value:"3.5",label:"3.5+ Stars"},{value:"3.0",label:"3.0+ Stars"}],bye=["all","Nigerian","International","Fusion","Mediterranean","Asian","European","African","American"],_ye=["all","Afrobeats","Hip Hop","R&B","House","Amapiano","Reggae","Pop","Jazz","Live Band","DJ Sets"],wye=()=>{const{id:e}=uE(),[t]=EM(),r=t.get("type"),n=R=>R&&{restaurant:"Restaurant",club:"Club",lounge:"Lounge"}[R]||"all";if(e)return l.jsx(o9,{});const[i,o]=I.useState(""),[h,s]=I.useState([]),[p,y]=I.useState([]),[b,_]=I.useState(!0),[E,C]=I.useState({location:"all",venueType:n(r),rating:"all",cuisineType:"all",musicGenre:"all"});I.useEffect(()=>{C(R=>({...R,venueType:n(r)}))},[r]),I.useEffect(()=>{let R=p;i&&(R=R.filter(L=>L.name&&L.name.toLowerCase().includes(i.toLowerCase())||L.description&&L.description.toLowerCase().includes(i.toLowerCase())||L.ambiance&&L.ambiance.toLowerCase().includes(i.toLowerCase())||L.cuisine&&Array.isArray(L.cuisine)&&L.cuisine.some(B=>B.toLowerCase().includes(i.toLowerCase()))||L.music&&Array.isArray(L.music)&&L.music.some(B=>B.toLowerCase().includes(i.toLowerCase())))),E.location!=="all"&&(R=R.filter(L=>L.location===E.location)),E.venueType!=="all"&&(R=R.filter(L=>L.type===E.venueType.toLowerCase())),E.rating!=="all"&&(R=R.filter(L=>L.rating>=parseFloat(E.rating))),E.cuisineType!=="all"&&(R=R.filter(L=>L.cuisine&&L.cuisine.includes(E.cuisineType))),E.musicGenre!=="all"&&(R=R.filter(L=>Array.isArray(L.musicGenres)&&L.musicGenres.includes(E.musicGenre))),s(R)},[p,i,E]),I.useEffect(()=>{(async()=>{try{const{data:L,error:B}=await Ve.from("venues").select("*").eq("status","approved").eq("is_active",!0).order("created_at",{ascending:!1});if(B)throw B;const{data:q,error:F}=await Ve.from("venue_images").select("*").order("is_primary",{ascending:!1});F&&console.error("Error fetching images:",F);const H=L.map(Z=>{const re=q?q.filter(W=>W.venue_id===Z.id).map(W=>W.image_url):[];return{...Z,images:re}});y(H)}catch(L){console.error("Error fetching venues:",L),Mr({title:"Error",description:"Failed to load venues. Please try again.",variant:"destructive"})}finally{_(!1)}})()},[]);const k=(R,L)=>{C(B=>({...B,[R]:L}))},N=()=>{o(""),C({location:"all",venueType:"all",rating:"all",cuisineType:"all",musicGenre:"all"})},O=p.filter(R=>R.rating>=4.7).slice(0,3);return l.jsx("div",{className:"py-12 bg-brand-cream text-brand-burgundy",children:l.jsxs("div",{className:"container",children:[l.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-10 text-center",children:[l.jsx("h1",{className:"text-5xl font-heading mb-4 text-brand-burgundy",children:"Explore Lagos' Premier Venues"}),l.jsx("p",{className:"text-lg text-brand-burgundy/80 font-body max-w-3xl mx-auto",children:"Discover an curated collection of Lagos' most exclusive clubs, sophisticated restaurants, and chic lounges."})]}),O.length>0&&l.jsxs(tt.section,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:"mb-16",children:[l.jsx("h2",{className:"text-3xl font-heading mb-8 text-center text-brand-burgundy",children:"Top Picks for Tonight"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:O.map(R=>l.jsx(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},whileHover:{y:-5,boxShadow:"0 10px 20px rgba(0,0,0,0.05)"},children:l.jsxs(Mt,{className:"overflow-hidden h-full flex flex-col bg-white border-brand-burgundy/10 shadow-lg hover:shadow-xl transition-shadow duration-300 rounded-lg",children:[l.jsxs("div",{className:"relative h-56 overflow-hidden",children:[l.jsx("img",{className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",alt:`${R.name} venue image`,src:R.images&&R.images.length>0?R.images[0]:"https://images.unsplash.com/photo-1699990320295-ecd2664079ab"}),l.jsx("div",{className:"absolute top-3 right-3",children:l.jsx("span",{className:"bg-brand-gold text-brand-burgundy px-3 py-1 text-xs font-semibold rounded-full shadow",children:"Top Pick"})})]}),l.jsx(Dr,{className:"pb-3",children:l.jsx(Lr,{className:"text-2xl font-heading text-brand-burgundy",children:R.name})}),l.jsxs(Ht,{className:"flex-grow pt-0",children:[l.jsx("p",{className:"text-sm text-brand-burgundy/70 mb-3 line-clamp-2",children:R.description}),l.jsxs("div",{className:"flex items-center text-sm text-brand-gold",children:[l.jsx(Gs,{className:"h-4 w-4 fill-current mr-1"})," ",R.rating]})]}),l.jsx(NI,{className:"pt-2",children:l.jsx(xt,{asChild:!0,className:"w-full bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90 transition-opacity rounded-md",children:l.jsx(Nn,{to:`/venues/${R.id}`,children:"View Details & Book"})})})]})},R.id))})]}),l.jsxs("div",{className:"mb-10 p-6 md:p-8 bg-white border border-brand-burgundy/10 rounded-xl shadow-lg",children:[l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-x-6 gap-y-4 items-end",children:[l.jsxs("div",{className:"relative sm:col-span-2 lg:col-span-1 xl:col-span-2",children:[l.jsx(Tt,{htmlFor:"search",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80",children:"Search Venues"}),l.jsxs("div",{className:"relative",children:[l.jsx(Lt,{id:"search",type:"text",placeholder:"Name, vibe, e.g., 'Rooftop Bar'",value:i,onChange:R=>o(R.target.value),className:"pl-10 h-12 bg-brand-cream/50 border-brand-burgundy/30 focus:border-brand-gold focus:ring-brand-gold text-brand-burgundy placeholder:text-brand-burgundy/60 rounded-md"}),l.jsx(gd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-brand-burgundy/60"})]})]}),l.jsxs("div",{children:[l.jsxs(Tt,{htmlFor:"location-filter",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80 flex items-center",children:[l.jsx(qs,{className:"h-4 w-4 mr-1 text-brand-gold"}),"Location"]}),l.jsxs(rl,{value:E.location,onValueChange:R=>k("location",R),children:[l.jsx(oo,{id:"location-filter",className:"h-12 bg-brand-cream/50 border-brand-burgundy/30 text-brand-burgundy rounded-md",children:l.jsx(nl,{placeholder:"All Lagos"})}),l.jsxs(lo,{children:[l.jsx(Dn,{value:"all",children:"All Lagos"}),yye.map(R=>l.jsx(Dn,{value:R,children:R},R))]})]})]}),l.jsxs("div",{children:[l.jsxs(Tt,{htmlFor:"type-filter",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80 flex items-center",children:[l.jsx(O8,{className:"h-4 w-4 mr-1 text-brand-gold"}),"Venue Type"]}),l.jsxs(rl,{value:E.venueType,onValueChange:R=>k("venueType",R),children:[l.jsx(oo,{id:"type-filter",className:"h-12 bg-brand-cream/50 border-brand-burgundy/30 text-brand-burgundy rounded-md",children:l.jsx(nl,{placeholder:"Any Type"})}),l.jsxs(lo,{children:[l.jsx(Dn,{value:"all",children:"Any Type"}),vye.map(R=>l.jsx(Dn,{value:R,children:R},R))]})]})]}),l.jsxs("div",{children:[l.jsxs(Tt,{htmlFor:"rating-filter",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80 flex items-center",children:[l.jsx(Gs,{className:"h-4 w-4 mr-1 text-brand-gold"}),"Min. Rating"]}),l.jsxs(rl,{value:E.rating,onValueChange:R=>k("rating",R),children:[l.jsx(oo,{id:"rating-filter",className:"h-12 bg-brand-cream/50 border-brand-burgundy/30 text-brand-burgundy rounded-md",children:l.jsx(nl,{placeholder:"Any Rating"})}),l.jsxs(lo,{children:[l.jsx(Dn,{value:"all",children:"Any Rating"}),xye.map(R=>l.jsx(Dn,{value:R.value,children:R.label},R.value))]})]})]}),E.venueType==="Restaurant"&&l.jsxs("div",{children:[l.jsxs(Tt,{htmlFor:"cuisine-filter",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80 flex items-center",children:[l.jsx(xE,{className:"h-4 w-4 mr-1 text-brand-gold"}),"Cuisine Type"]}),l.jsxs(rl,{value:E.cuisineType,onValueChange:R=>k("cuisineType",R),children:[l.jsx(oo,{id:"cuisine-filter",className:"h-12 bg-brand-cream/50 border-brand-burgundy/30 text-brand-burgundy rounded-md",children:l.jsx(nl,{placeholder:"Any Cuisine"})}),l.jsxs(lo,{children:[l.jsx(Dn,{value:"all",children:"Any Cuisine"}),bye.map(R=>l.jsx(Dn,{value:R,children:R},R))]})]})]}),(E.venueType==="Club"||E.venueType==="Lounge")&&l.jsxs("div",{children:[l.jsxs(Tt,{htmlFor:"music-filter",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80 flex items-center",children:[l.jsx(M8,{className:"h-4 w-4 mr-1 text-brand-gold"}),"Music Genre"]}),l.jsxs(rl,{value:E.musicGenre,onValueChange:R=>k("musicGenre",R),children:[l.jsx(oo,{id:"music-filter",className:"h-12 bg-brand-cream/50 border-brand-burgundy/30 text-brand-burgundy rounded-md",children:l.jsx(nl,{placeholder:"Any Genre"})}),l.jsxs(lo,{children:[l.jsx(Dn,{value:"all",children:"Any Genre"}),_ye.map(R=>l.jsx(Dn,{value:R,children:R},R))]})]})]})]}),l.jsxs(xt,{onClick:N,variant:"ghost",className:"mt-6 text-sm text-brand-burgundy/70 hover:text-brand-gold",children:[l.jsx(Cie,{className:"h-4 w-4 mr-1"})," Reset All Filters"]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:h.length>0?h.map((R,L)=>l.jsx(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:L*.05,ease:"easeOut"},children:l.jsx(a9,{venue:R})},R.id)):l.jsxs("div",{className:"col-span-full text-center py-16",children:[l.jsx(Is,{className:"h-16 w-16 mx-auto text-brand-burgundy/30 mb-6"}),l.jsx("h3",{className:"text-2xl font-heading mb-3 text-brand-burgundy",children:"No Venues Match Your Criteria"}),l.jsx("p",{className:"text-brand-burgundy/70 font-body mb-6 max-w-md mx-auto",children:"Please try adjusting your search terms or filters. Lagos has many hidden gems waiting to be discovered!"}),l.jsx(xt,{variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",onClick:N,children:"Clear Filters & Search Again"})]})})]})})};var YE="Dialog",[l9,e6e]=xo(YE),[Sye,gl]=l9(YE),c9=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:i,onOpenChange:o,modal:h=!0}=e,s=I.useRef(null),p=I.useRef(null),[y,b]=zc({prop:n,defaultProp:i??!1,onChange:o,caller:YE});return l.jsx(Sye,{scope:t,triggerRef:s,contentRef:p,contentId:zl(),titleId:zl(),descriptionId:zl(),open:y,onOpenChange:b,onOpenToggle:I.useCallback(()=>b(_=>!_),[b]),modal:h,children:r})};c9.displayName=YE;var u9="DialogTrigger",d9=I.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=gl(u9,r),o=Qr(t,i.triggerRef);return l.jsx(fr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":DI(i.open),...n,ref:o,onClick:Zt(e.onClick,i.onOpenToggle)})});d9.displayName=u9;var OI="DialogPortal",[Eye,h9]=l9(OI,{forceMount:void 0}),f9=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:i}=e,o=gl(OI,t);return l.jsx(Eye,{scope:t,forceMount:r,children:I.Children.map(n,h=>l.jsx(Hl,{present:r||o.open,children:l.jsx(fE,{asChild:!0,container:i,children:h})}))})};f9.displayName=OI;var q1="DialogOverlay",p9=I.forwardRef((e,t)=>{const r=h9(q1,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,o=gl(q1,e.__scopeDialog);return o.modal?l.jsx(Hl,{present:n||o.open,children:l.jsx(jye,{...i,ref:t})}):null});p9.displayName=q1;var Tye=af("DialogOverlay.RemoveScroll"),jye=I.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=gl(q1,r);return l.jsx(HM,{as:Tye,allowPinchZoom:!0,shards:[i.contentRef],children:l.jsx(fr.div,{"data-state":DI(i.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),uf="DialogContent",m9=I.forwardRef((e,t)=>{const r=h9(uf,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,o=gl(uf,e.__scopeDialog);return l.jsx(Hl,{present:n||o.open,children:o.modal?l.jsx(Cye,{...i,ref:t}):l.jsx(Pye,{...i,ref:t})})});m9.displayName=uf;var Cye=I.forwardRef((e,t)=>{const r=gl(uf,e.__scopeDialog),n=I.useRef(null),i=Qr(t,r.contentRef,n);return I.useEffect(()=>{const o=n.current;if(o)return GM(o)},[]),l.jsx(g9,{...e,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Zt(e.onCloseAutoFocus,o=>{var h;o.preventDefault(),(h=r.triggerRef.current)==null||h.focus()}),onPointerDownOutside:Zt(e.onPointerDownOutside,o=>{const h=o.detail.originalEvent,s=h.button===0&&h.ctrlKey===!0;(h.button===2||s)&&o.preventDefault()}),onFocusOutside:Zt(e.onFocusOutside,o=>o.preventDefault())})}),Pye=I.forwardRef((e,t)=>{const r=gl(uf,e.__scopeDialog),n=I.useRef(!1),i=I.useRef(!1);return l.jsx(g9,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var h,s;(h=e.onCloseAutoFocus)==null||h.call(e,o),o.defaultPrevented||(n.current||(s=r.triggerRef.current)==null||s.focus(),o.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:o=>{var p,y;(p=e.onInteractOutside)==null||p.call(e,o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const h=o.target;((y=r.triggerRef.current)==null?void 0:y.contains(h))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),g9=I.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:o,...h}=e,s=gl(uf,r),p=I.useRef(null),y=Qr(t,p);return IM(),l.jsxs(l.Fragment,{children:[l.jsx(bE,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:o,children:l.jsx(B0,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":DI(s.open),...h,ref:y,onDismiss:()=>s.onOpenChange(!1)})}),l.jsxs(l.Fragment,{children:[l.jsx(Aye,{titleId:s.titleId}),l.jsx(kye,{contentRef:p,descriptionId:s.descriptionId})]})]})}),RI="DialogTitle",y9=I.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=gl(RI,r);return l.jsx(fr.h2,{id:i.titleId,...n,ref:t})});y9.displayName=RI;var v9="DialogDescription",x9=I.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=gl(v9,r);return l.jsx(fr.p,{id:i.descriptionId,...n,ref:t})});x9.displayName=v9;var b9="DialogClose",_9=I.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=gl(b9,r);return l.jsx(fr.button,{type:"button",...n,ref:t,onClick:Zt(e.onClick,()=>i.onOpenChange(!1))})});_9.displayName=b9;function DI(e){return e?"open":"closed"}var w9="DialogTitleWarning",[t6e,S9]=jne(w9,{contentName:uf,titleName:RI,docsSlug:"dialog"}),Aye=({titleId:e})=>{const t=S9(w9),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return I.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},Nye="DialogDescriptionWarning",kye=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${S9(Nye).contentName}}.`;return I.useEffect(()=>{var o;const i=(o=e.current)==null?void 0:o.getAttribute("aria-describedby");t&&i&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},Mye=c9,Iye=d9,Oye=f9,E9=p9,T9=m9,j9=y9,C9=x9,Rye=_9;const wd=Mye,LI=Iye,Dye=Oye,P9=je.forwardRef(({className:e,...t},r)=>l.jsx(E9,{ref:r,className:Pr("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));P9.displayName=E9.displayName;const qc=je.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(Dye,{children:[l.jsx(P9,{}),l.jsxs(T9,{ref:n,className:Pr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full",e),...r,children:[t,l.jsxs(Rye,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[l.jsx(Nm,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));qc.displayName=T9.displayName;const Wc=({className:e,...t})=>l.jsx("div",{className:Pr("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Wc.displayName="DialogHeader";const Gc=je.forwardRef(({className:e,...t},r)=>l.jsx(j9,{ref:r,className:Pr("text-lg font-semibold leading-none tracking-tight",e),...t}));Gc.displayName=j9.displayName;const A9=je.forwardRef(({className:e,...t},r)=>l.jsx(C9,{ref:r,className:Pr("text-sm text-muted-foreground",e),...t}));A9.displayName=C9.displayName;const Lye=({formData:e,errors:t,handleInputChange:r,handleSubmit:n,isSubmitting:i,totalAmount:o,isAuthenticated:h=!1})=>l.jsx("form",{onSubmit:n,children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-secondary/20 border border-border/50 rounded-lg p-6",children:[l.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[l.jsx(Kn,{className:"mr-2 h-5 w-5"}),h?"Confirm Your Information":"Personal Information"]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"fullName",children:"Full Name"}),l.jsx(Lt,{id:"fullName",name:"fullName",value:e.fullName,onChange:r,className:t.fullName?"border-destructive":""}),t.fullName&&l.jsx("p",{className:"text-destructive text-sm mt-1",children:t.fullName})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"email",children:"Email"}),l.jsx(Lt,{id:"email",name:"email",type:"email",value:e.email,onChange:r,className:t.email?"border-destructive":"",readOnly:h,disabled:h}),t.email&&l.jsx("p",{className:"text-destructive text-sm mt-1",children:t.email}),h&&l.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Email cannot be changed during checkout"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"phone",children:"Phone Number"}),l.jsx(Lt,{id:"phone",name:"phone",value:e.phone,onChange:r,className:t.phone?"border-destructive":""}),t.phone&&l.jsx("p",{className:"text-destructive text-sm mt-1",children:t.phone})]}),!h&&l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"password",children:"Create Password"}),l.jsx(Lt,{id:"password",name:"password",type:"password",value:e.password,onChange:r,className:t.password?"border-destructive":"",placeholder:"Create a password for your account"}),t.password&&l.jsx("p",{className:"text-destructive text-sm mt-1",children:t.password}),l.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"This will create your VIPClub account for future bookings"})]}),h&&l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-3",children:l.jsx(Kn,{className:"h-3 w-3 text-white"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-green-800",children:"Signed in to your VIPClub account"}),l.jsx("p",{className:"text-xs text-green-600",children:"Your booking will be saved to your profile"})]})]})})]})]}),l.jsxs("div",{className:"bg-secondary/20 border border-border/50 rounded-lg p-6",children:[l.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[l.jsx(A8,{className:"mr-2 h-5 w-5"}),"Referral Code (Optional)"]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"referralCode",children:"Referral Code"}),l.jsx(Lt,{id:"referralCode",name:"referralCode",value:e.referralCode,onChange:r,placeholder:"Enter code for perks"})]})]}),l.jsxs("div",{className:"bg-secondary/20 border border-border/50 rounded-lg p-6",children:[l.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[l.jsx(Fc,{className:"mr-2 h-5 w-5"}),"Payment Information"]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"cardNumber",children:"Card Number"}),l.jsx(Lt,{id:"cardNumber",name:"cardNumber",placeholder:"1234 5678 9012 3456",value:e.cardNumber,onChange:r,className:t.cardNumber?"border-destructive":""}),t.cardNumber&&l.jsx("p",{className:"text-destructive text-sm mt-1",children:t.cardNumber})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"expiryDate",children:"Expiry Date"}),l.jsx(Lt,{id:"expiryDate",name:"expiryDate",placeholder:"MM/YY",value:e.expiryDate,onChange:r,className:t.expiryDate?"border-destructive":""}),t.expiryDate&&l.jsx("p",{className:"text-destructive text-sm mt-1",children:t.expiryDate})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"cvv",children:"CVV"}),l.jsx(Lt,{id:"cvv",name:"cvv",placeholder:"123",value:e.cvv,onChange:r,className:t.cvv?"border-destructive":""}),t.cvv&&l.jsx("p",{className:"text-destructive text-sm mt-1",children:t.cvv})]})]})]})]}),l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx("input",{type:"checkbox",id:"agreeToTerms",name:"agreeToTerms",checked:e.agreeToTerms,onChange:r,className:"mt-1"}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"agreeToTerms",className:"text-sm",children:"I agree to the Terms of Service and Privacy Policy"}),t.agreeToTerms&&l.jsx("p",{className:"text-destructive text-sm",children:t.agreeToTerms})]})]}),l.jsx(xt,{type:"submit",className:"w-full bg-gradient-to-r from-primary to-accent hover:opacity-90 transition-opacity text-accent-foreground",disabled:i,children:i?"Processing...":`Pay $${o}`})]})}),Bye=({selection:e,totalAmount:t,vipPerks:r})=>{var n,i;return l.jsxs("div",{className:"bg-secondary/20 border border-border/50 rounded-lg p-6",children:[l.jsx("h3",{className:"text-xl font-bold mb-4",children:"Order Summary"}),l.jsx("div",{className:"mb-4",children:l.jsx("h4",{className:"font-medium text-lg",children:e.clubName})}),l.jsxs("div",{className:"space-y-4 mb-6",children:[e.ticket&&l.jsxs("div",{className:"p-3 bg-background/50 rounded-lg",children:[l.jsxs("div",{className:"flex justify-between items-start mb-1",children:[l.jsx("h4",{className:"font-medium",children:e.ticket.name}),l.jsxs("span",{className:"font-bold",children:["$",e.ticket.price]})]}),l.jsx("p",{className:"text-xs text-muted-foreground",children:e.ticket.description})]}),e.table&&l.jsxs("div",{className:"p-3 bg-background/50 rounded-lg",children:[l.jsxs("div",{className:"flex justify-between items-start mb-1",children:[l.jsxs("h4",{className:"font-medium",children:[e.table.tableName," Table"]}),l.jsxs("span",{className:"font-bold",children:["$",e.table.price]})]}),l.jsxs("div",{className:"flex items-center text-xs text-muted-foreground gap-2 flex-wrap",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(ma,{className:"h-3 w-3 mr-1"}),e.table.date]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx(ml,{className:"h-3 w-3 mr-1"}),e.table.time]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx(Kn,{className:"h-3 w-3 mr-1"}),e.table.guestCount," guests"]})]})]})]}),l.jsxs("div",{className:"border-t border-border pt-4 mb-4",children:[l.jsxs("div",{className:"flex justify-between mb-2",children:[l.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),l.jsxs("span",{children:["$",(((n=e.ticket)==null?void 0:n.price)||0)+(((i=e.table)==null?void 0:i.price)||0)]})]}),l.jsxs("div",{className:"flex justify-between mb-2",children:[l.jsx("span",{className:"text-muted-foreground",children:"Service Fee"}),l.jsx("span",{children:"$25"})]}),r&&r.includes("10% Discount Applied")&&l.jsxs("div",{className:"flex justify-between mb-2 text-green-400",children:[l.jsx("span",{className:"text-muted-foreground",children:"Referral Discount"}),l.jsx("span",{children:"-10%"})]}),l.jsxs("div",{className:"flex justify-between font-bold text-lg mt-4",children:[l.jsx("span",{children:"Total"}),l.jsxs("span",{children:["$",t]})]})]})]})},zye=({totalAmount:e,onSplitCreated:t,user:r,bookingId:n,createBookingIfNeeded:i})=>{const{toast:o}=Ui(),[h,s]=I.useState(2),[p,y]=I.useState([]),[b,_]=I.useState([]),[E,C]=I.useState(""),[k,N]=I.useState([]),[O,R]=I.useState(!1),[L,B]=I.useState(!1),[q,F]=I.useState(0),[H,Z]=I.useState(!1);I.useEffect(()=>{const xe=Math.ceil(e/h),be=Array(h-1).fill(xe);be.reduce((Ae,me)=>Ae+me,0),y(be),_(Array(h-1).fill(null))},[h,e]);const re=xe=>{xe<2||s(xe)},W=async xe=>{if(!xe.trim()){N([]);return}R(!0);try{const{data:be,error:Ae}=await Ve.from("profiles").select("id, first_name, last_name, phone").or(`first_name.ilike.%${xe}%,last_name.ilike.%${xe}%,phone.ilike.%${xe}%`).neq("id",r==null?void 0:r.id).limit(10);if(Ae)throw Ae;const me=(be||[]).map(ke=>({...ke,displayName:`${ke.first_name} ${ke.last_name}`.trim(),type:"profile"}));N(me)}catch(be){console.error("Error searching users:",be),o({title:"Search Error",description:"Failed to search users. Please try again.",variant:"destructive"})}finally{R(!1)}},te=(xe,be)=>{const Ae=[...b];Ae[be]=xe,_(Ae),B(!1),C(""),N([])},oe=xe=>{const be=[...b];be[xe]=null,_(be)},ie=xe=>{F(xe),B(!0)},ue=async()=>{if(!r){o({title:"Authentication Required",description:"Please sign in to create split payment requests.",variant:"destructive"});return}if(await Ve.from("profiles").select("id").eq("id",r.id).single(),b.some(be=>!be)){o({title:"Missing Recipients",description:"Please select recipients for all split payments.",variant:"destructive"});return}Z(!0);try{let be=n;if(!be&&typeof i=="function"&&(be=await i()),!be)throw new Error("Booking could not be created.");const Ae=b.map((We,ut)=>({booking_id:be,requester_id:r.id,recipient_id:We.id,recipient_phone:We.phone||null,amount:p[ut],payment_link:`${window.location.origin}/split-payment/${be}/${ut}`,status:"pending"})),{data:me,error:ke}=await Ve.from("split_payment_requests").insert(Ae).select();if(ke)throw ke;const Ne=me.map(We=>({user_id:We.recipient_id,split_payment_id:We.id,type:"payment_request",title:"Payment Request Received",message:`${r.first_name||"Someone"} has requested ${We.amount.toLocaleString()} for a shared booking.`})),{error:Be}=await Ve.from("payment_notifications").insert(Ne);Be&&console.error("Error creating notifications:",Be),o({title:"Split Payment Requests Created!",description:`Successfully sent ${me.length} payment requests.`,className:"bg-green-500 text-white"}),t(me)}catch(be){console.error("Error creating split payment requests:",be),o({title:"Error",description:"Failed to create split payment requests. Please try again.",variant:"destructive"})}finally{Z(!1)}},_e=e-p.reduce((xe,be)=>xe+be,0);return l.jsxs("div",{className:"space-y-6",children:[l.jsxs(Mt,{children:[l.jsx(Dr,{children:l.jsx(Lr,{className:"text-lg",children:"Split Payment Setup"})}),l.jsxs(Ht,{children:[l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[l.jsx(xt,{variant:"outline",size:"icon",onClick:()=>re(h-1),disabled:h<=2,children:l.jsx(k8,{className:"h-4 w-4"})}),l.jsxs("div",{className:"flex-1 text-center",children:[l.jsxs(Tt,{className:"text-lg",children:["Split between ",h," people"]}),l.jsx("div",{className:"text-sm text-muted-foreground",children:"Including you"})]}),l.jsx(xt,{variant:"outline",size:"icon",onClick:()=>re(h+1),children:l.jsx(yE,{className:"h-4 w-4"})})]}),l.jsx("div",{className:"bg-brand-cream/30 border border-brand-gold/20 rounded-lg p-4 mb-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 bg-brand-gold rounded-full flex items-center justify-center",children:l.jsx(Kn,{className:"h-4 w-4 text-brand-burgundy"})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:"You"}),l.jsxs("div",{className:"text-sm text-muted-foreground",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"font-bold text-lg",children:["",_e.toLocaleString()]}),l.jsx("div",{className:"text-sm text-muted-foreground",children:"Your portion"})]})]})})]})]}),l.jsxs(Mt,{children:[l.jsx(Dr,{children:l.jsx(Lr,{className:"text-lg",children:"Select Recipients"})}),l.jsx(Ht,{children:l.jsx("div",{className:"space-y-4",children:p.map((xe,be)=>l.jsxs("div",{className:"border rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs(Tt,{children:["Person ",be+2]}),l.jsxs("div",{className:"font-bold",children:["",xe.toLocaleString()]})]}),b[be]?l.jsxs("div",{className:"flex items-center justify-between bg-green-50 border border-green-200 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:l.jsx(Kn,{className:"h-4 w-4 text-white"})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:b[be].displayName}),l.jsx("div",{className:"text-sm text-muted-foreground",children:b[be].phone})]})]}),l.jsx(xt,{variant:"ghost",size:"sm",onClick:()=>oe(be),children:l.jsx(Nm,{className:"h-4 w-4"})})]}):l.jsxs(xt,{variant:"outline",className:"w-full",onClick:()=>ie(be),children:[l.jsx(gd,{className:"h-4 w-4 mr-2"}),"Search for recipient"]})]},be))})})]}),l.jsx(xt,{className:"w-full bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",onClick:ue,disabled:H||b.some(xe=>!xe),children:H?l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-brand-burgundy mr-2"}),"Creating Requests..."]}):l.jsxs(l.Fragment,{children:[l.jsx(ax,{className:"h-4 w-4 mr-2"}),"Send Payment Requests"]})}),l.jsx(wd,{open:L,onOpenChange:B,children:l.jsxs(qc,{children:[l.jsx(Wc,{children:l.jsx(Gc,{children:"Search for Recipient"})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(gd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),l.jsx(Lt,{placeholder:"Search by name or phone...",value:E,onChange:xe=>{C(xe.target.value),W(xe.target.value)},className:"pl-10"})]}),O&&l.jsxs("div",{className:"text-center py-4",children:[l.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-brand-burgundy mx-auto"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Searching..."})]}),l.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2",children:k.map(xe=>l.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted cursor-pointer",onClick:()=>te(xe,q),children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 bg-brand-burgundy/10 rounded-full flex items-center justify-center",children:l.jsx(Kn,{className:"h-4 w-4 text-brand-burgundy"})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:xe.displayName}),l.jsx("div",{className:"text-sm text-muted-foreground",children:xe.phone})]})]}),l.jsx(Yr,{variant:"outline",children:"VIP Member"})]},xe.id))}),E&&!O&&k.length===0&&l.jsxs("div",{className:"text-center py-4 text-muted-foreground",children:[l.jsxs("p",{children:['No users found matching "',E,'"']}),l.jsx("p",{className:"text-sm mt-1",children:"Try searching by name or phone number"})]})]})]})})]})},$ye=(e,t=!1)=>{const r={};return e.fullName.trim()||(r.fullName="Full name is required"),e.email.trim()?/\S+@\S+\.\S+/.test(e.email)||(r.email="Email is invalid"):r.email="Email is required",e.phone.trim()||(r.phone="Phone number is required"),t||(e.password.trim()?e.password.length<6&&(r.password="Password must be at least 6 characters"):r.password="Password is required"),e.cardNumber.trim()?/^\d{16}$/.test(e.cardNumber.replace(/\s/g,""))||(r.cardNumber="Card number must be 16 digits"):r.cardNumber="Card number is required",e.expiryDate.trim()?/^(0[1-9]|1[0-2])\/?([0-9]{2})$/.test(e.expiryDate)||(r.expiryDate="Format must be MM/YY"):r.expiryDate="Expiry date is required",e.cvv.trim()?/^\d{3,4}$/.test(e.cvv)||(r.cvv="CVV must be 3 or 4 digits"):r.cvv="CVV is required",e.agreeToTerms||(r.agreeToTerms="You must agree to the terms"),r};var BI="Radio",[Fye,N9]=xo(BI),[Uye,Vye]=Fye(BI),k9=I.forwardRef((e,t)=>{const{__scopeRadio:r,name:n,checked:i=!1,required:o,disabled:h,value:s="on",onCheck:p,form:y,...b}=e,[_,E]=I.useState(null),C=Qr(t,O=>E(O)),k=I.useRef(!1),N=_?y||!!_.closest("form"):!0;return l.jsxs(Uye,{scope:r,checked:i,disabled:h,children:[l.jsx(fr.button,{type:"button",role:"radio","aria-checked":i,"data-state":R9(i),"data-disabled":h?"":void 0,disabled:h,value:s,...b,ref:C,onClick:Zt(e.onClick,O=>{i||p==null||p(),N&&(k.current=O.isPropagationStopped(),k.current||O.stopPropagation())})}),N&&l.jsx(O9,{control:_,bubbles:!k.current,name:n,value:s,checked:i,required:o,disabled:h,form:y,style:{transform:"translateX(-100%)"}})]})});k9.displayName=BI;var M9="RadioIndicator",I9=I.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:n,...i}=e,o=Vye(M9,r);return l.jsx(Hl,{present:n||o.checked,children:l.jsx(fr.span,{"data-state":R9(o.checked),"data-disabled":o.disabled?"":void 0,...i,ref:t})})});I9.displayName=M9;var qye="RadioBubbleInput",O9=I.forwardRef(({__scopeRadio:e,control:t,checked:r,bubbles:n=!0,...i},o)=>{const h=I.useRef(null),s=Qr(h,o),p=PI(r),y=FM(t);return I.useEffect(()=>{const b=h.current;if(!b)return;const _=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(_,"checked").set;if(p!==r&&C){const k=new Event("click",{bubbles:n});C.call(b,r),b.dispatchEvent(k)}},[p,r,n]),l.jsx(fr.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...i,tabIndex:-1,ref:s,style:{...i.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});O9.displayName=qye;function R9(e){return e?"checked":"unchecked"}var Wye=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],JE="RadioGroup",[Gye,r6e]=xo(JE,[mg,N9]),D9=mg(),L9=N9(),[Hye,Xye]=Gye(JE),B9=I.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:n,defaultValue:i,value:o,required:h=!1,disabled:s=!1,orientation:p,dir:y,loop:b=!0,onValueChange:_,...E}=e,C=D9(r),k=F0(y),[N,O]=zc({prop:o,defaultProp:i??null,onChange:_,caller:JE});return l.jsx(Hye,{scope:r,name:n,required:h,disabled:s,value:N,onValueChange:O,children:l.jsx(qM,{asChild:!0,...C,orientation:p,dir:k,loop:b,children:l.jsx(fr.div,{role:"radiogroup","aria-required":h,"aria-orientation":p,"data-disabled":s?"":void 0,dir:k,...E,ref:t})})})});B9.displayName=JE;var z9="RadioGroupItem",$9=I.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:n,...i}=e,o=Xye(z9,r),h=o.disabled||n,s=D9(r),p=L9(r),y=I.useRef(null),b=Qr(t,y),_=o.value===i.value,E=I.useRef(!1);return I.useEffect(()=>{const C=N=>{Wye.includes(N.key)&&(E.current=!0)},k=()=>E.current=!1;return document.addEventListener("keydown",C),document.addEventListener("keyup",k),()=>{document.removeEventListener("keydown",C),document.removeEventListener("keyup",k)}},[]),l.jsx(WM,{asChild:!0,...s,focusable:!h,active:_,children:l.jsx(k9,{disabled:h,required:o.required,checked:_,...p,...i,name:o.name,ref:b,onCheck:()=>o.onValueChange(i.value),onKeyDown:Zt(C=>{C.key==="Enter"&&C.preventDefault()}),onFocus:Zt(i.onFocus,()=>{var C;E.current&&((C=y.current)==null||C.click())})})})});$9.displayName=z9;var Kye="RadioGroupIndicator",F9=I.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...n}=e,i=L9(r);return l.jsx(I9,{...i,...n,ref:t})});F9.displayName=Kye;var U9=B9,V9=$9,Zye=F9;const Yye=I.forwardRef(({className:e,...t},r)=>l.jsx(U9,{className:Pr("grid gap-2",e),...t,ref:r}));Yye.displayName=U9.displayName;const Jye=I.forwardRef(({className:e,...t},r)=>l.jsx(V9,{ref:r,className:Pr("aspect-square h-4 w-4 rounded-full border border-brand-burgundy text-brand-burgundy ring-offset-white focus:outline-none focus-visible:ring-2 focus-visible:ring-brand-burgundy focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:l.jsx(Zye,{className:"flex items-center justify-center",children:l.jsx(Sie,{className:"h-2.5 w-2.5 fill-brand-burgundy text-brand-burgundy"})})}));Jye.displayName=V9.displayName;class Sg{constructor(t=0,r="Network Error"){this.status=t,this.text=r}}const Qye=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},cs={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:Qye()},zI=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},q9=(e,t="https://api.emailjs.com")=>{if(!e)return;const r=zI(e);cs.publicKey=r.publicKey,cs.blockHeadless=r.blockHeadless,cs.storageProvider=r.storageProvider,cs.blockList=r.blockList,cs.limitRate=r.limitRate,cs.origin=r.origin||t},W9=async(e,t,r={})=>{const n=await fetch(cs.origin+e,{method:"POST",headers:r,body:t}),i=await n.text(),o=new Sg(n.status,i);if(n.ok)return o;throw o},G9=(e,t,r)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!r||typeof r!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},eve=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},H9=e=>e.webdriver||!e.languages||e.languages.length===0,X9=()=>new Sg(451,"Unavailable For Headless Browser"),tve=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"},rve=e=>{var t;return!((t=e.list)!=null&&t.length)||!e.watchVariable},nve=(e,t)=>e instanceof FormData?e.get(t):e[t],K9=(e,t)=>{if(rve(e))return!1;tve(e.list,e.watchVariable);const r=nve(t,e.watchVariable);return typeof r!="string"?!1:e.list.includes(r)},Z9=()=>new Sg(403,"Forbidden"),ive=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"},sve=async(e,t,r)=>{const n=Number(await r.get(e)||0);return t-Date.now()+n},Y9=async(e,t,r)=>{if(!t.throttle||!r)return!1;ive(t.throttle,t.id);const n=t.id||e;return await sve(n,t.throttle,r)>0?!0:(await r.set(n,Date.now().toString()),!1)},J9=()=>new Sg(429,"Too Many Requests"),Q9=async(e,t,r,n)=>{const i=zI(n),o=i.publicKey||cs.publicKey,h=i.blockHeadless||cs.blockHeadless,s=i.storageProvider||cs.storageProvider,p={...cs.blockList,...i.blockList},y={...cs.limitRate,...i.limitRate};return h&&H9(navigator)?Promise.reject(X9()):(G9(o,e,t),eve(r),r&&K9(p,r)?Promise.reject(Z9()):await Y9(location.pathname,y,s)?Promise.reject(J9()):W9("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:o,service_id:e,template_id:t,template_params:r}),{"Content-type":"application/json"}))},ave=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},ove=e=>typeof e=="string"?document.querySelector(e):e,eH=async(e,t,r,n)=>{const i=zI(n),o=i.publicKey||cs.publicKey,h=i.blockHeadless||cs.blockHeadless,s=cs.storageProvider||i.storageProvider,p={...cs.blockList,...i.blockList},y={...cs.limitRate,...i.limitRate};if(h&&H9(navigator))return Promise.reject(X9());const b=ove(r);G9(o,e,t),ave(b);const _=new FormData(b);return K9(p,_)?Promise.reject(Z9()):await Y9(location.pathname,y,s)?Promise.reject(J9()):(_.append("lib_version","4.4.1"),_.append("service_id",e),_.append("template_id",t),_.append("user_id",o),W9("/api/v1.0/email/send-form",_))},Ws={init:q9,send:Q9,sendForm:eH,EmailJSResponseStatus:Sg},Ef=Object.freeze(Object.defineProperty({__proto__:null,EmailJSResponseStatus:Sg,default:Ws,init:q9,send:Q9,sendForm:eH},Symbol.toStringTag,{value:"Module"})),lve=e=>`
<div
  style="
    font-family: system-ui, sans-serif, Arial;
    font-size: 14px;
    color: #333;
    padding: 14px 8px;
    background-color: #f5f5f5;
  "
>
  <style>
    @media only screen and (max-width: 600px) {
      .mobile-padding { padding: 8px !important; }
      .mobile-text { font-size: 12px !important; }
      .mobile-title { font-size: 14px !important; }
      .mobile-stack { display: block !important; width: 100% !important; }
      .mobile-center { text-align: center !important; }
      .mobile-hide { display: none !important; }
      .mobile-full-width { width: 100% !important; }
    }
  </style>
  <div style="max-width: 600px; margin: auto; background-color: #fff">
    <div style="border-top: 6px solid #5B0202; padding: 16px;" class="mobile-padding">
      <a
        style="text-decoration: none; outline: none; margin-right: 8px; vertical-align: middle"
        href="https://vipclub.com"
        target="_blank"
      >
        <img
          style="height: 32px; vertical-align: middle"
          height="32px"
          src="cid:logo.png"
          alt="Eddys Members"
        />
      </a>
      <span
        style="
          font-size: 16px;
          vertical-align: middle;
          border-left: 1px solid #333;
          padding-left: 8px;
        "
        class="mobile-title"
      >
        <strong>Booking Confirmation</strong>
      </span>
    </div>
    <div style="padding: 0 16px;" class="mobile-padding">
      <p class="mobile-text">Thank you for your reservation! We're excited to welcome you to ${e.venueName}.</p>
      <div
        style="
          text-align: left;
          font-size: 14px;
          padding-bottom: 4px;
          border-bottom: 2px solid #333;
          margin-bottom: 16px;
        "
        class="mobile-text"
      >
        <strong>Booking # ${e.bookingId}</strong>
      </div>
      
      <!-- Booking Details - Mobile Responsive -->
      <table style="width: 100%; border-collapse: collapse; margin-top: 24px;" class="mobile-stack">
        <tr style="vertical-align: top;" class="mobile-stack">
          <td style="padding: 12px 8px; width: 120px;" class="mobile-stack mobile-center">
            <img style="height: 80px; width: 120px; object-fit: cover; border-radius: 8px; max-width: 100%;" 
                 src="${e.venueImage}" alt="${e.venueName}" class="mobile-full-width" />
          </td>
          <td style="padding: 12px 8px; width: 100%;" class="mobile-stack">
            <div style="font-weight: bold; font-size: 16px; color: #5B0202;" class="mobile-title">${e.venueName}</div>
            <div style="color: #888; padding-top: 4px;" class="mobile-text">${e.venueAddress}</div>
            <div style="padding-top: 8px;" class="mobile-text">
              <div><strong>Date:</strong> ${e.date}</div>
              <div><strong>Time:</strong> ${e.time}</div>
              <div><strong>Guests:</strong> ${e.guests}</div>
              ${e.tableNumber?`<div><strong>Table:</strong> ${e.tableNumber}</div>`:""}
            </div>
          </td>
        </tr>
      </table>

      <!-- Pricing Breakdown -->
      <div style="padding: 24px 0;">
        <div style="border-top: 2px solid #333"></div>
      </div>
      <table style="border-collapse: collapse; width: 100%; text-align: right;" class="mobile-text">
        <tr>
          <td style="width: 60%;"></td>
          <td style="padding: 4px 8px;">Booking Fee</td>
          <td style="padding: 4px 8px; white-space: nowrap">${e.bookingFee}</td>
        </tr>
        ${e.serviceCharge?`
        <tr>
          <td style="width: 60%;"></td>
          <td style="padding: 4px 8px;">Service Charge</td>
          <td style="padding: 4px 8px; white-space: nowrap">${e.serviceCharge}</td>
        </tr>
        `:""}
        <tr>
          <td style="width: 60%;"></td>
          <td style="border-top: 2px solid #333; padding: 8px;">
            <strong style="white-space: nowrap">Total Amount</strong>
          </td>
          <td style="padding: 8px; border-top: 2px solid #333; white-space: nowrap">
            <strong>${e.totalAmount}</strong>
          </td>
        </tr>
      </table>

      <!-- Important Information -->
      <div style="margin-top: 24px; padding: 16px; background-color: #f8f8f8; border-radius: 8px;" class="mobile-padding">
        <h3 style="margin: 0 0 12px 0; color: #5B0202;" class="mobile-title">Important Information</h3>
        <ul style="margin: 0; padding-left: 20px;" class="mobile-text">
          <li style="margin-bottom: 8px;">Please arrive 15 minutes before your reservation time</li>
          <li style="margin-bottom: 8px;">Bring a valid ID for verification</li>
          <li style="margin-bottom: 8px;">Dress code: ${e.dressCode||"Smart casual"}</li>
          <li>For cancellations, contact us at least 24 hours in advance</li>
        </ul>
      </div>

      <!-- Contact Information -->
      <div style="margin-top: 24px; padding: 16px; border: 1px solid #ddd; border-radius: 8px;" class="mobile-padding">
        <h3 style="margin: 0 0 12px 0; color: #5B0202;" class="mobile-title">Venue Contact</h3>
        <p style="margin: 0;" class="mobile-text">
          <strong>${e.venueName}</strong><br>
           ${e.venueAddress}<br>
           ${e.venuePhone}<br>
           ${e.venueEmail}
        </p>
      </div>
    </div>
  </div>
  <div style="max-width: 600px; margin: auto;">
    <p style="color: #999; text-align: center; padding: 16px;" class="mobile-text mobile-padding">
      This email was sent to ${e.customerEmail}<br>
      You received this email because you made a reservation with Eddys Members
    </p>
    <p style="color: #999; text-align: center; font-size: 12px;" class="mobile-text">
      Eddys Members - Your Premier Destination for Exclusive Venue Bookings<br>
      Lagos, Nigeria | www.vipclub.com
    </p>
  </div>
</div>
  `,tH=(e,t)=>`
<div
  style="
    font-family: system-ui, sans-serif, Arial;
    font-size: 14px;
    color: #333;
    padding: 14px 8px;
    background-color: #f5f5f5;
  "
>
  <div style="max-width: 600px; margin: auto; background-color: #fff">
    <div style="border-top: 6px solid #D4AF37; padding: 16px">
      <a
        style="text-decoration: none; outline: none; margin-right: 8px; vertical-align: middle"
        href="https://vipclub.com/venue-owner/dashboard"
        target="_blank"
      >
        <img
          style="height: 32px; vertical-align: middle"
          height="32px"
          src="cid:logo.png"
          alt="Eddys Members"
        />
      </a>
      <span
        style="
          font-size: 16px;
          vertical-align: middle;
          border-left: 1px solid #333;
          padding-left: 8px;
        "
      >
        <strong>New Booking Received</strong>
      </span>
    </div>
    <div style="padding: 0 16px">
      <p>Hello ${t.name},</p>
      <p>You have received a new booking for <strong>${e.venueName}</strong>.</p>
      
      <div
        style="
          text-align: left;
          font-size: 14px;
          padding-bottom: 4px;
          border-bottom: 2px solid #333;
        "
      >
        <strong>Booking # ${e.bookingId}</strong>
      </div>

      <!-- Customer Information -->
      <div style="margin-top: 24px; padding: 16px; background-color: #f8f8f8; border-radius: 8px;">
        <h3 style="margin: 0 0 12px 0; color: #5B0202;">Customer Details</h3>
        <p style="margin: 0;">
          <strong>Name:</strong> ${e.customerName}<br>
          <strong>Email:</strong> ${e.customerEmail}<br>
          <strong>Phone:</strong> ${e.customerPhone}
        </p>
      </div>

      <!-- Booking Details -->
      <div style="margin-top: 16px; padding: 16px; background-color: #f8f8f8; border-radius: 8px;">
        <h3 style="margin: 0 0 12px 0; color: #5B0202;">Booking Details</h3>
        <p style="margin: 0;">
          <strong>Date:</strong> ${e.date}<br>
          <strong>Time:</strong> ${e.time}<br>
          <strong>Guests:</strong> ${e.guests}<br>
          ${e.tableNumber?`<strong>Table:</strong> ${e.tableNumber}<br>`:""}
          <strong>Total Amount:</strong> ${e.totalAmount}
        </p>
      </div>

      <!-- Action Buttons -->
      <div style="text-align: center; margin: 24px 0;">
        <a href="https://vipclub.com/venue-owner/bookings" 
           style="
             display: inline-block;
             padding: 12px 24px;
             background-color: #5B0202;
             color: white;
             text-decoration: none;
             border-radius: 6px;
             font-weight: bold;
           ">
          View in Dashboard
        </a>
      </div>
    </div>
  </div>
  <div style="max-width: 600px; margin: auto">
    <p style="color: #999; text-align: center; padding: 16px;">
      Eddys Members Venue Owner Portal<br>
      Manage your bookings at vipclub.com/venue-owner
    </p>
  </div>
</div>
  `,cve=e=>`
<div
  style="
    font-family: system-ui, sans-serif, Arial;
    font-size: 14px;
    color: #333;
    padding: 14px 8px;
    background-color: #f5f5f5;
  "
>
  <div style="max-width: 600px; margin: auto; background-color: #fff">
    <div style="border-top: 6px solid #dc2626; padding: 16px">
      <a
        style="text-decoration: none; outline: none; margin-right: 8px; vertical-align: middle"
        href="https://vipclub.com"
        target="_blank"
      >
        <img
          style="height: 32px; vertical-align: middle"
          height="32px"
          src="cid:logo.png"
          alt="Eddys Members"
        />
      </a>
      <span
        style="
          font-size: 16px;
          vertical-align: middle;
          border-left: 1px solid #333;
          padding-left: 8px;
        "
      >
        <strong>Booking Cancelled</strong>
      </span>
    </div>
    <div style="padding: 0 16px">
      <p>Your booking has been cancelled as requested.</p>
      
      <div
        style="
          text-align: left;
          font-size: 14px;
          padding-bottom: 4px;
          border-bottom: 2px solid #333;
        "
      >
        <strong>Booking # ${e.bookingId}</strong>
      </div>

      <!-- Cancelled Booking Details -->
      <div style="margin-top: 24px; padding: 16px; background-color: #fef2f2; border: 1px solid #fecaca; border-radius: 8px;">
        <h3 style="margin: 0 0 12px 0; color: #dc2626;">Cancelled Reservation</h3>
        <p style="margin: 0;">
          <strong>Venue:</strong> ${e.venueName}<br>
          <strong>Date:</strong> ${e.date}<br>
          <strong>Time:</strong> ${e.time}<br>
          <strong>Guests:</strong> ${e.guests}
        </p>
      </div>

      ${e.refundAmount?`
      <div style="margin-top: 16px; padding: 16px; background-color: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px;">
        <h3 style="margin: 0 0 12px 0; color: #16a34a;">Refund Information</h3>
        <p style="margin: 0;">
          A refund of <strong>${e.refundAmount}</strong> will be processed to your original payment method within 5-7 business days.
        </p>
      </div>
      `:""}

      <p style="margin-top: 24px;">
        We're sorry to see you cancel your reservation. We hope to welcome you to Eddys Members in the future!
      </p>
    </div>
  </div>
  <div style="max-width: 600px; margin: auto">
    <p style="color: #999; text-align: center; padding: 16px;">
      Eddys Members - Your Premier Destination for Exclusive Venue Bookings<br>
      Lagos, Nigeria | www.vipclub.com
    </p>
  </div>
</div>
  `,rH=(e,t,r)=>{var n;return{bookingId:e.id,venueName:t.name,venueAddress:t.address,venuePhone:t.contact_phone,venueEmail:t.contact_email,venueImage:((n=t.images)==null?void 0:n[0])||"/images/default-venue.jpg",customerName:r.full_name||r.name,customerEmail:r.email,customerPhone:r.phone,date:new Date(e.booking_date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),time:e.booking_time,guests:e.guest_count,tableNumber:e.table_number,bookingFee:e.booking_fee||"0",serviceCharge:e.service_charge||"0",totalAmount:e.total_amount||e.amount,dressCode:t.dress_code,status:e.status}},uve=Object.freeze(Object.defineProperty({__proto__:null,bookingConfirmationTemplate:lve,cancellationTemplate:cve,generateEmailData:rH,venueOwnerNotificationTemplate:tH},Symbol.toStringTag,{value:"Module"})),_n={serviceId:"service_55v7svp",templateId:{}.VITE_EMAILJS_BOOKING_CONFIRMATION_TEMPLATE,publicKey:"_DltRvDA4UAiyUt1E"};Ws.init(_n.publicKey);const dve=e=>({...e,subject:e.subject||"Eddys Members Booking Confirmation",from_name:"Eddys Members",reply_to:"info@oneeddy.com"}),hve=async(e,t,r)=>{try{if(!_n.serviceId||!_n.templateId||!_n.publicKey)throw console.warn(" EmailJS not fully configured. Check your .env file for:"),console.warn("   - VITE_EMAILJS_SERVICE_ID"),console.warn("   - VITE_EMAILJS_TEMPLATE_ID"),console.warn("   - VITE_EMAILJS_PUBLIC_KEY"),new Error("EmailJS configuration incomplete");const n=r.email||r.customerEmail||r.full_name;if(!n||!n.includes("@"))throw console.error(" Invalid or missing customer email:",n),new Error("Invalid customer email address");const i={customerEmail:n,to_name:r.full_name||r.customerName||r.name||"Valued Customer",customerName:r.full_name||r.customerName||r.name||"Valued Customer",to_email:n,customerPhone:r.phone||r.customerPhone||r.phone_number||"N/A",bookingReference:e.booking_reference||`VIP-${e.id}`,partySize:e.guest_count||e.guests||e.number_of_guests||"2",bookingDate:new Date(e.booking_date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),bookingTime:e.booking_time||e.start_time||"7:00 PM",bookingDuration:e.duration||e.booking_duration||"4",tableNumber:e.table_number||e.table_id||"VIP-001",tableType:e.table_type||t.table_type||"VIP Table",tableCapacity:e.guest_count||e.guests||e.number_of_guests||"2",tableLocation:e.table_location||t.table_location||"Prime Location",tableFeatures:e.table_features||t.table_features||"Premium seating with excellent view",venueName:t.name||"Premium Venue",venueDescription:t.description||t.about||"Experience luxury dining and entertainment in Lagos' most exclusive venue.",venueAddress:t.address||t.location||"Lagos, Nigeria",venuePhone:t.contact_phone||t.phone||t.contact_number||"+234 XXX XXX XXXX",venueDressCode:t.dress_code||t.dresscode||"Smart Casual",venueParking:t.parking||t.parking_info||"Valet parking available",venueCuisine:t.cuisine||t.cuisine_type||"International cuisine",venueHours:t.hours||t.opening_hours||t.business_hours||"6:00 PM - 2:00 AM",specialRequests:e.special_requests||e.notes||e.additional_notes||"None specified",viewBookingUrl:`${window.location.origin}/profile`,modifyBookingUrl:`${window.location.origin}/profile`,cancelBookingUrl:`${window.location.origin}/profile`,websiteUrl:window.location.origin,supportUrl:"mailto:info@oneeddy.com",unsubscribeUrl:`${window.location.origin}/settings`},o=dve(i);console.log(" Sending booking confirmation with optimized parameters:",{to_email:o.to_email,customerName:o.customerName,bookingReference:o.bookingReference,venueName:o.venueName,subject:o.subject});const h=await Ws.send(_n.serviceId,_n.templateId,o);return console.log(" Booking confirmation email sent successfully:",h),console.log(" Email Delivery Tips:"),console.log("   - Check spam/junk folder if email not received"),console.log('   - Mark as "Not Spam" to improve future delivery'),console.log("   - Add support@vipclub.com to contacts"),h}catch(n){throw console.error(" Failed to send booking confirmation:",n),console.error("Error details:",{message:n.message,status:n.status,text:n.text}),n.text==="The recipients address is empty"&&(console.error(' EmailJS template issue: The "To" field in your EmailJS template is missing or incorrectly configured.'),console.error('   Please ensure your EmailJS template has {{customerEmail}} in the "To" field.')),n}},fve=async(e,t,r)=>{try{if(!_n.serviceId||!_n.templateId||!_n.publicKey)throw new Error("EmailJS configuration incomplete");const n=rH(e,t,r),i=tH(n),o=await Ws.send(_n.serviceId,_n.templateId,{to_email:t.contact_email,to_name:"Venue Manager",subject:`New Booking - ${t.name}`,html_content:i,from_name:"Eddys Members",reply_to:"info@oneeddy.com"});return console.log(" Venue owner notification sent successfully"),o}catch(n){throw console.error(" Failed to send venue owner notification:",n),n}},pve=async()=>{if(!_n.templateId||!_n.publicKey)return console.error(" EmailJS configuration incomplete:"),console.error("   Service ID:"," Set"),console.error("   Template ID:",_n.templateId?" Set":" Missing"),console.error("   Public Key:"," Set"),{success:!1,error:"EmailJS configuration incomplete. Check your .env file."};const e={to_name:"Test User",to_email:"test@example.com",from_name:"Eddys Members",message:"This is a test email to verify EmailJS configuration.",subject:"Eddys Members Email Service Test"};try{console.log(" Testing EmailJS with config:",{serviceId:_n.serviceId,templateId:_n.templateId,publicKey:_n.publicKey?"***":"missing"});const t=await Ws.send(_n.serviceId,_n.templateId,e);return console.log(" Email service test successful:",t),{success:!0,result:t}}catch(t){console.error(" Email service test failed:",t),console.error("Error details:",{message:t.message,status:t.status,text:t.text});let r="Email service test failed";return t.status===422?r="Template parameters mismatch. Please check your EmailJS template configuration.":t.status===400?r="Invalid request. Check your Service ID and Template ID.":t.status===401&&(r="Unauthorized. Check your Public Key."),{success:!1,error:r}}},mve=async(e="test@example.com")=>{console.log(" Starting quick email test...");try{const t=await Ws.send(_n.serviceId,_n.templateId,{to_email:e,to_name:"Test User",from_name:"Eddys Members",subject:"Eddys Members Test Email",message:"This is a test email from Eddys Members",venue_name:"Test Venue",booking_id:"12345",booking_date:new Date().toLocaleDateString(),booking_time:"19:00",guests:"2",total_amount:"5000"});return console.log(" Quick email test successful!",t),{success:!0,result:t}}catch(t){return console.error(" Quick email test failed:",t),{success:!1,error:t}}},gve=async(e,t,r)=>{console.log(" Debugging booking email issue..."),console.log(" Customer data:",r),console.log(" Venue data:",t),console.log(" Booking data:",e),console.log(" EmailJS config:",{serviceId:" Set",templateId:_n.templateId?" Set":" Missing",publicKey:" Set"});const n=r.email||r.customerEmail||r.full_name;if(console.log(" Customer email found:",n),!n||!n.includes("@"))return console.error(" Invalid customer email:",n),{success:!1,error:"Invalid customer email"};const i={customerEmail:n,to_name:r.full_name||r.customerName||"Test User",customerName:r.full_name||r.customerName||"Test User",to_email:n,bookingReference:"TEST-123",venueName:t.name||"Test Venue"};console.log(" Testing with minimal params:",i);try{const o=await Ws.send(_n.serviceId,_n.templateId,i);return console.log(" Debug test successful:",o),{success:!0,result:o}}catch(o){return console.error(" Debug test failed:",o),o.text==="The recipients address is empty"&&(console.error(' SOLUTION: Your EmailJS template is missing the "To" field configuration.'),console.error("   Please go to your EmailJS dashboard and:"),console.error("   1. Open your email template"),console.error('   2. In the "To" field, add: {{customerEmail}}'),console.error("   3. Save the template"),console.error("   4. Try again")),{success:!1,error:o.text||o.message}}},yve=async(e="test@example.com")=>{if(console.log(" Testing EmailJS configuration..."),console.log(" EmailJS Config:",{serviceId:" Set",templateId:_n.templateId?" Set":" Missing",publicKey:" Set"}),!_n.templateId||!_n.publicKey)return console.error(" EmailJS not fully configured. Check your .env file."),!1;const t={customerEmail:e,to_name:"Test User",customerName:"Test User",bookingReference:"TEST-123",venueName:"Test Venue",bookingDate:new Date().toLocaleDateString(),bookingTime:"19:00",partySize:"2",totalAmount:"5000"};console.log(" Sending test with params:",t);try{const r=await Ws.send(_n.serviceId,_n.templateId,t);return console.log(" Test email sent successfully!",r),!0}catch(r){return console.error(" Test email failed:",r),console.error("Error details:",{status:r.status,text:r.text,message:r.message}),r.text==="The recipients address is empty"&&(console.error(' SOLUTION: Your EmailJS template needs {{customerEmail}} in the "To" field'),console.error("   Go to EmailJS Dashboard  Templates  Edit your template"),console.error('   In the "To" field, make sure it says: {{customerEmail}}')),!1}};typeof window<"u"&&(window.quickEmailTest=mve,window.testEmailService=pve,window.testEmailJSNow=yve);const vve=async(e="venue-owner-invitation",t={})=>{try{console.log(" Testing Edge Function email with template:",e),console.log(" Test data:",t);const{data:r,error:n}=await Ve.functions.invoke("send-email",{body:{template:e,data:{email:t.email||"test@example.com",venueName:t.venueName||"Test Venue",contactName:t.contactName||"Test Owner",venueType:t.venueType||"Restaurant",ownerName:t.ownerName||"Test Owner",venueAddress:t.venueAddress||"Test Address",venueCity:t.venueCity||"Lagos"}}});return n?(console.error(" Edge Function error:",n),console.error("Error details:",{message:n.message,status:n.status,name:n.name}),{success:!1,error:n.message}):(console.log(" Edge Function email test successful:",r),{success:!0,data:r})}catch(r){return console.error(" Error testing Edge Function email:",r),{success:!1,error:r.message}}};typeof window<"u"&&(window.testEdgeFunctionEmail=vve);const xve=async(e="test@example.com")=>{console.log(" Testing EmailJS on localhost...");const t={serviceId:"service_55v7svp",templateId:"template_wh2h7sn",publicKey:"_DltRvDA4UAiyUt1E"};console.log(" EmailJS Config:",{serviceId:" Set",templateId:" Set",publicKey:" Set"});try{Ws.init(t.publicKey);const r={to_email:e,to_name:"Test User",from_name:"Eddys Members Test",subject:"Localhost Email Test",message:"This is a test email from localhost to verify EmailJS is working.",venue_name:"Test Venue",owner_name:"Test Owner",application_date:new Date().toLocaleDateString()};console.log(" Sending test email with params:",r);const n=await Ws.send(t.serviceId,t.templateId,r);return console.log(" Localhost email test successful:",n),{success:!0,result:n}}catch(r){return console.error(" Localhost email test failed:",r),console.error("Error details:",{status:r.status,text:r.text,message:r.message}),{success:!1,error:r.text||r.message}}};typeof window<"u"&&(window.testLocalhostEmail=xve);const NC=()=>{var ke,Ne,Be,We,ut;const{id:e}=uE(),t=ts(),r=Gl(),{toast:n}=Ui(),{user:i}=Pd(),o=r.pathname.includes("/deposit"),h=(ke=r.state)==null?void 0:ke.depositAmount,[s,p]=I.useState(null),[y,b]=I.useState(!0),[_,E]=I.useState({fullName:"",email:"",phone:"",password:"",cardNumber:"",expiryDate:"",cvv:"",agreeToTerms:!1,referralCode:""}),[C,k]=I.useState(null),[N,O]=I.useState({}),[R,L]=I.useState(!1),[B,q]=I.useState(!1),[F,H]=I.useState([]);I.useState(null),I.useState("card"),I.useState(1),I.useState([]),I.useState([]);const[Z,re]=I.useState(!1),[W,te]=I.useState([]);I.useEffect(()=>{(async()=>{if(i)try{const{data:Pt,error:It}=await Ve.from("profiles").select("*").eq("id",i.id).single();It&&It.code!=="PGRST116"?console.error("Error fetching user profile:",It):Pt&&(k(Pt),E(at=>{var Ut,ct;return{...at,fullName:`${Pt.first_name||""} ${Pt.last_name||""}`.trim()||((Ut=i.user_metadata)==null?void 0:Ut.full_name)||"",email:i.email||"",phone:Pt.phone||((ct=i.user_metadata)==null?void 0:ct.phone)||""}}))}catch(Pt){console.error("Error fetching user profile:",Pt)}})()},[i]),I.useEffect(()=>{var Pt;console.log("CheckoutPage useEffect triggered"),console.log("isDepositFlow:",o),console.log("id from params:",e),console.log("location.pathname:",r.pathname),console.log("location.state:",r.state);const nt=(Pt=r.state)==null?void 0:Pt.creditPurchase;if(o){if(!h){console.log("No deposit amount, redirecting to profile"),t("/profile");return}p({depositAmount:h,isDeposit:!0,venueName:"VIP Credit Deposit"})}else if(nt){console.log("Credit purchase flow detected");const{venueId:It,venueName:at,amount:Ut,purchaseAmount:ct,venue:gt}=r.state;p({isCreditPurchase:!0,venueId:It,venueName:at,creditAmount:Ut,purchaseAmount:ct,venue:gt})}else{if(!e){console.log("No venue ID provided, redirecting to venues"),t("/venues");return}const It=localStorage.getItem("lagosvibe_booking_selection");if(console.log("savedSelection from localStorage:",It),It){const at=JSON.parse(It);console.log("parsedSelection:",at),console.log("parsedSelection.venueId:",at.venueId),console.log("id from params:",e),console.log("Comparison result:",at.venueId===e),at.venueId===e?(console.log("Venue ID matches, setting selection"),p(at)):(console.log("Venue ID mismatch, redirecting to venue page"),t(`/venues/${e}`))}else console.log("No saved selection, redirecting to venue page"),t(`/venues/${e}`)}b(!1)},[e,t,o,h,r.state]);const oe=nt=>{const{name:Pt,value:It,type:at,checked:Ut}=nt.target;E(ct=>({...ct,[Pt]:at==="checkbox"?Ut:It})),N[Pt]&&O(ct=>({...ct,[Pt]:null}))},ie=nt=>nt==="VIP2025"?(n({title:"Referral code applied!",description:"You've unlocked 10% off!"}),H(Pt=>[...Pt,"10% Discount Applied"]),!0):(n({title:"Invalid referral code",variant:"destructive"}),!1),ue=async nt=>{var Ut,ct,gt;let Pt,It,at;try{if(nt.dbRecord?Pt=nt.dbRecord:Pt={id:nt.bookingId||nt.id,booking_date:nt.bookingDate||new Date().toISOString(),booking_time:s.time||"19:00:00",guest_count:s.guests||s.guestCount||2,table_number:((Ut=s.table)==null?void 0:Ut.name)||((ct=s.table)==null?void 0:ct.table_number),total_amount:nt.totalAmount,status:"confirmed"},Pt.venue_id){const{data:rr,error:ir}=await Ve.from("venues").select("*").eq("id",Pt.venue_id).single();!ir&&rr?It=rr:(console.warn("Could not fetch venue data, using fallback:",ir),It={name:nt.venueName||s.venueName,address:s.venueAddress||"Lagos, Nigeria",contact_phone:s.venuePhone||"+234 XXX XXX XXXX",contact_email:s.venueEmail||"info@oneeddy.com",images:s.venueImage?[s.venueImage]:[],dress_code:"Smart casual"})}else It={name:nt.venueName||s.venueName,address:s.venueAddress||"Lagos, Nigeria",contact_phone:s.venuePhone||"+234 XXX XXX XXXX",contact_email:s.venueEmail||"info@oneeddy.com",images:s.venueImage?[s.venueImage]:[],dress_code:"Smart casual"};at={full_name:nt.customerName||_.fullName,email:nt.customerEmail||_.email,phone:nt.customerPhone||_.phone};const it=await hve(Pt,It,at),rt=It.contact_email||s.ownerEmail||"info@oneeddy.com";return rt&&fve(Pt,It,at,{full_name:"Venue Owner",email:rt}).catch(ir=>console.log("Venue owner notification failed:",ir)),console.log(" Email service result:",it),!0}catch(it){if(console.error(" Failed to send booking emails:",it),(it.text==="The recipients address is empty"||(gt=it.message)!=null&&gt.includes("recipients address is empty"))&&Pt&&It&&at){console.log(" Running email debug function...");try{await gve(Pt,It,at)}catch(rt){console.error(" Debug function also failed:",rt)}}return!1}},_e=async nt=>{try{if(i){const{error:ct}=await Ve.from("profiles").upsert([{id:i.id,first_name:nt.fullName.split(" ")[0]||"",last_name:nt.fullName.split(" ").slice(1).join(" ")||"",phone:nt.phone}],{onConflict:"id"});return ct&&console.error("Error updating user profile:",ct),i}const{data:Pt,error:It}=await Ve.auth.signInWithPassword({email:nt.email,password:nt.password});if(Pt!=null&&Pt.user)return Pt.user;const{data:at,error:Ut}=await Ve.auth.signUp({email:nt.email,password:nt.password,options:{data:{full_name:nt.fullName,phone:nt.phone}}});if(Ut)throw Ut;if(at.user){const{error:ct}=await Ve.from("profiles").upsert([{id:at.user.id,first_name:nt.fullName.split(" ")[0]||"",last_name:nt.fullName.split(" ").slice(1).join(" ")||"",phone:nt.phone}],{onConflict:"id"});ct&&console.error("Error creating user profile:",ct)}return at.user}catch(Pt){throw console.error("Error with user account:",Pt),Pt}},xe=async nt=>{var It;nt.preventDefault();const Pt=$ye(_,!!i);if(O(Pt),Object.keys(Pt).length===0){L(!0);try{_.referralCode&&ie(_.referralCode);const at=await _e({fullName:_.fullName,email:_.email,phone:_.phone,password:_.password});if(s.isCreditPurchase){const{data:Sr,error:tn}=await Ve.from("venue_credits").insert([{user_id:at==null?void 0:at.id,venue_id:s.venueId,amount:s.creditAmount*100,notes:`Credit purchase for ${s.venueName}`,status:"active"}]).select().single();if(tn)throw new Error(`Failed to create venue credits: ${tn.message}`);n({title:"Credits Purchased Successfully! ",description:`${s.creditAmount.toLocaleString()} credits added to your ${s.venueName} account`,className:"bg-green-500 text-white"}),setTimeout(()=>{t("/profile",{state:{activeTab:"wallet"}})},2e3);return}const Ut={user_id:at==null?void 0:at.id,venue_id:s.venueId||s.id,table_id:((It=s.table)==null?void 0:It.id)||null,booking_date:s.date||new Date().toISOString().split("T")[0],start_time:s.time||"19:00:00",end_time:s.endTime||"23:00:00",number_of_guests:s.guests||s.guestCount||2,status:"confirmed",total_amount:parseFloat(be())},{data:ct,error:gt}=await Ve.from("bookings").insert([Ut]).select().single();if(gt)throw new Error(`Failed to create booking: ${gt.message}`);const it={id:ct.id,...s,customerName:_.fullName,customerEmail:_.email,customerPhone:_.phone,userId:at==null?void 0:at.id,bookingDate:new Date().toISOString(),status:"confirmed",referralCode:_.referralCode,vipPerksApplied:F,totalAmount:be(),dbRecord:ct},rt=JSON.parse(localStorage.getItem("lagosvibe_bookings")||"[]");rt.push(it),localStorage.setItem("lagosvibe_bookings",JSON.stringify(rt)),localStorage.removeItem("lagosvibe_booking_selection");const rr=await ue({...it,bookingId:ct.id,venueName:s.venueName||s.name}),ir=["Free Welcome Drink","Priority Queue"];localStorage.setItem("lagosvibe_vip_perks",JSON.stringify(ir));const or=!i;n({title:or?"Account Created & Booking Confirmed!":"Booking Confirmed!",description:rr?or?"Welcome to VIPClub! Check your email for confirmation.":"Your booking is confirmed! Check your email for confirmation.":or?"Welcome to VIPClub! Your booking is confirmed. You can view details in your profile.":"Your booking is confirmed. You can view details in your profile.",className:"bg-green-500 text-white"}),rr||setTimeout(()=>{n({title:"Email Notification",description:"Confirmation email could not be sent, but your booking is saved. You can view it in your profile.",variant:"default"})},3e3),q(!0)}catch(at){console.error("Error processing booking:",at),n({title:"Booking Error",description:at.message||"There was an error processing your booking. Please try again.",variant:"destructive"})}finally{L(!1)}}else n({title:"Form validation failed",description:"Please check the form and fix the errors.",variant:"destructive"})},be=()=>{var Pt,It;if(o&&h)return h.toFixed(2);if(s!=null&&s.isCreditPurchase)return s.purchaseAmount.toFixed(2);if(!s)return 0;let nt=(((Pt=s.ticket)==null?void 0:Pt.price)||0)+(((It=s.table)==null?void 0:It.price)||0)+25;return F.includes("10% Discount Applied")&&(nt*=.9),nt.toFixed(2)},Ae=nt=>{navigator.clipboard.writeText(nt),n({title:"Link copied!",description:"Share this link with your friends to collect payment."})},me=nt=>{te(nt),re(!0)};return y?l.jsx("div",{className:"container py-20 text-center",children:l.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[l.jsx("div",{className:"h-8 w-64 bg-secondary rounded mb-4"}),l.jsx("div",{className:"h-4 w-48 bg-secondary rounded"})]})}):s?l.jsxs("div",{className:"container py-10",children:[l.jsxs(Nn,{to:o?"/profile":(We=r.state)!=null&&We.creditPurchase?"/venue-credit-purchase":`/venues/${e}`,className:"inline-flex items-center text-sm text-muted-foreground hover:text-primary mb-6",children:[l.jsx(gE,{className:"mr-2 h-4 w-4"}),o?"Back to Profile":(ut=r.state)!=null&&ut.creditPurchase?"Back to Credit Purchase":"Back to Venue"]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[l.jsx("div",{className:"lg:col-span-2",children:l.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[l.jsxs("h1",{className:"text-3xl font-bold mb-6 flex items-center",children:[l.jsx(Fc,{className:"h-8 w-8 mr-2"}),"Checkout"]}),l.jsxs(wg,{defaultValue:"single",className:"w-full mb-6",children:[l.jsxs(Sf,{className:"grid w-full grid-cols-2 mb-6",children:[l.jsx(Ci,{value:"single",children:"Single Payment"}),l.jsx(Ci,{value:"split",children:"Split Payment"})]}),l.jsxs(Pi,{value:"single",children:[l.jsx(Lye,{formData:_,errors:N,handleInputChange:oe,handleSubmit:xe,isSubmitting:R,totalAmount:be(),isAuthenticated:!!i,icons:{user:l.jsx(Kn,{className:"h-5 w-5 mr-2"})}}),l.jsx(xt,{type:"submit",disabled:R,className:"w-full bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90 py-3.5 text-lg rounded-md",children:R?l.jsxs("div",{className:"flex items-center justify-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-brand-cream mr-2"}),"Processing..."]}):`Pay ${be().toLocaleString()}`})]}),l.jsx(Pi,{value:"split",children:l.jsx(zye,{totalAmount:parseFloat(be()),onSplitCreated:me,user:C||i,bookingId:s==null?void 0:s.id,createBookingIfNeeded:async()=>{var at,Ut;if(s!=null&&s.id)return s.id;const nt={user_id:(at=C||i)==null?void 0:at.id,venue_id:s.venueId||s.id,table_id:((Ut=s.table)==null?void 0:Ut.id)||null,booking_date:s.date||new Date().toISOString().split("T")[0],start_time:s.time||"19:00:00",end_time:s.endTime||"23:00:00",number_of_guests:s.guests||s.guestCount||2,status:"pending",total_amount:parseFloat(be())},{data:Pt,error:It}=await Ve.from("bookings").insert([nt]).select().single();if(It)throw new Error(`Failed to create booking: ${It.message}`);return p(ct=>({...ct,id:Pt.id})),Pt.id}})})]})]})}),l.jsx("div",{children:l.jsx("div",{className:"sticky top-20",children:l.jsx(Bye,{selection:s,totalAmount:be(),vipPerks:F,icons:{calendar:l.jsx(ma,{className:"h-5 w-5 mr-2"}),clock:l.jsx(ml,{className:"h-5 w-5 mr-2"})}})})})]}),l.jsx(wd,{open:B,onOpenChange:q,children:l.jsxs(qc,{className:"sm:max-w-md","aria-describedby":"checkout-dialog-desc",children:[l.jsx("div",{id:"checkout-dialog-desc",className:"sr-only",children:"Enter your payment details to complete your booking."}),l.jsxs(Wc,{children:[l.jsx(Gc,{className:"text-center text-2xl",children:"Booking Confirmed!"}),l.jsxs(A9,{className:"text-center",children:[l.jsx("div",{className:"flex justify-center my-6",children:l.jsx("div",{className:"w-16 h-16 bg-primary/20 rounded-full flex items-center justify-center",children:l.jsx(tm,{className:"h-8 w-8 text-primary"})})}),l.jsxs("p",{className:"mb-2",children:["Your booking at ",l.jsx("span",{className:"font-bold",children:s.venueName})," has been confirmed."]}),F.length>0&&l.jsxs("div",{className:"my-2 text-sm text-green-400",children:[l.jsx("p",{className:"font-semibold",children:"VIP Perks Applied:"}),l.jsx("ul",{className:"list-disc list-inside",children:F.map(nt=>l.jsx("li",{children:nt},nt))})]}),l.jsxs("p",{className:"text-sm",children:["A confirmation email has been sent to ",_.email,". You can show this email or your ID at the entrance."]})]})]}),l.jsx("div",{className:"flex justify-center mt-4",children:l.jsx(Nn,{to:"/",children:l.jsx(xt,{className:"bg-gradient-to-r from-primary to-accent hover:opacity-90 transition-opacity text-accent-foreground",children:"Back to Home"})})})]})}),l.jsx(wd,{open:Z,onOpenChange:re,children:l.jsxs(qc,{"aria-describedby":"checkout-dialog-desc-2",children:[l.jsx("div",{id:"checkout-dialog-desc-2",className:"sr-only",children:"View and manage your split payment requests."}),l.jsx(Wc,{children:l.jsx(Gc,{children:"Split Payment Requests Sent"})}),l.jsxs("div",{className:"space-y-4",children:[W.length>0?W.map((nt,Pt)=>l.jsxs("div",{className:"border rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 bg-brand-burgundy/10 rounded-full flex items-center justify-center",children:l.jsx(Kn,{className:"h-4 w-4 text-brand-burgundy"})}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-medium",children:["Recipient ",Pt+1]}),l.jsx("div",{className:"text-sm text-muted-foreground",children:nt.recipient_phone})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"font-bold",children:["",nt.amount.toLocaleString()]}),l.jsx(Yr,{variant:"outline",className:"text-xs",children:nt.status})]})]}),l.jsx("div",{className:"flex items-center gap-2 mt-3",children:l.jsxs(xt,{variant:"outline",size:"sm",onClick:()=>Ae(nt.payment_link),className:"flex-1",children:[l.jsx(jie,{className:"h-4 w-4 mr-2"}),"Copy Payment Link"]})})]},nt.id)):l.jsx("div",{className:"text-center py-8 text-muted-foreground",children:l.jsx("p",{children:"No split payment requests created yet."})}),l.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[l.jsx(xt,{variant:"outline",onClick:()=>re(!1),children:"Close"}),l.jsx(xt,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",onClick:()=>{re(!1),t("/bookings")},children:"View All Bookings"})]})]})]})})]}):l.jsxs("div",{className:"container py-20 text-center",children:[l.jsx("h2",{className:"text-2xl font-bold mb-4",children:"No Selection Found"}),l.jsx("p",{className:"text-muted-foreground mb-6",children:"Please go back and select a ticket or table first."}),l.jsx(Nn,{to:o?"/profile":(Ne=r.state)!=null&&Ne.creditPurchase?"/venue-credit-purchase":`/venues/${e}`,children:l.jsx(xt,{children:o?"Back to Profile":(Be=r.state)!=null&&Be.creditPurchase?"Back to Credit Purchase":"Back to Venue"})})]})};function W1(e){"@babel/helpers - typeof";return W1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W1(e)}function pl(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function vi(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function Ks(e){vi(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||W1(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function bve(e,t){vi(2,arguments);var r=Ks(e),n=pl(t);if(isNaN(n))return new Date(NaN);if(!n)return r;var i=r.getDate(),o=new Date(r.getTime());o.setMonth(r.getMonth()+n+1,0);var h=o.getDate();return i>=h?o:(r.setFullYear(o.getFullYear(),o.getMonth(),i),r)}function _ve(e,t){vi(2,arguments);var r=Ks(e).getTime(),n=pl(t);return new Date(r+n)}var wve={};function Eg(){return wve}function kC(e,t){var r,n,i,o,h,s,p,y;vi(1,arguments);var b=Eg(),_=pl((r=(n=(i=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(h=t.locale)===null||h===void 0||(s=h.options)===null||s===void 0?void 0:s.weekStartsOn)!==null&&i!==void 0?i:b.weekStartsOn)!==null&&n!==void 0?n:(p=b.locale)===null||p===void 0||(y=p.options)===null||y===void 0?void 0:y.weekStartsOn)!==null&&r!==void 0?r:0);if(!(_>=0&&_<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var E=Ks(e),C=E.getDay(),k=(C<_?7:0)+C-_;return E.setDate(E.getDate()-k),E.setHours(0,0,0,0),E}function Sve(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function Eve(e){return vi(1,arguments),e instanceof Date||W1(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Tve(e){if(vi(1,arguments),!Eve(e)&&typeof e!="number")return!1;var t=Ks(e);return!isNaN(Number(t))}function gw(e){vi(1,arguments);var t=Ks(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function yw(e){vi(1,arguments);var t=Ks(e);return t.setDate(1),t.setHours(0,0,0,0),t}function MC(e,t){var r,n,i,o,h,s,p,y;vi(1,arguments);var b=Eg(),_=pl((r=(n=(i=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(h=t.locale)===null||h===void 0||(s=h.options)===null||s===void 0?void 0:s.weekStartsOn)!==null&&i!==void 0?i:b.weekStartsOn)!==null&&n!==void 0?n:(p=b.locale)===null||p===void 0||(y=p.options)===null||y===void 0?void 0:y.weekStartsOn)!==null&&r!==void 0?r:0);if(!(_>=0&&_<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var E=Ks(e),C=E.getDay(),k=(C<_?-7:0)+6-(C-_);return E.setDate(E.getDate()+k),E.setHours(23,59,59,999),E}function jve(e,t){vi(2,arguments);var r=pl(t);return _ve(e,-r)}var Cve=864e5;function Pve(e){vi(1,arguments);var t=Ks(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var n=t.getTime(),i=r-n;return Math.floor(i/Cve)+1}function G1(e){vi(1,arguments);var t=1,r=Ks(e),n=r.getUTCDay(),i=(n<t?7:0)+n-t;return r.setUTCDate(r.getUTCDate()-i),r.setUTCHours(0,0,0,0),r}function nH(e){vi(1,arguments);var t=Ks(e),r=t.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var i=G1(n),o=new Date(0);o.setUTCFullYear(r,0,4),o.setUTCHours(0,0,0,0);var h=G1(o);return t.getTime()>=i.getTime()?r+1:t.getTime()>=h.getTime()?r:r-1}function Ave(e){vi(1,arguments);var t=nH(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var n=G1(r);return n}var Nve=6048e5;function kve(e){vi(1,arguments);var t=Ks(e),r=G1(t).getTime()-Ave(t).getTime();return Math.round(r/Nve)+1}function H1(e,t){var r,n,i,o,h,s,p,y;vi(1,arguments);var b=Eg(),_=pl((r=(n=(i=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(h=t.locale)===null||h===void 0||(s=h.options)===null||s===void 0?void 0:s.weekStartsOn)!==null&&i!==void 0?i:b.weekStartsOn)!==null&&n!==void 0?n:(p=b.locale)===null||p===void 0||(y=p.options)===null||y===void 0?void 0:y.weekStartsOn)!==null&&r!==void 0?r:0);if(!(_>=0&&_<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var E=Ks(e),C=E.getUTCDay(),k=(C<_?7:0)+C-_;return E.setUTCDate(E.getUTCDate()-k),E.setUTCHours(0,0,0,0),E}function iH(e,t){var r,n,i,o,h,s,p,y;vi(1,arguments);var b=Ks(e),_=b.getUTCFullYear(),E=Eg(),C=pl((r=(n=(i=(o=t==null?void 0:t.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(h=t.locale)===null||h===void 0||(s=h.options)===null||s===void 0?void 0:s.firstWeekContainsDate)!==null&&i!==void 0?i:E.firstWeekContainsDate)!==null&&n!==void 0?n:(p=E.locale)===null||p===void 0||(y=p.options)===null||y===void 0?void 0:y.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(C>=1&&C<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var k=new Date(0);k.setUTCFullYear(_+1,0,C),k.setUTCHours(0,0,0,0);var N=H1(k,t),O=new Date(0);O.setUTCFullYear(_,0,C),O.setUTCHours(0,0,0,0);var R=H1(O,t);return b.getTime()>=N.getTime()?_+1:b.getTime()>=R.getTime()?_:_-1}function Mve(e,t){var r,n,i,o,h,s,p,y;vi(1,arguments);var b=Eg(),_=pl((r=(n=(i=(o=t==null?void 0:t.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(h=t.locale)===null||h===void 0||(s=h.options)===null||s===void 0?void 0:s.firstWeekContainsDate)!==null&&i!==void 0?i:b.firstWeekContainsDate)!==null&&n!==void 0?n:(p=b.locale)===null||p===void 0||(y=p.options)===null||y===void 0?void 0:y.firstWeekContainsDate)!==null&&r!==void 0?r:1),E=iH(e,t),C=new Date(0);C.setUTCFullYear(E,0,_),C.setUTCHours(0,0,0,0);var k=H1(C,t);return k}var Ive=6048e5;function Ove(e,t){vi(1,arguments);var r=Ks(e),n=H1(r,t).getTime()-Mve(r,t).getTime();return Math.round(n/Ive)+1}function bn(e,t){for(var r=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return r+n}var Rve={y:function(t,r){var n=t.getUTCFullYear(),i=n>0?n:1-n;return bn(r==="yy"?i%100:i,r.length)},M:function(t,r){var n=t.getUTCMonth();return r==="M"?String(n+1):bn(n+1,2)},d:function(t,r){return bn(t.getUTCDate(),r.length)},a:function(t,r){var n=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(t,r){return bn(t.getUTCHours()%12||12,r.length)},H:function(t,r){return bn(t.getUTCHours(),r.length)},m:function(t,r){return bn(t.getUTCMinutes(),r.length)},s:function(t,r){return bn(t.getUTCSeconds(),r.length)},S:function(t,r){var n=r.length,i=t.getUTCMilliseconds(),o=Math.floor(i*Math.pow(10,n-3));return bn(o,r.length)}};const Ru=Rve;var Dp={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Dve={G:function(t,r,n){var i=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(t,r,n){if(r==="yo"){var i=t.getUTCFullYear(),o=i>0?i:1-i;return n.ordinalNumber(o,{unit:"year"})}return Ru.y(t,r)},Y:function(t,r,n,i){var o=iH(t,i),h=o>0?o:1-o;if(r==="YY"){var s=h%100;return bn(s,2)}return r==="Yo"?n.ordinalNumber(h,{unit:"year"}):bn(h,r.length)},R:function(t,r){var n=nH(t);return bn(n,r.length)},u:function(t,r){var n=t.getUTCFullYear();return bn(n,r.length)},Q:function(t,r,n){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(i);case"QQ":return bn(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,r,n){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(i);case"qq":return bn(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,r,n){var i=t.getUTCMonth();switch(r){case"M":case"MM":return Ru.M(t,r);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(t,r,n){var i=t.getUTCMonth();switch(r){case"L":return String(i+1);case"LL":return bn(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(t,r,n,i){var o=Ove(t,i);return r==="wo"?n.ordinalNumber(o,{unit:"week"}):bn(o,r.length)},I:function(t,r,n){var i=kve(t);return r==="Io"?n.ordinalNumber(i,{unit:"week"}):bn(i,r.length)},d:function(t,r,n){return r==="do"?n.ordinalNumber(t.getUTCDate(),{unit:"date"}):Ru.d(t,r)},D:function(t,r,n){var i=Pve(t);return r==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):bn(i,r.length)},E:function(t,r,n){var i=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(t,r,n,i){var o=t.getUTCDay(),h=(o-i.weekStartsOn+8)%7||7;switch(r){case"e":return String(h);case"ee":return bn(h,2);case"eo":return n.ordinalNumber(h,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});case"eeee":default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(t,r,n,i){var o=t.getUTCDay(),h=(o-i.weekStartsOn+8)%7||7;switch(r){case"c":return String(h);case"cc":return bn(h,r.length);case"co":return n.ordinalNumber(h,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});case"cccc":default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(t,r,n){var i=t.getUTCDay(),o=i===0?7:i;switch(r){case"i":return String(o);case"ii":return bn(o,r.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(t,r,n){var i=t.getUTCHours(),o=i/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(t,r,n){var i=t.getUTCHours(),o;switch(i===12?o=Dp.noon:i===0?o=Dp.midnight:o=i/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(t,r,n){var i=t.getUTCHours(),o;switch(i>=17?o=Dp.evening:i>=12?o=Dp.afternoon:i>=4?o=Dp.morning:o=Dp.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(t,r,n){if(r==="ho"){var i=t.getUTCHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return Ru.h(t,r)},H:function(t,r,n){return r==="Ho"?n.ordinalNumber(t.getUTCHours(),{unit:"hour"}):Ru.H(t,r)},K:function(t,r,n){var i=t.getUTCHours()%12;return r==="Ko"?n.ordinalNumber(i,{unit:"hour"}):bn(i,r.length)},k:function(t,r,n){var i=t.getUTCHours();return i===0&&(i=24),r==="ko"?n.ordinalNumber(i,{unit:"hour"}):bn(i,r.length)},m:function(t,r,n){return r==="mo"?n.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):Ru.m(t,r)},s:function(t,r,n){return r==="so"?n.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):Ru.s(t,r)},S:function(t,r){return Ru.S(t,r)},X:function(t,r,n,i){var o=i._originalDate||t,h=o.getTimezoneOffset();if(h===0)return"Z";switch(r){case"X":return uz(h);case"XXXX":case"XX":return Oh(h);case"XXXXX":case"XXX":default:return Oh(h,":")}},x:function(t,r,n,i){var o=i._originalDate||t,h=o.getTimezoneOffset();switch(r){case"x":return uz(h);case"xxxx":case"xx":return Oh(h);case"xxxxx":case"xxx":default:return Oh(h,":")}},O:function(t,r,n,i){var o=i._originalDate||t,h=o.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+cz(h,":");case"OOOO":default:return"GMT"+Oh(h,":")}},z:function(t,r,n,i){var o=i._originalDate||t,h=o.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+cz(h,":");case"zzzz":default:return"GMT"+Oh(h,":")}},t:function(t,r,n,i){var o=i._originalDate||t,h=Math.floor(o.getTime()/1e3);return bn(h,r.length)},T:function(t,r,n,i){var o=i._originalDate||t,h=o.getTime();return bn(h,r.length)}};function cz(e,t){var r=e>0?"-":"+",n=Math.abs(e),i=Math.floor(n/60),o=n%60;if(o===0)return r+String(i);var h=t||"";return r+String(i)+h+bn(o,2)}function uz(e,t){if(e%60===0){var r=e>0?"-":"+";return r+bn(Math.abs(e)/60,2)}return Oh(e,t)}function Oh(e,t){var r=t||"",n=e>0?"-":"+",i=Math.abs(e),o=bn(Math.floor(i/60),2),h=bn(i%60,2);return n+o+r+h}const Lve=Dve;var dz=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},sH=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},Bve=function(t,r){var n=t.match(/(P+)(p+)?/)||[],i=n[1],o=n[2];if(!o)return dz(t,r);var h;switch(i){case"P":h=r.dateTime({width:"short"});break;case"PP":h=r.dateTime({width:"medium"});break;case"PPP":h=r.dateTime({width:"long"});break;case"PPPP":default:h=r.dateTime({width:"full"});break}return h.replace("{{date}}",dz(i,r)).replace("{{time}}",sH(o,r))},zve={p:sH,P:Bve};const $ve=zve;var Fve=["D","DD"],Uve=["YY","YYYY"];function Vve(e){return Fve.indexOf(e)!==-1}function qve(e){return Uve.indexOf(e)!==-1}function hz(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var Wve={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Gve=function(t,r,n){var i,o=Wve[t];return typeof o=="string"?i=o:r===1?i=o.one:i=o.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};const Hve=Gve;function IC(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,n=e.formats[r]||e.formats[e.defaultWidth];return n}}var Xve={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Kve={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Zve={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Yve={date:IC({formats:Xve,defaultWidth:"full"}),time:IC({formats:Kve,defaultWidth:"full"}),dateTime:IC({formats:Zve,defaultWidth:"full"})};const Jve=Yve;var Qve={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},exe=function(t,r,n,i){return Qve[t]};const txe=exe;function Nv(e){return function(t,r){var n=r!=null&&r.context?String(r.context):"standalone",i;if(n==="formatting"&&e.formattingValues){var o=e.defaultFormattingWidth||e.defaultWidth,h=r!=null&&r.width?String(r.width):o;i=e.formattingValues[h]||e.formattingValues[o]}else{var s=e.defaultWidth,p=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[p]||e.values[s]}var y=e.argumentCallback?e.argumentCallback(t):t;return i[y]}}var rxe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},nxe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},ixe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},sxe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},axe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},oxe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},lxe=function(t,r){var n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},cxe={ordinalNumber:lxe,era:Nv({values:rxe,defaultWidth:"wide"}),quarter:Nv({values:nxe,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Nv({values:ixe,defaultWidth:"wide"}),day:Nv({values:sxe,defaultWidth:"wide"}),dayPeriod:Nv({values:axe,defaultWidth:"wide",formattingValues:oxe,defaultFormattingWidth:"wide"})};const uxe=cxe;function kv(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],o=t.match(i);if(!o)return null;var h=o[0],s=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],p=Array.isArray(s)?hxe(s,function(_){return _.test(h)}):dxe(s,function(_){return _.test(h)}),y;y=e.valueCallback?e.valueCallback(p):p,y=r.valueCallback?r.valueCallback(y):y;var b=t.slice(h.length);return{value:y,rest:b}}}function dxe(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function hxe(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function fxe(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var i=n[0],o=t.match(e.parsePattern);if(!o)return null;var h=e.valueCallback?e.valueCallback(o[0]):o[0];h=r.valueCallback?r.valueCallback(h):h;var s=t.slice(i.length);return{value:h,rest:s}}}var pxe=/^(\d+)(th|st|nd|rd)?/i,mxe=/\d+/i,gxe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},yxe={any:[/^b/i,/^(a|c)/i]},vxe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},xxe={any:[/1/i,/2/i,/3/i,/4/i]},bxe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},_xe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},wxe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Sxe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Exe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Txe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},jxe={ordinalNumber:fxe({matchPattern:pxe,parsePattern:mxe,valueCallback:function(t){return parseInt(t,10)}}),era:kv({matchPatterns:gxe,defaultMatchWidth:"wide",parsePatterns:yxe,defaultParseWidth:"any"}),quarter:kv({matchPatterns:vxe,defaultMatchWidth:"wide",parsePatterns:xxe,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:kv({matchPatterns:bxe,defaultMatchWidth:"wide",parsePatterns:_xe,defaultParseWidth:"any"}),day:kv({matchPatterns:wxe,defaultMatchWidth:"wide",parsePatterns:Sxe,defaultParseWidth:"any"}),dayPeriod:kv({matchPatterns:Exe,defaultMatchWidth:"any",parsePatterns:Txe,defaultParseWidth:"any"})};const Cxe=jxe;var Pxe={code:"en-US",formatDistance:Hve,formatLong:Jve,formatRelative:txe,localize:uxe,match:Cxe,options:{weekStartsOn:0,firstWeekContainsDate:1}};const Axe=Pxe;var Nxe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,kxe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Mxe=/^'([^]*?)'?$/,Ixe=/''/g,Oxe=/[a-zA-Z]/;function Yx(e,t,r){var n,i,o,h,s,p,y,b,_,E,C,k,N,O,R,L,B,q;vi(2,arguments);var F=String(t),H=Eg(),Z=(n=(i=r==null?void 0:r.locale)!==null&&i!==void 0?i:H.locale)!==null&&n!==void 0?n:Axe,re=pl((o=(h=(s=(p=r==null?void 0:r.firstWeekContainsDate)!==null&&p!==void 0?p:r==null||(y=r.locale)===null||y===void 0||(b=y.options)===null||b===void 0?void 0:b.firstWeekContainsDate)!==null&&s!==void 0?s:H.firstWeekContainsDate)!==null&&h!==void 0?h:(_=H.locale)===null||_===void 0||(E=_.options)===null||E===void 0?void 0:E.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(re>=1&&re<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var W=pl((C=(k=(N=(O=r==null?void 0:r.weekStartsOn)!==null&&O!==void 0?O:r==null||(R=r.locale)===null||R===void 0||(L=R.options)===null||L===void 0?void 0:L.weekStartsOn)!==null&&N!==void 0?N:H.weekStartsOn)!==null&&k!==void 0?k:(B=H.locale)===null||B===void 0||(q=B.options)===null||q===void 0?void 0:q.weekStartsOn)!==null&&C!==void 0?C:0);if(!(W>=0&&W<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!Z.localize)throw new RangeError("locale must contain localize property");if(!Z.formatLong)throw new RangeError("locale must contain formatLong property");var te=Ks(e);if(!Tve(te))throw new RangeError("Invalid time value");var oe=Sve(te),ie=jve(te,oe),ue={firstWeekContainsDate:re,weekStartsOn:W,locale:Z,_originalDate:te},_e=F.match(kxe).map(function(xe){var be=xe[0];if(be==="p"||be==="P"){var Ae=$ve[be];return Ae(xe,Z.formatLong)}return xe}).join("").match(Nxe).map(function(xe){if(xe==="''")return"'";var be=xe[0];if(be==="'")return Rxe(xe);var Ae=Lve[be];if(Ae)return!(r!=null&&r.useAdditionalWeekYearTokens)&&qve(xe)&&hz(xe,t,String(e)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&Vve(xe)&&hz(xe,t,String(e)),Ae(ie,xe,Z.localize,ue);if(be.match(Oxe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+be+"`");return xe}).join("");return _e}function Rxe(e){var t=e.match(Mxe);return t?t[1].replace(Ixe,"'"):e}function jh(e,t){vi(2,arguments);var r=pl(t);return bve(e,-r)}const aH=je.forwardRef(({className:e,...t},r)=>l.jsx("div",{className:"relative w-full overflow-auto",children:l.jsx("table",{ref:r,className:Pr("w-full caption-bottom text-sm",e),...t})}));aH.displayName="Table";const oH=je.forwardRef(({className:e,...t},r)=>l.jsx("thead",{ref:r,className:Pr("[&_tr]:border-b",e),...t}));oH.displayName="TableHeader";const lH=je.forwardRef(({className:e,...t},r)=>l.jsx("tbody",{ref:r,className:Pr("[&_tr:last-child]:border-0",e),...t}));lH.displayName="TableBody";const Dxe=je.forwardRef(({className:e,...t},r)=>l.jsx("tfoot",{ref:r,className:Pr("bg-primary font-medium text-primary-foreground",e),...t}));Dxe.displayName="TableFooter";const QA=je.forwardRef(({className:e,...t},r)=>l.jsx("tr",{ref:r,className:Pr("border-b border-border/50 transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));QA.displayName="TableRow";const $u=je.forwardRef(({className:e,...t},r)=>l.jsx("th",{ref:r,className:Pr("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));$u.displayName="TableHead";const Fu=je.forwardRef(({className:e,...t},r)=>l.jsx("td",{ref:r,className:Pr("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Fu.displayName="TableCell";const Lxe=je.forwardRef(({className:e,...t},r)=>l.jsx("caption",{ref:r,className:Pr("mt-4 text-sm text-muted-foreground",e),...t}));Lxe.displayName="TableCaption";const cH=({currentUser:e})=>{const[t,r]=I.useState([]),[n,i]=I.useState(!0),o=I.useRef(null);I.useEffect(()=>(e&&p(),()=>{h()}),[e]);const h=()=>{o.current&&(console.log("Cleaning up BookingList real-time subscription..."),o.current.unsubscribe(),o.current=null)},s=async C=>{if(h(),!C||C.length===0){console.log("No venue IDs provided for BookingList subscription");return}console.log("Setting up BookingList real-time subscription for venues:",C);try{o.current=Ve.channel("booking-list-changes").on("postgres_changes",{event:"*",schema:"public",table:"bookings",filter:`venue_id=in.(${C.join(",")})`},k=>{console.log("Real-time booking change detected in BookingList:",k),k.eventType==="INSERT"&&Mr({title:"New Booking Received!",description:"A new booking has been received",className:"bg-green-50 border-green-200"}),setTimeout(()=>{p(!0)},1e3)}).subscribe(k=>{console.log("BookingList subscription status:",k),k==="SUBSCRIBED"&&console.log("Successfully subscribed to BookingList real-time updates")})}catch(k){console.error("Error setting up BookingList real-time subscription:",k)}},p=async(C=!1)=>{try{C||i(!0);const{data:k,error:N}=await Ve.from("venues").select("id").eq("owner_id",e.id);if(N)throw N;if(!k||k.length===0){r([]),C||i(!1);return}const O=k.map(H=>H.id);o.current||await s(O);const{data:R,error:L}=await Ve.from("bookings").select(`
          *,
          venues (
            id,
            name
          ),
          venue_tables!table_id (
            id,
            table_number
          )
        `).in("venue_id",O).order("created_at",{ascending:!1});if(L)throw L;const B=[...new Set(R==null?void 0:R.map(H=>H.user_id))].filter(Boolean),q={};if(B.length>0){const{data:H,error:Z}=await Ve.from("profiles").select("id, first_name, last_name, email, phone").in("id",B);!Z&&H&&H.forEach(re=>{q[re.id]=re})}const F=(R==null?void 0:R.map(H=>({...H,profiles:q[H.user_id]||null})))||[];r(F)}catch(k){console.error("Error fetching bookings:",k),C||Mr({title:"Error",description:"Failed to load bookings",variant:"destructive"})}finally{C||i(!1)}},y=async(C,k)=>{try{const{error:N}=await Ve.from("bookings").update({status:k,updated_at:new Date().toISOString()}).eq("id",C);if(N)throw N;r(O=>O.map(R=>R.id===C?{...R,status:k}:R)),Mr({title:"Success",description:`Booking ${k} successfully`,className:"bg-green-500 text-white"})}catch(N){console.error("Error updating booking status:",N),Mr({title:"Error",description:"Failed to update booking status",variant:"destructive"})}},b=C=>{switch(C){case"confirmed":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"completed":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},_=C=>C.profiles?`${C.profiles.first_name||""} ${C.profiles.last_name||""}`.trim():C.customerName||"Unknown Customer";if(n)return l.jsx("div",{className:"flex items-center justify-center p-8",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-gold"})});if(!t.length)return l.jsx("div",{className:"text-center p-8",children:l.jsx("p",{className:"text-brand-burgundy/70",children:"No bookings found."})});const E=({booking:C})=>{var k;return l.jsx(Mt,{className:"mb-4 border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-4",children:[l.jsxs("div",{className:"flex justify-between items-start mb-3",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-semibold text-brand-burgundy text-sm sm:text-base",children:_(C)}),l.jsxs("p",{className:"text-xs text-brand-burgundy/60",children:[Yx(new Date(C.booking_date),"MMM d, yyyy"),"  ",C.start_time," - ",C.end_time]})]}),l.jsx(Yr,{className:`${b(C.status)} text-xs`,children:C.status})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-brand-burgundy/60",children:"Table:"}),l.jsx("span",{className:"ml-1 font-medium",children:(k=C.venue_tables)!=null&&k.table_number?`Table ${C.venue_tables.table_number}`:"Not assigned"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-brand-burgundy/60",children:"Guests:"}),l.jsx("span",{className:"ml-1 font-medium",children:C.number_of_guests})]}),l.jsxs("div",{className:"col-span-2",children:[l.jsx("span",{className:"text-brand-burgundy/60",children:"Amount:"}),l.jsxs("span",{className:"ml-1 font-medium",children:["",(C.total_amount||0).toLocaleString()]})]})]}),l.jsxs("div",{className:"flex gap-2 pt-2 border-t border-brand-burgundy/10",children:[l.jsxs(xt,{variant:"ghost",size:"sm",className:"h-8 px-2 text-brand-burgundy/70 hover:text-brand-burgundy",children:[l.jsx(cl,{className:"h-3 w-3 mr-1"}),l.jsx("span",{className:"hidden sm:inline",children:"View"})]}),C.status==="pending"&&l.jsxs(l.Fragment,{children:[l.jsxs(xt,{variant:"ghost",size:"sm",className:"h-8 px-2 text-green-600 hover:text-green-700",onClick:()=>y(C.id,"confirmed"),children:[l.jsx(tm,{className:"h-3 w-3 mr-1"}),l.jsx("span",{className:"hidden sm:inline",children:"Confirm"})]}),l.jsxs(xt,{variant:"ghost",size:"sm",className:"h-8 px-2 text-red-600 hover:text-red-700",onClick:()=>y(C.id,"cancelled"),children:[l.jsx(Nm,{className:"h-3 w-3 mr-1"}),l.jsx("span",{className:"hidden sm:inline",children:"Cancel"})]})]}),C.status==="confirmed"&&l.jsxs(xt,{variant:"ghost",size:"sm",className:"h-8 px-2 text-blue-600 hover:text-blue-700",onClick:()=>y(C.id,"completed"),title:"Mark as completed",children:[l.jsx(tm,{className:"h-3 w-3 mr-1"}),l.jsx("span",{className:"hidden sm:inline",children:"Complete"})]})]})]})})};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-3 sm:space-y-0",children:[l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy",children:"Recent Bookings"}),l.jsx("div",{className:"flex gap-2",children:l.jsxs(xt,{variant:"outline",size:"sm",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",onClick:p,children:[l.jsx(kM,{className:"h-4 w-4 mr-1 sm:mr-2"}),l.jsx("span",{className:"hidden sm:inline",children:"Refresh"}),l.jsx("span",{className:"sm:hidden",children:"Refresh"})]})})]}),l.jsx("div",{className:"hidden lg:block",children:l.jsxs(aH,{children:[l.jsx(oH,{children:l.jsxs(QA,{children:[l.jsx($u,{children:"Customer"}),l.jsx($u,{children:"Date & Time"}),l.jsx($u,{children:"Table"}),l.jsx($u,{children:"Guests"}),l.jsx($u,{children:"Amount"}),l.jsx($u,{children:"Status"}),l.jsx($u,{children:"Actions"})]})}),l.jsx(lH,{children:t.map(C=>{var k;return l.jsxs(QA,{children:[l.jsx(Fu,{className:"font-medium",children:_(C)}),l.jsx(Fu,{children:l.jsxs("div",{children:[l.jsx("div",{children:Yx(new Date(C.booking_date),"MMM d, yyyy")}),l.jsxs("div",{className:"text-sm text-brand-burgundy/60",children:[C.start_time," - ",C.end_time]})]})}),l.jsx(Fu,{children:(k=C.venue_tables)!=null&&k.table_number?`Table ${C.venue_tables.table_number}`:"No table assigned"}),l.jsx(Fu,{children:C.number_of_guests}),l.jsxs(Fu,{children:["",(C.total_amount||0).toLocaleString()]}),l.jsx(Fu,{children:l.jsx(Yr,{className:b(C.status),children:C.status})}),l.jsx(Fu,{children:l.jsxs("div",{className:"flex gap-2",children:[l.jsx(xt,{variant:"ghost",size:"icon",className:"h-8 w-8",children:l.jsx(cl,{className:"h-4 w-4"})}),C.status==="pending"&&l.jsxs(l.Fragment,{children:[l.jsx(xt,{variant:"ghost",size:"icon",className:"h-8 w-8 text-green-600 hover:text-green-700",onClick:()=>y(C.id,"confirmed"),children:l.jsx(tm,{className:"h-4 w-4"})}),l.jsx(xt,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-600 hover:text-red-700",onClick:()=>y(C.id,"cancelled"),children:l.jsx(Nm,{className:"h-4 w-4"})})]}),C.status==="confirmed"&&l.jsx(xt,{variant:"ghost",size:"icon",className:"h-8 w-8 text-blue-600 hover:text-blue-700",onClick:()=>y(C.id,"completed"),title:"Mark as completed",children:l.jsx(tm,{className:"h-4 w-4"})})]})})]},C.id)})})]})}),l.jsx("div",{className:"lg:hidden space-y-2",children:t.map(C=>l.jsx(E,{booking:C},C.id))})]})},Bxe=({currentUser:e})=>{const[t,r]=I.useState(null),[n,i]=I.useState([]),[o,h]=I.useState(!1),[s,p]=I.useState(!0),[y,b]=I.useState(!1),[_,E]=I.useState(""),[C,k]=I.useState(!1);I.useEffect(()=>{e&&N()},[e]);const N=async()=>{try{p(!0);const{data:Z,error:re}=await Ve.from("venues").select("*").eq("owner_id",e.id).single();if(re){console.error("Error fetching venue:",re);return}r(Z);const{data:W,error:te}=await Ve.from("venue_images").select("*").eq("venue_id",Z.id).order("is_primary",{ascending:!1}).order("created_at",{ascending:!1});if(te){console.error("Error fetching images:",te);return}i(W||[])}catch(Z){console.error("Error in fetchVenueAndImages:",Z),Mr({title:"Error",description:"Failed to load venue images",variant:"destructive"})}finally{p(!1)}},O=async()=>{try{if(k(!0),!_.trim())throw new Error("Please enter an image URL");try{new URL(_)}catch{throw new Error("Please enter a valid URL")}const Z=new Image;await new Promise((te,oe)=>{Z.onload=te,Z.onerror=oe,Z.src=_});const{data:re,error:W}=await Ve.from("venue_images").insert([{venue_id:t.id,image_url:_,is_primary:n.length===0}]).select().single();if(W)throw W;i(te=>[re,...te]),E(""),Mr({title:"Success",description:"Image added successfully!",className:"bg-green-500 text-white"})}catch(Z){console.error("Error adding image from URL:",Z);let re="Failed to add image from URL";Z.message.includes("valid URL")?re="Please enter a valid image URL":Z.message.includes("load")?re="Could not load image from this URL. Please check the URL and try again.":Z.message&&(re=Z.message),Mr({title:"Failed to Add Image",description:re,variant:"destructive"})}finally{k(!1)}},R=async Z=>{var re,W,te,oe;if(!(!t||!Z))try{if(h(!0),!Z.type.startsWith("image/"))throw new Error("Please select an image file");if(Z.size>5*1024*1024)throw new Error("Image must be less than 5MB");const ie=Z.name.split(".").pop(),ue=`${t.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${ie}`,{data:_e,error:xe}=await Ve.storage.from("venue-images").upload(ue,Z,{cacheControl:"3600",upsert:!1});if(xe)throw xe;const{data:{publicUrl:be}}=Ve.storage.from("venue-images").getPublicUrl(ue),{data:Ae,error:me}=await Ve.from("venue_images").insert([{venue_id:t.id,image_url:be,is_primary:n.length===0}]).select().single();if(me)throw me;i(ke=>[Ae,...ke]),Mr({title:"Success",description:"Image uploaded successfully!",className:"bg-green-500 text-white"})}catch(ie){console.error("Error uploading image:",ie),console.error("Full error details:",{message:ie.message,name:ie.name,stack:ie.stack,details:ie});let ue="Failed to upload image. Please try again.";(re=ie.message)!=null&&re.includes("bucket")||(W=ie.message)!=null&&W.includes("Bucket")?ue="Storage bucket not configured. Please contact support or use URL upload instead.":(te=ie.message)!=null&&te.includes("policy")||(oe=ie.message)!=null&&oe.includes("permission")?ue="Permission denied. Storage bucket needs proper policies configured.":ie.message&&(ue=ie.message),Mr({title:"Upload Failed",description:ue,variant:"destructive"})}finally{h(!1)}},L=async(Z,re)=>{try{const W=re.split("/"),te=W[W.length-1],oe=`${t.id}/${te}`,{error:ie}=await Ve.storage.from("venue-images").remove([oe]);ie&&console.error("Storage deletion error:",ie);const{error:ue}=await Ve.from("venue_images").delete().eq("id",Z);if(ue)throw ue;i(_e=>_e.filter(xe=>xe.id!==Z)),Mr({title:"Success",description:"Image deleted successfully!",className:"bg-green-500 text-white"})}catch(W){console.error("Error deleting image:",W),Mr({title:"Error",description:"Failed to delete image. Please try again.",variant:"destructive"})}},B=async Z=>{try{const{error:re}=await Ve.from("venue_images").update({is_primary:!1}).eq("venue_id",t.id);if(re)throw re;const{error:W}=await Ve.from("venue_images").update({is_primary:!0}).eq("id",Z);if(W)throw W;i(te=>te.map(oe=>({...oe,is_primary:oe.id===Z}))),Mr({title:"Success",description:"Primary image updated!",className:"bg-green-500 text-white"})}catch(re){console.error("Error setting primary image:",re),Mr({title:"Error",description:"Failed to update primary image. Please try again.",variant:"destructive"})}},q=Z=>{Z.preventDefault(),Z.stopPropagation(),Z.type==="dragenter"||Z.type==="dragover"?b(!0):Z.type==="dragleave"&&b(!1)},F=Z=>{Z.preventDefault(),Z.stopPropagation(),b(!1),Z.dataTransfer.files&&Z.dataTransfer.files[0]&&R(Z.dataTransfer.files[0])},H=Z=>{Z.target.files&&Z.target.files[0]&&R(Z.target.files[0])};return s?l.jsx("div",{className:"flex items-center justify-center p-8",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-gold"})}):t?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-heading text-brand-burgundy",children:"Venue Images"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Upload and manage photos of your venue"})]}),l.jsxs("div",{className:"text-sm text-brand-burgundy/60",children:[n.length," image",n.length!==1?"s":""," uploaded"]})]}),l.jsx(Mt,{className:`border-2 border-dashed transition-colors ${y?"border-brand-gold bg-brand-gold/10":"border-brand-burgundy/20 hover:border-brand-gold/50"}`,children:l.jsx(Ht,{className:"p-8",children:l.jsxs("div",{className:"text-center",onDragEnter:q,onDragLeave:q,onDragOver:q,onDrop:F,children:[l.jsx(zie,{className:"h-12 w-12 mx-auto mb-4 text-brand-burgundy/40"}),l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"Upload Venue Images"}),l.jsx("p",{className:"text-brand-burgundy/70 mb-4",children:"Drag and drop images here, or click to select files from your device"}),l.jsx("p",{className:"text-sm text-brand-burgundy/50 mb-4",children:"Supports JPG, PNG, WebP  Max 5MB per image"}),l.jsx(Lt,{type:"file",accept:"image/*",onChange:H,className:"hidden",id:"image-upload",disabled:o}),l.jsx(Tt,{htmlFor:"image-upload",children:l.jsx(xt,{variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",disabled:o,asChild:!0,children:l.jsx("span",{children:o?"Uploading...":"Choose Images"})})})]})})}),l.jsx(Mt,{className:"border border-brand-burgundy/20",children:l.jsx(Ht,{className:"p-6",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"Add Image from URL"}),l.jsx("p",{className:"text-brand-burgundy/70 mb-4",children:"Alternative: Add an image by providing a direct image URL"}),l.jsxs("div",{className:"flex gap-2 max-w-md mx-auto",children:[l.jsx(Lt,{type:"url",placeholder:"https://example.com/image.jpg",value:_,onChange:Z=>E(Z.target.value),className:"flex-1",disabled:C}),l.jsx(xt,{onClick:O,disabled:C||!_.trim(),className:"bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:C?"Adding...":"Add Image"})]}),l.jsx("p",{className:"text-xs text-brand-burgundy/50 mt-2",children:"Use this option if file upload isn't working"})]})})}),n.length>0&&l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(Z=>l.jsx(Mt,{className:"overflow-hidden",children:l.jsxs("div",{className:"relative aspect-video",children:[l.jsx("img",{src:Z.image_url,alt:"Venue",className:"w-full h-full object-cover",onError:re=>{re.target.style.display="none",re.target.nextSibling.style.display="flex"}}),l.jsx("div",{className:"absolute inset-0 bg-gray-200 flex items-center justify-center text-gray-500 hidden",children:l.jsxs("div",{className:"text-center",children:[l.jsx(pA,{className:"h-8 w-8 mx-auto mb-2"}),l.jsx("p",{className:"text-sm",children:"Image failed to load"})]})}),Z.is_primary&&l.jsx("div",{className:"absolute top-2 left-2",children:l.jsx("span",{className:"bg-brand-gold text-brand-burgundy px-2 py-1 rounded text-xs font-semibold",children:"Primary"})}),l.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[l.jsx(xt,{size:"sm",variant:"secondary",className:"h-8 w-8 p-0 bg-white/80 hover:bg-white",onClick:()=>B(Z.id),disabled:Z.is_primary,children:Z.is_primary?l.jsx(Gs,{className:"h-4 w-4 text-brand-gold fill-current"}):l.jsx(Rie,{className:"h-4 w-4 text-brand-burgundy/60"})}),l.jsxs(wd,{children:[l.jsx(LI,{asChild:!0,children:l.jsx(xt,{size:"sm",variant:"destructive",className:"h-8 w-8 p-0 bg-red-500/80 hover:bg-red-500",children:l.jsx(MM,{className:"h-4 w-4"})})}),l.jsxs(qc,{children:[l.jsx(Wc,{children:l.jsx(Gc,{children:"Delete Image"})}),l.jsx("p",{className:"text-brand-burgundy/70 mb-4",children:"Are you sure you want to delete this image? This action cannot be undone."}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx(xt,{variant:"outline",children:"Cancel"}),l.jsx(xt,{variant:"destructive",onClick:()=>L(Z.id,Z.image_url),children:"Delete"})]})]})]})]})]})},Z.id))}),n.length===0&&l.jsxs(Mt,{className:"text-center p-8",children:[l.jsx(pA,{className:"h-16 w-16 mx-auto mb-4 text-brand-burgundy/30"}),l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"No Images Yet"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Upload your first venue image using the area above"})]})]}):l.jsx("div",{className:"text-center p-8",children:l.jsx("p",{className:"text-brand-burgundy/70",children:"No venue found for your account."})})};var zxe=Array.isArray,va=zxe,$xe=typeof us=="object"&&us&&us.Object===Object&&us,uH=$xe,Fxe=uH,Uxe=typeof self=="object"&&self&&self.Object===Object&&self,Vxe=Fxe||Uxe||Function("return this")(),Kl=Vxe,qxe=Kl,Wxe=qxe.Symbol,J0=Wxe,fz=J0,dH=Object.prototype,Gxe=dH.hasOwnProperty,Hxe=dH.toString,Mv=fz?fz.toStringTag:void 0;function Xxe(e){var t=Gxe.call(e,Mv),r=e[Mv];try{e[Mv]=void 0;var n=!0}catch{}var i=Hxe.call(e);return n&&(t?e[Mv]=r:delete e[Mv]),i}var Kxe=Xxe,Zxe=Object.prototype,Yxe=Zxe.toString;function Jxe(e){return Yxe.call(e)}var Qxe=Jxe,pz=J0,e0e=Kxe,t0e=Qxe,r0e="[object Null]",n0e="[object Undefined]",mz=pz?pz.toStringTag:void 0;function i0e(e){return e==null?e===void 0?n0e:r0e:mz&&mz in Object(e)?e0e(e):t0e(e)}var Qc=i0e;function s0e(e){return e!=null&&typeof e=="object"}var eu=s0e,a0e=Qc,o0e=eu,l0e="[object Symbol]";function c0e(e){return typeof e=="symbol"||o0e(e)&&a0e(e)==l0e}var Tg=c0e,u0e=va,d0e=Tg,h0e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,f0e=/^\w*$/;function p0e(e,t){if(u0e(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||d0e(e)?!0:f0e.test(e)||!h0e.test(e)||t!=null&&e in Object(t)}var $I=p0e;function m0e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Md=m0e;const jg=Sn(Md);var g0e=Qc,y0e=Md,v0e="[object AsyncFunction]",x0e="[object Function]",b0e="[object GeneratorFunction]",_0e="[object Proxy]";function w0e(e){if(!y0e(e))return!1;var t=g0e(e);return t==x0e||t==b0e||t==v0e||t==_0e}var FI=w0e;const Rr=Sn(FI);var S0e=Kl,E0e=S0e["__core-js_shared__"],T0e=E0e,OC=T0e,gz=function(){var e=/[^.]+$/.exec(OC&&OC.keys&&OC.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function j0e(e){return!!gz&&gz in e}var C0e=j0e,P0e=Function.prototype,A0e=P0e.toString;function N0e(e){if(e!=null){try{return A0e.call(e)}catch{}try{return e+""}catch{}}return""}var hH=N0e,k0e=FI,M0e=C0e,I0e=Md,O0e=hH,R0e=/[\\^$.*+?()[\]{}|]/g,D0e=/^\[object .+?Constructor\]$/,L0e=Function.prototype,B0e=Object.prototype,z0e=L0e.toString,$0e=B0e.hasOwnProperty,F0e=RegExp("^"+z0e.call($0e).replace(R0e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function U0e(e){if(!I0e(e)||M0e(e))return!1;var t=k0e(e)?F0e:D0e;return t.test(O0e(e))}var V0e=U0e;function q0e(e,t){return e==null?void 0:e[t]}var W0e=q0e,G0e=V0e,H0e=W0e;function X0e(e,t){var r=H0e(e,t);return G0e(r)?r:void 0}var Tf=X0e,K0e=Tf,Z0e=K0e(Object,"create"),QE=Z0e,yz=QE;function Y0e(){this.__data__=yz?yz(null):{},this.size=0}var J0e=Y0e;function Q0e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var ebe=Q0e,tbe=QE,rbe="__lodash_hash_undefined__",nbe=Object.prototype,ibe=nbe.hasOwnProperty;function sbe(e){var t=this.__data__;if(tbe){var r=t[e];return r===rbe?void 0:r}return ibe.call(t,e)?t[e]:void 0}var abe=sbe,obe=QE,lbe=Object.prototype,cbe=lbe.hasOwnProperty;function ube(e){var t=this.__data__;return obe?t[e]!==void 0:cbe.call(t,e)}var dbe=ube,hbe=QE,fbe="__lodash_hash_undefined__";function pbe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=hbe&&t===void 0?fbe:t,this}var mbe=pbe,gbe=J0e,ybe=ebe,vbe=abe,xbe=dbe,bbe=mbe;function Cg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Cg.prototype.clear=gbe;Cg.prototype.delete=ybe;Cg.prototype.get=vbe;Cg.prototype.has=xbe;Cg.prototype.set=bbe;var _be=Cg;function wbe(){this.__data__=[],this.size=0}var Sbe=wbe;function Ebe(e,t){return e===t||e!==e&&t!==t}var UI=Ebe,Tbe=UI;function jbe(e,t){for(var r=e.length;r--;)if(Tbe(e[r][0],t))return r;return-1}var e2=jbe,Cbe=e2,Pbe=Array.prototype,Abe=Pbe.splice;function Nbe(e){var t=this.__data__,r=Cbe(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Abe.call(t,r,1),--this.size,!0}var kbe=Nbe,Mbe=e2;function Ibe(e){var t=this.__data__,r=Mbe(t,e);return r<0?void 0:t[r][1]}var Obe=Ibe,Rbe=e2;function Dbe(e){return Rbe(this.__data__,e)>-1}var Lbe=Dbe,Bbe=e2;function zbe(e,t){var r=this.__data__,n=Bbe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var $be=zbe,Fbe=Sbe,Ube=kbe,Vbe=Obe,qbe=Lbe,Wbe=$be;function Pg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Pg.prototype.clear=Fbe;Pg.prototype.delete=Ube;Pg.prototype.get=Vbe;Pg.prototype.has=qbe;Pg.prototype.set=Wbe;var t2=Pg,Gbe=Tf,Hbe=Kl,Xbe=Gbe(Hbe,"Map"),VI=Xbe,vz=_be,Kbe=t2,Zbe=VI;function Ybe(){this.size=0,this.__data__={hash:new vz,map:new(Zbe||Kbe),string:new vz}}var Jbe=Ybe;function Qbe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var e_e=Qbe,t_e=e_e;function r_e(e,t){var r=e.__data__;return t_e(t)?r[typeof t=="string"?"string":"hash"]:r.map}var r2=r_e,n_e=r2;function i_e(e){var t=n_e(this,e).delete(e);return this.size-=t?1:0,t}var s_e=i_e,a_e=r2;function o_e(e){return a_e(this,e).get(e)}var l_e=o_e,c_e=r2;function u_e(e){return c_e(this,e).has(e)}var d_e=u_e,h_e=r2;function f_e(e,t){var r=h_e(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var p_e=f_e,m_e=Jbe,g_e=s_e,y_e=l_e,v_e=d_e,x_e=p_e;function Ag(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ag.prototype.clear=m_e;Ag.prototype.delete=g_e;Ag.prototype.get=y_e;Ag.prototype.has=v_e;Ag.prototype.set=x_e;var qI=Ag,fH=qI,b_e="Expected a function";function WI(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(b_e);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var h=e.apply(this,n);return r.cache=o.set(i,h)||o,h};return r.cache=new(WI.Cache||fH),r}WI.Cache=fH;var pH=WI;const __e=Sn(pH);var w_e=pH,S_e=500;function E_e(e){var t=w_e(e,function(n){return r.size===S_e&&r.clear(),n}),r=t.cache;return t}var T_e=E_e,j_e=T_e,C_e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,P_e=/\\(\\)?/g,A_e=j_e(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(C_e,function(r,n,i,o){t.push(i?o.replace(P_e,"$1"):n||r)}),t}),N_e=A_e;function k_e(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var GI=k_e,xz=J0,M_e=GI,I_e=va,O_e=Tg,R_e=1/0,bz=xz?xz.prototype:void 0,_z=bz?bz.toString:void 0;function mH(e){if(typeof e=="string")return e;if(I_e(e))return M_e(e,mH)+"";if(O_e(e))return _z?_z.call(e):"";var t=e+"";return t=="0"&&1/e==-R_e?"-0":t}var D_e=mH,L_e=D_e;function B_e(e){return e==null?"":L_e(e)}var gH=B_e,z_e=va,$_e=$I,F_e=N_e,U_e=gH;function V_e(e,t){return z_e(e)?e:$_e(e,t)?[e]:F_e(U_e(e))}var yH=V_e,q_e=Tg,W_e=1/0;function G_e(e){if(typeof e=="string"||q_e(e))return e;var t=e+"";return t=="0"&&1/e==-W_e?"-0":t}var n2=G_e,H_e=yH,X_e=n2;function K_e(e,t){t=H_e(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[X_e(t[r++])];return r&&r==n?e:void 0}var HI=K_e,Z_e=HI;function Y_e(e,t,r){var n=e==null?void 0:Z_e(e,t);return n===void 0?r:n}var vH=Y_e;const po=Sn(vH);function J_e(e){return e==null}var Q_e=J_e;const Hr=Sn(Q_e);var ewe=Qc,twe=va,rwe=eu,nwe="[object String]";function iwe(e){return typeof e=="string"||!twe(e)&&rwe(e)&&ewe(e)==nwe}var swe=iwe;const df=Sn(swe);var xH={exports:{}},En={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XI=Symbol.for("react.element"),KI=Symbol.for("react.portal"),i2=Symbol.for("react.fragment"),s2=Symbol.for("react.strict_mode"),a2=Symbol.for("react.profiler"),o2=Symbol.for("react.provider"),l2=Symbol.for("react.context"),awe=Symbol.for("react.server_context"),c2=Symbol.for("react.forward_ref"),u2=Symbol.for("react.suspense"),d2=Symbol.for("react.suspense_list"),h2=Symbol.for("react.memo"),f2=Symbol.for("react.lazy"),owe=Symbol.for("react.offscreen"),bH;bH=Symbol.for("react.module.reference");function bo(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case XI:switch(e=e.type,e){case i2:case a2:case s2:case u2:case d2:return e;default:switch(e=e&&e.$$typeof,e){case awe:case l2:case c2:case f2:case h2:case o2:return e;default:return t}}case KI:return t}}}En.ContextConsumer=l2;En.ContextProvider=o2;En.Element=XI;En.ForwardRef=c2;En.Fragment=i2;En.Lazy=f2;En.Memo=h2;En.Portal=KI;En.Profiler=a2;En.StrictMode=s2;En.Suspense=u2;En.SuspenseList=d2;En.isAsyncMode=function(){return!1};En.isConcurrentMode=function(){return!1};En.isContextConsumer=function(e){return bo(e)===l2};En.isContextProvider=function(e){return bo(e)===o2};En.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===XI};En.isForwardRef=function(e){return bo(e)===c2};En.isFragment=function(e){return bo(e)===i2};En.isLazy=function(e){return bo(e)===f2};En.isMemo=function(e){return bo(e)===h2};En.isPortal=function(e){return bo(e)===KI};En.isProfiler=function(e){return bo(e)===a2};En.isStrictMode=function(e){return bo(e)===s2};En.isSuspense=function(e){return bo(e)===u2};En.isSuspenseList=function(e){return bo(e)===d2};En.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===i2||e===a2||e===s2||e===u2||e===d2||e===owe||typeof e=="object"&&e!==null&&(e.$$typeof===f2||e.$$typeof===h2||e.$$typeof===o2||e.$$typeof===l2||e.$$typeof===c2||e.$$typeof===bH||e.getModuleId!==void 0)};En.typeOf=bo;xH.exports=En;var lwe=xH.exports,cwe=Qc,uwe=eu,dwe="[object Number]";function hwe(e){return typeof e=="number"||uwe(e)&&cwe(e)==dwe}var _H=hwe;const fwe=Sn(_H);var pwe=_H;function mwe(e){return pwe(e)&&e!=+e}var gwe=mwe;const Q0=Sn(gwe);var al=function(t){return t===0?0:t>0?1:-1},qh=function(t){return df(t)&&t.indexOf("%")===t.length-1},qt=function(t){return fwe(t)&&!Q0(t)},Fi=function(t){return qt(t)||df(t)},ywe=0,eb=function(t){var r=++ywe;return"".concat(t||"").concat(r)},hf=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!qt(t)&&!df(t))return n;var o;if(qh(t)){var h=t.indexOf("%");o=r*parseFloat(t.slice(0,h))/100}else o=+t;return Q0(o)&&(o=n),i&&o>r&&(o=r),o},Zu=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},vwe=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},i=0;i<r;i++)if(!n[t[i]])n[t[i]]=!0;else return!0;return!1},tl=function(t,r){return qt(t)&&qt(r)?function(n){return t+n*(r-t)}:function(){return r}};function X1(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):po(n,t))===r})}var xwe=function(t,r){return qt(t)&&qt(r)?t-r:df(t)&&df(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function ym(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function eN(e){"@babel/helpers - typeof";return eN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eN(e)}var bwe=["viewBox","children"],_we=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],wz=["points","pathLength"],RC={svg:bwe,polygon:wz,polyline:wz},ZI=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],K1=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(I.isValidElement(t)&&(n=t.props),!jg(n))return null;var i={};return Object.keys(n).forEach(function(o){ZI.includes(o)&&(i[o]=r||function(h){return n[o](n,h)})}),i},wwe=function(t,r,n){return function(i){return t(r,n,i),null}},Z1=function(t,r,n){if(!jg(t)||eN(t)!=="object")return null;var i=null;return Object.keys(t).forEach(function(o){var h=t[o];ZI.includes(o)&&typeof h=="function"&&(i||(i={}),i[o]=wwe(h,r,n))}),i},Swe=["children"],Ewe=["children"];function Sz(e,t){if(e==null)return{};var r=Twe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Twe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function tN(e){"@babel/helpers - typeof";return tN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tN(e)}var Ez={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},kc=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},Tz=null,DC=null,YI=function e(t){if(t===Tz&&Array.isArray(DC))return DC;var r=[];return I.Children.forEach(t,function(n){Hr(n)||(lwe.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),DC=r,Tz=t,r};function mo(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(i){return kc(i)}):n=[kc(t)],YI(e).forEach(function(i){var o=po(i,"type.displayName")||po(i,"type.name");n.indexOf(o)!==-1&&r.push(i)}),r}function Na(e,t){var r=mo(e,t);return r&&r[0]}var jz=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,i=r.height;return!(!qt(n)||n<=0||!qt(i)||i<=0)},jwe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Cwe=function(t){return t&&t.type&&df(t.type)&&jwe.indexOf(t.type)>=0},Pwe=function(t){return t&&tN(t)==="object"&&"clipDot"in t},Awe=function(t,r,n,i){var o,h=(o=RC==null?void 0:RC[i])!==null&&o!==void 0?o:[];return r.startsWith("data-")||!Rr(t)&&(i&&h.includes(r)||_we.includes(r))||n&&ZI.includes(r)},Kr=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(I.isValidElement(t)&&(i=t.props),!jg(i))return null;var o={};return Object.keys(i).forEach(function(h){var s;Awe((s=i)===null||s===void 0?void 0:s[h],h,r,n)&&(o[h]=i[h])}),o},rN=function e(t,r){if(t===r)return!0;var n=I.Children.count(t);if(n!==I.Children.count(r))return!1;if(n===0)return!0;if(n===1)return Cz(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var i=0;i<n;i++){var o=t[i],h=r[i];if(Array.isArray(o)||Array.isArray(h)){if(!e(o,h))return!1}else if(!Cz(o,h))return!1}return!0},Cz=function(t,r){if(Hr(t)&&Hr(r))return!0;if(!Hr(t)&&!Hr(r)){var n=t.props||{},i=n.children,o=Sz(n,Swe),h=r.props||{},s=h.children,p=Sz(h,Ewe);return i&&s?ym(o,p)&&rN(i,s):!i&&!s?ym(o,p):!1}return!1},Pz=function(t,r){var n=[],i={};return YI(t).forEach(function(o,h){if(Cwe(o))n.push(o);else if(o){var s=kc(o.type),p=r[s]||{},y=p.handler,b=p.once;if(y&&(!b||!i[s])){var _=y(o,s,h);n.push(_),i[s]=!0}}}),n},Nwe=function(t){var r=t&&t.type;return r&&Ez[r]?Ez[r]:null},kwe=function(t,r){return YI(r).indexOf(t)},Mwe=["children","width","height","viewBox","className","style","title","desc"];function nN(){return nN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nN.apply(this,arguments)}function Iwe(e,t){if(e==null)return{};var r=Owe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Owe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function iN(e){var t=e.children,r=e.width,n=e.height,i=e.viewBox,o=e.className,h=e.style,s=e.title,p=e.desc,y=Iwe(e,Mwe),b=i||{width:r,height:n,x:0,y:0},_=Jr("recharts-surface",o);return je.createElement("svg",nN({},Kr(y,!0,"svg"),{className:_,width:r,height:n,style:h,viewBox:"".concat(b.x," ").concat(b.y," ").concat(b.width," ").concat(b.height)}),je.createElement("title",null,s),je.createElement("desc",null,p),t)}var Rwe=["children","className"];function sN(){return sN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sN.apply(this,arguments)}function Dwe(e,t){if(e==null)return{};var r=Lwe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Lwe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var gi=je.forwardRef(function(e,t){var r=e.children,n=e.className,i=Dwe(e,Rwe),o=Jr("recharts-layer",n);return je.createElement("g",sN({className:o},Kr(i,!0),{ref:t}),r)}),Mc=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o]};function Bwe(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),r=r>i?i:r,r<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o}var zwe=Bwe,$we=zwe;function Fwe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:$we(e,t,r)}var Uwe=Fwe,Vwe="\\ud800-\\udfff",qwe="\\u0300-\\u036f",Wwe="\\ufe20-\\ufe2f",Gwe="\\u20d0-\\u20ff",Hwe=qwe+Wwe+Gwe,Xwe="\\ufe0e\\ufe0f",Kwe="\\u200d",Zwe=RegExp("["+Kwe+Vwe+Hwe+Xwe+"]");function Ywe(e){return Zwe.test(e)}var wH=Ywe;function Jwe(e){return e.split("")}var Qwe=Jwe,SH="\\ud800-\\udfff",e1e="\\u0300-\\u036f",t1e="\\ufe20-\\ufe2f",r1e="\\u20d0-\\u20ff",n1e=e1e+t1e+r1e,i1e="\\ufe0e\\ufe0f",s1e="["+SH+"]",aN="["+n1e+"]",oN="\\ud83c[\\udffb-\\udfff]",a1e="(?:"+aN+"|"+oN+")",EH="[^"+SH+"]",TH="(?:\\ud83c[\\udde6-\\uddff]){2}",jH="[\\ud800-\\udbff][\\udc00-\\udfff]",o1e="\\u200d",CH=a1e+"?",PH="["+i1e+"]?",l1e="(?:"+o1e+"(?:"+[EH,TH,jH].join("|")+")"+PH+CH+")*",c1e=PH+CH+l1e,u1e="(?:"+[EH+aN+"?",aN,TH,jH,s1e].join("|")+")",d1e=RegExp(oN+"(?="+oN+")|"+u1e+c1e,"g");function h1e(e){return e.match(d1e)||[]}var f1e=h1e,p1e=Qwe,m1e=wH,g1e=f1e;function y1e(e){return m1e(e)?g1e(e):p1e(e)}var v1e=y1e,x1e=Uwe,b1e=wH,_1e=v1e,w1e=gH;function S1e(e){return function(t){t=w1e(t);var r=b1e(t)?_1e(t):void 0,n=r?r[0]:t.charAt(0),i=r?x1e(r,1).join(""):t.slice(1);return n[e]()+i}}var E1e=S1e,T1e=E1e,j1e=T1e("toUpperCase"),C1e=j1e;const p2=Sn(C1e);function Ln(e){return function(){return e}}const AH=Math.cos,Y1=Math.sin,yl=Math.sqrt,J1=Math.PI,m2=2*J1,lN=Math.PI,cN=2*lN,Rh=1e-6,P1e=cN-Rh;function NH(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function A1e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return NH;const r=10**t;return function(n){this._+=n[0];for(let i=1,o=n.length;i<o;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class N1e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?NH:A1e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,o,h){this._append`C${+t},${+r},${+n},${+i},${this._x1=+o},${this._y1=+h}`}arcTo(t,r,n,i,o){if(t=+t,r=+r,n=+n,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let h=this._x1,s=this._y1,p=n-t,y=i-r,b=h-t,_=s-r,E=b*b+_*_;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(E>Rh)if(!(Math.abs(_*p-y*b)>Rh)||!o)this._append`L${this._x1=t},${this._y1=r}`;else{let C=n-h,k=i-s,N=p*p+y*y,O=C*C+k*k,R=Math.sqrt(N),L=Math.sqrt(E),B=o*Math.tan((lN-Math.acos((N+E-O)/(2*R*L)))/2),q=B/L,F=B/R;Math.abs(q-1)>Rh&&this._append`L${t+q*b},${r+q*_}`,this._append`A${o},${o},0,0,${+(_*C>b*k)},${this._x1=t+F*p},${this._y1=r+F*y}`}}arc(t,r,n,i,o,h){if(t=+t,r=+r,n=+n,h=!!h,n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(i),p=n*Math.sin(i),y=t+s,b=r+p,_=1^h,E=h?i-o:o-i;this._x1===null?this._append`M${y},${b}`:(Math.abs(this._x1-y)>Rh||Math.abs(this._y1-b)>Rh)&&this._append`L${y},${b}`,n&&(E<0&&(E=E%cN+cN),E>P1e?this._append`A${n},${n},0,1,${_},${t-s},${r-p}A${n},${n},0,1,${_},${this._x1=y},${this._y1=b}`:E>Rh&&this._append`A${n},${n},0,${+(E>=lN)},${_},${this._x1=t+n*Math.cos(o)},${this._y1=r+n*Math.sin(o)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function JI(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new N1e(t)}function QI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function kH(e){this._context=e}kH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function g2(e){return new kH(e)}function MH(e){return e[0]}function IH(e){return e[1]}function OH(e,t){var r=Ln(!0),n=null,i=g2,o=null,h=JI(s);e=typeof e=="function"?e:e===void 0?MH:Ln(e),t=typeof t=="function"?t:t===void 0?IH:Ln(t);function s(p){var y,b=(p=QI(p)).length,_,E=!1,C;for(n==null&&(o=i(C=h())),y=0;y<=b;++y)!(y<b&&r(_=p[y],y,p))===E&&((E=!E)?o.lineStart():o.lineEnd()),E&&o.point(+e(_,y,p),+t(_,y,p));if(C)return o=null,C+""||null}return s.x=function(p){return arguments.length?(e=typeof p=="function"?p:Ln(+p),s):e},s.y=function(p){return arguments.length?(t=typeof p=="function"?p:Ln(+p),s):t},s.defined=function(p){return arguments.length?(r=typeof p=="function"?p:Ln(!!p),s):r},s.curve=function(p){return arguments.length?(i=p,n!=null&&(o=i(n)),s):i},s.context=function(p){return arguments.length?(p==null?n=o=null:o=i(n=p),s):n},s}function vw(e,t,r){var n=null,i=Ln(!0),o=null,h=g2,s=null,p=JI(y);e=typeof e=="function"?e:e===void 0?MH:Ln(+e),t=typeof t=="function"?t:Ln(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?IH:Ln(+r);function y(_){var E,C,k,N=(_=QI(_)).length,O,R=!1,L,B=new Array(N),q=new Array(N);for(o==null&&(s=h(L=p())),E=0;E<=N;++E){if(!(E<N&&i(O=_[E],E,_))===R)if(R=!R)C=E,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),k=E-1;k>=C;--k)s.point(B[k],q[k]);s.lineEnd(),s.areaEnd()}R&&(B[E]=+e(O,E,_),q[E]=+t(O,E,_),s.point(n?+n(O,E,_):B[E],r?+r(O,E,_):q[E]))}if(L)return s=null,L+""||null}function b(){return OH().defined(i).curve(h).context(o)}return y.x=function(_){return arguments.length?(e=typeof _=="function"?_:Ln(+_),n=null,y):e},y.x0=function(_){return arguments.length?(e=typeof _=="function"?_:Ln(+_),y):e},y.x1=function(_){return arguments.length?(n=_==null?null:typeof _=="function"?_:Ln(+_),y):n},y.y=function(_){return arguments.length?(t=typeof _=="function"?_:Ln(+_),r=null,y):t},y.y0=function(_){return arguments.length?(t=typeof _=="function"?_:Ln(+_),y):t},y.y1=function(_){return arguments.length?(r=_==null?null:typeof _=="function"?_:Ln(+_),y):r},y.lineX0=y.lineY0=function(){return b().x(e).y(t)},y.lineY1=function(){return b().x(e).y(r)},y.lineX1=function(){return b().x(n).y(t)},y.defined=function(_){return arguments.length?(i=typeof _=="function"?_:Ln(!!_),y):i},y.curve=function(_){return arguments.length?(h=_,o!=null&&(s=h(o)),y):h},y.context=function(_){return arguments.length?(_==null?o=s=null:s=h(o=_),y):o},y}class RH{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function k1e(e){return new RH(e,!0)}function M1e(e){return new RH(e,!1)}const eO={draw(e,t){const r=yl(t/J1);e.moveTo(r,0),e.arc(0,0,r,0,m2)}},I1e={draw(e,t){const r=yl(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},DH=yl(1/3),O1e=DH*2,R1e={draw(e,t){const r=yl(t/O1e),n=r*DH;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},D1e={draw(e,t){const r=yl(t),n=-r/2;e.rect(n,n,r,r)}},L1e=.8908130915292852,LH=Y1(J1/10)/Y1(7*J1/10),B1e=Y1(m2/10)*LH,z1e=-AH(m2/10)*LH,$1e={draw(e,t){const r=yl(t*L1e),n=B1e*r,i=z1e*r;e.moveTo(0,-r),e.lineTo(n,i);for(let o=1;o<5;++o){const h=m2*o/5,s=AH(h),p=Y1(h);e.lineTo(p*r,-s*r),e.lineTo(s*n-p*i,p*n+s*i)}e.closePath()}},LC=yl(3),F1e={draw(e,t){const r=-yl(t/(LC*3));e.moveTo(0,r*2),e.lineTo(-LC*r,-r),e.lineTo(LC*r,-r),e.closePath()}},to=-.5,ro=yl(3)/2,uN=1/yl(12),U1e=(uN/2+1)*3,V1e={draw(e,t){const r=yl(t/U1e),n=r/2,i=r*uN,o=n,h=r*uN+r,s=-o,p=h;e.moveTo(n,i),e.lineTo(o,h),e.lineTo(s,p),e.lineTo(to*n-ro*i,ro*n+to*i),e.lineTo(to*o-ro*h,ro*o+to*h),e.lineTo(to*s-ro*p,ro*s+to*p),e.lineTo(to*n+ro*i,to*i-ro*n),e.lineTo(to*o+ro*h,to*h-ro*o),e.lineTo(to*s+ro*p,to*p-ro*s),e.closePath()}};function q1e(e,t){let r=null,n=JI(i);e=typeof e=="function"?e:Ln(e||eO),t=typeof t=="function"?t:Ln(t===void 0?64:+t);function i(){let o;if(r||(r=o=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),o)return r=null,o+""||null}return i.type=function(o){return arguments.length?(e=typeof o=="function"?o:Ln(o),i):e},i.size=function(o){return arguments.length?(t=typeof o=="function"?o:Ln(+o),i):t},i.context=function(o){return arguments.length?(r=o??null,i):r},i}function Q1(){}function eS(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function BH(e){this._context=e}BH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:eS(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:eS(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function W1e(e){return new BH(e)}function zH(e){this._context=e}zH.prototype={areaStart:Q1,areaEnd:Q1,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:eS(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function G1e(e){return new zH(e)}function $H(e){this._context=e}$H.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:eS(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function H1e(e){return new $H(e)}function FH(e){this._context=e}FH.prototype={areaStart:Q1,areaEnd:Q1,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function X1e(e){return new FH(e)}function Az(e){return e<0?-1:1}function Nz(e,t,r){var n=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(n||i<0&&-0),h=(r-e._y1)/(i||n<0&&-0),s=(o*i+h*n)/(n+i);return(Az(o)+Az(h))*Math.min(Math.abs(o),Math.abs(h),.5*Math.abs(s))||0}function kz(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function BC(e,t,r){var n=e._x0,i=e._y0,o=e._x1,h=e._y1,s=(o-n)/3;e._context.bezierCurveTo(n+s,i+s*t,o-s,h-s*r,o,h)}function tS(e){this._context=e}tS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:BC(this,this._t0,kz(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,BC(this,kz(this,r=Nz(this,e,t)),r);break;default:BC(this,this._t0,r=Nz(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function UH(e){this._context=new VH(e)}(UH.prototype=Object.create(tS.prototype)).point=function(e,t){tS.prototype.point.call(this,t,e)};function VH(e){this._context=e}VH.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,o){this._context.bezierCurveTo(t,e,n,r,o,i)}};function K1e(e){return new tS(e)}function Z1e(e){return new UH(e)}function qH(e){this._context=e}qH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=Mz(e),i=Mz(t),o=0,h=1;h<r;++o,++h)this._context.bezierCurveTo(n[0][o],i[0][o],n[1][o],i[1][o],e[h],t[h]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Mz(e){var t,r=e.length-1,n,i=new Array(r),o=new Array(r),h=new Array(r);for(i[0]=0,o[0]=2,h[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,h[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,h[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,h[t]-=n*h[t-1];for(i[r-1]=h[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(h[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function Y1e(e){return new qH(e)}function y2(e,t){this._context=e,this._t=t}y2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function J1e(e){return new y2(e,.5)}function Q1e(e){return new y2(e,0)}function eSe(e){return new y2(e,1)}function Dm(e,t){if((h=e.length)>1)for(var r=1,n,i,o=e[t[0]],h,s=o.length;r<h;++r)for(i=o,o=e[t[r]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function dN(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function tSe(e,t){return e[t]}function rSe(e){const t=[];return t.key=e,t}function nSe(){var e=Ln([]),t=dN,r=Dm,n=tSe;function i(o){var h=Array.from(e.apply(this,arguments),rSe),s,p=h.length,y=-1,b;for(const _ of o)for(s=0,++y;s<p;++s)(h[s][y]=[0,+n(_,h[s].key,y,o)]).data=_;for(s=0,b=QI(t(h));s<p;++s)h[b[s]].index=s;return r(h,b),h}return i.keys=function(o){return arguments.length?(e=typeof o=="function"?o:Ln(Array.from(o)),i):e},i.value=function(o){return arguments.length?(n=typeof o=="function"?o:Ln(+o),i):n},i.order=function(o){return arguments.length?(t=o==null?dN:typeof o=="function"?o:Ln(Array.from(o)),i):t},i.offset=function(o){return arguments.length?(r=o??Dm,i):r},i}function iSe(e,t){if((n=e.length)>0){for(var r,n,i=0,o=e[0].length,h;i<o;++i){for(h=r=0;r<n;++r)h+=e[r][i][1]||0;if(h)for(r=0;r<n;++r)e[r][i][1]/=h}Dm(e,t)}}function sSe(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,o=n.length;r<o;++r){for(var h=0,s=0;h<i;++h)s+=e[h][r][1]||0;n[r][1]+=n[r][0]=-s/2}Dm(e,t)}}function aSe(e,t){if(!(!((h=e.length)>0)||!((o=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,o,h;n<o;++n){for(var s=0,p=0,y=0;s<h;++s){for(var b=e[t[s]],_=b[n][1]||0,E=b[n-1][1]||0,C=(_-E)/2,k=0;k<s;++k){var N=e[t[k]],O=N[n][1]||0,R=N[n-1][1]||0;C+=O-R}p+=_,y+=C*_}i[n-1][1]+=i[n-1][0]=r,p&&(r-=y/p)}i[n-1][1]+=i[n-1][0]=r,Dm(e,t)}}function Jx(e){"@babel/helpers - typeof";return Jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jx(e)}var oSe=["type","size","sizeType"];function hN(){return hN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hN.apply(this,arguments)}function Iz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Oz(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Iz(Object(r),!0).forEach(function(n){lSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Iz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lSe(e,t,r){return t=cSe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cSe(e){var t=uSe(e,"string");return Jx(t)=="symbol"?t:t+""}function uSe(e,t){if(Jx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dSe(e,t){if(e==null)return{};var r=hSe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hSe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var WH={symbolCircle:eO,symbolCross:I1e,symbolDiamond:R1e,symbolSquare:D1e,symbolStar:$1e,symbolTriangle:F1e,symbolWye:V1e},fSe=Math.PI/180,pSe=function(t){var r="symbol".concat(p2(t));return WH[r]||eO},mSe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var i=18*fSe;return 1.25*t*t*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},gSe=function(t,r){WH["symbol".concat(p2(t))]=r},tO=function(t){var r=t.type,n=r===void 0?"circle":r,i=t.size,o=i===void 0?64:i,h=t.sizeType,s=h===void 0?"area":h,p=dSe(t,oSe),y=Oz(Oz({},p),{},{type:n,size:o,sizeType:s}),b=function(){var O=pSe(n),R=q1e().type(O).size(mSe(o,s,n));return R()},_=y.className,E=y.cx,C=y.cy,k=Kr(y,!0);return E===+E&&C===+C&&o===+o?je.createElement("path",hN({},k,{className:Jr("recharts-symbols",_),transform:"translate(".concat(E,", ").concat(C,")"),d:b()})):null};tO.registerSymbol=gSe;function Lm(e){"@babel/helpers - typeof";return Lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lm(e)}function fN(){return fN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fN.apply(this,arguments)}function Rz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ySe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rz(Object(r),!0).forEach(function(n){Qx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HH(n.key),n)}}function xSe(e,t,r){return t&&Dz(e.prototype,t),r&&Dz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bSe(e,t,r){return t=rS(t),_Se(e,GH()?Reflect.construct(t,r||[],rS(e).constructor):t.apply(e,r))}function _Se(e,t){if(t&&(Lm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wSe(e)}function wSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(GH=function(){return!!e})()}function rS(e){return rS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rS(e)}function SSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pN(e,t)}function pN(e,t){return pN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pN(e,t)}function Qx(e,t,r){return t=HH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HH(e){var t=ESe(e,"string");return Lm(t)=="symbol"?t:t+""}function ESe(e,t){if(Lm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var no=32,rO=function(e){function t(){return vSe(this,t),bSe(this,t,arguments)}return SSe(t,e),xSe(t,[{key:"renderIcon",value:function(n){var i=this.props.inactiveColor,o=no/2,h=no/6,s=no/3,p=n.inactive?i:n.color;if(n.type==="plainline")return je.createElement("line",{strokeWidth:4,fill:"none",stroke:p,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:o,x2:no,y2:o,className:"recharts-legend-icon"});if(n.type==="line")return je.createElement("path",{strokeWidth:4,fill:"none",stroke:p,d:"M0,".concat(o,"h").concat(s,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(2*s,",").concat(o,`
            H`).concat(no,"M").concat(2*s,",").concat(o,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(s,",").concat(o),className:"recharts-legend-icon"});if(n.type==="rect")return je.createElement("path",{stroke:"none",fill:p,d:"M0,".concat(no/8,"h").concat(no,"v").concat(no*3/4,"h").concat(-no,"z"),className:"recharts-legend-icon"});if(je.isValidElement(n.legendIcon)){var y=ySe({},n);return delete y.legendIcon,je.cloneElement(n.legendIcon,y)}return je.createElement(tO,{fill:p,cx:o,cy:o,size:no,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,i=this.props,o=i.payload,h=i.iconSize,s=i.layout,p=i.formatter,y=i.inactiveColor,b={x:0,y:0,width:no,height:no},_={display:s==="horizontal"?"inline-block":"block",marginRight:10},E={display:"inline-block",verticalAlign:"middle",marginRight:4};return o.map(function(C,k){var N=C.formatter||p,O=Jr(Qx(Qx({"recharts-legend-item":!0},"legend-item-".concat(k),!0),"inactive",C.inactive));if(C.type==="none")return null;var R=Rr(C.value)?null:C.value;Mc(!Rr(C.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var L=C.inactive?y:C.color;return je.createElement("li",fN({className:O,style:_,key:"legend-item-".concat(k)},Z1(n.props,C,k)),je.createElement(iN,{width:h,height:h,viewBox:b,style:E},n.renderIcon(C)),je.createElement("span",{className:"recharts-legend-item-text",style:{color:L}},N?N(R,C,k):R))})}},{key:"render",value:function(){var n=this.props,i=n.payload,o=n.layout,h=n.align;if(!i||!i.length)return null;var s={padding:0,margin:0,textAlign:o==="horizontal"?h:"left"};return je.createElement("ul",{className:"recharts-default-legend",style:s},this.renderItems())}}])}(I.PureComponent);Qx(rO,"displayName","Legend");Qx(rO,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var TSe=t2;function jSe(){this.__data__=new TSe,this.size=0}var CSe=jSe;function PSe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var ASe=PSe;function NSe(e){return this.__data__.get(e)}var kSe=NSe;function MSe(e){return this.__data__.has(e)}var ISe=MSe,OSe=t2,RSe=VI,DSe=qI,LSe=200;function BSe(e,t){var r=this.__data__;if(r instanceof OSe){var n=r.__data__;if(!RSe||n.length<LSe-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new DSe(n)}return r.set(e,t),this.size=r.size,this}var zSe=BSe,$Se=t2,FSe=CSe,USe=ASe,VSe=kSe,qSe=ISe,WSe=zSe;function Ng(e){var t=this.__data__=new $Se(e);this.size=t.size}Ng.prototype.clear=FSe;Ng.prototype.delete=USe;Ng.prototype.get=VSe;Ng.prototype.has=qSe;Ng.prototype.set=WSe;var XH=Ng,GSe="__lodash_hash_undefined__";function HSe(e){return this.__data__.set(e,GSe),this}var XSe=HSe;function KSe(e){return this.__data__.has(e)}var ZSe=KSe,YSe=qI,JSe=XSe,QSe=ZSe;function nS(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new YSe;++t<r;)this.add(e[t])}nS.prototype.add=nS.prototype.push=JSe;nS.prototype.has=QSe;var KH=nS;function eEe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var ZH=eEe;function tEe(e,t){return e.has(t)}var YH=tEe,rEe=KH,nEe=ZH,iEe=YH,sEe=1,aEe=2;function oEe(e,t,r,n,i,o){var h=r&sEe,s=e.length,p=t.length;if(s!=p&&!(h&&p>s))return!1;var y=o.get(e),b=o.get(t);if(y&&b)return y==t&&b==e;var _=-1,E=!0,C=r&aEe?new rEe:void 0;for(o.set(e,t),o.set(t,e);++_<s;){var k=e[_],N=t[_];if(n)var O=h?n(N,k,_,t,e,o):n(k,N,_,e,t,o);if(O!==void 0){if(O)continue;E=!1;break}if(C){if(!nEe(t,function(R,L){if(!iEe(C,L)&&(k===R||i(k,R,r,n,o)))return C.push(L)})){E=!1;break}}else if(!(k===N||i(k,N,r,n,o))){E=!1;break}}return o.delete(e),o.delete(t),E}var JH=oEe,lEe=Kl,cEe=lEe.Uint8Array,uEe=cEe;function dEe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}var hEe=dEe;function fEe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var nO=fEe,Lz=J0,Bz=uEe,pEe=UI,mEe=JH,gEe=hEe,yEe=nO,vEe=1,xEe=2,bEe="[object Boolean]",_Ee="[object Date]",wEe="[object Error]",SEe="[object Map]",EEe="[object Number]",TEe="[object RegExp]",jEe="[object Set]",CEe="[object String]",PEe="[object Symbol]",AEe="[object ArrayBuffer]",NEe="[object DataView]",zz=Lz?Lz.prototype:void 0,zC=zz?zz.valueOf:void 0;function kEe(e,t,r,n,i,o,h){switch(r){case NEe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case AEe:return!(e.byteLength!=t.byteLength||!o(new Bz(e),new Bz(t)));case bEe:case _Ee:case EEe:return pEe(+e,+t);case wEe:return e.name==t.name&&e.message==t.message;case TEe:case CEe:return e==t+"";case SEe:var s=gEe;case jEe:var p=n&vEe;if(s||(s=yEe),e.size!=t.size&&!p)return!1;var y=h.get(e);if(y)return y==t;n|=xEe,h.set(e,t);var b=mEe(s(e),s(t),n,i,o,h);return h.delete(e),b;case PEe:if(zC)return zC.call(e)==zC.call(t)}return!1}var MEe=kEe;function IEe(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var QH=IEe,OEe=QH,REe=va;function DEe(e,t,r){var n=t(e);return REe(e)?n:OEe(n,r(e))}var LEe=DEe;function BEe(e,t){for(var r=-1,n=e==null?0:e.length,i=0,o=[];++r<n;){var h=e[r];t(h,r,e)&&(o[i++]=h)}return o}var zEe=BEe;function $Ee(){return[]}var FEe=$Ee,UEe=zEe,VEe=FEe,qEe=Object.prototype,WEe=qEe.propertyIsEnumerable,$z=Object.getOwnPropertySymbols,GEe=$z?function(e){return e==null?[]:(e=Object(e),UEe($z(e),function(t){return WEe.call(e,t)}))}:VEe,HEe=GEe;function XEe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var KEe=XEe,ZEe=Qc,YEe=eu,JEe="[object Arguments]";function QEe(e){return YEe(e)&&ZEe(e)==JEe}var e2e=QEe,Fz=e2e,t2e=eu,eX=Object.prototype,r2e=eX.hasOwnProperty,n2e=eX.propertyIsEnumerable,i2e=Fz(function(){return arguments}())?Fz:function(e){return t2e(e)&&r2e.call(e,"callee")&&!n2e.call(e,"callee")},iO=i2e,iS={exports:{}};function s2e(){return!1}var a2e=s2e;iS.exports;(function(e,t){var r=Kl,n=a2e,i=t&&!t.nodeType&&t,o=i&&!0&&e&&!e.nodeType&&e,h=o&&o.exports===i,s=h?r.Buffer:void 0,p=s?s.isBuffer:void 0,y=p||n;e.exports=y})(iS,iS.exports);var tX=iS.exports,o2e=9007199254740991,l2e=/^(?:0|[1-9]\d*)$/;function c2e(e,t){var r=typeof e;return t=t??o2e,!!t&&(r=="number"||r!="symbol"&&l2e.test(e))&&e>-1&&e%1==0&&e<t}var sO=c2e,u2e=9007199254740991;function d2e(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=u2e}var aO=d2e,h2e=Qc,f2e=aO,p2e=eu,m2e="[object Arguments]",g2e="[object Array]",y2e="[object Boolean]",v2e="[object Date]",x2e="[object Error]",b2e="[object Function]",_2e="[object Map]",w2e="[object Number]",S2e="[object Object]",E2e="[object RegExp]",T2e="[object Set]",j2e="[object String]",C2e="[object WeakMap]",P2e="[object ArrayBuffer]",A2e="[object DataView]",N2e="[object Float32Array]",k2e="[object Float64Array]",M2e="[object Int8Array]",I2e="[object Int16Array]",O2e="[object Int32Array]",R2e="[object Uint8Array]",D2e="[object Uint8ClampedArray]",L2e="[object Uint16Array]",B2e="[object Uint32Array]",Vn={};Vn[N2e]=Vn[k2e]=Vn[M2e]=Vn[I2e]=Vn[O2e]=Vn[R2e]=Vn[D2e]=Vn[L2e]=Vn[B2e]=!0;Vn[m2e]=Vn[g2e]=Vn[P2e]=Vn[y2e]=Vn[A2e]=Vn[v2e]=Vn[x2e]=Vn[b2e]=Vn[_2e]=Vn[w2e]=Vn[S2e]=Vn[E2e]=Vn[T2e]=Vn[j2e]=Vn[C2e]=!1;function z2e(e){return p2e(e)&&f2e(e.length)&&!!Vn[h2e(e)]}var $2e=z2e;function F2e(e){return function(t){return e(t)}}var rX=F2e,sS={exports:{}};sS.exports;(function(e,t){var r=uH,n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===n,h=o&&r.process,s=function(){try{var p=i&&i.require&&i.require("util").types;return p||h&&h.binding&&h.binding("util")}catch{}}();e.exports=s})(sS,sS.exports);var U2e=sS.exports,V2e=$2e,q2e=rX,Uz=U2e,Vz=Uz&&Uz.isTypedArray,W2e=Vz?q2e(Vz):V2e,nX=W2e,G2e=KEe,H2e=iO,X2e=va,K2e=tX,Z2e=sO,Y2e=nX,J2e=Object.prototype,Q2e=J2e.hasOwnProperty;function eTe(e,t){var r=X2e(e),n=!r&&H2e(e),i=!r&&!n&&K2e(e),o=!r&&!n&&!i&&Y2e(e),h=r||n||i||o,s=h?G2e(e.length,String):[],p=s.length;for(var y in e)(t||Q2e.call(e,y))&&!(h&&(y=="length"||i&&(y=="offset"||y=="parent")||o&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||Z2e(y,p)))&&s.push(y);return s}var tTe=eTe,rTe=Object.prototype;function nTe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||rTe;return e===r}var iTe=nTe;function sTe(e,t){return function(r){return e(t(r))}}var iX=sTe,aTe=iX,oTe=aTe(Object.keys,Object),lTe=oTe,cTe=iTe,uTe=lTe,dTe=Object.prototype,hTe=dTe.hasOwnProperty;function fTe(e){if(!cTe(e))return uTe(e);var t=[];for(var r in Object(e))hTe.call(e,r)&&r!="constructor"&&t.push(r);return t}var pTe=fTe,mTe=FI,gTe=aO;function yTe(e){return e!=null&&gTe(e.length)&&!mTe(e)}var tb=yTe,vTe=tTe,xTe=pTe,bTe=tb;function _Te(e){return bTe(e)?vTe(e):xTe(e)}var v2=_Te,wTe=LEe,STe=HEe,ETe=v2;function TTe(e){return wTe(e,ETe,STe)}var jTe=TTe,qz=jTe,CTe=1,PTe=Object.prototype,ATe=PTe.hasOwnProperty;function NTe(e,t,r,n,i,o){var h=r&CTe,s=qz(e),p=s.length,y=qz(t),b=y.length;if(p!=b&&!h)return!1;for(var _=p;_--;){var E=s[_];if(!(h?E in t:ATe.call(t,E)))return!1}var C=o.get(e),k=o.get(t);if(C&&k)return C==t&&k==e;var N=!0;o.set(e,t),o.set(t,e);for(var O=h;++_<p;){E=s[_];var R=e[E],L=t[E];if(n)var B=h?n(L,R,E,t,e,o):n(R,L,E,e,t,o);if(!(B===void 0?R===L||i(R,L,r,n,o):B)){N=!1;break}O||(O=E=="constructor")}if(N&&!O){var q=e.constructor,F=t.constructor;q!=F&&"constructor"in e&&"constructor"in t&&!(typeof q=="function"&&q instanceof q&&typeof F=="function"&&F instanceof F)&&(N=!1)}return o.delete(e),o.delete(t),N}var kTe=NTe,MTe=Tf,ITe=Kl,OTe=MTe(ITe,"DataView"),RTe=OTe,DTe=Tf,LTe=Kl,BTe=DTe(LTe,"Promise"),zTe=BTe,$Te=Tf,FTe=Kl,UTe=$Te(FTe,"Set"),sX=UTe,VTe=Tf,qTe=Kl,WTe=VTe(qTe,"WeakMap"),GTe=WTe,mN=RTe,gN=VI,yN=zTe,vN=sX,xN=GTe,aX=Qc,kg=hH,Wz="[object Map]",HTe="[object Object]",Gz="[object Promise]",Hz="[object Set]",Xz="[object WeakMap]",Kz="[object DataView]",XTe=kg(mN),KTe=kg(gN),ZTe=kg(yN),YTe=kg(vN),JTe=kg(xN),Dh=aX;(mN&&Dh(new mN(new ArrayBuffer(1)))!=Kz||gN&&Dh(new gN)!=Wz||yN&&Dh(yN.resolve())!=Gz||vN&&Dh(new vN)!=Hz||xN&&Dh(new xN)!=Xz)&&(Dh=function(e){var t=aX(e),r=t==HTe?e.constructor:void 0,n=r?kg(r):"";if(n)switch(n){case XTe:return Kz;case KTe:return Wz;case ZTe:return Gz;case YTe:return Hz;case JTe:return Xz}return t});var QTe=Dh,$C=XH,eje=JH,tje=MEe,rje=kTe,Zz=QTe,Yz=va,Jz=tX,nje=nX,ije=1,Qz="[object Arguments]",e5="[object Array]",xw="[object Object]",sje=Object.prototype,t5=sje.hasOwnProperty;function aje(e,t,r,n,i,o){var h=Yz(e),s=Yz(t),p=h?e5:Zz(e),y=s?e5:Zz(t);p=p==Qz?xw:p,y=y==Qz?xw:y;var b=p==xw,_=y==xw,E=p==y;if(E&&Jz(e)){if(!Jz(t))return!1;h=!0,b=!1}if(E&&!b)return o||(o=new $C),h||nje(e)?eje(e,t,r,n,i,o):tje(e,t,p,r,n,i,o);if(!(r&ije)){var C=b&&t5.call(e,"__wrapped__"),k=_&&t5.call(t,"__wrapped__");if(C||k){var N=C?e.value():e,O=k?t.value():t;return o||(o=new $C),i(N,O,r,n,o)}}return E?(o||(o=new $C),rje(e,t,r,n,i,o)):!1}var oje=aje,lje=oje,r5=eu;function oX(e,t,r,n,i){return e===t?!0:e==null||t==null||!r5(e)&&!r5(t)?e!==e&&t!==t:lje(e,t,r,n,oX,i)}var oO=oX,cje=XH,uje=oO,dje=1,hje=2;function fje(e,t,r,n){var i=r.length,o=i,h=!n;if(e==null)return!o;for(e=Object(e);i--;){var s=r[i];if(h&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){s=r[i];var p=s[0],y=e[p],b=s[1];if(h&&s[2]){if(y===void 0&&!(p in e))return!1}else{var _=new cje;if(n)var E=n(y,b,p,e,t,_);if(!(E===void 0?uje(b,y,dje|hje,n,_):E))return!1}}return!0}var pje=fje,mje=Md;function gje(e){return e===e&&!mje(e)}var lX=gje,yje=lX,vje=v2;function xje(e){for(var t=vje(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,yje(i)]}return t}var bje=xje;function _je(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var cX=_je,wje=pje,Sje=bje,Eje=cX;function Tje(e){var t=Sje(e);return t.length==1&&t[0][2]?Eje(t[0][0],t[0][1]):function(r){return r===e||wje(r,e,t)}}var jje=Tje;function Cje(e,t){return e!=null&&t in Object(e)}var Pje=Cje,Aje=yH,Nje=iO,kje=va,Mje=sO,Ije=aO,Oje=n2;function Rje(e,t,r){t=Aje(t,e);for(var n=-1,i=t.length,o=!1;++n<i;){var h=Oje(t[n]);if(!(o=e!=null&&r(e,h)))break;e=e[h]}return o||++n!=i?o:(i=e==null?0:e.length,!!i&&Ije(i)&&Mje(h,i)&&(kje(e)||Nje(e)))}var Dje=Rje,Lje=Pje,Bje=Dje;function zje(e,t){return e!=null&&Bje(e,t,Lje)}var $je=zje,Fje=oO,Uje=vH,Vje=$je,qje=$I,Wje=lX,Gje=cX,Hje=n2,Xje=1,Kje=2;function Zje(e,t){return qje(e)&&Wje(t)?Gje(Hje(e),t):function(r){var n=Uje(r,e);return n===void 0&&n===t?Vje(r,e):Fje(t,n,Xje|Kje)}}var Yje=Zje;function Jje(e){return e}var Mg=Jje;function Qje(e){return function(t){return t==null?void 0:t[e]}}var eCe=Qje,tCe=HI;function rCe(e){return function(t){return tCe(t,e)}}var nCe=rCe,iCe=eCe,sCe=nCe,aCe=$I,oCe=n2;function lCe(e){return aCe(e)?iCe(oCe(e)):sCe(e)}var cCe=lCe,uCe=jje,dCe=Yje,hCe=Mg,fCe=va,pCe=cCe;function mCe(e){return typeof e=="function"?e:e==null?hCe:typeof e=="object"?fCe(e)?dCe(e[0],e[1]):uCe(e):pCe(e)}var Id=mCe;function gCe(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}var uX=gCe;function yCe(e){return e!==e}var vCe=yCe;function xCe(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}var bCe=xCe,_Ce=uX,wCe=vCe,SCe=bCe;function ECe(e,t,r){return t===t?SCe(e,t,r):_Ce(e,wCe,r)}var TCe=ECe,jCe=TCe;function CCe(e,t){var r=e==null?0:e.length;return!!r&&jCe(e,t,0)>-1}var PCe=CCe;function ACe(e,t,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}var NCe=ACe;function kCe(){}var MCe=kCe,FC=sX,ICe=MCe,OCe=nO,RCe=1/0,DCe=FC&&1/OCe(new FC([,-0]))[1]==RCe?function(e){return new FC(e)}:ICe,LCe=DCe,BCe=KH,zCe=PCe,$Ce=NCe,FCe=YH,UCe=LCe,VCe=nO,qCe=200;function WCe(e,t,r){var n=-1,i=zCe,o=e.length,h=!0,s=[],p=s;if(r)h=!1,i=$Ce;else if(o>=qCe){var y=t?null:UCe(e);if(y)return VCe(y);h=!1,i=FCe,p=new BCe}else p=t?[]:s;e:for(;++n<o;){var b=e[n],_=t?t(b):b;if(b=r||b!==0?b:0,h&&_===_){for(var E=p.length;E--;)if(p[E]===_)continue e;t&&p.push(_),s.push(b)}else i(p,_,r)||(p!==s&&p.push(_),s.push(b))}return s}var GCe=WCe,HCe=Id,XCe=GCe;function KCe(e,t){return e&&e.length?XCe(e,HCe(t)):[]}var ZCe=KCe;const n5=Sn(ZCe);function dX(e,t,r){return t===!0?n5(e,r):Rr(t)?n5(e,t):e}function Bm(e){"@babel/helpers - typeof";return Bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bm(e)}var YCe=["ref"];function i5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function mc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i5(Object(r),!0).forEach(function(n){x2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fX(n.key),n)}}function QCe(e,t,r){return t&&s5(e.prototype,t),r&&s5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ePe(e,t,r){return t=aS(t),tPe(e,hX()?Reflect.construct(t,r||[],aS(e).constructor):t.apply(e,r))}function tPe(e,t){if(t&&(Bm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rPe(e)}function rPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hX=function(){return!!e})()}function aS(e){return aS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aS(e)}function nPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bN(e,t)}function bN(e,t){return bN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bN(e,t)}function x2(e,t,r){return t=fX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fX(e){var t=iPe(e,"string");return Bm(t)=="symbol"?t:t+""}function iPe(e,t){if(Bm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sPe(e,t){if(e==null)return{};var r=aPe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aPe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function oPe(e){return e.value}function lPe(e,t){if(je.isValidElement(e))return je.cloneElement(e,t);if(typeof e=="function")return je.createElement(e,t);t.ref;var r=sPe(t,YCe);return je.createElement(rO,r)}var a5=1,vm=function(e){function t(){var r;JCe(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=ePe(this,t,[].concat(i)),x2(r,"lastBoundingBox",{width:-1,height:-1}),r}return nPe(t,e),QCe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>a5||Math.abs(i.height-this.lastBoundingBox.height)>a5)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,n&&n(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?mc({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var i=this.props,o=i.layout,h=i.align,s=i.verticalAlign,p=i.margin,y=i.chartWidth,b=i.chartHeight,_,E;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(h==="center"&&o==="vertical"){var C=this.getBBoxSnapshot();_={left:((y||0)-C.width)/2}}else _=h==="right"?{right:p&&p.right||0}:{left:p&&p.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(s==="middle"){var k=this.getBBoxSnapshot();E={top:((b||0)-k.height)/2}}else E=s==="bottom"?{bottom:p&&p.bottom||0}:{top:p&&p.top||0};return mc(mc({},_),E)}},{key:"render",value:function(){var n=this,i=this.props,o=i.content,h=i.width,s=i.height,p=i.wrapperStyle,y=i.payloadUniqBy,b=i.payload,_=mc(mc({position:"absolute",width:h||"auto",height:s||"auto"},this.getDefaultPosition(p)),p);return je.createElement("div",{className:"recharts-legend-wrapper",style:_,ref:function(C){n.wrapperNode=C}},lPe(o,mc(mc({},this.props),{},{payload:dX(b,y,oPe)})))}}],[{key:"getWithHeight",value:function(n,i){var o=mc(mc({},this.defaultProps),n.props),h=o.layout;return h==="vertical"&&qt(n.props.height)?{height:n.props.height}:h==="horizontal"?{width:n.props.width||i}:null}}])}(I.PureComponent);x2(vm,"displayName","Legend");x2(vm,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var o5=J0,cPe=iO,uPe=va,l5=o5?o5.isConcatSpreadable:void 0;function dPe(e){return uPe(e)||cPe(e)||!!(l5&&e&&e[l5])}var hPe=dPe,fPe=QH,pPe=hPe;function pX(e,t,r,n,i){var o=-1,h=e.length;for(r||(r=pPe),i||(i=[]);++o<h;){var s=e[o];t>0&&r(s)?t>1?pX(s,t-1,r,n,i):fPe(i,s):n||(i[i.length]=s)}return i}var mX=pX;function mPe(e){return function(t,r,n){for(var i=-1,o=Object(t),h=n(t),s=h.length;s--;){var p=h[e?s:++i];if(r(o[p],p,o)===!1)break}return t}}var gPe=mPe,yPe=gPe,vPe=yPe(),xPe=vPe,bPe=xPe,_Pe=v2;function wPe(e,t){return e&&bPe(e,t,_Pe)}var gX=wPe,SPe=tb;function EPe(e,t){return function(r,n){if(r==null)return r;if(!SPe(r))return e(r,n);for(var i=r.length,o=t?i:-1,h=Object(r);(t?o--:++o<i)&&n(h[o],o,h)!==!1;);return r}}var TPe=EPe,jPe=gX,CPe=TPe,PPe=CPe(jPe),lO=PPe,APe=lO,NPe=tb;function kPe(e,t){var r=-1,n=NPe(e)?Array(e.length):[];return APe(e,function(i,o,h){n[++r]=t(i,o,h)}),n}var yX=kPe;function MPe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var IPe=MPe,c5=Tg;function OPe(e,t){if(e!==t){var r=e!==void 0,n=e===null,i=e===e,o=c5(e),h=t!==void 0,s=t===null,p=t===t,y=c5(t);if(!s&&!y&&!o&&e>t||o&&h&&p&&!s&&!y||n&&h&&p||!r&&p||!i)return 1;if(!n&&!o&&!y&&e<t||y&&r&&i&&!n&&!o||s&&r&&i||!h&&i||!p)return-1}return 0}var RPe=OPe,DPe=RPe;function LPe(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,h=i.length,s=r.length;++n<h;){var p=DPe(i[n],o[n]);if(p){if(n>=s)return p;var y=r[n];return p*(y=="desc"?-1:1)}}return e.index-t.index}var BPe=LPe,UC=GI,zPe=HI,$Pe=Id,FPe=yX,UPe=IPe,VPe=rX,qPe=BPe,WPe=Mg,GPe=va;function HPe(e,t,r){t.length?t=UC(t,function(o){return GPe(o)?function(h){return zPe(h,o.length===1?o[0]:o)}:o}):t=[WPe];var n=-1;t=UC(t,VPe($Pe));var i=FPe(e,function(o,h,s){var p=UC(t,function(y){return y(o)});return{criteria:p,index:++n,value:o}});return UPe(i,function(o,h){return qPe(o,h,r)})}var XPe=HPe;function KPe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var ZPe=KPe,YPe=ZPe,u5=Math.max;function JPe(e,t,r){return t=u5(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=u5(n.length-t,0),h=Array(o);++i<o;)h[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(h),YPe(e,this,s)}}var QPe=JPe;function eAe(e){return function(){return e}}var tAe=eAe,rAe=Tf,nAe=function(){try{var e=rAe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),vX=nAe,iAe=tAe,d5=vX,sAe=Mg,aAe=d5?function(e,t){return d5(e,"toString",{configurable:!0,enumerable:!1,value:iAe(t),writable:!0})}:sAe,oAe=aAe,lAe=800,cAe=16,uAe=Date.now;function dAe(e){var t=0,r=0;return function(){var n=uAe(),i=cAe-(n-r);if(r=n,i>0){if(++t>=lAe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var hAe=dAe,fAe=oAe,pAe=hAe,mAe=pAe(fAe),gAe=mAe,yAe=Mg,vAe=QPe,xAe=gAe;function bAe(e,t){return xAe(vAe(e,t,yAe),e+"")}var _Ae=bAe,wAe=UI,SAe=tb,EAe=sO,TAe=Md;function jAe(e,t,r){if(!TAe(r))return!1;var n=typeof t;return(n=="number"?SAe(r)&&EAe(t,r.length):n=="string"&&t in r)?wAe(r[t],e):!1}var b2=jAe,CAe=mX,PAe=XPe,AAe=_Ae,h5=b2,NAe=AAe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&h5(e,t[0],t[1])?t=[]:r>2&&h5(t[0],t[1],t[2])&&(t=[t[0]]),PAe(e,CAe(t,1),[])}),kAe=NAe;const cO=Sn(kAe);function e0(e){"@babel/helpers - typeof";return e0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e0(e)}function _N(){return _N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_N.apply(this,arguments)}function MAe(e,t){return DAe(e)||RAe(e,t)||OAe(e,t)||IAe()}function IAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OAe(e,t){if(e){if(typeof e=="string")return f5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f5(e,t)}}function f5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,h,s=[],p=!0,y=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);p=!0);}catch(b){y=!0,i=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw i}}return s}}function DAe(e){if(Array.isArray(e))return e}function p5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function VC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p5(Object(r),!0).forEach(function(n){LAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LAe(e,t,r){return t=BAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BAe(e){var t=zAe(e,"string");return e0(t)=="symbol"?t:t+""}function zAe(e,t){if(e0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(e0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Ae(e){return Array.isArray(e)&&Fi(e[0])&&Fi(e[1])?e.join(" ~ "):e}var FAe=function(t){var r=t.separator,n=r===void 0?" : ":r,i=t.contentStyle,o=i===void 0?{}:i,h=t.itemStyle,s=h===void 0?{}:h,p=t.labelStyle,y=p===void 0?{}:p,b=t.payload,_=t.formatter,E=t.itemSorter,C=t.wrapperClassName,k=t.labelClassName,N=t.label,O=t.labelFormatter,R=t.accessibilityLayer,L=R===void 0?!1:R,B=function(){if(b&&b.length){var ie={padding:0,margin:0},ue=(E?cO(b,E):b).map(function(_e,xe){if(_e.type==="none")return null;var be=VC({display:"block",paddingTop:4,paddingBottom:4,color:_e.color||"#000"},s),Ae=_e.formatter||_||$Ae,me=_e.value,ke=_e.name,Ne=me,Be=ke;if(Ae&&Ne!=null&&Be!=null){var We=Ae(me,ke,_e,xe,b);if(Array.isArray(We)){var ut=MAe(We,2);Ne=ut[0],Be=ut[1]}else Ne=We}return je.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(xe),style:be},Fi(Be)?je.createElement("span",{className:"recharts-tooltip-item-name"},Be):null,Fi(Be)?je.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,je.createElement("span",{className:"recharts-tooltip-item-value"},Ne),je.createElement("span",{className:"recharts-tooltip-item-unit"},_e.unit||""))});return je.createElement("ul",{className:"recharts-tooltip-item-list",style:ie},ue)}return null},q=VC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},o),F=VC({margin:0},y),H=!Hr(N),Z=H?N:"",re=Jr("recharts-default-tooltip",C),W=Jr("recharts-tooltip-label",k);H&&O&&b!==void 0&&b!==null&&(Z=O(N,b));var te=L?{role:"status","aria-live":"assertive"}:{};return je.createElement("div",_N({className:re,style:q},te),je.createElement("p",{className:W,style:F},je.isValidElement(Z)?Z:"".concat(Z)),B())};function t0(e){"@babel/helpers - typeof";return t0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t0(e)}function bw(e,t,r){return t=UAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UAe(e){var t=VAe(e,"string");return t0(t)=="symbol"?t:t+""}function VAe(e,t){if(t0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(t0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iv="recharts-tooltip-wrapper",qAe={visibility:"hidden"};function WAe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return Jr(Iv,bw(bw(bw(bw({},"".concat(Iv,"-right"),qt(r)&&t&&qt(t.x)&&r>=t.x),"".concat(Iv,"-left"),qt(r)&&t&&qt(t.x)&&r<t.x),"".concat(Iv,"-bottom"),qt(n)&&t&&qt(t.y)&&n>=t.y),"".concat(Iv,"-top"),qt(n)&&t&&qt(t.y)&&n<t.y))}function m5(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,i=e.offsetTopLeft,o=e.position,h=e.reverseDirection,s=e.tooltipDimension,p=e.viewBox,y=e.viewBoxDimension;if(o&&qt(o[n]))return o[n];var b=r[n]-s-i,_=r[n]+i;if(t[n])return h[n]?b:_;if(h[n]){var E=b,C=p[n];return E<C?Math.max(_,p[n]):Math.max(b,p[n])}var k=_+s,N=p[n]+y;return k>N?Math.max(b,p[n]):Math.max(_,p[n])}function GAe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function HAe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,i=e.position,o=e.reverseDirection,h=e.tooltipBox,s=e.useTranslate3d,p=e.viewBox,y,b,_;return h.height>0&&h.width>0&&r?(b=m5({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:o,tooltipDimension:h.width,viewBox:p,viewBoxDimension:p.width}),_=m5({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:o,tooltipDimension:h.height,viewBox:p,viewBoxDimension:p.height}),y=GAe({translateX:b,translateY:_,useTranslate3d:s})):y=qAe,{cssProperties:y,cssClasses:WAe({translateX:b,translateY:_,coordinate:r})}}function zm(e){"@babel/helpers - typeof";return zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zm(e)}function g5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function y5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g5(Object(r),!0).forEach(function(n){SN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bX(n.key),n)}}function KAe(e,t,r){return t&&v5(e.prototype,t),r&&v5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZAe(e,t,r){return t=oS(t),YAe(e,xX()?Reflect.construct(t,r||[],oS(e).constructor):t.apply(e,r))}function YAe(e,t){if(t&&(zm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JAe(e)}function JAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xX=function(){return!!e})()}function oS(e){return oS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oS(e)}function QAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wN(e,t)}function wN(e,t){return wN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wN(e,t)}function SN(e,t,r){return t=bX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bX(e){var t=eNe(e,"string");return zm(t)=="symbol"?t:t+""}function eNe(e,t){if(zm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x5=1,tNe=function(e){function t(){var r;XAe(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=ZAe(this,t,[].concat(i)),SN(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),SN(r,"handleKeyDown",function(h){if(h.key==="Escape"){var s,p,y,b;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(p=r.props.coordinate)===null||p===void 0?void 0:p.x)!==null&&s!==void 0?s:0,y:(y=(b=r.props.coordinate)===null||b===void 0?void 0:b.y)!==null&&y!==void 0?y:0}})}}),r}return QAe(t,e),KAe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>x5||Math.abs(n.height-this.state.lastBoundingBox.height)>x5)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,i=this.props,o=i.active,h=i.allowEscapeViewBox,s=i.animationDuration,p=i.animationEasing,y=i.children,b=i.coordinate,_=i.hasPayload,E=i.isAnimationActive,C=i.offset,k=i.position,N=i.reverseDirection,O=i.useTranslate3d,R=i.viewBox,L=i.wrapperStyle,B=HAe({allowEscapeViewBox:h,coordinate:b,offsetTopLeft:C,position:k,reverseDirection:N,tooltipBox:this.state.lastBoundingBox,useTranslate3d:O,viewBox:R}),q=B.cssClasses,F=B.cssProperties,H=y5(y5({transition:E&&o?"transform ".concat(s,"ms ").concat(p):void 0},F),{},{pointerEvents:"none",visibility:!this.state.dismissed&&o&&_?"visible":"hidden",position:"absolute",top:0,left:0},L);return je.createElement("div",{tabIndex:-1,className:q,style:H,ref:function(re){n.wrapperNode=re}},y)}}])}(I.PureComponent),rNe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Ic={isSsr:rNe(),get:function(t){return Ic[t]},set:function(t,r){if(typeof t=="string")Ic[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(i){Ic[i]=t[i]})}}};function $m(e){"@babel/helpers - typeof";return $m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$m(e)}function b5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b5(Object(r),!0).forEach(function(n){uO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wX(n.key),n)}}function iNe(e,t,r){return t&&w5(e.prototype,t),r&&w5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sNe(e,t,r){return t=lS(t),aNe(e,_X()?Reflect.construct(t,r||[],lS(e).constructor):t.apply(e,r))}function aNe(e,t){if(t&&($m(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oNe(e)}function oNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _X(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_X=function(){return!!e})()}function lS(e){return lS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lS(e)}function lNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EN(e,t)}function EN(e,t){return EN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},EN(e,t)}function uO(e,t,r){return t=wX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wX(e){var t=cNe(e,"string");return $m(t)=="symbol"?t:t+""}function cNe(e,t){if($m(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($m(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uNe(e){return e.dataKey}function dNe(e,t){return je.isValidElement(e)?je.cloneElement(e,t):typeof e=="function"?je.createElement(e,t):je.createElement(FAe,t)}var kl=function(e){function t(){return nNe(this,t),sNe(this,t,arguments)}return lNe(t,e),iNe(t,[{key:"render",value:function(){var n=this,i=this.props,o=i.active,h=i.allowEscapeViewBox,s=i.animationDuration,p=i.animationEasing,y=i.content,b=i.coordinate,_=i.filterNull,E=i.isAnimationActive,C=i.offset,k=i.payload,N=i.payloadUniqBy,O=i.position,R=i.reverseDirection,L=i.useTranslate3d,B=i.viewBox,q=i.wrapperStyle,F=k??[];_&&F.length&&(F=dX(k.filter(function(Z){return Z.value!=null&&(Z.hide!==!0||n.props.includeHidden)}),N,uNe));var H=F.length>0;return je.createElement(tNe,{allowEscapeViewBox:h,animationDuration:s,animationEasing:p,isAnimationActive:E,active:o,coordinate:b,hasPayload:H,offset:C,position:O,reverseDirection:R,useTranslate3d:L,viewBox:B,wrapperStyle:q},dNe(y,_5(_5({},this.props),{},{payload:F})))}}])}(I.PureComponent);uO(kl,"displayName","Tooltip");uO(kl,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Ic.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var hNe=Kl,fNe=function(){return hNe.Date.now()},pNe=fNe,mNe=/\s/;function gNe(e){for(var t=e.length;t--&&mNe.test(e.charAt(t)););return t}var yNe=gNe,vNe=yNe,xNe=/^\s+/;function bNe(e){return e&&e.slice(0,vNe(e)+1).replace(xNe,"")}var _Ne=bNe,wNe=_Ne,S5=Md,SNe=Tg,E5=0/0,ENe=/^[-+]0x[0-9a-f]+$/i,TNe=/^0b[01]+$/i,jNe=/^0o[0-7]+$/i,CNe=parseInt;function PNe(e){if(typeof e=="number")return e;if(SNe(e))return E5;if(S5(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=S5(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=wNe(e);var r=TNe.test(e);return r||jNe.test(e)?CNe(e.slice(2),r?2:8):ENe.test(e)?E5:+e}var SX=PNe,ANe=Md,qC=pNe,T5=SX,NNe="Expected a function",kNe=Math.max,MNe=Math.min;function INe(e,t,r){var n,i,o,h,s,p,y=0,b=!1,_=!1,E=!0;if(typeof e!="function")throw new TypeError(NNe);t=T5(t)||0,ANe(r)&&(b=!!r.leading,_="maxWait"in r,o=_?kNe(T5(r.maxWait)||0,t):o,E="trailing"in r?!!r.trailing:E);function C(H){var Z=n,re=i;return n=i=void 0,y=H,h=e.apply(re,Z),h}function k(H){return y=H,s=setTimeout(R,t),b?C(H):h}function N(H){var Z=H-p,re=H-y,W=t-Z;return _?MNe(W,o-re):W}function O(H){var Z=H-p,re=H-y;return p===void 0||Z>=t||Z<0||_&&re>=o}function R(){var H=qC();if(O(H))return L(H);s=setTimeout(R,N(H))}function L(H){return s=void 0,E&&n?C(H):(n=i=void 0,h)}function B(){s!==void 0&&clearTimeout(s),y=0,n=p=i=s=void 0}function q(){return s===void 0?h:L(qC())}function F(){var H=qC(),Z=O(H);if(n=arguments,i=this,p=H,Z){if(s===void 0)return k(p);if(_)return clearTimeout(s),s=setTimeout(R,t),C(p)}return s===void 0&&(s=setTimeout(R,t)),h}return F.cancel=B,F.flush=q,F}var ONe=INe,RNe=ONe,DNe=Md,LNe="Expected a function";function BNe(e,t,r){var n=!0,i=!0;if(typeof e!="function")throw new TypeError(LNe);return DNe(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),RNe(e,t,{leading:n,maxWait:t,trailing:i})}var zNe=BNe;const EX=Sn(zNe);function r0(e){"@babel/helpers - typeof";return r0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r0(e)}function j5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _w(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j5(Object(r),!0).forEach(function(n){$Ne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $Ne(e,t,r){return t=FNe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FNe(e){var t=UNe(e,"string");return r0(t)=="symbol"?t:t+""}function UNe(e,t){if(r0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(r0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VNe(e,t){return HNe(e)||GNe(e,t)||WNe(e,t)||qNe()}function qNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WNe(e,t){if(e){if(typeof e=="string")return C5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C5(e,t)}}function C5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,h,s=[],p=!0,y=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);p=!0);}catch(b){y=!0,i=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw i}}return s}}function HNe(e){if(Array.isArray(e))return e}var XNe=I.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,i=n===void 0?{width:-1,height:-1}:n,o=e.width,h=o===void 0?"100%":o,s=e.height,p=s===void 0?"100%":s,y=e.minWidth,b=y===void 0?0:y,_=e.minHeight,E=e.maxHeight,C=e.children,k=e.debounce,N=k===void 0?0:k,O=e.id,R=e.className,L=e.onResize,B=e.style,q=B===void 0?{}:B,F=I.useRef(null),H=I.useRef();H.current=L,I.useImperativeHandle(t,function(){return Object.defineProperty(F.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),F.current},configurable:!0})});var Z=I.useState({containerWidth:i.width,containerHeight:i.height}),re=VNe(Z,2),W=re[0],te=re[1],oe=I.useCallback(function(ue,_e){te(function(xe){var be=Math.round(ue),Ae=Math.round(_e);return xe.containerWidth===be&&xe.containerHeight===Ae?xe:{containerWidth:be,containerHeight:Ae}})},[]);I.useEffect(function(){var ue=function(ke){var Ne,Be=ke[0].contentRect,We=Be.width,ut=Be.height;oe(We,ut),(Ne=H.current)===null||Ne===void 0||Ne.call(H,We,ut)};N>0&&(ue=EX(ue,N,{trailing:!0,leading:!1}));var _e=new ResizeObserver(ue),xe=F.current.getBoundingClientRect(),be=xe.width,Ae=xe.height;return oe(be,Ae),_e.observe(F.current),function(){_e.disconnect()}},[oe,N]);var ie=I.useMemo(function(){var ue=W.containerWidth,_e=W.containerHeight;if(ue<0||_e<0)return null;Mc(qh(h)||qh(p),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,h,p),Mc(!r||r>0,"The aspect(%s) must be greater than zero.",r);var xe=qh(h)?ue:h,be=qh(p)?_e:p;r&&r>0&&(xe?be=xe/r:be&&(xe=be*r),E&&be>E&&(be=E)),Mc(xe>0||be>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,xe,be,h,p,b,_,r);var Ae=!Array.isArray(C)&&kc(C.type).endsWith("Chart");return je.Children.map(C,function(me){return je.isValidElement(me)?I.cloneElement(me,_w({width:xe,height:be},Ae?{style:_w({height:"100%",width:"100%",maxHeight:be,maxWidth:xe},me.props.style)}:{})):me})},[r,C,p,E,_,b,W,h]);return je.createElement("div",{id:O?"".concat(O):void 0,className:Jr("recharts-responsive-container",R),style:_w(_w({},q),{},{width:h,height:p,minWidth:b,minHeight:_,maxHeight:E}),ref:F},ie)}),TX=function(t){return null};TX.displayName="Cell";function n0(e){"@babel/helpers - typeof";return n0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n0(e)}function P5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function TN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P5(Object(r),!0).forEach(function(n){KNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KNe(e,t,r){return t=ZNe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZNe(e){var t=YNe(e,"string");return n0(t)=="symbol"?t:t+""}function YNe(e,t){if(n0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(n0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lp={widthCache:{},cacheCount:0},JNe=2e3,QNe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},A5="recharts_measurement_span";function eke(e){var t=TN({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var yx=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ic.isSsr)return{width:0,height:0};var n=eke(r),i=JSON.stringify({text:t,copyStyle:n});if(Lp.widthCache[i])return Lp.widthCache[i];try{var o=document.getElementById(A5);o||(o=document.createElement("span"),o.setAttribute("id",A5),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var h=TN(TN({},QNe),n);Object.assign(o.style,h),o.textContent="".concat(t);var s=o.getBoundingClientRect(),p={width:s.width,height:s.height};return Lp.widthCache[i]=p,++Lp.cacheCount>JNe&&(Lp.cacheCount=0,Lp.widthCache={}),p}catch{return{width:0,height:0}}},tke=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function i0(e){"@babel/helpers - typeof";return i0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i0(e)}function cS(e,t){return ske(e)||ike(e,t)||nke(e,t)||rke()}function rke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nke(e,t){if(e){if(typeof e=="string")return N5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N5(e,t)}}function N5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ike(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,h,s=[],p=!0,y=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);p=!0);}catch(b){y=!0,i=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw i}}return s}}function ske(e){if(Array.isArray(e))return e}function ake(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lke(n.key),n)}}function oke(e,t,r){return t&&k5(e.prototype,t),r&&k5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lke(e){var t=cke(e,"string");return i0(t)=="symbol"?t:t+""}function cke(e,t){if(i0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(i0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,I5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,uke=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,dke=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,jX={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},hke=Object.keys(jX),am="NaN";function fke(e,t){return e*jX[t]}var ww=function(){function e(t,r){ake(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!uke.test(r)&&(this.num=NaN,this.unit=""),hke.includes(r)&&(this.num=fke(t,r),this.unit="px")}return oke(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,i=(n=dke.exec(r))!==null&&n!==void 0?n:[],o=cS(i,3),h=o[1],s=o[2];return new e(parseFloat(h),s??"")}}])}();function CX(e){if(e.includes(am))return am;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=M5.exec(t))!==null&&r!==void 0?r:[],i=cS(n,4),o=i[1],h=i[2],s=i[3],p=ww.parse(o??""),y=ww.parse(s??""),b=h==="*"?p.multiply(y):p.divide(y);if(b.isNaN())return am;t=t.replace(M5,b.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var _,E=(_=I5.exec(t))!==null&&_!==void 0?_:[],C=cS(E,4),k=C[1],N=C[2],O=C[3],R=ww.parse(k??""),L=ww.parse(O??""),B=N==="+"?R.add(L):R.subtract(L);if(B.isNaN())return am;t=t.replace(I5,B.toString())}return t}var O5=/\(([^()]*)\)/;function pke(e){for(var t=e;t.includes("(");){var r=O5.exec(t),n=cS(r,2),i=n[1];t=t.replace(O5,CX(i))}return t}function mke(e){var t=e.replace(/\s+/g,"");return t=pke(t),t=CX(t),t}function gke(e){try{return mke(e)}catch{return am}}function WC(e){var t=gke(e.slice(5,-1));return t===am?"":t}var yke=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],vke=["dx","dy","angle","className","breakAll"];function jN(){return jN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jN.apply(this,arguments)}function R5(e,t){if(e==null)return{};var r=xke(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function D5(e,t){return Ske(e)||wke(e,t)||_ke(e,t)||bke()}function bke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _ke(e,t){if(e){if(typeof e=="string")return L5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L5(e,t)}}function L5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,h,s=[],p=!0,y=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);p=!0);}catch(b){y=!0,i=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw i}}return s}}function Ske(e){if(Array.isArray(e))return e}var PX=/[ \f\n\r\t\v\u2028\u2029]+/,AX=function(t){var r=t.children,n=t.breakAll,i=t.style;try{var o=[];Hr(r)||(n?o=r.toString().split(""):o=r.toString().split(PX));var h=o.map(function(p){return{word:p,width:yx(p,i).width}}),s=n?0:yx("",i).width;return{wordsWithComputedWidth:h,spaceWidth:s}}catch{return null}},Eke=function(t,r,n,i,o){var h=t.maxLines,s=t.children,p=t.style,y=t.breakAll,b=qt(h),_=s,E=function(){var xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return xe.reduce(function(be,Ae){var me=Ae.word,ke=Ae.width,Ne=be[be.length-1];if(Ne&&(i==null||o||Ne.width+ke+n<Number(i)))Ne.words.push(me),Ne.width+=ke+n;else{var Be={words:[me],width:ke};be.push(Be)}return be},[])},C=E(r),k=function(xe){return xe.reduce(function(be,Ae){return be.width>Ae.width?be:Ae})};if(!b)return C;for(var N="",O=function(xe){var be=_.slice(0,xe),Ae=AX({breakAll:y,style:p,children:be+N}).wordsWithComputedWidth,me=E(Ae),ke=me.length>h||k(me).width>Number(i);return[ke,me]},R=0,L=_.length-1,B=0,q;R<=L&&B<=_.length-1;){var F=Math.floor((R+L)/2),H=F-1,Z=O(H),re=D5(Z,2),W=re[0],te=re[1],oe=O(F),ie=D5(oe,1),ue=ie[0];if(!W&&!ue&&(R=F+1),W&&ue&&(L=F-1),!W&&ue){q=te;break}B++}return q||C},B5=function(t){var r=Hr(t)?[]:t.toString().split(PX);return[{words:r}]},Tke=function(t){var r=t.width,n=t.scaleToFit,i=t.children,o=t.style,h=t.breakAll,s=t.maxLines;if((r||n)&&!Ic.isSsr){var p,y,b=AX({breakAll:h,children:i,style:o});if(b){var _=b.wordsWithComputedWidth,E=b.spaceWidth;p=_,y=E}else return B5(i);return Eke({breakAll:h,children:i,maxLines:s,style:o},p,y,r,n)}return B5(i)},z5="#808080",uS=function(t){var r=t.x,n=r===void 0?0:r,i=t.y,o=i===void 0?0:i,h=t.lineHeight,s=h===void 0?"1em":h,p=t.capHeight,y=p===void 0?"0.71em":p,b=t.scaleToFit,_=b===void 0?!1:b,E=t.textAnchor,C=E===void 0?"start":E,k=t.verticalAnchor,N=k===void 0?"end":k,O=t.fill,R=O===void 0?z5:O,L=R5(t,yke),B=I.useMemo(function(){return Tke({breakAll:L.breakAll,children:L.children,maxLines:L.maxLines,scaleToFit:_,style:L.style,width:L.width})},[L.breakAll,L.children,L.maxLines,_,L.style,L.width]),q=L.dx,F=L.dy,H=L.angle,Z=L.className,re=L.breakAll,W=R5(L,vke);if(!Fi(n)||!Fi(o))return null;var te=n+(qt(q)?q:0),oe=o+(qt(F)?F:0),ie;switch(N){case"start":ie=WC("calc(".concat(y,")"));break;case"middle":ie=WC("calc(".concat((B.length-1)/2," * -").concat(s," + (").concat(y," / 2))"));break;default:ie=WC("calc(".concat(B.length-1," * -").concat(s,")"));break}var ue=[];if(_){var _e=B[0].width,xe=L.width;ue.push("scale(".concat((qt(xe)?xe/_e:1)/_e,")"))}return H&&ue.push("rotate(".concat(H,", ").concat(te,", ").concat(oe,")")),ue.length&&(W.transform=ue.join(" ")),je.createElement("text",jN({},Kr(W,!0),{x:te,y:oe,className:Jr("recharts-text",Z),textAnchor:C,fill:R.includes("url")?z5:R}),B.map(function(be,Ae){var me=be.words.join(re?"":" ");return je.createElement("tspan",{x:te,dy:Ae===0?ie:s,key:"".concat(me,"-").concat(Ae)},me)}))};function hd(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function jke(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function dO(e){let t,r,n;e.length!==2?(t=hd,r=(s,p)=>hd(e(s),p),n=(s,p)=>e(s)-p):(t=e===hd||e===jke?e:Cke,r=e,n=e);function i(s,p,y=0,b=s.length){if(y<b){if(t(p,p)!==0)return b;do{const _=y+b>>>1;r(s[_],p)<0?y=_+1:b=_}while(y<b)}return y}function o(s,p,y=0,b=s.length){if(y<b){if(t(p,p)!==0)return b;do{const _=y+b>>>1;r(s[_],p)<=0?y=_+1:b=_}while(y<b)}return y}function h(s,p,y=0,b=s.length){const _=i(s,p,y,b-1);return _>y&&n(s[_-1],p)>-n(s[_],p)?_-1:_}return{left:i,center:h,right:o}}function Cke(){return 0}function NX(e){return e===null?NaN:+e}function*Pke(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}const Ake=dO(hd),Nke=Ake.right;dO(NX).center;const rb=Nke;class $5 extends Map{constructor(t,r=Ike){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(F5(this,t))}has(t){return super.has(F5(this,t))}set(t,r){return super.set(kke(this,t),r)}delete(t){return super.delete(Mke(this,t))}}function F5({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function kke({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function Mke({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function Ike(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Oke(e=hd){if(e===hd)return kX;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function kX(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Rke=Math.sqrt(50),Dke=Math.sqrt(10),Lke=Math.sqrt(2);function dS(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),o=n/Math.pow(10,i),h=o>=Rke?10:o>=Dke?5:o>=Lke?2:1;let s,p,y;return i<0?(y=Math.pow(10,-i)/h,s=Math.round(e*y),p=Math.round(t*y),s/y<e&&++s,p/y>t&&--p,y=-y):(y=Math.pow(10,i)*h,s=Math.round(e/y),p=Math.round(t/y),s*y<e&&++s,p*y>t&&--p),p<s&&.5<=r&&r<2?dS(e,t,r*2):[s,p,y]}function CN(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,o,h]=n?dS(t,e,r):dS(e,t,r);if(!(o>=i))return[];const s=o-i+1,p=new Array(s);if(n)if(h<0)for(let y=0;y<s;++y)p[y]=(o-y)/-h;else for(let y=0;y<s;++y)p[y]=(o-y)*h;else if(h<0)for(let y=0;y<s;++y)p[y]=(i+y)/-h;else for(let y=0;y<s;++y)p[y]=(i+y)*h;return p}function PN(e,t,r){return t=+t,e=+e,r=+r,dS(e,t,r)[2]}function AN(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?PN(t,e,r):PN(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function U5(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r<i||r===void 0&&i>=i)&&(r=i)}return r}function V5(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r>i||r===void 0&&i>=i)&&(r=i)}return r}function MX(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?kX:Oke(i);n>r;){if(n-r>600){const p=n-r+1,y=t-r+1,b=Math.log(p),_=.5*Math.exp(2*b/3),E=.5*Math.sqrt(b*_*(p-_)/p)*(y-p/2<0?-1:1),C=Math.max(r,Math.floor(t-y*_/p+E)),k=Math.min(n,Math.floor(t+(p-y)*_/p+E));MX(e,t,C,k,i)}const o=e[t];let h=r,s=n;for(Ov(e,r,t),i(e[n],o)>0&&Ov(e,r,n);h<s;){for(Ov(e,h,s),++h,--s;i(e[h],o)<0;)++h;for(;i(e[s],o)>0;)--s}i(e[r],o)===0?Ov(e,r,s):(++s,Ov(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}return e}function Ov(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Bke(e,t,r){if(e=Float64Array.from(Pke(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return V5(e);if(t>=1)return U5(e);var n,i=(n-1)*t,o=Math.floor(i),h=U5(MX(e,o).subarray(0,o+1)),s=V5(e.subarray(o+1));return h+(s-h)*(i-o)}}function zke(e,t,r=NX){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,o=Math.floor(i),h=+r(e[o],o,e),s=+r(e[o+1],o+1,e);return h+(s-h)*(i-o)}}function $ke(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,o=new Array(i);++n<i;)o[n]=e+n*r;return o}function _o(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function tu(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const NN=Symbol("implicit");function hO(){var e=new $5,t=[],r=[],n=NN;function i(o){let h=e.get(o);if(h===void 0){if(n!==NN)return n;e.set(o,h=t.push(o)-1)}return r[h%r.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new $5;for(const h of o)e.has(h)||e.set(h,t.push(h)-1);return i},i.range=function(o){return arguments.length?(r=Array.from(o),i):r.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return hO(t,r).unknown(n)},_o.apply(i,arguments),i}function s0(){var e=hO().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,o,h,s=!1,p=0,y=0,b=.5;delete e.unknown;function _(){var E=t().length,C=i<n,k=C?i:n,N=C?n:i;o=(N-k)/Math.max(1,E-p+y*2),s&&(o=Math.floor(o)),k+=(N-k-o*(E-p))*b,h=o*(1-p),s&&(k=Math.round(k),h=Math.round(h));var O=$ke(E).map(function(R){return k+o*R});return r(C?O.reverse():O)}return e.domain=function(E){return arguments.length?(t(E),_()):t()},e.range=function(E){return arguments.length?([n,i]=E,n=+n,i=+i,_()):[n,i]},e.rangeRound=function(E){return[n,i]=E,n=+n,i=+i,s=!0,_()},e.bandwidth=function(){return h},e.step=function(){return o},e.round=function(E){return arguments.length?(s=!!E,_()):s},e.padding=function(E){return arguments.length?(p=Math.min(1,y=+E),_()):p},e.paddingInner=function(E){return arguments.length?(p=Math.min(1,E),_()):p},e.paddingOuter=function(E){return arguments.length?(y=+E,_()):y},e.align=function(E){return arguments.length?(b=Math.max(0,Math.min(1,E)),_()):b},e.copy=function(){return s0(t(),[n,i]).round(s).paddingInner(p).paddingOuter(y).align(b)},_o.apply(_(),arguments)}function IX(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return IX(t())},e}function vx(){return IX(s0.apply(null,arguments).paddingInner(1))}function fO(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function OX(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function nb(){}var a0=.7,hS=1/a0,xm="\\s*([+-]?\\d+)\\s*",o0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ul="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Fke=/^#([0-9a-f]{3,8})$/,Uke=new RegExp(`^rgb\\(${xm},${xm},${xm}\\)$`),Vke=new RegExp(`^rgb\\(${Ul},${Ul},${Ul}\\)$`),qke=new RegExp(`^rgba\\(${xm},${xm},${xm},${o0}\\)$`),Wke=new RegExp(`^rgba\\(${Ul},${Ul},${Ul},${o0}\\)$`),Gke=new RegExp(`^hsl\\(${o0},${Ul},${Ul}\\)$`),Hke=new RegExp(`^hsla\\(${o0},${Ul},${Ul},${o0}\\)$`),q5={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};fO(nb,l0,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:W5,formatHex:W5,formatHex8:Xke,formatHsl:Kke,formatRgb:G5,toString:G5});function W5(){return this.rgb().formatHex()}function Xke(){return this.rgb().formatHex8()}function Kke(){return RX(this).formatHsl()}function G5(){return this.rgb().formatRgb()}function l0(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Fke.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?H5(t):r===3?new ua(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Sw(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Sw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Uke.exec(e))?new ua(t[1],t[2],t[3],1):(t=Vke.exec(e))?new ua(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=qke.exec(e))?Sw(t[1],t[2],t[3],t[4]):(t=Wke.exec(e))?Sw(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Gke.exec(e))?Z5(t[1],t[2]/100,t[3]/100,1):(t=Hke.exec(e))?Z5(t[1],t[2]/100,t[3]/100,t[4]):q5.hasOwnProperty(e)?H5(q5[e]):e==="transparent"?new ua(NaN,NaN,NaN,0):null}function H5(e){return new ua(e>>16&255,e>>8&255,e&255,1)}function Sw(e,t,r,n){return n<=0&&(e=t=r=NaN),new ua(e,t,r,n)}function Zke(e){return e instanceof nb||(e=l0(e)),e?(e=e.rgb(),new ua(e.r,e.g,e.b,e.opacity)):new ua}function kN(e,t,r,n){return arguments.length===1?Zke(e):new ua(e,t,r,n??1)}function ua(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}fO(ua,kN,OX(nb,{brighter(e){return e=e==null?hS:Math.pow(hS,e),new ua(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?a0:Math.pow(a0,e),new ua(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ua(Jh(this.r),Jh(this.g),Jh(this.b),fS(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:X5,formatHex:X5,formatHex8:Yke,formatRgb:K5,toString:K5}));function X5(){return`#${Wh(this.r)}${Wh(this.g)}${Wh(this.b)}`}function Yke(){return`#${Wh(this.r)}${Wh(this.g)}${Wh(this.b)}${Wh((isNaN(this.opacity)?1:this.opacity)*255)}`}function K5(){const e=fS(this.opacity);return`${e===1?"rgb(":"rgba("}${Jh(this.r)}, ${Jh(this.g)}, ${Jh(this.b)}${e===1?")":`, ${e})`}`}function fS(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Jh(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wh(e){return e=Jh(e),(e<16?"0":"")+e.toString(16)}function Z5(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new il(e,t,r,n)}function RX(e){if(e instanceof il)return new il(e.h,e.s,e.l,e.opacity);if(e instanceof nb||(e=l0(e)),!e)return new il;if(e instanceof il)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),o=Math.max(t,r,n),h=NaN,s=o-i,p=(o+i)/2;return s?(t===o?h=(r-n)/s+(r<n)*6:r===o?h=(n-t)/s+2:h=(t-r)/s+4,s/=p<.5?o+i:2-o-i,h*=60):s=p>0&&p<1?0:h,new il(h,s,p,e.opacity)}function Jke(e,t,r,n){return arguments.length===1?RX(e):new il(e,t,r,n??1)}function il(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}fO(il,Jke,OX(nb,{brighter(e){return e=e==null?hS:Math.pow(hS,e),new il(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?a0:Math.pow(a0,e),new il(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new ua(GC(e>=240?e-240:e+120,i,n),GC(e,i,n),GC(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new il(Y5(this.h),Ew(this.s),Ew(this.l),fS(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=fS(this.opacity);return`${e===1?"hsl(":"hsla("}${Y5(this.h)}, ${Ew(this.s)*100}%, ${Ew(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Y5(e){return e=(e||0)%360,e<0?e+360:e}function Ew(e){return Math.max(0,Math.min(1,e||0))}function GC(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const pO=e=>()=>e;function Qke(e,t){return function(r){return e+r*t}}function eMe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function tMe(e){return(e=+e)==1?DX:function(t,r){return r-t?eMe(t,r,e):pO(isNaN(t)?r:t)}}function DX(e,t){var r=t-e;return r?Qke(e,r):pO(isNaN(e)?t:e)}const J5=function e(t){var r=tMe(t);function n(i,o){var h=r((i=kN(i)).r,(o=kN(o)).r),s=r(i.g,o.g),p=r(i.b,o.b),y=DX(i.opacity,o.opacity);return function(b){return i.r=h(b),i.g=s(b),i.b=p(b),i.opacity=y(b),i+""}}return n.gamma=e,n}(1);function rMe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(o){for(i=0;i<r;++i)n[i]=e[i]*(1-o)+t[i]*o;return n}}function nMe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function iMe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),o=new Array(r),h;for(h=0;h<n;++h)i[h]=Ig(e[h],t[h]);for(;h<r;++h)o[h]=t[h];return function(s){for(h=0;h<n;++h)o[h]=i[h](s);return o}}function sMe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function pS(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function aMe(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=Ig(e[i],t[i]):n[i]=t[i];return function(o){for(i in r)n[i]=r[i](o);return n}}var MN=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,HC=new RegExp(MN.source,"g");function oMe(e){return function(){return e}}function lMe(e){return function(t){return e(t)+""}}function cMe(e,t){var r=MN.lastIndex=HC.lastIndex=0,n,i,o,h=-1,s=[],p=[];for(e=e+"",t=t+"";(n=MN.exec(e))&&(i=HC.exec(t));)(o=i.index)>r&&(o=t.slice(r,o),s[h]?s[h]+=o:s[++h]=o),(n=n[0])===(i=i[0])?s[h]?s[h]+=i:s[++h]=i:(s[++h]=null,p.push({i:h,x:pS(n,i)})),r=HC.lastIndex;return r<t.length&&(o=t.slice(r),s[h]?s[h]+=o:s[++h]=o),s.length<2?p[0]?lMe(p[0].x):oMe(t):(t=p.length,function(y){for(var b=0,_;b<t;++b)s[(_=p[b]).i]=_.x(y);return s.join("")})}function Ig(e,t){var r=typeof t,n;return t==null||r==="boolean"?pO(t):(r==="number"?pS:r==="string"?(n=l0(t))?(t=n,J5):cMe:t instanceof l0?J5:t instanceof Date?sMe:nMe(t)?rMe:Array.isArray(t)?iMe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?aMe:pS)(e,t)}function mO(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function uMe(e,t){t===void 0&&(t=e,e=Ig);for(var r=0,n=t.length-1,i=t[0],o=new Array(n<0?0:n);r<n;)o[r]=e(i,i=t[++r]);return function(h){var s=Math.max(0,Math.min(n-1,Math.floor(h*=n)));return o[s](h-s)}}function dMe(e){return function(){return e}}function mS(e){return+e}var Q5=[0,1];function Us(e){return e}function IN(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:dMe(isNaN(t)?NaN:.5)}function hMe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function fMe(e,t,r){var n=e[0],i=e[1],o=t[0],h=t[1];return i<n?(n=IN(i,n),o=r(h,o)):(n=IN(n,i),o=r(o,h)),function(s){return o(n(s))}}function pMe(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),o=new Array(n),h=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++h<n;)i[h]=IN(e[h],e[h+1]),o[h]=r(t[h],t[h+1]);return function(s){var p=rb(e,s,1,n)-1;return o[p](i[p](s))}}function ib(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function _2(){var e=Q5,t=Q5,r=Ig,n,i,o,h=Us,s,p,y;function b(){var E=Math.min(e.length,t.length);return h!==Us&&(h=hMe(e[0],e[E-1])),s=E>2?pMe:fMe,p=y=null,_}function _(E){return E==null||isNaN(E=+E)?o:(p||(p=s(e.map(n),t,r)))(n(h(E)))}return _.invert=function(E){return h(i((y||(y=s(t,e.map(n),pS)))(E)))},_.domain=function(E){return arguments.length?(e=Array.from(E,mS),b()):e.slice()},_.range=function(E){return arguments.length?(t=Array.from(E),b()):t.slice()},_.rangeRound=function(E){return t=Array.from(E),r=mO,b()},_.clamp=function(E){return arguments.length?(h=E?!0:Us,b()):h!==Us},_.interpolate=function(E){return arguments.length?(r=E,b()):r},_.unknown=function(E){return arguments.length?(o=E,_):o},function(E,C){return n=E,i=C,b()}}function gO(){return _2()(Us,Us)}function mMe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function gS(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Fm(e){return e=gS(Math.abs(e)),e?e[1]:NaN}function gMe(e,t){return function(r,n){for(var i=r.length,o=[],h=0,s=e[0],p=0;i>0&&s>0&&(p+s+1>n&&(s=Math.max(1,n-p)),o.push(r.substring(i-=s,i+s)),!((p+=s+1)>n));)s=e[h=(h+1)%e.length];return o.reverse().join(t)}}function yMe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var vMe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function c0(e){if(!(t=vMe.exec(e)))throw new Error("invalid format: "+e);var t;return new yO({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}c0.prototype=yO.prototype;function yO(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}yO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function xMe(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var LX;function bMe(e,t){var r=gS(e,t);if(!r)return e+"";var n=r[0],i=r[1],o=i-(LX=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,h=n.length;return o===h?n:o>h?n+new Array(o-h+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+gS(e,Math.max(0,t+o-1))[0]}function e$(e,t){var r=gS(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const t$={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:mMe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>e$(e*100,t),r:e$,s:bMe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function r$(e){return e}var n$=Array.prototype.map,i$=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function _Me(e){var t=e.grouping===void 0||e.thousands===void 0?r$:gMe(n$.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?r$:yMe(n$.call(e.numerals,String)),h=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"":e.minus+"",p=e.nan===void 0?"NaN":e.nan+"";function y(_){_=c0(_);var E=_.fill,C=_.align,k=_.sign,N=_.symbol,O=_.zero,R=_.width,L=_.comma,B=_.precision,q=_.trim,F=_.type;F==="n"?(L=!0,F="g"):t$[F]||(B===void 0&&(B=12),q=!0,F="g"),(O||E==="0"&&C==="=")&&(O=!0,E="0",C="=");var H=N==="$"?r:N==="#"&&/[boxX]/.test(F)?"0"+F.toLowerCase():"",Z=N==="$"?n:/[%p]/.test(F)?h:"",re=t$[F],W=/[defgprs%]/.test(F);B=B===void 0?6:/[gprs]/.test(F)?Math.max(1,Math.min(21,B)):Math.max(0,Math.min(20,B));function te(oe){var ie=H,ue=Z,_e,xe,be;if(F==="c")ue=re(oe)+ue,oe="";else{oe=+oe;var Ae=oe<0||1/oe<0;if(oe=isNaN(oe)?p:re(Math.abs(oe),B),q&&(oe=xMe(oe)),Ae&&+oe==0&&k!=="+"&&(Ae=!1),ie=(Ae?k==="("?k:s:k==="-"||k==="("?"":k)+ie,ue=(F==="s"?i$[8+LX/3]:"")+ue+(Ae&&k==="("?")":""),W){for(_e=-1,xe=oe.length;++_e<xe;)if(be=oe.charCodeAt(_e),48>be||be>57){ue=(be===46?i+oe.slice(_e+1):oe.slice(_e))+ue,oe=oe.slice(0,_e);break}}}L&&!O&&(oe=t(oe,1/0));var me=ie.length+oe.length+ue.length,ke=me<R?new Array(R-me+1).join(E):"";switch(L&&O&&(oe=t(ke+oe,ke.length?R-ue.length:1/0),ke=""),C){case"<":oe=ie+oe+ue+ke;break;case"=":oe=ie+ke+oe+ue;break;case"^":oe=ke.slice(0,me=ke.length>>1)+ie+oe+ue+ke.slice(me);break;default:oe=ke+ie+oe+ue;break}return o(oe)}return te.toString=function(){return _+""},te}function b(_,E){var C=y((_=c0(_),_.type="f",_)),k=Math.max(-8,Math.min(8,Math.floor(Fm(E)/3)))*3,N=Math.pow(10,-k),O=i$[8+k/3];return function(R){return C(N*R)+O}}return{format:y,formatPrefix:b}}var Tw,vO,BX;wMe({thousands:",",grouping:[3],currency:["$",""]});function wMe(e){return Tw=_Me(e),vO=Tw.format,BX=Tw.formatPrefix,Tw}function SMe(e){return Math.max(0,-Fm(Math.abs(e)))}function EMe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Fm(t)/3)))*3-Fm(Math.abs(e)))}function TMe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Fm(t)-Fm(e))+1}function zX(e,t,r,n){var i=AN(e,t,r),o;switch(n=c0(n??",f"),n.type){case"s":{var h=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(o=EMe(i,h))&&(n.precision=o),BX(n,h)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=TMe(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=SMe(i))&&(n.precision=o-(n.type==="%")*2);break}}return vO(n)}function Od(e){var t=e.domain;return e.ticks=function(r){var n=t();return CN(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return zX(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,o=n.length-1,h=n[i],s=n[o],p,y,b=10;for(s<h&&(y=h,h=s,s=y,y=i,i=o,o=y);b-- >0;){if(y=PN(h,s,r),y===p)return n[i]=h,n[o]=s,t(n);if(y>0)h=Math.floor(h/y)*y,s=Math.ceil(s/y)*y;else if(y<0)h=Math.ceil(h*y)/y,s=Math.floor(s*y)/y;else break;p=y}return e},e}function yS(){var e=gO();return e.copy=function(){return ib(e,yS())},_o.apply(e,arguments),Od(e)}function $X(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,mS),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return $X(e).unknown(t)},e=arguments.length?Array.from(e,mS):[0,1],Od(r)}function FX(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],o=e[n],h;return o<i&&(h=r,r=n,n=h,h=i,i=o,o=h),e[r]=t.floor(i),e[n]=t.ceil(o),e}function s$(e){return Math.log(e)}function a$(e){return Math.exp(e)}function jMe(e){return-Math.log(-e)}function CMe(e){return-Math.exp(-e)}function PMe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function AMe(e){return e===10?PMe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function NMe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function o$(e){return(t,r)=>-e(-t,r)}function xO(e){const t=e(s$,a$),r=t.domain;let n=10,i,o;function h(){return i=NMe(n),o=AMe(n),r()[0]<0?(i=o$(i),o=o$(o),e(jMe,CMe)):e(s$,a$),t}return t.base=function(s){return arguments.length?(n=+s,h()):n},t.domain=function(s){return arguments.length?(r(s),h()):r()},t.ticks=s=>{const p=r();let y=p[0],b=p[p.length-1];const _=b<y;_&&([y,b]=[b,y]);let E=i(y),C=i(b),k,N;const O=s==null?10:+s;let R=[];if(!(n%1)&&C-E<O){if(E=Math.floor(E),C=Math.ceil(C),y>0){for(;E<=C;++E)for(k=1;k<n;++k)if(N=E<0?k/o(-E):k*o(E),!(N<y)){if(N>b)break;R.push(N)}}else for(;E<=C;++E)for(k=n-1;k>=1;--k)if(N=E>0?k/o(-E):k*o(E),!(N<y)){if(N>b)break;R.push(N)}R.length*2<O&&(R=CN(y,b,O))}else R=CN(E,C,Math.min(C-E,O)).map(o);return _?R.reverse():R},t.tickFormat=(s,p)=>{if(s==null&&(s=10),p==null&&(p=n===10?"s":","),typeof p!="function"&&(!(n%1)&&(p=c0(p)).precision==null&&(p.trim=!0),p=vO(p)),s===1/0)return p;const y=Math.max(1,n*s/t.ticks().length);return b=>{let _=b/o(Math.round(i(b)));return _*n<n-.5&&(_*=n),_<=y?p(b):""}},t.nice=()=>r(FX(r(),{floor:s=>o(Math.floor(i(s))),ceil:s=>o(Math.ceil(i(s)))})),t}function UX(){const e=xO(_2()).domain([1,10]);return e.copy=()=>ib(e,UX()).base(e.base()),_o.apply(e,arguments),e}function l$(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function c$(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function bO(e){var t=1,r=e(l$(t),c$(t));return r.constant=function(n){return arguments.length?e(l$(t=+n),c$(t)):t},Od(r)}function VX(){var e=bO(_2());return e.copy=function(){return ib(e,VX()).constant(e.constant())},_o.apply(e,arguments)}function u$(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function kMe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function MMe(e){return e<0?-e*e:e*e}function _O(e){var t=e(Us,Us),r=1;function n(){return r===1?e(Us,Us):r===.5?e(kMe,MMe):e(u$(r),u$(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Od(t)}function wO(){var e=_O(_2());return e.copy=function(){return ib(e,wO()).exponent(e.exponent())},_o.apply(e,arguments),e}function IMe(){return wO.apply(null,arguments).exponent(.5)}function d$(e){return Math.sign(e)*e*e}function OMe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function qX(){var e=gO(),t=[0,1],r=!1,n;function i(o){var h=OMe(e(o));return isNaN(h)?n:r?Math.round(h):h}return i.invert=function(o){return e.invert(d$(o))},i.domain=function(o){return arguments.length?(e.domain(o),i):e.domain()},i.range=function(o){return arguments.length?(e.range((t=Array.from(o,mS)).map(d$)),i):t.slice()},i.rangeRound=function(o){return i.range(o).round(!0)},i.round=function(o){return arguments.length?(r=!!o,i):r},i.clamp=function(o){return arguments.length?(e.clamp(o),i):e.clamp()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return qX(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},_o.apply(i,arguments),Od(i)}function WX(){var e=[],t=[],r=[],n;function i(){var h=0,s=Math.max(1,t.length);for(r=new Array(s-1);++h<s;)r[h-1]=zke(e,h/s);return o}function o(h){return h==null||isNaN(h=+h)?n:t[rb(r,h)]}return o.invertExtent=function(h){var s=t.indexOf(h);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},o.domain=function(h){if(!arguments.length)return e.slice();e=[];for(let s of h)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(hd),i()},o.range=function(h){return arguments.length?(t=Array.from(h),i()):t.slice()},o.unknown=function(h){return arguments.length?(n=h,o):n},o.quantiles=function(){return r.slice()},o.copy=function(){return WX().domain(e).range(t).unknown(n)},_o.apply(o,arguments)}function GX(){var e=0,t=1,r=1,n=[.5],i=[0,1],o;function h(p){return p!=null&&p<=p?i[rb(n,p,0,r)]:o}function s(){var p=-1;for(n=new Array(r);++p<r;)n[p]=((p+1)*t-(p-r)*e)/(r+1);return h}return h.domain=function(p){return arguments.length?([e,t]=p,e=+e,t=+t,s()):[e,t]},h.range=function(p){return arguments.length?(r=(i=Array.from(p)).length-1,s()):i.slice()},h.invertExtent=function(p){var y=i.indexOf(p);return y<0?[NaN,NaN]:y<1?[e,n[0]]:y>=r?[n[r-1],t]:[n[y-1],n[y]]},h.unknown=function(p){return arguments.length&&(o=p),h},h.thresholds=function(){return n.slice()},h.copy=function(){return GX().domain([e,t]).range(i).unknown(o)},_o.apply(Od(h),arguments)}function HX(){var e=[.5],t=[0,1],r,n=1;function i(o){return o!=null&&o<=o?t[rb(e,o,0,n)]:r}return i.domain=function(o){return arguments.length?(e=Array.from(o),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var h=t.indexOf(o);return[e[h-1],e[h]]},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return HX().domain(e).range(t).unknown(r)},_o.apply(i,arguments)}const XC=new Date,KC=new Date;function Vi(e,t,r,n){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{const h=i(o),s=i.ceil(o);return o-h<s-o?h:s},i.offset=(o,h)=>(t(o=new Date(+o),h==null?1:Math.floor(h)),o),i.range=(o,h,s)=>{const p=[];if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<h)||!(s>0))return p;let y;do p.push(y=new Date(+o)),t(o,s),e(o);while(y<o&&o<h);return p},i.filter=o=>Vi(h=>{if(h>=h)for(;e(h),!o(h);)h.setTime(h-1)},(h,s)=>{if(h>=h)if(s<0)for(;++s<=0;)for(;t(h,-1),!o(h););else for(;--s>=0;)for(;t(h,1),!o(h););}),r&&(i.count=(o,h)=>(XC.setTime(+o),KC.setTime(+h),e(XC),e(KC),Math.floor(r(XC,KC))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(n?h=>n(h)%o===0:h=>i.count(0,h)%o===0):i)),i}const vS=Vi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);vS.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Vi(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):vS);vS.range;const Tc=1e3,uo=Tc*60,jc=uo*60,Hc=jc*24,SO=Hc*7,h$=Hc*30,ZC=Hc*365,Gh=Vi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Tc)},(e,t)=>(t-e)/Tc,e=>e.getUTCSeconds());Gh.range;const EO=Vi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Tc)},(e,t)=>{e.setTime(+e+t*uo)},(e,t)=>(t-e)/uo,e=>e.getMinutes());EO.range;const TO=Vi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*uo)},(e,t)=>(t-e)/uo,e=>e.getUTCMinutes());TO.range;const jO=Vi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Tc-e.getMinutes()*uo)},(e,t)=>{e.setTime(+e+t*jc)},(e,t)=>(t-e)/jc,e=>e.getHours());jO.range;const CO=Vi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*jc)},(e,t)=>(t-e)/jc,e=>e.getUTCHours());CO.range;const sb=Vi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*uo)/Hc,e=>e.getDate()-1);sb.range;const w2=Vi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Hc,e=>e.getUTCDate()-1);w2.range;const XX=Vi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Hc,e=>Math.floor(e/Hc));XX.range;function jf(e){return Vi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*uo)/SO)}const S2=jf(0),xS=jf(1),RMe=jf(2),DMe=jf(3),Um=jf(4),LMe=jf(5),BMe=jf(6);S2.range;xS.range;RMe.range;DMe.range;Um.range;LMe.range;BMe.range;function Cf(e){return Vi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/SO)}const E2=Cf(0),bS=Cf(1),zMe=Cf(2),$Me=Cf(3),Vm=Cf(4),FMe=Cf(5),UMe=Cf(6);E2.range;bS.range;zMe.range;$Me.range;Vm.range;FMe.range;UMe.range;const PO=Vi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());PO.range;const AO=Vi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());AO.range;const Xc=Vi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Xc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Xc.range;const Kc=Vi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Kc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Kc.range;function KX(e,t,r,n,i,o){const h=[[Gh,1,Tc],[Gh,5,5*Tc],[Gh,15,15*Tc],[Gh,30,30*Tc],[o,1,uo],[o,5,5*uo],[o,15,15*uo],[o,30,30*uo],[i,1,jc],[i,3,3*jc],[i,6,6*jc],[i,12,12*jc],[n,1,Hc],[n,2,2*Hc],[r,1,SO],[t,1,h$],[t,3,3*h$],[e,1,ZC]];function s(y,b,_){const E=b<y;E&&([y,b]=[b,y]);const C=_&&typeof _.range=="function"?_:p(y,b,_),k=C?C.range(y,+b+1):[];return E?k.reverse():k}function p(y,b,_){const E=Math.abs(b-y)/_,C=dO(([,,O])=>O).right(h,E);if(C===h.length)return e.every(AN(y/ZC,b/ZC,_));if(C===0)return vS.every(Math.max(AN(y,b,_),1));const[k,N]=h[E/h[C-1][2]<h[C][2]/E?C-1:C];return k.every(N)}return[s,p]}const[VMe,qMe]=KX(Kc,AO,E2,XX,CO,TO),[WMe,GMe]=KX(Xc,PO,S2,sb,jO,EO);function YC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function JC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Rv(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function HMe(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,o=e.days,h=e.shortDays,s=e.months,p=e.shortMonths,y=Dv(i),b=Lv(i),_=Dv(o),E=Lv(o),C=Dv(h),k=Lv(h),N=Dv(s),O=Lv(s),R=Dv(p),L=Lv(p),B={a:Ae,A:me,b:ke,B:Ne,c:null,d:v$,e:v$,f:gIe,g:jIe,G:PIe,H:fIe,I:pIe,j:mIe,L:ZX,m:yIe,M:vIe,p:Be,q:We,Q:_$,s:w$,S:xIe,u:bIe,U:_Ie,V:wIe,w:SIe,W:EIe,x:null,X:null,y:TIe,Y:CIe,Z:AIe,"%":b$},q={a:ut,A:nt,b:Pt,B:It,c:null,d:x$,e:x$,f:IIe,g:VIe,G:WIe,H:NIe,I:kIe,j:MIe,L:JX,m:OIe,M:RIe,p:at,q:Ut,Q:_$,s:w$,S:DIe,u:LIe,U:BIe,V:zIe,w:$Ie,W:FIe,x:null,X:null,y:UIe,Y:qIe,Z:GIe,"%":b$},F={a:te,A:oe,b:ie,B:ue,c:_e,d:g$,e:g$,f:cIe,g:m$,G:p$,H:y$,I:y$,j:sIe,L:lIe,m:iIe,M:aIe,p:W,q:nIe,Q:dIe,s:hIe,S:oIe,u:JMe,U:QMe,V:eIe,w:YMe,W:tIe,x:xe,X:be,y:m$,Y:p$,Z:rIe,"%":uIe};B.x=H(r,B),B.X=H(n,B),B.c=H(t,B),q.x=H(r,q),q.X=H(n,q),q.c=H(t,q);function H(ct,gt){return function(it){var rt=[],rr=-1,ir=0,or=ct.length,Sr,tn,Mn;for(it instanceof Date||(it=new Date(+it));++rr<or;)ct.charCodeAt(rr)===37&&(rt.push(ct.slice(ir,rr)),(tn=f$[Sr=ct.charAt(++rr)])!=null?Sr=ct.charAt(++rr):tn=Sr==="e"?" ":"0",(Mn=gt[Sr])&&(Sr=Mn(it,tn)),rt.push(Sr),ir=rr+1);return rt.push(ct.slice(ir,rr)),rt.join("")}}function Z(ct,gt){return function(it){var rt=Rv(1900,void 0,1),rr=re(rt,ct,it+="",0),ir,or;if(rr!=it.length)return null;if("Q"in rt)return new Date(rt.Q);if("s"in rt)return new Date(rt.s*1e3+("L"in rt?rt.L:0));if(gt&&!("Z"in rt)&&(rt.Z=0),"p"in rt&&(rt.H=rt.H%12+rt.p*12),rt.m===void 0&&(rt.m="q"in rt?rt.q:0),"V"in rt){if(rt.V<1||rt.V>53)return null;"w"in rt||(rt.w=1),"Z"in rt?(ir=JC(Rv(rt.y,0,1)),or=ir.getUTCDay(),ir=or>4||or===0?bS.ceil(ir):bS(ir),ir=w2.offset(ir,(rt.V-1)*7),rt.y=ir.getUTCFullYear(),rt.m=ir.getUTCMonth(),rt.d=ir.getUTCDate()+(rt.w+6)%7):(ir=YC(Rv(rt.y,0,1)),or=ir.getDay(),ir=or>4||or===0?xS.ceil(ir):xS(ir),ir=sb.offset(ir,(rt.V-1)*7),rt.y=ir.getFullYear(),rt.m=ir.getMonth(),rt.d=ir.getDate()+(rt.w+6)%7)}else("W"in rt||"U"in rt)&&("w"in rt||(rt.w="u"in rt?rt.u%7:"W"in rt?1:0),or="Z"in rt?JC(Rv(rt.y,0,1)).getUTCDay():YC(Rv(rt.y,0,1)).getDay(),rt.m=0,rt.d="W"in rt?(rt.w+6)%7+rt.W*7-(or+5)%7:rt.w+rt.U*7-(or+6)%7);return"Z"in rt?(rt.H+=rt.Z/100|0,rt.M+=rt.Z%100,JC(rt)):YC(rt)}}function re(ct,gt,it,rt){for(var rr=0,ir=gt.length,or=it.length,Sr,tn;rr<ir;){if(rt>=or)return-1;if(Sr=gt.charCodeAt(rr++),Sr===37){if(Sr=gt.charAt(rr++),tn=F[Sr in f$?gt.charAt(rr++):Sr],!tn||(rt=tn(ct,it,rt))<0)return-1}else if(Sr!=it.charCodeAt(rt++))return-1}return rt}function W(ct,gt,it){var rt=y.exec(gt.slice(it));return rt?(ct.p=b.get(rt[0].toLowerCase()),it+rt[0].length):-1}function te(ct,gt,it){var rt=C.exec(gt.slice(it));return rt?(ct.w=k.get(rt[0].toLowerCase()),it+rt[0].length):-1}function oe(ct,gt,it){var rt=_.exec(gt.slice(it));return rt?(ct.w=E.get(rt[0].toLowerCase()),it+rt[0].length):-1}function ie(ct,gt,it){var rt=R.exec(gt.slice(it));return rt?(ct.m=L.get(rt[0].toLowerCase()),it+rt[0].length):-1}function ue(ct,gt,it){var rt=N.exec(gt.slice(it));return rt?(ct.m=O.get(rt[0].toLowerCase()),it+rt[0].length):-1}function _e(ct,gt,it){return re(ct,t,gt,it)}function xe(ct,gt,it){return re(ct,r,gt,it)}function be(ct,gt,it){return re(ct,n,gt,it)}function Ae(ct){return h[ct.getDay()]}function me(ct){return o[ct.getDay()]}function ke(ct){return p[ct.getMonth()]}function Ne(ct){return s[ct.getMonth()]}function Be(ct){return i[+(ct.getHours()>=12)]}function We(ct){return 1+~~(ct.getMonth()/3)}function ut(ct){return h[ct.getUTCDay()]}function nt(ct){return o[ct.getUTCDay()]}function Pt(ct){return p[ct.getUTCMonth()]}function It(ct){return s[ct.getUTCMonth()]}function at(ct){return i[+(ct.getUTCHours()>=12)]}function Ut(ct){return 1+~~(ct.getUTCMonth()/3)}return{format:function(ct){var gt=H(ct+="",B);return gt.toString=function(){return ct},gt},parse:function(ct){var gt=Z(ct+="",!1);return gt.toString=function(){return ct},gt},utcFormat:function(ct){var gt=H(ct+="",q);return gt.toString=function(){return ct},gt},utcParse:function(ct){var gt=Z(ct+="",!0);return gt.toString=function(){return ct},gt}}}var f$={"-":"",_:" ",0:"0"},rs=/^\s*\d+/,XMe=/^%/,KMe=/[\\^$*+?|[\]().{}]/g;function dn(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",o=i.length;return n+(o<r?new Array(r-o+1).join(t)+i:i)}function ZMe(e){return e.replace(KMe,"\\$&")}function Dv(e){return new RegExp("^(?:"+e.map(ZMe).join("|")+")","i")}function Lv(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function YMe(e,t,r){var n=rs.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function JMe(e,t,r){var n=rs.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function QMe(e,t,r){var n=rs.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function eIe(e,t,r){var n=rs.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function tIe(e,t,r){var n=rs.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function p$(e,t,r){var n=rs.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function m$(e,t,r){var n=rs.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function rIe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function nIe(e,t,r){var n=rs.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function iIe(e,t,r){var n=rs.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function g$(e,t,r){var n=rs.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function sIe(e,t,r){var n=rs.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function y$(e,t,r){var n=rs.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function aIe(e,t,r){var n=rs.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function oIe(e,t,r){var n=rs.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function lIe(e,t,r){var n=rs.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function cIe(e,t,r){var n=rs.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function uIe(e,t,r){var n=XMe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function dIe(e,t,r){var n=rs.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function hIe(e,t,r){var n=rs.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function v$(e,t){return dn(e.getDate(),t,2)}function fIe(e,t){return dn(e.getHours(),t,2)}function pIe(e,t){return dn(e.getHours()%12||12,t,2)}function mIe(e,t){return dn(1+sb.count(Xc(e),e),t,3)}function ZX(e,t){return dn(e.getMilliseconds(),t,3)}function gIe(e,t){return ZX(e,t)+"000"}function yIe(e,t){return dn(e.getMonth()+1,t,2)}function vIe(e,t){return dn(e.getMinutes(),t,2)}function xIe(e,t){return dn(e.getSeconds(),t,2)}function bIe(e){var t=e.getDay();return t===0?7:t}function _Ie(e,t){return dn(S2.count(Xc(e)-1,e),t,2)}function YX(e){var t=e.getDay();return t>=4||t===0?Um(e):Um.ceil(e)}function wIe(e,t){return e=YX(e),dn(Um.count(Xc(e),e)+(Xc(e).getDay()===4),t,2)}function SIe(e){return e.getDay()}function EIe(e,t){return dn(xS.count(Xc(e)-1,e),t,2)}function TIe(e,t){return dn(e.getFullYear()%100,t,2)}function jIe(e,t){return e=YX(e),dn(e.getFullYear()%100,t,2)}function CIe(e,t){return dn(e.getFullYear()%1e4,t,4)}function PIe(e,t){var r=e.getDay();return e=r>=4||r===0?Um(e):Um.ceil(e),dn(e.getFullYear()%1e4,t,4)}function AIe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+dn(t/60|0,"0",2)+dn(t%60,"0",2)}function x$(e,t){return dn(e.getUTCDate(),t,2)}function NIe(e,t){return dn(e.getUTCHours(),t,2)}function kIe(e,t){return dn(e.getUTCHours()%12||12,t,2)}function MIe(e,t){return dn(1+w2.count(Kc(e),e),t,3)}function JX(e,t){return dn(e.getUTCMilliseconds(),t,3)}function IIe(e,t){return JX(e,t)+"000"}function OIe(e,t){return dn(e.getUTCMonth()+1,t,2)}function RIe(e,t){return dn(e.getUTCMinutes(),t,2)}function DIe(e,t){return dn(e.getUTCSeconds(),t,2)}function LIe(e){var t=e.getUTCDay();return t===0?7:t}function BIe(e,t){return dn(E2.count(Kc(e)-1,e),t,2)}function QX(e){var t=e.getUTCDay();return t>=4||t===0?Vm(e):Vm.ceil(e)}function zIe(e,t){return e=QX(e),dn(Vm.count(Kc(e),e)+(Kc(e).getUTCDay()===4),t,2)}function $Ie(e){return e.getUTCDay()}function FIe(e,t){return dn(bS.count(Kc(e)-1,e),t,2)}function UIe(e,t){return dn(e.getUTCFullYear()%100,t,2)}function VIe(e,t){return e=QX(e),dn(e.getUTCFullYear()%100,t,2)}function qIe(e,t){return dn(e.getUTCFullYear()%1e4,t,4)}function WIe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Vm(e):Vm.ceil(e),dn(e.getUTCFullYear()%1e4,t,4)}function GIe(){return"+0000"}function b$(){return"%"}function _$(e){return+e}function w$(e){return Math.floor(+e/1e3)}var Bp,eK,tK;HIe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function HIe(e){return Bp=HMe(e),eK=Bp.format,Bp.parse,tK=Bp.utcFormat,Bp.utcParse,Bp}function XIe(e){return new Date(e)}function KIe(e){return e instanceof Date?+e:+new Date(+e)}function NO(e,t,r,n,i,o,h,s,p,y){var b=gO(),_=b.invert,E=b.domain,C=y(".%L"),k=y(":%S"),N=y("%I:%M"),O=y("%I %p"),R=y("%a %d"),L=y("%b %d"),B=y("%B"),q=y("%Y");function F(H){return(p(H)<H?C:s(H)<H?k:h(H)<H?N:o(H)<H?O:n(H)<H?i(H)<H?R:L:r(H)<H?B:q)(H)}return b.invert=function(H){return new Date(_(H))},b.domain=function(H){return arguments.length?E(Array.from(H,KIe)):E().map(XIe)},b.ticks=function(H){var Z=E();return e(Z[0],Z[Z.length-1],H??10)},b.tickFormat=function(H,Z){return Z==null?F:y(Z)},b.nice=function(H){var Z=E();return(!H||typeof H.range!="function")&&(H=t(Z[0],Z[Z.length-1],H??10)),H?E(FX(Z,H)):b},b.copy=function(){return ib(b,NO(e,t,r,n,i,o,h,s,p,y))},b}function ZIe(){return _o.apply(NO(WMe,GMe,Xc,PO,S2,sb,jO,EO,Gh,eK).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function YIe(){return _o.apply(NO(VMe,qMe,Kc,AO,E2,w2,CO,TO,Gh,tK).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function T2(){var e=0,t=1,r,n,i,o,h=Us,s=!1,p;function y(_){return _==null||isNaN(_=+_)?p:h(i===0?.5:(_=(o(_)-r)*i,s?Math.max(0,Math.min(1,_)):_))}y.domain=function(_){return arguments.length?([e,t]=_,r=o(e=+e),n=o(t=+t),i=r===n?0:1/(n-r),y):[e,t]},y.clamp=function(_){return arguments.length?(s=!!_,y):s},y.interpolator=function(_){return arguments.length?(h=_,y):h};function b(_){return function(E){var C,k;return arguments.length?([C,k]=E,h=_(C,k),y):[h(0),h(1)]}}return y.range=b(Ig),y.rangeRound=b(mO),y.unknown=function(_){return arguments.length?(p=_,y):p},function(_){return o=_,r=_(e),n=_(t),i=r===n?0:1/(n-r),y}}function Rd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function rK(){var e=Od(T2()(Us));return e.copy=function(){return Rd(e,rK())},tu.apply(e,arguments)}function nK(){var e=xO(T2()).domain([1,10]);return e.copy=function(){return Rd(e,nK()).base(e.base())},tu.apply(e,arguments)}function iK(){var e=bO(T2());return e.copy=function(){return Rd(e,iK()).constant(e.constant())},tu.apply(e,arguments)}function kO(){var e=_O(T2());return e.copy=function(){return Rd(e,kO()).exponent(e.exponent())},tu.apply(e,arguments)}function JIe(){return kO.apply(null,arguments).exponent(.5)}function sK(){var e=[],t=Us;function r(n){if(n!=null&&!isNaN(n=+n))return t((rb(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(hd),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,o)=>Bke(e,o/n))},r.copy=function(){return sK(t).domain(e)},tu.apply(r,arguments)}function j2(){var e=0,t=.5,r=1,n=1,i,o,h,s,p,y=Us,b,_=!1,E;function C(N){return isNaN(N=+N)?E:(N=.5+((N=+b(N))-o)*(n*N<n*o?s:p),y(_?Math.max(0,Math.min(1,N)):N))}C.domain=function(N){return arguments.length?([e,t,r]=N,i=b(e=+e),o=b(t=+t),h=b(r=+r),s=i===o?0:.5/(o-i),p=o===h?0:.5/(h-o),n=o<i?-1:1,C):[e,t,r]},C.clamp=function(N){return arguments.length?(_=!!N,C):_},C.interpolator=function(N){return arguments.length?(y=N,C):y};function k(N){return function(O){var R,L,B;return arguments.length?([R,L,B]=O,y=uMe(N,[R,L,B]),C):[y(0),y(.5),y(1)]}}return C.range=k(Ig),C.rangeRound=k(mO),C.unknown=function(N){return arguments.length?(E=N,C):E},function(N){return b=N,i=N(e),o=N(t),h=N(r),s=i===o?0:.5/(o-i),p=o===h?0:.5/(h-o),n=o<i?-1:1,C}}function aK(){var e=Od(j2()(Us));return e.copy=function(){return Rd(e,aK())},tu.apply(e,arguments)}function oK(){var e=xO(j2()).domain([.1,1,10]);return e.copy=function(){return Rd(e,oK()).base(e.base())},tu.apply(e,arguments)}function lK(){var e=bO(j2());return e.copy=function(){return Rd(e,lK()).constant(e.constant())},tu.apply(e,arguments)}function MO(){var e=_O(j2());return e.copy=function(){return Rd(e,MO()).exponent(e.exponent())},tu.apply(e,arguments)}function QIe(){return MO.apply(null,arguments).exponent(.5)}const S$=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:s0,scaleDiverging:aK,scaleDivergingLog:oK,scaleDivergingPow:MO,scaleDivergingSqrt:QIe,scaleDivergingSymlog:lK,scaleIdentity:$X,scaleImplicit:NN,scaleLinear:yS,scaleLog:UX,scaleOrdinal:hO,scalePoint:vx,scalePow:wO,scaleQuantile:WX,scaleQuantize:GX,scaleRadial:qX,scaleSequential:rK,scaleSequentialLog:nK,scaleSequentialPow:kO,scaleSequentialQuantile:sK,scaleSequentialSqrt:JIe,scaleSequentialSymlog:iK,scaleSqrt:IMe,scaleSymlog:VX,scaleThreshold:HX,scaleTime:ZIe,scaleUtc:YIe,tickFormat:zX},Symbol.toStringTag,{value:"Module"}));var eOe=Tg;function tOe(e,t,r){for(var n=-1,i=e.length;++n<i;){var o=e[n],h=t(o);if(h!=null&&(s===void 0?h===h&&!eOe(h):r(h,s)))var s=h,p=o}return p}var cK=tOe;function rOe(e,t){return e>t}var nOe=rOe,iOe=cK,sOe=nOe,aOe=Mg;function oOe(e){return e&&e.length?iOe(e,aOe,sOe):void 0}var lOe=oOe;const C2=Sn(lOe);function cOe(e,t){return e<t}var uOe=cOe,dOe=cK,hOe=uOe,fOe=Mg;function pOe(e){return e&&e.length?dOe(e,fOe,hOe):void 0}var mOe=pOe;const P2=Sn(mOe);var gOe=GI,yOe=Id,vOe=yX,xOe=va;function bOe(e,t){var r=xOe(e)?gOe:vOe;return r(e,yOe(t))}var _Oe=bOe,wOe=mX,SOe=_Oe;function EOe(e,t){return wOe(SOe(e,t),1)}var TOe=EOe;const jOe=Sn(TOe);var COe=oO;function POe(e,t){return COe(e,t)}var AOe=POe;const A2=Sn(AOe);var Og=1e9,NOe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},OO,Zn=!0,vo="[DecimalError] ",Qh=vo+"Invalid argument: ",IO=vo+"Exponent out of range: ",Rg=Math.floor,Lh=Math.pow,kOe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ma,Ji=1e7,qn=7,uK=9007199254740991,_S=Rg(uK/qn),tr={};tr.absoluteValue=tr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};tr.comparedTo=tr.cmp=function(e){var t,r,n,i,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(n=o.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return n===i?0:n>i^o.s<0?1:-1};tr.decimalPlaces=tr.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*qn;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};tr.dividedBy=tr.div=function(e){return Oc(this,new this.constructor(e))};tr.dividedToIntegerBy=tr.idiv=function(e){var t=this,r=t.constructor;return kn(Oc(t,new r(e),0,1),r.precision)};tr.equals=tr.eq=function(e){return!this.cmp(e)};tr.exponent=function(){return Ni(this)};tr.greaterThan=tr.gt=function(e){return this.cmp(e)>0};tr.greaterThanOrEqualTo=tr.gte=function(e){return this.cmp(e)>=0};tr.isInteger=tr.isint=function(){return this.e>this.d.length-2};tr.isNegative=tr.isneg=function(){return this.s<0};tr.isPositive=tr.ispos=function(){return this.s>0};tr.isZero=function(){return this.s===0};tr.lessThan=tr.lt=function(e){return this.cmp(e)<0};tr.lessThanOrEqualTo=tr.lte=function(e){return this.cmp(e)<1};tr.logarithm=tr.log=function(e){var t,r=this,n=r.constructor,i=n.precision,o=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ma))throw Error(vo+"NaN");if(r.s<1)throw Error(vo+(r.s?"NaN":"-Infinity"));return r.eq(Ma)?new n(0):(Zn=!1,t=Oc(u0(r,o),u0(e,o),o),Zn=!0,kn(t,i))};tr.minus=tr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?fK(t,e):dK(t,(e.s=-e.s,e))};tr.modulo=tr.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(vo+"NaN");return r.s?(Zn=!1,t=Oc(r,e,0,1).times(e),Zn=!0,r.minus(t)):kn(new n(r),i)};tr.naturalExponential=tr.exp=function(){return hK(this)};tr.naturalLogarithm=tr.ln=function(){return u0(this)};tr.negated=tr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};tr.plus=tr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?dK(t,e):fK(t,(e.s=-e.s,e))};tr.precision=tr.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Qh+e);if(t=Ni(i)+1,n=i.d.length-1,r=n*qn+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};tr.squareRoot=tr.sqrt=function(){var e,t,r,n,i,o,h,s=this,p=s.constructor;if(s.s<1){if(!s.s)return new p(0);throw Error(vo+"NaN")}for(e=Ni(s),Zn=!1,i=Math.sqrt(+s),i==0||i==1/0?(t=Rl(s.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=Rg((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new p(t)):n=new p(i.toString()),r=p.precision,i=h=r+3;;)if(o=n,n=o.plus(Oc(s,o,h+2)).times(.5),Rl(o.d).slice(0,h)===(t=Rl(n.d)).slice(0,h)){if(t=t.slice(h-3,h+1),i==h&&t=="4999"){if(kn(o,r+1,0),o.times(o).eq(s)){n=o;break}}else if(t!="9999")break;h+=4}return Zn=!0,kn(n,r)};tr.times=tr.mul=function(e){var t,r,n,i,o,h,s,p,y,b=this,_=b.constructor,E=b.d,C=(e=new _(e)).d;if(!b.s||!e.s)return new _(0);for(e.s*=b.s,r=b.e+e.e,p=E.length,y=C.length,p<y&&(o=E,E=C,C=o,h=p,p=y,y=h),o=[],h=p+y,n=h;n--;)o.push(0);for(n=y;--n>=0;){for(t=0,i=p+n;i>n;)s=o[i]+C[n]*E[i-n-1]+t,o[i--]=s%Ji|0,t=s/Ji|0;o[i]=(o[i]+t)%Ji|0}for(;!o[--h];)o.pop();return t?++r:o.shift(),e.d=o,e.e=r,Zn?kn(e,_.precision):e};tr.toDecimalPlaces=tr.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Wl(e,0,Og),t===void 0?t=n.rounding:Wl(t,0,8),kn(r,e+Ni(r)+1,t))};tr.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=ff(n,!0):(Wl(e,0,Og),t===void 0?t=i.rounding:Wl(t,0,8),n=kn(new i(n),e+1,t),r=ff(n,!0,e+1)),r};tr.toFixed=function(e,t){var r,n,i=this,o=i.constructor;return e===void 0?ff(i):(Wl(e,0,Og),t===void 0?t=o.rounding:Wl(t,0,8),n=kn(new o(i),e+Ni(i)+1,t),r=ff(n.abs(),!1,e+Ni(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};tr.toInteger=tr.toint=function(){var e=this,t=e.constructor;return kn(new t(e),Ni(e)+1,t.rounding)};tr.toNumber=function(){return+this};tr.toPower=tr.pow=function(e){var t,r,n,i,o,h,s=this,p=s.constructor,y=12,b=+(e=new p(e));if(!e.s)return new p(Ma);if(s=new p(s),!s.s){if(e.s<1)throw Error(vo+"Infinity");return s}if(s.eq(Ma))return s;if(n=p.precision,e.eq(Ma))return kn(s,n);if(t=e.e,r=e.d.length-1,h=t>=r,o=s.s,h){if((r=b<0?-b:b)<=uK){for(i=new p(Ma),t=Math.ceil(n/qn+4),Zn=!1;r%2&&(i=i.times(s),T$(i.d,t)),r=Rg(r/2),r!==0;)s=s.times(s),T$(s.d,t);return Zn=!0,e.s<0?new p(Ma).div(i):kn(i,n)}}else if(o<0)throw Error(vo+"NaN");return o=o<0&&e.d[Math.max(t,r)]&1?-1:1,s.s=1,Zn=!1,i=e.times(u0(s,n+y)),Zn=!0,i=hK(i),i.s=o,i};tr.toPrecision=function(e,t){var r,n,i=this,o=i.constructor;return e===void 0?(r=Ni(i),n=ff(i,r<=o.toExpNeg||r>=o.toExpPos)):(Wl(e,1,Og),t===void 0?t=o.rounding:Wl(t,0,8),i=kn(new o(i),e,t),r=Ni(i),n=ff(i,e<=r||r<=o.toExpNeg,e)),n};tr.toSignificantDigits=tr.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Wl(e,1,Og),t===void 0?t=n.rounding:Wl(t,0,8)),kn(new n(r),e,t)};tr.toString=tr.valueOf=tr.val=tr.toJSON=tr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ni(e),r=e.constructor;return ff(e,t<=r.toExpNeg||t>=r.toExpPos)};function dK(e,t){var r,n,i,o,h,s,p,y,b=e.constructor,_=b.precision;if(!e.s||!t.s)return t.s||(t=new b(e)),Zn?kn(t,_):t;if(p=e.d,y=t.d,h=e.e,i=t.e,p=p.slice(),o=h-i,o){for(o<0?(n=p,o=-o,s=y.length):(n=y,i=h,s=p.length),h=Math.ceil(_/qn),s=h>s?h+1:s+1,o>s&&(o=s,n.length=1),n.reverse();o--;)n.push(0);n.reverse()}for(s=p.length,o=y.length,s-o<0&&(o=s,n=y,y=p,p=n),r=0;o;)r=(p[--o]=p[o]+y[o]+r)/Ji|0,p[o]%=Ji;for(r&&(p.unshift(r),++i),s=p.length;p[--s]==0;)p.pop();return t.d=p,t.e=i,Zn?kn(t,_):t}function Wl(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Qh+e)}function Rl(e){var t,r,n,i=e.length-1,o="",h=e[0];if(i>0){for(o+=h,t=1;t<i;t++)n=e[t]+"",r=qn-n.length,r&&(o+=Gu(r)),o+=n;h=e[t],n=h+"",r=qn-n.length,r&&(o+=Gu(r))}else if(h===0)return"0";for(;h%10===0;)h/=10;return o+h}var Oc=function(){function e(n,i){var o,h=0,s=n.length;for(n=n.slice();s--;)o=n[s]*i+h,n[s]=o%Ji|0,h=o/Ji|0;return h&&n.unshift(h),n}function t(n,i,o,h){var s,p;if(o!=h)p=o>h?1:-1;else for(s=p=0;s<o;s++)if(n[s]!=i[s]){p=n[s]>i[s]?1:-1;break}return p}function r(n,i,o){for(var h=0;o--;)n[o]-=h,h=n[o]<i[o]?1:0,n[o]=h*Ji+n[o]-i[o];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,o,h){var s,p,y,b,_,E,C,k,N,O,R,L,B,q,F,H,Z,re,W=n.constructor,te=n.s==i.s?1:-1,oe=n.d,ie=i.d;if(!n.s)return new W(n);if(!i.s)throw Error(vo+"Division by zero");for(p=n.e-i.e,Z=ie.length,F=oe.length,C=new W(te),k=C.d=[],y=0;ie[y]==(oe[y]||0);)++y;if(ie[y]>(oe[y]||0)&&--p,o==null?L=o=W.precision:h?L=o+(Ni(n)-Ni(i))+1:L=o,L<0)return new W(0);if(L=L/qn+2|0,y=0,Z==1)for(b=0,ie=ie[0],L++;(y<F||b)&&L--;y++)B=b*Ji+(oe[y]||0),k[y]=B/ie|0,b=B%ie|0;else{for(b=Ji/(ie[0]+1)|0,b>1&&(ie=e(ie,b),oe=e(oe,b),Z=ie.length,F=oe.length),q=Z,N=oe.slice(0,Z),O=N.length;O<Z;)N[O++]=0;re=ie.slice(),re.unshift(0),H=ie[0],ie[1]>=Ji/2&&++H;do b=0,s=t(ie,N,Z,O),s<0?(R=N[0],Z!=O&&(R=R*Ji+(N[1]||0)),b=R/H|0,b>1?(b>=Ji&&(b=Ji-1),_=e(ie,b),E=_.length,O=N.length,s=t(_,N,E,O),s==1&&(b--,r(_,Z<E?re:ie,E))):(b==0&&(s=b=1),_=ie.slice()),E=_.length,E<O&&_.unshift(0),r(N,_,O),s==-1&&(O=N.length,s=t(ie,N,Z,O),s<1&&(b++,r(N,Z<O?re:ie,O))),O=N.length):s===0&&(b++,N=[0]),k[y++]=b,s&&N[0]?N[O++]=oe[q]||0:(N=[oe[q]],O=1);while((q++<F||N[0]!==void 0)&&L--)}return k[0]||k.shift(),C.e=p,kn(C,h?o+Ni(C)+1:o)}}();function hK(e,t){var r,n,i,o,h,s,p=0,y=0,b=e.constructor,_=b.precision;if(Ni(e)>16)throw Error(IO+Ni(e));if(!e.s)return new b(Ma);for(t==null?(Zn=!1,s=_):s=t,h=new b(.03125);e.abs().gte(.1);)e=e.times(h),y+=5;for(n=Math.log(Lh(2,y))/Math.LN10*2+5|0,s+=n,r=i=o=new b(Ma),b.precision=s;;){if(i=kn(i.times(e),s),r=r.times(++p),h=o.plus(Oc(i,r,s)),Rl(h.d).slice(0,s)===Rl(o.d).slice(0,s)){for(;y--;)o=kn(o.times(o),s);return b.precision=_,t==null?(Zn=!0,kn(o,_)):o}o=h}}function Ni(e){for(var t=e.e*qn,r=e.d[0];r>=10;r/=10)t++;return t}function QC(e,t,r){if(t>e.LN10.sd())throw Zn=!0,r&&(e.precision=r),Error(vo+"LN10 precision limit exceeded");return kn(new e(e.LN10),t)}function Gu(e){for(var t="";e--;)t+="0";return t}function u0(e,t){var r,n,i,o,h,s,p,y,b,_=1,E=10,C=e,k=C.d,N=C.constructor,O=N.precision;if(C.s<1)throw Error(vo+(C.s?"NaN":"-Infinity"));if(C.eq(Ma))return new N(0);if(t==null?(Zn=!1,y=O):y=t,C.eq(10))return t==null&&(Zn=!0),QC(N,y);if(y+=E,N.precision=y,r=Rl(k),n=r.charAt(0),o=Ni(C),Math.abs(o)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)C=C.times(e),r=Rl(C.d),n=r.charAt(0),_++;o=Ni(C),n>1?(C=new N("0."+r),o++):C=new N(n+"."+r.slice(1))}else return p=QC(N,y+2,O).times(o+""),C=u0(new N(n+"."+r.slice(1)),y-E).plus(p),N.precision=O,t==null?(Zn=!0,kn(C,O)):C;for(s=h=C=Oc(C.minus(Ma),C.plus(Ma),y),b=kn(C.times(C),y),i=3;;){if(h=kn(h.times(b),y),p=s.plus(Oc(h,new N(i),y)),Rl(p.d).slice(0,y)===Rl(s.d).slice(0,y))return s=s.times(2),o!==0&&(s=s.plus(QC(N,y+2,O).times(o+""))),s=Oc(s,new N(_),y),N.precision=O,t==null?(Zn=!0,kn(s,O)):s;s=p,i+=2}}function E$(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=Rg(r/qn),e.d=[],n=(r+1)%qn,r<0&&(n+=qn),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=qn;n<i;)e.d.push(+t.slice(n,n+=qn));t=t.slice(n),n=qn-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),Zn&&(e.e>_S||e.e<-_S))throw Error(IO+r)}else e.s=0,e.e=0,e.d=[0];return e}function kn(e,t,r){var n,i,o,h,s,p,y,b,_=e.d;for(h=1,o=_[0];o>=10;o/=10)h++;if(n=t-h,n<0)n+=qn,i=t,y=_[b=0];else{if(b=Math.ceil((n+1)/qn),o=_.length,b>=o)return e;for(y=o=_[b],h=1;o>=10;o/=10)h++;n%=qn,i=n-qn+h}if(r!==void 0&&(o=Lh(10,h-i-1),s=y/o%10|0,p=t<0||_[b+1]!==void 0||y%o,p=r<4?(s||p)&&(r==0||r==(e.s<0?3:2)):s>5||s==5&&(r==4||p||r==6&&(n>0?i>0?y/Lh(10,h-i):0:_[b-1])%10&1||r==(e.s<0?8:7))),t<1||!_[0])return p?(o=Ni(e),_.length=1,t=t-o-1,_[0]=Lh(10,(qn-t%qn)%qn),e.e=Rg(-t/qn)||0):(_.length=1,_[0]=e.e=e.s=0),e;if(n==0?(_.length=b,o=1,b--):(_.length=b+1,o=Lh(10,qn-n),_[b]=i>0?(y/Lh(10,h-i)%Lh(10,i)|0)*o:0),p)for(;;)if(b==0){(_[0]+=o)==Ji&&(_[0]=1,++e.e);break}else{if(_[b]+=o,_[b]!=Ji)break;_[b--]=0,o=1}for(n=_.length;_[--n]===0;)_.pop();if(Zn&&(e.e>_S||e.e<-_S))throw Error(IO+Ni(e));return e}function fK(e,t){var r,n,i,o,h,s,p,y,b,_,E=e.constructor,C=E.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new E(e),Zn?kn(t,C):t;if(p=e.d,_=t.d,n=t.e,y=e.e,p=p.slice(),h=y-n,h){for(b=h<0,b?(r=p,h=-h,s=_.length):(r=_,n=y,s=p.length),i=Math.max(Math.ceil(C/qn),s)+2,h>i&&(h=i,r.length=1),r.reverse(),i=h;i--;)r.push(0);r.reverse()}else{for(i=p.length,s=_.length,b=i<s,b&&(s=i),i=0;i<s;i++)if(p[i]!=_[i]){b=p[i]<_[i];break}h=0}for(b&&(r=p,p=_,_=r,t.s=-t.s),s=p.length,i=_.length-s;i>0;--i)p[s++]=0;for(i=_.length;i>h;){if(p[--i]<_[i]){for(o=i;o&&p[--o]===0;)p[o]=Ji-1;--p[o],p[i]+=Ji}p[i]-=_[i]}for(;p[--s]===0;)p.pop();for(;p[0]===0;p.shift())--n;return p[0]?(t.d=p,t.e=n,Zn?kn(t,C):t):new E(0)}function ff(e,t,r){var n,i=Ni(e),o=Rl(e.d),h=o.length;return t?(r&&(n=r-h)>0?o=o.charAt(0)+"."+o.slice(1)+Gu(n):h>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(i<0?"e":"e+")+i):i<0?(o="0."+Gu(-i-1)+o,r&&(n=r-h)>0&&(o+=Gu(n))):i>=h?(o+=Gu(i+1-h),r&&(n=r-i-1)>0&&(o=o+"."+Gu(n))):((n=i+1)<h&&(o=o.slice(0,n)+"."+o.slice(n)),r&&(n=r-h)>0&&(i+1===h&&(o+="."),o+=Gu(n))),e.s<0?"-"+o:o}function T$(e,t){if(e.length>t)return e.length=t,!0}function pK(e){var t,r,n;function i(o){var h=this;if(!(h instanceof i))return new i(o);if(h.constructor=i,o instanceof i){h.s=o.s,h.e=o.e,h.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(Qh+o);if(o>0)h.s=1;else if(o<0)o=-o,h.s=-1;else{h.s=0,h.e=0,h.d=[0];return}if(o===~~o&&o<1e7){h.e=0,h.d=[o];return}return E$(h,o.toString())}else if(typeof o!="string")throw Error(Qh+o);if(o.charCodeAt(0)===45?(o=o.slice(1),h.s=-1):h.s=1,kOe.test(o))E$(h,o);else throw Error(Qh+o)}if(i.prototype=tr,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=pK,i.config=i.set=MOe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function MOe(e){if(!e||typeof e!="object")throw Error(vo+"Object expected");var t,r,n,i=["precision",1,Og,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if(Rg(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(Qh+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Qh+r+": "+n);return this}var OO=pK(NOe);Ma=new OO(1);const Cn=OO;function IOe(e){return LOe(e)||DOe(e)||ROe(e)||OOe()}function OOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ROe(e,t){if(e){if(typeof e=="string")return ON(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ON(e,t)}}function DOe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function LOe(e){if(Array.isArray(e))return ON(e)}function ON(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var BOe=function(t){return t},mK={"@@functional/placeholder":!0},gK=function(t){return t===mK},j$=function(t){return function r(){return arguments.length===0||arguments.length===1&&gK(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},zOe=function e(t,r){return t===1?r:j$(function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var h=i.filter(function(s){return s!==mK}).length;return h>=t?r.apply(void 0,i):e(t-h,j$(function(){for(var s=arguments.length,p=new Array(s),y=0;y<s;y++)p[y]=arguments[y];var b=i.map(function(_){return gK(_)?p.shift():_});return r.apply(void 0,IOe(b).concat(p))}))})},N2=function(t){return zOe(t.length,t)},RN=function(t,r){for(var n=[],i=t;i<r;++i)n[i-t]=i;return n},$Oe=N2(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),FOe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return BOe;var i=r.reverse(),o=i[0],h=i.slice(1);return function(){return h.reduce(function(s,p){return p(s)},o.apply(void 0,arguments))}},DN=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},yK=function(t){var r=null,n=null;return function(){for(var i=arguments.length,o=new Array(i),h=0;h<i;h++)o[h]=arguments[h];return r&&o.every(function(s,p){return s===r[p]})||(r=o,n=t.apply(void 0,o)),n}};function UOe(e){var t;return e===0?t=1:t=Math.floor(new Cn(e).abs().log(10).toNumber())+1,t}function VOe(e,t,r){for(var n=new Cn(e),i=0,o=[];n.lt(t)&&i<1e5;)o.push(n.toNumber()),n=n.add(r),i++;return o}var qOe=N2(function(e,t,r){var n=+e,i=+t;return n+r*(i-n)}),WOe=N2(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),GOe=N2(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const k2={rangeStep:VOe,getDigitCount:UOe,interpolateNumber:qOe,uninterpolateNumber:WOe,uninterpolateTruncation:GOe};function LN(e){return KOe(e)||XOe(e)||vK(e)||HOe()}function HOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XOe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function KOe(e){if(Array.isArray(e))return BN(e)}function d0(e,t){return JOe(e)||YOe(e,t)||vK(e,t)||ZOe()}function ZOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vK(e,t){if(e){if(typeof e=="string")return BN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BN(e,t)}}function BN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YOe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,i=!1,o=void 0;try{for(var h=e[Symbol.iterator](),s;!(n=(s=h.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(p){i=!0,o=p}finally{try{!n&&h.return!=null&&h.return()}finally{if(i)throw o}}return r}}function JOe(e){if(Array.isArray(e))return e}function xK(e){var t=d0(e,2),r=t[0],n=t[1],i=r,o=n;return r>n&&(i=n,o=r),[i,o]}function bK(e,t,r){if(e.lte(0))return new Cn(0);var n=k2.getDigitCount(e.toNumber()),i=new Cn(10).pow(n),o=e.div(i),h=n!==1?.05:.1,s=new Cn(Math.ceil(o.div(h).toNumber())).add(r).mul(h),p=s.mul(i);return t?p:new Cn(Math.ceil(p))}function QOe(e,t,r){var n=1,i=new Cn(e);if(!i.isint()&&r){var o=Math.abs(e);o<1?(n=new Cn(10).pow(k2.getDigitCount(e)-1),i=new Cn(Math.floor(i.div(n).toNumber())).mul(n)):o>1&&(i=new Cn(Math.floor(e)))}else e===0?i=new Cn(Math.floor((t-1)/2)):r||(i=new Cn(Math.floor(e)));var h=Math.floor((t-1)/2),s=FOe($Oe(function(p){return i.add(new Cn(p-h).mul(n)).toNumber()}),RN);return s(0,t)}function _K(e,t,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Cn(0),tickMin:new Cn(0),tickMax:new Cn(0)};var o=bK(new Cn(t).sub(e).div(r-1),n,i),h;e<=0&&t>=0?h=new Cn(0):(h=new Cn(e).add(t).div(2),h=h.sub(new Cn(h).mod(o)));var s=Math.ceil(h.sub(e).div(o).toNumber()),p=Math.ceil(new Cn(t).sub(h).div(o).toNumber()),y=s+p+1;return y>r?_K(e,t,r,n,i+1):(y<r&&(p=t>0?p+(r-y):p,s=t>0?s:s+(r-y)),{step:o,tickMin:h.sub(new Cn(s).mul(o)),tickMax:h.add(new Cn(p).mul(o))})}function eRe(e){var t=d0(e,2),r=t[0],n=t[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=Math.max(i,2),s=xK([r,n]),p=d0(s,2),y=p[0],b=p[1];if(y===-1/0||b===1/0){var _=b===1/0?[y].concat(LN(RN(0,i-1).map(function(){return 1/0}))):[].concat(LN(RN(0,i-1).map(function(){return-1/0})),[b]);return r>n?DN(_):_}if(y===b)return QOe(y,i,o);var E=_K(y,b,h,o),C=E.step,k=E.tickMin,N=E.tickMax,O=k2.rangeStep(k,N.add(new Cn(.1).mul(C)),C);return r>n?DN(O):O}function tRe(e,t){var r=d0(e,2),n=r[0],i=r[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=xK([n,i]),s=d0(h,2),p=s[0],y=s[1];if(p===-1/0||y===1/0)return[n,i];if(p===y)return[p];var b=Math.max(t,2),_=bK(new Cn(y).sub(p).div(b-1),o,0),E=[].concat(LN(k2.rangeStep(new Cn(p),new Cn(y).sub(new Cn(.99).mul(_)),_)),[y]);return n>i?DN(E):E}var rRe=yK(eRe),nRe=yK(tRe),iRe=!0,eP="Invariant failed";function pf(e,t){if(!e){if(iRe)throw new Error(eP);var r=typeof t=="function"?t():t,n=r?"".concat(eP,": ").concat(r):eP;throw new Error(n)}}var sRe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function qm(e){"@babel/helpers - typeof";return qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qm(e)}function wS(){return wS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wS.apply(this,arguments)}function aRe(e,t){return uRe(e)||cRe(e,t)||lRe(e,t)||oRe()}function oRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lRe(e,t){if(e){if(typeof e=="string")return C$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C$(e,t)}}function C$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,h,s=[],p=!0,y=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);p=!0);}catch(b){y=!0,i=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw i}}return s}}function uRe(e){if(Array.isArray(e))return e}function dRe(e,t){if(e==null)return{};var r=hRe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function fRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EK(n.key),n)}}function pRe(e,t,r){return t&&P$(e.prototype,t),r&&P$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mRe(e,t,r){return t=SS(t),gRe(e,wK()?Reflect.construct(t,r||[],SS(e).constructor):t.apply(e,r))}function gRe(e,t){if(t&&(qm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yRe(e)}function yRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wK=function(){return!!e})()}function SS(e){return SS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},SS(e)}function vRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zN(e,t)}function zN(e,t){return zN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zN(e,t)}function SK(e,t,r){return t=EK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EK(e){var t=xRe(e,"string");return qm(t)=="symbol"?t:t+""}function xRe(e,t){if(qm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ab=function(e){function t(){return fRe(this,t),mRe(this,t,arguments)}return vRe(t,e),pRe(t,[{key:"render",value:function(){var n=this.props,i=n.offset,o=n.layout,h=n.width,s=n.dataKey,p=n.data,y=n.dataPointFormatter,b=n.xAxis,_=n.yAxis,E=dRe(n,sRe),C=Kr(E,!1);this.props.direction==="x"&&b.type!=="number"&&pf(!1);var k=p.map(function(N){var O=y(N,s),R=O.x,L=O.y,B=O.value,q=O.errorVal;if(!q)return null;var F=[],H,Z;if(Array.isArray(q)){var re=aRe(q,2);H=re[0],Z=re[1]}else H=Z=q;if(o==="vertical"){var W=b.scale,te=L+i,oe=te+h,ie=te-h,ue=W(B-H),_e=W(B+Z);F.push({x1:_e,y1:oe,x2:_e,y2:ie}),F.push({x1:ue,y1:te,x2:_e,y2:te}),F.push({x1:ue,y1:oe,x2:ue,y2:ie})}else if(o==="horizontal"){var xe=_.scale,be=R+i,Ae=be-h,me=be+h,ke=xe(B-H),Ne=xe(B+Z);F.push({x1:Ae,y1:Ne,x2:me,y2:Ne}),F.push({x1:be,y1:ke,x2:be,y2:Ne}),F.push({x1:Ae,y1:ke,x2:me,y2:ke})}return je.createElement(gi,wS({className:"recharts-errorBar",key:"bar-".concat(F.map(function(Be){return"".concat(Be.x1,"-").concat(Be.x2,"-").concat(Be.y1,"-").concat(Be.y2)}))},C),F.map(function(Be){return je.createElement("line",wS({},Be,{key:"line-".concat(Be.x1,"-").concat(Be.x2,"-").concat(Be.y1,"-").concat(Be.y2)}))}))});return je.createElement(gi,{className:"recharts-errorBars"},k)}}])}(je.Component);SK(ab,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});SK(ab,"displayName","ErrorBar");function h0(e){"@babel/helpers - typeof";return h0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h0(e)}function A$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ch(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A$(Object(r),!0).forEach(function(n){bRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bRe(e,t,r){return t=_Re(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Re(e){var t=wRe(e,"string");return h0(t)=="symbol"?t:t+""}function wRe(e,t){if(h0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(h0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TK=function(t){var r=t.children,n=t.formattedGraphicalItems,i=t.legendWidth,o=t.legendContent,h=Na(r,vm);if(!h)return null;var s=vm.defaultProps,p=s!==void 0?Ch(Ch({},s),h.props):{},y;return h.props&&h.props.payload?y=h.props&&h.props.payload:o==="children"?y=(n||[]).reduce(function(b,_){var E=_.item,C=_.props,k=C.sectors||C.data||[];return b.concat(k.map(function(N){return{type:h.props.iconType||E.props.legendType,value:N.name,color:N.fill,payload:N}}))},[]):y=(n||[]).map(function(b){var _=b.item,E=_.type.defaultProps,C=E!==void 0?Ch(Ch({},E),_.props):{},k=C.dataKey,N=C.name,O=C.legendType,R=C.hide;return{inactive:R,dataKey:k,type:p.iconType||O||"square",color:RO(_),value:N||k,payload:C}}),Ch(Ch(Ch({},p),vm.getWithHeight(h,i)),{},{payload:y,item:h})};function f0(e){"@babel/helpers - typeof";return f0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f0(e)}function N$(e){return jRe(e)||TRe(e)||ERe(e)||SRe()}function SRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ERe(e,t){if(e){if(typeof e=="string")return $N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $N(e,t)}}function TRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jRe(e){if(Array.isArray(e))return $N(e)}function $N(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function k$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k$(Object(r),!0).forEach(function(n){bm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bm(e,t,r){return t=CRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CRe(e){var t=PRe(e,"string");return f0(t)=="symbol"?t:t+""}function PRe(e,t){if(f0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(f0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ba(e,t,r){return Hr(e)||Hr(t)?r:Fi(t)?po(e,t,r):Rr(t)?t(e):r}function xx(e,t,r,n){var i=jOe(e,function(s){return Ba(s,t)});if(r==="number"){var o=i.filter(function(s){return qt(s)||parseFloat(s)});return o.length?[P2(o),C2(o)]:[1/0,-1/0]}var h=n?i.filter(function(s){return!Hr(s)}):i;return h.map(function(s){return Fi(s)||s instanceof Date?s:""})}var ARe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,h=-1,s=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(s<=1)return 0;if(o&&o.axisType==="angleAxis"&&Math.abs(Math.abs(o.range[1]-o.range[0])-360)<=1e-6)for(var p=o.range,y=0;y<s;y++){var b=y>0?i[y-1].coordinate:i[s-1].coordinate,_=i[y].coordinate,E=y>=s-1?i[0].coordinate:i[y+1].coordinate,C=void 0;if(al(_-b)!==al(E-_)){var k=[];if(al(E-_)===al(p[1]-p[0])){C=E;var N=_+p[1]-p[0];k[0]=Math.min(N,(N+b)/2),k[1]=Math.max(N,(N+b)/2)}else{C=b;var O=E+p[1]-p[0];k[0]=Math.min(_,(O+_)/2),k[1]=Math.max(_,(O+_)/2)}var R=[Math.min(_,(C+_)/2),Math.max(_,(C+_)/2)];if(t>R[0]&&t<=R[1]||t>=k[0]&&t<=k[1]){h=i[y].index;break}}else{var L=Math.min(b,E),B=Math.max(b,E);if(t>(L+_)/2&&t<=(B+_)/2){h=i[y].index;break}}}else for(var q=0;q<s;q++)if(q===0&&t<=(n[q].coordinate+n[q+1].coordinate)/2||q>0&&q<s-1&&t>(n[q].coordinate+n[q-1].coordinate)/2&&t<=(n[q].coordinate+n[q+1].coordinate)/2||q===s-1&&t>(n[q].coordinate+n[q-1].coordinate)/2){h=n[q].index;break}return h},RO=function(t){var r,n=t,i=n.type.displayName,o=(r=t.type)!==null&&r!==void 0&&r.defaultProps?fi(fi({},t.type.defaultProps),t.props):t.props,h=o.stroke,s=o.fill,p;switch(i){case"Line":p=h;break;case"Area":case"Radar":p=h&&h!=="none"?h:s;break;default:p=s;break}return p},NRe=function(t){var r=t.barSize,n=t.totalSize,i=t.stackGroups,o=i===void 0?{}:i;if(!o)return{};for(var h={},s=Object.keys(o),p=0,y=s.length;p<y;p++)for(var b=o[s[p]].stackGroups,_=Object.keys(b),E=0,C=_.length;E<C;E++){var k=b[_[E]],N=k.items,O=k.cateAxisId,R=N.filter(function(Z){return kc(Z.type).indexOf("Bar")>=0});if(R&&R.length){var L=R[0].type.defaultProps,B=L!==void 0?fi(fi({},L),R[0].props):R[0].props,q=B.barSize,F=B[O];h[F]||(h[F]=[]);var H=Hr(q)?r:q;h[F].push({item:R[0],stackList:R.slice(1),barSize:Hr(H)?void 0:hf(H,n,0)})}}return h},kRe=function(t){var r=t.barGap,n=t.barCategoryGap,i=t.bandSize,o=t.sizeList,h=o===void 0?[]:o,s=t.maxBarSize,p=h.length;if(p<1)return null;var y=hf(r,i,0,!0),b,_=[];if(h[0].barSize===+h[0].barSize){var E=!1,C=i/p,k=h.reduce(function(q,F){return q+F.barSize||0},0);k+=(p-1)*y,k>=i&&(k-=(p-1)*y,y=0),k>=i&&C>0&&(E=!0,C*=.9,k=p*C);var N=(i-k)/2>>0,O={offset:N-y,size:0};b=h.reduce(function(q,F){var H={item:F.item,position:{offset:O.offset+O.size+y,size:E?C:F.barSize}},Z=[].concat(N$(q),[H]);return O=Z[Z.length-1].position,F.stackList&&F.stackList.length&&F.stackList.forEach(function(re){Z.push({item:re,position:O})}),Z},_)}else{var R=hf(n,i,0,!0);i-2*R-(p-1)*y<=0&&(y=0);var L=(i-2*R-(p-1)*y)/p;L>1&&(L>>=0);var B=s===+s?Math.min(L,s):L;b=h.reduce(function(q,F,H){var Z=[].concat(N$(q),[{item:F.item,position:{offset:R+(L+y)*H+(L-B)/2,size:B}}]);return F.stackList&&F.stackList.length&&F.stackList.forEach(function(re){Z.push({item:re,position:Z[Z.length-1].position})}),Z},_)}return b},MRe=function(t,r,n,i){var o=n.children,h=n.width,s=n.margin,p=h-(s.left||0)-(s.right||0),y=TK({children:o,legendWidth:p});if(y){var b=i||{},_=b.width,E=b.height,C=y.align,k=y.verticalAlign,N=y.layout;if((N==="vertical"||N==="horizontal"&&k==="middle")&&C!=="center"&&qt(t[C]))return fi(fi({},t),{},bm({},C,t[C]+(_||0)));if((N==="horizontal"||N==="vertical"&&C==="center")&&k!=="middle"&&qt(t[k]))return fi(fi({},t),{},bm({},k,t[k]+(E||0)))}return t},IRe=function(t,r,n){return Hr(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},jK=function(t,r,n,i,o){var h=r.props.children,s=mo(h,ab).filter(function(y){return IRe(i,o,y.props.direction)});if(s&&s.length){var p=s.map(function(y){return y.props.dataKey});return t.reduce(function(y,b){var _=Ba(b,n);if(Hr(_))return y;var E=Array.isArray(_)?[P2(_),C2(_)]:[_,_],C=p.reduce(function(k,N){var O=Ba(b,N,0),R=E[0]-Math.abs(Array.isArray(O)?O[0]:O),L=E[1]+Math.abs(Array.isArray(O)?O[1]:O);return[Math.min(R,k[0]),Math.max(L,k[1])]},[1/0,-1/0]);return[Math.min(C[0],y[0]),Math.max(C[1],y[1])]},[1/0,-1/0])}return null},ORe=function(t,r,n,i,o){var h=r.map(function(s){return jK(t,s,n,o,i)}).filter(function(s){return!Hr(s)});return h&&h.length?h.reduce(function(s,p){return[Math.min(s[0],p[0]),Math.max(s[1],p[1])]},[1/0,-1/0]):null},CK=function(t,r,n,i,o){var h=r.map(function(p){var y=p.props.dataKey;return n==="number"&&y&&jK(t,p,y,i)||xx(t,y,n,o)});if(n==="number")return h.reduce(function(p,y){return[Math.min(p[0],y[0]),Math.max(p[1],y[1])]},[1/0,-1/0]);var s={};return h.reduce(function(p,y){for(var b=0,_=y.length;b<_;b++)s[y[b]]||(s[y[b]]=!0,p.push(y[b]));return p},[])},PK=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},AK=function(t,r,n,i){if(i)return t.map(function(p){return p.coordinate});var o,h,s=t.map(function(p){return p.coordinate===r&&(o=!0),p.coordinate===n&&(h=!0),p.coordinate});return o||s.push(r),h||s.push(n),s},Cc=function(t,r,n){if(!t)return null;var i=t.scale,o=t.duplicateDomain,h=t.type,s=t.range,p=t.realScaleType==="scaleBand"?i.bandwidth()/2:2,y=(r||n)&&h==="category"&&i.bandwidth?i.bandwidth()/p:0;if(y=t.axisType==="angleAxis"&&(s==null?void 0:s.length)>=2?al(s[0]-s[1])*2*y:y,r&&(t.ticks||t.niceTicks)){var b=(t.ticks||t.niceTicks).map(function(_){var E=o?o.indexOf(_):_;return{coordinate:i(E)+y,value:_,offset:y}});return b.filter(function(_){return!Q0(_.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(_,E){return{coordinate:i(_)+y,value:_,index:E,offset:y}}):i.ticks&&!n?i.ticks(t.tickCount).map(function(_){return{coordinate:i(_)+y,value:_,offset:y}}):i.domain().map(function(_,E){return{coordinate:i(_)+y,value:o?o[_]:_,index:E,offset:y}})},tP=new WeakMap,jw=function(t,r){if(typeof r!="function")return t;tP.has(t)||tP.set(t,new WeakMap);var n=tP.get(t);if(n.has(r))return n.get(r);var i=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,i),i},RRe=function(t,r,n){var i=t.scale,o=t.type,h=t.layout,s=t.axisType;if(i==="auto")return h==="radial"&&s==="radiusAxis"?{scale:s0(),realScaleType:"band"}:h==="radial"&&s==="angleAxis"?{scale:yS(),realScaleType:"linear"}:o==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:vx(),realScaleType:"point"}:o==="category"?{scale:s0(),realScaleType:"band"}:{scale:yS(),realScaleType:"linear"};if(df(i)){var p="scale".concat(p2(i));return{scale:(S$[p]||vx)(),realScaleType:S$[p]?p:"point"}}return Rr(i)?{scale:i}:{scale:vx(),realScaleType:"point"}},M$=1e-4,DRe=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,i=t.range(),o=Math.min(i[0],i[1])-M$,h=Math.max(i[0],i[1])+M$,s=t(r[0]),p=t(r[n-1]);(s<o||s>h||p<o||p>h)&&t.domain([r[0],r[n-1]])}},LRe=function(t,r){if(!t)return null;for(var n=0,i=t.length;n<i;n++)if(t[n].item===r)return t[n].position;return null},BRe=function(t,r){if(!r||r.length!==2||!qt(r[0])||!qt(r[1]))return t;var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]),o=[t[0],t[1]];return(!qt(t[0])||t[0]<n)&&(o[0]=n),(!qt(t[1])||t[1]>i)&&(o[1]=i),o[0]>i&&(o[0]=i),o[1]<n&&(o[1]=n),o},zRe=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var o=0,h=0,s=0;s<r;++s){var p=Q0(t[s][n][1])?t[s][n][0]:t[s][n][1];p>=0?(t[s][n][0]=o,t[s][n][1]=o+p,o=t[s][n][1]):(t[s][n][0]=h,t[s][n][1]=h+p,h=t[s][n][1])}},$Re=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var o=0,h=0;h<r;++h){var s=Q0(t[h][n][1])?t[h][n][0]:t[h][n][1];s>=0?(t[h][n][0]=o,t[h][n][1]=o+s,o=t[h][n][1]):(t[h][n][0]=0,t[h][n][1]=0)}},FRe={sign:zRe,expand:iSe,none:Dm,silhouette:sSe,wiggle:aSe,positive:$Re},URe=function(t,r,n){var i=r.map(function(s){return s.props.dataKey}),o=FRe[n],h=nSe().keys(i).value(function(s,p){return+Ba(s,p,0)}).order(dN).offset(o);return h(t)},VRe=function(t,r,n,i,o,h){if(!t)return null;var s=h?r.reverse():r,p={},y=s.reduce(function(_,E){var C,k=(C=E.type)!==null&&C!==void 0&&C.defaultProps?fi(fi({},E.type.defaultProps),E.props):E.props,N=k.stackId,O=k.hide;if(O)return _;var R=k[n],L=_[R]||{hasStack:!1,stackGroups:{}};if(Fi(N)){var B=L.stackGroups[N]||{numericAxisId:n,cateAxisId:i,items:[]};B.items.push(E),L.hasStack=!0,L.stackGroups[N]=B}else L.stackGroups[eb("_stackId_")]={numericAxisId:n,cateAxisId:i,items:[E]};return fi(fi({},_),{},bm({},R,L))},p),b={};return Object.keys(y).reduce(function(_,E){var C=y[E];if(C.hasStack){var k={};C.stackGroups=Object.keys(C.stackGroups).reduce(function(N,O){var R=C.stackGroups[O];return fi(fi({},N),{},bm({},O,{numericAxisId:n,cateAxisId:i,items:R.items,stackedData:URe(t,R.items,o)}))},k)}return fi(fi({},_),{},bm({},E,C))},b)},qRe=function(t,r){var n=r.realScaleType,i=r.type,o=r.tickCount,h=r.originalDomain,s=r.allowDecimals,p=n||r.scale;if(p!=="auto"&&p!=="linear")return null;if(o&&i==="number"&&h&&(h[0]==="auto"||h[1]==="auto")){var y=t.domain();if(!y.length)return null;var b=rRe(y,o,s);return t.domain([P2(b),C2(b)]),{niceTicks:b}}if(o&&i==="number"){var _=t.domain(),E=nRe(_,o,s);return{niceTicks:E}}return null};function I$(e){var t=e.axis,r=e.ticks,n=e.bandSize,i=e.entry,o=e.index,h=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Hr(i[t.dataKey])){var s=X1(r,"value",i[t.dataKey]);if(s)return s.coordinate+n/2}return r[o]?r[o].coordinate+n/2:null}var p=Ba(i,Hr(h)?t.dataKey:h);return Hr(p)?null:t.scale(p)}var O$=function(t){var r=t.axis,n=t.ticks,i=t.offset,o=t.bandSize,h=t.entry,s=t.index;if(r.type==="category")return n[s]?n[s].coordinate+i:null;var p=Ba(h,r.dataKey,r.domain[s]);return Hr(p)?null:r.scale(p)-o/2+i},WRe=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var i=Math.min(n[0],n[1]),o=Math.max(n[0],n[1]);return i<=0&&o>=0?0:o<0?o:i}return n[0]},GRe=function(t,r){var n,i=(n=t.type)!==null&&n!==void 0&&n.defaultProps?fi(fi({},t.type.defaultProps),t.props):t.props,o=i.stackId;if(Fi(o)){var h=r[o];if(h){var s=h.items.indexOf(t);return s>=0?h.stackedData[s]:null}}return null},HRe=function(t){return t.reduce(function(r,n){return[P2(n.concat([r[0]]).filter(qt)),C2(n.concat([r[1]]).filter(qt))]},[1/0,-1/0])},NK=function(t,r,n){return Object.keys(t).reduce(function(i,o){var h=t[o],s=h.stackedData,p=s.reduce(function(y,b){var _=HRe(b.slice(r,n+1));return[Math.min(y[0],_[0]),Math.max(y[1],_[1])]},[1/0,-1/0]);return[Math.min(p[0],i[0]),Math.max(p[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},R$=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,D$=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,FN=function(t,r,n){if(Rr(t))return t(r,n);if(!Array.isArray(t))return r;var i=[];if(qt(t[0]))i[0]=n?t[0]:Math.min(t[0],r[0]);else if(R$.test(t[0])){var o=+R$.exec(t[0])[1];i[0]=r[0]-o}else Rr(t[0])?i[0]=t[0](r[0]):i[0]=r[0];if(qt(t[1]))i[1]=n?t[1]:Math.max(t[1],r[1]);else if(D$.test(t[1])){var h=+D$.exec(t[1])[1];i[1]=r[1]+h}else Rr(t[1])?i[1]=t[1](r[1]):i[1]=r[1];return i},ES=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var i=t.scale.bandwidth();if(!n||i>0)return i}if(t&&r&&r.length>=2){for(var o=cO(r,function(_){return _.coordinate}),h=1/0,s=1,p=o.length;s<p;s++){var y=o[s],b=o[s-1];h=Math.min((y.coordinate||0)-(b.coordinate||0),h)}return h===1/0?0:h}return n?void 0:0},L$=function(t,r,n){return!t||!t.length||A2(t,po(n,"type.defaultProps.domain"))?r:t},kK=function(t,r){var n=t.type.defaultProps?fi(fi({},t.type.defaultProps),t.props):t.props,i=n.dataKey,o=n.name,h=n.unit,s=n.formatter,p=n.tooltipType,y=n.chartType,b=n.hide;return fi(fi({},Kr(t,!1)),{},{dataKey:i,unit:h,formatter:s,name:o||i,color:RO(t),value:Ba(r,i),type:p,payload:r,chartType:y,hide:b})};function p0(e){"@babel/helpers - typeof";return p0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p0(e)}function B$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function z$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B$(Object(r),!0).forEach(function(n){XRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XRe(e,t,r){return t=KRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KRe(e){var t=ZRe(e,"string");return p0(t)=="symbol"?t:t+""}function ZRe(e,t){if(p0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(p0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TS=Math.PI/180,YRe=function(t){return t*180/Math.PI},ds=function(t,r,n,i){return{x:t+Math.cos(-TS*i)*n,y:r+Math.sin(-TS*i)*n}},JRe=function(t,r){var n=t.x,i=t.y,o=r.x,h=r.y;return Math.sqrt(Math.pow(n-o,2)+Math.pow(i-h,2))},QRe=function(t,r){var n=t.x,i=t.y,o=r.cx,h=r.cy,s=JRe({x:n,y:i},{x:o,y:h});if(s<=0)return{radius:s};var p=(n-o)/s,y=Math.acos(p);return i>h&&(y=2*Math.PI-y),{radius:s,angle:YRe(y),angleInRadian:y}},eDe=function(t){var r=t.startAngle,n=t.endAngle,i=Math.floor(r/360),o=Math.floor(n/360),h=Math.min(i,o);return{startAngle:r-h*360,endAngle:n-h*360}},tDe=function(t,r){var n=r.startAngle,i=r.endAngle,o=Math.floor(n/360),h=Math.floor(i/360),s=Math.min(o,h);return t+s*360},$$=function(t,r){var n=t.x,i=t.y,o=QRe({x:n,y:i},r),h=o.radius,s=o.angle,p=r.innerRadius,y=r.outerRadius;if(h<p||h>y)return!1;if(h===0)return!0;var b=eDe(r),_=b.startAngle,E=b.endAngle,C=s,k;if(_<=E){for(;C>E;)C-=360;for(;C<_;)C+=360;k=C>=_&&C<=E}else{for(;C>_;)C-=360;for(;C<E;)C+=360;k=C>=E&&C<=_}return k?z$(z$({},r),{},{radius:h,angle:tDe(C,r)}):null};function m0(e){"@babel/helpers - typeof";return m0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m0(e)}var rDe=["offset"];function nDe(e){return oDe(e)||aDe(e)||sDe(e)||iDe()}function iDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sDe(e,t){if(e){if(typeof e=="string")return UN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UN(e,t)}}function aDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oDe(e){if(Array.isArray(e))return UN(e)}function UN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lDe(e,t){if(e==null)return{};var r=cDe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function F$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Bi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F$(Object(r),!0).forEach(function(n){uDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uDe(e,t,r){return t=dDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dDe(e){var t=hDe(e,"string");return m0(t)=="symbol"?t:t+""}function hDe(e,t){if(m0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(m0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g0(){return g0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g0.apply(this,arguments)}var fDe=function(t){var r=t.value,n=t.formatter,i=Hr(t.children)?r:t.children;return Rr(n)?n(i):i},pDe=function(t,r){var n=al(r-t),i=Math.min(Math.abs(r-t),360);return n*i},mDe=function(t,r,n){var i=t.position,o=t.viewBox,h=t.offset,s=t.className,p=o,y=p.cx,b=p.cy,_=p.innerRadius,E=p.outerRadius,C=p.startAngle,k=p.endAngle,N=p.clockWise,O=(_+E)/2,R=pDe(C,k),L=R>=0?1:-1,B,q;i==="insideStart"?(B=C+L*h,q=N):i==="insideEnd"?(B=k-L*h,q=!N):i==="end"&&(B=k+L*h,q=N),q=R<=0?q:!q;var F=ds(y,b,O,B),H=ds(y,b,O,B+(q?1:-1)*359),Z="M".concat(F.x,",").concat(F.y,`
    A`).concat(O,",").concat(O,",0,1,").concat(q?0:1,`,
    `).concat(H.x,",").concat(H.y),re=Hr(t.id)?eb("recharts-radial-line-"):t.id;return je.createElement("text",g0({},n,{dominantBaseline:"central",className:Jr("recharts-radial-bar-label",s)}),je.createElement("defs",null,je.createElement("path",{id:re,d:Z})),je.createElement("textPath",{xlinkHref:"#".concat(re)},r))},gDe=function(t){var r=t.viewBox,n=t.offset,i=t.position,o=r,h=o.cx,s=o.cy,p=o.innerRadius,y=o.outerRadius,b=o.startAngle,_=o.endAngle,E=(b+_)/2;if(i==="outside"){var C=ds(h,s,y+n,E),k=C.x,N=C.y;return{x:k,y:N,textAnchor:k>=h?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:h,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:h,y:s,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:h,y:s,textAnchor:"middle",verticalAnchor:"end"};var O=(p+y)/2,R=ds(h,s,O,E),L=R.x,B=R.y;return{x:L,y:B,textAnchor:"middle",verticalAnchor:"middle"}},yDe=function(t){var r=t.viewBox,n=t.parentViewBox,i=t.offset,o=t.position,h=r,s=h.x,p=h.y,y=h.width,b=h.height,_=b>=0?1:-1,E=_*i,C=_>0?"end":"start",k=_>0?"start":"end",N=y>=0?1:-1,O=N*i,R=N>0?"end":"start",L=N>0?"start":"end";if(o==="top"){var B={x:s+y/2,y:p-_*i,textAnchor:"middle",verticalAnchor:C};return Bi(Bi({},B),n?{height:Math.max(p-n.y,0),width:y}:{})}if(o==="bottom"){var q={x:s+y/2,y:p+b+E,textAnchor:"middle",verticalAnchor:k};return Bi(Bi({},q),n?{height:Math.max(n.y+n.height-(p+b),0),width:y}:{})}if(o==="left"){var F={x:s-O,y:p+b/2,textAnchor:R,verticalAnchor:"middle"};return Bi(Bi({},F),n?{width:Math.max(F.x-n.x,0),height:b}:{})}if(o==="right"){var H={x:s+y+O,y:p+b/2,textAnchor:L,verticalAnchor:"middle"};return Bi(Bi({},H),n?{width:Math.max(n.x+n.width-H.x,0),height:b}:{})}var Z=n?{width:y,height:b}:{};return o==="insideLeft"?Bi({x:s+O,y:p+b/2,textAnchor:L,verticalAnchor:"middle"},Z):o==="insideRight"?Bi({x:s+y-O,y:p+b/2,textAnchor:R,verticalAnchor:"middle"},Z):o==="insideTop"?Bi({x:s+y/2,y:p+E,textAnchor:"middle",verticalAnchor:k},Z):o==="insideBottom"?Bi({x:s+y/2,y:p+b-E,textAnchor:"middle",verticalAnchor:C},Z):o==="insideTopLeft"?Bi({x:s+O,y:p+E,textAnchor:L,verticalAnchor:k},Z):o==="insideTopRight"?Bi({x:s+y-O,y:p+E,textAnchor:R,verticalAnchor:k},Z):o==="insideBottomLeft"?Bi({x:s+O,y:p+b-E,textAnchor:L,verticalAnchor:C},Z):o==="insideBottomRight"?Bi({x:s+y-O,y:p+b-E,textAnchor:R,verticalAnchor:C},Z):jg(o)&&(qt(o.x)||qh(o.x))&&(qt(o.y)||qh(o.y))?Bi({x:s+hf(o.x,y),y:p+hf(o.y,b),textAnchor:"end",verticalAnchor:"end"},Z):Bi({x:s+y/2,y:p+b/2,textAnchor:"middle",verticalAnchor:"middle"},Z)},vDe=function(t){return"cx"in t&&qt(t.cx)};function As(e){var t=e.offset,r=t===void 0?5:t,n=lDe(e,rDe),i=Bi({offset:r},n),o=i.viewBox,h=i.position,s=i.value,p=i.children,y=i.content,b=i.className,_=b===void 0?"":b,E=i.textBreakAll;if(!o||Hr(s)&&Hr(p)&&!I.isValidElement(y)&&!Rr(y))return null;if(I.isValidElement(y))return I.cloneElement(y,i);var C;if(Rr(y)){if(C=I.createElement(y,i),I.isValidElement(C))return C}else C=fDe(i);var k=vDe(o),N=Kr(i,!0);if(k&&(h==="insideStart"||h==="insideEnd"||h==="end"))return mDe(i,C,N);var O=k?gDe(i):yDe(i);return je.createElement(uS,g0({className:Jr("recharts-label",_)},N,O,{breakAll:E}),C)}As.displayName="Label";var MK=function(t){var r=t.cx,n=t.cy,i=t.angle,o=t.startAngle,h=t.endAngle,s=t.r,p=t.radius,y=t.innerRadius,b=t.outerRadius,_=t.x,E=t.y,C=t.top,k=t.left,N=t.width,O=t.height,R=t.clockWise,L=t.labelViewBox;if(L)return L;if(qt(N)&&qt(O)){if(qt(_)&&qt(E))return{x:_,y:E,width:N,height:O};if(qt(C)&&qt(k))return{x:C,y:k,width:N,height:O}}return qt(_)&&qt(E)?{x:_,y:E,width:0,height:0}:qt(r)&&qt(n)?{cx:r,cy:n,startAngle:o||i||0,endAngle:h||i||0,innerRadius:y||0,outerRadius:b||p||s||0,clockWise:R}:t.viewBox?t.viewBox:{}},xDe=function(t,r){return t?t===!0?je.createElement(As,{key:"label-implicit",viewBox:r}):Fi(t)?je.createElement(As,{key:"label-implicit",viewBox:r,value:t}):I.isValidElement(t)?t.type===As?I.cloneElement(t,{key:"label-implicit",viewBox:r}):je.createElement(As,{key:"label-implicit",content:t,viewBox:r}):Rr(t)?je.createElement(As,{key:"label-implicit",content:t,viewBox:r}):jg(t)?je.createElement(As,g0({viewBox:r},t,{key:"label-implicit"})):null:null},bDe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var i=t.children,o=MK(t),h=mo(i,As).map(function(p,y){return I.cloneElement(p,{viewBox:r||o,key:"label-".concat(y)})});if(!n)return h;var s=xDe(t.label,r||o);return[s].concat(nDe(h))};As.parseViewBox=MK;As.renderCallByParent=bDe;function _De(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var wDe=_De;const SDe=Sn(wDe);function y0(e){"@babel/helpers - typeof";return y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y0(e)}var EDe=["valueAccessor"],TDe=["data","dataKey","clockWise","id","textBreakAll"];function jDe(e){return NDe(e)||ADe(e)||PDe(e)||CDe()}function CDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PDe(e,t){if(e){if(typeof e=="string")return VN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VN(e,t)}}function ADe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function NDe(e){if(Array.isArray(e))return VN(e)}function VN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jS(){return jS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jS.apply(this,arguments)}function U$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function V$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U$(Object(r),!0).forEach(function(n){kDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kDe(e,t,r){return t=MDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MDe(e){var t=IDe(e,"string");return y0(t)=="symbol"?t:t+""}function IDe(e,t){if(y0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(y0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q$(e,t){if(e==null)return{};var r=ODe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ODe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var RDe=function(t){return Array.isArray(t.value)?SDe(t.value):t.value};function fd(e){var t=e.valueAccessor,r=t===void 0?RDe:t,n=q$(e,EDe),i=n.data,o=n.dataKey,h=n.clockWise,s=n.id,p=n.textBreakAll,y=q$(n,TDe);return!i||!i.length?null:je.createElement(gi,{className:"recharts-label-list"},i.map(function(b,_){var E=Hr(o)?r(b,_):Ba(b&&b.payload,o),C=Hr(s)?{}:{id:"".concat(s,"-").concat(_)};return je.createElement(As,jS({},Kr(b,!0),y,C,{parentViewBox:b.parentViewBox,value:E,textBreakAll:p,viewBox:As.parseViewBox(Hr(h)?b:V$(V$({},b),{},{clockWise:h})),key:"label-".concat(_),index:_}))}))}fd.displayName="LabelList";function DDe(e,t){return e?e===!0?je.createElement(fd,{key:"labelList-implicit",data:t}):je.isValidElement(e)||Rr(e)?je.createElement(fd,{key:"labelList-implicit",data:t,content:e}):jg(e)?je.createElement(fd,jS({data:t},e,{key:"labelList-implicit"})):null:null}function LDe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,i=mo(n,fd).map(function(h,s){return I.cloneElement(h,{data:t,key:"labelList-".concat(s)})});if(!r)return i;var o=DDe(e.label,t);return[o].concat(jDe(i))}fd.renderCallByParent=LDe;function v0(e){"@babel/helpers - typeof";return v0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v0(e)}function qN(){return qN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qN.apply(this,arguments)}function W$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function G$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W$(Object(r),!0).forEach(function(n){BDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BDe(e,t,r){return t=zDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zDe(e){var t=$De(e,"string");return v0(t)=="symbol"?t:t+""}function $De(e,t){if(v0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(v0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FDe=function(t,r){var n=al(r-t),i=Math.min(Math.abs(r-t),359.999);return n*i},Cw=function(t){var r=t.cx,n=t.cy,i=t.radius,o=t.angle,h=t.sign,s=t.isExternal,p=t.cornerRadius,y=t.cornerIsExternal,b=p*(s?1:-1)+i,_=Math.asin(p/b)/TS,E=y?o:o+h*_,C=ds(r,n,b,E),k=ds(r,n,i,E),N=y?o-h*_:o,O=ds(r,n,b*Math.cos(_*TS),N);return{center:C,circleTangency:k,lineTangency:O,theta:_}},IK=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,o=t.outerRadius,h=t.startAngle,s=t.endAngle,p=FDe(h,s),y=h+p,b=ds(r,n,o,h),_=ds(r,n,o,y),E="M ".concat(b.x,",").concat(b.y,`
    A `).concat(o,",").concat(o,`,0,
    `).concat(+(Math.abs(p)>180),",").concat(+(h>y),`,
    `).concat(_.x,",").concat(_.y,`
  `);if(i>0){var C=ds(r,n,i,h),k=ds(r,n,i,y);E+="L ".concat(k.x,",").concat(k.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(p)>180),",").concat(+(h<=y),`,
            `).concat(C.x,",").concat(C.y," Z")}else E+="L ".concat(r,",").concat(n," Z");return E},UDe=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,o=t.outerRadius,h=t.cornerRadius,s=t.forceCornerRadius,p=t.cornerIsExternal,y=t.startAngle,b=t.endAngle,_=al(b-y),E=Cw({cx:r,cy:n,radius:o,angle:y,sign:_,cornerRadius:h,cornerIsExternal:p}),C=E.circleTangency,k=E.lineTangency,N=E.theta,O=Cw({cx:r,cy:n,radius:o,angle:b,sign:-_,cornerRadius:h,cornerIsExternal:p}),R=O.circleTangency,L=O.lineTangency,B=O.theta,q=p?Math.abs(y-b):Math.abs(y-b)-N-B;if(q<0)return s?"M ".concat(k.x,",").concat(k.y,`
        a`).concat(h,",").concat(h,",0,0,1,").concat(h*2,`,0
        a`).concat(h,",").concat(h,",0,0,1,").concat(-h*2,`,0
      `):IK({cx:r,cy:n,innerRadius:i,outerRadius:o,startAngle:y,endAngle:b});var F="M ".concat(k.x,",").concat(k.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(_<0),",").concat(C.x,",").concat(C.y,`
    A`).concat(o,",").concat(o,",0,").concat(+(q>180),",").concat(+(_<0),",").concat(R.x,",").concat(R.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(_<0),",").concat(L.x,",").concat(L.y,`
  `);if(i>0){var H=Cw({cx:r,cy:n,radius:i,angle:y,sign:_,isExternal:!0,cornerRadius:h,cornerIsExternal:p}),Z=H.circleTangency,re=H.lineTangency,W=H.theta,te=Cw({cx:r,cy:n,radius:i,angle:b,sign:-_,isExternal:!0,cornerRadius:h,cornerIsExternal:p}),oe=te.circleTangency,ie=te.lineTangency,ue=te.theta,_e=p?Math.abs(y-b):Math.abs(y-b)-W-ue;if(_e<0&&h===0)return"".concat(F,"L").concat(r,",").concat(n,"Z");F+="L".concat(ie.x,",").concat(ie.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(_<0),",").concat(oe.x,",").concat(oe.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(_e>180),",").concat(+(_>0),",").concat(Z.x,",").concat(Z.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(_<0),",").concat(re.x,",").concat(re.y,"Z")}else F+="L".concat(r,",").concat(n,"Z");return F},VDe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},OK=function(t){var r=G$(G$({},VDe),t),n=r.cx,i=r.cy,o=r.innerRadius,h=r.outerRadius,s=r.cornerRadius,p=r.forceCornerRadius,y=r.cornerIsExternal,b=r.startAngle,_=r.endAngle,E=r.className;if(h<o||b===_)return null;var C=Jr("recharts-sector",E),k=h-o,N=hf(s,k,0,!0),O;return N>0&&Math.abs(b-_)<360?O=UDe({cx:n,cy:i,innerRadius:o,outerRadius:h,cornerRadius:Math.min(N,k/2),forceCornerRadius:p,cornerIsExternal:y,startAngle:b,endAngle:_}):O=IK({cx:n,cy:i,innerRadius:o,outerRadius:h,startAngle:b,endAngle:_}),je.createElement("path",qN({},Kr(r,!0),{className:C,d:O,role:"img"}))};function x0(e){"@babel/helpers - typeof";return x0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x0(e)}function WN(){return WN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WN.apply(this,arguments)}function H$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function X$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H$(Object(r),!0).forEach(function(n){qDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qDe(e,t,r){return t=WDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WDe(e){var t=GDe(e,"string");return x0(t)=="symbol"?t:t+""}function GDe(e,t){if(x0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(x0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K$={curveBasisClosed:G1e,curveBasisOpen:H1e,curveBasis:W1e,curveBumpX:k1e,curveBumpY:M1e,curveLinearClosed:X1e,curveLinear:g2,curveMonotoneX:K1e,curveMonotoneY:Z1e,curveNatural:Y1e,curveStep:J1e,curveStepAfter:eSe,curveStepBefore:Q1e},Pw=function(t){return t.x===+t.x&&t.y===+t.y},Bv=function(t){return t.x},zv=function(t){return t.y},HDe=function(t,r){if(Rr(t))return t;var n="curve".concat(p2(t));return(n==="curveMonotone"||n==="curveBump")&&r?K$["".concat(n).concat(r==="vertical"?"Y":"X")]:K$[n]||g2},XDe=function(t){var r=t.type,n=r===void 0?"linear":r,i=t.points,o=i===void 0?[]:i,h=t.baseLine,s=t.layout,p=t.connectNulls,y=p===void 0?!1:p,b=HDe(n,s),_=y?o.filter(function(N){return Pw(N)}):o,E;if(Array.isArray(h)){var C=y?h.filter(function(N){return Pw(N)}):h,k=_.map(function(N,O){return X$(X$({},N),{},{base:C[O]})});return s==="vertical"?E=vw().y(zv).x1(Bv).x0(function(N){return N.base.x}):E=vw().x(Bv).y1(zv).y0(function(N){return N.base.y}),E.defined(Pw).curve(b),E(k)}return s==="vertical"&&qt(h)?E=vw().y(zv).x1(Bv).x0(h):qt(h)?E=vw().x(Bv).y1(zv).y0(h):E=OH().x(Bv).y(zv),E.defined(Pw).curve(b),E(_)},GN=function(t){var r=t.className,n=t.points,i=t.path,o=t.pathRef;if((!n||!n.length)&&!i)return null;var h=n&&n.length?XDe(t):i;return je.createElement("path",WN({},Kr(t,!1),K1(t),{className:Jr("recharts-curve",r),d:h,ref:o}))},KDe=Object.getOwnPropertyNames,ZDe=Object.getOwnPropertySymbols,YDe=Object.prototype.hasOwnProperty;function Z$(e,t){return function(n,i,o){return e(n,i,o)&&t(n,i,o)}}function Aw(e){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,i);var o=i.cache,h=o.get(r),s=o.get(n);if(h&&s)return h===n&&s===r;o.set(r,n),o.set(n,r);var p=e(r,n,i);return o.delete(r),o.delete(n),p}}function Y$(e){return KDe(e).concat(ZDe(e))}var JDe=Object.hasOwn||function(e,t){return YDe.call(e,t)};function Pf(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var QDe="__v",eLe="__o",tLe="_owner",J$=Object.getOwnPropertyDescriptor,Q$=Object.keys;function rLe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function nLe(e,t){return Pf(e.getTime(),t.getTime())}function iLe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function sLe(e,t){return e===t}function eF(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var i=new Array(n),o=e.entries(),h,s,p=0;(h=o.next())&&!h.done;){for(var y=t.entries(),b=!1,_=0;(s=y.next())&&!s.done;){if(i[_]){_++;continue}var E=h.value,C=s.value;if(r.equals(E[0],C[0],p,_,e,t,r)&&r.equals(E[1],C[1],E[0],C[0],e,t,r)){b=i[_]=!0;break}_++}if(!b)return!1;p++}return!0}var aLe=Pf;function oLe(e,t,r){var n=Q$(e),i=n.length;if(Q$(t).length!==i)return!1;for(;i-- >0;)if(!RK(e,t,r,n[i]))return!1;return!0}function $v(e,t,r){var n=Y$(e),i=n.length;if(Y$(t).length!==i)return!1;for(var o,h,s;i-- >0;)if(o=n[i],!RK(e,t,r,o)||(h=J$(e,o),s=J$(t,o),(h||s)&&(!h||!s||h.configurable!==s.configurable||h.enumerable!==s.enumerable||h.writable!==s.writable)))return!1;return!0}function lLe(e,t){return Pf(e.valueOf(),t.valueOf())}function cLe(e,t){return e.source===t.source&&e.flags===t.flags}function tF(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var i=new Array(n),o=e.values(),h,s;(h=o.next())&&!h.done;){for(var p=t.values(),y=!1,b=0;(s=p.next())&&!s.done;){if(!i[b]&&r.equals(h.value,s.value,h.value,s.value,e,t,r)){y=i[b]=!0;break}b++}if(!y)return!1}return!0}function uLe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function dLe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function RK(e,t,r,n){return(n===tLe||n===eLe||n===QDe)&&(e.$$typeof||t.$$typeof)?!0:JDe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var hLe="[object Arguments]",fLe="[object Boolean]",pLe="[object Date]",mLe="[object Error]",gLe="[object Map]",yLe="[object Number]",vLe="[object Object]",xLe="[object RegExp]",bLe="[object Set]",_Le="[object String]",wLe="[object URL]",SLe=Array.isArray,rF=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,nF=Object.assign,ELe=Object.prototype.toString.call.bind(Object.prototype.toString);function TLe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,i=e.areFunctionsEqual,o=e.areMapsEqual,h=e.areNumbersEqual,s=e.areObjectsEqual,p=e.arePrimitiveWrappersEqual,y=e.areRegExpsEqual,b=e.areSetsEqual,_=e.areTypedArraysEqual,E=e.areUrlsEqual;return function(k,N,O){if(k===N)return!0;if(k==null||N==null)return!1;var R=typeof k;if(R!==typeof N)return!1;if(R!=="object")return R==="number"?h(k,N,O):R==="function"?i(k,N,O):!1;var L=k.constructor;if(L!==N.constructor)return!1;if(L===Object)return s(k,N,O);if(SLe(k))return t(k,N,O);if(rF!=null&&rF(k))return _(k,N,O);if(L===Date)return r(k,N,O);if(L===RegExp)return y(k,N,O);if(L===Map)return o(k,N,O);if(L===Set)return b(k,N,O);var B=ELe(k);return B===pLe?r(k,N,O):B===xLe?y(k,N,O):B===gLe?o(k,N,O):B===bLe?b(k,N,O):B===vLe?typeof k.then!="function"&&typeof N.then!="function"&&s(k,N,O):B===wLe?E(k,N,O):B===mLe?n(k,N,O):B===hLe?s(k,N,O):B===fLe||B===yLe||B===_Le?p(k,N,O):!1}}function jLe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,i={areArraysEqual:n?$v:rLe,areDatesEqual:nLe,areErrorsEqual:iLe,areFunctionsEqual:sLe,areMapsEqual:n?Z$(eF,$v):eF,areNumbersEqual:aLe,areObjectsEqual:n?$v:oLe,arePrimitiveWrappersEqual:lLe,areRegExpsEqual:cLe,areSetsEqual:n?Z$(tF,$v):tF,areTypedArraysEqual:n?$v:uLe,areUrlsEqual:dLe};if(r&&(i=nF({},i,r(i))),t){var o=Aw(i.areArraysEqual),h=Aw(i.areMapsEqual),s=Aw(i.areObjectsEqual),p=Aw(i.areSetsEqual);i=nF({},i,{areArraysEqual:o,areMapsEqual:h,areObjectsEqual:s,areSetsEqual:p})}return i}function CLe(e){return function(t,r,n,i,o,h,s){return e(t,r,s)}}function PLe(e){var t=e.circular,r=e.comparator,n=e.createState,i=e.equals,o=e.strict;if(n)return function(p,y){var b=n(),_=b.cache,E=_===void 0?t?new WeakMap:void 0:_,C=b.meta;return r(p,y,{cache:E,equals:i,meta:C,strict:o})};if(t)return function(p,y){return r(p,y,{cache:new WeakMap,equals:i,meta:void 0,strict:o})};var h={cache:void 0,equals:i,meta:void 0,strict:o};return function(p,y){return r(p,y,h)}}var ALe=Dd();Dd({strict:!0});Dd({circular:!0});Dd({circular:!0,strict:!0});Dd({createInternalComparator:function(){return Pf}});Dd({strict:!0,createInternalComparator:function(){return Pf}});Dd({circular:!0,createInternalComparator:function(){return Pf}});Dd({circular:!0,createInternalComparator:function(){return Pf},strict:!0});function Dd(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,i=e.createState,o=e.strict,h=o===void 0?!1:o,s=jLe(e),p=TLe(s),y=n?n(p):CLe(p);return PLe({circular:r,comparator:p,createState:i,equals:y,strict:h})}function NLe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function iF(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function i(o){r<0&&(r=o),o-r>t?(e(o),r=-1):NLe(i)};requestAnimationFrame(n)}function HN(e){"@babel/helpers - typeof";return HN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HN(e)}function kLe(e){return RLe(e)||OLe(e)||ILe(e)||MLe()}function MLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ILe(e,t){if(e){if(typeof e=="string")return sF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sF(e,t)}}function sF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RLe(e){if(Array.isArray(e))return e}function DLe(){var e={},t=function(){return null},r=!1,n=function i(o){if(!r){if(Array.isArray(o)){if(!o.length)return;var h=o,s=kLe(h),p=s[0],y=s.slice(1);if(typeof p=="number"){iF(i.bind(null,y),p);return}i(p),iF(i.bind(null,y));return}HN(o)==="object"&&(e=o,t(e)),typeof o=="function"&&o()}};return{stop:function(){r=!0},start:function(o){r=!1,n(o)},subscribe:function(o){return t=o,function(){t=function(){return null}}}}}function b0(e){"@babel/helpers - typeof";return b0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b0(e)}function aF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aF(Object(r),!0).forEach(function(n){DK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DK(e,t,r){return t=LLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LLe(e){var t=BLe(e,"string");return b0(t)==="symbol"?t:String(t)}function BLe(e,t){if(b0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(b0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zLe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,i){return n.filter(function(o){return i.includes(o)})})},$Le=function(t){return t},FLe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},bx=function(t,r){return Object.keys(r).reduce(function(n,i){return oF(oF({},n),{},DK({},i,t(i,r[i])))},{})},lF=function(t,r,n){return t.map(function(i){return"".concat(FLe(i)," ").concat(r,"ms ").concat(n)}).join(",")};function ULe(e,t){return WLe(e)||qLe(e,t)||LK(e,t)||VLe()}function VLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,h,s=[],p=!0,y=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);p=!0);}catch(b){y=!0,i=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw i}}return s}}function WLe(e){if(Array.isArray(e))return e}function GLe(e){return KLe(e)||XLe(e)||LK(e)||HLe()}function HLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LK(e,t){if(e){if(typeof e=="string")return XN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XN(e,t)}}function XLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KLe(e){if(Array.isArray(e))return XN(e)}function XN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var CS=1e-4,BK=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},zK=function(t,r){return t.map(function(n,i){return n*Math.pow(r,i)}).reduce(function(n,i){return n+i})},cF=function(t,r){return function(n){var i=BK(t,r);return zK(i,n)}},ZLe=function(t,r){return function(n){var i=BK(t,r),o=[].concat(GLe(i.map(function(h,s){return h*s}).slice(1)),[0]);return zK(o,n)}},uF=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0],o=r[1],h=r[2],s=r[3];if(r.length===1)switch(r[0]){case"linear":i=0,o=0,h=1,s=1;break;case"ease":i=.25,o=.1,h=.25,s=1;break;case"ease-in":i=.42,o=0,h=1,s=1;break;case"ease-out":i=.42,o=0,h=.58,s=1;break;case"ease-in-out":i=0,o=0,h=.58,s=1;break;default:{var p=r[0].split("(");if(p[0]==="cubic-bezier"&&p[1].split(")")[0].split(",").length===4){var y=p[1].split(")")[0].split(",").map(function(O){return parseFloat(O)}),b=ULe(y,4);i=b[0],o=b[1],h=b[2],s=b[3]}}}var _=cF(i,h),E=cF(o,s),C=ZLe(i,h),k=function(R){return R>1?1:R<0?0:R},N=function(R){for(var L=R>1?1:R,B=L,q=0;q<8;++q){var F=_(B)-L,H=C(B);if(Math.abs(F-L)<CS||H<CS)return E(B);B=k(B-F/H)}return E(B)};return N.isStepper=!1,N},YLe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,i=t.damping,o=i===void 0?8:i,h=t.dt,s=h===void 0?17:h,p=function(b,_,E){var C=-(b-_)*n,k=E*o,N=E+(C-k)*s/1e3,O=E*s/1e3+b;return Math.abs(O-_)<CS&&Math.abs(N)<CS?[_,0]:[O,N]};return p.isStepper=!0,p.dt=s,p},JLe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return uF(i);case"spring":return YLe();default:if(i.split("(")[0]==="cubic-bezier")return uF(i)}return typeof i=="function"?i:null};function _0(e){"@babel/helpers - typeof";return _0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_0(e)}function dF(e){return t3e(e)||e3e(e)||$K(e)||QLe()}function QLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function t3e(e){if(Array.isArray(e))return ZN(e)}function hF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function as(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hF(Object(r),!0).forEach(function(n){KN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KN(e,t,r){return t=r3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r3e(e){var t=n3e(e,"string");return _0(t)==="symbol"?t:String(t)}function n3e(e,t){if(_0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function i3e(e,t){return o3e(e)||a3e(e,t)||$K(e,t)||s3e()}function s3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $K(e,t){if(e){if(typeof e=="string")return ZN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZN(e,t)}}function ZN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,h,s=[],p=!0,y=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);p=!0);}catch(b){y=!0,i=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw i}}return s}}function o3e(e){if(Array.isArray(e))return e}var PS=function(t,r,n){return t+(r-t)*n},YN=function(t){var r=t.from,n=t.to;return r!==n},l3e=function e(t,r,n){var i=bx(function(o,h){if(YN(h)){var s=t(h.from,h.to,h.velocity),p=i3e(s,2),y=p[0],b=p[1];return as(as({},h),{},{from:y,velocity:b})}return h},r);return n<1?bx(function(o,h){return YN(h)?as(as({},h),{},{velocity:PS(h.velocity,i[o].velocity,n),from:PS(h.from,i[o].from,n)}):h},r):e(t,i,n-1)};const c3e=function(e,t,r,n,i){var o=zLe(e,t),h=o.reduce(function(O,R){return as(as({},O),{},KN({},R,[e[R],t[R]]))},{}),s=o.reduce(function(O,R){return as(as({},O),{},KN({},R,{from:e[R],velocity:0,to:t[R]}))},{}),p=-1,y,b,_=function(){return null},E=function(){return bx(function(R,L){return L.from},s)},C=function(){return!Object.values(s).filter(YN).length},k=function(R){y||(y=R);var L=R-y,B=L/r.dt;s=l3e(r,s,B),i(as(as(as({},e),t),E())),y=R,C()||(p=requestAnimationFrame(_))},N=function(R){b||(b=R);var L=(R-b)/n,B=bx(function(F,H){return PS.apply(void 0,dF(H).concat([r(L)]))},h);if(i(as(as(as({},e),t),B)),L<1)p=requestAnimationFrame(_);else{var q=bx(function(F,H){return PS.apply(void 0,dF(H).concat([r(1)]))},h);i(as(as(as({},e),t),q))}};return _=r.isStepper?k:N,function(){return requestAnimationFrame(_),function(){cancelAnimationFrame(p)}}};function Wm(e){"@babel/helpers - typeof";return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wm(e)}var u3e=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function d3e(e,t){if(e==null)return{};var r=h3e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function h3e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function rP(e){return g3e(e)||m3e(e)||p3e(e)||f3e()}function f3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p3e(e,t){if(e){if(typeof e=="string")return JN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JN(e,t)}}function m3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function g3e(e){if(Array.isArray(e))return JN(e)}function JN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Wo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fF(Object(r),!0).forEach(function(n){Zv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zv(e,t,r){return t=FK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FK(n.key),n)}}function v3e(e,t,r){return t&&pF(e.prototype,t),r&&pF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FK(e){var t=x3e(e,"string");return Wm(t)==="symbol"?t:String(t)}function x3e(e,t){if(Wm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function b3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QN(e,t)}function QN(e,t){return QN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},QN(e,t)}function _3e(e){var t=w3e();return function(){var n=AS(e),i;if(t){var o=AS(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ek(this,i)}}function ek(e,t){if(t&&(Wm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tk(e)}function tk(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function AS(e){return AS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},AS(e)}var M2=function(e){b3e(r,e);var t=_3e(r);function r(n,i){var o;y3e(this,r),o=t.call(this,n,i);var h=o.props,s=h.isActive,p=h.attributeName,y=h.from,b=h.to,_=h.steps,E=h.children,C=h.duration;if(o.handleStyleChange=o.handleStyleChange.bind(tk(o)),o.changeStyle=o.changeStyle.bind(tk(o)),!s||C<=0)return o.state={style:{}},typeof E=="function"&&(o.state={style:b}),ek(o);if(_&&_.length)o.state={style:_[0].style};else if(y){if(typeof E=="function")return o.state={style:y},ek(o);o.state={style:p?Zv({},p,y):y}}else o.state={style:{}};return o}return v3e(r,[{key:"componentDidMount",value:function(){var i=this.props,o=i.isActive,h=i.canBegin;this.mounted=!0,!(!o||!h)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var o=this.props,h=o.isActive,s=o.canBegin,p=o.attributeName,y=o.shouldReAnimate,b=o.to,_=o.from,E=this.state.style;if(s){if(!h){var C={style:p?Zv({},p,b):b};this.state&&E&&(p&&E[p]!==b||!p&&E!==b)&&this.setState(C);return}if(!(ALe(i.to,b)&&i.canBegin&&i.isActive)){var k=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var N=k||y?_:i.to;if(this.state&&E){var O={style:p?Zv({},p,N):N};(p&&E[p]!==N||!p&&E!==N)&&this.setState(O)}this.runAnimation(Wo(Wo({},this.props),{},{from:N,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var o=this,h=i.from,s=i.to,p=i.duration,y=i.easing,b=i.begin,_=i.onAnimationEnd,E=i.onAnimationStart,C=c3e(h,s,JLe(y),p,this.changeStyle),k=function(){o.stopJSAnimation=C()};this.manager.start([E,b,k,p,_])}},{key:"runStepAnimation",value:function(i){var o=this,h=i.steps,s=i.begin,p=i.onAnimationStart,y=h[0],b=y.style,_=y.duration,E=_===void 0?0:_,C=function(N,O,R){if(R===0)return N;var L=O.duration,B=O.easing,q=B===void 0?"ease":B,F=O.style,H=O.properties,Z=O.onAnimationEnd,re=R>0?h[R-1]:O,W=H||Object.keys(F);if(typeof q=="function"||q==="spring")return[].concat(rP(N),[o.runJSAnimation.bind(o,{from:re.style,to:F,duration:L,easing:q}),L]);var te=lF(W,L,q),oe=Wo(Wo(Wo({},re.style),F),{},{transition:te});return[].concat(rP(N),[oe,L,Z]).filter($Le)};return this.manager.start([p].concat(rP(h.reduce(C,[b,Math.max(E,s)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=DLe());var o=i.begin,h=i.duration,s=i.attributeName,p=i.to,y=i.easing,b=i.onAnimationStart,_=i.onAnimationEnd,E=i.steps,C=i.children,k=this.manager;if(this.unSubscribe=k.subscribe(this.handleStyleChange),typeof y=="function"||typeof C=="function"||y==="spring"){this.runJSAnimation(i);return}if(E.length>1){this.runStepAnimation(i);return}var N=s?Zv({},s,p):p,O=lF(Object.keys(N),h,y);k.start([b,o,Wo(Wo({},N),{},{transition:O}),h,_])}},{key:"render",value:function(){var i=this.props,o=i.children;i.begin;var h=i.duration;i.attributeName,i.easing;var s=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var p=d3e(i,u3e),y=I.Children.count(o),b=this.state.style;if(typeof o=="function")return o(b);if(!s||y===0||h<=0)return o;var _=function(C){var k=C.props,N=k.style,O=N===void 0?{}:N,R=k.className,L=I.cloneElement(C,Wo(Wo({},p),{},{style:Wo(Wo({},O),b),className:R}));return L};return y===1?_(I.Children.only(o)):je.createElement("div",null,I.Children.map(o,function(E){return _(E)}))}}]),r}(I.PureComponent);M2.displayName="Animate";M2.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};M2.propTypes={from:cr.oneOfType([cr.object,cr.string]),to:cr.oneOfType([cr.object,cr.string]),attributeName:cr.string,duration:cr.number,begin:cr.number,easing:cr.oneOfType([cr.string,cr.func]),steps:cr.arrayOf(cr.shape({duration:cr.number.isRequired,style:cr.object.isRequired,easing:cr.oneOfType([cr.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),cr.func]),properties:cr.arrayOf("string"),onAnimationEnd:cr.func})),children:cr.oneOfType([cr.node,cr.func]),isActive:cr.bool,canBegin:cr.bool,onAnimationEnd:cr.func,shouldReAnimate:cr.bool,onAnimationStart:cr.func,onAnimationReStart:cr.func};const Gm=M2;function w0(e){"@babel/helpers - typeof";return w0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w0(e)}function NS(){return NS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},NS.apply(this,arguments)}function S3e(e,t){return C3e(e)||j3e(e,t)||T3e(e,t)||E3e()}function E3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T3e(e,t){if(e){if(typeof e=="string")return mF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mF(e,t)}}function mF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,h,s=[],p=!0,y=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);p=!0);}catch(b){y=!0,i=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw i}}return s}}function C3e(e){if(Array.isArray(e))return e}function gF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function yF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gF(Object(r),!0).forEach(function(n){P3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P3e(e,t,r){return t=A3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A3e(e){var t=N3e(e,"string");return w0(t)=="symbol"?t:t+""}function N3e(e,t){if(w0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(w0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vF=function(t,r,n,i,o){var h=Math.min(Math.abs(n)/2,Math.abs(i)/2),s=i>=0?1:-1,p=n>=0?1:-1,y=i>=0&&n>=0||i<0&&n<0?1:0,b;if(h>0&&o instanceof Array){for(var _=[0,0,0,0],E=0,C=4;E<C;E++)_[E]=o[E]>h?h:o[E];b="M".concat(t,",").concat(r+s*_[0]),_[0]>0&&(b+="A ".concat(_[0],",").concat(_[0],",0,0,").concat(y,",").concat(t+p*_[0],",").concat(r)),b+="L ".concat(t+n-p*_[1],",").concat(r),_[1]>0&&(b+="A ".concat(_[1],",").concat(_[1],",0,0,").concat(y,`,
        `).concat(t+n,",").concat(r+s*_[1])),b+="L ".concat(t+n,",").concat(r+i-s*_[2]),_[2]>0&&(b+="A ".concat(_[2],",").concat(_[2],",0,0,").concat(y,`,
        `).concat(t+n-p*_[2],",").concat(r+i)),b+="L ".concat(t+p*_[3],",").concat(r+i),_[3]>0&&(b+="A ".concat(_[3],",").concat(_[3],",0,0,").concat(y,`,
        `).concat(t,",").concat(r+i-s*_[3])),b+="Z"}else if(h>0&&o===+o&&o>0){var k=Math.min(h,o);b="M ".concat(t,",").concat(r+s*k,`
            A `).concat(k,",").concat(k,",0,0,").concat(y,",").concat(t+p*k,",").concat(r,`
            L `).concat(t+n-p*k,",").concat(r,`
            A `).concat(k,",").concat(k,",0,0,").concat(y,",").concat(t+n,",").concat(r+s*k,`
            L `).concat(t+n,",").concat(r+i-s*k,`
            A `).concat(k,",").concat(k,",0,0,").concat(y,",").concat(t+n-p*k,",").concat(r+i,`
            L `).concat(t+p*k,",").concat(r+i,`
            A `).concat(k,",").concat(k,",0,0,").concat(y,",").concat(t,",").concat(r+i-s*k," Z")}else b="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(i," h ").concat(-n," Z");return b},k3e=function(t,r){if(!t||!r)return!1;var n=t.x,i=t.y,o=r.x,h=r.y,s=r.width,p=r.height;if(Math.abs(s)>0&&Math.abs(p)>0){var y=Math.min(o,o+s),b=Math.max(o,o+s),_=Math.min(h,h+p),E=Math.max(h,h+p);return n>=y&&n<=b&&i>=_&&i<=E}return!1},M3e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},DO=function(t){var r=yF(yF({},M3e),t),n=I.useRef(),i=I.useState(-1),o=S3e(i,2),h=o[0],s=o[1];I.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var q=n.current.getTotalLength();q&&s(q)}catch{}},[]);var p=r.x,y=r.y,b=r.width,_=r.height,E=r.radius,C=r.className,k=r.animationEasing,N=r.animationDuration,O=r.animationBegin,R=r.isAnimationActive,L=r.isUpdateAnimationActive;if(p!==+p||y!==+y||b!==+b||_!==+_||b===0||_===0)return null;var B=Jr("recharts-rectangle",C);return L?je.createElement(Gm,{canBegin:h>0,from:{width:b,height:_,x:p,y},to:{width:b,height:_,x:p,y},duration:N,animationEasing:k,isActive:L},function(q){var F=q.width,H=q.height,Z=q.x,re=q.y;return je.createElement(Gm,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:O,duration:N,isActive:R,easing:k},je.createElement("path",NS({},Kr(r,!0),{className:B,d:vF(Z,re,F,H,E),ref:n})))}):je.createElement("path",NS({},Kr(r,!0),{className:B,d:vF(p,y,b,_,E)}))};function rk(){return rk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rk.apply(this,arguments)}var LO=function(t){var r=t.cx,n=t.cy,i=t.r,o=t.className,h=Jr("recharts-dot",o);return r===+r&&n===+n&&i===+i?je.createElement("circle",rk({},Kr(t,!1),K1(t),{className:h,cx:r,cy:n,r:i})):null};function S0(e){"@babel/helpers - typeof";return S0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S0(e)}var I3e=["x","y","top","left","width","height","className"];function nk(){return nk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nk.apply(this,arguments)}function xF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function O3e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xF(Object(r),!0).forEach(function(n){R3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function R3e(e,t,r){return t=D3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D3e(e){var t=L3e(e,"string");return S0(t)=="symbol"?t:t+""}function L3e(e,t){if(S0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(S0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B3e(e,t){if(e==null)return{};var r=z3e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function z3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var $3e=function(t,r,n,i,o,h){return"M".concat(t,",").concat(o,"v").concat(i,"M").concat(h,",").concat(r,"h").concat(n)},F3e=function(t){var r=t.x,n=r===void 0?0:r,i=t.y,o=i===void 0?0:i,h=t.top,s=h===void 0?0:h,p=t.left,y=p===void 0?0:p,b=t.width,_=b===void 0?0:b,E=t.height,C=E===void 0?0:E,k=t.className,N=B3e(t,I3e),O=O3e({x:n,y:o,top:s,left:y,width:_,height:C},N);return!qt(n)||!qt(o)||!qt(_)||!qt(C)||!qt(s)||!qt(y)?null:je.createElement("path",nk({},Kr(O,!0),{className:Jr("recharts-cross",k),d:$3e(n,o,_,C,s,y)}))},U3e=iX,V3e=U3e(Object.getPrototypeOf,Object),q3e=V3e,W3e=Qc,G3e=q3e,H3e=eu,X3e="[object Object]",K3e=Function.prototype,Z3e=Object.prototype,UK=K3e.toString,Y3e=Z3e.hasOwnProperty,J3e=UK.call(Object);function Q3e(e){if(!H3e(e)||W3e(e)!=X3e)return!1;var t=G3e(e);if(t===null)return!0;var r=Y3e.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&UK.call(r)==J3e}var e4e=Q3e;const t4e=Sn(e4e);var r4e=Qc,n4e=eu,i4e="[object Boolean]";function s4e(e){return e===!0||e===!1||n4e(e)&&r4e(e)==i4e}var a4e=s4e;const o4e=Sn(a4e);function E0(e){"@babel/helpers - typeof";return E0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E0(e)}function kS(){return kS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kS.apply(this,arguments)}function l4e(e,t){return h4e(e)||d4e(e,t)||u4e(e,t)||c4e()}function c4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function u4e(e,t){if(e){if(typeof e=="string")return bF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bF(e,t)}}function bF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,h,s=[],p=!0,y=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);p=!0);}catch(b){y=!0,i=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw i}}return s}}function h4e(e){if(Array.isArray(e))return e}function _F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_F(Object(r),!0).forEach(function(n){f4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_F(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function f4e(e,t,r){return t=p4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p4e(e){var t=m4e(e,"string");return E0(t)=="symbol"?t:t+""}function m4e(e,t){if(E0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(E0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SF=function(t,r,n,i,o){var h=n-i,s;return s="M ".concat(t,",").concat(r),s+="L ".concat(t+n,",").concat(r),s+="L ".concat(t+n-h/2,",").concat(r+o),s+="L ".concat(t+n-h/2-i,",").concat(r+o),s+="L ".concat(t,",").concat(r," Z"),s},g4e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},y4e=function(t){var r=wF(wF({},g4e),t),n=I.useRef(),i=I.useState(-1),o=l4e(i,2),h=o[0],s=o[1];I.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var B=n.current.getTotalLength();B&&s(B)}catch{}},[]);var p=r.x,y=r.y,b=r.upperWidth,_=r.lowerWidth,E=r.height,C=r.className,k=r.animationEasing,N=r.animationDuration,O=r.animationBegin,R=r.isUpdateAnimationActive;if(p!==+p||y!==+y||b!==+b||_!==+_||E!==+E||b===0&&_===0||E===0)return null;var L=Jr("recharts-trapezoid",C);return R?je.createElement(Gm,{canBegin:h>0,from:{upperWidth:0,lowerWidth:0,height:E,x:p,y},to:{upperWidth:b,lowerWidth:_,height:E,x:p,y},duration:N,animationEasing:k,isActive:R},function(B){var q=B.upperWidth,F=B.lowerWidth,H=B.height,Z=B.x,re=B.y;return je.createElement(Gm,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:O,duration:N,easing:k},je.createElement("path",kS({},Kr(r,!0),{className:L,d:SF(Z,re,q,F,H),ref:n})))}):je.createElement("g",null,je.createElement("path",kS({},Kr(r,!0),{className:L,d:SF(p,y,b,_,E)})))},v4e=["option","shapeType","propTransformer","activeClassName","isActive"];function T0(e){"@babel/helpers - typeof";return T0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T0(e)}function x4e(e,t){if(e==null)return{};var r=b4e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function b4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function EF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function MS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EF(Object(r),!0).forEach(function(n){_4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _4e(e,t,r){return t=w4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w4e(e){var t=S4e(e,"string");return T0(t)=="symbol"?t:t+""}function S4e(e,t){if(T0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(T0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function E4e(e,t){return MS(MS({},t),e)}function T4e(e,t){return e==="symbols"}function TF(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return je.createElement(DO,r);case"trapezoid":return je.createElement(y4e,r);case"sector":return je.createElement(OK,r);case"symbols":if(T4e(t))return je.createElement(tO,r);break;default:return null}}function j4e(e){return I.isValidElement(e)?e.props:e}function C4e(e){var t=e.option,r=e.shapeType,n=e.propTransformer,i=n===void 0?E4e:n,o=e.activeClassName,h=o===void 0?"recharts-active-shape":o,s=e.isActive,p=x4e(e,v4e),y;if(I.isValidElement(t))y=I.cloneElement(t,MS(MS({},p),j4e(t)));else if(Rr(t))y=t(p);else if(t4e(t)&&!o4e(t)){var b=i(t,p);y=je.createElement(TF,{shapeType:r,elementProps:b})}else{var _=p;y=je.createElement(TF,{shapeType:r,elementProps:_})}return s?je.createElement(gi,{className:h},y):y}function I2(e,t){return t!=null&&"trapezoids"in e.props}function O2(e,t){return t!=null&&"sectors"in e.props}function j0(e,t){return t!=null&&"points"in e.props}function P4e(e,t){var r,n,i=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,o=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return i&&o}function A4e(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function N4e(e,t){var r=e.x===t.x,n=e.y===t.y,i=e.z===t.z;return r&&n&&i}function k4e(e,t){var r;return I2(e,t)?r=P4e:O2(e,t)?r=A4e:j0(e,t)&&(r=N4e),r}function M4e(e,t){var r;return I2(e,t)?r="trapezoids":O2(e,t)?r="sectors":j0(e,t)&&(r="points"),r}function I4e(e,t){if(I2(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(O2(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return j0(e,t)?t.payload:{}}function O4e(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,i=M4e(r,t),o=I4e(r,t),h=n.filter(function(p,y){var b=A2(o,p),_=r.props[i].filter(function(k){var N=k4e(r,t);return N(k,t)}),E=r.props[i].indexOf(_[_.length-1]),C=y===E;return b&&C}),s=n.indexOf(h[h.length-1]);return s}var R4e=Math.ceil,D4e=Math.max;function L4e(e,t,r,n){for(var i=-1,o=D4e(R4e((t-e)/(r||1)),0),h=Array(o);o--;)h[n?o:++i]=e,e+=r;return h}var B4e=L4e,z4e=SX,jF=1/0,$4e=17976931348623157e292;function F4e(e){if(!e)return e===0?e:0;if(e=z4e(e),e===jF||e===-jF){var t=e<0?-1:1;return t*$4e}return e===e?e:0}var VK=F4e,U4e=B4e,V4e=b2,nP=VK;function q4e(e){return function(t,r,n){return n&&typeof n!="number"&&V4e(t,r,n)&&(r=n=void 0),t=nP(t),r===void 0?(r=t,t=0):r=nP(r),n=n===void 0?t<r?1:-1:nP(n),U4e(t,r,n,e)}}var W4e=q4e,G4e=W4e,H4e=G4e(),X4e=H4e;const IS=Sn(X4e);function C0(e){"@babel/helpers - typeof";return C0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C0(e)}function CF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function PF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CF(Object(r),!0).forEach(function(n){qK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qK(e,t,r){return t=K4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K4e(e){var t=Z4e(e,"string");return C0(t)=="symbol"?t:t+""}function Z4e(e,t){if(C0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(C0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y4e=["Webkit","Moz","O","ms"],J4e=function(t,r){if(!t)return null;var n=t.replace(/(\w)/,function(o){return o.toUpperCase()}),i=Y4e.reduce(function(o,h){return PF(PF({},o),{},qK({},h+n,r))},{});return i[t]=r,i};function Hm(e){"@babel/helpers - typeof";return Hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hm(e)}function OS(){return OS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OS.apply(this,arguments)}function AF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function iP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AF(Object(r),!0).forEach(function(n){Pa(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GK(n.key),n)}}function eBe(e,t,r){return t&&NF(e.prototype,t),r&&NF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tBe(e,t,r){return t=RS(t),rBe(e,WK()?Reflect.construct(t,r||[],RS(e).constructor):t.apply(e,r))}function rBe(e,t){if(t&&(Hm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nBe(e)}function nBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WK=function(){return!!e})()}function RS(e){return RS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},RS(e)}function iBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ik(e,t)}function ik(e,t){return ik=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ik(e,t)}function Pa(e,t,r){return t=GK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GK(e){var t=sBe(e,"string");return Hm(t)=="symbol"?t:t+""}function sBe(e,t){if(Hm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aBe=function(t){var r=t.data,n=t.startIndex,i=t.endIndex,o=t.x,h=t.width,s=t.travellerWidth;if(!r||!r.length)return{};var p=r.length,y=vx().domain(IS(0,p)).range([o,o+h-s]),b=y.domain().map(function(_){return y(_)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:y(n),endX:y(i),scale:y,scaleValues:b}},kF=function(t){return t.changedTouches&&!!t.changedTouches.length},Xm=function(e){function t(r){var n;return Q4e(this,t),n=tBe(this,t,[r]),Pa(n,"handleDrag",function(i){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(i):n.state.isSlideMoving&&n.handleSlideDrag(i)}),Pa(n,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&n.handleDrag(i.changedTouches[0])}),Pa(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=n.props,o=i.endIndex,h=i.onDragEnd,s=i.startIndex;h==null||h({endIndex:o,startIndex:s})}),n.detachDragEndListener()}),Pa(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Pa(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Pa(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Pa(n,"handleSlideDragStart",function(i){var o=kF(i)?i.changedTouches[0]:i;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return iBe(t,e),eBe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var i=n.startX,o=n.endX,h=this.state.scaleValues,s=this.props,p=s.gap,y=s.data,b=y.length-1,_=Math.min(i,o),E=Math.max(i,o),C=t.getIndexInRange(h,_),k=t.getIndexInRange(h,E);return{startIndex:C-C%p,endIndex:k===b?b:k-k%p}}},{key:"getTextOfTick",value:function(n){var i=this.props,o=i.data,h=i.tickFormatter,s=i.dataKey,p=Ba(o[n],s,n);return Rr(h)?h(p,n):p}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var i=this.state,o=i.slideMoveStartX,h=i.startX,s=i.endX,p=this.props,y=p.x,b=p.width,_=p.travellerWidth,E=p.startIndex,C=p.endIndex,k=p.onChange,N=n.pageX-o;N>0?N=Math.min(N,y+b-_-s,y+b-_-h):N<0&&(N=Math.max(N,y-h,y-s));var O=this.getIndex({startX:h+N,endX:s+N});(O.startIndex!==E||O.endIndex!==C)&&k&&k(O),this.setState({startX:h+N,endX:s+N,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,i){var o=kF(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:o.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var i=this.state,o=i.brushMoveStartX,h=i.movingTravellerId,s=i.endX,p=i.startX,y=this.state[h],b=this.props,_=b.x,E=b.width,C=b.travellerWidth,k=b.onChange,N=b.gap,O=b.data,R={startX:this.state.startX,endX:this.state.endX},L=n.pageX-o;L>0?L=Math.min(L,_+E-C-y):L<0&&(L=Math.max(L,_-y)),R[h]=y+L;var B=this.getIndex(R),q=B.startIndex,F=B.endIndex,H=function(){var re=O.length-1;return h==="startX"&&(s>p?q%N===0:F%N===0)||s<p&&F===re||h==="endX"&&(s>p?F%N===0:q%N===0)||s>p&&F===re};this.setState(Pa(Pa({},h,y+L),"brushMoveStartX",n.pageX),function(){k&&H()&&k(B)})}},{key:"handleTravellerMoveKeyboard",value:function(n,i){var o=this,h=this.state,s=h.scaleValues,p=h.startX,y=h.endX,b=this.state[i],_=s.indexOf(b);if(_!==-1){var E=_+n;if(!(E===-1||E>=s.length)){var C=s[E];i==="startX"&&C>=y||i==="endX"&&C<=p||this.setState(Pa({},i,C),function(){o.props.onChange(o.getIndex({startX:o.state.startX,endX:o.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,i=n.x,o=n.y,h=n.width,s=n.height,p=n.fill,y=n.stroke;return je.createElement("rect",{stroke:y,fill:p,x:i,y:o,width:h,height:s})}},{key:"renderPanorama",value:function(){var n=this.props,i=n.x,o=n.y,h=n.width,s=n.height,p=n.data,y=n.children,b=n.padding,_=I.Children.only(y);return _?je.cloneElement(_,{x:i,y:o,width:h,height:s,margin:b,compact:!0,data:p}):null}},{key:"renderTravellerLayer",value:function(n,i){var o,h,s=this,p=this.props,y=p.y,b=p.travellerWidth,_=p.height,E=p.traveller,C=p.ariaLabel,k=p.data,N=p.startIndex,O=p.endIndex,R=Math.max(n,this.props.x),L=iP(iP({},Kr(this.props,!1)),{},{x:R,y,width:b,height:_}),B=C||"Min value: ".concat((o=k[N])===null||o===void 0?void 0:o.name,", Max value: ").concat((h=k[O])===null||h===void 0?void 0:h.name);return je.createElement(gi,{tabIndex:0,role:"slider","aria-label":B,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(F){["ArrowLeft","ArrowRight"].includes(F.key)&&(F.preventDefault(),F.stopPropagation(),s.handleTravellerMoveKeyboard(F.key==="ArrowRight"?1:-1,i))},onFocus:function(){s.setState({isTravellerFocused:!0})},onBlur:function(){s.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(E,L))}},{key:"renderSlide",value:function(n,i){var o=this.props,h=o.y,s=o.height,p=o.stroke,y=o.travellerWidth,b=Math.min(n,i)+y,_=Math.max(Math.abs(i-n)-y,0);return je.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:p,fillOpacity:.2,x:b,y:h,width:_,height:s})}},{key:"renderText",value:function(){var n=this.props,i=n.startIndex,o=n.endIndex,h=n.y,s=n.height,p=n.travellerWidth,y=n.stroke,b=this.state,_=b.startX,E=b.endX,C=5,k={pointerEvents:"none",fill:y};return je.createElement(gi,{className:"recharts-brush-texts"},je.createElement(uS,OS({textAnchor:"end",verticalAnchor:"middle",x:Math.min(_,E)-C,y:h+s/2},k),this.getTextOfTick(i)),je.createElement(uS,OS({textAnchor:"start",verticalAnchor:"middle",x:Math.max(_,E)+p+C,y:h+s/2},k),this.getTextOfTick(o)))}},{key:"render",value:function(){var n=this.props,i=n.data,o=n.className,h=n.children,s=n.x,p=n.y,y=n.width,b=n.height,_=n.alwaysShowText,E=this.state,C=E.startX,k=E.endX,N=E.isTextActive,O=E.isSlideMoving,R=E.isTravellerMoving,L=E.isTravellerFocused;if(!i||!i.length||!qt(s)||!qt(p)||!qt(y)||!qt(b)||y<=0||b<=0)return null;var B=Jr("recharts-brush",o),q=je.Children.count(h)===1,F=J4e("userSelect","none");return je.createElement(gi,{className:B,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:F},this.renderBackground(),q&&this.renderPanorama(),this.renderSlide(C,k),this.renderTravellerLayer(C,"startX"),this.renderTravellerLayer(k,"endX"),(N||O||R||L||_)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var i=n.x,o=n.y,h=n.width,s=n.height,p=n.stroke,y=Math.floor(o+s/2)-1;return je.createElement(je.Fragment,null,je.createElement("rect",{x:i,y:o,width:h,height:s,fill:p,stroke:"none"}),je.createElement("line",{x1:i+1,y1:y,x2:i+h-1,y2:y,fill:"none",stroke:"#fff"}),je.createElement("line",{x1:i+1,y1:y+2,x2:i+h-1,y2:y+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,i){var o;return je.isValidElement(n)?o=je.cloneElement(n,i):Rr(n)?o=n(i):o=t.renderDefaultTraveller(i),o}},{key:"getDerivedStateFromProps",value:function(n,i){var o=n.data,h=n.width,s=n.x,p=n.travellerWidth,y=n.updateId,b=n.startIndex,_=n.endIndex;if(o!==i.prevData||y!==i.prevUpdateId)return iP({prevData:o,prevTravellerWidth:p,prevUpdateId:y,prevX:s,prevWidth:h},o&&o.length?aBe({data:o,width:h,x:s,travellerWidth:p,startIndex:b,endIndex:_}):{scale:null,scaleValues:null});if(i.scale&&(h!==i.prevWidth||s!==i.prevX||p!==i.prevTravellerWidth)){i.scale.range([s,s+h-p]);var E=i.scale.domain().map(function(C){return i.scale(C)});return{prevData:o,prevTravellerWidth:p,prevUpdateId:y,prevX:s,prevWidth:h,startX:i.scale(n.startIndex),endX:i.scale(n.endIndex),scaleValues:E}}return null}},{key:"getIndexInRange",value:function(n,i){for(var o=n.length,h=0,s=o-1;s-h>1;){var p=Math.floor((h+s)/2);n[p]>i?s=p:h=p}return i>=n[s]?s:h}}])}(I.PureComponent);Pa(Xm,"displayName","Brush");Pa(Xm,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var oBe=lO;function lBe(e,t){var r;return oBe(e,function(n,i,o){return r=t(n,i,o),!r}),!!r}var cBe=lBe,uBe=ZH,dBe=Id,hBe=cBe,fBe=va,pBe=b2;function mBe(e,t,r){var n=fBe(e)?uBe:hBe;return r&&pBe(e,t,r)&&(t=void 0),n(e,dBe(t))}var gBe=mBe;const yBe=Sn(gBe);var Vl=function(t,r){var n=t.alwaysShow,i=t.ifOverflow;return n&&(i="extendDomain"),i===r},MF=vX;function vBe(e,t,r){t=="__proto__"&&MF?MF(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var xBe=vBe,bBe=xBe,_Be=gX,wBe=Id;function SBe(e,t){var r={};return t=wBe(t),_Be(e,function(n,i,o){bBe(r,i,t(n,i,o))}),r}var EBe=SBe;const TBe=Sn(EBe);function jBe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var CBe=jBe,PBe=lO;function ABe(e,t){var r=!0;return PBe(e,function(n,i,o){return r=!!t(n,i,o),r}),r}var NBe=ABe,kBe=CBe,MBe=NBe,IBe=Id,OBe=va,RBe=b2;function DBe(e,t,r){var n=OBe(e)?kBe:MBe;return r&&RBe(e,t,r)&&(t=void 0),n(e,IBe(t))}var LBe=DBe;const HK=Sn(LBe);var BBe=["x","y"];function P0(e){"@babel/helpers - typeof";return P0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P0(e)}function sk(){return sk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sk.apply(this,arguments)}function IF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Fv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IF(Object(r),!0).forEach(function(n){zBe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zBe(e,t,r){return t=$Be(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Be(e){var t=FBe(e,"string");return P0(t)=="symbol"?t:t+""}function FBe(e,t){if(P0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(P0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UBe(e,t){if(e==null)return{};var r=VBe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function VBe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function qBe(e,t){var r=e.x,n=e.y,i=UBe(e,BBe),o="".concat(r),h=parseInt(o,10),s="".concat(n),p=parseInt(s,10),y="".concat(t.height||i.height),b=parseInt(y,10),_="".concat(t.width||i.width),E=parseInt(_,10);return Fv(Fv(Fv(Fv(Fv({},t),i),h?{x:h}:{}),p?{y:p}:{}),{},{height:b,width:E,name:t.name,radius:t.radius})}function OF(e){return je.createElement(C4e,sk({shapeType:"rectangle",propTransformer:qBe,activeClassName:"recharts-active-bar"},e))}var WBe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,i){if(typeof t=="number")return t;var o=typeof n=="number";return o?t(n,i):(o||pf(!1),r)}},GBe=["value","background"],XK;function Km(e){"@babel/helpers - typeof";return Km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Km(e)}function HBe(e,t){if(e==null)return{};var r=XBe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function XBe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function DS(){return DS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},DS.apply(this,arguments)}function RF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ji(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RF(Object(r),!0).forEach(function(n){ed(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZK(n.key),n)}}function ZBe(e,t,r){return t&&DF(e.prototype,t),r&&DF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YBe(e,t,r){return t=LS(t),JBe(e,KK()?Reflect.construct(t,r||[],LS(e).constructor):t.apply(e,r))}function JBe(e,t){if(t&&(Km(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QBe(e)}function QBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KK=function(){return!!e})()}function LS(e){return LS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},LS(e)}function eze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ak(e,t)}function ak(e,t){return ak=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ak(e,t)}function ed(e,t,r){return t=ZK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZK(e){var t=tze(e,"string");return Km(t)=="symbol"?t:t+""}function tze(e,t){if(Km(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Km(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ob=function(e){function t(){var r;KBe(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=YBe(this,t,[].concat(i)),ed(r,"state",{isAnimationFinished:!1}),ed(r,"id",eb("recharts-bar-")),ed(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),h&&h()}),ed(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),h&&h()}),r}return eze(t,e),ZBe(t,[{key:"renderRectanglesStatically",value:function(n){var i=this,o=this.props,h=o.shape,s=o.dataKey,p=o.activeIndex,y=o.activeBar,b=Kr(this.props,!1);return n&&n.map(function(_,E){var C=E===p,k=C?y:h,N=ji(ji(ji({},b),_),{},{isActive:C,option:k,index:E,dataKey:s,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return je.createElement(gi,DS({className:"recharts-bar-rectangle"},Z1(i.props,_,E),{key:"rectangle-".concat(_==null?void 0:_.x,"-").concat(_==null?void 0:_.y,"-").concat(_==null?void 0:_.value,"-").concat(E)}),je.createElement(OF,N))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,i=this.props,o=i.data,h=i.layout,s=i.isAnimationActive,p=i.animationBegin,y=i.animationDuration,b=i.animationEasing,_=i.animationId,E=this.state.prevData;return je.createElement(Gm,{begin:p,duration:y,isActive:s,easing:b,from:{t:0},to:{t:1},key:"bar-".concat(_),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(C){var k=C.t,N=o.map(function(O,R){var L=E&&E[R];if(L){var B=tl(L.x,O.x),q=tl(L.y,O.y),F=tl(L.width,O.width),H=tl(L.height,O.height);return ji(ji({},O),{},{x:B(k),y:q(k),width:F(k),height:H(k)})}if(h==="horizontal"){var Z=tl(0,O.height),re=Z(k);return ji(ji({},O),{},{y:O.y+O.height-re,height:re})}var W=tl(0,O.width),te=W(k);return ji(ji({},O),{},{width:te})});return je.createElement(gi,null,n.renderRectanglesStatically(N))})}},{key:"renderRectangles",value:function(){var n=this.props,i=n.data,o=n.isAnimationActive,h=this.state.prevData;return o&&i&&i.length&&(!h||!A2(h,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var n=this,i=this.props,o=i.data,h=i.dataKey,s=i.activeIndex,p=Kr(this.props.background,!1);return o.map(function(y,b){y.value;var _=y.background,E=HBe(y,GBe);if(!_)return null;var C=ji(ji(ji(ji(ji({},E),{},{fill:"#eee"},_),p),Z1(n.props,y,b)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:h,index:b,className:"recharts-bar-background-rectangle"});return je.createElement(OF,DS({key:"background-bar-".concat(b),option:n.props.background,isActive:b===s},C))})}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,h=o.data,s=o.xAxis,p=o.yAxis,y=o.layout,b=o.children,_=mo(b,ab);if(!_)return null;var E=y==="vertical"?h[0].height/2:h[0].width/2,C=function(O,R){var L=Array.isArray(O.value)?O.value[1]:O.value;return{x:O.x,y:O.y,value:L,errorVal:Ba(O,R)}},k={clipPath:n?"url(#clipPath-".concat(i,")"):null};return je.createElement(gi,k,_.map(function(N){return je.cloneElement(N,{key:"error-bar-".concat(i,"-").concat(N.props.dataKey),data:h,xAxis:s,yAxis:p,layout:y,offset:E,dataPointFormatter:C})}))}},{key:"render",value:function(){var n=this.props,i=n.hide,o=n.data,h=n.className,s=n.xAxis,p=n.yAxis,y=n.left,b=n.top,_=n.width,E=n.height,C=n.isAnimationActive,k=n.background,N=n.id;if(i||!o||!o.length)return null;var O=this.state.isAnimationFinished,R=Jr("recharts-bar",h),L=s&&s.allowDataOverflow,B=p&&p.allowDataOverflow,q=L||B,F=Hr(N)?this.id:N;return je.createElement(gi,{className:R},L||B?je.createElement("defs",null,je.createElement("clipPath",{id:"clipPath-".concat(F)},je.createElement("rect",{x:L?y:y-_/2,y:B?b:b-E/2,width:L?_:_*2,height:B?E:E*2}))):null,je.createElement(gi,{className:"recharts-bar-rectangles",clipPath:q?"url(#clipPath-".concat(F,")"):null},k?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(q,F),(!C||O)&&fd.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:i.curData}:n.data!==i.curData?{curData:n.data}:null}}])}(I.PureComponent);XK=ob;ed(ob,"displayName","Bar");ed(ob,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Ic.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});ed(ob,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,i=e.bandSize,o=e.xAxis,h=e.yAxis,s=e.xAxisTicks,p=e.yAxisTicks,y=e.stackedData,b=e.dataStartIndex,_=e.displayedData,E=e.offset,C=LRe(n,r);if(!C)return null;var k=t.layout,N=r.type.defaultProps,O=N!==void 0?ji(ji({},N),r.props):r.props,R=O.dataKey,L=O.children,B=O.minPointSize,q=k==="horizontal"?h:o,F=y?q.scale.domain():null,H=WRe({numericAxis:q}),Z=mo(L,TX),re=_.map(function(W,te){var oe,ie,ue,_e,xe,be;y?oe=BRe(y[b+te],F):(oe=Ba(W,R),Array.isArray(oe)||(oe=[H,oe]));var Ae=WBe(B,XK.defaultProps.minPointSize)(oe[1],te);if(k==="horizontal"){var me,ke=[h.scale(oe[0]),h.scale(oe[1])],Ne=ke[0],Be=ke[1];ie=O$({axis:o,ticks:s,bandSize:i,offset:C.offset,entry:W,index:te}),ue=(me=Be??Ne)!==null&&me!==void 0?me:void 0,_e=C.size;var We=Ne-Be;if(xe=Number.isNaN(We)?0:We,be={x:ie,y:h.y,width:_e,height:h.height},Math.abs(Ae)>0&&Math.abs(xe)<Math.abs(Ae)){var ut=al(xe||Ae)*(Math.abs(Ae)-Math.abs(xe));ue-=ut,xe+=ut}}else{var nt=[o.scale(oe[0]),o.scale(oe[1])],Pt=nt[0],It=nt[1];if(ie=Pt,ue=O$({axis:h,ticks:p,bandSize:i,offset:C.offset,entry:W,index:te}),_e=It-Pt,xe=C.size,be={x:o.x,y:ue,width:o.width,height:xe},Math.abs(Ae)>0&&Math.abs(_e)<Math.abs(Ae)){var at=al(_e||Ae)*(Math.abs(Ae)-Math.abs(_e));_e+=at}}return ji(ji(ji({},W),{},{x:ie,y:ue,width:_e,height:xe,value:y?oe:oe[1],payload:W,background:be},Z&&Z[te]&&Z[te].props),{},{tooltipPayload:[kK(r,W)],tooltipPosition:{x:ie+_e/2,y:ue+xe/2}})});return ji({data:re,layout:k},E)});function A0(e){"@babel/helpers - typeof";return A0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A0(e)}function rze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YK(n.key),n)}}function nze(e,t,r){return t&&LF(e.prototype,t),r&&LF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Yo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BF(Object(r),!0).forEach(function(n){R2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function R2(e,t,r){return t=YK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YK(e){var t=ize(e,"string");return A0(t)=="symbol"?t:t+""}function ize(e,t){if(A0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(A0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sze=function(t,r,n,i,o){var h=t.width,s=t.height,p=t.layout,y=t.children,b=Object.keys(r),_={left:n.left,leftMirror:n.left,right:h-n.right,rightMirror:h-n.right,top:n.top,topMirror:n.top,bottom:s-n.bottom,bottomMirror:s-n.bottom},E=!!Na(y,ob);return b.reduce(function(C,k){var N=r[k],O=N.orientation,R=N.domain,L=N.padding,B=L===void 0?{}:L,q=N.mirror,F=N.reversed,H="".concat(O).concat(q?"Mirror":""),Z,re,W,te,oe;if(N.type==="number"&&(N.padding==="gap"||N.padding==="no-gap")){var ie=R[1]-R[0],ue=1/0,_e=N.categoricalDomain.sort(xwe);if(_e.forEach(function(nt,Pt){Pt>0&&(ue=Math.min((nt||0)-(_e[Pt-1]||0),ue))}),Number.isFinite(ue)){var xe=ue/ie,be=N.layout==="vertical"?n.height:n.width;if(N.padding==="gap"&&(Z=xe*be/2),N.padding==="no-gap"){var Ae=hf(t.barCategoryGap,xe*be),me=xe*be/2;Z=me-Ae-(me-Ae)/be*Ae}}}i==="xAxis"?re=[n.left+(B.left||0)+(Z||0),n.left+n.width-(B.right||0)-(Z||0)]:i==="yAxis"?re=p==="horizontal"?[n.top+n.height-(B.bottom||0),n.top+(B.top||0)]:[n.top+(B.top||0)+(Z||0),n.top+n.height-(B.bottom||0)-(Z||0)]:re=N.range,F&&(re=[re[1],re[0]]);var ke=RRe(N,o,E),Ne=ke.scale,Be=ke.realScaleType;Ne.domain(R).range(re),DRe(Ne);var We=qRe(Ne,Yo(Yo({},N),{},{realScaleType:Be}));i==="xAxis"?(oe=O==="top"&&!q||O==="bottom"&&q,W=n.left,te=_[H]-oe*N.height):i==="yAxis"&&(oe=O==="left"&&!q||O==="right"&&q,W=_[H]-oe*N.width,te=n.top);var ut=Yo(Yo(Yo({},N),We),{},{realScaleType:Be,x:W,y:te,scale:Ne,width:i==="xAxis"?n.width:N.width,height:i==="yAxis"?n.height:N.height});return ut.bandSize=ES(ut,We),!N.hide&&i==="xAxis"?_[H]+=(oe?-1:1)*ut.height:N.hide||(_[H]+=(oe?-1:1)*ut.width),Yo(Yo({},C),{},R2({},k,ut))},{})},JK=function(t,r){var n=t.x,i=t.y,o=r.x,h=r.y;return{x:Math.min(n,o),y:Math.min(i,h),width:Math.abs(o-n),height:Math.abs(h-i)}},aze=function(t){var r=t.x1,n=t.y1,i=t.x2,o=t.y2;return JK({x:r,y:n},{x:i,y:o})},QK=function(){function e(t){rze(this,e),this.scale=t}return nze(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.bandAware,o=n.position;if(r!==void 0){if(o)switch(o){case"start":return this.scale(r);case"middle":{var h=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+h}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(r)+s}default:return this.scale(r)}if(i){var p=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+p}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),i=n[0],o=n[n.length-1];return i<=o?r>=i&&r<=o:r>=o&&r<=i}}],[{key:"create",value:function(r){return new e(r)}}])}();R2(QK,"EPS",1e-4);var BO=function(t){var r=Object.keys(t).reduce(function(n,i){return Yo(Yo({},n),{},R2({},i,QK.create(t[i])))},{});return Yo(Yo({},r),{},{apply:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=o.bandAware,s=o.position;return TBe(i,function(p,y){return r[y].apply(p,{bandAware:h,position:s})})},isInRange:function(i){return HK(i,function(o,h){return r[h].isInRange(o)})}})};function oze(e){return(e%180+180)%180}var lze=function(t){var r=t.width,n=t.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=oze(i),h=o*Math.PI/180,s=Math.atan(n/r),p=h>s&&h<Math.PI-s?n/Math.sin(h):r/Math.cos(h);return Math.abs(p)},cze=Id,uze=tb,dze=v2;function hze(e){return function(t,r,n){var i=Object(t);if(!uze(t)){var o=cze(r);t=dze(t),r=function(s){return o(i[s],s,i)}}var h=e(t,r,n);return h>-1?i[o?t[h]:h]:void 0}}var fze=hze,pze=VK;function mze(e){var t=pze(e),r=t%1;return t===t?r?t-r:t:0}var gze=mze,yze=uX,vze=Id,xze=gze,bze=Math.max;function _ze(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var i=r==null?0:xze(r);return i<0&&(i=bze(n+i,0)),yze(e,vze(t),i)}var wze=_ze,Sze=fze,Eze=wze,Tze=Sze(Eze),jze=Tze;const Cze=Sn(jze);var Pze=__e(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),zO=I.createContext(void 0),$O=I.createContext(void 0),eZ=I.createContext(void 0),tZ=I.createContext({}),rZ=I.createContext(void 0),nZ=I.createContext(0),iZ=I.createContext(0),zF=function(t){var r=t.state,n=r.xAxisMap,i=r.yAxisMap,o=r.offset,h=t.clipPathId,s=t.children,p=t.width,y=t.height,b=Pze(o);return je.createElement(zO.Provider,{value:n},je.createElement($O.Provider,{value:i},je.createElement(tZ.Provider,{value:o},je.createElement(eZ.Provider,{value:b},je.createElement(rZ.Provider,{value:h},je.createElement(nZ.Provider,{value:y},je.createElement(iZ.Provider,{value:p},s)))))))},Aze=function(){return I.useContext(rZ)},sZ=function(t){var r=I.useContext(zO);r==null&&pf(!1);var n=r[t];return n==null&&pf(!1),n},Nze=function(){var t=I.useContext(zO);return Zu(t)},kze=function(){var t=I.useContext($O),r=Cze(t,function(n){return HK(n.domain,Number.isFinite)});return r||Zu(t)},aZ=function(t){var r=I.useContext($O);r==null&&pf(!1);var n=r[t];return n==null&&pf(!1),n},Mze=function(){var t=I.useContext(eZ);return t},Ize=function(){return I.useContext(tZ)},FO=function(){return I.useContext(iZ)},UO=function(){return I.useContext(nZ)};function Zm(e){"@babel/helpers - typeof";return Zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zm(e)}function Oze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lZ(n.key),n)}}function Rze(e,t,r){return t&&$F(e.prototype,t),r&&$F(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dze(e,t,r){return t=BS(t),Lze(e,oZ()?Reflect.construct(t,r||[],BS(e).constructor):t.apply(e,r))}function Lze(e,t){if(t&&(Zm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bze(e)}function Bze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oZ=function(){return!!e})()}function BS(e){return BS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},BS(e)}function zze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ok(e,t)}function ok(e,t){return ok=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ok(e,t)}function FF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function UF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FF(Object(r),!0).forEach(function(n){VO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VO(e,t,r){return t=lZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lZ(e){var t=$ze(e,"string");return Zm(t)=="symbol"?t:t+""}function $ze(e,t){if(Zm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fze(e,t){return Wze(e)||qze(e,t)||Vze(e,t)||Uze()}function Uze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vze(e,t){if(e){if(typeof e=="string")return VF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VF(e,t)}}function VF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qze(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,h,s=[],p=!0,y=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);p=!0);}catch(b){y=!0,i=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw i}}return s}}function Wze(e){if(Array.isArray(e))return e}function lk(){return lk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lk.apply(this,arguments)}var Gze=function(t,r){var n;return je.isValidElement(t)?n=je.cloneElement(t,r):Rr(t)?n=t(r):n=je.createElement("line",lk({},r,{className:"recharts-reference-line-line"})),n},Hze=function(t,r,n,i,o,h,s,p,y){var b=o.x,_=o.y,E=o.width,C=o.height;if(n){var k=y.y,N=t.y.apply(k,{position:h});if(Vl(y,"discard")&&!t.y.isInRange(N))return null;var O=[{x:b+E,y:N},{x:b,y:N}];return p==="left"?O.reverse():O}if(r){var R=y.x,L=t.x.apply(R,{position:h});if(Vl(y,"discard")&&!t.x.isInRange(L))return null;var B=[{x:L,y:_+C},{x:L,y:_}];return s==="top"?B.reverse():B}if(i){var q=y.segment,F=q.map(function(H){return t.apply(H,{position:h})});return Vl(y,"discard")&&yBe(F,function(H){return!t.isInRange(H)})?null:F}return null};function Xze(e){var t=e.x,r=e.y,n=e.segment,i=e.xAxisId,o=e.yAxisId,h=e.shape,s=e.className,p=e.alwaysShow,y=Aze(),b=sZ(i),_=aZ(o),E=Mze();if(!y||!E)return null;Mc(p===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var C=BO({x:b.scale,y:_.scale}),k=Fi(t),N=Fi(r),O=n&&n.length===2,R=Hze(C,k,N,O,E,e.position,b.orientation,_.orientation,e);if(!R)return null;var L=Fze(R,2),B=L[0],q=B.x,F=B.y,H=L[1],Z=H.x,re=H.y,W=Vl(e,"hidden")?"url(#".concat(y,")"):void 0,te=UF(UF({clipPath:W},Kr(e,!0)),{},{x1:q,y1:F,x2:Z,y2:re});return je.createElement(gi,{className:Jr("recharts-reference-line",s)},Gze(h,te),As.renderCallByParent(e,aze({x1:q,y1:F,x2:Z,y2:re})))}var qO=function(e){function t(){return Oze(this,t),Dze(this,t,arguments)}return zze(t,e),Rze(t,[{key:"render",value:function(){return je.createElement(Xze,this.props)}}])}(je.Component);VO(qO,"displayName","ReferenceLine");VO(qO,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function ck(){return ck=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ck.apply(this,arguments)}function Ym(e){"@babel/helpers - typeof";return Ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ym(e)}function qF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function WF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qF(Object(r),!0).forEach(function(n){D2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uZ(n.key),n)}}function Zze(e,t,r){return t&&GF(e.prototype,t),r&&GF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yze(e,t,r){return t=zS(t),Jze(e,cZ()?Reflect.construct(t,r||[],zS(e).constructor):t.apply(e,r))}function Jze(e,t){if(t&&(Ym(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qze(e)}function Qze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cZ=function(){return!!e})()}function zS(e){return zS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zS(e)}function e5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uk(e,t)}function uk(e,t){return uk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uk(e,t)}function D2(e,t,r){return t=uZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uZ(e){var t=t5e(e,"string");return Ym(t)=="symbol"?t:t+""}function t5e(e,t){if(Ym(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ym(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var r5e=function(t){var r=t.x,n=t.y,i=t.xAxis,o=t.yAxis,h=BO({x:i.scale,y:o.scale}),s=h.apply({x:r,y:n},{bandAware:!0});return Vl(t,"discard")&&!h.isInRange(s)?null:s},L2=function(e){function t(){return Kze(this,t),Yze(this,t,arguments)}return e5e(t,e),Zze(t,[{key:"render",value:function(){var n=this.props,i=n.x,o=n.y,h=n.r,s=n.alwaysShow,p=n.clipPathId,y=Fi(i),b=Fi(o);if(Mc(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!y||!b)return null;var _=r5e(this.props);if(!_)return null;var E=_.x,C=_.y,k=this.props,N=k.shape,O=k.className,R=Vl(this.props,"hidden")?"url(#".concat(p,")"):void 0,L=WF(WF({clipPath:R},Kr(this.props,!0)),{},{cx:E,cy:C});return je.createElement(gi,{className:Jr("recharts-reference-dot",O)},t.renderDot(N,L),As.renderCallByParent(this.props,{x:E-h,y:C-h,width:2*h,height:2*h}))}}])}(je.Component);D2(L2,"displayName","ReferenceDot");D2(L2,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});D2(L2,"renderDot",function(e,t){var r;return je.isValidElement(e)?r=je.cloneElement(e,t):Rr(e)?r=e(t):r=je.createElement(LO,ck({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function dk(){return dk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dk.apply(this,arguments)}function Jm(e){"@babel/helpers - typeof";return Jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jm(e)}function HF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function XF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HF(Object(r),!0).forEach(function(n){B2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hZ(n.key),n)}}function i5e(e,t,r){return t&&KF(e.prototype,t),r&&KF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s5e(e,t,r){return t=$S(t),a5e(e,dZ()?Reflect.construct(t,r||[],$S(e).constructor):t.apply(e,r))}function a5e(e,t){if(t&&(Jm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o5e(e)}function o5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dZ=function(){return!!e})()}function $S(e){return $S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$S(e)}function l5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hk(e,t)}function hk(e,t){return hk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hk(e,t)}function B2(e,t,r){return t=hZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hZ(e){var t=c5e(e,"string");return Jm(t)=="symbol"?t:t+""}function c5e(e,t){if(Jm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u5e=function(t,r,n,i,o){var h=o.x1,s=o.x2,p=o.y1,y=o.y2,b=o.xAxis,_=o.yAxis;if(!b||!_)return null;var E=BO({x:b.scale,y:_.scale}),C={x:t?E.x.apply(h,{position:"start"}):E.x.rangeMin,y:n?E.y.apply(p,{position:"start"}):E.y.rangeMin},k={x:r?E.x.apply(s,{position:"end"}):E.x.rangeMax,y:i?E.y.apply(y,{position:"end"}):E.y.rangeMax};return Vl(o,"discard")&&(!E.isInRange(C)||!E.isInRange(k))?null:JK(C,k)},z2=function(e){function t(){return n5e(this,t),s5e(this,t,arguments)}return l5e(t,e),i5e(t,[{key:"render",value:function(){var n=this.props,i=n.x1,o=n.x2,h=n.y1,s=n.y2,p=n.className,y=n.alwaysShow,b=n.clipPathId;Mc(y===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var _=Fi(i),E=Fi(o),C=Fi(h),k=Fi(s),N=this.props.shape;if(!_&&!E&&!C&&!k&&!N)return null;var O=u5e(_,E,C,k,this.props);if(!O&&!N)return null;var R=Vl(this.props,"hidden")?"url(#".concat(b,")"):void 0;return je.createElement(gi,{className:Jr("recharts-reference-area",p)},t.renderRect(N,XF(XF({clipPath:R},Kr(this.props,!0)),O)),As.renderCallByParent(this.props,O))}}])}(je.Component);B2(z2,"displayName","ReferenceArea");B2(z2,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});B2(z2,"renderRect",function(e,t){var r;return je.isValidElement(e)?r=je.cloneElement(e,t):Rr(e)?r=e(t):r=je.createElement(DO,dk({},t,{className:"recharts-reference-area-rect"})),r});function fZ(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],i=0;i<e.length;i+=t)if(r===void 0||r(e[i])===!0)n.push(e[i]);else return;return n}function d5e(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return lze(n,r)}function h5e(e,t,r){var n=r==="width",i=e.x,o=e.y,h=e.width,s=e.height;return t===1?{start:n?i:o,end:n?i+h:o+s}:{start:n?i+h:o+s,end:n?i:o}}function FS(e,t,r,n,i){if(e*t<e*n||e*t>e*i)return!1;var o=r();return e*(t-e*o/2-n)>=0&&e*(t+e*o/2-i)<=0}function f5e(e,t){return fZ(e,t+1)}function p5e(e,t,r,n,i){for(var o=(n||[]).slice(),h=t.start,s=t.end,p=0,y=1,b=h,_=function(){var k=n==null?void 0:n[p];if(k===void 0)return{v:fZ(n,y)};var N=p,O,R=function(){return O===void 0&&(O=r(k,N)),O},L=k.coordinate,B=p===0||FS(e,L,R,b,s);B||(p=0,b=h,y+=1),B&&(b=L+e*(R()/2+i),p+=y)},E;y<=o.length;)if(E=_(),E)return E.v;return[]}function N0(e){"@babel/helpers - typeof";return N0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N0(e)}function ZF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Cs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZF(Object(r),!0).forEach(function(n){m5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m5e(e,t,r){return t=g5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g5e(e){var t=y5e(e,"string");return N0(t)=="symbol"?t:t+""}function y5e(e,t){if(N0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(N0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function v5e(e,t,r,n,i){for(var o=(n||[]).slice(),h=o.length,s=t.start,p=t.end,y=function(E){var C=o[E],k,N=function(){return k===void 0&&(k=r(C,E)),k};if(E===h-1){var O=e*(C.coordinate+e*N()/2-p);o[E]=C=Cs(Cs({},C),{},{tickCoord:O>0?C.coordinate-O*e:C.coordinate})}else o[E]=C=Cs(Cs({},C),{},{tickCoord:C.coordinate});var R=FS(e,C.tickCoord,N,s,p);R&&(p=C.tickCoord-e*(N()/2+i),o[E]=Cs(Cs({},C),{},{isShow:!0}))},b=h-1;b>=0;b--)y(b);return o}function x5e(e,t,r,n,i,o){var h=(n||[]).slice(),s=h.length,p=t.start,y=t.end;if(o){var b=n[s-1],_=r(b,s-1),E=e*(b.coordinate+e*_/2-y);h[s-1]=b=Cs(Cs({},b),{},{tickCoord:E>0?b.coordinate-E*e:b.coordinate});var C=FS(e,b.tickCoord,function(){return _},p,y);C&&(y=b.tickCoord-e*(_/2+i),h[s-1]=Cs(Cs({},b),{},{isShow:!0}))}for(var k=o?s-1:s,N=function(L){var B=h[L],q,F=function(){return q===void 0&&(q=r(B,L)),q};if(L===0){var H=e*(B.coordinate-e*F()/2-p);h[L]=B=Cs(Cs({},B),{},{tickCoord:H<0?B.coordinate-H*e:B.coordinate})}else h[L]=B=Cs(Cs({},B),{},{tickCoord:B.coordinate});var Z=FS(e,B.tickCoord,F,p,y);Z&&(p=B.tickCoord+e*(F()/2+i),h[L]=Cs(Cs({},B),{},{isShow:!0}))},O=0;O<k;O++)N(O);return h}function WO(e,t,r){var n=e.tick,i=e.ticks,o=e.viewBox,h=e.minTickGap,s=e.orientation,p=e.interval,y=e.tickFormatter,b=e.unit,_=e.angle;if(!i||!i.length||!n)return[];if(qt(p)||Ic.isSsr)return f5e(i,typeof p=="number"&&qt(p)?p:0);var E=[],C=s==="top"||s==="bottom"?"width":"height",k=b&&C==="width"?yx(b,{fontSize:t,letterSpacing:r}):{width:0,height:0},N=function(B,q){var F=Rr(y)?y(B.value,q):B.value;return C==="width"?d5e(yx(F,{fontSize:t,letterSpacing:r}),k,_):yx(F,{fontSize:t,letterSpacing:r})[C]},O=i.length>=2?al(i[1].coordinate-i[0].coordinate):1,R=h5e(o,O,C);return p==="equidistantPreserveStart"?p5e(O,R,N,i,h):(p==="preserveStart"||p==="preserveStartEnd"?E=x5e(O,R,N,i,h,p==="preserveStartEnd"):E=v5e(O,R,N,i,h),E.filter(function(L){return L.isShow}))}var b5e=["viewBox"],_5e=["viewBox"],w5e=["ticks"];function Qm(e){"@babel/helpers - typeof";return Qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qm(e)}function om(){return om=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},om.apply(this,arguments)}function YF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Bs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YF(Object(r),!0).forEach(function(n){GO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sP(e,t){if(e==null)return{};var r=S5e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function S5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function E5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mZ(n.key),n)}}function T5e(e,t,r){return t&&JF(e.prototype,t),r&&JF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j5e(e,t,r){return t=US(t),C5e(e,pZ()?Reflect.construct(t,r||[],US(e).constructor):t.apply(e,r))}function C5e(e,t){if(t&&(Qm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P5e(e)}function P5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pZ=function(){return!!e})()}function US(e){return US=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},US(e)}function A5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fk(e,t)}function fk(e,t){return fk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fk(e,t)}function GO(e,t,r){return t=mZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mZ(e){var t=N5e(e,"string");return Qm(t)=="symbol"?t:t+""}function N5e(e,t){if(Qm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dg=function(e){function t(r){var n;return E5e(this,t),n=j5e(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return A5e(t,e),T5e(t,[{key:"shouldComponentUpdate",value:function(n,i){var o=n.viewBox,h=sP(n,b5e),s=this.props,p=s.viewBox,y=sP(s,_5e);return!ym(o,p)||!ym(h,y)||!ym(i,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var i=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var i=this.props,o=i.x,h=i.y,s=i.width,p=i.height,y=i.orientation,b=i.tickSize,_=i.mirror,E=i.tickMargin,C,k,N,O,R,L,B=_?-1:1,q=n.tickSize||b,F=qt(n.tickCoord)?n.tickCoord:n.coordinate;switch(y){case"top":C=k=n.coordinate,O=h+ +!_*p,N=O-B*q,L=N-B*E,R=F;break;case"left":N=O=n.coordinate,k=o+ +!_*s,C=k-B*q,R=C-B*E,L=F;break;case"right":N=O=n.coordinate,k=o+ +_*s,C=k+B*q,R=C+B*E,L=F;break;default:C=k=n.coordinate,O=h+ +_*p,N=O+B*q,L=N+B*E,R=F;break}return{line:{x1:C,y1:N,x2:k,y2:O},tick:{x:R,y:L}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,i=n.orientation,o=n.mirror,h;switch(i){case"left":h=o?"start":"end";break;case"right":h=o?"end":"start";break;default:h="middle";break}return h}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,i=n.orientation,o=n.mirror,h="end";switch(i){case"left":case"right":h="middle";break;case"top":h=o?"start":"end";break;default:h=o?"end":"start";break}return h}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.x,o=n.y,h=n.width,s=n.height,p=n.orientation,y=n.mirror,b=n.axisLine,_=Bs(Bs(Bs({},Kr(this.props,!1)),Kr(b,!1)),{},{fill:"none"});if(p==="top"||p==="bottom"){var E=+(p==="top"&&!y||p==="bottom"&&y);_=Bs(Bs({},_),{},{x1:i,y1:o+E*s,x2:i+h,y2:o+E*s})}else{var C=+(p==="left"&&!y||p==="right"&&y);_=Bs(Bs({},_),{},{x1:i+C*h,y1:o,x2:i+C*h,y2:o+s})}return je.createElement("line",om({},_,{className:Jr("recharts-cartesian-axis-line",po(b,"className"))}))}},{key:"renderTicks",value:function(n,i,o){var h=this,s=this.props,p=s.tickLine,y=s.stroke,b=s.tick,_=s.tickFormatter,E=s.unit,C=WO(Bs(Bs({},this.props),{},{ticks:n}),i,o),k=this.getTickTextAnchor(),N=this.getTickVerticalAnchor(),O=Kr(this.props,!1),R=Kr(b,!1),L=Bs(Bs({},O),{},{fill:"none"},Kr(p,!1)),B=C.map(function(q,F){var H=h.getTickLineCoord(q),Z=H.line,re=H.tick,W=Bs(Bs(Bs(Bs({textAnchor:k,verticalAnchor:N},O),{},{stroke:"none",fill:y},R),re),{},{index:F,payload:q,visibleTicksCount:C.length,tickFormatter:_});return je.createElement(gi,om({className:"recharts-cartesian-axis-tick",key:"tick-".concat(q.value,"-").concat(q.coordinate,"-").concat(q.tickCoord)},Z1(h.props,q,F)),p&&je.createElement("line",om({},L,Z,{className:Jr("recharts-cartesian-axis-tick-line",po(p,"className"))})),b&&t.renderTickItem(b,W,"".concat(Rr(_)?_(q.value,F):q.value).concat(E||"")))});return je.createElement("g",{className:"recharts-cartesian-axis-ticks"},B)}},{key:"render",value:function(){var n=this,i=this.props,o=i.axisLine,h=i.width,s=i.height,p=i.ticksGenerator,y=i.className,b=i.hide;if(b)return null;var _=this.props,E=_.ticks,C=sP(_,w5e),k=E;return Rr(p)&&(k=E&&E.length>0?p(this.props):p(C)),h<=0||s<=0||!k||!k.length?null:je.createElement(gi,{className:Jr("recharts-cartesian-axis",y),ref:function(O){n.layerReference=O}},o&&this.renderAxisLine(),this.renderTicks(k,this.state.fontSize,this.state.letterSpacing),As.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,i,o){var h;return je.isValidElement(n)?h=je.cloneElement(n,i):Rr(n)?h=n(i):h=je.createElement(uS,om({},i,{className:"recharts-cartesian-axis-tick-value"}),o),h}}])}(I.Component);GO(Dg,"displayName","CartesianAxis");GO(Dg,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var k5e=["x1","y1","x2","y2","key"],M5e=["offset"];function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}function QF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ns(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QF(Object(r),!0).forEach(function(n){I5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I5e(e,t,r){return t=O5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O5e(e){var t=R5e(e,"string");return mf(t)=="symbol"?t:t+""}function R5e(e,t){if(mf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hh(){return Hh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hh.apply(this,arguments)}function eU(e,t){if(e==null)return{};var r=D5e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function D5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var L5e=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,i=t.x,o=t.y,h=t.width,s=t.height,p=t.ry;return je.createElement("rect",{x:i,y:o,ry:p,width:h,height:s,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function gZ(e,t){var r;if(je.isValidElement(e))r=je.cloneElement(e,t);else if(Rr(e))r=e(t);else{var n=t.x1,i=t.y1,o=t.x2,h=t.y2,s=t.key,p=eU(t,k5e),y=Kr(p,!1);y.offset;var b=eU(y,M5e);r=je.createElement("line",Hh({},b,{x1:n,y1:i,x2:o,y2:h,fill:"none",key:s}))}return r}function B5e(e){var t=e.x,r=e.width,n=e.horizontal,i=n===void 0?!0:n,o=e.horizontalPoints;if(!i||!o||!o.length)return null;var h=o.map(function(s,p){var y=Ns(Ns({},e),{},{x1:t,y1:s,x2:t+r,y2:s,key:"line-".concat(p),index:p});return gZ(i,y)});return je.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function z5e(e){var t=e.y,r=e.height,n=e.vertical,i=n===void 0?!0:n,o=e.verticalPoints;if(!i||!o||!o.length)return null;var h=o.map(function(s,p){var y=Ns(Ns({},e),{},{x1:s,y1:t,x2:s,y2:t+r,key:"line-".concat(p),index:p});return gZ(i,y)});return je.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function $5e(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,i=e.y,o=e.width,h=e.height,s=e.horizontalPoints,p=e.horizontal,y=p===void 0?!0:p;if(!y||!t||!t.length)return null;var b=s.map(function(E){return Math.round(E+i-i)}).sort(function(E,C){return E-C});i!==b[0]&&b.unshift(0);var _=b.map(function(E,C){var k=!b[C+1],N=k?i+h-E:b[C+1]-E;if(N<=0)return null;var O=C%t.length;return je.createElement("rect",{key:"react-".concat(C),y:E,x:n,height:N,width:o,stroke:"none",fill:t[O],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return je.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},_)}function F5e(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,i=e.fillOpacity,o=e.x,h=e.y,s=e.width,p=e.height,y=e.verticalPoints;if(!r||!n||!n.length)return null;var b=y.map(function(E){return Math.round(E+o-o)}).sort(function(E,C){return E-C});o!==b[0]&&b.unshift(0);var _=b.map(function(E,C){var k=!b[C+1],N=k?o+s-E:b[C+1]-E;if(N<=0)return null;var O=C%n.length;return je.createElement("rect",{key:"react-".concat(C),x:E,y:h,width:N,height:p,stroke:"none",fill:n[O],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return je.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},_)}var U5e=function(t,r){var n=t.xAxis,i=t.width,o=t.height,h=t.offset;return AK(WO(Ns(Ns(Ns({},Dg.defaultProps),n),{},{ticks:Cc(n,!0),viewBox:{x:0,y:0,width:i,height:o}})),h.left,h.left+h.width,r)},V5e=function(t,r){var n=t.yAxis,i=t.width,o=t.height,h=t.offset;return AK(WO(Ns(Ns(Ns({},Dg.defaultProps),n),{},{ticks:Cc(n,!0),viewBox:{x:0,y:0,width:i,height:o}})),h.top,h.top+h.height,r)},zp={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function yZ(e){var t,r,n,i,o,h,s=FO(),p=UO(),y=Ize(),b=Ns(Ns({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:zp.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:zp.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:zp.horizontal,horizontalFill:(i=e.horizontalFill)!==null&&i!==void 0?i:zp.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:zp.vertical,verticalFill:(h=e.verticalFill)!==null&&h!==void 0?h:zp.verticalFill,x:qt(e.x)?e.x:y.left,y:qt(e.y)?e.y:y.top,width:qt(e.width)?e.width:y.width,height:qt(e.height)?e.height:y.height}),_=b.x,E=b.y,C=b.width,k=b.height,N=b.syncWithTicks,O=b.horizontalValues,R=b.verticalValues,L=Nze(),B=kze();if(!qt(C)||C<=0||!qt(k)||k<=0||!qt(_)||_!==+_||!qt(E)||E!==+E)return null;var q=b.verticalCoordinatesGenerator||U5e,F=b.horizontalCoordinatesGenerator||V5e,H=b.horizontalPoints,Z=b.verticalPoints;if((!H||!H.length)&&Rr(F)){var re=O&&O.length,W=F({yAxis:B?Ns(Ns({},B),{},{ticks:re?O:B.ticks}):void 0,width:s,height:p,offset:y},re?!0:N);Mc(Array.isArray(W),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(mf(W),"]")),Array.isArray(W)&&(H=W)}if((!Z||!Z.length)&&Rr(q)){var te=R&&R.length,oe=q({xAxis:L?Ns(Ns({},L),{},{ticks:te?R:L.ticks}):void 0,width:s,height:p,offset:y},te?!0:N);Mc(Array.isArray(oe),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(mf(oe),"]")),Array.isArray(oe)&&(Z=oe)}return je.createElement("g",{className:"recharts-cartesian-grid"},je.createElement(L5e,{fill:b.fill,fillOpacity:b.fillOpacity,x:b.x,y:b.y,width:b.width,height:b.height,ry:b.ry}),je.createElement(B5e,Hh({},b,{offset:y,horizontalPoints:H,xAxis:L,yAxis:B})),je.createElement(z5e,Hh({},b,{offset:y,verticalPoints:Z,xAxis:L,yAxis:B})),je.createElement($5e,Hh({},b,{horizontalPoints:H})),je.createElement(F5e,Hh({},b,{verticalPoints:Z})))}yZ.displayName="CartesianGrid";var q5e=["type","layout","connectNulls","ref"],W5e=["key"];function eg(e){"@babel/helpers - typeof";return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eg(e)}function tU(e,t){if(e==null)return{};var r=G5e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function G5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function _x(){return _x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_x.apply(this,arguments)}function rU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ca(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rU(Object(r),!0).forEach(function(n){Jo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $p(e){return Z5e(e)||K5e(e)||X5e(e)||H5e()}function H5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X5e(e,t){if(e){if(typeof e=="string")return pk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pk(e,t)}}function K5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Z5e(e){if(Array.isArray(e))return pk(e)}function pk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Y5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xZ(n.key),n)}}function J5e(e,t,r){return t&&nU(e.prototype,t),r&&nU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q5e(e,t,r){return t=VS(t),e$e(e,vZ()?Reflect.construct(t,r||[],VS(e).constructor):t.apply(e,r))}function e$e(e,t){if(t&&(eg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t$e(e)}function t$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vZ=function(){return!!e})()}function VS(e){return VS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},VS(e)}function r$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mk(e,t)}function mk(e,t){return mk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mk(e,t)}function Jo(e,t,r){return t=xZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xZ(e){var t=n$e(e,"string");return eg(t)=="symbol"?t:t+""}function n$e(e,t){if(eg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tg=function(e){function t(){var r;Y5e(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=Q5e(this,t,[].concat(i)),Jo(r,"state",{isAnimationFinished:!0,totalLength:0}),Jo(r,"generateSimpleStrokeDasharray",function(h,s){return"".concat(s,"px ").concat(h-s,"px")}),Jo(r,"getStrokeDasharray",function(h,s,p){var y=p.reduce(function(R,L){return R+L});if(!y)return r.generateSimpleStrokeDasharray(s,h);for(var b=Math.floor(h/y),_=h%y,E=s-h,C=[],k=0,N=0;k<p.length;N+=p[k],++k)if(N+p[k]>_){C=[].concat($p(p.slice(0,k)),[_-N]);break}var O=C.length%2===0?[0,E]:[E];return[].concat($p(t.repeat(p,b)),$p(C),O).map(function(R){return"".concat(R,"px")}).join(", ")}),Jo(r,"id",eb("recharts-line-")),Jo(r,"pathRef",function(h){r.mainCurve=h}),Jo(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Jo(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return r$e(t,e),J5e(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,h=o.points,s=o.xAxis,p=o.yAxis,y=o.layout,b=o.children,_=mo(b,ab);if(!_)return null;var E=function(N,O){return{x:N.x,y:N.y,value:N.value,errorVal:Ba(N.payload,O)}},C={clipPath:n?"url(#clipPath-".concat(i,")"):null};return je.createElement(gi,C,_.map(function(k){return je.cloneElement(k,{key:"bar-".concat(k.props.dataKey),data:h,xAxis:s,yAxis:p,layout:y,dataPointFormatter:E})}))}},{key:"renderDots",value:function(n,i,o){var h=this.props.isAnimationActive;if(h&&!this.state.isAnimationFinished)return null;var s=this.props,p=s.dot,y=s.points,b=s.dataKey,_=Kr(this.props,!1),E=Kr(p,!0),C=y.map(function(N,O){var R=Ca(Ca(Ca({key:"dot-".concat(O),r:3},_),E),{},{index:O,cx:N.x,cy:N.y,value:N.value,dataKey:b,payload:N.payload,points:y});return t.renderDotItem(p,R)}),k={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return je.createElement(gi,_x({className:"recharts-line-dots",key:"dots"},k),C)}},{key:"renderCurveStatically",value:function(n,i,o,h){var s=this.props,p=s.type,y=s.layout,b=s.connectNulls;s.ref;var _=tU(s,q5e),E=Ca(Ca(Ca({},Kr(_,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(o,")"):null,points:n},h),{},{type:p,layout:y,connectNulls:b});return je.createElement(GN,_x({},E,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,i){var o=this,h=this.props,s=h.points,p=h.strokeDasharray,y=h.isAnimationActive,b=h.animationBegin,_=h.animationDuration,E=h.animationEasing,C=h.animationId,k=h.animateNewValues,N=h.width,O=h.height,R=this.state,L=R.prevPoints,B=R.totalLength;return je.createElement(Gm,{begin:b,duration:_,isActive:y,easing:E,from:{t:0},to:{t:1},key:"line-".concat(C),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(q){var F=q.t;if(L){var H=L.length/s.length,Z=s.map(function(ie,ue){var _e=Math.floor(ue*H);if(L[_e]){var xe=L[_e],be=tl(xe.x,ie.x),Ae=tl(xe.y,ie.y);return Ca(Ca({},ie),{},{x:be(F),y:Ae(F)})}if(k){var me=tl(N*2,ie.x),ke=tl(O/2,ie.y);return Ca(Ca({},ie),{},{x:me(F),y:ke(F)})}return Ca(Ca({},ie),{},{x:ie.x,y:ie.y})});return o.renderCurveStatically(Z,n,i)}var re=tl(0,B),W=re(F),te;if(p){var oe="".concat(p).split(/[,\s]+/gim).map(function(ie){return parseFloat(ie)});te=o.getStrokeDasharray(W,B,oe)}else te=o.generateSimpleStrokeDasharray(B,W);return o.renderCurveStatically(s,n,i,{strokeDasharray:te})})}},{key:"renderCurve",value:function(n,i){var o=this.props,h=o.points,s=o.isAnimationActive,p=this.state,y=p.prevPoints,b=p.totalLength;return s&&h&&h.length&&(!y&&b>0||!A2(y,h))?this.renderCurveWithAnimation(n,i):this.renderCurveStatically(h,n,i)}},{key:"render",value:function(){var n,i=this.props,o=i.hide,h=i.dot,s=i.points,p=i.className,y=i.xAxis,b=i.yAxis,_=i.top,E=i.left,C=i.width,k=i.height,N=i.isAnimationActive,O=i.id;if(o||!s||!s.length)return null;var R=this.state.isAnimationFinished,L=s.length===1,B=Jr("recharts-line",p),q=y&&y.allowDataOverflow,F=b&&b.allowDataOverflow,H=q||F,Z=Hr(O)?this.id:O,re=(n=Kr(h,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},W=re.r,te=W===void 0?3:W,oe=re.strokeWidth,ie=oe===void 0?2:oe,ue=Pwe(h)?h:{},_e=ue.clipDot,xe=_e===void 0?!0:_e,be=te*2+ie;return je.createElement(gi,{className:B},q||F?je.createElement("defs",null,je.createElement("clipPath",{id:"clipPath-".concat(Z)},je.createElement("rect",{x:q?E:E-C/2,y:F?_:_-k/2,width:q?C:C*2,height:F?k:k*2})),!xe&&je.createElement("clipPath",{id:"clipPath-dots-".concat(Z)},je.createElement("rect",{x:E-be/2,y:_-be/2,width:C+be,height:k+be}))):null,!L&&this.renderCurve(H,Z),this.renderErrorBar(H,Z),(L||h)&&this.renderDots(H,xe,Z),(!N||R)&&fd.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:i.curPoints}:n.points!==i.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,i){for(var o=n.length%2!==0?[].concat($p(n),[0]):n,h=[],s=0;s<i;++s)h=[].concat($p(h),$p(o));return h}},{key:"renderDotItem",value:function(n,i){var o;if(je.isValidElement(n))o=je.cloneElement(n,i);else if(Rr(n))o=n(i);else{var h=i.key,s=tU(i,W5e),p=Jr("recharts-line-dot",typeof n!="boolean"?n.className:"");o=je.createElement(LO,_x({key:h},s,{className:p}))}return o}}])}(I.PureComponent);Jo(tg,"displayName","Line");Jo(tg,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Ic.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Jo(tg,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,h=e.dataKey,s=e.bandSize,p=e.displayedData,y=e.offset,b=t.layout,_=p.map(function(E,C){var k=Ba(E,h);return b==="horizontal"?{x:I$({axis:r,ticks:i,bandSize:s,entry:E,index:C}),y:Hr(k)?null:n.scale(k),value:k,payload:E}:{x:Hr(k)?null:r.scale(k),y:I$({axis:n,ticks:o,bandSize:s,entry:E,index:C}),value:k,payload:E}});return Ca({points:_,layout:b},y)});function rg(e){"@babel/helpers - typeof";return rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rg(e)}function i$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wZ(n.key),n)}}function s$e(e,t,r){return t&&iU(e.prototype,t),r&&iU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a$e(e,t,r){return t=qS(t),o$e(e,bZ()?Reflect.construct(t,r||[],qS(e).constructor):t.apply(e,r))}function o$e(e,t){if(t&&(rg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l$e(e)}function l$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bZ=function(){return!!e})()}function qS(e){return qS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qS(e)}function c$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gk(e,t)}function gk(e,t){return gk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gk(e,t)}function _Z(e,t,r){return t=wZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wZ(e){var t=u$e(e,"string");return rg(t)=="symbol"?t:t+""}function u$e(e,t){if(rg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yk(){return yk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yk.apply(this,arguments)}function d$e(e){var t=e.xAxisId,r=FO(),n=UO(),i=sZ(t);return i==null?null:je.createElement(Dg,yk({},i,{className:Jr("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(h){return Cc(h,!0)}}))}var $2=function(e){function t(){return i$e(this,t),a$e(this,t,arguments)}return c$e(t,e),s$e(t,[{key:"render",value:function(){return je.createElement(d$e,this.props)}}])}(je.Component);_Z($2,"displayName","XAxis");_Z($2,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function ng(e){"@babel/helpers - typeof";return ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ng(e)}function h$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TZ(n.key),n)}}function f$e(e,t,r){return t&&sU(e.prototype,t),r&&sU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p$e(e,t,r){return t=WS(t),m$e(e,SZ()?Reflect.construct(t,r||[],WS(e).constructor):t.apply(e,r))}function m$e(e,t){if(t&&(ng(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g$e(e)}function g$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SZ=function(){return!!e})()}function WS(e){return WS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},WS(e)}function y$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vk(e,t)}function vk(e,t){return vk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vk(e,t)}function EZ(e,t,r){return t=TZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TZ(e){var t=v$e(e,"string");return ng(t)=="symbol"?t:t+""}function v$e(e,t){if(ng(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ng(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xk(){return xk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xk.apply(this,arguments)}var x$e=function(t){var r=t.yAxisId,n=FO(),i=UO(),o=aZ(r);return o==null?null:je.createElement(Dg,xk({},o,{className:Jr("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(s){return Cc(s,!0)}}))},F2=function(e){function t(){return h$e(this,t),p$e(this,t,arguments)}return y$e(t,e),f$e(t,[{key:"render",value:function(){return je.createElement(x$e,this.props)}}])}(je.Component);EZ(F2,"displayName","YAxis");EZ(F2,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function aU(e){return S$e(e)||w$e(e)||_$e(e)||b$e()}function b$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _$e(e,t){if(e){if(typeof e=="string")return bk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bk(e,t)}}function w$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function S$e(e){if(Array.isArray(e))return bk(e)}function bk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _k=function(t,r,n,i,o){var h=mo(t,qO),s=mo(t,L2),p=[].concat(aU(h),aU(s)),y=mo(t,z2),b="".concat(i,"Id"),_=i[0],E=r;if(p.length&&(E=p.reduce(function(N,O){if(O.props[b]===n&&Vl(O.props,"extendDomain")&&qt(O.props[_])){var R=O.props[_];return[Math.min(N[0],R),Math.max(N[1],R)]}return N},E)),y.length){var C="".concat(_,"1"),k="".concat(_,"2");E=y.reduce(function(N,O){if(O.props[b]===n&&Vl(O.props,"extendDomain")&&qt(O.props[C])&&qt(O.props[k])){var R=O.props[C],L=O.props[k];return[Math.min(N[0],R,L),Math.max(N[1],R,L)]}return N},E)}return o&&o.length&&(E=o.reduce(function(N,O){return qt(O)?[Math.min(N[0],O),Math.max(N[1],O)]:N},E)),E},jZ={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(p,y,b){this.fn=p,this.context=y,this.once=b||!1}function o(p,y,b,_,E){if(typeof b!="function")throw new TypeError("The listener must be a function");var C=new i(b,_||p,E),k=r?r+y:y;return p._events[k]?p._events[k].fn?p._events[k]=[p._events[k],C]:p._events[k].push(C):(p._events[k]=C,p._eventsCount++),p}function h(p,y){--p._eventsCount===0?p._events=new n:delete p._events[y]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var y=[],b,_;if(this._eventsCount===0)return y;for(_ in b=this._events)t.call(b,_)&&y.push(r?_.slice(1):_);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(b)):y},s.prototype.listeners=function(y){var b=r?r+y:y,_=this._events[b];if(!_)return[];if(_.fn)return[_.fn];for(var E=0,C=_.length,k=new Array(C);E<C;E++)k[E]=_[E].fn;return k},s.prototype.listenerCount=function(y){var b=r?r+y:y,_=this._events[b];return _?_.fn?1:_.length:0},s.prototype.emit=function(y,b,_,E,C,k){var N=r?r+y:y;if(!this._events[N])return!1;var O=this._events[N],R=arguments.length,L,B;if(O.fn){switch(O.once&&this.removeListener(y,O.fn,void 0,!0),R){case 1:return O.fn.call(O.context),!0;case 2:return O.fn.call(O.context,b),!0;case 3:return O.fn.call(O.context,b,_),!0;case 4:return O.fn.call(O.context,b,_,E),!0;case 5:return O.fn.call(O.context,b,_,E,C),!0;case 6:return O.fn.call(O.context,b,_,E,C,k),!0}for(B=1,L=new Array(R-1);B<R;B++)L[B-1]=arguments[B];O.fn.apply(O.context,L)}else{var q=O.length,F;for(B=0;B<q;B++)switch(O[B].once&&this.removeListener(y,O[B].fn,void 0,!0),R){case 1:O[B].fn.call(O[B].context);break;case 2:O[B].fn.call(O[B].context,b);break;case 3:O[B].fn.call(O[B].context,b,_);break;case 4:O[B].fn.call(O[B].context,b,_,E);break;default:if(!L)for(F=1,L=new Array(R-1);F<R;F++)L[F-1]=arguments[F];O[B].fn.apply(O[B].context,L)}}return!0},s.prototype.on=function(y,b,_){return o(this,y,b,_,!1)},s.prototype.once=function(y,b,_){return o(this,y,b,_,!0)},s.prototype.removeListener=function(y,b,_,E){var C=r?r+y:y;if(!this._events[C])return this;if(!b)return h(this,C),this;var k=this._events[C];if(k.fn)k.fn===b&&(!E||k.once)&&(!_||k.context===_)&&h(this,C);else{for(var N=0,O=[],R=k.length;N<R;N++)(k[N].fn!==b||E&&!k[N].once||_&&k[N].context!==_)&&O.push(k[N]);O.length?this._events[C]=O.length===1?O[0]:O:h(this,C)}return this},s.prototype.removeAllListeners=function(y){var b;return y?(b=r?r+y:y,this._events[b]&&h(this,b)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s})(jZ);var E$e=jZ.exports;const T$e=Sn(E$e);var aP=new T$e,oP="recharts.syncMouseEvents";function k0(e){"@babel/helpers - typeof";return k0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k0(e)}function j$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CZ(n.key),n)}}function C$e(e,t,r){return t&&oU(e.prototype,t),r&&oU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lP(e,t,r){return t=CZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CZ(e){var t=P$e(e,"string");return k0(t)=="symbol"?t:t+""}function P$e(e,t){if(k0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(k0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var A$e=function(){function e(){j$e(this,e),lP(this,"activeIndex",0),lP(this,"coordinateList",[]),lP(this,"layout","horizontal")}return C$e(e,[{key:"setDetails",value:function(r){var n,i=r.coordinateList,o=i===void 0?null:i,h=r.container,s=h===void 0?null:h,p=r.layout,y=p===void 0?null:p,b=r.offset,_=b===void 0?null:b,E=r.mouseHandlerCallback,C=E===void 0?null:E;this.coordinateList=(n=o??this.coordinateList)!==null&&n!==void 0?n:[],this.container=s??this.container,this.layout=y??this.layout,this.offset=_??this.offset,this.mouseHandlerCallback=C??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),o=i.x,h=i.y,s=i.height,p=this.coordinateList[this.activeIndex].coordinate,y=((r=window)===null||r===void 0?void 0:r.scrollX)||0,b=((n=window)===null||n===void 0?void 0:n.scrollY)||0,_=o+p+y,E=h+this.offset.top+s/2+b;this.mouseHandlerCallback({pageX:_,pageY:E})}}}])}();function N$e(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],i=e==null?void 0:e[1];if(n&&i&&qt(n)&&qt(i))return!0}return!1}function k$e(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function PZ(e){var t=e.cx,r=e.cy,n=e.radius,i=e.startAngle,o=e.endAngle,h=ds(t,r,n,i),s=ds(t,r,n,o);return{points:[h,s],cx:t,cy:r,radius:n,startAngle:i,endAngle:o}}function M$e(e,t,r){var n,i,o,h;if(e==="horizontal")n=t.x,o=n,i=r.top,h=r.top+r.height;else if(e==="vertical")i=t.y,h=i,n=r.left,o=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,p=t.cy,y=t.innerRadius,b=t.outerRadius,_=t.angle,E=ds(s,p,y,_),C=ds(s,p,b,_);n=E.x,i=E.y,o=C.x,h=C.y}else return PZ(t);return[{x:n,y:i},{x:o,y:h}]}function M0(e){"@babel/helpers - typeof";return M0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M0(e)}function lU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Nw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lU(Object(r),!0).forEach(function(n){I$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I$e(e,t,r){return t=O$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O$e(e){var t=R$e(e,"string");return M0(t)=="symbol"?t:t+""}function R$e(e,t){if(M0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(M0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function D$e(e){var t,r,n=e.element,i=e.tooltipEventType,o=e.isActive,h=e.activeCoordinate,s=e.activePayload,p=e.offset,y=e.activeTooltipIndex,b=e.tooltipAxisBandSize,_=e.layout,E=e.chartName,C=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!C||!o||!h||E!=="ScatterChart"&&i!=="axis")return null;var k,N=GN;if(E==="ScatterChart")k=h,N=F3e;else if(E==="BarChart")k=k$e(_,h,p,b),N=DO;else if(_==="radial"){var O=PZ(h),R=O.cx,L=O.cy,B=O.radius,q=O.startAngle,F=O.endAngle;k={cx:R,cy:L,startAngle:q,endAngle:F,innerRadius:B,outerRadius:B},N=OK}else k={points:M$e(_,h,p)},N=GN;var H=Nw(Nw(Nw(Nw({stroke:"#ccc",pointerEvents:"none"},p),k),Kr(C,!1)),{},{payload:s,payloadIndex:y,className:Jr("recharts-tooltip-cursor",C.className)});return I.isValidElement(C)?I.cloneElement(C,H):I.createElement(N,H)}var L$e=["item"],B$e=["children","className","width","height","style","compact","title","desc"];function ig(e){"@babel/helpers - typeof";return ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ig(e)}function lm(){return lm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lm.apply(this,arguments)}function cU(e,t){return F$e(e)||$$e(e,t)||NZ(e,t)||z$e()}function z$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,h,s=[],p=!0,y=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);p=!0);}catch(b){y=!0,i=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw i}}return s}}function F$e(e){if(Array.isArray(e))return e}function uU(e,t){if(e==null)return{};var r=U$e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function U$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function V$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kZ(n.key),n)}}function q$e(e,t,r){return t&&dU(e.prototype,t),r&&dU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W$e(e,t,r){return t=GS(t),G$e(e,AZ()?Reflect.construct(t,r||[],GS(e).constructor):t.apply(e,r))}function G$e(e,t){if(t&&(ig(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H$e(e)}function H$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(AZ=function(){return!!e})()}function GS(e){return GS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},GS(e)}function X$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wk(e,t)}function wk(e,t){return wk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wk(e,t)}function sg(e){return Y$e(e)||Z$e(e)||NZ(e)||K$e()}function K$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NZ(e,t){if(e){if(typeof e=="string")return Sk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sk(e,t)}}function Z$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Y$e(e){if(Array.isArray(e))return Sk(e)}function Sk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hU(Object(r),!0).forEach(function(n){vr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vr(e,t,r){return t=kZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kZ(e){var t=J$e(e,"string");return ig(t)=="symbol"?t:t+""}function J$e(e,t){if(ig(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ig(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q$e={xAxis:["bottom","top"],yAxis:["left","right"]},eFe={width:"100%",height:"100%"},MZ={x:0,y:0};function kw(e){return e}var tFe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},rFe=function(t,r,n,i){var o=r.find(function(b){return b&&b.index===n});if(o){if(t==="horizontal")return{x:o.coordinate,y:i.y};if(t==="vertical")return{x:i.x,y:o.coordinate};if(t==="centric"){var h=o.coordinate,s=i.radius;return vt(vt(vt({},i),ds(i.cx,i.cy,s,h)),{},{angle:h,radius:s})}var p=o.coordinate,y=i.angle;return vt(vt(vt({},i),ds(i.cx,i.cy,p,y)),{},{angle:y,radius:p})}return MZ},U2=function(t,r){var n=r.graphicalItems,i=r.dataStartIndex,o=r.dataEndIndex,h=(n??[]).reduce(function(s,p){var y=p.props.data;return y&&y.length?[].concat(sg(s),sg(y)):s},[]);return h.length>0?h:t&&t.length&&qt(i)&&qt(o)?t.slice(i,o+1):[]};function IZ(e){return e==="number"?[0,"auto"]:void 0}var Ek=function(t,r,n,i){var o=t.graphicalItems,h=t.tooltipAxis,s=U2(r,t);return n<0||!o||!o.length||n>=s.length?null:o.reduce(function(p,y){var b,_=(b=y.props.data)!==null&&b!==void 0?b:r;_&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(_=_.slice(t.dataStartIndex,t.dataEndIndex+1));var E;if(h.dataKey&&!h.allowDuplicatedCategory){var C=_===void 0?s:_;E=X1(C,h.dataKey,i)}else E=_&&_[n]||s[n];return E?[].concat(sg(p),[kK(y,E)]):p},[])},fU=function(t,r,n,i){var o=i||{x:t.chartX,y:t.chartY},h=tFe(o,n),s=t.orderedTooltipTicks,p=t.tooltipAxis,y=t.tooltipTicks,b=ARe(h,s,y,p);if(b>=0&&y){var _=y[b]&&y[b].value,E=Ek(t,r,b,_),C=rFe(n,s,b,o);return{activeTooltipIndex:b,activeLabel:_,activePayload:E,activeCoordinate:C}}return null},nFe=function(t,r){var n=r.axes,i=r.graphicalItems,o=r.axisType,h=r.axisIdKey,s=r.stackGroups,p=r.dataStartIndex,y=r.dataEndIndex,b=t.layout,_=t.children,E=t.stackOffset,C=PK(b,o);return n.reduce(function(k,N){var O,R=N.type.defaultProps!==void 0?vt(vt({},N.type.defaultProps),N.props):N.props,L=R.type,B=R.dataKey,q=R.allowDataOverflow,F=R.allowDuplicatedCategory,H=R.scale,Z=R.ticks,re=R.includeHidden,W=R[h];if(k[W])return k;var te=U2(t.data,{graphicalItems:i.filter(function(We){var ut,nt=h in We.props?We.props[h]:(ut=We.type.defaultProps)===null||ut===void 0?void 0:ut[h];return nt===W}),dataStartIndex:p,dataEndIndex:y}),oe=te.length,ie,ue,_e;N$e(R.domain,q,L)&&(ie=FN(R.domain,null,q),C&&(L==="number"||H!=="auto")&&(_e=xx(te,B,"category")));var xe=IZ(L);if(!ie||ie.length===0){var be,Ae=(be=R.domain)!==null&&be!==void 0?be:xe;if(B){if(ie=xx(te,B,L),L==="category"&&C){var me=vwe(ie);F&&me?(ue=ie,ie=IS(0,oe)):F||(ie=L$(Ae,ie,N).reduce(function(We,ut){return We.indexOf(ut)>=0?We:[].concat(sg(We),[ut])},[]))}else if(L==="category")F?ie=ie.filter(function(We){return We!==""&&!Hr(We)}):ie=L$(Ae,ie,N).reduce(function(We,ut){return We.indexOf(ut)>=0||ut===""||Hr(ut)?We:[].concat(sg(We),[ut])},[]);else if(L==="number"){var ke=ORe(te,i.filter(function(We){var ut,nt,Pt=h in We.props?We.props[h]:(ut=We.type.defaultProps)===null||ut===void 0?void 0:ut[h],It="hide"in We.props?We.props.hide:(nt=We.type.defaultProps)===null||nt===void 0?void 0:nt.hide;return Pt===W&&(re||!It)}),B,o,b);ke&&(ie=ke)}C&&(L==="number"||H!=="auto")&&(_e=xx(te,B,"category"))}else C?ie=IS(0,oe):s&&s[W]&&s[W].hasStack&&L==="number"?ie=E==="expand"?[0,1]:NK(s[W].stackGroups,p,y):ie=CK(te,i.filter(function(We){var ut=h in We.props?We.props[h]:We.type.defaultProps[h],nt="hide"in We.props?We.props.hide:We.type.defaultProps.hide;return ut===W&&(re||!nt)}),L,b,!0);if(L==="number")ie=_k(_,ie,W,o,Z),Ae&&(ie=FN(Ae,ie,q));else if(L==="category"&&Ae){var Ne=Ae,Be=ie.every(function(We){return Ne.indexOf(We)>=0});Be&&(ie=Ne)}}return vt(vt({},k),{},vr({},W,vt(vt({},R),{},{axisType:o,domain:ie,categoricalDomain:_e,duplicateDomain:ue,originalDomain:(O=R.domain)!==null&&O!==void 0?O:xe,isCategorical:C,layout:b})))},{})},iFe=function(t,r){var n=r.graphicalItems,i=r.Axis,o=r.axisType,h=r.axisIdKey,s=r.stackGroups,p=r.dataStartIndex,y=r.dataEndIndex,b=t.layout,_=t.children,E=U2(t.data,{graphicalItems:n,dataStartIndex:p,dataEndIndex:y}),C=E.length,k=PK(b,o),N=-1;return n.reduce(function(O,R){var L=R.type.defaultProps!==void 0?vt(vt({},R.type.defaultProps),R.props):R.props,B=L[h],q=IZ("number");if(!O[B]){N++;var F;return k?F=IS(0,C):s&&s[B]&&s[B].hasStack?(F=NK(s[B].stackGroups,p,y),F=_k(_,F,B,o)):(F=FN(q,CK(E,n.filter(function(H){var Z,re,W=h in H.props?H.props[h]:(Z=H.type.defaultProps)===null||Z===void 0?void 0:Z[h],te="hide"in H.props?H.props.hide:(re=H.type.defaultProps)===null||re===void 0?void 0:re.hide;return W===B&&!te}),"number",b),i.defaultProps.allowDataOverflow),F=_k(_,F,B,o)),vt(vt({},O),{},vr({},B,vt(vt({axisType:o},i.defaultProps),{},{hide:!0,orientation:po(Q$e,"".concat(o,".").concat(N%2),null),domain:F,originalDomain:q,isCategorical:k,layout:b})))}return O},{})},sFe=function(t,r){var n=r.axisType,i=n===void 0?"xAxis":n,o=r.AxisComp,h=r.graphicalItems,s=r.stackGroups,p=r.dataStartIndex,y=r.dataEndIndex,b=t.children,_="".concat(i,"Id"),E=mo(b,o),C={};return E&&E.length?C=nFe(t,{axes:E,graphicalItems:h,axisType:i,axisIdKey:_,stackGroups:s,dataStartIndex:p,dataEndIndex:y}):h&&h.length&&(C=iFe(t,{Axis:o,graphicalItems:h,axisType:i,axisIdKey:_,stackGroups:s,dataStartIndex:p,dataEndIndex:y})),C},aFe=function(t){var r=Zu(t),n=Cc(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:cO(n,function(i){return i.coordinate}),tooltipAxis:r,tooltipAxisBandSize:ES(r,n)}},pU=function(t){var r=t.children,n=t.defaultShowTooltip,i=Na(r,Xm),o=0,h=0;return t.data&&t.data.length!==0&&(h=t.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(o=i.props.startIndex),i.props.endIndex>=0&&(h=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:o,dataEndIndex:h,activeTooltipIndex:-1,isTooltipActive:!!n}},oFe=function(t){return!t||!t.length?!1:t.some(function(r){var n=kc(r&&r.type);return n&&n.indexOf("Bar")>=0})},mU=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},lFe=function(t,r){var n=t.props,i=t.graphicalItems,o=t.xAxisMap,h=o===void 0?{}:o,s=t.yAxisMap,p=s===void 0?{}:s,y=n.width,b=n.height,_=n.children,E=n.margin||{},C=Na(_,Xm),k=Na(_,vm),N=Object.keys(p).reduce(function(F,H){var Z=p[H],re=Z.orientation;return!Z.mirror&&!Z.hide?vt(vt({},F),{},vr({},re,F[re]+Z.width)):F},{left:E.left||0,right:E.right||0}),O=Object.keys(h).reduce(function(F,H){var Z=h[H],re=Z.orientation;return!Z.mirror&&!Z.hide?vt(vt({},F),{},vr({},re,po(F,"".concat(re))+Z.height)):F},{top:E.top||0,bottom:E.bottom||0}),R=vt(vt({},O),N),L=R.bottom;C&&(R.bottom+=C.props.height||Xm.defaultProps.height),k&&r&&(R=MRe(R,i,n,r));var B=y-R.left-R.right,q=b-R.top-R.bottom;return vt(vt({brushBottom:L},R),{},{width:Math.max(B,0),height:Math.max(q,0)})},cFe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},uFe=function(t){var r=t.chartName,n=t.GraphicalChild,i=t.defaultTooltipEventType,o=i===void 0?"axis":i,h=t.validateTooltipEventTypes,s=h===void 0?["axis"]:h,p=t.axisComponents,y=t.legendContent,b=t.formatAxisMap,_=t.defaultProps,E=function(R,L){var B=L.graphicalItems,q=L.stackGroups,F=L.offset,H=L.updateId,Z=L.dataStartIndex,re=L.dataEndIndex,W=R.barSize,te=R.layout,oe=R.barGap,ie=R.barCategoryGap,ue=R.maxBarSize,_e=mU(te),xe=_e.numericAxisName,be=_e.cateAxisName,Ae=oFe(B),me=[];return B.forEach(function(ke,Ne){var Be=U2(R.data,{graphicalItems:[ke],dataStartIndex:Z,dataEndIndex:re}),We=ke.type.defaultProps!==void 0?vt(vt({},ke.type.defaultProps),ke.props):ke.props,ut=We.dataKey,nt=We.maxBarSize,Pt=We["".concat(xe,"Id")],It=We["".concat(be,"Id")],at={},Ut=p.reduce(function(qi,ns){var ms=L["".concat(ns.axisType,"Map")],xa=We["".concat(ns.axisType,"Id")];ms&&ms[xa]||ns.axisType==="zAxis"||pf(!1);var Fa=ms[xa];return vt(vt({},qi),{},vr(vr({},ns.axisType,Fa),"".concat(ns.axisType,"Ticks"),Cc(Fa)))},at),ct=Ut[be],gt=Ut["".concat(be,"Ticks")],it=q&&q[Pt]&&q[Pt].hasStack&&GRe(ke,q[Pt].stackGroups),rt=kc(ke.type).indexOf("Bar")>=0,rr=ES(ct,gt),ir=[],or=Ae&&NRe({barSize:W,stackGroups:q,totalSize:cFe(Ut,be)});if(rt){var Sr,tn,Mn=Hr(nt)?ue:nt,vn=(Sr=(tn=ES(ct,gt,!0))!==null&&tn!==void 0?tn:Mn)!==null&&Sr!==void 0?Sr:0;ir=kRe({barGap:oe,barCategoryGap:ie,bandSize:vn!==rr?vn:rr,sizeList:or[It],maxBarSize:Mn}),vn!==rr&&(ir=ir.map(function(qi){return vt(vt({},qi),{},{position:vt(vt({},qi.position),{},{offset:qi.position.offset-vn/2})})}))}var Zs=ke&&ke.type&&ke.type.getComposedData;Zs&&me.push({props:vt(vt({},Zs(vt(vt({},Ut),{},{displayedData:Be,props:R,dataKey:ut,item:ke,bandSize:rr,barPosition:ir,offset:F,stackedData:it,layout:te,dataStartIndex:Z,dataEndIndex:re}))),{},vr(vr(vr({key:ke.key||"item-".concat(Ne)},xe,Ut[xe]),be,Ut[be]),"animationId",H)),childIndex:kwe(ke,R.children),item:ke})}),me},C=function(R,L){var B=R.props,q=R.dataStartIndex,F=R.dataEndIndex,H=R.updateId;if(!jz({props:B}))return null;var Z=B.children,re=B.layout,W=B.stackOffset,te=B.data,oe=B.reverseStackOrder,ie=mU(re),ue=ie.numericAxisName,_e=ie.cateAxisName,xe=mo(Z,n),be=VRe(te,xe,"".concat(ue,"Id"),"".concat(_e,"Id"),W,oe),Ae=p.reduce(function(We,ut){var nt="".concat(ut.axisType,"Map");return vt(vt({},We),{},vr({},nt,sFe(B,vt(vt({},ut),{},{graphicalItems:xe,stackGroups:ut.axisType===ue&&be,dataStartIndex:q,dataEndIndex:F}))))},{}),me=lFe(vt(vt({},Ae),{},{props:B,graphicalItems:xe}),L==null?void 0:L.legendBBox);Object.keys(Ae).forEach(function(We){Ae[We]=b(B,Ae[We],me,We.replace("Map",""),r)});var ke=Ae["".concat(_e,"Map")],Ne=aFe(ke),Be=E(B,vt(vt({},Ae),{},{dataStartIndex:q,dataEndIndex:F,updateId:H,graphicalItems:xe,stackGroups:be,offset:me}));return vt(vt({formattedGraphicalItems:Be,graphicalItems:xe,offset:me,stackGroups:be},Ne),Ae)},k=function(O){function R(L){var B,q,F;return V$e(this,R),F=W$e(this,R,[L]),vr(F,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),vr(F,"accessibilityManager",new A$e),vr(F,"handleLegendBBoxUpdate",function(H){if(H){var Z=F.state,re=Z.dataStartIndex,W=Z.dataEndIndex,te=Z.updateId;F.setState(vt({legendBBox:H},C({props:F.props,dataStartIndex:re,dataEndIndex:W,updateId:te},vt(vt({},F.state),{},{legendBBox:H}))))}}),vr(F,"handleReceiveSyncEvent",function(H,Z,re){if(F.props.syncId===H){if(re===F.eventEmitterSymbol&&typeof F.props.syncMethod!="function")return;F.applySyncEvent(Z)}}),vr(F,"handleBrushChange",function(H){var Z=H.startIndex,re=H.endIndex;if(Z!==F.state.dataStartIndex||re!==F.state.dataEndIndex){var W=F.state.updateId;F.setState(function(){return vt({dataStartIndex:Z,dataEndIndex:re},C({props:F.props,dataStartIndex:Z,dataEndIndex:re,updateId:W},F.state))}),F.triggerSyncEvent({dataStartIndex:Z,dataEndIndex:re})}}),vr(F,"handleMouseEnter",function(H){var Z=F.getMouseInfo(H);if(Z){var re=vt(vt({},Z),{},{isTooltipActive:!0});F.setState(re),F.triggerSyncEvent(re);var W=F.props.onMouseEnter;Rr(W)&&W(re,H)}}),vr(F,"triggeredAfterMouseMove",function(H){var Z=F.getMouseInfo(H),re=Z?vt(vt({},Z),{},{isTooltipActive:!0}):{isTooltipActive:!1};F.setState(re),F.triggerSyncEvent(re);var W=F.props.onMouseMove;Rr(W)&&W(re,H)}),vr(F,"handleItemMouseEnter",function(H){F.setState(function(){return{isTooltipActive:!0,activeItem:H,activePayload:H.tooltipPayload,activeCoordinate:H.tooltipPosition||{x:H.cx,y:H.cy}}})}),vr(F,"handleItemMouseLeave",function(){F.setState(function(){return{isTooltipActive:!1}})}),vr(F,"handleMouseMove",function(H){H.persist(),F.throttleTriggeredAfterMouseMove(H)}),vr(F,"handleMouseLeave",function(H){F.throttleTriggeredAfterMouseMove.cancel();var Z={isTooltipActive:!1};F.setState(Z),F.triggerSyncEvent(Z);var re=F.props.onMouseLeave;Rr(re)&&re(Z,H)}),vr(F,"handleOuterEvent",function(H){var Z=Nwe(H),re=po(F.props,"".concat(Z));if(Z&&Rr(re)){var W,te;/.*touch.*/i.test(Z)?te=F.getMouseInfo(H.changedTouches[0]):te=F.getMouseInfo(H),re((W=te)!==null&&W!==void 0?W:{},H)}}),vr(F,"handleClick",function(H){var Z=F.getMouseInfo(H);if(Z){var re=vt(vt({},Z),{},{isTooltipActive:!0});F.setState(re),F.triggerSyncEvent(re);var W=F.props.onClick;Rr(W)&&W(re,H)}}),vr(F,"handleMouseDown",function(H){var Z=F.props.onMouseDown;if(Rr(Z)){var re=F.getMouseInfo(H);Z(re,H)}}),vr(F,"handleMouseUp",function(H){var Z=F.props.onMouseUp;if(Rr(Z)){var re=F.getMouseInfo(H);Z(re,H)}}),vr(F,"handleTouchMove",function(H){H.changedTouches!=null&&H.changedTouches.length>0&&F.throttleTriggeredAfterMouseMove(H.changedTouches[0])}),vr(F,"handleTouchStart",function(H){H.changedTouches!=null&&H.changedTouches.length>0&&F.handleMouseDown(H.changedTouches[0])}),vr(F,"handleTouchEnd",function(H){H.changedTouches!=null&&H.changedTouches.length>0&&F.handleMouseUp(H.changedTouches[0])}),vr(F,"handleDoubleClick",function(H){var Z=F.props.onDoubleClick;if(Rr(Z)){var re=F.getMouseInfo(H);Z(re,H)}}),vr(F,"handleContextMenu",function(H){var Z=F.props.onContextMenu;if(Rr(Z)){var re=F.getMouseInfo(H);Z(re,H)}}),vr(F,"triggerSyncEvent",function(H){F.props.syncId!==void 0&&aP.emit(oP,F.props.syncId,H,F.eventEmitterSymbol)}),vr(F,"applySyncEvent",function(H){var Z=F.props,re=Z.layout,W=Z.syncMethod,te=F.state.updateId,oe=H.dataStartIndex,ie=H.dataEndIndex;if(H.dataStartIndex!==void 0||H.dataEndIndex!==void 0)F.setState(vt({dataStartIndex:oe,dataEndIndex:ie},C({props:F.props,dataStartIndex:oe,dataEndIndex:ie,updateId:te},F.state)));else if(H.activeTooltipIndex!==void 0){var ue=H.chartX,_e=H.chartY,xe=H.activeTooltipIndex,be=F.state,Ae=be.offset,me=be.tooltipTicks;if(!Ae)return;if(typeof W=="function")xe=W(me,H);else if(W==="value"){xe=-1;for(var ke=0;ke<me.length;ke++)if(me[ke].value===H.activeLabel){xe=ke;break}}var Ne=vt(vt({},Ae),{},{x:Ae.left,y:Ae.top}),Be=Math.min(ue,Ne.x+Ne.width),We=Math.min(_e,Ne.y+Ne.height),ut=me[xe]&&me[xe].value,nt=Ek(F.state,F.props.data,xe),Pt=me[xe]?{x:re==="horizontal"?me[xe].coordinate:Be,y:re==="horizontal"?We:me[xe].coordinate}:MZ;F.setState(vt(vt({},H),{},{activeLabel:ut,activeCoordinate:Pt,activePayload:nt,activeTooltipIndex:xe}))}else F.setState(H)}),vr(F,"renderCursor",function(H){var Z,re=F.state,W=re.isTooltipActive,te=re.activeCoordinate,oe=re.activePayload,ie=re.offset,ue=re.activeTooltipIndex,_e=re.tooltipAxisBandSize,xe=F.getTooltipEventType(),be=(Z=H.props.active)!==null&&Z!==void 0?Z:W,Ae=F.props.layout,me=H.key||"_recharts-cursor";return je.createElement(D$e,{key:me,activeCoordinate:te,activePayload:oe,activeTooltipIndex:ue,chartName:r,element:H,isActive:be,layout:Ae,offset:ie,tooltipAxisBandSize:_e,tooltipEventType:xe})}),vr(F,"renderPolarAxis",function(H,Z,re){var W=po(H,"type.axisType"),te=po(F.state,"".concat(W,"Map")),oe=H.type.defaultProps,ie=oe!==void 0?vt(vt({},oe),H.props):H.props,ue=te&&te[ie["".concat(W,"Id")]];return I.cloneElement(H,vt(vt({},ue),{},{className:Jr(W,ue.className),key:H.key||"".concat(Z,"-").concat(re),ticks:Cc(ue,!0)}))}),vr(F,"renderPolarGrid",function(H){var Z=H.props,re=Z.radialLines,W=Z.polarAngles,te=Z.polarRadius,oe=F.state,ie=oe.radiusAxisMap,ue=oe.angleAxisMap,_e=Zu(ie),xe=Zu(ue),be=xe.cx,Ae=xe.cy,me=xe.innerRadius,ke=xe.outerRadius;return I.cloneElement(H,{polarAngles:Array.isArray(W)?W:Cc(xe,!0).map(function(Ne){return Ne.coordinate}),polarRadius:Array.isArray(te)?te:Cc(_e,!0).map(function(Ne){return Ne.coordinate}),cx:be,cy:Ae,innerRadius:me,outerRadius:ke,key:H.key||"polar-grid",radialLines:re})}),vr(F,"renderLegend",function(){var H=F.state.formattedGraphicalItems,Z=F.props,re=Z.children,W=Z.width,te=Z.height,oe=F.props.margin||{},ie=W-(oe.left||0)-(oe.right||0),ue=TK({children:re,formattedGraphicalItems:H,legendWidth:ie,legendContent:y});if(!ue)return null;var _e=ue.item,xe=uU(ue,L$e);return I.cloneElement(_e,vt(vt({},xe),{},{chartWidth:W,chartHeight:te,margin:oe,onBBoxUpdate:F.handleLegendBBoxUpdate}))}),vr(F,"renderTooltip",function(){var H,Z=F.props,re=Z.children,W=Z.accessibilityLayer,te=Na(re,kl);if(!te)return null;var oe=F.state,ie=oe.isTooltipActive,ue=oe.activeCoordinate,_e=oe.activePayload,xe=oe.activeLabel,be=oe.offset,Ae=(H=te.props.active)!==null&&H!==void 0?H:ie;return I.cloneElement(te,{viewBox:vt(vt({},be),{},{x:be.left,y:be.top}),active:Ae,label:xe,payload:Ae?_e:[],coordinate:ue,accessibilityLayer:W})}),vr(F,"renderBrush",function(H){var Z=F.props,re=Z.margin,W=Z.data,te=F.state,oe=te.offset,ie=te.dataStartIndex,ue=te.dataEndIndex,_e=te.updateId;return I.cloneElement(H,{key:H.key||"_recharts-brush",onChange:jw(F.handleBrushChange,H.props.onChange),data:W,x:qt(H.props.x)?H.props.x:oe.left,y:qt(H.props.y)?H.props.y:oe.top+oe.height+oe.brushBottom-(re.bottom||0),width:qt(H.props.width)?H.props.width:oe.width,startIndex:ie,endIndex:ue,updateId:"brush-".concat(_e)})}),vr(F,"renderReferenceElement",function(H,Z,re){if(!H)return null;var W=F,te=W.clipPathId,oe=F.state,ie=oe.xAxisMap,ue=oe.yAxisMap,_e=oe.offset,xe=H.type.defaultProps||{},be=H.props,Ae=be.xAxisId,me=Ae===void 0?xe.xAxisId:Ae,ke=be.yAxisId,Ne=ke===void 0?xe.yAxisId:ke;return I.cloneElement(H,{key:H.key||"".concat(Z,"-").concat(re),xAxis:ie[me],yAxis:ue[Ne],viewBox:{x:_e.left,y:_e.top,width:_e.width,height:_e.height},clipPathId:te})}),vr(F,"renderActivePoints",function(H){var Z=H.item,re=H.activePoint,W=H.basePoint,te=H.childIndex,oe=H.isRange,ie=[],ue=Z.props.key,_e=Z.item.type.defaultProps!==void 0?vt(vt({},Z.item.type.defaultProps),Z.item.props):Z.item.props,xe=_e.activeDot,be=_e.dataKey,Ae=vt(vt({index:te,dataKey:be,cx:re.x,cy:re.y,r:4,fill:RO(Z.item),strokeWidth:2,stroke:"#fff",payload:re.payload,value:re.value},Kr(xe,!1)),K1(xe));return ie.push(R.renderActiveDot(xe,Ae,"".concat(ue,"-activePoint-").concat(te))),W?ie.push(R.renderActiveDot(xe,vt(vt({},Ae),{},{cx:W.x,cy:W.y}),"".concat(ue,"-basePoint-").concat(te))):oe&&ie.push(null),ie}),vr(F,"renderGraphicChild",function(H,Z,re){var W=F.filterFormatItem(H,Z,re);if(!W)return null;var te=F.getTooltipEventType(),oe=F.state,ie=oe.isTooltipActive,ue=oe.tooltipAxis,_e=oe.activeTooltipIndex,xe=oe.activeLabel,be=F.props.children,Ae=Na(be,kl),me=W.props,ke=me.points,Ne=me.isRange,Be=me.baseLine,We=W.item.type.defaultProps!==void 0?vt(vt({},W.item.type.defaultProps),W.item.props):W.item.props,ut=We.activeDot,nt=We.hide,Pt=We.activeBar,It=We.activeShape,at=!!(!nt&&ie&&Ae&&(ut||Pt||It)),Ut={};te!=="axis"&&Ae&&Ae.props.trigger==="click"?Ut={onClick:jw(F.handleItemMouseEnter,H.props.onClick)}:te!=="axis"&&(Ut={onMouseLeave:jw(F.handleItemMouseLeave,H.props.onMouseLeave),onMouseEnter:jw(F.handleItemMouseEnter,H.props.onMouseEnter)});var ct=I.cloneElement(H,vt(vt({},W.props),Ut));function gt(ns){return typeof ue.dataKey=="function"?ue.dataKey(ns.payload):null}if(at)if(_e>=0){var it,rt;if(ue.dataKey&&!ue.allowDuplicatedCategory){var rr=typeof ue.dataKey=="function"?gt:"payload.".concat(ue.dataKey.toString());it=X1(ke,rr,xe),rt=Ne&&Be&&X1(Be,rr,xe)}else it=ke==null?void 0:ke[_e],rt=Ne&&Be&&Be[_e];if(It||Pt){var ir=H.props.activeIndex!==void 0?H.props.activeIndex:_e;return[I.cloneElement(H,vt(vt(vt({},W.props),Ut),{},{activeIndex:ir})),null,null]}if(!Hr(it))return[ct].concat(sg(F.renderActivePoints({item:W,activePoint:it,basePoint:rt,childIndex:_e,isRange:Ne})))}else{var or,Sr=(or=F.getItemByXY(F.state.activeCoordinate))!==null&&or!==void 0?or:{graphicalItem:ct},tn=Sr.graphicalItem,Mn=tn.item,vn=Mn===void 0?H:Mn,Zs=tn.childIndex,qi=vt(vt(vt({},W.props),Ut),{},{activeIndex:Zs});return[I.cloneElement(vn,qi),null,null]}return Ne?[ct,null,null]:[ct,null]}),vr(F,"renderCustomized",function(H,Z,re){return I.cloneElement(H,vt(vt({key:"recharts-customized-".concat(re)},F.props),F.state))}),vr(F,"renderMap",{CartesianGrid:{handler:kw,once:!0},ReferenceArea:{handler:F.renderReferenceElement},ReferenceLine:{handler:kw},ReferenceDot:{handler:F.renderReferenceElement},XAxis:{handler:kw},YAxis:{handler:kw},Brush:{handler:F.renderBrush,once:!0},Bar:{handler:F.renderGraphicChild},Line:{handler:F.renderGraphicChild},Area:{handler:F.renderGraphicChild},Radar:{handler:F.renderGraphicChild},RadialBar:{handler:F.renderGraphicChild},Scatter:{handler:F.renderGraphicChild},Pie:{handler:F.renderGraphicChild},Funnel:{handler:F.renderGraphicChild},Tooltip:{handler:F.renderCursor,once:!0},PolarGrid:{handler:F.renderPolarGrid,once:!0},PolarAngleAxis:{handler:F.renderPolarAxis},PolarRadiusAxis:{handler:F.renderPolarAxis},Customized:{handler:F.renderCustomized}}),F.clipPathId="".concat((B=L.id)!==null&&B!==void 0?B:eb("recharts"),"-clip"),F.throttleTriggeredAfterMouseMove=EX(F.triggeredAfterMouseMove,(q=L.throttleDelay)!==null&&q!==void 0?q:1e3/60),F.state={},F}return X$e(R,O),q$e(R,[{key:"componentDidMount",value:function(){var B,q;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(B=this.props.margin.left)!==null&&B!==void 0?B:0,top:(q=this.props.margin.top)!==null&&q!==void 0?q:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var B=this.props,q=B.children,F=B.data,H=B.height,Z=B.layout,re=Na(q,kl);if(re){var W=re.props.defaultIndex;if(!(typeof W!="number"||W<0||W>this.state.tooltipTicks.length-1)){var te=this.state.tooltipTicks[W]&&this.state.tooltipTicks[W].value,oe=Ek(this.state,F,W,te),ie=this.state.tooltipTicks[W].coordinate,ue=(this.state.offset.top+H)/2,_e=Z==="horizontal",xe=_e?{x:ie,y:ue}:{y:ie,x:ue},be=this.state.formattedGraphicalItems.find(function(me){var ke=me.item;return ke.type.name==="Scatter"});be&&(xe=vt(vt({},xe),be.props.points[W].tooltipPosition),oe=be.props.points[W].tooltipPayload);var Ae={activeTooltipIndex:W,isTooltipActive:!0,activeLabel:te,activePayload:oe,activeCoordinate:xe};this.setState(Ae),this.renderCursor(re),this.accessibilityManager.setIndex(W)}}}},{key:"getSnapshotBeforeUpdate",value:function(B,q){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==q.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==B.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==B.margin){var F,H;this.accessibilityManager.setDetails({offset:{left:(F=this.props.margin.left)!==null&&F!==void 0?F:0,top:(H=this.props.margin.top)!==null&&H!==void 0?H:0}})}return null}},{key:"componentDidUpdate",value:function(B){rN([Na(B.children,kl)],[Na(this.props.children,kl)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var B=Na(this.props.children,kl);if(B&&typeof B.props.shared=="boolean"){var q=B.props.shared?"axis":"item";return s.indexOf(q)>=0?q:o}return o}},{key:"getMouseInfo",value:function(B){if(!this.container)return null;var q=this.container,F=q.getBoundingClientRect(),H=tke(F),Z={chartX:Math.round(B.pageX-H.left),chartY:Math.round(B.pageY-H.top)},re=F.width/q.offsetWidth||1,W=this.inRange(Z.chartX,Z.chartY,re);if(!W)return null;var te=this.state,oe=te.xAxisMap,ie=te.yAxisMap,ue=this.getTooltipEventType(),_e=fU(this.state,this.props.data,this.props.layout,W);if(ue!=="axis"&&oe&&ie){var xe=Zu(oe).scale,be=Zu(ie).scale,Ae=xe&&xe.invert?xe.invert(Z.chartX):null,me=be&&be.invert?be.invert(Z.chartY):null;return vt(vt({},Z),{},{xValue:Ae,yValue:me},_e)}return _e?vt(vt({},Z),_e):null}},{key:"inRange",value:function(B,q){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,H=this.props.layout,Z=B/F,re=q/F;if(H==="horizontal"||H==="vertical"){var W=this.state.offset,te=Z>=W.left&&Z<=W.left+W.width&&re>=W.top&&re<=W.top+W.height;return te?{x:Z,y:re}:null}var oe=this.state,ie=oe.angleAxisMap,ue=oe.radiusAxisMap;if(ie&&ue){var _e=Zu(ie);return $$({x:Z,y:re},_e)}return null}},{key:"parseEventsOfWrapper",value:function(){var B=this.props.children,q=this.getTooltipEventType(),F=Na(B,kl),H={};F&&q==="axis"&&(F.props.trigger==="click"?H={onClick:this.handleClick}:H={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var Z=K1(this.props,this.handleOuterEvent);return vt(vt({},Z),H)}},{key:"addListener",value:function(){aP.on(oP,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){aP.removeListener(oP,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(B,q,F){for(var H=this.state.formattedGraphicalItems,Z=0,re=H.length;Z<re;Z++){var W=H[Z];if(W.item===B||W.props.key===B.key||q===kc(W.item.type)&&F===W.childIndex)return W}return null}},{key:"renderClipPath",value:function(){var B=this.clipPathId,q=this.state.offset,F=q.left,H=q.top,Z=q.height,re=q.width;return je.createElement("defs",null,je.createElement("clipPath",{id:B},je.createElement("rect",{x:F,y:H,height:Z,width:re})))}},{key:"getXScales",value:function(){var B=this.state.xAxisMap;return B?Object.entries(B).reduce(function(q,F){var H=cU(F,2),Z=H[0],re=H[1];return vt(vt({},q),{},vr({},Z,re.scale))},{}):null}},{key:"getYScales",value:function(){var B=this.state.yAxisMap;return B?Object.entries(B).reduce(function(q,F){var H=cU(F,2),Z=H[0],re=H[1];return vt(vt({},q),{},vr({},Z,re.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(B){var q;return(q=this.state.xAxisMap)===null||q===void 0||(q=q[B])===null||q===void 0?void 0:q.scale}},{key:"getYScaleByAxisId",value:function(B){var q;return(q=this.state.yAxisMap)===null||q===void 0||(q=q[B])===null||q===void 0?void 0:q.scale}},{key:"getItemByXY",value:function(B){var q=this.state,F=q.formattedGraphicalItems,H=q.activeItem;if(F&&F.length)for(var Z=0,re=F.length;Z<re;Z++){var W=F[Z],te=W.props,oe=W.item,ie=oe.type.defaultProps!==void 0?vt(vt({},oe.type.defaultProps),oe.props):oe.props,ue=kc(oe.type);if(ue==="Bar"){var _e=(te.data||[]).find(function(me){return k3e(B,me)});if(_e)return{graphicalItem:W,payload:_e}}else if(ue==="RadialBar"){var xe=(te.data||[]).find(function(me){return $$(B,me)});if(xe)return{graphicalItem:W,payload:xe}}else if(I2(W,H)||O2(W,H)||j0(W,H)){var be=O4e({graphicalItem:W,activeTooltipItem:H,itemData:ie.data}),Ae=ie.activeIndex===void 0?be:ie.activeIndex;return{graphicalItem:vt(vt({},W),{},{childIndex:Ae}),payload:j0(W,H)?ie.data[be]:W.props.data[be]}}}return null}},{key:"render",value:function(){var B=this;if(!jz(this))return null;var q=this.props,F=q.children,H=q.className,Z=q.width,re=q.height,W=q.style,te=q.compact,oe=q.title,ie=q.desc,ue=uU(q,B$e),_e=Kr(ue,!1);if(te)return je.createElement(zF,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},je.createElement(iN,lm({},_e,{width:Z,height:re,title:oe,desc:ie}),this.renderClipPath(),Pz(F,this.renderMap)));if(this.props.accessibilityLayer){var xe,be;_e.tabIndex=(xe=this.props.tabIndex)!==null&&xe!==void 0?xe:0,_e.role=(be=this.props.role)!==null&&be!==void 0?be:"application",_e.onKeyDown=function(me){B.accessibilityManager.keyboardEvent(me)},_e.onFocus=function(){B.accessibilityManager.focus()}}var Ae=this.parseEventsOfWrapper();return je.createElement(zF,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},je.createElement("div",lm({className:Jr("recharts-wrapper",H),style:vt({position:"relative",cursor:"default",width:Z,height:re},W)},Ae,{ref:function(ke){B.container=ke}}),je.createElement(iN,lm({},_e,{width:Z,height:re,title:oe,desc:ie,style:eFe}),this.renderClipPath(),Pz(F,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(I.Component);vr(k,"displayName",r),vr(k,"defaultProps",vt({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},_)),vr(k,"getDerivedStateFromProps",function(O,R){var L=O.dataKey,B=O.data,q=O.children,F=O.width,H=O.height,Z=O.layout,re=O.stackOffset,W=O.margin,te=R.dataStartIndex,oe=R.dataEndIndex;if(R.updateId===void 0){var ie=pU(O);return vt(vt(vt({},ie),{},{updateId:0},C(vt(vt({props:O},ie),{},{updateId:0}),R)),{},{prevDataKey:L,prevData:B,prevWidth:F,prevHeight:H,prevLayout:Z,prevStackOffset:re,prevMargin:W,prevChildren:q})}if(L!==R.prevDataKey||B!==R.prevData||F!==R.prevWidth||H!==R.prevHeight||Z!==R.prevLayout||re!==R.prevStackOffset||!ym(W,R.prevMargin)){var ue=pU(O),_e={chartX:R.chartX,chartY:R.chartY,isTooltipActive:R.isTooltipActive},xe=vt(vt({},fU(R,B,Z)),{},{updateId:R.updateId+1}),be=vt(vt(vt({},ue),_e),xe);return vt(vt(vt({},be),C(vt({props:O},be),R)),{},{prevDataKey:L,prevData:B,prevWidth:F,prevHeight:H,prevLayout:Z,prevStackOffset:re,prevMargin:W,prevChildren:q})}if(!rN(q,R.prevChildren)){var Ae,me,ke,Ne,Be=Na(q,Xm),We=Be&&(Ae=(me=Be.props)===null||me===void 0?void 0:me.startIndex)!==null&&Ae!==void 0?Ae:te,ut=Be&&(ke=(Ne=Be.props)===null||Ne===void 0?void 0:Ne.endIndex)!==null&&ke!==void 0?ke:oe,nt=We!==te||ut!==oe,Pt=!Hr(B),It=Pt&&!nt?R.updateId:R.updateId+1;return vt(vt({updateId:It},C(vt(vt({props:O},R),{},{updateId:It,dataStartIndex:We,dataEndIndex:ut}),R)),{},{prevChildren:q,dataStartIndex:We,dataEndIndex:ut})}return null}),vr(k,"renderActiveDot",function(O,R,L){var B;return I.isValidElement(O)?B=I.cloneElement(O,R):Rr(O)?B=O(R):B=je.createElement(LO,R),je.createElement(gi,{className:"recharts-active-dot",key:L},B)});var N=I.forwardRef(function(R,L){return je.createElement(k,lm({},R,{ref:L}))});return N.displayName=k.displayName,N},dFe=uFe({chartName:"LineChart",GraphicalChild:tg,axisComponents:[{axisType:"xAxis",AxisComp:$2},{axisType:"yAxis",AxisComp:F2}],formatAxisMap:sze});const hFe=()=>{const e=ts(),{signOut:t}=Pd(),[r,n]=I.useState(null),[i,o]=I.useState({totalBookings:0,totalRevenue:0,averageRating:0,popularTables:[],pendingPayouts:0,activeBookings:0,totalTables:0}),[h,s]=I.useState([]),[p,y]=I.useState([]),[b,_]=I.useState(!0),[E,C]=I.useState(null),[k,N]=I.useState(null),O=r==null?void 0:r.id,[R,L]=I.useState(""),B=I.useRef(null),q=I.useRef(null);console.log("Dashboard currentUser (top-level):",k),I.useEffect(()=>(F(),Z(),q.current=setInterval(()=>{k&&!b&&(console.log("Auto-refreshing dashboard data..."),H(!0))},6e4),()=>{W(),q.current&&clearInterval(q.current)}),[]);const F=async()=>{try{const{data:{session:oe},error:ie}=await Ve.auth.getSession();if(ie)throw ie;if(!oe){console.log("No session found, redirecting to login..."),Mr({title:"Authentication Required",description:"Please log in to access the dashboard",variant:"destructive"}),e("/venue-owner/login");return}const{data:{user:ue},error:_e}=await Ve.auth.getUser();if(_e)throw _e;const{data:xe,error:be}=await Ve.from("venue_owners").select("*").eq("user_id",ue.id).single();if(be||!xe){console.log("User is not a venue owner, redirecting to register..."),Mr({title:"Venue Owner Account Required",description:"Please register as a venue owner to access the dashboard",variant:"destructive"}),e("/venue-owner/register");return}H()}catch(oe){console.error("Auth check error:",oe),C(oe.message),Mr({title:"Error",description:"Failed to verify authentication",variant:"destructive"})}},H=async(oe=!1)=>{try{console.log("Fetching venue data..."),_(!0),C(null);const{data:{user:ie},error:ue}=await Ve.auth.getUser();if(ue)throw console.error("User fetch error:",ue),ue;N(ie);const{data:_e,error:xe}=await Ve.from("venues").select("*").eq("owner_id",ie.id).single();if(xe)throw console.error("Venue fetch error:",xe),xe;n(_e),await te([_e.id]);const{data:be,error:Ae}=await Ve.from("bookings").select("*").eq("venue_id",_e.id);if(Ae)throw console.error("Bookings fetch error:",Ae),Ae;const me=be.length,ke=be.reduce((at,Ut)=>at+(Ut.total_amount||0),0),Ne=be.filter(at=>["pending","confirmed"].includes(at.status)).length,Be=be.sort((at,Ut)=>new Date(Ut.created_at)-new Date(at.created_at)).slice(0,5),We=new Date;We.setDate(We.getDate()-7);const ut=be.filter(at=>new Date(at.created_at)>=We),nt=[];for(let at=6;at>=0;at--){const Ut=new Date;Ut.setDate(Ut.getDate()-at);const ct=ut.filter(gt=>new Date(gt.created_at).toDateString()===Ut.toDateString());nt.push({date:Ut.toLocaleDateString("en-US",{month:"short",day:"numeric"}),bookings:ct.length,revenue:ct.reduce((gt,it)=>gt+(it.total_amount||0),0)})}const{data:Pt,error:It}=await Ve.from("venue_tables").select("*").eq("venue_id",_e.id);if(It)throw console.error("Tables fetch error:",It),It;o({totalBookings:me,totalRevenue:ke,averageRating:_e.rating||0,popularTables:[],pendingPayouts:ke*.1,activeBookings:Ne,totalTables:Pt.length}),s(Be),y(nt)}catch(ie){console.error("Error fetching venue data:",ie),oe||(C(ie.message),Mr({title:"Error",description:"Failed to load dashboard data",variant:"destructive"}))}finally{_(!1)}},Z=async()=>{var oe;try{const{data:{user:ie}}=await Ve.auth.getUser();if(ie){const{data:ue}=await Ve.from("venue_owners").select("venues(name)").eq("user_id",ie.id).single();(oe=ue==null?void 0:ue.venues)!=null&&oe.name&&L(`Welcome back! You are logged in as the owner of ${ue.venues.name}`)}}catch(ie){console.error("Error fetching venue login message:",ie)}},re=async()=>{try{await t(),e("/venue-owner/login"),Mr({title:"Logged Out",description:"You have been successfully logged out"})}catch(oe){console.error("Logout error:",oe),Mr({title:"Error",description:"Failed to log out",variant:"destructive"})}},W=()=>{B.current&&(console.log("Cleaning up dashboard real-time subscription..."),B.current.unsubscribe(),B.current=null)},te=async oe=>{if(W(),!oe||oe.length===0){console.log("No venue IDs provided for dashboard subscription");return}console.log("Setting up dashboard real-time subscription for venues:",oe);try{B.current=Ve.channel("dashboard-bookings-changes").on("postgres_changes",{event:"*",schema:"public",table:"bookings",filter:`venue_id=in.(${oe.join(",")})`},ie=>{console.log("Real-time booking change detected in dashboard:",ie),setTimeout(()=>{k&&H(!0)},1e3)}).subscribe(ie=>{console.log("Dashboard subscription status:",ie),ie==="SUBSCRIBED"&&console.log("Successfully subscribed to dashboard real-time updates")})}catch(ie){console.error("Error setting up dashboard real-time subscription:",ie)}};return b?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):E?l.jsx("div",{className:"container mx-auto px-4 py-8",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[l.jsx("h2",{className:"text-red-800 font-semibold mb-2",children:"Error Loading Dashboard"}),l.jsx("p",{className:"text-red-600",children:E}),l.jsx("button",{onClick:H,className:"mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors",children:"Retry"})]})}):!r&&!b?l.jsxs("div",{className:"container mx-auto px-4 py-8",children:[l.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[l.jsx("h2",{className:"text-yellow-800 font-semibold mb-2",children:"No Venue Found"}),l.jsx("p",{className:"text-yellow-600",children:"You haven't created a venue yet, or your venue is not associated with your account."}),l.jsx("a",{href:"/venue-owner/register",className:"mt-4 inline-block bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 transition-colors",children:"Create Venue"})]}),l.jsxs("pre",{className:"mt-4 bg-gray-100 p-2 rounded text-xs text-gray-700 overflow-x-auto",children:["Debug Info: userId=",(k==null?void 0:k.id)||"N/A"]})]}):l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsxs("div",{className:"container py-8",children:[R&&l.jsx("div",{className:"mb-6 p-4 rounded bg-green-50 border border-green-200 text-green-800 text-center",children:R}),l.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0 mb-6 sm:mb-8",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-heading text-brand-burgundy mb-2",children:"Venue Dashboard"}),l.jsx("p",{className:"text-sm sm:text-base text-brand-burgundy/70",children:"Manage your venue, bookings, and revenue"})]}),l.jsxs("div",{className:"flex flex-col space-y-2 sm:flex-row sm:gap-4 sm:space-y-0",children:[l.jsxs(xt,{variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10 w-full sm:w-auto",onClick:()=>e("/venue-owner/settings"),children:[l.jsx(Yh,{className:"h-4 w-4 mr-2"}),"Settings"]}),l.jsxs(xt,{variant:"outline",className:"border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10 w-full sm:w-auto",onClick:()=>e("/venue-owner/credits"),children:[l.jsx(Sc,{className:"h-4 w-4 mr-2"}),l.jsx("span",{className:"hidden sm:inline",children:"Eddys Members Credits"}),l.jsx("span",{className:"sm:hidden",children:"Credits"})]}),l.jsxs(xt,{variant:"outline",className:"border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10 w-full sm:w-auto",onClick:()=>e("/venue-owner/receipts"),children:[l.jsx(Fp,{className:"h-4 w-4 mr-2"}),l.jsx("span",{className:"hidden sm:inline",children:"Receipt Management"}),l.jsx("span",{className:"sm:hidden",children:"Receipts"})]}),l.jsxs(xt,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90 w-full sm:w-auto",children:[l.jsx(Iie,{className:"h-4 w-4 mr-2"}),l.jsx("span",{className:"hidden sm:inline",children:"Generate QR Code"}),l.jsx("span",{className:"sm:hidden",children:"QR Code"})]}),l.jsxs(xt,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-50 w-full sm:w-auto",onClick:re,children:[l.jsx(mA,{className:"h-4 w-4 mr-2"}),"Log Out"]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsxs(Dr,{className:"flex flex-row items-center justify-between pb-2",children:[l.jsx(Lr,{className:"text-sm font-medium text-brand-burgundy/70",children:"Total Revenue"}),l.jsx(Fc,{className:"h-4 w-4 text-brand-gold"})]}),l.jsxs(Ht,{children:[l.jsxs("div",{className:"text-2xl font-bold text-brand-burgundy",children:["",(i.totalRevenue??0).toLocaleString()]}),l.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"All time earnings"})]})]}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsxs(Dr,{className:"flex flex-row items-center justify-between pb-2",children:[l.jsx(Lr,{className:"text-sm font-medium text-brand-burgundy/70",children:"Pending Payouts"}),l.jsx(vE,{className:"h-4 w-4 text-brand-gold"})]}),l.jsxs(Ht,{children:[l.jsxs("div",{className:"text-2xl font-bold text-brand-burgundy",children:["",(i.pendingPayouts??0).toLocaleString()]}),l.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"Available for withdrawal"})]})]}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsxs(Dr,{className:"flex flex-row items-center justify-between pb-2",children:[l.jsx(Lr,{className:"text-sm font-medium text-brand-burgundy/70",children:"Active Bookings"}),l.jsx(ma,{className:"h-4 w-4 text-brand-gold"})]}),l.jsxs(Ht,{children:[l.jsx("div",{className:"text-2xl font-bold text-brand-burgundy",children:i.activeBookings}),l.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"Current bookings"})]})]}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsxs(Dr,{className:"flex flex-row items-center justify-between pb-2",children:[l.jsx(Lr,{className:"text-sm font-medium text-brand-burgundy/70",children:"Total Tables"}),l.jsx(Die,{className:"h-4 w-4 text-brand-gold"})]}),l.jsxs(Ht,{children:[l.jsx("div",{className:"text-2xl font-bold text-brand-burgundy",children:i.totalTables}),l.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"Available tables"})]})]})]}),l.jsxs(wg,{defaultValue:"bookings",className:"space-y-4",children:[l.jsxs(Sf,{className:"bg-white p-1 rounded-lg border border-brand-burgundy/10",children:[l.jsxs(Ci,{value:"bookings",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[l.jsx(ma,{className:"h-4 w-4 mr-2"}),"Bookings"]}),l.jsxs(Ci,{value:"images",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[l.jsx(pA,{className:"h-4 w-4 mr-2"}),"Images"]}),l.jsxs(Ci,{value:"analytics",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[l.jsx(j8,{className:"h-4 w-4 mr-2"}),"Analytics"]})]}),l.jsx(Pi,{value:"bookings",children:l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsx(Ht,{className:"pt-6",children:l.jsx(cH,{currentUser:k})})})}),l.jsx(Pi,{value:"images",children:l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsx(Ht,{className:"pt-6",children:l.jsx(Bxe,{venueId:O})})})}),l.jsx(Pi,{value:"analytics",children:l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsx(Ht,{className:"pt-6",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-4",children:"Booking Trends (Last 7 Days)"}),l.jsx("div",{className:"h-64",children:l.jsx(XNe,{width:"100%",height:"100%",children:l.jsxs(dFe,{data:p,children:[l.jsx(yZ,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),l.jsx($2,{dataKey:"date",stroke:"#6b7280",fontSize:12}),l.jsx(F2,{stroke:"#6b7280",fontSize:12}),l.jsx(kl,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),l.jsx(tg,{type:"monotone",dataKey:"bookings",stroke:"#8b5cf6",strokeWidth:2,dot:{fill:"#8b5cf6",strokeWidth:2,r:4}}),l.jsx(tg,{type:"monotone",dataKey:"revenue",stroke:"#f59e0b",strokeWidth:2,dot:{fill:"#f59e0b",strokeWidth:2,r:4}})]})})})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-4",children:"Recent Bookings"}),l.jsx("div",{className:"space-y-3",children:h.map(oe=>l.jsxs("div",{className:"flex justify-between items-center p-3 bg-brand-cream/30 rounded-lg",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"font-medium text-brand-burgundy",children:["Booking #",oe.id.slice(0,8),"..."]}),l.jsx("div",{className:"text-sm text-brand-burgundy/60",children:new Date(oe.booking_date).toLocaleDateString()})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"font-semibold text-brand-gold",children:["",(oe.total_amount||0).toLocaleString()]}),l.jsx("div",{className:"text-xs text-brand-burgundy/60",children:oe.status})]})]},oe.id))})]})]})})})})]}),l.jsx(wd,{children:l.jsxs(qc,{"aria-describedby":"add-table-desc",children:[l.jsx(Wc,{children:l.jsx(Gc,{children:"Add New Table"})}),l.jsx("div",{id:"add-table-desc",className:"sr-only",children:"Fill out the form below to add a new table to your venue."})]})})]})})},OZ=async e=>{try{console.log(" Sending venue owner application approved email to:",e.email);const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"venue-owner-application-approved",data:{email:e.email,contactName:e.contact_name||e.owner_name,venueName:e.venue_name,venueType:e.venue_type||"Restaurant",venueAddress:e.venue_address,venueCity:e.venue_city,registrationUrl:`${window.location.origin}/venue-owner/register?approved=true&email=${encodeURIComponent(e.email)}`}}});if(r)throw console.warn(" Edge Function failed, trying EmailJS fallback...",r),r;return console.log(" Venue owner application approved email sent successfully via Edge Function:",t),t}catch{console.log(" Falling back to EmailJS for approval email...");try{const r="service_55v7svp",n={}.VITE_EMAILJS_VENUE_OWNER_APPROVAL_TEMPLATE,i="_DltRvDA4UAiyUt1E";if(!r||!n||!i)throw new Error("EmailJS configuration missing");const{default:o}=await Os(()=>Promise.resolve().then(()=>Ef),void 0);o.init(i);const h=await o.send(r,n,{email:e.email,to_name:e.contact_name||e.owner_name,from_name:"VIPClub",venue_name:e.venue_name,venue_type:e.venue_type||"Restaurant",venue_address:e.venue_address,venue_city:e.venue_city,owner_name:e.contact_name||e.owner_name,application_date:new Date().toLocaleDateString(),registration_url:`${window.location.origin}/venue-owner/register?approved=true&email=${encodeURIComponent(e.email)}`});return console.log(" Approval email sent via EmailJS fallback:",h),h}catch(r){throw console.error(" Both Edge Function and EmailJS fallback failed:",r),r}}},RZ=async e=>{try{console.log(" Sending venue owner registration complete email to:",e.email);const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"venue-owner-signup-complete",data:{email:e.email,ownerName:e.owner_name,venueName:e.venue_name,venueType:e.venue_type||"Restaurant",venueAddress:e.venue_address,venueCity:e.venue_city,dashboardUrl:`${window.location.origin}/venue-owner/dashboard`,loginUrl:`${window.location.origin}/venue-owner/login`}}});if(r)throw console.warn(" Edge Function failed, trying EmailJS fallback...",r),r;return console.log(" Venue owner registration complete email sent successfully via Edge Function:",t),t}catch{console.log(" Falling back to EmailJS for registration complete email...");try{const r="service_55v7svp",n={}.VITE_EMAILJS_VENUE_OWNER_WELCOME_TEMPLATE,i="_DltRvDA4UAiyUt1E";if(!r||!n||!i)throw new Error("EmailJS configuration missing");const{default:o}=await Os(()=>Promise.resolve().then(()=>Ef),void 0);o.init(i);const h=await o.send(r,n,{email:e.email,to_name:e.owner_name,from_name:"VIPClub",venue_name:e.venue_name,venue_type:e.venue_type||"Restaurant",venue_address:e.venue_address,venue_city:e.venue_city,owner_name:e.owner_name,dashboard_url:`${window.location.origin}/venue-owner/dashboard`,login_url:`${window.location.origin}/venue-owner/login`});return console.log(" Registration complete email sent via EmailJS fallback:",h),h}catch(r){throw console.error(" Both Edge Function and EmailJS fallback failed:",r),r}}},DZ=async e=>{try{console.log(" Sending venue owner password reset email to:",e.email);const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"venue-owner-password-reset",data:{email:e.email,ownerName:e.owner_name,venueName:e.venue_name,resetUrl:`${window.location.origin}/venue-owner/reset-password?email=${encodeURIComponent(e.email)}`}}});if(r)throw console.error(" Failed to send password reset email:",r),r;return console.log(" Venue owner password reset email sent successfully:",t),t}catch(t){throw console.error(" Error in sendVenueOwnerPasswordReset:",t),t}},fFe=async e=>{try{console.log(" Sending venue owner email confirmation to:",e.email);const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"venue-owner-email-confirmation",data:{email:e.email,ownerName:e.owner_name,venueName:e.venue_name,confirmationUrl:`${window.location.origin}/venue-owner/confirm-email?email=${encodeURIComponent(e.email)}`}}});if(r)throw console.error(" Failed to send email confirmation:",r),r;return console.log(" Venue owner email confirmation sent successfully:",t),t}catch(t){throw console.error(" Error in sendVenueOwnerEmailConfirmation:",t),t}},LZ=async e=>{try{console.log(" Notifying admin of venue owner registration");const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"admin-venue-owner-registration",data:{adminEmail:"sales@oneeddy.com",ownerName:e.owner_name,email:e.email,phone:e.phone,venueName:e.venue_name,venueType:e.venue_type,venueAddress:e.venue_address,venueCity:e.venue_city,adminUrl:`${window.location.origin}/admin/venue-approvals`}}});if(r)throw console.warn(" Edge Function failed, trying EmailJS fallback...",r),r;return console.log(" Admin notification sent successfully via Edge Function:",t),t}catch{console.log(" Falling back to EmailJS for admin notification...");try{const r="service_55v7svp",n={}.VITE_EMAILJS_VENUE_OWNER_REQUEST_TEMPLATE,i="_DltRvDA4UAiyUt1E";if(!r||!n||!i)throw new Error("EmailJS configuration missing");const{default:o}=await Os(()=>Promise.resolve().then(()=>Ef),void 0);o.init(i);const h=await o.send(r,n,{email:"sales@oneeddy.com",to_name:"Admin",from_name:"VIPClub System",subject:"New Venue Owner Registration",ownerName:e.owner_name,ownerEmail:e.email,ownerPhone:e.phone||"Not provided",venueName:e.venue_name,venueType:e.venue_type||"Restaurant",venueAddress:e.venue_address,venueCity:e.venue_city,applicationDate:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})});return console.log(" Admin notification sent via EmailJS fallback:",h),h}catch(r){throw console.error(" Both Edge Function and EmailJS fallback failed:",r),r}}},pFe=async e=>{try{console.log(" Attempting to send approval email via Edge Function...");const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"venue-owner-invitation",data:{email:e.email,contactName:e.contact_name||e.owner_name,venueName:e.venue_name,venueType:e.venue_type||"Restaurant",venueAddress:e.venue_address,venueCity:e.venue_city}}});if(r)throw console.warn(" Edge Function failed, trying EmailJS fallback...",r),r;return console.log(" Approval email sent via Edge Function:",t),t}catch{console.log(" Falling back to EmailJS for approval email...");try{const r="service_55v7svp",n={}.VITE_EMAILJS_VENUE_OWNER_APPROVAL_TEMPLATE,i="_DltRvDA4UAiyUt1E";if(!r||!n||!i)throw new Error("EmailJS configuration missing");const{default:o}=await Os(()=>Promise.resolve().then(()=>Ef),void 0);o.init(i);const h=await o.send(r,n,{email:e.email,to_name:e.contact_name||e.owner_name,from_name:"VIPClub",venue_name:e.venue_name,venue_type:e.venue_type||"Restaurant",venue_address:e.venue_address,venue_city:e.venue_city,owner_name:e.contact_name||e.owner_name,application_date:new Date().toLocaleDateString()});return console.log(" Approval email sent via EmailJS fallback:",h),h}catch(r){throw console.error(" Both Edge Function and EmailJS fallback failed:",r),r}}},BZ=async(e="test@example.com")=>{console.log(" Testing venue owner email templates...");const t={email:e,ownerName:"Test Owner",contactName:"Test Contact",phone:"+234 123 456 7890",venueName:"Test Venue",venueType:"Restaurant",venueAddress:"123 Test Street",venueCity:"Lagos"};try{return console.log(" Testing application approved email..."),await OZ(t),console.log(" Testing registration complete email..."),await RZ(t),console.log(" Testing password reset email..."),await DZ(t),console.log(" All venue owner email tests completed successfully!"),{success:!0}}catch(r){return console.error(" Venue owner email test failed:",r),{success:!1,error:r.message}}};typeof window<"u"&&(window.testVenueOwnerEmails=BZ);const zZ=async()=>{console.log(" Testing email service configuration...");const e={emailjsServiceId:"service_55v7svp",emailjsPublicKey:"_DltRvDA4UAiyUt1E",venueOwnerApprovalTemplate:{}.VITE_EMAILJS_VENUE_OWNER_APPROVAL_TEMPLATE,venueOwnerWelcomeTemplate:{}.VITE_EMAILJS_VENUE_OWNER_WELCOME_TEMPLATE,venueOwnerRequestTemplate:{}.VITE_EMAILJS_VENUE_OWNER_REQUEST_TEMPLATE};console.log(" Environment Variables:",{serviceId:" Set",publicKey:" Set",approvalTemplate:e.venueOwnerApprovalTemplate?" Set":" Missing",welcomeTemplate:e.venueOwnerWelcomeTemplate?" Set":" Missing",requestTemplate:e.venueOwnerRequestTemplate?" Set":" Missing"});try{console.log(" Testing Edge Function...");const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"test",data:{email:"test@example.com",message:"Test email from Edge Function"}}});r?console.error(" Edge Function test failed:",r):console.log(" Edge Function test successful:",t)}catch(t){console.error(" Edge Function not available:",t)}try{console.log(" Testing EmailJS...");const{default:t}=await Os(()=>Promise.resolve().then(()=>Ef),void 0);e.emailjsPublicKey&&(t.init(e.emailjsPublicKey),console.log(" EmailJS initialized"))}catch(t){console.error(" EmailJS test failed:",t)}return{edgeFunction:"tested",emailjs:e.emailjsPublicKey?"available":"missing_key",templates:{approval:e.venueOwnerApprovalTemplate?"set":"missing",welcome:e.venueOwnerWelcomeTemplate?"set":"missing",request:e.venueOwnerRequestTemplate?"set":"missing"}}};typeof window<"u"&&(window.testEmailConfiguration=zZ);const mFe=Object.freeze(Object.defineProperty({__proto__:null,notifyAdminOfVenueOwnerRegistration:LZ,sendApprovalEmailWithFallback:pFe,sendVenueOwnerApplicationApproved:OZ,sendVenueOwnerEmailConfirmation:fFe,sendVenueOwnerPasswordReset:DZ,sendVenueOwnerRegistrationComplete:RZ,testEmailConfiguration:zZ,testVenueOwnerEmails:BZ},Symbol.toStringTag,{value:"Module"})),gFe=()=>{const e=ts(),{toast:t}=Ui(),[r,n]=I.useState(!1),[i,o]=I.useState({email:"",password:""}),[h,s]=I.useState(null),[p,y]=I.useState(!1),b=async N=>{N.preventDefault(),n(!0),s(null);try{console.log(" Starting login process for:",i.email),console.log(" Login attempt:",{email:i.email,passwordLength:i.password.length,hasPassword:!!i.password});const{data:O,error:R}=await Ve.auth.signInWithPassword({email:i.email,password:i.password});if(console.log(" Auth result:",{data:O,error:R}),R)throw console.error(" Authentication failed:",R),R;if(!O.user)throw console.error(" No user data returned"),new Error("No user data returned from authentication");console.log(" Authentication successful for user:",O.user.id),console.log(" User details:",{id:O.user.id,email:O.user.email,emailConfirmed:!!O.user.email_confirmed_at,lastSignIn:O.user.last_sign_in_at}),console.log(" Checking venue owner status...");const{data:L,error:B}=await Ve.from("venue_owners").select("*").eq("user_id",O.user.id).single();if(console.log(" Venue owner check result:",{venueOwner:L,venueOwnerError:B}),B)throw console.error(" Venue owner lookup failed:",B),new Error("Venue owner profile not found");if(!L)throw console.error(" No venue owner record found"),new Error("No venue owner profile found for this user");if(console.log(" Venue owner found:",{id:L.id,email:L.owner_email,status:L.status,name:L.owner_name}),L.status!=="active")throw console.error(" Venue owner not active:",L.status),new Error(`Venue owner account is ${L.status}. Please contact support.`);console.log(" Login successful! Redirecting to dashboard..."),e("/venue-owner/dashboard")}catch(O){console.error(" Login error:",O),O.message==="Invalid login credentials"?s('Invalid email or password. If you recently registered, please check your email for a confirmation link and click it before logging in. You can also use the "Resend confirmation email" button below.'):O.message.includes("Email not confirmed")?s(`Please check your email and click the confirmation link before logging in. If you didn't receive the email, use the "Resend confirmation email" button below.`):O.message.includes("Invalid login credentials")?s("Invalid email or password. If you recently registered, please check your email for a confirmation link and click it before logging in."):s(O.message||"Login failed"),t({title:"Login Failed",description:'If you recently registered, please check your email for a confirmation link. Use the "Debug Account Status" button to check your account status.',variant:"destructive"})}finally{n(!1)}},_=N=>{const{name:O,value:R}=N.target;o(L=>({...L,[O]:R}))},E=async()=>{if(!i.email){s("Please enter your email address first"),t({title:"Email Required",description:"Please enter your email address to reset your password.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)){s("Please enter a valid email address"),t({title:"Invalid Email",description:"Please enter a valid email address.",variant:"destructive"});return}try{n(!0),s(null),console.log(" Sending password reset email to:",i.email),console.log(" Redirect URL:",`${window.location.origin}/venue-owner/reset-password`);const{error:O}=await Ve.auth.resetPasswordForEmail(i.email,{redirectTo:`${window.location.origin}/venue-owner/reset-password`});if(O)throw O;t({title:"Password Reset Email Sent",description:"Check your email for password reset instructions. Click the link in the email to reset your password. If you don't see it, check your spam folder.",variant:"default"}),s(null),console.log(" Password reset email sent successfully"),t({title:"Important",description:"After clicking the reset link, you will be taken to a password reset page. If you are redirected to the home page, please check the URL for any error messages.",variant:"default"})}catch(O){console.error(" Password reset error:",O),s(O.message||"Failed to send password reset email"),t({title:"Error",description:O.message||"Failed to send password reset email. Please try again.",variant:"destructive"})}finally{n(!1)}},C=async()=>{if(!i.email){s("Please enter your email address first");return}try{n(!0),s(null),console.log(" Resending confirmation email to:",i.email);const{error:N}=await Ve.auth.resend({type:"signup",email:i.email,options:{emailRedirectTo:`${window.location.origin}/venue-owner/login`}});if(N)throw N;t({title:"Confirmation Email Sent",description:"Check your email for the confirmation link. If you don't see it, check your spam folder.",variant:"default"}),s(null),console.log(" Confirmation email resent successfully")}catch(N){console.error(" Resend confirmation error:",N),s(N.message||"Failed to resend confirmation email"),t({title:"Error",description:N.message||"Failed to resend confirmation email. Please try again.",variant:"destructive"})}finally{n(!1)}},k=async()=>{try{console.log(" Debugging venue owner status...");const{data:{user:N},error:O}=await Ve.auth.getUser();if(console.log(" Current user:",N,"User Error:",O),N){const{data:Z,error:re}=await Ve.from("venue_owners").select("*").eq("user_id",N.id);console.log(" Venue owners for user:",Z,"Error:",re);const{data:W,error:te}=await Ve.from("venue_owners").select("*").eq("owner_email",i.email);console.log(" Venue owners by email:",W,"Error:",te)}const{data:R,error:L}=await Ve.from("venue_owners").select("*").eq("owner_email",i.email);console.log(" Venue owners by email:",R,"Error:",L);const{data:B,error:q}=await Ve.from("pending_venue_owner_requests").select("*").eq("email",i.email);console.log(" Pending requests:",B,"Error:",q);const{data:F,error:H}=await Ve.from("venues").select("*").eq("contact_email",i.email);console.log(" Venues by email:",F,"Error:",H),console.log(" DEBUG SUMMARY:"),console.log("   - Auth user check: Use Supabase Auth API (cannot query auth.users directly)"),console.log("   - Venue owners found:",(R==null?void 0:R.length)||0),console.log("   - Venues found:",(F==null?void 0:F.length)||0),console.log("   - Pending requests:",(B==null?void 0:B.length)||0)}catch(N){console.error(" Debug error:",N)}};return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-4 px-4 sm:py-12 sm:px-6 lg:px-8",children:l.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full space-y-6 sm:space-y-8 bg-white p-6 sm:p-8 rounded-xl shadow-lg",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(tt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},className:"mx-auto h-10 w-10 sm:h-12 sm:w-12 bg-brand-burgundy/10 rounded-full flex items-center justify-center",children:l.jsx(yd,{className:"h-5 w-5 sm:h-6 sm:w-6 text-brand-burgundy"})}),l.jsx("h2",{className:"mt-4 sm:mt-6 text-2xl sm:text-3xl font-heading text-brand-burgundy",children:"Welcome Back"}),l.jsx("p",{className:"mt-2 text-sm text-brand-burgundy/70",children:"Sign in to manage your venue"})]}),l.jsxs("form",{className:"mt-6 sm:mt-8 space-y-4 sm:space-y-6",onSubmit:b,children:[l.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"email",className:"text-brand-burgundy",children:"Email Address"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Vx,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:i.email,onChange:_,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your email"})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"password",className:"text-brand-burgundy",children:"Password"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Ux,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"password",name:"password",type:p?"text":"password",autoComplete:"current-password",required:!0,value:i.password,onChange:_,className:"pl-10 pr-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your password"}),l.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>y(!p),children:p?l.jsx(Zh,{className:"h-5 w-5 text-brand-burgundy/50 hover:text-brand-burgundy"}):l.jsx(cl,{className:"h-5 w-5 text-brand-burgundy/50 hover:text-brand-burgundy"})})]})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-brand-burgundy border-brand-burgundy/20 rounded focus:ring-brand-burgundy"}),l.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-brand-burgundy/70",children:"Remember me"})]}),l.jsx("div",{className:"text-sm",children:l.jsx("button",{type:"button",onClick:E,className:"text-brand-burgundy hover:text-brand-gold",children:"Forgot your password?"})})]}),l.jsx("div",{children:l.jsxs(xt,{type:"submit",className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",disabled:r,children:[r?"Signing in...":"Sign in",l.jsx(Bl,{className:"ml-2 h-4 w-4"})]})})]}),l.jsxs("div",{className:"text-center mt-4 sm:mt-6",children:[l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Don't have a venue account?"," ",l.jsx(Nn,{to:"/venue-owner/register",className:"text-brand-burgundy hover:text-brand-gold font-medium",children:"Register your venue"})]}),l.jsxs("div",{className:"mt-3 sm:mt-4 pt-3 sm:pt-4 border-t border-brand-burgundy/10",children:[l.jsx("p",{className:"text-xs text-brand-burgundy/60 mb-2",children:"Having trouble logging in?"}),l.jsxs("div",{className:"space-y-1 sm:space-y-2",children:[l.jsx("button",{type:"button",onClick:C,className:"text-xs text-brand-burgundy/70 hover:text-brand-gold underline block",disabled:r,children:"Resend confirmation email"}),l.jsx("button",{type:"button",onClick:k,className:"text-xs text-brand-burgundy/70 hover:text-brand-gold underline block",disabled:r,children:"Debug Account Status"})]})]})]})]})})},ag=je.forwardRef(({className:e,...t},r)=>l.jsx("textarea",{className:Pr("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));ag.displayName="Textarea";const yFe=()=>{console.log(" VenueOwnerRegister component loaded - this is the CORRECT component");const e=ts();Ui();const[t,r]=I.useState(!1),[n,i]=I.useState(null),[o,h]=I.useState(null),[s,p]=I.useState(!1),[y,b]=I.useState(()=>{const k=localStorage.getItem("venueRegistrationData");return k?JSON.parse(k):{full_name:"",email:"",phone:"",password:"",venue_name:"",venue_description:"",venue_address:"",venue_city:"",venue_country:"",venue_phone:"",venue_email:"",venue_type:"restaurant",opening_hours:"",capacity:"",price_range:"$$"}}),_=async()=>{var k;try{console.log(" Testing Supabase email configuration...");const N="test@example.com",{data:O,error:R}=await Ve.auth.signUp({email:N,password:"testpassword123",options:{emailRedirectTo:`${window.location.origin}/venue-owner/login`}});return R?(console.error(" Supabase email test failed:",R),{success:!1,error:R.message}):(console.log(" Supabase email test successful:",{user:O.user?"User created":"No user",session:O.session?"Session created":"No session",email_confirmed:(k=O.user)!=null&&k.email_confirmed_at?"Already confirmed":"Needs confirmation"}),{success:!0,data:O})}catch(N){return console.error(" Error testing Supabase email:",N),{success:!1,error:N.message}}};I.useEffect(()=>{typeof window<"u"&&(window.testSupabaseEmail=_)},[]),I.useEffect(()=>{localStorage.setItem("venueRegistrationData",JSON.stringify(y))},[y]);const E=k=>{const{name:N,value:O}=k.target;b(R=>({...R,[N]:O}))},C=async k=>{k.preventDefault(),r(!0),i(null),h(null);try{console.log(" Starting venue owner registration process..."),console.log(" Form email:",y.email);const{data:N,error:O}=await Ve.from("venue_owners").select("*").eq("owner_email",y.email).in("status",["pending_owner_signup","active"]);if(console.log(" Existing venues check:",{existingVenues:N,venueCheckError:O}),O)throw O;if(N&&N.length>0){const oe=N[0];if(oe.status==="active"){console.log(" Venue owner already active, redirecting to login..."),i("Account already exists and is active. Please use the login page to access your dashboard."),setTimeout(()=>{e("/venue-owner/login")},3e3);return}console.log(" Found existing approved venue owner record, creating user account..."),console.log(" Creating user account for approved venue owner..."),console.log(" Email being used for signup:",y.email),console.log(" Redirect URL:",`${window.location.origin}/venue-owner/login`);const{data:ie,error:ue}=await Ve.auth.signUp({email:y.email,password:y.password,options:{emailRedirectTo:`${window.location.origin}/venue-owner/login`,data:{full_name:y.full_name,phone:y.phone,venue_name:oe.venue_name}}});if(console.log(" Sign up result:",{user:ie!=null&&ie.user?{id:ie.user.id,email:ie.user.email,email_confirmed_at:ie.user.email_confirmed_at,created_at:ie.user.created_at}:null,session:ie!=null&&ie.session?"Session created":"No session",error:ue}),ue)throw console.error(" User creation failed:",ue),ue;if(!ie.user||!ie.user.id)throw console.error(" No user data returned from signup"),new Error("Failed to create user account");console.log(" User account created successfully:",ie.user.id),await new Promise(me=>setTimeout(me,2e3)),console.log(" Verifying automatic venue owner link...");const{data:_e,error:xe}=await Ve.from("venue_owners").select("*").eq("owner_email",y.email).eq("user_id",ie.user.id).eq("status","active").single();if(xe||!_e){console.warn(" Automatic linking may have failed, attempting manual link...");const{error:me}=await Ve.from("venue_owners").update({user_id:ie.user.id,status:"active",owner_name:y.full_name,owner_phone:y.phone}).eq("owner_email",y.email).eq("status","pending_owner_signup");if(me)throw console.error(" Manual linking also failed:",me),me;console.log(" Manual linking successful")}else console.log(" Automatic linking successful");console.log(" Linking venue to user account...");let{data:be,error:Ae}=await Ve.from("venues").select("*").eq("id",oe.venue_id).single();if(Ae&&Ae.code==="PGRST116"){console.log(" No venue found by contact_email, trying alternative search...");const{data:me}=await Ve.from("venue_owners").select("venue_name, owner_email").eq("owner_email",y.email.trim()).eq("status","active").single();if(me){const{data:ke,error:Ne}=await Ve.from("venues").select("*").eq("name",me.venue_name).ilike("contact_email",y.email.trim()).is("owner_id",null).single();!Ne&&ke&&(be=ke,Ae=null,console.log(" Found venue using alternative search"))}}if(Ae){console.error(" Failed to find venue to link:",Ae);const{data:me}=await Ve.from("venues").select("id, name, contact_email, owner_id").ilike("contact_email",`%${y.email.split("@")[0]}%`);throw console.log(" Available venues for debugging:",me),new Error("Venue not found. Please contact support.")}if(be){console.log(" Found venue to link:",be.id);const{error:me}=await Ve.from("venues").update({owner_id:ie.user.id,updated_at:new Date().toISOString()}).eq("id",be.id);if(me)throw console.error(" Failed to update venue owner_id:",me),me;console.log(" Venue linked to user account successfully");const{error:ke}=await Ve.from("venue_owners").update({venue_id:be.id,updated_at:new Date().toISOString()}).eq("owner_email",y.email.trim()).eq("status","active");ke?console.error(" Failed to update venue_owners with venue_id:",ke):console.log(" Venue owner record updated with venue_id")}else throw console.warn(" No venue found to link - this should not happen"),new Error("Venue linking failed. Please contact support.");try{const me={email:y.email,owner_name:y.full_name,venue_name:oe.venue_name,venue_type:oe.venue_type,venue_address:oe.venue_address,venue_city:oe.venue_city};await LZ(me),console.log(" Admin notification sent successfully")}catch(me){console.error(" Failed to send admin notification email:",me)}ie.user&&!ie.user.email_confirmed_at?(console.log(" Email confirmation required for venue owner"),h("Account created successfully! Please check your email and click the confirmation link before logging in.")):h("Account created successfully! You can now log in to manage your venue."),console.log(" Registration completed successfully"),b({full_name:"",email:"",phone:"",password:"",venue_name:"",venue_description:"",venue_address:"",venue_city:"",venue_country:"",venue_phone:"",venue_email:"",venue_type:"restaurant",opening_hours:"",capacity:"",price_range:"$$"}),localStorage.removeItem("venueRegistrationData");return}console.log(" No existing approved record found, creating new pending request..."),console.log(" Creating user account for new venue owner application...");const{data:R,error:L}=await Ve.auth.signUp({email:y.email,password:y.password,options:{emailRedirectTo:`${window.location.origin}/venue-owner/login`,data:{full_name:y.full_name,phone:y.phone,venue_name:y.venue_name}}});if(L){console.error(" User creation failed:",L),i(`Failed to create account: ${L.message}`);return}if(!R.user||!R.user.id){console.error(" No user data returned from signup"),i("Failed to create user account");return}console.log(" User account created successfully:",R.user.id);const{data:B,error:q}=await Ve.from("venue_owners").insert([{user_id:R.user.id,venue_name:y.venue_name,venue_description:y.venue_description,venue_address:y.venue_address,venue_city:y.venue_city,venue_country:y.venue_country,venue_phone:y.phone,owner_name:y.full_name,owner_email:y.email,owner_phone:y.phone,venue_type:y.venue_type,opening_hours:y.opening_hours||"",capacity:y.capacity||"",price_range:y.price_range||"$$",status:"pending_approval"}]).select().single();if(q){console.error(" Venue owner creation failed:",q),i(`Failed to create venue owner record: ${q.message}`);return}console.log(" Venue owner record created successfully");const F={email:y.email,venue_name:y.venue_name,venue_address:y.venue_address,venue_city:y.venue_city,venue_country:y.venue_country,contact_name:y.full_name,contact_phone:y.phone,additional_info:y.venue_description,venue_type:y.venue_type,opening_hours:y.opening_hours,capacity:y.capacity,price_range:y.price_range,status:"pending",user_id:R.user.id},{data:H,error:Z}=await Ve.from("pending_venue_owner_requests").insert([F]);Z&&console.warn(" Failed to create pending request record:",Z);const re="service_55v7svp",W={}.VITE_EMAILJS_VENUE_OWNER_REQUEST_TEMPLATE,te="_DltRvDA4UAiyUt1E";if(re&&W&&te)try{Ws.init(te),await Ws.send(re,W,{email:"info@oneeddy.com",to_name:"Admin",from_name:"Eddys Members",subject:"New Venue Owner Application",ownerName:y.full_name,ownerEmail:y.email,ownerPhone:y.phone,applicationDate:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),venueName:y.venue_name,venueDescription:y.venue_description,venueType:y.venue_type||"Not specified",venueCapacity:y.capacity||"Not specified",venueAddress:y.venue_address,priceRange:y.price_range||"Not specified",openingHours:y.opening_hours||"Not specified",venuePhone:y.phone}),console.log(" Admin notification email sent")}catch(oe){console.error(" Failed to send admin notification:",oe)}R.user&&!R.user.email_confirmed_at?h("Account created successfully! Please check your email and click the confirmation link to complete your registration. Your venue will be reviewed by our team within 48 hours."):h("Account created successfully! Your venue application has been submitted and will be reviewed by our team within 48 hours.")}catch(N){i(N.message||"An unexpected error occurred."),console.error("Unexpected error:",N)}finally{r(!1)}};return l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsx("div",{className:"container py-8",children:l.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-2xl w-full space-y-8 bg-white p-8 rounded-xl shadow-lg",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(tt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},className:"mx-auto h-12 w-12 bg-brand-burgundy/10 rounded-full flex items-center justify-center",children:l.jsx(yd,{className:"h-6 w-6 text-brand-burgundy"})}),l.jsx("h2",{className:"mt-6 text-3xl font-heading text-brand-burgundy",children:"Register Your Venue"}),l.jsx("p",{className:"mt-2 text-sm text-brand-burgundy/70",children:"Create your venue profile to start managing bookings"}),l.jsx("div",{className:"mt-4 p-4 bg-brand-gold/10 border border-brand-gold/20 rounded-lg",children:l.jsxs("p",{className:"text-sm text-brand-burgundy/80",children:[l.jsx("strong",{children:"How it works:"})," Submit your venue application below. Our team will review it within 48 hours. If approved, you'll receive an email invitation to complete your registration and access your venue dashboard."]})})]}),l.jsxs("form",{className:"mt-8 space-y-6",onSubmit:C,children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-xl font-semibold text-brand-burgundy mb-4",children:"Your Details"}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"full_name",className:"text-brand-burgundy",children:"Full Name"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Kn,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"full_name",name:"full_name",type:"text",required:!0,value:y.full_name,onChange:E,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your full name"})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"email",className:"text-brand-burgundy",children:"Email Address"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Vx,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"email",name:"email",type:"email",required:!0,value:y.email,onChange:E,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your email"})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"password",className:"text-brand-burgundy",children:"Password"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Ux,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"password",name:"password",type:s?"text":"password",required:!0,value:y.password,onChange:E,className:"pl-10 pr-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Create a password"}),l.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>p(!s),children:s?l.jsx(Zh,{className:"h-5 w-5 text-brand-burgundy/50 hover:text-brand-burgundy"}):l.jsx(cl,{className:"h-5 w-5 text-brand-burgundy/50 hover:text-brand-burgundy"})})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"phone",className:"text-brand-burgundy",children:"Phone Number"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Am,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"phone",name:"phone",type:"tel",required:!0,value:y.phone,onChange:E,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter contact number"})]})]})]}),l.jsxs("div",{className:"space-y-4 pt-6 border-t border-brand-burgundy/10",children:[l.jsx("h3",{className:"text-xl font-semibold text-brand-burgundy mb-4",children:"Venue Details"}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"venue_name",className:"text-brand-burgundy",children:"Venue Name"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx($c,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"venue_name",name:"venue_name",type:"text",required:!0,value:y.venue_name,onChange:E,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your venue name"})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"venue_description",className:"text-brand-burgundy",children:"Venue Description"}),l.jsx(ag,{id:"venue_description",name:"venue_description",required:!0,value:y.venue_description,onChange:E,className:"mt-1 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Describe your venue...",rows:4})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"venue_address",className:"text-brand-burgundy",children:"Address"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(qs,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"venue_address",name:"venue_address",type:"text",required:!0,value:y.venue_address,onChange:E,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter venue address"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"venue_city",className:"text-brand-burgundy",children:"City"}),l.jsx(Lt,{id:"venue_city",name:"venue_city",type:"text",required:!0,value:y.venue_city,onChange:E,className:"mt-1 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"e.g., Lagos"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"venue_country",className:"text-brand-burgundy",children:"Country"}),l.jsx(Lt,{id:"venue_country",name:"venue_country",type:"text",required:!0,value:y.venue_country,onChange:E,className:"mt-1 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"e.g., Nigeria"})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"venue_phone",className:"text-brand-burgundy",children:"Venue Phone"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Am,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"venue_phone",name:"venue_phone",type:"tel",required:!0,value:y.venue_phone,onChange:E,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter venue phone"})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"venue_email",className:"text-brand-burgundy",children:"Venue Email"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Vx,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"venue_email",name:"venue_email",type:"email",required:!0,value:y.venue_email,onChange:E,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter venue email"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"capacity",className:"text-brand-burgundy",children:"Capacity (guests)"}),l.jsx(Lt,{id:"capacity",name:"capacity",type:"number",value:y.capacity,onChange:E,className:"mt-1 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"e.g., 100"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"price_range",className:"text-brand-burgundy",children:"Price Range"}),l.jsxs("select",{id:"price_range",name:"price_range",value:y.price_range,onChange:E,className:"mt-1 w-full px-3 py-2 bg-white border border-brand-burgundy/20 rounded-md focus:border-brand-burgundy focus:ring-1 focus:ring-brand-burgundy",children:[l.jsx("option",{value:"$",children:"$ (Budget)"}),l.jsx("option",{value:"$$",children:"$$ (Moderate)"}),l.jsx("option",{value:"$$$",children:"$$$ (Premium)"})]})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"opening_hours",className:"text-brand-burgundy",children:"Opening Hours"}),l.jsx(Lt,{id:"opening_hours",name:"opening_hours",type:"text",value:y.opening_hours,onChange:E,className:"mt-1 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"e.g., Mon-Sun 9AM-11PM"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"venue_type",className:"text-brand-burgundy",children:"Venue Type"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(yd,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsxs("select",{id:"venue_type",name:"venue_type",required:!0,value:y.venue_type,onChange:E,className:"w-full pl-10 pr-3 py-2 bg-white border border-brand-burgundy/20 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-burgundy focus:border-transparent",children:[l.jsx("option",{value:"restaurant",children:"Restaurant"}),l.jsx("option",{value:"bar",children:"Bar"}),l.jsx("option",{value:"club",children:"Club"}),l.jsx("option",{value:"lounge",children:"Lounge"}),l.jsx("option",{value:"other",children:"Other"})]})]})]})]}),l.jsx("div",{children:l.jsxs(xt,{type:"submit",disabled:t,className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:[t?"Registering...":"Register Venue",l.jsx(Bl,{className:"ml-2 h-4 w-4"})]})}),n&&l.jsx("div",{className:"text-red-500 mb-2",children:n}),o&&l.jsx("div",{className:"text-green-600 mb-2",children:o})]}),l.jsx("div",{className:"text-center mt-6",children:l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Already have a venue account?"," ",l.jsx(Nn,{to:"/venue-owner/login",className:"text-brand-burgundy hover:text-brand-gold font-medium",children:"Sign in"})]})})]})})})},gU=()=>{const[e]=EM(),t=ts(),{toast:r}=Ui(),[n,i]=I.useState(!1),[o,h]=I.useState(null),[s,p]=I.useState(!1),[y,b]=I.useState(!1),[_,E]=I.useState(!1),[C,k]=I.useState(null),[N,O]=I.useState(!1),[R,L]=I.useState({password:"",confirmPassword:""});I.useEffect(()=>{const Z=e.get("access_token"),re=e.get("refresh_token"),W=e.get("token"),te=e.get("type");if(console.log(" Reset password page loaded with params:",{accessToken:Z?"Present":"Missing",refreshToken:re?"Present":"Missing",standardToken:W?"Present":"Missing",type:te,allParams:Object.fromEntries(e.entries())}),k({accessToken:Z?"Present":"Missing",refreshToken:re?"Present":"Missing",standardToken:W?"Present":"Missing",type:te,allParams:Object.fromEntries(e.entries())}),W){console.log(" Standard password reset detected"),O(!0);return}if(!Z||!re){console.error(" Missing tokens for password reset"),h("Invalid or missing reset link. Please request a new password reset.");return}(async()=>{try{console.log(" Setting session with tokens...");const{error:ie}=await Ve.auth.setSession({access_token:Z,refresh_token:re});if(ie){console.error(" Session error:",ie),h("Invalid reset link. Please request a new password reset.");return}console.log(" Session set successfully");const{data:{user:ue},error:_e}=await Ve.auth.getUser();if(_e||!ue){console.error(" User verification failed:",_e),h("Unable to verify user. Please request a new password reset.");return}console.log(" User verified:",ue.email)}catch(ie){console.error(" Error setting session:",ie),h("Failed to validate reset link. Please try again.")}})()},[e]);const B=Z=>{L({...R,[Z.target.name]:Z.target.value}),h(null)},q=Z=>{const W=/[A-Z]/.test(Z),te=/[a-z]/.test(Z),oe=/\d/.test(Z),ie=/[!@#$%^&*(),.?":{}|<>]/.test(Z),ue=[];return Z.length<8&&ue.push("At least 8 characters"),W||ue.push("One uppercase letter"),te||ue.push("One lowercase letter"),oe||ue.push("One number"),ie||ue.push("One special character"),ue},F=async Z=>{if(Z.preventDefault(),i(!0),h(null),R.password!==R.confirmPassword){h("Passwords do not match"),i(!1);return}const re=q(R.password);if(re.length>0){h(`Password must contain: ${re.join(", ")}`),i(!1);return}try{let W;if(N){const te=e.get("token");if(!te)throw new Error("Missing reset token");const{data:{user:oe},error:ie}=await Ve.auth.getUser();if(ie||!oe){const{error:ue}=await Ve.auth.verifyOtp({token_hash:te,type:"recovery"});if(ue){h("Invalid or expired reset token. Please request a new password reset."),i(!1);return}}W=await Ve.auth.updateUser({password:R.password})}else W=await Ve.auth.updateUser({password:R.password});if(W.error)throw W.error;p(!0),r({title:"Password Updated",description:"Your password has been successfully updated.",variant:"default"}),setTimeout(()=>{t(N?"/":"/venue-owner/login")},2e3)}catch(W){h(W.message||"Failed to update password"),r({title:"Error",description:W.message||"Failed to update password",variant:"destructive"})}finally{i(!1)}},H=()=>{t(N?"/":"/venue-owner/login")};return s?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:l.jsxs(tt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-lg text-center",children:[l.jsx(tt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},className:"mx-auto h-16 w-16 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx(Pm,{className:"h-8 w-8 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-heading text-gray-900",children:"Password Updated Successfully!"}),l.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Your password has been updated. You will be redirected to the login page shortly."})]}),l.jsxs(xt,{onClick:()=>t(N?"/":"/venue-owner/login"),className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:["Go to Login",l.jsx(Bl,{className:"ml-2 h-4 w-4"})]})]})}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:l.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-lg",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(tt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},className:"mx-auto h-12 w-12 bg-brand-burgundy/10 rounded-full flex items-center justify-center",children:l.jsx(yd,{className:"h-6 w-6 text-brand-burgundy"})}),l.jsx("h2",{className:"mt-6 text-3xl font-heading text-brand-burgundy",children:"Reset Your Password"}),l.jsx("p",{className:"mt-2 text-sm text-brand-burgundy/70",children:"Enter your new password below"})]}),o&&l.jsx(tt.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 rounded-md p-4",children:l.jsxs("div",{className:"flex",children:[l.jsx($0,{className:"h-5 w-5 text-red-400 mr-2 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-red-600",children:o}),l.jsx("button",{onClick:H,className:"text-sm text-red-500 hover:text-red-700 underline mt-1",children:"Request new password reset"})]})]})}),C&&l.jsx(tt.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:l.jsxs("p",{className:"text-xs text-blue-600 font-mono",children:["Debug: ",JSON.stringify(C,null,2)]})}),l.jsxs("form",{className:"mt-8 space-y-6",onSubmit:F,children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"password",className:"text-brand-burgundy",children:"New Password"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Ux,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"password",name:"password",type:y?"text":"password",autoComplete:"new-password",required:!0,value:R.password,onChange:B,className:"pl-10 pr-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your new password"}),l.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>b(!y),children:y?l.jsx(Zh,{className:"h-5 w-5 text-brand-burgundy/50"}):l.jsx(cl,{className:"h-5 w-5 text-brand-burgundy/50"})})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"confirmPassword",className:"text-brand-burgundy",children:"Confirm New Password"}),l.jsxs("div",{className:"mt-1 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Ux,{className:"h-5 w-5 text-brand-burgundy/50"})}),l.jsx(Lt,{id:"confirmPassword",name:"confirmPassword",type:_?"text":"password",autoComplete:"new-password",required:!0,value:R.confirmPassword,onChange:B,className:"pl-10 pr-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Confirm your new password"}),l.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>E(!_),children:_?l.jsx(Zh,{className:"h-5 w-5 text-brand-burgundy/50"}):l.jsx(cl,{className:"h-5 w-5 text-brand-burgundy/50"})})]})]})]}),l.jsx("div",{children:l.jsxs(xt,{type:"submit",className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",disabled:n||!!o,children:[n?"Updating Password...":"Update Password",l.jsx(Bl,{className:"ml-2 h-4 w-4"})]})})]}),l.jsx("div",{className:"text-center mt-6",children:l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Remember your password?"," ",l.jsx("button",{onClick:()=>t(N?"/":"/venue-owner/login"),className:"text-brand-burgundy hover:text-brand-gold font-medium",children:"Back to login"})]})})]})})};function vFe(){const e=ts(),{toast:t}=Ui(),[r,n]=I.useState(null),[i,o]=I.useState(!0);I.useEffect(()=>{h()},[]);const h=async()=>{try{o(!0);const{data:{user:s},error:p}=await Ve.auth.getUser();if(p)throw p;const{data:y,error:b}=await Ve.from("venues").select("*").eq("owner_id",s.id).single();if(b)throw b;n(y),y.status==="approved"?e("/venue-owner/dashboard"):y.status==="rejected"&&t({title:"Venue Rejected",description:"Your venue application has been rejected. Please contact support for more information.",variant:"destructive"})}catch(s){console.error("Error checking venue status:",s),t({title:"Error",description:"Failed to check venue status",variant:"destructive"})}finally{o(!1)}};return i?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):l.jsx("div",{className:"container mx-auto px-4 py-8",children:l.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[l.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Venue Pending Approval"}),l.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-500 mx-auto mb-4"}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Your venue is under review"}),l.jsx("p",{className:"text-gray-600",children:"We're currently reviewing your venue application. This process typically takes 1-2 business days."})]}),r&&l.jsxs("div",{className:"text-left bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Venue Details:"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Name:"})," ",r.name]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Address:"})," ",r.address]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Type:"})," ",r.type]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Submitted:"})," ",new Date(r.created_at).toLocaleDateString()]})]}),l.jsxs("div",{className:"mt-8",children:[l.jsx("p",{className:"text-sm text-gray-500",children:"We'll send you an email once your venue is approved. You can also check back here for updates."}),l.jsx("button",{onClick:h,className:"mt-4 bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-colors",children:"Check Status"})]})]})]})})}const xFe=()=>{const{user:e}=Pd(),[t,r]=I.useState(!0);return I.useEffect(()=>{e&&r(!1)},[e]),t?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold"})}):l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsxs("div",{className:"container px-4 py-4 sm:py-8",children:[l.jsx("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 sm:mb-8 space-y-4 sm:space-y-0",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-heading text-brand-burgundy mb-2",children:"Bookings Management"}),l.jsx("p",{className:"text-sm sm:text-base text-brand-burgundy/70",children:"View and manage all your venue bookings"})]})}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsx(Ht,{className:"p-4 sm:pt-6",children:l.jsx(cH,{currentUser:e})})})]})})},bFe=({currentUser:e})=>{const[t,r]=I.useState([]),[n,i]=I.useState([]),[o,h]=I.useState(!1),[s,p]=I.useState(null),[y,b]=I.useState({table_number:"",capacity:"",price:"",table_type:"",status:"available",venue_id:"",description:""});I.useEffect(()=>{console.log("[TableManagement] currentUser prop:",e)},[e]),I.useEffect(()=>{if(!(e!=null&&e.id))return;(async()=>{console.log("Fetching venues for owner_id:",e.id);const{data:R,error:L}=await Ve.from("venues").select("id, name, owner_id").eq("owner_id",e.id);if(L){Mr({title:"Error",description:L.message,variant:"destructive"}),i([]),r([]);return}console.log("currentUser.id:",e.id),console.log("venuesData:",R),console.log("venuesError:",L),i(R||[]);const B=Array.isArray(R)?R.map(H=>H.id):[];if(!B||B.length===0){r([]);return}const{data:q,error:F}=await Ve.from("venue_tables").select("*").in("venue_id",B);F?(Mr({title:"Error",description:F.message,variant:"destructive"}),r([])):(console.log("tablesData:",q),console.log("tablesError:",F),r(q||[]))})()},[e]);const _=async()=>{if(!y.venue_id){Mr({title:"Error",description:"Please select a venue for this table.",variant:"destructive"});return}if(!y.table_number||!y.capacity||!y.price||!y.table_type||!y.status){Mr({title:"Missing Fields",description:"Please fill all fields",variant:"destructive"});return}const O=parseInt(y.capacity,10),R=parseInt(y.price,10);if(isNaN(O)||isNaN(R)){Mr({title:"Invalid Input",description:"Capacity and Price must be valid numbers.",variant:"destructive"});return}const L={venue_id:y.venue_id,table_number:y.table_number,capacity:O,price:R,table_type:y.table_type,status:y.status,description:y.description};let B;if(s?B=(await Ve.from("venue_tables").update(L).eq("id",s.id)).error:B=(await Ve.from("venue_tables").insert([L])).error,B)Mr({title:"Error",description:`Failed to ${s?"update":"add"} table: ${B.message}`,variant:"destructive"});else{Mr({title:`Table ${s?"Updated":"Added"}`,description:`Table ${s?"updated":"added"} successfully!`}),b({table_number:"",capacity:"",price:"",table_type:"",status:"available",venue_id:"",description:""}),p(null),h(!1);const{data:q}=await Ve.from("venues").select("id").eq("owner_id",e.id),F=q.map(Z=>Z.id),{data:H}=await Ve.from("venue_tables").select("*").in("venue_id",F);r(H||[])}},E=O=>{p(O),b({table_number:O.table_number,capacity:O.capacity.toString(),price:O.price.toString(),table_type:O.table_type,status:O.status,venue_id:O.venue_id,description:O.description||""}),h(!0)},C=async O=>{if(!confirm("Are you sure you want to delete this table?"))return;const{error:R}=await Ve.from("venue_tables").delete().eq("id",O);if(R)Mr({title:"Error",description:`Failed to delete table: ${R.message}`,variant:"destructive"});else{Mr({title:"Table Deleted",description:"Table deleted successfully!"});const{data:L}=await Ve.from("venues").select("id").eq("owner_id",e.id),B=L.map(F=>F.id),{data:q}=await Ve.from("venue_tables").select("*").in("venue_id",B);r(q||[])}},k=O=>{h(O),O||(p(null),b({table_number:"",capacity:"",price:"",table_type:"",status:"available",venue_id:"",description:""}))},N=O=>{switch(O){case"available":return"bg-green-100 text-green-800";case"booked":return"bg-yellow-100 text-yellow-800";case"maintenance":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return console.log("venues in render:",n),l.jsx("div",{className:"space-y-6",children:l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy",children:"Table Management"}),l.jsxs(wd,{open:o,onOpenChange:k,children:[l.jsx(LI,{asChild:!0,children:l.jsxs(xt,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",title:"Add a new table to your venue",children:[l.jsx(yE,{className:"h-4 w-4 mr-2"}),"Add Table"]})}),l.jsxs(qc,{className:"sm:max-w-md max-h-[90vh] overflow-y-auto","aria-describedby":"add-table-desc",children:[l.jsx(Wc,{children:l.jsx(Gc,{children:s?"Edit Table":"Add New Table"})}),l.jsxs("div",{id:"add-table-desc",className:"sr-only",children:["Fill out the form below to ",s?"edit the":"add a new"," table ",s?"":"to your venue","."]}),l.jsxs("div",{className:"space-y-4 py-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"tableNumber",children:"Table Number"}),l.jsx(Lt,{id:"tableNumber",value:y.table_number,onChange:O=>b({...y,table_number:O.target.value}),placeholder:"e.g., A1"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"capacity",children:"Capacity"}),l.jsx(Lt,{id:"capacity",type:"number",value:y.capacity,onChange:O=>b({...y,capacity:O.target.value}),placeholder:"Number of seats"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"price",children:"Price ()"}),l.jsx(Lt,{id:"price",type:"number",value:y.price,onChange:O=>b({...y,price:O.target.value}),placeholder:"Table price"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"tableType",children:"Table Type"}),l.jsxs("select",{id:"tableType",value:y.table_type,onChange:O=>b({...y,table_type:O.target.value}),className:"w-full border rounded px-2 py-1",children:[l.jsx("option",{value:"",children:"Select table type"}),l.jsx("option",{value:"standard",children:"Standard"}),l.jsx("option",{value:"vip",children:"VIP"}),l.jsx("option",{value:"booth",children:"Booth"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"description",children:"Description"}),l.jsx(Lt,{id:"description",value:y.description,onChange:O=>b({...y,description:O.target.value}),placeholder:"e.g., Near window, VIP section, Corner booth"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"status",children:"Status"}),l.jsxs("select",{id:"status",value:y.status,onChange:O=>b({...y,status:O.target.value}),className:"w-full border rounded px-2 py-1",children:[l.jsx("option",{value:"available",children:"Available"}),l.jsx("option",{value:"booked",children:"Booked"}),l.jsx("option",{value:"maintenance",children:"Maintenance"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"venueId",children:"Venue"}),l.jsxs("select",{id:"venueId",value:y.venue_id,onChange:O=>b({...y,venue_id:O.target.value}),className:"w-full border rounded px-2 py-1",children:[l.jsx("option",{value:"",children:"Select a venue"}),n.map(O=>l.jsx("option",{value:O.id,children:O.name},O.id))]})]}),l.jsx(xt,{className:"w-full bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",onClick:_,children:s?"Update Table":"Add Table"})]})]})]})]}),t.length===0?l.jsx("div",{className:"text-center text-brand-burgundy/70 py-8",children:"No tables yet. Add your first table!"}):l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:t.map(O=>l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsxs(Dr,{className:"flex flex-row items-center justify-between pb-2",children:[l.jsxs(Lr,{className:"text-lg font-semibold text-brand-burgundy",children:["Table ",O.table_number]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(xt,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>E(O),children:l.jsx(Mie,{className:"h-4 w-4"})}),l.jsx(xt,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-600",onClick:()=>C(O.id),children:l.jsx(MM,{className:"h-4 w-4"})})]})]}),l.jsx(Ht,{children:l.jsxs("div",{className:"space-y-2",children:[O.description&&l.jsx("div",{className:"text-sm text-brand-burgundy/80 italic mb-2",children:O.description}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-brand-burgundy/70",children:"Type:"}),l.jsx("span",{className:"font-medium",children:O.table_type})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-brand-burgundy/70",children:"Capacity:"}),l.jsxs("span",{className:"font-medium",children:[O.capacity," seats"]})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-brand-burgundy/70",children:"Price:"}),l.jsxs("span",{className:"font-medium",children:["",O.price.toLocaleString()]})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-brand-burgundy/70",children:"Status:"}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${N(O.status)}`,children:O.status.charAt(0).toUpperCase()+O.status.slice(1)})]})]})})]},O.id))})]})})},_Fe=()=>{const[e,t]=I.useState(null),[r,n]=I.useState(!0),i=ts();I.useEffect(()=>{o()},[]);const o=async()=>{try{const{data:{session:h},error:s}=await Ve.auth.getSession();if(s)throw s;if(!h){Mr({title:"Authentication Required",description:"Please log in to access table management",variant:"destructive"}),i("/venue-owner/login");return}const{data:{user:p},error:y}=await Ve.auth.getUser();if(y)throw y;const{data:b,error:_}=await Ve.from("venue_owners").select("*").eq("user_id",p.id).single();if(_||!b){Mr({title:"Venue Owner Account Required",description:"Please register as a venue owner to access table management",variant:"destructive"}),i("/venue-owner/register");return}t(p)}catch(h){console.error("Auth check error:",h),Mr({title:"Error",description:"Failed to verify authentication",variant:"destructive"})}finally{n(!1)}};return r?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsxs("div",{className:"container py-8",children:[l.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0 mb-6 sm:mb-8",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-heading text-brand-burgundy mb-2",children:"Table Management"}),l.jsx("p",{className:"text-sm sm:text-base text-brand-burgundy/70",children:"Manage your venue's tables and seating arrangements"})]}),l.jsx(xt,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90 w-full sm:w-auto",children:"Add New Table"})]}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsx(Ht,{className:"pt-6",children:e?l.jsx(bFe,{currentUser:e}):l.jsx("div",{children:"Loading..."})})})]})})},wFe=()=>{const{toast:e}=Ui(),[t,r]=I.useState(!0),[n,i]=I.useState(!1),[o,h]=I.useState([]),[s,p]=I.useState(null),[y,b]=I.useState("thisMonth"),[_,E]=I.useState({totalRevenue:0,totalBookings:0,averageBookingValue:0,confirmedBookings:0,pendingBookings:0,cancelledBookings:0,revenueGrowth:0,bookingGrowth:0,dailyRevenue:[],monthlyRevenue:[],statusBreakdown:{},recentBookings:[]}),C=I.useRef(null),k=I.useRef(null);I.useEffect(()=>(R(),k.current=setInterval(()=>{s&&!n&&(console.log("Auto-refreshing analytics data..."),L(s,!0))},3e4),()=>{N(),k.current&&clearInterval(k.current)}),[]),I.useEffect(()=>{s&&o.length>0&&F()},[o,y,s]);const N=()=>{C.current&&(console.log("Cleaning up real-time subscription..."),C.current.unsubscribe(),C.current=null)},O=async W=>{if(N(),!W||W.length===0){console.log("No venue IDs provided for subscription");return}console.log("Setting up real-time subscription for venues:",W);try{C.current=Ve.channel("venue-bookings-changes").on("postgres_changes",{event:"*",schema:"public",table:"bookings",filter:`venue_id=in.(${W.join(",")})`},te=>{var oe;console.log("Real-time booking change detected:",te),te.eventType==="INSERT"?e({title:"New Booking!",description:`A new booking has been received for ${((oe=te.new.total_amount)==null?void 0:oe.toLocaleString())||0}`,className:"bg-green-50 border-green-200"}):te.eventType==="UPDATE"&&te.new.status!==te.old.status&&e({title:"Booking Updated",description:`Booking status changed to ${te.new.status}`,className:"bg-blue-50 border-blue-200"}),setTimeout(()=>{s&&L(s,!0)},1e3)}).subscribe(te=>{console.log("Subscription status:",te),te==="SUBSCRIBED"?(console.log("Successfully subscribed to real-time updates"),e({title:"Live Updates Enabled",description:"Analytics will update automatically when new bookings arrive",className:"bg-green-50 border-green-200"})):te==="CLOSED"?console.log("Real-time subscription closed"):te==="CHANNEL_ERROR"&&(console.error("Real-time subscription error"),e({title:"Real-time Updates Unavailable",description:"Analytics will refresh every 30 seconds instead",variant:"destructive"}))})}catch(te){console.error("Error setting up real-time subscription:",te),e({title:"Real-time Setup Failed",description:"Using automatic refresh instead",variant:"destructive"})}},R=async()=>{try{const{data:{user:W},error:te}=await Ve.auth.getUser();if(te)throw te;if(!W){e({title:"Authentication Required",description:"Please log in to view analytics",variant:"destructive"});return}p(W),await L(W)}catch(W){console.error("Auth error:",W),e({title:"Error",description:"Failed to authenticate user",variant:"destructive"})}},L=async(W,te=!1)=>{try{te||r(!0);const{data:oe,error:ie}=await Ve.from("venues").select("id, name").eq("owner_id",W.id);if(ie)throw ie;if(!oe||oe.length===0){h([]);return}const ue=oe.map(Ae=>Ae.id);C.current||await O(ue);const _e=jh(new Date,6),{data:xe,error:be}=await Ve.from("bookings").select(`
          id,
          venue_id,
          user_id,
          status,
          total_amount,
          number_of_guests,
          booking_date,
          start_time,
          end_time,
          created_at,
          updated_at,
          venues (
            id,
            name
          )
        `).in("venue_id",ue).gte("created_at",_e.toISOString()).order("created_at",{ascending:!1});if(be)throw be;h(xe||[]),te||console.log("Analytics data refreshed successfully")}catch(oe){console.error("Error fetching bookings:",oe),te||e({title:"Error",description:"Failed to load analytics data",variant:"destructive"})}finally{te||r(!1)}},B=async()=>{i(!0),s&&await L(s),i(!1)},q=()=>{const W=new Date;switch(y){case"thisMonth":return{start:yw(W),end:gw(W)};case"lastMonth":const te=jh(W,1);return{start:yw(te),end:gw(te)};case"thisWeek":return{start:kC(W),end:MC(W)};case"lastWeek":const oe=jh(W,1);return{start:kC(oe),end:MC(oe)};default:return{start:yw(W),end:gw(W)}}},F=()=>{const{start:W,end:te}=q(),oe=o.filter(gt=>{const it=new Date(gt.booking_date||gt.created_at);return it>=W&&it<=te}),ie=y.includes("Month")?yw(jh(W,1)):kC(jh(W,1)),ue=y.includes("Month")?gw(jh(W,1)):MC(jh(W,1)),_e=o.filter(gt=>{const it=new Date(gt.booking_date||gt.created_at);return it>=ie&&it<=ue}),xe=oe.reduce((gt,it)=>gt+(it.total_amount||0),0),be=_e.reduce((gt,it)=>gt+(it.total_amount||0),0),Ae=oe.length,me=_e.length,ke=oe.filter(gt=>gt.status==="confirmed").length,Ne=oe.filter(gt=>gt.status==="pending").length,Be=oe.filter(gt=>gt.status==="cancelled").length,We=oe.filter(gt=>gt.status==="completed").length,ut=Ae>0?xe/Ae:0,nt=be>0?(xe-be)/be*100:xe>0?100:0,Pt=me>0?(Ae-me)/me*100:Ae>0?100:0,at=Array.from({length:30},(gt,it)=>{const rt=new Date;return rt.setDate(rt.getDate()-(29-it)),rt}).map(gt=>{const it=o.filter(rt=>new Date(rt.booking_date||rt.created_at).toDateString()===gt.toDateString());return{date:Yx(gt,"MMM dd"),revenue:it.reduce((rt,rr)=>rt+(rr.total_amount||0),0),bookings:it.length}}),Ut={confirmed:ke,pending:Ne,cancelled:Be,completed:We},ct=oe.slice(0,5);E({totalRevenue:xe,totalBookings:Ae,averageBookingValue:ut,confirmedBookings:ke,pendingBookings:Ne,cancelledBookings:Be,revenueGrowth:nt,bookingGrowth:Pt,dailyRevenue:at,statusBreakdown:Ut,recentBookings:ct})},H=W=>`${(W||0).toLocaleString()}`,Z=W=>W>0?l.jsx(xie,{className:"h-4 w-4 text-green-600"}):W<0?l.jsx(vie,{className:"h-4 w-4 text-red-600"}):l.jsx(Z3,{className:"h-4 w-4 text-gray-400"}),re=W=>W>0?"text-green-600":W<0?"text-red-600":"text-gray-500";return t?l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsx("div",{className:"container py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold mx-auto mb-4"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Loading analytics..."})]})})})}):l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsxs("div",{className:"container py-8",children:[l.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0 mb-6 sm:mb-8",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-heading text-brand-burgundy mb-2",children:"Analytics Dashboard"}),l.jsx("p",{className:"text-sm sm:text-base text-brand-burgundy/70",children:"Track your venue's performance and revenue"})]}),l.jsxs("div",{className:"flex flex-col space-y-2 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[l.jsxs("select",{value:y,onChange:W=>b(W.target.value),className:"px-3 py-2 border border-brand-burgundy/20 rounded-lg bg-white text-brand-burgundy w-full sm:w-auto",children:[l.jsx("option",{value:"thisWeek",children:"This Week"}),l.jsx("option",{value:"lastWeek",children:"Last Week"}),l.jsx("option",{value:"thisMonth",children:"This Month"}),l.jsx("option",{value:"lastMonth",children:"Last Month"})]}),l.jsxs(xt,{onClick:B,disabled:n,variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10 w-full sm:w-auto",children:[l.jsx(kM,{className:`h-4 w-4 mr-2 ${n?"animate-spin":""}`}),"Refresh"]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6 mb-6 sm:mb-8",children:[l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-brand-burgundy/70",children:"Total Revenue"}),l.jsx("p",{className:"text-lg sm:text-2xl font-bold text-brand-burgundy truncate",children:H(_.totalRevenue)})]}),l.jsx("div",{className:"p-1.5 sm:p-2 bg-green-100 rounded-full flex-shrink-0",children:l.jsx(P8,{className:"h-4 w-4 sm:h-6 sm:w-6 text-green-600"})})]}),l.jsxs("div",{className:"flex items-center mt-1 sm:mt-2",children:[Z(_.revenueGrowth),l.jsxs("span",{className:`text-xs sm:text-sm ml-1 ${re(_.revenueGrowth)}`,children:[_.revenueGrowth.toFixed(1),"% from last period"]})]})]})}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-brand-burgundy/70",children:"Total Bookings"}),l.jsx("p",{className:"text-lg sm:text-2xl font-bold text-brand-burgundy",children:_.totalBookings})]}),l.jsx("div",{className:"p-1.5 sm:p-2 bg-blue-100 rounded-full flex-shrink-0",children:l.jsx(ma,{className:"h-4 w-4 sm:h-6 sm:w-6 text-blue-600"})})]}),l.jsxs("div",{className:"flex items-center mt-1 sm:mt-2",children:[Z(_.bookingGrowth),l.jsxs("span",{className:`text-xs sm:text-sm ml-1 ${re(_.bookingGrowth)}`,children:[_.bookingGrowth.toFixed(1),"% from last period"]})]})]})}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-brand-burgundy/70",children:"Avg. Booking Value"}),l.jsx("p",{className:"text-lg sm:text-2xl font-bold text-brand-burgundy truncate",children:H(_.averageBookingValue)})]}),l.jsx("div",{className:"p-1.5 sm:p-2 bg-yellow-100 rounded-full flex-shrink-0",children:l.jsx(vE,{className:"h-4 w-4 sm:h-6 sm:w-6 text-yellow-600"})})]}),l.jsxs("div",{className:"flex items-center mt-1 sm:mt-2",children:[l.jsx(Z3,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-400"}),l.jsx("span",{className:"text-xs sm:text-sm ml-1 text-gray-500",children:"Per booking average"})]})]})}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-brand-burgundy/70",children:"Confirmed Bookings"}),l.jsx("p",{className:"text-lg sm:text-2xl font-bold text-brand-burgundy",children:_.confirmedBookings})]}),l.jsx("div",{className:"p-1.5 sm:p-2 bg-purple-100 rounded-full flex-shrink-0",children:l.jsx(Is,{className:"h-4 w-4 sm:h-6 sm:w-6 text-purple-600"})})]}),l.jsx("div",{className:"flex items-center mt-1 sm:mt-2",children:l.jsxs("span",{className:"text-xs sm:text-sm text-gray-500",children:[_.pendingBookings," pending, ",_.cancelledBookings," cancelled"]})})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 sm:gap-6",children:[l.jsxs(Mt,{className:"xl:col-span-2 bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center text-sm sm:text-base",children:[l.jsx(j8,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2"}),"Daily Revenue Trend (Last 30 Days)"]})}),l.jsxs(Ht,{className:"p-3 sm:p-6",children:[l.jsx("div",{className:"w-full overflow-x-auto",children:l.jsx("div",{className:"min-w-[600px] sm:min-w-full h-48 sm:h-64 flex items-end justify-between space-x-1 px-2",children:_.dailyRevenue.map((W,te)=>{const oe=Math.max(..._.dailyRevenue.map(ue=>ue.revenue)),ie=oe>0?W.revenue/oe*100:0;return l.jsxs("div",{className:"flex flex-col items-center flex-1 min-w-[16px] group",children:[l.jsx("div",{className:"bg-brand-gold rounded-t w-full min-h-[4px] transition-all duration-300 hover:bg-brand-burgundy cursor-pointer",style:{height:`${Math.max(ie,4)}%`},title:`${W.date}: ${H(W.revenue)} (${W.bookings} bookings)`}),l.jsxs("span",{className:"text-[10px] sm:text-xs text-brand-burgundy/70 mt-1 sm:mt-2 transform sm:rotate-45 sm:origin-top-left whitespace-nowrap",children:[l.jsx("span",{className:"sm:hidden",children:W.date.split(" ")[1]}),l.jsx("span",{className:"hidden sm:inline",children:W.date})]})]},te)})})}),l.jsx("div",{className:"sm:hidden text-center mt-2",children:l.jsx("p",{className:"text-xs text-brand-burgundy/50",children:" Swipe to see more data "})}),l.jsx("div",{className:"mt-4 sm:hidden",children:l.jsx("div",{className:"flex items-center justify-center space-x-4 text-xs",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-3 h-3 bg-brand-gold rounded mr-1"}),l.jsx("span",{className:"text-brand-burgundy/70",children:"Daily Revenue"})]})})})]})]}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsx(Lr,{className:"text-sm sm:text-base",children:"Booking Status"})}),l.jsxs(Ht,{className:"p-4 sm:p-6 space-y-3 sm:space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-xs sm:text-sm text-brand-burgundy/70",children:"Confirmed"}),l.jsx(Yr,{className:"bg-green-100 text-green-800 text-xs",children:_.statusBreakdown.confirmed})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-xs sm:text-sm text-brand-burgundy/70",children:"Pending"}),l.jsx(Yr,{className:"bg-yellow-100 text-yellow-800 text-xs",children:_.statusBreakdown.pending})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-xs sm:text-sm text-brand-burgundy/70",children:"Completed"}),l.jsx(Yr,{className:"bg-blue-100 text-blue-800 text-xs",children:_.statusBreakdown.completed})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-xs sm:text-sm text-brand-burgundy/70",children:"Cancelled"}),l.jsx(Yr,{className:"bg-red-100 text-red-800 text-xs",children:_.statusBreakdown.cancelled})]})]})]})]}),_.recentBookings.length>0&&l.jsxs(Mt,{className:"mt-4 sm:mt-6 bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsx(Lr,{className:"text-sm sm:text-base",children:"Recent Bookings"})}),l.jsx(Ht,{className:"p-4 sm:p-6",children:l.jsx("div",{className:"space-y-3 sm:space-y-4",children:_.recentBookings.map(W=>{var te;return l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-3 sm:p-4 border border-brand-burgundy/10 rounded-lg space-y-2 sm:space-y-0",children:[l.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[l.jsx("div",{className:"h-2 w-2 bg-brand-gold rounded-full flex-shrink-0"}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:"font-medium text-brand-burgundy text-sm sm:text-base truncate",children:((te=W.venues)==null?void 0:te.name)||"Unknown Venue"}),l.jsxs("p",{className:"text-xs sm:text-sm text-brand-burgundy/70",children:[Yx(new Date(W.booking_date||W.created_at),"MMM dd, yyyy"),"  ",W.number_of_guests," guests"]})]})]}),l.jsxs("div",{className:"flex items-center justify-between sm:flex-col sm:text-right space-x-2 sm:space-x-0",children:[l.jsx("p",{className:"font-semibold text-brand-burgundy text-sm sm:text-base",children:H(W.total_amount)}),l.jsx(Yr,{className:`text-xs ${W.status==="confirmed"?"bg-green-100 text-green-800":W.status==="pending"?"bg-yellow-100 text-yellow-800":W.status==="cancelled"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:W.status})]})]},W.id)})})})]})]})})};var V2="Switch",[SFe,n6e]=xo(V2),[EFe,TFe]=SFe(V2),$Z=I.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:i,defaultChecked:o,required:h,disabled:s,value:p="on",onCheckedChange:y,form:b,..._}=e,[E,C]=I.useState(null),k=Qr(t,B=>C(B)),N=I.useRef(!1),O=E?b||!!E.closest("form"):!0,[R,L]=zc({prop:i,defaultProp:o??!1,onChange:y,caller:V2});return l.jsxs(EFe,{scope:r,checked:R,disabled:s,children:[l.jsx(fr.button,{type:"button",role:"switch","aria-checked":R,"aria-required":h,"data-state":qZ(R),"data-disabled":s?"":void 0,disabled:s,value:p,..._,ref:k,onClick:Zt(e.onClick,B=>{L(q=>!q),O&&(N.current=B.isPropagationStopped(),N.current||B.stopPropagation())})}),O&&l.jsx(VZ,{control:E,bubbles:!N.current,name:n,value:p,checked:R,required:h,disabled:s,form:b,style:{transform:"translateX(-100%)"}})]})});$Z.displayName=V2;var FZ="SwitchThumb",UZ=I.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,i=TFe(FZ,r);return l.jsx(fr.span,{"data-state":qZ(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:t})});UZ.displayName=FZ;var jFe="SwitchBubbleInput",VZ=I.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:n=!0,...i},o)=>{const h=I.useRef(null),s=Qr(h,o),p=PI(r),y=FM(t);return I.useEffect(()=>{const b=h.current;if(!b)return;const _=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(_,"checked").set;if(p!==r&&C){const k=new Event("click",{bubbles:n});C.call(b,r),b.dispatchEvent(k)}},[p,r,n]),l.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...i,tabIndex:-1,ref:s,style:{...i.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});VZ.displayName=jFe;function qZ(e){return e?"checked":"unchecked"}var WZ=$Z,CFe=UZ;const Qo=je.forwardRef(({className:e,...t},r)=>l.jsx(WZ,{className:Pr("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:l.jsx(CFe,{className:Pr("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Qo.displayName=WZ.displayName;const PFe=()=>{const e=ts(),{toast:t}=Ui(),[r,n]=I.useState(!0),[i,o]=I.useState(!1),[h,s]=I.useState(null),[p,y]=I.useState(null),[b,_]=I.useState([]),[E,C]=I.useState({name:"",description:"",type:"",address:"",city:"",country:"",contact_phone:"",contact_email:"",price_range:"",opening_hours:"",website_url:"",vibe:""}),[k,N]=I.useState({name:"",email:"",role:"",phone:""}),[O,R]=I.useState(!1),[L,B]=I.useState({email_bookings:!0,email_cancellations:!0,email_payments:!0,sms_bookings:!1,sms_cancellations:!1,daily_summary:!0,weekly_report:!0});I.useEffect(()=>{q()},[]),I.useEffect(()=>{},[p,h]);const q=async()=>{try{const{data:{session:W},error:te}=await Ve.auth.getSession();if(te)throw te;if(!W){t({title:"Authentication Required",description:"Please log in to access settings",variant:"destructive"}),e("/venue-owner/login");return}const{data:{user:oe},error:ie}=await Ve.auth.getUser();if(ie)throw ie;const{data:ue,error:_e}=await Ve.from("venue_owners").select("*").eq("user_id",oe.id).single();if(_e||!ue){t({title:"Venue Owner Account Required",description:"Please register as a venue owner",variant:"destructive"}),e("/venue-owner/register");return}s(oe),await F(oe.id)}catch(W){console.error("Auth check error:",W),t({title:"Error",description:"Failed to verify authentication",variant:"destructive"})}},F=async W=>{try{n(!0),console.log(" Fetching venue data for user:",W);const{data:te,error:oe}=await Ve.from("venues").select("*").eq("owner_id",W).single();if(oe){console.error(" Error fetching venue:",oe);const{data:{user:ie}}=await Ve.auth.getUser();if(ie!=null&&ie.email){console.log(" Trying to fetch venue by email:",ie.email);const{data:ue,error:_e}=await Ve.from("venues").select("*").eq("contact_email",ie.email).single();if(ue&&!_e)console.log(" Found venue by email, updating owner_id..."),await Ve.from("venues").update({owner_id:W}).eq("id",ue.id),y({...ue,owner_id:W}),console.log(" Venue owner_id fixed");else{console.error(" No venue found by email either:",_e);return}}else return}else y(te),console.log(" Venue fetched successfully:",te.id);y(te),C({name:te.name||"",description:te.description||"",type:te.type||"",address:te.address||"",city:te.city||"",country:te.country||"",contact_phone:te.contact_phone||"",contact_email:te.contact_email||"",price_range:te.price_range||"",opening_hours:te.opening_hours||"",website_url:te.website_url||"",vibe:te.vibe||""}),_([{id:1,name:"Manager",email:te.contact_email,role:"Manager",phone:te.contact_phone}])}catch(te){console.error("Error fetching venue data:",te),t({title:"Error",description:"Failed to load venue data",variant:"destructive"})}finally{n(!1)}},H=async W=>{if(W.preventDefault(),!!p)try{if(o(!0),console.log(" Attempting to update venue:",p.id),console.log(" Current user ID:",h==null?void 0:h.id),console.log(" Venue owner_id:",p.owner_id),!(h!=null&&h.id))throw new Error("Authentication required. Please log in again.");if(p.owner_id!==h.id)throw console.error(" User does not own this venue:",{userID:h.id,venueOwnerID:p.owner_id}),new Error("You do not have permission to update this venue.");const te={name:E.name,description:E.description,type:E.type,address:E.address,city:E.city,country:E.country,contact_phone:E.contact_phone,contact_email:E.contact_email,price_range:E.price_range,opening_hours:E.opening_hours||null,website_url:E.website_url||null,vibe:E.vibe||null,updated_at:new Date().toISOString()};console.log(" Update data:",te);const{data:oe,error:ie}=await Ve.from("venues").update(te).eq("id",p.id).eq("owner_id",h.id).select();if(ie)throw console.error(" Supabase update error:",ie),ie;if(!oe||oe.length===0)throw new Error("No venue was updated. Please check that you own this venue.");console.log(" Venue updated successfully:",oe[0]),t({title:"Success!",description:"Saved settings",className:"bg-green-500 text-white"}),await F(h.id)}catch(te){console.error(" Error updating venue:",te);let oe="Failed to update venue details";te.message.includes("permission")||te.message.includes("policy")?oe="Permission denied. Please ensure you own this venue.":te.message.includes("authentication")||te.message.includes("auth")?oe="Authentication error. Please log in again.":te.message&&(oe=te.message),t({title:"Error",description:oe,variant:"destructive"})}finally{o(!1)}},Z=async()=>{if(!k.name.trim()||!k.email.trim()||!k.role.trim()){t({title:"Error",description:"Please fill in all required fields (Name, Email, and Role)",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(k.email)){t({title:"Error",description:"Please enter a valid email address",variant:"destructive"});return}try{const te={id:Date.now(),name:k.name.trim(),email:k.email.trim(),role:k.role.trim(),phone:k.phone.trim()||null,venue_id:p==null?void 0:p.id,added_at:new Date().toISOString()};_(oe=>[...oe,te]),N({name:"",email:"",role:"",phone:""}),R(!1),t({title:"Success!",description:"Staff member added successfully",className:"bg-green-500 text-white"})}catch(te){console.error("Error adding staff member:",te),t({title:"Error",description:"Failed to add staff member. Please try again.",variant:"destructive"})}},re=W=>{_(te=>te.filter(oe=>oe.id!==W)),t({title:"Success!",description:"Staff member removed successfully",className:"bg-green-500 text-white"})};return r?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold"})}):p?l.jsxs("div",{className:"container mx-auto px-4 py-4 sm:py-8 max-w-7xl",children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-heading text-brand-burgundy mb-4 sm:mb-6",children:"Venue Settings"}),l.jsxs(wg,{defaultValue:"profile",className:"space-y-4",children:[l.jsxs(Sf,{className:"bg-white p-1 rounded-lg border border-brand-burgundy/10 mb-4 grid grid-cols-3 w-full",children:[l.jsxs(Ci,{value:"profile",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 p-3 sm:p-4 text-xs sm:text-sm min-h-[60px] sm:min-h-[50px]",children:[l.jsx(Yh,{className:"h-3 w-3 sm:h-4 sm:w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Venue Profile"}),l.jsx("span",{className:"sm:hidden",children:"Profile"})]}),l.jsxs(Ci,{value:"staff",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 p-3 sm:p-4 text-xs sm:text-sm min-h-[60px] sm:min-h-[50px]",children:[l.jsx(Is,{className:"h-3 w-3 sm:h-4 sm:w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Staff Management"}),l.jsx("span",{className:"sm:hidden",children:"Staff"})]}),l.jsxs(Ci,{value:"notifications",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 p-3 sm:p-4 text-xs sm:text-sm min-h-[60px] sm:min-h-[50px]",children:[l.jsx(fA,{className:"h-3 w-3 sm:h-4 sm:w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Notifications"}),l.jsx("span",{className:"sm:hidden",children:"Alerts"})]})]}),l.jsx(Pi,{value:"profile",children:l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center text-lg sm:text-xl",children:[l.jsx(Yh,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2"}),"Venue Profile"]})}),l.jsx(Ht,{className:"p-4 sm:p-6",children:l.jsxs("form",{onSubmit:H,className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"font-semibold text-brand-burgundy text-base sm:text-lg",children:"Basic Information"}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"name",className:"text-sm sm:text-base",children:"Venue Name"}),l.jsx(Lt,{id:"name",value:E.name,onChange:W=>C({...E,name:W.target.value}),placeholder:"Enter venue name",className:"mt-1"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"type",className:"text-sm sm:text-base",children:"Venue Type"}),l.jsxs(rl,{value:E.type,onValueChange:W=>C({...E,type:W}),children:[l.jsx(oo,{className:"mt-1",children:l.jsx(nl,{placeholder:"Select venue type"})}),l.jsxs(lo,{children:[l.jsx(Dn,{value:"restaurant",children:"Restaurant"}),l.jsx(Dn,{value:"club",children:"Nightclub"}),l.jsx(Dn,{value:"lounge",children:"Lounge"}),l.jsx(Dn,{value:"bar",children:"Bar"}),l.jsx(Dn,{value:"cafe",children:"Cafe"})]})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"description",className:"text-sm sm:text-base",children:"Description"}),l.jsx(ag,{id:"description",value:E.description,onChange:W=>C({...E,description:W.target.value}),placeholder:"Describe your venue",rows:3,className:"mt-1"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"vibe",className:"text-sm sm:text-base",children:"Venue Vibe"}),l.jsxs(rl,{value:E.vibe,onValueChange:W=>C({...E,vibe:W}),children:[l.jsx(oo,{className:"mt-1",children:l.jsx(nl,{placeholder:"Select venue vibe"})}),l.jsxs(lo,{children:[l.jsx(Dn,{value:"Sophisticated",children:"Sophisticated"}),l.jsx(Dn,{value:"Energetic",children:"Energetic"}),l.jsx(Dn,{value:"Relaxed",children:"Relaxed"})]})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"font-semibold text-brand-burgundy text-base sm:text-lg",children:"Contact & Location"}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"address",className:"text-sm sm:text-base",children:"Address"}),l.jsx(ag,{id:"address",value:E.address,onChange:W=>C({...E,address:W.target.value}),placeholder:"Full address",rows:2,className:"mt-1"})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"city",className:"text-sm sm:text-base",children:"City"}),l.jsx(Lt,{id:"city",value:E.city,onChange:W=>C({...E,city:W.target.value}),placeholder:"City",className:"mt-1"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"country",className:"text-sm sm:text-base",children:"Country"}),l.jsx(Lt,{id:"country",value:E.country,onChange:W=>C({...E,country:W.target.value}),placeholder:"Country",className:"mt-1"})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"contact_phone",className:"text-sm sm:text-base",children:"Contact Phone"}),l.jsx(Lt,{id:"contact_phone",value:E.contact_phone,onChange:W=>C({...E,contact_phone:W.target.value}),placeholder:"Phone number",className:"mt-1"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"contact_email",className:"text-sm sm:text-base",children:"Contact Email"}),l.jsx(Lt,{id:"contact_email",type:"email",value:E.contact_email,onChange:W=>C({...E,contact_email:W.target.value}),placeholder:"Email address",className:"mt-1"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"website_url",className:"text-sm sm:text-base",children:"Website URL"}),l.jsx(Lt,{id:"website_url",value:E.website_url,onChange:W=>C({...E,website_url:W.target.value}),placeholder:"https://yourvenue.com",className:"mt-1"})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"font-semibold text-brand-burgundy text-base sm:text-lg",children:"Additional Information"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"price_range",className:"text-sm sm:text-base",children:"Price Range"}),l.jsxs(rl,{value:E.price_range,onValueChange:W=>C({...E,price_range:W}),children:[l.jsx(oo,{className:"mt-1",children:l.jsx(nl,{placeholder:"Select price range"})}),l.jsxs(lo,{children:[l.jsx(Dn,{value:"budget",children:"Budget"}),l.jsx(Dn,{value:"moderate",children:"Moderate"}),l.jsx(Dn,{value:"premium",children:"Premium"}),l.jsx(Dn,{value:"luxury",children:"Luxury"})]})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"opening_hours",className:"text-sm sm:text-base",children:"Opening Hours"}),l.jsx(Lt,{id:"opening_hours",value:E.opening_hours,onChange:W=>C({...E,opening_hours:W.target.value}),placeholder:"e.g., Mon-Sun 6PM-2AM",className:"mt-1"})]})]})]}),l.jsxs("div",{className:"flex justify-end pt-4",children:[l.jsx(xt,{type:"submit",disabled:i,className:"w-full sm:w-auto",children:i?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):l.jsxs(l.Fragment,{children:[l.jsx(r4,{className:"h-4 w-4 mr-2"}),"Save Changes"]})}),!1]})]})})]})}),l.jsx(Pi,{value:"staff",children:l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center text-lg sm:text-xl",children:[l.jsx(Is,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2"}),"Staff Management"]})}),l.jsx(Ht,{className:"p-4 sm:p-6",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h3",{className:"font-semibold text-brand-burgundy text-base sm:text-lg",children:"Staff Members"}),l.jsxs(xt,{onClick:()=>R(!O),className:"flex items-center gap-2",children:[l.jsx(yE,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Add Staff"}),l.jsx("span",{className:"sm:hidden",children:"Add"})]})]}),O&&l.jsx(Mt,{className:"border-brand-gold/20 bg-brand-gold/5",children:l.jsxs(Ht,{className:"p-4 sm:p-6",children:[l.jsx("h4",{className:"font-semibold mb-4 text-brand-burgundy",children:"Add New Staff Member"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"staff_name",className:"text-sm sm:text-base",children:"Name *"}),l.jsx(Lt,{id:"staff_name",value:k.name,onChange:W=>N({...k,name:W.target.value}),placeholder:"Staff member name",className:"mt-1"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"staff_email",className:"text-sm sm:text-base",children:"Email *"}),l.jsx(Lt,{id:"staff_email",type:"email",value:k.email,onChange:W=>N({...k,email:W.target.value}),placeholder:"staff@venue.com",className:"mt-1"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"staff_role",className:"text-sm sm:text-base",children:"Role *"}),l.jsx(Lt,{id:"staff_role",value:k.role,onChange:W=>N({...k,role:W.target.value}),placeholder:"Manager, Server, etc.",className:"mt-1"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"staff_phone",className:"text-sm sm:text-base",children:"Phone"}),l.jsx(Lt,{id:"staff_phone",value:k.phone,onChange:W=>N({...k,phone:W.target.value}),placeholder:"Phone number",className:"mt-1"})]})]}),l.jsxs("div",{className:"flex gap-2 mt-4",children:[l.jsxs(xt,{type:"button",onClick:Z,className:"flex-1 sm:flex-none",children:[l.jsx($ie,{className:"h-4 w-4 mr-2"}),l.jsx("span",{className:"hidden sm:inline",children:"Add Staff Member"}),l.jsx("span",{className:"sm:hidden",children:"Add"})]}),l.jsx(xt,{type:"button",variant:"outline",onClick:()=>R(!1),className:"flex-1 sm:flex-none",children:"Cancel"})]})]})}),l.jsx("div",{className:"space-y-3",children:b.length===0?l.jsx("p",{className:"text-gray-500 text-center py-8",children:"No staff members added yet."}):b.map((W,te)=>l.jsx(Mt,{className:"border-brand-burgundy/10",children:l.jsx(Ht,{className:"p-4",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-semibold text-brand-burgundy",children:W.name}),l.jsx("p",{className:"text-sm text-gray-600",children:W.email}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx(Yr,{variant:"secondary",className:"text-xs",children:W.role}),W.phone&&l.jsx("span",{className:"text-xs text-gray-500",children:W.phone})]})]}),l.jsx(xt,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700",onClick:()=>re(W.id),children:l.jsx(MM,{className:"h-4 w-4"})})]})})},W.id||te))})]})})]})}),l.jsx(Pi,{value:"notifications",children:l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center text-lg sm:text-xl",children:[l.jsx(fA,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2"}),"Notification Preferences"]})}),l.jsx(Ht,{className:"p-4 sm:p-6",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"font-semibold text-brand-burgundy text-base sm:text-lg",children:"Email Notifications"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx(Tt,{className:"text-sm sm:text-base",children:"New Bookings"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Get notified when someone books your venue"})]}),l.jsx(Qo,{checked:L.email_bookings,onCheckedChange:W=>B({...L,email_bookings:W})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx(Tt,{className:"text-sm sm:text-base",children:"Cancellations"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Get notified when bookings are cancelled"})]}),l.jsx(Qo,{checked:L.email_cancellations,onCheckedChange:W=>B({...L,email_cancellations:W})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx(Tt,{className:"text-sm sm:text-base",children:"Payment Confirmations"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Get notified when payments are received"})]}),l.jsx(Qo,{checked:L.email_payments,onCheckedChange:W=>B({...L,email_payments:W})})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"font-semibold text-brand-burgundy text-base sm:text-lg",children:"SMS Notifications"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx(Tt,{className:"text-sm sm:text-base",children:"New Bookings"}),l.jsx("p",{className:"text-xs text-gray-500",children:"SMS alerts for new bookings"})]}),l.jsx(Qo,{checked:L.sms_bookings,onCheckedChange:W=>B({...L,sms_bookings:W})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx(Tt,{className:"text-sm sm:text-base",children:"Cancellations"}),l.jsx("p",{className:"text-xs text-gray-500",children:"SMS alerts for cancellations"})]}),l.jsx(Qo,{checked:L.sms_cancellations,onCheckedChange:W=>B({...L,sms_cancellations:W})})]})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"font-semibold text-brand-burgundy text-base sm:text-lg",children:"Reports"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx(Tt,{className:"text-sm sm:text-base",children:"Daily Summary"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Receive daily booking summaries"})]}),l.jsx(Qo,{checked:L.daily_summary,onCheckedChange:W=>B({...L,daily_summary:W})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx(Tt,{className:"text-sm sm:text-base",children:"Weekly Report"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Receive weekly performance reports"})]}),l.jsx(Qo,{checked:L.weekly_report,onCheckedChange:W=>B({...L,weekly_report:W})})]})]})]}),l.jsx("div",{className:"flex justify-end pt-4",children:l.jsxs(xt,{className:"w-full sm:w-auto",children:[l.jsx(r4,{className:"h-4 w-4 mr-2"}),l.jsx("span",{className:"hidden sm:inline",children:"Save Preferences"}),l.jsx("span",{className:"sm:hidden",children:"Save"})]})})]})})]})})]})]}):l.jsxs("div",{className:"container mx-auto px-4 py-20 text-center",children:[l.jsx("h2",{className:"text-2xl font-bold mb-4",children:"No Venue Found"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"You don't have a venue associated with your account."}),l.jsx(xt,{onClick:()=>e("/venue-owner/register"),children:"Create Venue"})]})},AFe=()=>{const{toast:e}=Ui(),[t,r]=I.useState(!0),[n,i]=I.useState(!1),[o,h]=I.useState([]),[s,p]=I.useState(null),[y,b]=I.useState(null),[_,E]=I.useState(""),[C,k]=I.useState({totalCredits:0,activeMembers:0,usedCredits:0,recentCredits:0}),[N,O]=I.useState(null);I.useEffect(()=>{R()},[]),I.useEffect(()=>{if(!s)return;const te=setInterval(()=>{L(s.id,!0)},3e4);return()=>clearInterval(te)},[s]),I.useEffect(()=>{const te=()=>{!document.hidden&&s&&L(s.id,!0)};return document.addEventListener("visibilitychange",te),()=>document.removeEventListener("visibilitychange",te)},[s]);const R=async()=>{try{const{data:{user:te},error:oe}=await Ve.auth.getUser();if(oe)throw oe;if(!te){e({title:"Authentication Required",description:"Please log in to view venue credits",variant:"destructive"});return}p(te),await L(te.id)}catch(te){console.error("Auth error:",te),e({title:"Error",description:"Failed to authenticate user",variant:"destructive"})}finally{r(!1)}},L=async(te,oe=!1)=>{try{oe||i(!0);const{data:ie,error:ue}=await Ve.from("venues").select("*").eq("owner_id",te).single();if(ue){if(ue.code==="PGRST116"){b(null),h([]);return}throw ue}b(ie);let _e,xe;try{const{data:Ae,error:me}=await Ve.from("venue_credits").select(`
            *,
            profiles:user_id (
              id,
              full_name,
              email,
              first_name,
              last_name
            )
          `).eq("venue_id",ie.id).order("created_at",{ascending:!1});if(_e=Ae,xe=me,xe&&xe.code==="PGRST200"){console.log(" Profiles table not ready, using fallback...");const ke=await Ve.from("venue_credits").select("*").eq("venue_id",ie.id).order("created_at",{ascending:!1});_e=ke.data,xe=ke.error}}catch(Ae){console.error("Error fetching credits:",Ae),xe=Ae}if(xe)throw xe;const be=(_e||[]).map(Ae=>(Ae.profiles?Ae.display_data={name:Ae.profiles.full_name||`${Ae.profiles.first_name||""} ${Ae.profiles.last_name||""}`.trim()||`Member ${Ae.user_id.substring(0,8)}...`,email:Ae.profiles.email||`member-${Ae.user_id.substring(0,8)}@hidden`,initials:(Ae.profiles.full_name||Ae.profiles.first_name||Ae.user_id).substring(0,2).toUpperCase()}:Ae.display_data={name:`Member ${Ae.user_id.substring(0,8)}...`,email:`member-${Ae.user_id.substring(0,8)}@hidden`,initials:Ae.user_id.substring(0,2).toUpperCase()},Ae));if(oe&&o.length>0&&be.length>o.length){const Ae=be.length-o.length,me=be[0];e({title:"New Member Credit! ",description:`${me.display_data.name} purchased ${(me.amount/100).toLocaleString()} credits${Ae>1?` (+${Ae-1} more)`:""}`,className:"bg-green-500 text-white"})}!oe&&be.length>0&&be.some(me=>me.display_data.name.startsWith("Member ")&&me.display_data.name.includes("..."))&&setTimeout(()=>{e({title:"Member Names Not Available",description:"To see real member names and emails, please set up the profiles table. Check the setup guide for instructions.",variant:"default"})},2e3),h(be),B(be),O(new Date)}catch(ie){console.error("Error fetching venue credits:",ie),oe||e({title:"Error",description:"Failed to load venue credits",variant:"destructive"})}finally{oe||i(!1)}},B=te=>{const oe=new Date,ie=new Date(oe.getTime()-30*24*60*60*1e3),ue=te.reduce((Ae,me)=>Ae+me.amount/100,0),_e=te.reduce((Ae,me)=>Ae+me.used_amount/100,0),xe=new Set(te.filter(Ae=>Ae.status==="active"&&Ae.remaining_balance>0).map(Ae=>Ae.user_id)).size,be=te.filter(Ae=>new Date(Ae.created_at)>=ie).reduce((Ae,me)=>Ae+me.amount/100,0);k({totalCredits:ue,activeMembers:xe,usedCredits:_e,recentCredits:be})},q=()=>{s&&L(s.id)},F=te=>{switch(te){case"active":return"bg-green-100 text-green-800";case"used":return"bg-gray-100 text-gray-800";case"expired":return"bg-red-100 text-red-800";case"cancelled":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},H=te=>{var oe,ie;return(oe=te.display_data)!=null&&oe.name?te.display_data.name:(ie=te.profiles)!=null&&ie.full_name?te.profiles.full_name:`Member ${te.user_id.substring(0,8)}...`},Z=te=>{var oe,ie;return(oe=te.display_data)!=null&&oe.email?te.display_data.email:(ie=te.profiles)!=null&&ie.email?te.profiles.email:`member-${te.user_id.substring(0,8)}@hidden`},re=te=>{const oe=new Date,ie=new Date(te.created_at);return(oe-ie)/(1e3*60*60)<=24},W=o.filter(te=>{const oe=H(te).toLowerCase(),ie=Z(te).toLowerCase(),ue=_.toLowerCase();return oe.includes(ue)||ie.includes(ue)||te.status.toLowerCase().includes(ue)});return t?l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsx("div",{className:"container py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold mx-auto mb-4"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Loading venue credits..."})]})})})}):y?l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsxs("div",{className:"container py-8",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-8",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-2",children:"Eddys Members Credits"}),l.jsxs("p",{className:"text-brand-burgundy/70",children:["Manage and track member credits for ",l.jsx("span",{className:"font-semibold",children:y.name})]})]}),l.jsxs("div",{className:"flex flex-col items-end mt-4 sm:mt-0",children:[l.jsxs(xt,{onClick:q,disabled:n,variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",children:[l.jsx(kM,{className:`h-4 w-4 mr-2 ${n?"animate-spin":""}`}),"Refresh"]}),N&&l.jsxs("p",{className:"text-xs text-brand-burgundy/60 mt-2",children:["Last updated: ",N.toLocaleTimeString()]}),l.jsx("p",{className:"text-xs text-brand-burgundy/50 mt-1",children:"Auto-refreshing every 30 seconds"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsx(Ht,{className:"p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-brand-burgundy/70",children:"Total Credits"}),l.jsxs("p",{className:"text-2xl font-bold text-brand-burgundy",children:["",C.totalCredits.toLocaleString()]})]}),l.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:l.jsx(P8,{className:"h-6 w-6 text-green-600"})})]})})}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsx(Ht,{className:"p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-brand-burgundy/70",children:"Active Members"}),l.jsx("p",{className:"text-2xl font-bold text-brand-burgundy",children:C.activeMembers})]}),l.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:l.jsx(Is,{className:"h-6 w-6 text-blue-600"})})]})})}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsx(Ht,{className:"p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-brand-burgundy/70",children:"Used Credits"}),l.jsxs("p",{className:"text-2xl font-bold text-brand-burgundy",children:["",C.usedCredits.toLocaleString()]})]}),l.jsx("div",{className:"p-2 bg-purple-100 rounded-full",children:l.jsx(Fc,{className:"h-6 w-6 text-purple-600"})})]})})}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsx(Ht,{className:"p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-brand-burgundy/70",children:"This Month"}),l.jsxs("p",{className:"text-2xl font-bold text-brand-burgundy",children:["",C.recentCredits.toLocaleString()]})]}),l.jsx("div",{className:"p-2 bg-yellow-100 rounded-full",children:l.jsx(vE,{className:"h-6 w-6 text-yellow-600"})})]})})})]}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10 mb-6",children:l.jsx(Ht,{className:"p-6",children:l.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:l.jsxs("div",{className:"relative flex-1",children:[l.jsx(gd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-brand-burgundy/40 h-4 w-4"}),l.jsx(Lt,{placeholder:"Search by member name, email, or status...",value:_,onChange:te=>E(te.target.value),className:"pl-10 border-brand-burgundy/20 focus:border-brand-burgundy"})]})})})}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center",children:[l.jsx(Sc,{className:"h-5 w-5 mr-2"}),"Member Credits (",W.length,")"]})}),l.jsx(Ht,{children:W.length>0?l.jsx("div",{className:"space-y-4",children:W.map(te=>l.jsxs(tt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-brand-burgundy/10 rounded-lg p-4 hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[l.jsxs("div",{className:"flex items-start space-x-4 mb-4 sm:mb-0",children:[l.jsx("div",{className:"p-2 bg-brand-burgundy/10 rounded-full",children:l.jsx(Kn,{className:"h-5 w-5 text-brand-burgundy"})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("h4",{className:"font-semibold text-brand-burgundy",children:H(te)}),re(te)&&l.jsx(Yr,{className:"bg-green-500 text-white text-xs px-2 py-1",children:"New"})]}),l.jsx("p",{className:"text-sm text-brand-burgundy/70",children:Z(te)}),l.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-brand-burgundy/60",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(ma,{className:"h-3 w-3 mr-1"}),new Date(te.created_at).toLocaleDateString()]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx(ml,{className:"h-3 w-3 mr-1"}),"Expires: ",new Date(te.expires_at).toLocaleDateString()]})]})]})]}),l.jsxs("div",{className:"flex flex-col sm:items-end space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"font-bold text-brand-burgundy",children:["",(te.remaining_balance/100).toLocaleString()," remaining"]}),l.jsxs("div",{className:"text-sm text-brand-burgundy/70",children:["of ",(te.amount/100).toLocaleString()," total"]}),te.used_amount>0&&l.jsxs("div",{className:"text-xs text-brand-burgundy/60",children:["Used: ",(te.used_amount/100).toLocaleString()]})]}),l.jsx(Yr,{className:F(te.status),children:te.status})]}),l.jsx("div",{className:"w-full sm:w-32",children:l.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-brand-gold rounded-full h-2 transition-all duration-300",style:{width:`${Math.max(0,Math.min(100,(te.amount-te.used_amount)/te.amount*100))}%`}})})})]})]}),te.notes&&l.jsx("div",{className:"mt-3 pt-3 border-t border-brand-burgundy/10",children:l.jsxs("p",{className:"text-sm text-brand-burgundy/70 italic",children:["Note: ",te.notes]})})]},te.id))}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Sc,{className:"h-16 w-16 text-brand-burgundy/30 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:_?"No matching credits found":"No member credits yet"}),l.jsx("p",{className:"text-brand-burgundy/60 mb-6",children:_?"Try adjusting your search terms":"When members purchase credits for your venue, they will appear here"}),!_&&l.jsx(xt,{onClick:()=>window.open("/venue-credit-purchase?venue="+y.id,"_blank"),className:"bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:"Share Credit Purchase Link"})]})})]})]})}):l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsx("div",{className:"container py-8",children:l.jsxs("div",{className:"text-center py-16",children:[l.jsx($0,{className:"h-16 w-16 text-brand-burgundy/40 mx-auto mb-4"}),l.jsx("h2",{className:"text-2xl font-heading text-brand-burgundy mb-2",children:"No Venue Found"}),l.jsx("p",{className:"text-brand-burgundy/70 mb-6",children:"You need to have an approved venue to view member credits."}),l.jsx(xt,{onClick:()=>window.location.href="/venue-owner/register",className:"bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:"Register Your Venue"})]})})})},NFe=()=>{const{toast:e}=Ui(),[t,r]=I.useState(!0),[n,i]=I.useState(!1),[o,h]=I.useState(null),[s,p]=I.useState(null),[y,b]=I.useState([]),[_,E]=I.useState(""),[C,k]=I.useState(!1),[N,O]=I.useState(null),[R,L]=I.useState([]),[B,q]=I.useState(""),[F,H]=I.useState({receiptNumber:"",totalAmount:"",creditAmountUsed:"",cashAmountPaid:"0",receiptDate:new Date().toISOString().split("T")[0],notes:"",receiptImage:null,receiptImageUrl:""}),[Z,re]=I.useState([{itemName:"",quantity:1,unitPrice:"",category:"drinks"}]);I.useEffect(()=>{W()},[]);const W=async()=>{try{const{data:{user:Ne},error:Be}=await Ve.auth.getUser();if(Be)throw Be;if(!Ne){e({title:"Authentication Required",description:"Please log in to manage receipts",variant:"destructive"});return}h(Ne),await te(Ne.id)}catch(Ne){console.error("Auth error:",Ne),e({title:"Error",description:"Failed to authenticate user",variant:"destructive"})}finally{r(!1)}},te=async Ne=>{try{const{data:Be,error:We}=await Ve.from("venues").select("*").eq("owner_id",Ne).single();if(We){if(We.code==="PGRST116"){p(null),b([]);return}throw We}p(Be);const{data:ut,error:nt}=await Ve.from("venue_receipts").select(`
          *,
          profiles:member_user_id (
            id,
            full_name,
            email,
            first_name,
            last_name
          ),
          venue_receipt_items (*)
        `).eq("venue_id",Be.id).order("created_at",{ascending:!1});if(nt){console.error("Error fetching receipts:",nt);const{data:Pt,error:It}=await Ve.from("venue_receipts").select("*").eq("venue_id",Be.id).order("created_at",{ascending:!1});It||b(Pt||[])}else b(ut||[])}catch(Be){console.error("Error fetching venue and receipts:",Be),e({title:"Error",description:"Failed to load venue data",variant:"destructive"})}},oe=async Ne=>{if(!s||!Ne||Ne.length<2){L([]);return}try{const{data:Be,error:We}=await Ve.from("venue_credits").select(`
          user_id,
          remaining_balance,
          profiles:user_id (
            id,
            full_name,
            email,
            first_name,
            last_name
          )
        `).eq("venue_id",s.id).eq("status","active").gt("remaining_balance",0).gt("expires_at",new Date().toISOString());if(We){console.error("Error searching members:",We);return}const ut=(Be||[]).filter(nt=>{if(!nt.profiles)return!1;const Pt=nt.profiles.full_name||`${nt.profiles.first_name||""} ${nt.profiles.last_name||""}`.trim(),It=nt.profiles.email||"";return Pt.toLowerCase().includes(Ne.toLowerCase())||It.toLowerCase().includes(Ne.toLowerCase())}).map(nt=>({...nt,display_name:nt.profiles.full_name||`${nt.profiles.first_name||""} ${nt.profiles.last_name||""}`.trim()||"Unknown Member",display_email:nt.profiles.email||"No email"}));L(ut)}catch(Be){console.error("Error searching members:",Be)}},ie=async Ne=>{O(Ne),q(Ne.display_name),L([]);try{const{data:Be,error:We}=await Ve.rpc("get_member_credit_balance",{p_venue_id:s.id,p_member_user_id:Ne.user_id});!We&&Be&&O(ut=>({...ut,total_balance:Be.total_balance,active_credits:Be.active_credits||[]}))}catch(Be){console.error("Error fetching member balance:",Be)}},ue=()=>{re([...Z,{itemName:"",quantity:1,unitPrice:"",category:"drinks"}])},_e=Ne=>{Z.length>1&&re(Z.filter((Be,We)=>We!==Ne))},xe=(Ne,Be,We)=>{const ut=Z.map((nt,Pt)=>Pt===Ne?{...nt,[Be]:We}:nt);re(ut)},be=()=>Z.reduce((Ne,Be)=>{const We=parseInt(Be.quantity)||0,ut=parseFloat(Be.unitPrice)||0;return Ne+We*ut},0),Ae=async Ne=>{try{const Be=Ne.name.split(".").pop(),We=`receipt-${Date.now()}.${Be}`,{data:ut,error:nt}=await Ve.storage.from("venue-images").upload(`receipts/${We}`,Ne);if(nt)throw nt;const{data:Pt}=Ve.storage.from("venue-images").getPublicUrl(`receipts/${We}`);return Pt.publicUrl}catch(Be){throw console.error("Error uploading receipt image:",Be),Be}},me=async()=>{if(!N){e({title:"Member Required",description:"Please select a member first",variant:"destructive"});return}if(!F.totalAmount||!F.creditAmountUsed){e({title:"Amount Required",description:"Please enter both total amount and credit amount used",variant:"destructive"});return}if(!F.receiptImage){e({title:"Receipt Image Required",description:"Please upload a receipt image before submitting.",variant:"destructive"});return}i(!0);try{let Ne=F.receiptImageUrl;F.receiptImage&&(Ne=await Ae(F.receiptImage));const Be=Z.filter(at=>at.itemName&&at.unitPrice&&at.quantity).map(at=>({item_name:at.itemName,quantity:parseInt(at.quantity),unit_price:Math.round(parseFloat(at.unitPrice)*100),total_price:Math.round(parseInt(at.quantity)*parseFloat(at.unitPrice)*100),category:at.category})),{data:We,error:ut}=await Ve.rpc("process_credit_redemption",{p_venue_id:s.id,p_member_user_id:N.user_id,p_processed_by_user_id:o.id,p_receipt_number:F.receiptNumber||`R-${Date.now()}`,p_receipt_image_url:Ne,p_total_amount:Math.round(parseFloat(F.totalAmount)*100),p_credit_amount_used:Math.round(parseFloat(F.creditAmountUsed)*100),p_cash_amount_paid:Math.round(parseFloat(F.cashAmountPaid||0)*100),p_receipt_date:F.receiptDate,p_notes:F.notes,p_receipt_items:Be});if(ut)throw ut;if(!We.success){e({title:"Processing Failed",description:We.error||"Failed to process receipt",variant:"destructive"});return}e({title:"Receipt Processed! ",description:`${F.creditAmountUsed} deducted from ${N.display_name}'s credits`,className:"bg-green-500 text-white"});const nt=N.user_id,Pt=s.id,It=Math.round(parseFloat(F.creditAmountUsed)*100);console.log("Processing receipt for member:",nt,"venue:",Pt,"amount:",It),H({receiptNumber:"",totalAmount:"",creditAmountUsed:"",cashAmountPaid:"0",receiptDate:new Date().toISOString().split("T")[0],notes:"",receiptImage:null,receiptImageUrl:""}),re([{itemName:"",quantity:1,unitPrice:"",category:"drinks"}]),O(null),q(""),k(!1),await te(o.id)}catch(Ne){console.error("Error processing receipt:",Ne),e({title:"Processing Error",description:Ne.message||"Failed to process receipt",variant:"destructive"})}finally{i(!1)}},ke=y.filter(Ne=>{var ut;if(!_)return!0;const Be=((ut=Ne.profiles)==null?void 0:ut.full_name)||"Unknown Member",We=Ne.receipt_number||"";return Be.toLowerCase().includes(_.toLowerCase())||We.toLowerCase().includes(_.toLowerCase())});return t?l.jsx("div",{className:"bg-brand-cream/50 min-h-screen flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold mx-auto mb-4"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Loading receipts..."})]})}):s?l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsxs("div",{className:"container py-8",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-8",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-2",children:"Receipt Management"}),l.jsxs("p",{className:"text-brand-burgundy/70",children:["Process member purchases and manage credit redemptions for ",l.jsx("span",{className:"font-semibold",children:s.name})]})]}),l.jsxs(wd,{open:C,onOpenChange:k,children:[l.jsx(LI,{asChild:!0,children:l.jsxs(xt,{className:"bg-brand-burgundy text-white hover:bg-brand-burgundy/90 mt-4 sm:mt-0",children:[l.jsx(Fp,{className:"h-4 w-4 mr-2"}),"Process Receipt"]})}),l.jsxs(qc,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[l.jsx(Wc,{children:l.jsx(Gc,{children:"Process Member Receipt"})}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{children:"Select Member"}),l.jsxs("div",{className:"relative",children:[l.jsx(Lt,{value:B,onChange:Ne=>{q(Ne.target.value),oe(Ne.target.value)},placeholder:"Search member by name or email...",className:"border-brand-burgundy/20"}),R.length>0&&l.jsx("div",{className:"absolute z-10 w-full bg-white border border-brand-burgundy/20 rounded-md mt-1 max-h-48 overflow-y-auto",children:R.map(Ne=>l.jsxs("button",{onClick:()=>ie(Ne),className:"w-full text-left px-4 py-2 hover:bg-brand-cream/50 border-b border-brand-burgundy/10 last:border-b-0",children:[l.jsx("div",{className:"font-medium text-brand-burgundy",children:Ne.display_name}),l.jsx("div",{className:"text-sm text-brand-burgundy/70",children:Ne.display_email}),l.jsxs("div",{className:"text-sm text-brand-gold font-semibold",children:["Available: ",(Ne.remaining_balance/100).toLocaleString()]})]},Ne.user_id))})]}),N&&l.jsxs("div",{className:"p-4 bg-brand-cream/30 rounded-lg",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-brand-burgundy",children:N.display_name}),l.jsx("p",{className:"text-sm text-brand-burgundy/70",children:N.display_email})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"text-lg font-bold text-brand-gold",children:["",((N.total_balance||0)/100).toLocaleString()]}),l.jsx("div",{className:"text-sm text-brand-burgundy/70",children:"Available Credits"})]})]}),l.jsx("div",{className:"flex justify-end mt-2",children:l.jsx(xt,{type:"button",variant:"outline",size:"sm",className:"border-red-300 text-red-600 hover:bg-red-50",onClick:()=>{O(null),q("")},children:"Remove Member"})})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{children:"Receipt Number"}),l.jsx(Lt,{value:F.receiptNumber,onChange:Ne=>H({...F,receiptNumber:Ne.target.value}),placeholder:"e.g., R-001 (optional)",className:"border-brand-burgundy/20"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{children:"Receipt Date"}),l.jsx(Lt,{type:"date",value:F.receiptDate,onChange:Ne=>H({...F,receiptDate:Ne.target.value}),className:"border-brand-burgundy/20"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{children:"Total Amount ()"}),l.jsx(Lt,{type:"number",value:F.totalAmount,onChange:Ne=>H({...F,totalAmount:Ne.target.value}),placeholder:"0.00",className:"border-brand-burgundy/20"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{children:"Credit Amount Used ()"}),l.jsx(Lt,{type:"number",value:F.creditAmountUsed,onChange:Ne=>H({...F,creditAmountUsed:Ne.target.value}),placeholder:"0.00",className:"border-brand-burgundy/20"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{children:"Cash Paid ()"}),l.jsx(Lt,{type:"number",value:F.cashAmountPaid,onChange:Ne=>H({...F,cashAmountPaid:Ne.target.value}),placeholder:"0.00",className:"border-brand-burgundy/20"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx(Tt,{children:"Receipt Items (Optional)"}),l.jsxs(xt,{type:"button",onClick:ue,variant:"outline",size:"sm",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",children:[l.jsx(yE,{className:"h-4 w-4 mr-1"}),"Add Item"]})]}),Z.map((Ne,Be)=>l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-2 p-3 border border-brand-burgundy/10 rounded-lg",children:[l.jsx("div",{className:"md:col-span-2",children:l.jsx(Lt,{value:Ne.itemName,onChange:We=>xe(Be,"itemName",We.target.value),placeholder:"Item name",className:"border-brand-burgundy/20"})}),l.jsx("div",{children:l.jsx(Lt,{type:"number",value:Ne.quantity,onChange:We=>xe(Be,"quantity",We.target.value),placeholder:"Qty",className:"border-brand-burgundy/20"})}),l.jsx("div",{children:l.jsx(Lt,{type:"number",value:Ne.unitPrice,onChange:We=>xe(Be,"unitPrice",We.target.value),placeholder:"Unit Price",className:"border-brand-burgundy/20"})}),l.jsx("div",{children:l.jsxs("select",{value:Ne.category,onChange:We=>xe(Be,"category",We.target.value),className:"w-full p-2 border border-brand-burgundy/20 rounded-md",children:[l.jsx("option",{value:"drinks",children:"Drinks"}),l.jsx("option",{value:"food",children:"Food"}),l.jsx("option",{value:"service",children:"Service"}),l.jsx("option",{value:"other",children:"Other"})]})}),l.jsx("div",{className:"flex items-center justify-center",children:Z.length>1&&l.jsx(xt,{type:"button",onClick:()=>_e(Be),variant:"outline",size:"sm",className:"border-red-300 text-red-600 hover:bg-red-50",children:l.jsx(k8,{className:"h-4 w-4"})})})]},Be)),Z.some(Ne=>Ne.itemName&&Ne.unitPrice)&&l.jsx("div",{className:"text-right text-brand-burgundy",children:l.jsxs("strong",{children:["Items Total: ",be().toFixed(2)]})})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{children:"Receipt Image"}),l.jsx(Lt,{type:"file",accept:"image/*",onChange:Ne=>H({...F,receiptImage:Ne.target.files[0]}),className:"border-brand-burgundy/20"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{children:"Notes (Optional)"}),l.jsx(ag,{value:F.notes,onChange:Ne=>H({...F,notes:Ne.target.value}),placeholder:"Additional notes about this transaction...",className:"border-brand-burgundy/20"})]}),l.jsx(xt,{onClick:me,disabled:n||!N,className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:n?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Pm,{className:"h-4 w-4 mr-2"}),"Process Receipt"]})})]})]})]})]}),l.jsx("div",{className:"mb-6",children:l.jsxs("div",{className:"relative max-w-md",children:[l.jsx(gd,{className:"absolute left-3 top-3 h-4 w-4 text-brand-burgundy/40"}),l.jsx(Lt,{value:_,onChange:Ne=>E(Ne.target.value),placeholder:"Search receipts by member name or receipt number...",className:"pl-10 border-brand-burgundy/20"})]})}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center",children:[l.jsx(Fp,{className:"h-5 w-5 mr-2"}),"Recent Receipts (",ke.length,")"]})}),l.jsx(Ht,{children:ke.length>0?l.jsx("div",{className:"space-y-4",children:ke.map(Ne=>{var Be;return l.jsxs(tt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-brand-burgundy/10 rounded-lg p-4 hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[l.jsxs("div",{className:"flex items-start space-x-4 mb-4 sm:mb-0",children:[l.jsx("div",{className:"p-2 bg-brand-burgundy/10 rounded-full",children:l.jsx(Fp,{className:"h-5 w-5 text-brand-burgundy"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-brand-burgundy",children:((Be=Ne.profiles)==null?void 0:Be.full_name)||"Unknown Member"}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Receipt #",Ne.receipt_number||"N/A"]}),l.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-brand-burgundy/60",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(ma,{className:"h-3 w-3 mr-1"}),new Date(Ne.created_at).toLocaleDateString()]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx(ml,{className:"h-3 w-3 mr-1"}),new Date(Ne.created_at).toLocaleTimeString()]})]})]})]}),l.jsxs("div",{className:"flex flex-col sm:items-end space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"font-bold text-brand-burgundy",children:["Total: ",(Ne.total_amount/100).toLocaleString()]}),l.jsxs("div",{className:"text-sm text-brand-gold",children:["Credits: ",(Ne.credit_amount_used/100).toLocaleString()]}),Ne.cash_amount_paid>0&&l.jsxs("div",{className:"text-sm text-brand-burgundy/70",children:["Cash: ",(Ne.cash_amount_paid/100).toLocaleString()]})]}),l.jsx(Yr,{className:`${Ne.status==="completed"?"bg-green-100 text-green-800":Ne.status==="pending"?"bg-yellow-100 text-yellow-800":Ne.status==="refunded"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:Ne.status})]}),Ne.receipt_image_url&&l.jsxs(xt,{variant:"outline",size:"sm",onClick:()=>window.open(Ne.receipt_image_url,"_blank"),className:"border-brand-burgundy/20 text-brand-burgundy hover:bg-brand-burgundy/10",children:[l.jsx(cl,{className:"h-4 w-4 mr-1"}),"View Image"]})]})]}),Ne.notes&&l.jsx("div",{className:"mt-3 p-3 bg-brand-cream/30 rounded-lg",children:l.jsx("p",{className:"text-sm text-brand-burgundy/70",children:Ne.notes})})]},Ne.id)})}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Fp,{className:"h-16 w-16 text-brand-burgundy/30 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"No Receipts Found"}),l.jsx("p",{className:"text-brand-burgundy/60 mb-6",children:_?"No receipts match your search criteria.":"Start processing member receipts to see them here."}),!_&&l.jsxs(xt,{onClick:()=>k(!0),className:"bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:[l.jsx(Fp,{className:"h-4 w-4 mr-2"}),"Process First Receipt"]})]})})]})]})}):l.jsx("div",{className:"bg-brand-cream/50 min-h-screen flex items-center justify-center",children:l.jsx(Mt,{className:"max-w-md",children:l.jsxs(Ht,{className:"text-center py-8",children:[l.jsx($0,{className:"h-12 w-12 text-brand-burgundy/30 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"No Venue Found"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"You need to have an approved venue to manage receipts."})]})})})},kFe=()=>{console.log(" ADMIN VenueApprovalsPage component loaded - this should ONLY be at /admin/venue-approvals");const[e,t]=I.useState([]),[r,n]=I.useState(!0),[i,o]=I.useState(null),[h,s]=I.useState(!1);I.useEffect(()=>{p()},[]);const p=async()=>{try{const{data:C,error:k}=await Ve.from("pending_venue_owner_requests").select("*").order("created_at",{ascending:!1});if(k)throw k;t(C||[])}catch(C){console.error("Error loading requests:",C)}finally{n(!1)}},y=async C=>{s(!0);try{const k=C.venue_type||"restaurant";console.log(" Venue type from request:",{original:C.venue_type,using:k});const{data:N,error:O}=await Ve.from("venue_owners").select("*").eq("owner_email",C.email).eq("status","pending_approval").single();if(O||!N)throw console.error(" Could not find existing venue owner record:",O),new Error(`Could not find venue owner record for ${C.email}. Make sure they have completed the registration process first.`);console.log(" Found existing venue owner record:",N);const{data:R,error:L}=await Ve.from("venues").insert([{name:C.venue_name,description:C.additional_info,type:k,price_range:C.price_range||"$$",address:C.venue_address,city:C.venue_city,state:C.venue_city,country:C.venue_country,latitude:6.5244,longitude:3.3792,contact_phone:C.contact_phone,contact_email:C.email,owner_id:N.user_id,status:"approved",is_active:!0}]).select().single();if(L)throw L;console.log(" Venue created with owner_id:",R.owner_id);const{error:B}=await Ve.from("venue_owners").update({venue_id:R.id,status:"active"}).eq("id",N.id);if(B)throw B;await Ve.from("pending_venue_owner_requests").update({status:"approved"}).eq("id",C.id);try{const q={email:C.email,contact_name:C.contact_name,owner_name:C.contact_name,venue_name:C.venue_name,venue_type:k,venue_address:C.venue_address,venue_city:C.venue_city},{sendVenueOwnerApplicationApproved:F}=await Os(()=>Promise.resolve().then(()=>mFe),void 0);await F(q),console.log(" Approval notification email sent")}catch(q){console.error(" Failed to send approval email:",q)}await p(),alert(`Venue owner approved successfully! ${C.contact_name} can now access their venue dashboard. The venue "${C.venue_name}" is now live with proper owner linking.`)}catch(k){console.error("Error approving request:",k),alert("Error approving request: "+k.message)}finally{s(!1)}},b=async C=>{s(!0);try{await Ve.from("pending_venue_owner_requests").update({status:"rejected"}).eq("id",C.id),await p(),alert("Request rejected successfully!")}catch(k){console.error("Error rejecting request:",k),alert("Error rejecting request: "+k.message)}finally{s(!1)}},_=C=>{switch(C){case"pending":return l.jsx(Yr,{variant:"outline",className:"border-yellow-500 text-yellow-700",children:"Pending"});case"approved":return l.jsx(Yr,{variant:"outline",className:"border-green-500 text-green-700",children:"Approved"});case"rejected":return l.jsx(Yr,{variant:"outline",className:"border-red-500 text-red-700",children:"Rejected"});default:return l.jsx(Yr,{variant:"outline",children:C})}},E=C=>new Date(C).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return r?l.jsx("div",{className:"min-h-screen bg-brand-cream/50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-burgundy mx-auto"}),l.jsx("p",{className:"mt-4 text-brand-burgundy",children:"Loading venue applications..."})]})}):l.jsx("div",{className:"min-h-screen bg-brand-cream/50",children:l.jsxs("div",{className:"container mx-auto py-8 px-4",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-3 bg-brand-burgundy/10 rounded-full",children:l.jsx(yd,{className:"h-8 w-8 text-brand-burgundy"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-brand-burgundy",children:"Venue Owner Applications"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Review and manage venue partnership requests"})]})]}),l.jsxs("div",{className:"flex gap-4 text-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),l.jsxs("span",{children:["Pending: ",e.filter(C=>C.status==="pending").length]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),l.jsxs("span",{children:["Approved: ",e.filter(C=>C.status==="approved").length]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),l.jsxs("span",{children:["Rejected: ",e.filter(C=>C.status==="rejected").length]})]})]})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:e.map((C,k)=>l.jsx(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:k*.1},children:l.jsxs(Mt,{className:"h-full hover:shadow-lg transition-shadow",children:[l.jsx(Dr,{className:"pb-4",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx(Lr,{className:"text-lg text-brand-burgundy mb-2",children:C.venue_name}),l.jsxs("div",{className:"flex items-center gap-2 text-sm text-brand-burgundy/70",children:[l.jsx($c,{className:"h-4 w-4"}),l.jsx("span",{children:C.venue_type||"Restaurant"})]})]}),_(C.status)]})}),l.jsxs(Ht,{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs("h4",{className:"font-semibold text-brand-burgundy flex items-center gap-2",children:[l.jsx(Kn,{className:"h-4 w-4"}),"Owner Details"]}),l.jsxs("div",{className:"space-y-1 text-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Vx,{className:"h-3 w-3 text-brand-burgundy/50"}),l.jsx("span",{children:C.email})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Am,{className:"h-3 w-3 text-brand-burgundy/50"}),l.jsx("span",{children:C.contact_phone})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Kn,{className:"h-3 w-3 text-brand-burgundy/50"}),l.jsx("span",{children:C.contact_name})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("h4",{className:"font-semibold text-brand-burgundy flex items-center gap-2",children:[l.jsx(qs,{className:"h-4 w-4"}),"Location"]}),l.jsxs("div",{className:"space-y-1 text-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(qs,{className:"h-3 w-3 text-brand-burgundy/50"}),l.jsx("span",{children:C.venue_address})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(N8,{className:"h-3 w-3 text-brand-burgundy/50"}),l.jsxs("span",{children:[C.venue_city,", ",C.venue_country]})]})]})]}),C.additional_info&&l.jsxs("div",{className:"space-y-2",children:[l.jsxs("h4",{className:"font-semibold text-brand-burgundy flex items-center gap-2",children:[l.jsx(J3,{className:"h-4 w-4"}),"Description"]}),l.jsx("p",{className:"text-sm text-brand-burgundy/70 line-clamp-3",children:C.additional_info})]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm text-brand-burgundy/60",children:[l.jsx(ma,{className:"h-3 w-3"}),l.jsxs("span",{children:["Applied: ",E(C.created_at)]})]}),l.jsxs("div",{className:"flex gap-2 pt-4 border-t border-brand-burgundy/10",children:[l.jsxs(xt,{variant:"outline",size:"sm",className:"flex-1 border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10",onClick:()=>o(C),children:[l.jsx(cl,{className:"h-4 w-4 mr-2"}),"View Details"]}),C.status==="pending"&&l.jsxs(l.Fragment,{children:[l.jsxs(xt,{size:"sm",className:"flex-1 bg-green-600 hover:bg-green-700 text-white",onClick:()=>y(C),disabled:h,children:[l.jsx(Pm,{className:"h-4 w-4 mr-2"}),h?"Processing...":"Approve"]}),l.jsxs(xt,{size:"sm",variant:"destructive",className:"flex-1",onClick:()=>b(C),disabled:h,children:[l.jsx(j1,{className:"h-4 w-4 mr-2"}),h?"Processing...":"Reject"]})]})]})]})]})},C.id))}),e.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(yd,{className:"h-16 w-16 text-brand-burgundy/30 mx-auto mb-4"}),l.jsx("h3",{className:"text-xl font-semibold text-brand-burgundy mb-2",children:"No Applications Yet"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"When venue owners submit applications, they will appear here for review."})]}),i&&l.jsx(wd,{open:!!i,onOpenChange:()=>o(null),children:l.jsxs(qc,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[l.jsx(Wc,{children:l.jsxs(Gc,{className:"text-xl text-brand-burgundy",children:[i.venue_name," - Application Details"]})}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg",children:[l.jsxs("h3",{className:"font-semibold text-brand-burgundy mb-3 flex items-center gap-2",children:[l.jsx(Kn,{className:"h-5 w-5"}),"Owner Information"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Full Name"}),l.jsx("p",{className:"text-brand-burgundy",children:i.contact_name})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Email Address"}),l.jsx("p",{className:"text-brand-burgundy",children:i.email})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Phone Number"}),l.jsx("p",{className:"text-brand-burgundy",children:i.contact_phone})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Application Date"}),l.jsx("p",{className:"text-brand-burgundy",children:E(i.created_at)})]})]})]}),l.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg",children:[l.jsxs("h3",{className:"font-semibold text-brand-burgundy mb-3 flex items-center gap-2",children:[l.jsx($c,{className:"h-5 w-5"}),"Venue Information"]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Venue Name"}),l.jsx("p",{className:"text-brand-burgundy font-semibold",children:i.venue_name})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Venue Type"}),l.jsx("p",{className:"text-brand-burgundy",children:i.venue_type||"Restaurant"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Description"}),l.jsx("p",{className:"text-brand-burgundy",children:i.additional_info||"No description provided"})]})]})]}),l.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg",children:[l.jsxs("h3",{className:"font-semibold text-brand-burgundy mb-3 flex items-center gap-2",children:[l.jsx(qs,{className:"h-5 w-5"}),"Location Details"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Address"}),l.jsx("p",{className:"text-brand-burgundy",children:i.venue_address})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"City"}),l.jsx("p",{className:"text-brand-burgundy",children:i.venue_city})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Country"}),l.jsx("p",{className:"text-brand-burgundy",children:i.venue_country})]})]})]}),l.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg",children:[l.jsxs("h3",{className:"font-semibold text-brand-burgundy mb-3 flex items-center gap-2",children:[l.jsx(J3,{className:"h-5 w-5"}),"Additional Details"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Opening Hours"}),l.jsx("p",{className:"text-brand-burgundy",children:i.opening_hours||"Not specified"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Capacity"}),l.jsx("p",{className:"text-brand-burgundy",children:i.capacity||"Not specified"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Price Range"}),l.jsx("p",{className:"text-brand-burgundy",children:i.price_range||"Not specified"})]})]})]}),i.status==="pending"&&l.jsxs("div",{className:"flex gap-3 pt-4 border-t border-brand-burgundy/10",children:[l.jsxs(xt,{className:"flex-1 bg-green-600 hover:bg-green-700 text-white",onClick:()=>{y(i),o(null)},disabled:h,children:[l.jsx(Pm,{className:"h-4 w-4 mr-2"}),h?"Processing...":"Approve Application"]}),l.jsxs(xt,{variant:"destructive",className:"flex-1",onClick:()=>{b(i),o(null)},disabled:h,children:[l.jsx(j1,{className:"h-4 w-4 mr-2"}),h?"Processing...":"Reject Application"]})]})]})]})})]})})},MFe=W7("pk_live_51RcBmaD82xmrCdK7zUZNtJKtO1Cx8Vld8hH2sARagshct2ivP38bavj7tP77gIhK8yo4FEwShNPkjX7VRex3rSWw00IYtFuuxt"),IFe=()=>{var Fa;console.log(" UserProfilePage component is rendering");const{user:e,signIn:t,signUp:r,signOut:n}=Pd();console.log(" Current user:",e);const i=ts(),o=Gl(),[h,s]=I.useState(!1),[p,y]=I.useState({email:"",password:""}),[b,_]=I.useState({email:"",password:"",confirm:"",firstName:"",lastName:"",age:"",phone:"",city:"",country:""}),[E,C]=I.useState(null),[k,N]=I.useState(null),[O,R]=I.useState(null),[L,B]=I.useState(null),[q,F]=I.useState(null),[H,Z]=I.useState([]),[re,W]=I.useState([]);I.useState("");const[te,oe]=I.useState(!1),[ie,ue]=I.useState({first_name:"",last_name:"",phone_number:"",city:"",country:"",age:""}),[_e,xe]=I.useState([]),[be,Ae]=I.useState([]),[me,ke]=I.useState(!0),[Ne,Be]=I.useState(null),[We,ut]=I.useState(null),[nt,Pt]=I.useState(null);I.useState(null);const[It,at]=I.useState(null),[Ut,ct]=I.useState(null),[gt,it]=I.useState([]),[rt,rr]=I.useState(!1),[ir,or]=I.useState(!1),[Sr,tn]=I.useState(!1),[Mn,vn]=I.useState(!1);I.useEffect(()=>{e&&(qi(),Zs())},[e]),I.useEffect(()=>{if(!e)return;ke(!0),(async()=>{try{const{data:Kt,error:Ar}=await Ve.from("split_payment_requests").select("*").eq("requester_id",e.id).order("created_at",{ascending:!1}),{data:Zr,error:In}=await Ve.from("split_payment_requests").select("*").eq("recipient_id",e.id).order("created_at",{ascending:!1});if(Ar||In)throw Ar||In;xe(Kt||[]),Ae(Zr||[]),Be(null),(Zr||[]).find(Wi=>Wi.status==="pending"&&!Wi.seen_by_recipient)&&ut("You have a new split payment request!")}catch{Be("Failed to load split payment requests.")}finally{ke(!1)}})()},[e]);const Zs=async()=>{if(e){rr(!0);try{const{data:ft,error:Kt}=await Ve.from("venue_credits").select("*").eq("user_id",e.id).eq("status","active").gt("remaining_balance",0).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(Kt)throw Kt;const Ar=await Promise.all((ft||[]).map(async Zr=>{try{const{data:In,error:Ii}=await Ve.from("venues").select("id, name, address, type, city").eq("id",Zr.venue_id).single();!Ii&&In?Zr.venues=In:Zr.venues={id:Zr.venue_id,name:"Unknown Venue",address:"Address not available",type:"Venue",city:"City not available"}}catch(In){console.error("Error fetching venue data:",In),Zr.venues={id:Zr.venue_id,name:"Unknown Venue",address:"Address not available",type:"Venue",city:"City not available"}}return Zr}));it(Ar)}catch(ft){console.error("Error loading venue credits:",ft)}finally{rr(!1)}}},qi=async()=>{try{let{data:ft,error:Kt}=await Ve.from("profiles").select("*").eq("id",e.id).single();if(Kt&&Kt.code==="PGRST116"){console.log("Profile not found, attempting to create or update...");const{data:Wi,error:Ua}=await Ve.from("profiles").upsert([{id:e.id,first_name:"",last_name:"",phone:"",city:"",country:"",age:null}]).select().single();if(Ua){console.error("Error creating/updating profile:",Ua);const{data:Oi,error:wo}=await Ve.from("profiles").select("*").eq("id",e.id).single();!wo&&Oi&&(F(Oi),ue({first_name:Oi.first_name||"",last_name:Oi.last_name||"",phone_number:Oi.phone||"",city:Oi.city||"",country:Oi.country||"",age:Oi.age||""}))}else F(Wi),ue({first_name:Wi.first_name||"",last_name:Wi.last_name||"",phone_number:Wi.phone||"",city:Wi.city||"",country:Wi.country||"",age:Wi.age||""})}else Kt?console.error("Profile error:",Kt):(F(ft),ue({first_name:ft.first_name||"",last_name:ft.last_name||"",phone_number:ft.phone||"",city:ft.city||"",country:ft.country||"",age:ft.age||""}));const{data:Ar,error:Zr}=await Ve.from("saved_venues").select(`
          *,
          venues (
            id,
            name,
            type,
            city,
            rating
          )
        `).eq("user_id",e.id);Zr?(console.error("Saved venues error:",Zr),Z([])):Z(Ar||[]);const{data:In,error:Ii}=await Ve.from("bookings").select(`
          *,
          venues (
            id,
            name,
            type,
            city,
            address
          ),
          venue_tables!table_id (
            id,
            table_number
          )
        `).eq("user_id",e.id).order("booking_date",{ascending:!1});Ii?(console.error("Bookings error:",Ii),W([])):W(In||[])}catch(ft){console.error("Error loading user data:",ft)}},ns=async()=>{try{const{data:ft,error:Kt}=await Ve.from("profiles").update({first_name:ie.first_name,last_name:ie.last_name,phone:ie.phone_number,city:ie.city,country:ie.country,age:ie.age?parseInt(ie.age):null}).eq("id",e.id).select().single();if(Kt)throw Kt;F(ft),oe(!1),console.log("Profile updated successfully")}catch(ft){console.error("Error updating profile:",ft)}},ms=async ft=>{ft.preventDefault();try{const{error:Kt}=await t(p);if(Kt)throw Kt}catch(Kt){C(Kt.message)}},xa=async ft=>{if(ft.preventDefault(),b.password!==b.confirm){N("Passwords do not match");return}try{console.log(" DEBUG: UserProfilePage signup payload:",{email:b.email,firstName:b.firstName,lastName:b.lastName,city:b.city,country:b.country});const{data:Kt,error:Ar}=await Ve.auth.signUp({email:b.email,password:b.password,options:{data:{first_name:b.firstName,last_name:b.lastName,age:b.age,city:b.city,country:b.country,phone:b.phone}}});if(console.log(" DEBUG: Auth response:",{signUpData:Kt,signUpError:Ar}),Ar){console.error(" DEBUG: Sign up error:",Ar),N(Ar.message);return}console.log(" DEBUG: Auth signup successful, user created:",Kt.user);const In={id:Kt.user.id,first_name:b.firstName,last_name:b.lastName,age:b.age?parseInt(b.age):null,phone:b.phone,city:b.city,country:b.country,email:b.email};console.log(" DEBUG: Profile data for upsert:",In);const{error:Ii}=await Ve.from("profiles").upsert([In]);if(console.log(" DEBUG: Profile upsert result:",{profileError:Ii}),Ii){console.error(" DEBUG: Upsert error:",Ii),N(Ii.message);return}console.log(" DEBUG: Profile created successfully"),R("Account created successfully! Please check your email to confirm your account.")}catch(Kt){console.error(" DEBUG: Unexpected error during signup:",Kt),N(Kt.message)}};return e?l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsxs("div",{className:"container py-8",children:[l.jsxs("div",{className:"flex justify-between items-center mb-8",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-2",children:"My Profile"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Manage your account and preferences"})]}),l.jsx(xt,{onClick:n,variant:"outline",className:"border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10",children:"Sign Out"})]}),l.jsxs(wg,{defaultValue:((Fa=o.state)==null?void 0:Fa.activeTab)||"profile",className:"space-y-4",children:[l.jsxs(Sf,{className:"bg-white p-1 rounded-lg border border-brand-burgundy/10 grid grid-cols-2 md:grid-cols-7 h-auto",children:[l.jsxs(Ci,{value:"profile",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[l.jsx(Kn,{className:"h-3 w-3 md:h-4 md:w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Profile"}),l.jsx("span",{className:"sm:hidden",children:"Profile"})]}),l.jsxs(Ci,{value:"saved",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[l.jsx(Fx,{className:"h-3 w-3 md:h-4 md:w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Saved"}),l.jsx("span",{className:"sm:hidden",children:"Saved"})]}),l.jsxs(Ci,{value:"bookings",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[l.jsx(ma,{className:"h-3 w-3 md:h-4 md:w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Bookings"}),l.jsx("span",{className:"sm:hidden",children:"Bookings"})]}),l.jsxs(Ci,{value:"settings",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[l.jsx(Yh,{className:"h-3 w-3 md:h-4 md:w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Settings"}),l.jsx("span",{className:"sm:hidden",children:"Settings"})]}),l.jsxs(Ci,{value:"split-payments",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[l.jsx(ax,{className:"h-3 w-3 md:h-4 md:w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Split Payments"}),l.jsx("span",{className:"sm:hidden",children:"Split"})]}),l.jsxs(Ci,{value:"wallet",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[l.jsx(Sc,{className:"h-3 w-3 md:h-4 md:w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Wallet"}),l.jsx("span",{className:"sm:hidden",children:"Wallet"})]})]}),l.jsx(Pi,{value:"profile",children:l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold",children:"Profile Information"}),q&&!te&&l.jsx(xt,{onClick:()=>oe(!0),variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",children:"Edit Profile"})]}),q?te?l.jsxs("div",{className:"space-y-4 max-w-md",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Email"}),l.jsxs("p",{className:"text-sm text-brand-burgundy/50",children:[e.email," (cannot be changed)"]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"First Name"}),l.jsx(Lt,{value:ie.first_name,onChange:ft=>ue(Kt=>({...Kt,first_name:ft.target.value})),placeholder:"Enter first name"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Last Name"}),l.jsx(Lt,{value:ie.last_name,onChange:ft=>ue(Kt=>({...Kt,last_name:ft.target.value})),placeholder:"Enter last name"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Phone Number"}),l.jsx(Lt,{value:ie.phone_number,onChange:ft=>ue(Kt=>({...Kt,phone_number:ft.target.value})),placeholder:"Enter phone number"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Age"}),l.jsx(Lt,{type:"number",value:ie.age,onChange:ft=>ue(Kt=>({...Kt,age:ft.target.value})),placeholder:"Enter age",min:1})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"City"}),l.jsx(Lt,{value:ie.city,onChange:ft=>ue(Kt=>({...Kt,city:ft.target.value})),placeholder:"Enter city"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Country"}),l.jsx(Lt,{value:ie.country,onChange:ft=>ue(Kt=>({...Kt,country:ft.target.value})),placeholder:"Enter country"})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(xt,{onClick:ns,className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Save Changes"}),l.jsx(xt,{onClick:()=>{oe(!1),ue({first_name:q.first_name||"",last_name:q.last_name||"",phone_number:q.phone||"",city:q.city||"",country:q.country||"",age:q.age||""})},variant:"outline",className:"border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10",children:"Cancel"})]})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Email"}),l.jsx("p",{className:"mt-1",children:e.email})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Name"}),l.jsx("p",{className:"mt-1",children:q.first_name||q.last_name?`${q.first_name} ${q.last_name}`:"Not set"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Phone"}),l.jsx("p",{className:"mt-1",children:q.phone||"Not set"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Age"}),l.jsx("p",{className:"mt-1",children:q.age||"Not set"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"City"}),l.jsx("p",{className:"mt-1",children:q.city||"Not set"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Country"}),l.jsx("p",{className:"mt-1",children:q.country||"Not set"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Member Since"}),l.jsx("p",{className:"mt-1",children:new Date(q.created_at||e.created_at).toLocaleDateString()})]})]}):l.jsx("p",{children:"Loading profile..."})]})})}),l.jsx(Pi,{value:"saved",children:l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Saved Venues"}),H.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:H.map(ft=>l.jsxs(Mt,{className:"p-4",children:[l.jsx("h3",{className:"font-semibold",children:ft.venues.name}),l.jsx("p",{className:"text-sm text-brand-burgundy/70",children:ft.venues.type}),l.jsx(xt,{onClick:async()=>{try{const{error:Kt}=await Ve.from("saved_venues").delete().eq("user_id",e.id).eq("venue_id",ft.venue_id);if(Kt)throw Kt;Z(Ar=>Ar.filter(Zr=>Zr.id!==ft.id))}catch(Kt){console.error("Error removing saved venue:",Kt)}},variant:"outline",className:"mt-2 text-red-500 border-red-500 hover:bg-red-50",children:"Remove"})]},ft.id))}):l.jsx("p",{children:"No saved venues yet"})]})})}),l.jsx(Pi,{value:"bookings",children:l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",children:"My Bookings"}),re.length>0?l.jsx("div",{className:"space-y-4",children:re.map(ft=>{var Kt;return l.jsx(Mt,{className:"p-4",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold",children:((Kt=ft.venues)==null?void 0:Kt.name)||"Venue not found"}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[ft.booking_date?new Date(ft.booking_date).toLocaleDateString():"Date not set"," at ",ft.start_time||"Time not set"]}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[ft.number_of_guests||ft.guest_count||0," guests"]}),ft.venue_tables&&l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Table: ",ft.venue_tables.table_number]}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Total: ",(ft.total_amount||0).toLocaleString()]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-sm font-medium text-brand-burgundy",children:ft.status?ft.status.charAt(0).toUpperCase()+ft.status.slice(1):"Unknown"}),(ft.status==="confirmed"||ft.status==="pending")&&l.jsx(xt,{onClick:async()=>{try{const{error:Ar}=await Ve.from("bookings").update({status:"cancelled",updated_at:new Date().toISOString()}).eq("id",ft.id);if(Ar)throw Ar;W(Zr=>Zr.map(In=>In.id===ft.id?{...In,status:"cancelled"}:In))}catch(Ar){console.error("Error cancelling booking:",Ar)}},variant:"outline",className:"mt-2 text-red-500 border-red-500 hover:bg-red-50",children:"Cancel"})]})]})},ft.id)})}):l.jsx("p",{children:"No bookings yet"})]})})}),l.jsx(Pi,{value:"settings",children:l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs("div",{className:"p-2 sm:p-4 md:p-6 space-y-10",children:[l.jsxs("div",{className:"space-y-2 pb-8 border-b border-brand-burgundy/10",children:[l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Change Password"}),l.jsx(OFe,{user:e})]}),l.jsxs("div",{className:"space-y-2 pb-8 border-b border-brand-burgundy/10",children:[l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Payment Details"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Payment management coming soon..."})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Referral Codes"}),l.jsx(RFe,{user:e})]})]})})}),l.jsx(Pi,{value:"split-payments",children:l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Split Payments"}),We&&l.jsxs("div",{className:"mb-4 p-3 rounded bg-brand-gold/20 text-brand-burgundy flex items-center gap-2",children:[l.jsx(ax,{className:"h-4 w-4"}),We]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Requests You've Sent"}),me?l.jsx("p",{children:"Loading..."}):_e.length===0?l.jsx("p",{children:"No sent requests."}):l.jsx("div",{className:"space-y-3",children:_e.map(ft=>{var Kt;return l.jsx(Mt,{className:"p-3 flex flex-col gap-2 border border-brand-burgundy/10",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"font-medium",children:["To: ",ft.recipient_phone||ft.recipient_id]}),l.jsxs("div",{className:"text-sm text-brand-burgundy/70",children:["Amount: ",(Kt=ft.amount)==null?void 0:Kt.toLocaleString()]}),l.jsxs("div",{className:"text-xs text-brand-burgundy/50",children:["Status: ",ft.status]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(xt,{size:"icon",variant:"outline",onClick:()=>navigator.clipboard.writeText(ft.payment_link),title:"Copy Payment Link",children:l.jsx(Eie,{className:"h-4 w-4"})}),ft.status==="pending"&&l.jsx(xt,{size:"icon",variant:"outline",onClick:async()=>{await Ve.from("split_payment_requests").update({status:"cancelled"}).eq("id",ft.id),xe(Ar=>Ar.map(Zr=>Zr.id===ft.id?{...Zr,status:"cancelled"}:Zr))},title:"Cancel",children:l.jsx(j1,{className:"h-4 w-4 text-red-500"})})]})]})},ft.id)})})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Requests You've Received"}),me?l.jsx("p",{children:"Loading..."}):be.length===0?l.jsx("p",{children:"No received requests."}):l.jsx("div",{className:"space-y-3",children:be.map(ft=>{var Kt;return l.jsx(Mt,{className:"p-3 flex flex-col gap-2 border border-brand-burgundy/10",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"font-medium",children:["From: ",ft.requester_id]}),l.jsxs("div",{className:"text-sm text-brand-burgundy/70",children:["Amount: ",(Kt=ft.amount)==null?void 0:Kt.toLocaleString()]}),l.jsxs("div",{className:"text-xs text-brand-burgundy/50",children:["Status: ",ft.status]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(xt,{size:"icon",variant:"outline",onClick:()=>navigator.clipboard.writeText(ft.payment_link),title:"Copy Payment Link",children:l.jsx(Nie,{className:"h-4 w-4"})}),ft.status==="pending"&&l.jsx(xt,{size:"icon",variant:"outline",onClick:()=>Pt(ft),title:"Pay",children:l.jsx(ax,{className:"h-4 w-4 text-brand-gold"})}),ft.status==="paid"&&Ut&&l.jsx(xt,{size:"sm",variant:"outline",onClick:()=>{},title:"View Booking",children:"View Booking"})]})]})},ft.id)})})]})]}),Ne&&l.jsx("div",{className:"text-red-500 mt-4",children:Ne}),nt&&l.jsx($7,{stripe:MFe,children:l.jsx(DFe,{request:nt,onClose:()=>Pt(null),onSuccess:async ft=>{at("Payment successful!"),Pt(null),await Ve.from("split_payment_requests").update({status:"paid",stripe_payment_id:ft.id}).eq("id",nt.id),Ae(Ar=>Ar.map(Zr=>Zr.id===nt.id?{...Zr,status:"paid"}:Zr));const{data:Kt}=await Ve.from("split_payment_requests").select("*").eq("booking_id",nt.booking_id);if(Kt&&Kt.every(Ar=>Ar.status==="paid")){await Ve.from("bookings").update({status:"confirmed"}).eq("id",nt.booking_id);const{data:Ar}=await Ve.from("bookings").select("id, booking_reference").eq("id",nt.booking_id).single();ct((Ar==null?void 0:Ar.booking_reference)||(Ar==null?void 0:Ar.id))}}})}),It&&l.jsxs("div",{className:"mt-4 p-3 rounded bg-green-100 text-green-800",children:[It," ",Ut&&l.jsxs("span",{children:["Booking Ref: ",l.jsx("span",{className:"font-bold",children:Ut})]})]})]})})}),l.jsx(Pi,{value:"wallet",children:l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl sm:text-2xl font-heading text-brand-burgundy mb-2",children:"Venue Credits"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Manage your credits for faster bookings at your favorite venues"})]}),l.jsxs(xt,{onClick:()=>i("/venue-credit-purchase"),className:"bg-brand-burgundy text-white hover:bg-brand-burgundy/90 mt-4 sm:mt-0",children:[l.jsx(Sc,{className:"h-4 w-4 mr-2"}),"Purchase Credits"]})]}),rt?l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-gold"})}):gt.length>0?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10 text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-brand-burgundy",children:gt.length}),l.jsx("div",{className:"text-sm text-brand-burgundy/70",children:"Active Venues"})]}),l.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10 text-center",children:[l.jsxs("div",{className:"text-2xl font-bold text-brand-gold",children:["",gt.reduce((ft,Kt)=>ft+Kt.remaining_balance/100,0).toLocaleString()]}),l.jsx("div",{className:"text-sm text-brand-burgundy/70",children:"Total Available"})]}),l.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10 text-center",children:[l.jsxs("div",{className:"text-2xl font-bold text-brand-burgundy",children:["",gt.reduce((ft,Kt)=>ft+Kt.amount/100,0).toLocaleString()]}),l.jsx("div",{className:"text-sm text-brand-burgundy/70",children:"Total Purchased"})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy",children:"Your Venue Credits"}),gt.map(ft=>l.jsxs("div",{className:"border border-brand-burgundy/10 rounded-lg p-4 hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[l.jsxs("div",{className:"mb-3 sm:mb-0",children:[l.jsx("h4",{className:"font-semibold text-brand-burgundy",children:ft.venues.name}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[ft.venues.type,"  ",ft.venues.city]}),l.jsxs("p",{className:"text-xs text-brand-burgundy/60 mt-1",children:["Purchased: ",new Date(ft.created_at).toLocaleDateString()]})]}),l.jsxs("div",{className:"flex flex-col sm:items-end",children:[l.jsxs("div",{className:"text-lg font-bold text-brand-gold",children:["",(ft.remaining_balance/100).toLocaleString()]}),l.jsxs("div",{className:"text-sm text-brand-burgundy/70",children:["of ",(ft.amount/100).toLocaleString()]}),ft.used_amount>0&&l.jsxs("div",{className:"text-xs text-brand-burgundy/60",children:["Used: ",(ft.used_amount/100).toLocaleString()]}),l.jsxs("div",{className:"text-xs text-brand-burgundy/50 mt-1",children:["Expires: ",new Date(ft.expires_at).toLocaleDateString()]})]})]}),l.jsx("div",{className:"mt-3",children:l.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-brand-gold rounded-full h-2 transition-all duration-300",style:{width:`${Math.max(0,Math.min(100,(ft.amount-ft.used_amount)/ft.amount*100))}%`}})})})]},ft.id))]})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Sc,{className:"h-16 w-16 text-brand-burgundy/30 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"No Venue Credits"}),l.jsx("p",{className:"text-brand-burgundy/60 mb-6",children:"Purchase credits at your favorite venues for faster bookings and exclusive benefits."}),l.jsxs(xt,{onClick:()=>i("/venue-credit-purchase"),className:"bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:[l.jsx(Sc,{className:"h-4 w-4 mr-2"}),"Purchase Your First Credits"]})]})]})})})]})]})}):l.jsx("div",{className:"min-h-screen bg-brand-cream/50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"max-w-md w-full space-y-8",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"text-3xl font-heading text-brand-burgundy",children:h?"Create Account":"Welcome Back"}),l.jsx("p",{className:"mt-2 text-brand-burgundy/70",children:h?"Join Eddys Members today":"Sign in to your account"})]}),h?l.jsxs("form",{onSubmit:xa,className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsx("input",{type:"text",name:"firstName",placeholder:"First Name",value:b.firstName,onChange:ft=>_({...b,firstName:ft.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),l.jsx("input",{type:"text",name:"lastName",placeholder:"Last Name",value:b.lastName,onChange:ft=>_({...b,lastName:ft.target.value}),className:"w-full border p-2 rounded bg-white",required:!0})]}),l.jsx("input",{type:"email",name:"email",placeholder:"Email",value:b.email,onChange:ft=>_({...b,email:ft.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:Sr?"text":"password",name:"password",placeholder:"Password",value:b.password,onChange:ft=>_({...b,password:ft.target.value}),className:"w-full border p-2 pr-10 rounded bg-white",required:!0}),l.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>tn(!Sr),children:Sr?l.jsx(Zh,{className:"h-4 w-4 text-brand-burgundy/50 hover:text-brand-burgundy"}):l.jsx(cl,{className:"h-4 w-4 text-brand-burgundy/50 hover:text-brand-burgundy"})})]}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:Mn?"text":"password",name:"confirm",placeholder:"Confirm Password",value:b.confirm,onChange:ft=>_({...b,confirm:ft.target.value}),className:"w-full border p-2 pr-10 rounded bg-white",required:!0}),l.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>vn(!Mn),children:Mn?l.jsx(Zh,{className:"h-4 w-4 text-brand-burgundy/50 hover:text-brand-burgundy"}):l.jsx(cl,{className:"h-4 w-4 text-brand-burgundy/50 hover:text-brand-burgundy"})})]}),l.jsx("input",{type:"number",name:"age",placeholder:"Age",value:b.age,onChange:ft=>_({...b,age:ft.target.value}),className:"w-full border p-2 rounded bg-white",min:"18",required:!0}),l.jsx("input",{type:"tel",name:"phone",placeholder:"Phone Number",value:b.phone,onChange:ft=>_({...b,phone:ft.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),l.jsx("input",{type:"text",name:"city",placeholder:"City",value:b.city,onChange:ft=>_({...b,city:ft.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),l.jsx("input",{type:"text",name:"country",placeholder:"Country",value:b.country,onChange:ft=>_({...b,country:ft.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),k&&l.jsx("div",{className:"text-red-500",children:k}),O&&l.jsx("div",{className:"text-green-600",children:O}),l.jsx(xt,{type:"submit",className:"w-full bg-brand-burgundy text-white",children:"Sign Up"}),l.jsxs("div",{className:"text-center mt-4",children:[l.jsx("span",{className:"text-brand-burgundy/70",children:"Already have an account? "}),l.jsx("button",{type:"button",onClick:()=>s(!1),className:"font-bold text-brand-burgundy hover:text-brand-burgundy/80 transition-colors",children:"Sign In"})]})]}):l.jsxs("form",{onSubmit:ms,className:"space-y-4",children:[l.jsx("input",{type:"email",name:"email",placeholder:"Email",value:p.email,onChange:ft=>y({...p,[ft.target.name]:ft.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:ir?"text":"password",name:"password",placeholder:"Password",value:p.password,onChange:ft=>y({...p,[ft.target.name]:ft.target.value}),className:"w-full border p-2 pr-10 rounded bg-white",required:!0}),l.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>or(!ir),children:ir?l.jsx(Zh,{className:"h-4 w-4 text-brand-burgundy/50 hover:text-brand-burgundy"}):l.jsx(cl,{className:"h-4 w-4 text-brand-burgundy/50 hover:text-brand-burgundy"})})]}),E&&l.jsx("div",{className:"text-red-500",children:E}),L&&l.jsx("div",{className:"text-green-600",children:L}),l.jsx(xt,{type:"submit",className:"w-full bg-brand-burgundy text-white",children:"Login"}),l.jsx("div",{className:"text-center mt-2",children:l.jsx("button",{type:"button",onClick:async()=>{if(!p.email){C("Please enter your email address first");return}try{const{error:ft}=await Ve.auth.resetPasswordForEmail(p.email,{redirectTo:`${window.location.origin}/reset-password`});if(ft)throw ft;B("Password reset email sent! Check your inbox."),C("")}catch(ft){C(ft.message||"Failed to send password reset email")}},className:"text-sm text-brand-burgundy hover:text-brand-gold transition-colors",children:"Forgot Password?"})}),l.jsxs("div",{className:"text-center mt-4",children:[l.jsx("span",{className:"text-brand-burgundy/70",children:"Don't have an account? "}),l.jsx("button",{type:"button",onClick:()=>s(!0),className:"font-bold text-brand-burgundy hover:text-brand-burgundy/80 transition-colors",children:"Sign Up"})]})]})]})})};function OFe({user:e}){const[t,r]=I.useState(""),[n,i]=I.useState(""),[o,h]=I.useState(""),[s,p]=I.useState(!1),[y,b]=I.useState(""),[_,E]=I.useState(""),C=async k=>{if(k.preventDefault(),E(""),b(""),!t||!n||!o){E("All fields are required.");return}if(n!==o){E("New passwords do not match.");return}p(!0);try{const{error:N}=await Ve.auth.signInWithPassword({email:e.email,password:t});if(N)throw N;const{error:O}=await Ve.auth.updateUser({password:n});if(O)throw O;b("Password updated successfully!"),r(""),i(""),h("")}catch(N){E(N.message||"Failed to update password.")}finally{p(!1)}};return l.jsxs("form",{onSubmit:C,className:"space-y-4 max-w-md",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Current Password"}),l.jsx("input",{type:"password",className:"w-full border p-2 rounded bg-white",value:t,onChange:k=>r(k.target.value),required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"New Password"}),l.jsx("input",{type:"password",className:"w-full border p-2 rounded bg-white",value:n,onChange:k=>i(k.target.value),required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Confirm New Password"}),l.jsx("input",{type:"password",className:"w-full border p-2 rounded bg-white",value:o,onChange:k=>h(k.target.value),required:!0})]}),_&&l.jsx("div",{className:"text-red-500",children:_}),y&&l.jsx("div",{className:"text-green-600",children:y}),l.jsx("button",{type:"submit",className:"bg-brand-gold text-brand-burgundy px-4 py-2 rounded hover:bg-brand-gold/90",disabled:s,children:s?"Updating...":"Change Password"})]})}function RFe({user:e}){const[t,r]=I.useState(""),[n,i]=I.useState(""),[o,h]=I.useState(!1),[s,p]=I.useState(""),[y,b]=I.useState(""),_=async E=>{if(E.preventDefault(),b(""),p(""),!t||!t.includes("@")){b("Please enter a valid email address");return}h(!0);try{await new Promise(C=>setTimeout(C,1e3)),p("Referral invitation sent successfully!"),r(""),i("")}catch(C){console.error("Error sending referral:",C),b("Failed to send referral invitation. Please try again.")}finally{h(!1)}};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10",children:[l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-3",children:"Invite a Friend"}),l.jsxs("form",{onSubmit:_,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Friend's Email"}),l.jsx("input",{type:"email",className:"w-full border p-2 rounded bg-white border-brand-burgundy/30 focus:border-brand-gold",value:t,onChange:E=>r(E.target.value),placeholder:"friend@example.com",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Personal Message (Optional)"}),l.jsx("textarea",{className:"w-full border p-2 rounded bg-white border-brand-burgundy/30 focus:border-brand-gold",value:n,onChange:E=>i(E.target.value),placeholder:"Hey! I think you'd love Eddys Members...",rows:3})]}),y&&l.jsx("div",{className:"text-red-500 text-sm",children:y}),s&&l.jsx("div",{className:"text-green-600 text-sm",children:s}),l.jsx("button",{type:"submit",disabled:o,className:"bg-brand-gold text-brand-burgundy px-4 py-2 rounded hover:bg-brand-gold/90 disabled:opacity-50",children:o?"Sending...":"Send Invitation"})]})]}),l.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10",children:[l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-3",children:"Your Referral Code"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"text",value:e!=null&&e.id?`EDDY${e.id.slice(0,8).toUpperCase()}`:"Loading...",readOnly:!0,className:"flex-1 border p-2 rounded bg-white border-brand-burgundy/30 font-mono text-sm"}),l.jsx("button",{onClick:()=>{const E=e!=null&&e.id?`EDDY${e.id.slice(0,8).toUpperCase()}`:"";navigator.clipboard.writeText(E),p("Referral code copied to clipboard!")},className:"bg-brand-burgundy text-white px-3 py-2 rounded hover:bg-brand-burgundy/90",children:"Copy"})]}),l.jsx("p",{className:"text-sm text-brand-burgundy/70 mt-2",children:"Share this code with friends to earn rewards when they join!"})]}),l.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10",children:[l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-3",children:"Referral Benefits"}),l.jsxs("ul",{className:"space-y-2 text-sm text-brand-burgundy/70",children:[l.jsx("li",{children:" Earn credits when your friends join"}),l.jsx("li",{children:" Get exclusive member benefits"}),l.jsx("li",{children:" Unlock special venue access"}),l.jsx("li",{children:" Receive priority booking status"})]})]})]})}function DFe({request:e,onClose:t,onSuccess:r}){var b;const n=Gge(),i=Fge(),[o,h]=I.useState(!1),[s,p]=I.useState(null),y=async _=>{_.preventDefault(),h(!0),p(null);try{const E=await fetch("/api/create-split-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:e.amount,requestId:e.id})}),{clientSecret:C}=await E.json();if(!C)throw new Error("Failed to get payment secret");const k=await n.confirmCardPayment(C,{payment_method:{card:i.getElement(az)}});k.error?p(k.error.message):k.paymentIntent.status==="succeeded"&&r(k.paymentIntent)}catch(E){p(E.message)}finally{h(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full relative",children:[l.jsx("button",{className:"absolute top-2 right-2",onClick:t,children:l.jsx(j1,{className:"h-5 w-5 text-red-500"})}),l.jsx("h2",{className:"text-lg font-bold mb-4",children:"Pay Split Payment"}),l.jsxs("form",{onSubmit:y,className:"space-y-4",children:[l.jsxs("div",{children:["Amount: ",l.jsxs("span",{className:"font-semibold",children:["",(b=e.amount)==null?void 0:b.toLocaleString()]})]}),l.jsx(az,{className:"p-2 border rounded"}),s&&l.jsx("div",{className:"text-red-500 text-sm",children:s}),l.jsx(xt,{type:"submit",className:"w-full bg-brand-burgundy text-white",disabled:o,children:o?"Processing...":"Pay Now"})]})]})})}const LFe=()=>(console.log(" ProfilePage wrapper is rendering"),l.jsx(IFe,{})),BFe=()=>{const[e,t]=I.useState([]),[r,n]=I.useState(!0),[i,o]=I.useState(null);I.useEffect(()=>{h()},[]);const h=async()=>{try{const{data:{user:b},error:_}=await Ve.auth.getUser();if(_||!b){n(!1);return}o(b),await s(b.id)}catch(b){console.error("Error checking auth:",b),n(!1)}},s=async b=>{try{n(!0);const{data:_,error:E}=await Ve.from("bookings").select(`
          *,
          venues (
            id,
            name,
            address,
            city,
            type
          ),
          venue_tables!table_id (
            id,
            table_number
          )
        `).eq("user_id",b).order("booking_date",{ascending:!1});if(E)throw E;t(_||[])}catch(_){console.error("Error fetching bookings:",_),Mr({title:"Error",description:"Failed to load your bookings",variant:"destructive"})}finally{n(!1)}},p=async b=>{try{const{error:_}=await Ve.from("bookings").update({status:"cancelled",updated_at:new Date().toISOString()}).eq("id",b);if(_)throw _;t(E=>E.map(C=>C.id===b?{...C,status:"cancelled"}:C)),Mr({title:"Success",description:"Booking cancelled successfully",className:"bg-green-500 text-white"})}catch(_){console.error("Error cancelling booking:",_),Mr({title:"Error",description:"Failed to cancel booking",variant:"destructive"})}},y=b=>{switch(b){case"confirmed":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"completed":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return r?l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsx("div",{className:"container py-8",children:l.jsx("div",{className:"max-w-4xl mx-auto",children:l.jsx("div",{className:"flex items-center justify-center p-8",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold"})})})})}):i?l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsx("div",{className:"container py-8",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-8",children:[l.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy",children:"My Bookings"}),l.jsx(xt,{onClick:()=>s(i.id),variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",children:"Refresh"})]}),e.length===0?l.jsx(Mt,{className:"bg-white border-brand-burgundy/10 text-center p-8",children:l.jsxs(Ht,{children:[l.jsx("h2",{className:"text-xl font-semibold text-brand-burgundy mb-4",children:"No Bookings Yet"}),l.jsx("p",{className:"text-brand-burgundy/70 mb-6",children:"You haven't made any bookings yet. Start exploring our venues!"}),l.jsx(xt,{onClick:()=>window.location.href="/venues",className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Browse Venues"})]})}):l.jsx("div",{className:"space-y-6",children:e.map(b=>{var _,E;return l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsxs(Dr,{className:"flex flex-row items-center justify-between pb-2",children:[l.jsx(Lr,{className:"text-xl font-semibold text-brand-burgundy",children:((_=b.venues)==null?void 0:_.name)||"Unknown Venue"}),l.jsx(Yr,{className:y(b.status),children:b.status})]}),l.jsxs(Ht,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center text-brand-burgundy/70",children:[l.jsx(ma,{className:"h-4 w-4 mr-2"}),Yx(new Date(b.booking_date),"EEEE, MMMM d, yyyy")]}),l.jsxs("div",{className:"flex items-center text-brand-burgundy/70",children:[l.jsx(ml,{className:"h-4 w-4 mr-2"}),b.start_time," - ",b.end_time]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center text-brand-burgundy/70",children:[l.jsx(qs,{className:"h-4 w-4 mr-2"}),((E=b.venues)==null?void 0:E.city)||"Unknown Location"]}),l.jsxs("div",{className:"flex items-center text-brand-burgundy/70",children:[l.jsx(Is,{className:"h-4 w-4 mr-2"}),b.number_of_guests," ",b.number_of_guests===1?"Guest":"Guests"]})]})]}),b.venue_tables&&l.jsx("div",{className:"mt-4 pt-4 border-t border-brand-burgundy/10",children:l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Table: ",b.venue_tables.table_number]})}),l.jsx("div",{className:"mt-4 pt-4 border-t border-brand-burgundy/10",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Total Amount"}),l.jsxs("p",{className:"text-lg font-semibold text-brand-burgundy",children:["",(b.total_amount||0).toLocaleString()]})]}),l.jsxs("div",{className:"space-x-2",children:[l.jsx(xt,{variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",onClick:()=>{Mr({title:"Booking Details",description:`Booking ID: ${b.id}`})},children:"View Details"}),(b.status==="pending"||b.status==="confirmed")&&l.jsx(xt,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-50",onClick:()=>p(b.id),children:"Cancel Booking"})]})]})})]})]},b.id)})})]})})}):l.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:l.jsx("div",{className:"container py-8",children:l.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[l.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-4",children:"My Bookings"}),l.jsx("p",{className:"text-brand-burgundy/70 mb-6",children:"Please log in to view your bookings."}),l.jsx(xt,{onClick:()=>window.location.href="/register",className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Log In"})]})})})},zFe=()=>{const{user:e}=Pd(),[t,r]=I.useState(""),[n,i]=I.useState(""),[o,h]=I.useState(""),[s,p]=I.useState(!1),[y,b]=I.useState(""),[_,E]=I.useState(""),C=async k=>{if(k.preventDefault(),E(""),b(""),!t||!n||!o){E("All password fields are required.");return}if(n!==o){E("New passwords do not match.");return}if(n.length<8){E("New password must be at least 8 characters long.");return}p(!0);try{const{error:N}=await Ve.auth.signInWithPassword({email:e.email,password:t});if(N)throw N;const{error:O}=await Ve.auth.updateUser({password:n});if(O)throw O;b("Password updated successfully!"),r(""),i(""),h("")}catch(N){E(N.message||"Failed to update password.")}finally{p(!1)}};return l.jsx("div",{className:"container py-8",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-8",children:"Settings"}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center text-xl font-semibold text-brand-burgundy",children:[l.jsx(Kn,{className:"h-5 w-5 mr-2"}),"Account Settings"]})}),l.jsxs(Ht,{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"name",children:"Full Name"}),l.jsx(Lt,{id:"name",defaultValue:"John Doe"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"email",children:"Email"}),l.jsx(Lt,{id:"email",type:"email",defaultValue:"john@example.com"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"phone",children:"Phone Number"}),l.jsx(Lt,{id:"phone",type:"tel",defaultValue:"+234 123 456 7890"})]}),l.jsx(xt,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Save Changes"})]})]}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center text-xl font-semibold text-brand-burgundy",children:[l.jsx(Ux,{className:"h-5 w-5 mr-2"}),"Security"]})}),l.jsx(Ht,{className:"space-y-4",children:l.jsxs("form",{onSubmit:C,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"current-password",children:"Current Password"}),l.jsx(Lt,{id:"current-password",type:"password",value:t,onChange:k=>r(k.target.value),required:!0})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"new-password",children:"New Password"}),l.jsx(Lt,{id:"new-password",type:"password",value:n,onChange:k=>i(k.target.value),required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"confirm-password",children:"Confirm New Password"}),l.jsx(Lt,{id:"confirm-password",type:"password",value:o,onChange:k=>h(k.target.value),required:!0})]})]}),_&&l.jsx("div",{className:"text-red-500 text-sm",children:_}),y&&l.jsx("div",{className:"text-green-600 text-sm",children:y}),l.jsx(xt,{type:"submit",className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",disabled:s,children:s?"Updating...":"Update Password"})]})})]}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center text-xl font-semibold text-brand-burgundy",children:[l.jsx(fA,{className:"h-5 w-5 mr-2"}),"Notifications"]})}),l.jsxs(Ht,{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"space-y-0.5",children:[l.jsx(Tt,{children:"Email Notifications"}),l.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Receive updates about your bookings"})]}),l.jsx(Qo,{})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"space-y-0.5",children:[l.jsx(Tt,{children:"SMS Notifications"}),l.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Get text messages for important updates"})]}),l.jsx(Qo,{})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"space-y-0.5",children:[l.jsx(Tt,{children:"Marketing Emails"}),l.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Receive promotions and special offers"})]}),l.jsx(Qo,{})]})]})]}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center text-xl font-semibold text-brand-burgundy",children:[l.jsx(Fc,{className:"h-5 w-5 mr-2"}),"Payment Methods"]})}),l.jsxs(Ht,{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"card-number",children:"Card Number"}),l.jsx(Lt,{id:"card-number",placeholder:"**** **** **** ****"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"expiry",children:"Expiry Date"}),l.jsx(Lt,{id:"expiry",placeholder:"MM/YY"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"cvv",children:"CVV"}),l.jsx(Lt,{id:"cvv",placeholder:"***"})]})]}),l.jsx(xt,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Add Payment Method"})]})]}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center text-xl font-semibold text-brand-burgundy",children:[l.jsx(N8,{className:"h-5 w-5 mr-2"}),"Language & Region"]})}),l.jsxs(Ht,{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"language",children:"Language"}),l.jsxs("select",{id:"language",className:"w-full rounded-md border border-brand-burgundy/10 bg-white px-3 py-2",children:[l.jsx("option",{value:"en",children:"English"}),l.jsx("option",{value:"yo",children:"Yoruba"}),l.jsx("option",{value:"ig",children:"Igbo"}),l.jsx("option",{value:"ha",children:"Hausa"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Tt,{htmlFor:"currency",children:"Currency"}),l.jsxs("select",{id:"currency",className:"w-full rounded-md border border-brand-burgundy/10 bg-white px-3 py-2",children:[l.jsx("option",{value:"NGN",children:"Nigerian Naira ()"}),l.jsx("option",{value:"USD",children:"US Dollar ($)"}),l.jsx("option",{value:"EUR",children:"Euro ()"}),l.jsx("option",{value:"GBP",children:"British Pound ()"})]})]}),l.jsx(xt,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Save Preferences"})]})]})]})]})})},$Fe=I.createContext(null);function FFe(e,t){const r=Array.isArray(e)?e[0]:e?e.x:0,n=Array.isArray(e)?e[1]:e?e.y:0,i=Array.isArray(t)?t[0]:t?t.x:0,o=Array.isArray(t)?t[1]:t?t.y:0;return r===i&&n===o}function bc(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!bc(e[r],t[r]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const i of r)if(!t.hasOwnProperty(i)||!bc(e[i],t[i]))return!1;return!0}return!1}function UFe(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}function yU(e,t){if(!e.getProjection)return;const r=e.getProjection(),n=t.getProjection();bc(r,n)||t.setProjection(r)}function vU(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function xU(e,t){const r=t.viewState||t;let n=!1;if("zoom"in r){const i=e.zoom;e.zoom=r.zoom,n=n||i!==e.zoom}if("bearing"in r){const i=e.bearing;e.bearing=r.bearing,n=n||i!==e.bearing}if("pitch"in r){const i=e.pitch;e.pitch=r.pitch,n=n||i!==e.pitch}if(r.padding&&!e.isPaddingEqual(r.padding)&&(n=!0,e.padding=r.padding),"longitude"in r&&"latitude"in r){const i=e.center;e.center=new i.constructor(r.longitude,r.latitude),n=n||i!==e.center}return n}const VFe=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function bU(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const n of e.layers)t[n.id]=n;const r=e.layers.map(n=>{let i=null;"interactive"in n&&(i=Object.assign({},n),delete i.interactive);const o=t[n.ref];if(o){i=i||Object.assign({},n),delete i.ref;for(const h of VFe)h in o&&(i[h]=o[h])}return i||n});return{...e,layers:r}}const _U={version:8,sources:{},layers:[]},wU={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},cP={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},SU={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},qFe=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],WFe=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class og{constructor(t,r,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const o=this.props[SU[i.type]];o?o(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const o=this.props[wU[i.type]];o&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),o(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const o=this.props[cP[i.type]];o&&o(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=t,this.props=r,this._initialize(n)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const r=this.props;this.props=t;const n=this._updateSettings(t,r);n&&this._createShadowTransform(this._map);const i=this._updateSize(t),o=this._updateViewState(t,!0);this._updateStyle(t,r),this._updateStyleComponents(t,r),this._updateHandlers(t,r),(n||i||o&&!this._map.isMoving())&&this.redraw()}static reuse(t,r){const n=og.savedMaps.pop();if(!n)return null;const i=n.map,o=i.getContainer();for(r.className=o.className;o.childNodes.length>0;)r.appendChild(o.childNodes[0]);i._container=r;const h=i._resizeObserver;h&&(h.disconnect(),h.observe(r)),n.setProps({...t,styleDiffing:!1}),i.resize();const{initialViewState:s}=t;return s&&(s.bounds?i.fitBounds(s.bounds,{...s.fitBoundsOptions,duration:0}):n._updateViewState(s,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),n}_initialize(t){const{props:r}=this,{mapStyle:n=_U}=r,i={...r,...r.initialViewState,accessToken:r.mapboxAccessToken||GFe()||null,container:t,style:bU(n)},o=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[o.longitude||0,o.latitude||0],zoom:o.zoom||0,pitch:o.pitch||0,bearing:o.bearing||0}),r.gl){const b=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=b,r.gl)}const h=new this._MapClass(i);o.padding&&h.setPadding(o.padding),r.cursor&&(h.getCanvas().style.cursor=r.cursor),this._createShadowTransform(h);const s=h._render;h._render=b=>{this._inRender=!0,s.call(h,b),this._inRender=!1};const p=h._renderTaskQueue.run;h._renderTaskQueue.run=b=>{p.call(h._renderTaskQueue,b),this._onBeforeRepaint()},h.on("render",()=>this._onAfterRepaint());const y=h.fire;h.fire=this._fireEvent.bind(this,y),h.on("resize",()=>{this._renderTransform.resize(h.transform.width,h.transform.height)}),h.on("styledata",()=>{this._updateStyleComponents(this.props,{}),yU(h.transform,this._renderTransform)}),h.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const b in wU)h.on(b,this._onPointerEvent);for(const b in cP)h.on(b,this._onCameraEvent);for(const b in SU)h.on(b,this._onEvent);this._map=h}recycle(){const r=this.map.getContainer().querySelector("[mapboxgl-children]");r==null||r.remove(),og.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const r=UFe(t.transform);t.painter.transform=r,this._renderTransform=r}_updateSize(t){const{viewState:r}=t;if(r){const n=this._map;if(r.width!==n.transform.width||r.height!==n.transform.height)return n.resize(),!0}return!1}_updateViewState(t,r){if(this._internalUpdate)return!1;const n=this._map,i=this._renderTransform,{zoom:o,pitch:h,bearing:s}=i,p=n.isMoving();p&&(i.cameraElevationReference="sea");const y=xU(i,{...vU(n.transform),...t});if(p&&(i.cameraElevationReference="ground"),y&&r){const b=this._deferredEvents;b.move=!0,b.zoom||(b.zoom=o!==i.zoom),b.rotate||(b.rotate=s!==i.bearing),b.pitch||(b.pitch=h!==i.pitch)}return p||xU(n.transform,t),y}_updateSettings(t,r){const n=this._map;let i=!1;for(const o of qFe)if(o in t&&!bc(t[o],r[o])){i=!0;const h=n[`set${o[0].toUpperCase()}${o.slice(1)}`];h==null||h.call(n,t[o])}return i}_updateStyle(t,r){if(t.cursor!==r.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==r.mapStyle){const{mapStyle:n=_U,styleDiffing:i=!0}=t,o={diff:i};return"localIdeographFontFamily"in t&&(o.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(bU(n),o),!0}return!1}_updateStyleComponents(t,r){const n=this._map;let i=!1;return n.isStyleLoaded()&&("light"in t&&n.setLight&&!bc(t.light,r.light)&&(i=!0,n.setLight(t.light)),"fog"in t&&n.setFog&&!bc(t.fog,r.fog)&&(i=!0,n.setFog(t.fog)),"terrain"in t&&n.setTerrain&&!bc(t.terrain,r.terrain)&&(!t.terrain||n.getSource(t.terrain.source))&&(i=!0,n.setTerrain(t.terrain))),i}_updateHandlers(t,r){var n,i;const o=this._map;let h=!1;for(const s of WFe){const p=(n=t[s])!==null&&n!==void 0?n:!0,y=(i=r[s])!==null&&i!==void 0?i:!0;bc(p,y)||(h=!0,p?o[s].enable(p):o[s].disable())}return h}_queryRenderedFeatures(t){const r=this._map,n=r.transform,{interactiveLayerIds:i=[]}=this.props;try{return r.transform=this._renderTransform,r.queryRenderedFeatures(t,{layers:i.filter(r.getLayer.bind(r))})}catch{return[]}finally{r.transform=n}}_updateHover(t){var r;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const o=t.type,h=((r=this._hoveredFeatures)===null||r===void 0?void 0:r.length)>0,s=this._queryRenderedFeatures(t.point),p=s.length>0;!p&&h&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=s,p&&!h&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=o}else this._hoveredFeatures=null}_fireEvent(t,r,n){const i=this._map,o=i.transform,h=typeof r=="string"?r:r.type;return h==="move"&&this._updateViewState(this.props,!1),h in cP&&(typeof r=="object"&&(r.viewState=vU(o)),this._map.isMoving())?(i.transform=this._renderTransform,t.call(i,r,n),i.transform=o,i):(t.call(i,r,n),i)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const n in this._deferredEvents)this._deferredEvents[n]&&t.fire(n);this._internalUpdate=!1;const r=this._map.transform;t.transform=this._renderTransform,this._onAfterRepaint=()=>{yU(this._renderTransform,r),t.transform=r}}}og.savedMaps=[];function GFe(){let e=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||{}.MapboxAccessToken}catch{}try{e=e||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return e}const HFe=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function XFe(e){if(!e)return null;const t=e.map,r={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:n=>{const i=t.transform;t.transform=e.transform;const o=t.project(n);return t.transform=i,o},unproject:n=>{const i=t.transform;t.transform=e.transform;const o=t.unproject(n);return t.transform=i,o},queryTerrainElevation:(n,i)=>{const o=t.transform;t.transform=e.transform;const h=t.queryTerrainElevation(n,i);return t.transform=o,h},queryRenderedFeatures:(n,i)=>{const o=t.transform;t.transform=e.transform;const h=t.queryRenderedFeatures(n,i);return t.transform=o,h}};for(const n of KFe(t))!(n in r)&&!HFe.includes(n)&&(r[n]=t[n].bind(t));return r}function KFe(e){const t=new Set;let r=e;for(;r;){for(const n of Object.getOwnPropertyNames(r))n[0]!=="_"&&typeof e[n]=="function"&&n!=="fire"&&n!=="setEventedParent"&&t.add(n);r=Object.getPrototypeOf(r)}return Array.from(t)}const ZFe=typeof document<"u"?I.useLayoutEffect:I.useEffect,YFe=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function JFe(e,t){for(const n of YFe)n in t&&(e[n]=t[n]);const{RTLTextPlugin:r="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;r&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(r,n=>{n&&console.error(n)},!0)}const q2=I.createContext(null);function QFe(e,t,r){const n=I.useContext($Fe),[i,o]=I.useState(null),h=I.useRef(),{current:s}=I.useRef({mapLib:null,map:null});I.useEffect(()=>{const b=e.mapLib;let _=!0,E;return Promise.resolve(b||r).then(C=>{if(!_)return;if(!C)throw new Error("Invalid mapLib");const k="Map"in C?C:C.default;if(!k.Map)throw new Error("Invalid mapLib");if(JFe(k,e),!k.supported||k.supported(e))e.reuseMaps&&(E=og.reuse(e,h.current)),E||(E=new og(k.Map,e,h.current)),s.map=XFe(E),s.mapLib=k,o(E),n==null||n.onMapMount(s.map,e.id);else throw new Error("Map is not supported by this browser")}).catch(C=>{const{onError:k}=e;k?k({type:"error",target:null,originalEvent:null,error:C}):console.error(C)}),()=>{_=!1,E&&(n==null||n.onMapUnmount(e.id),e.reuseMaps?E.recycle():E.destroy())}},[]),ZFe(()=>{i&&i.setProps(e)}),I.useImperativeHandle(t,()=>s.map,[i]);const p=I.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),y={height:"100%"};return I.createElement("div",{id:e.id,ref:h,style:p},i&&I.createElement(q2.Provider,{value:s},I.createElement("div",{"mapboxgl-children":"",style:y},e.children)))}const eUe=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Af(e,t){if(!e||!t)return;const r=e.style;for(const n in t){const i=t[n];Number.isFinite(i)&&!eUe.test(n)?r[n]=`${i}px`:r[n]=i}}function tUe(e,t){const{map:r,mapLib:n}=I.useContext(q2),i=I.useRef({props:e});i.current.props=e;const o=I.useMemo(()=>{let N=!1;I.Children.forEach(e.children,L=>{L&&(N=!0)});const O={...e,element:N?document.createElement("div"):null},R=new n.Marker(O);return R.setLngLat([e.longitude,e.latitude]),R.getElement().addEventListener("click",L=>{var B,q;(q=(B=i.current.props).onClick)===null||q===void 0||q.call(B,{type:"click",target:R,originalEvent:L})}),R.on("dragstart",L=>{var B,q;const F=L;F.lngLat=o.getLngLat(),(q=(B=i.current.props).onDragStart)===null||q===void 0||q.call(B,F)}),R.on("drag",L=>{var B,q;const F=L;F.lngLat=o.getLngLat(),(q=(B=i.current.props).onDrag)===null||q===void 0||q.call(B,F)}),R.on("dragend",L=>{var B,q;const F=L;F.lngLat=o.getLngLat(),(q=(B=i.current.props).onDragEnd)===null||q===void 0||q.call(B,F)}),R},[]);I.useEffect(()=>(o.addTo(r.getMap()),()=>{o.remove()}),[]);const{longitude:h,latitude:s,offset:p,style:y,draggable:b=!1,popup:_=null,rotation:E=0,rotationAlignment:C="auto",pitchAlignment:k="auto"}=e;return I.useEffect(()=>{Af(o.getElement(),y)},[y]),I.useImperativeHandle(t,()=>o,[]),(o.getLngLat().lng!==h||o.getLngLat().lat!==s)&&o.setLngLat([h,s]),p&&!FFe(o.getOffset(),p)&&o.setOffset(p),o.isDraggable()!==b&&o.setDraggable(b),o.getRotation()!==E&&o.setRotation(E),o.getRotationAlignment()!==C&&o.setRotationAlignment(C),o.getPitchAlignment()!==k&&o.setPitchAlignment(k),o.getPopup()!==_&&o.setPopup(_),Yc.createPortal(e.children,o.getElement())}const rUe=I.memo(I.forwardRef(tUe));function EU(e){return new Set(e?e.trim().split(/\s+/):[])}function nUe(e,t){const{map:r,mapLib:n}=I.useContext(q2),i=I.useMemo(()=>document.createElement("div"),[]),o=I.useRef({props:e});o.current.props=e;const h=I.useMemo(()=>{const s={...e},p=new n.Popup(s);return p.setLngLat([e.longitude,e.latitude]),p.once("open",y=>{var b,_;(_=(b=o.current.props).onOpen)===null||_===void 0||_.call(b,y)}),p},[]);if(I.useEffect(()=>{const s=p=>{var y,b;(b=(y=o.current.props).onClose)===null||b===void 0||b.call(y,p)};return h.on("close",s),h.setDOMContent(i).addTo(r.getMap()),()=>{h.off("close",s),h.isOpen()&&h.remove()}},[]),I.useEffect(()=>{Af(h.getElement(),e.style)},[e.style]),I.useImperativeHandle(t,()=>h,[]),h.isOpen()&&((h.getLngLat().lng!==e.longitude||h.getLngLat().lat!==e.latitude)&&h.setLngLat([e.longitude,e.latitude]),e.offset&&!bc(h.options.offset,e.offset)&&h.setOffset(e.offset),(h.options.anchor!==e.anchor||h.options.maxWidth!==e.maxWidth)&&(h.options.anchor=e.anchor,h.setMaxWidth(e.maxWidth)),h.options.className!==e.className)){const s=EU(h.options.className),p=EU(e.className);for(const y of s)p.has(y)||h.removeClassName(y);for(const y of p)s.has(y)||h.addClassName(y);h.options.className=e.className}return Yc.createPortal(e.children,i)}const iUe=I.memo(I.forwardRef(nUe));function lb(e,t,r,n){const i=I.useContext(q2),o=I.useMemo(()=>e(i),[]);return I.useEffect(()=>{const h=n||r||t,s=typeof t=="function"&&typeof r=="function"?t:null,p=typeof r=="function"?r:typeof t=="function"?t:null,{map:y}=i;return y.hasControl(o)||(y.addControl(o,h==null?void 0:h.position),s&&s(i)),()=>{p&&p(i),y.hasControl(o)&&y.removeControl(o)}},[]),o}function sUe(e){const t=lb(({mapLib:r})=>new r.AttributionControl(e),{position:e.position});return I.useEffect(()=>{Af(t._container,e.style)},[e.style]),null}I.memo(sUe);function aUe(e){const t=lb(({mapLib:r})=>new r.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return I.useEffect(()=>{Af(t._controlContainer,e.style)},[e.style]),null}I.memo(aUe);function oUe(e,t){const r=I.useRef({props:e}),n=lb(({mapLib:i})=>{const o=new i.GeolocateControl(e),h=o._setupUI;return o._setupUI=s=>{o._container.hasChildNodes()||h(s)},o.on("geolocate",s=>{var p,y;(y=(p=r.current.props).onGeolocate)===null||y===void 0||y.call(p,s)}),o.on("error",s=>{var p,y;(y=(p=r.current.props).onError)===null||y===void 0||y.call(p,s)}),o.on("outofmaxbounds",s=>{var p,y;(y=(p=r.current.props).onOutOfMaxBounds)===null||y===void 0||y.call(p,s)}),o.on("trackuserlocationstart",s=>{var p,y;(y=(p=r.current.props).onTrackUserLocationStart)===null||y===void 0||y.call(p,s)}),o.on("trackuserlocationend",s=>{var p,y;(y=(p=r.current.props).onTrackUserLocationEnd)===null||y===void 0||y.call(p,s)}),o},{position:e.position});return r.current.props=e,I.useImperativeHandle(t,()=>n,[]),I.useEffect(()=>{Af(n._container,e.style)},[e.style]),null}I.memo(I.forwardRef(oUe));function lUe(e){const t=lb(({mapLib:r})=>new r.NavigationControl(e),{position:e.position});return I.useEffect(()=>{Af(t._container,e.style)},[e.style]),null}I.memo(lUe);function cUe(e){const t=lb(({mapLib:o})=>new o.ScaleControl(e),{position:e.position}),r=I.useRef(e),n=r.current;r.current=e;const{style:i}=e;return e.maxWidth!==void 0&&e.maxWidth!==n.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==n.unit&&t.setUnit(e.unit),I.useEffect(()=>{Af(t._container,i)},[i]),null}I.memo(cUe);const uUe=Os(()=>Promise.resolve().then(()=>wUe),void 0),dUe=(()=>I.forwardRef(function(t,r){return QFe(t,r,uUe)}))(),TU=rUe,hUe=iUe;const fUe=()=>{const[e,t]=I.useState([]),[r,n]=I.useState([]),[i,o]=I.useState(null),[h,s]=I.useState(!0),[p,y]=I.useState(null),[b,_]=I.useState({lat:6.5244,lng:3.3792}),[E,C]=I.useState(11),[k,N]=I.useState(!1),[O,R]=I.useState(!0),[L,B]=I.useState({search:"",type:"all",priceRange:"all",minRating:0});I.useState(!1);const q=I.useRef();I.useEffect(()=>{(()=>{if(!navigator.geolocation){console.log("Geolocation is not supported by this browser"),y({lat:6.5244,lng:3.3792});return}console.log("Getting user location..."),navigator.geolocation.getCurrentPosition(te=>{const oe=te.coords.latitude,ie=te.coords.longitude;console.log("User location detected:",{lat:oe,lng:ie});const ue={lat:oe,lng:ie};y(ue),_(ue),R(!1);const _e=te.coords.accuracy;let xe=13;_e>1e3?xe=11:_e<100&&(xe=15),C(xe)},te=>{console.log("Geolocation error:",te);let oe={lat:6.5244,lng:3.3792};switch(te.code){case te.PERMISSION_DENIED:console.log("User denied location permission, using Lagos as default"),N(!0);break;case te.POSITION_UNAVAILABLE:console.log("Location information unavailable, using Lagos as default");break;case te.TIMEOUT:console.log("Location request timed out, using Lagos as default");break;default:console.log("Unknown location error, using Lagos as default");break}y(oe),_(oe),C(11),R(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})})()},[]),I.useEffect(()=>{(async()=>{try{s(!0);const{data:te,error:oe}=await Ve.from("venues").select(`
            *,
            venue_images (
              image_url,
              is_primary
            )
          `).eq("status","approved").eq("is_active",!0);if(oe){console.error("Error fetching venues:",oe),t([]);return}if(!te||te.length===0){console.log("No venues found in database with status=approved and is_active=true");const{data:ue}=await Ve.from("venues").select("id, name, status, is_active, latitude, longitude");console.log("All venues in database:",ue),t([]),n([]);return}console.log(`Found ${te.length} approved venues:`,te);const ie=te.map(ue=>{var be,Ae,me,ke,Ne;const _e=((Ae=(be=ue.venue_images)==null?void 0:be.find(Be=>Be.is_primary))==null?void 0:Ae.image_url)||((ke=(me=ue.venue_images)==null?void 0:me[0])==null?void 0:ke.image_url)||"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4",xe={...ue,lat:ue.latitude||6.5244,lng:ue.longitude||3.3792,image:_e,priceLevel:((Ne=ue.price_range)==null?void 0:Ne.length)||1};return console.log(`Venue: ${ue.name}`,{id:ue.id,status:ue.status,is_active:ue.is_active,latitude:ue.latitude,longitude:ue.longitude,hasCoordinates:!!(ue.latitude&&ue.longitude)}),xe});t(ie),n(ie)}catch(te){console.error("Error in fetchVenues:",te),t([]),n([])}finally{s(!1)}})()},[]),I.useEffect(()=>{let W=e;L.search&&(W=W.filter(te=>{var oe;return te.name.toLowerCase().includes(L.search.toLowerCase())||((oe=te.description)==null?void 0:oe.toLowerCase().includes(L.search.toLowerCase()))||te.address.toLowerCase().includes(L.search.toLowerCase())||te.city.toLowerCase().includes(L.search.toLowerCase())})),L.type!=="all"&&(W=W.filter(te=>te.type===L.type)),L.priceRange!=="all"&&(W=W.filter(te=>te.price_range===L.priceRange)),L.minRating>0&&(W=W.filter(te=>(te.rating||0)>=L.minRating)),n(W)},[e,L]),I.useEffect(()=>{if(!q.current||!p)return;const W=q.current.getMap();(p.lat!==6.5244||p.lng!==3.3792)&&setTimeout(()=>{W.flyTo({center:[p.lng,p.lat],zoom:E,duration:2e3})},1e3)},[p,E]),I.useEffect(()=>{if(!(!q.current||!r.length)&&(L.search||L.type!=="all"||L.priceRange!=="all"||L.minRating>0)){const W=q.current.getMap();if(r.length===1)W.flyTo({center:[r[0].lng,r[0].lat],zoom:14,duration:1e3});else if(r.length>1){const te=r.map(ue=>ue.lat),oe=r.map(ue=>ue.lng),ie=[[Math.min(...oe)-.01,Math.min(...te)-.01],[Math.max(...oe)+.01,Math.max(...te)+.01]];W.fitBounds(ie,{padding:50,duration:1e3})}}},[r,L]);const F=W=>{switch(W.type){case"restaurant":return"#10B981";case"club":return"#8B5CF6";case"lounge":return"#F59E0B";default:return"#EF4444"}},H=W=>{switch(W){case"restaurant":return"";case"club":return"";case"lounge":return"";default:return""}},Z=()=>{B({search:"",type:"all",priceRange:"all",minRating:0})},re=()=>{if(!q.current||!p)return;q.current.getMap().flyTo({center:[p.lng,p.lat],zoom:15,duration:1e3})};return l.jsx("div",{className:"bg-brand-cream min-h-screen",children:l.jsxs("div",{className:"container py-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"Explore Lagos Venues"}),l.jsx("p",{className:"text-brand-burgundy/70 text-lg",children:"Discover the best restaurants, clubs, and lounges on our interactive map"})]}),!1,k&&l.jsx(Mt,{className:"mb-4 bg-amber-50 border-amber-200",children:l.jsx(Ht,{className:"p-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx($0,{className:"h-5 w-5 text-amber-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-amber-800",children:"Location access denied"}),l.jsx("p",{className:"text-xs text-amber-700",children:"Enable location permission in your browser to see venues near you"})]})]})})}),l.jsx(Mt,{className:"mb-6 bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-4",children:[l.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center",children:[l.jsxs("div",{className:"flex-1 relative",children:[l.jsx(gd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-brand-burgundy/50"}),l.jsx(Lt,{placeholder:"Search venues, locations...",value:L.search,onChange:W=>B(te=>({...te,search:W.target.value})),className:"pl-10 border-brand-burgundy/20 focus:border-brand-gold"})]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:L.type,onChange:W=>B(te=>({...te,type:W.target.value})),className:"px-3 py-2 border border-brand-burgundy/20 rounded-md bg-white text-brand-burgundy",children:[l.jsx("option",{value:"all",children:"All Types"}),l.jsx("option",{value:"restaurant",children:"Restaurants"}),l.jsx("option",{value:"club",children:"Clubs"}),l.jsx("option",{value:"lounge",children:"Lounges"})]}),l.jsxs("select",{value:L.priceRange,onChange:W=>B(te=>({...te,priceRange:W.target.value})),className:"px-3 py-2 border border-brand-burgundy/20 rounded-md bg-white text-brand-burgundy",children:[l.jsx("option",{value:"all",children:"All Prices"}),l.jsx("option",{value:"$",children:"$ - Budget"}),l.jsx("option",{value:"$$",children:"$$ - Moderate"}),l.jsx("option",{value:"$$$",children:"$$$ - Premium"})]}),l.jsxs("select",{value:L.minRating,onChange:W=>B(te=>({...te,minRating:parseFloat(W.target.value)})),className:"px-3 py-2 border border-brand-burgundy/20 rounded-md bg-white text-brand-burgundy",children:[l.jsx("option",{value:0,children:"All Ratings"}),l.jsx("option",{value:4.5,children:"4.5+ Stars"}),l.jsx("option",{value:4,children:"4.0+ Stars"}),l.jsx("option",{value:3.5,children:"3.5+ Stars"})]}),l.jsx(xt,{onClick:Z,variant:"outline",className:"border-brand-burgundy/20 text-brand-burgundy hover:bg-brand-burgundy/5",children:"Clear"})]})]}),l.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Showing ",r.length," of ",e.length," venues"]}),O&&l.jsxs("div",{className:"flex items-center gap-2 text-xs text-brand-burgundy/60",children:[l.jsx("div",{className:"w-3 h-3 border-2 border-brand-burgundy/30 border-t-brand-burgundy rounded-full animate-spin"}),l.jsx("span",{children:"Getting your location..."})]}),p&&!O&&p.lat!==6.5244&&l.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-600",children:[l.jsx(t4,{className:"h-3 w-3"}),l.jsx("span",{children:"Location detected"})]})]}),l.jsxs("div",{className:"flex gap-4 text-xs",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),l.jsx("span",{children:"Restaurants"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-500"}),l.jsx("span",{children:"Clubs"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500"}),l.jsx("span",{children:"Lounges"})]})]})]})]})}),l.jsx(Mt,{className:"overflow-hidden shadow-xl border-brand-burgundy/10",children:l.jsxs("div",{className:"h-[600px] relative",children:[p&&l.jsxs(xt,{onClick:re,className:"absolute top-4 right-4 z-10 bg-white text-brand-burgundy border border-brand-burgundy/20 hover:bg-brand-burgundy hover:text-white shadow-lg",size:"sm",children:[l.jsx(t4,{className:"h-4 w-4 mr-2"}),"My Location"]}),h?l.jsx("div",{className:"flex items-center justify-center h-full bg-brand-cream/50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-burgundy mx-auto mb-4"}),l.jsx("p",{className:"text-brand-burgundy",children:"Loading venues..."})]})}):l.jsxs(dUe,{ref:q,initialViewState:{latitude:b.lat,longitude:b.lng,zoom:E},style:{width:"100%",height:"100%"},mapboxAccessToken:"pk.eyJ1IjoiemFrbWVhZG93czE2IiwiYSI6ImNtYzFtanRxajA1NnMyaXM5NGpicGFwdXIifQ.rE6eaOez5Q6U6t-y58gzpQ",mapStyle:"mapbox://styles/mapbox/light-v11",interactiveLayerIds:["venues"],children:[p&&l.jsx(TU,{latitude:p.lat,longitude:p.lng,children:l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full border-2 border-white shadow-lg animate-pulse"}),l.jsx("div",{className:"absolute -top-1 -left-1 w-6 h-6 bg-blue-500/20 rounded-full animate-ping"})]})}),r.map(W=>l.jsx(TU,{latitude:W.lat,longitude:W.lng,onClick:()=>o(W),children:l.jsx("div",{className:"cursor-pointer transform hover:scale-110 transition-transform duration-200",style:{color:F(W)},children:l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-8 h-8 rounded-full border-3 border-white shadow-lg flex items-center justify-center text-white font-bold text-sm",style:{backgroundColor:F(W)},children:H(W.type)}),l.jsx("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2",children:l.jsx("div",{className:"w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent",style:{borderTopColor:F(W)}})})]})})},W.id)),i&&l.jsx(hUe,{latitude:i.lat,longitude:i.lng,onClose:()=>o(null),closeButton:!0,closeOnClick:!1,offsetTop:-10,className:"venue-popup",children:l.jsxs("div",{className:"p-0 max-w-sm",children:[l.jsxs("div",{className:"relative",children:[l.jsx("img",{src:i.image,alt:i.name,className:"w-full h-32 object-cover rounded-t-lg"}),l.jsx(Yr,{className:"absolute top-2 right-2 bg-white/90 text-brand-burgundy",children:i.type.charAt(0).toUpperCase()+i.type.slice(1)})]}),l.jsxs("div",{className:"p-4",children:[l.jsx("h3",{className:"font-heading text-lg text-brand-burgundy mb-2",children:i.name}),l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.rating&&l.jsxs("div",{className:"flex items-center",children:[l.jsx(Gs,{className:"h-4 w-4 text-yellow-400 fill-current"}),l.jsx("span",{className:"text-sm font-medium ml-1",children:i.rating})]}),l.jsx(Yr,{variant:"outline",className:"text-xs",children:i.price_range})]}),l.jsx("p",{className:"text-sm text-brand-burgundy/70 mb-3 line-clamp-2",children:i.description}),l.jsxs("div",{className:"space-y-2 text-xs text-brand-burgundy/60",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(qs,{className:"h-3 w-3"}),l.jsxs("span",{children:[i.address,", ",i.city]})]}),i.contact_phone&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Am,{className:"h-3 w-3"}),l.jsx("span",{children:i.contact_phone})]})]}),l.jsx(xt,{className:"w-full mt-3 bg-brand-burgundy text-white hover:bg-brand-burgundy/90",onClick:()=>window.location.href=`/venues/${i.id}`,children:"View Details & Book"})]})]})})]})]})}),l.jsxs("div",{className:"mt-8",children:[l.jsxs("h2",{className:"text-2xl font-heading text-brand-burgundy mb-4",children:["Featured Venues (",r.length,")"]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.slice(0,6).map(W=>l.jsxs(Mt,{className:"overflow-hidden hover:shadow-lg transition-shadow cursor-pointer bg-white border-brand-burgundy/10",children:[l.jsxs("div",{className:"relative h-48",children:[l.jsx("img",{src:W.image,alt:W.name,className:"w-full h-full object-cover"}),l.jsx(Yr,{className:"absolute top-3 right-3 bg-white/90 text-brand-burgundy",children:W.type.charAt(0).toUpperCase()+W.type.slice(1)})]}),l.jsxs(Ht,{className:"p-4",children:[l.jsx("h3",{className:"font-heading text-xl text-brand-burgundy mb-2",children:W.name}),l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[W.rating&&l.jsxs("div",{className:"flex items-center",children:[l.jsx(Gs,{className:"h-4 w-4 text-yellow-400 fill-current"}),l.jsx("span",{className:"text-sm font-medium ml-1",children:W.rating})]}),l.jsx(Yr,{variant:"outline",children:W.price_range})]}),l.jsx("p",{className:"text-sm text-brand-burgundy/70 mb-3 line-clamp-2",children:W.description}),l.jsxs("div",{className:"flex items-center gap-2 text-xs text-brand-burgundy/60 mb-3",children:[l.jsx(qs,{className:"h-3 w-3"}),l.jsx("span",{children:W.city})]}),l.jsx(xt,{className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",onClick:()=>window.location.href=`/venues/${W.id}`,children:"View Details"})]})]},W.id))})]})]})})},jU=()=>{const e=ts(),[t]=EM(),{toast:r}=Ui(),[n,i]=I.useState(!0),[o,h]=I.useState(!1),[s,p]=I.useState([]),[y,b]=I.useState(null),[_,E]=I.useState(""),[C,k]=I.useState(""),[N,O]=I.useState(null),[R,L]=I.useState([]),B=[{amount:50,label:"50,000",bonus:0,popular:!1},{amount:100,label:"100,000",bonus:10,popular:!0},{amount:250,label:"250,000",bonus:35,popular:!1},{amount:500,label:"500,000",bonus:75,popular:!1}];I.useEffect(()=>{q();const ue=t.get("venue");ue&&b({id:ue})},[]);const q=async()=>{try{const{data:{user:ue},error:_e}=await Ve.auth.getUser();if(_e)throw _e;if(!ue){r({title:"Authentication Required",description:"Please log in to purchase venue credits",variant:"destructive"}),e("/profile");return}O(ue),await F(),await H(ue.id)}catch(ue){console.error("Auth error:",ue),r({title:"Error",description:"Failed to authenticate user",variant:"destructive"})}finally{i(!1)}},F=async()=>{try{const{data:ue,error:_e}=await Ve.from("venues").select("*").eq("status","approved").eq("is_active",!0).order("name");if(_e)throw _e;p(ue||[])}catch(ue){console.error("Error fetching venues:",ue),r({title:"Error",description:"Failed to load venues",variant:"destructive"})}},H=async ue=>{try{const{data:_e,error:xe}=await Ve.from("venue_credits").select(`
          *,
          venues (
            id,
            name,
            address,
            type
          )
        `).eq("user_id",ue).eq("status","active").gt("remaining_balance",0).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(xe)throw xe;L(_e||[])}catch(_e){console.error("Error fetching user credits:",_e)}},Z=ue=>{const _e=s.find(xe=>xe.id===ue);b(_e)},re=ue=>{E(ue),k("")},W=ue=>{k(ue),E("")},te=()=>{const ue=_||parseFloat(C)||0,_e=B.find(be=>be.amount===_),xe=_e?_e.bonus:0;return ue+xe},oe=()=>_||parseFloat(C)||0,ie=async()=>{if(!y){r({title:"Venue Required",description:"Please select a venue for your credits",variant:"destructive"});return}const ue=oe();if(ue<10){r({title:"Minimum Amount",description:"Minimum credit purchase is 10,000",variant:"destructive"});return}e("/checkout",{state:{creditPurchase:!0,venueId:y.id,venueName:y.name,amount:te(),purchaseAmount:ue,venue:y}})};return n?l.jsx("div",{className:"bg-brand-cream/50 min-h-screen flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold mx-auto mb-4"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Loading venues..."})]})}):l.jsx("div",{className:"bg-brand-cream/50 min-h-screen py-8",children:l.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[l.jsxs("div",{className:"flex items-center mb-8",children:[l.jsxs(xt,{variant:"outline",onClick:()=>e(-1),className:"mr-4 border-brand-burgundy/20 text-brand-burgundy hover:bg-brand-burgundy/10",children:[l.jsx(gE,{className:"h-4 w-4 mr-2"}),"Back"]}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-2",children:"Purchase Venue Credits"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Add credits to your favorite venues for seamless bookings"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[l.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center",children:[l.jsx(qs,{className:"h-5 w-5 mr-2"}),"Select Venue"]})}),l.jsxs(Ht,{children:[l.jsxs(rl,{value:(y==null?void 0:y.id)||"",onValueChange:Z,children:[l.jsx(oo,{className:"border-brand-burgundy/20",children:l.jsx(nl,{placeholder:"Choose a venue for your credits"})}),l.jsx(lo,{children:s.map(ue=>l.jsx(Dn,{value:ue.id,children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-medium",children:ue.name}),l.jsxs("span",{className:"text-sm text-gray-500",children:[" ",ue.type]}),l.jsxs("span",{className:"text-sm text-gray-500",children:[" ",ue.city]})]})},ue.id))})]}),y&&l.jsxs(tt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4 p-4 bg-brand-cream/30 rounded-lg",children:[l.jsx("h4",{className:"font-semibold text-brand-burgundy",children:y.name}),l.jsx("p",{className:"text-sm text-brand-burgundy/70",children:y.address}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[y.type,"  ",y.city]})]})]})]}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center",children:[l.jsx(Sc,{className:"h-5 w-5 mr-2"}),"Select Credit Amount"]})}),l.jsxs(Ht,{className:"space-y-4",children:[l.jsx("div",{className:"grid grid-cols-2 gap-4",children:B.map(ue=>l.jsx(tt.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:l.jsx(Mt,{className:`cursor-pointer transition-colors relative ${_===ue.amount?"border-brand-gold bg-brand-gold/10":"border-brand-burgundy/20 hover:border-brand-gold/50"}`,onClick:()=>re(ue.amount),children:l.jsxs(Ht,{className:"p-4 text-center",children:[ue.popular&&l.jsx(Yr,{className:"absolute -top-2 left-1/2 transform -translate-x-1/2 bg-brand-gold text-brand-burgundy",children:"Popular"}),l.jsx("div",{className:"text-lg font-bold text-brand-burgundy",children:ue.label}),ue.bonus>0&&l.jsxs("div",{className:"text-sm text-green-600 flex items-center justify-center",children:[l.jsx(A8,{className:"h-3 w-3 mr-1"}),"+",ue.bonus.toLocaleString()," bonus"]}),l.jsxs("div",{className:"text-xs text-brand-burgundy/60 mt-1",children:["Total: ",(ue.amount+ue.bonus).toLocaleString()]})]})})},ue.amount))}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"customAmount",className:"text-brand-burgundy",children:"Or enter custom amount ()"}),l.jsx(Lt,{id:"customAmount",type:"number",min:"10",step:"1",value:C,onChange:ue=>W(ue.target.value),className:"border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter amount in thousands (min: 10)"}),l.jsx("p",{className:"text-xs text-brand-burgundy/60 mt-1",children:"Custom amounts do not include bonus credits"})]}),(_||C)&&l.jsxs(tt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 bg-brand-burgundy/5 rounded-lg",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-brand-burgundy",children:"Total Credits:"}),l.jsxs("span",{className:"text-xl font-bold text-brand-burgundy",children:["",te().toLocaleString()]})]}),l.jsxs("div",{className:"text-sm text-brand-burgundy/70 mt-1",children:["Purchase amount: ",oe().toLocaleString()]})]})]})]}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-6",children:[l.jsx(xt,{onClick:ie,disabled:!y||!_&&!C||o,className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90 py-3",size:"lg",children:o?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Fc,{className:"h-4 w-4 mr-2"}),"Purchase Credits - ",oe().toLocaleString()]})}),l.jsx("p",{className:"text-xs text-brand-burgundy/60 text-center mt-2",children:"Credits expire after 1 year from purchase date"})]})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center",children:[l.jsx(Gs,{className:"h-5 w-5 mr-2"}),"Your Current Credits"]})}),l.jsx(Ht,{children:R.length>0?l.jsx("div",{className:"space-y-3",children:R.map(ue=>l.jsxs("div",{className:"p-3 bg-brand-cream/30 rounded-lg",children:[l.jsx("div",{className:"font-medium text-brand-burgundy text-sm",children:ue.venues.name}),l.jsxs("div",{className:"text-xs text-brand-burgundy/70",children:[ue.venues.type,"  ",ue.venues.address]}),l.jsxs("div",{className:"flex justify-between items-center mt-2",children:[l.jsx("span",{className:"text-sm text-brand-burgundy/70",children:"Available:"}),l.jsxs("span",{className:"font-bold text-brand-burgundy",children:["",(ue.remaining_balance/100).toLocaleString()]})]}),l.jsxs("div",{className:"text-xs text-brand-burgundy/50 mt-1",children:["Expires: ",new Date(ue.expires_at).toLocaleDateString()]})]},ue.id))}):l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Sc,{className:"h-12 w-12 text-brand-burgundy/30 mx-auto mb-3"}),l.jsx("p",{className:"text-brand-burgundy/60 text-sm",children:"No active credits"}),l.jsx("p",{className:"text-brand-burgundy/50 text-xs",children:"Purchase credits to get started"})]})})]}),l.jsxs(Mt,{className:"bg-brand-gold/10 border-brand-gold/30",children:[l.jsx(Dr,{children:l.jsx(Lr,{className:"text-brand-burgundy",children:"Why Purchase Credits?"})}),l.jsxs(Ht,{className:"space-y-2 text-sm text-brand-burgundy/80",children:[l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-1.5 h-1.5 bg-brand-gold rounded-full mt-2 flex-shrink-0"}),l.jsx("span",{children:"Faster bookings - skip payment step"})]}),l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-1.5 h-1.5 bg-brand-gold rounded-full mt-2 flex-shrink-0"}),l.jsx("span",{children:"Bonus credits with larger purchases"})]}),l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-1.5 h-1.5 bg-brand-gold rounded-full mt-2 flex-shrink-0"}),l.jsx("span",{children:"Support your favorite venues"})]}),l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-1.5 h-1.5 bg-brand-gold rounded-full mt-2 flex-shrink-0"}),l.jsx("span",{children:"Never expire if used regularly"})]})]})]})]})]})]})})},ks=(e,t)=>{throw console.error(`Error in ${t}:`,e),e},pUe={getProfile:async e=>{try{console.log("Fetching profile for user:",e);const{data:t,error:r}=await Ve.from("user_profiles").select("*").eq("id",e).single();return r&&ks(r,"getProfile"),console.log("Profile data:",t),t}catch(t){ks(t,"getProfile")}},updateProfile:async(e,t)=>{try{console.log("Updating profile for user:",e,"with updates:",t);const{data:r,error:n}=await Ve.from("user_profiles").update(t).eq("id",e).select().single();return n&&ks(n,"updateProfile"),console.log("Updated profile:",r),r}catch(r){ks(r,"updateProfile")}}},CU={getSavedVenues:async e=>{try{console.log("Fetching saved venues for user:",e);const{data:t,error:r}=await Ve.from("saved_venues").select(`
          *,
          venues (*)
        `).eq("user_id",e);return r&&ks(r,"getSavedVenues"),console.log("Saved venues:",t),t}catch(t){ks(t,"getSavedVenues")}},saveVenue:async(e,t)=>{try{console.log("Saving venue:",t,"for user:",e);const{data:r,error:n}=await Ve.from("saved_venues").insert([{user_id:e,venue_id:t}]).select();return n&&ks(n,"saveVenue"),console.log("Saved venue:",r),r}catch(r){ks(r,"saveVenue")}},removeSavedVenue:async(e,t)=>{try{console.log("Removing venue:",t,"for user:",e);const{error:r}=await Ve.from("saved_venues").delete().eq("user_id",e).eq("venue_id",t);r&&ks(r,"removeSavedVenue"),console.log("Venue removed successfully")}catch(r){ks(r,"removeSavedVenue")}}},PU={getUserBookings:async e=>{try{console.log("Fetching bookings for user:",e);const{data:t,error:r}=await Ve.from("user_bookings").select(`
          *,
          venues (*)
        `).eq("user_id",e).order("booking_date",{ascending:!1});return r&&ks(r,"getUserBookings"),console.log("User bookings:",t),t}catch(t){ks(t,"getUserBookings")}},createBooking:async e=>{try{console.log("Creating booking:",e);const{data:t,error:r}=await Ve.from("user_bookings").insert([e]).select();return r&&ks(r,"createBooking"),console.log("Created booking:",t),t}catch(t){ks(t,"createBooking")}},updateBookingStatus:async(e,t)=>{try{console.log("Updating booking:",e,"to status:",t);const{data:r,error:n}=await Ve.from("user_bookings").update({status:t}).eq("id",e).select();return n&&ks(n,"updateBookingStatus"),console.log("Updated booking:",r),r}catch(r){ks(r,"updateBookingStatus")}}},mUe=()=>{const{user:e,signIn:t,signUp:r,signOut:n}=Pd(),[i,o]=I.useState(!1),[h,s]=I.useState({email:"",password:""}),[p,y]=I.useState({email:"",password:"",confirm:""}),[b,_]=I.useState(null),[E,C]=I.useState(null),[k,N]=I.useState(null),[O,R]=I.useState([]),[L,B]=I.useState([]),[q,F]=I.useState(!1);I.useEffect(()=>{e&&H()},[e]);const H=async()=>{try{F(!0);const W=await pUe.getProfile(e.id);N(W);const te=await CU.getSavedVenues(e.id);R(te);const oe=await PU.getUserBookings(e.id);B(oe)}catch(W){console.error("Error loading user data:",W)}finally{F(!1)}},Z=async W=>{W.preventDefault();try{F(!0);const{error:te}=await t(h);if(te)throw te}catch(te){_(te.message)}finally{F(!1)}},re=async W=>{if(W.preventDefault(),p.password!==p.confirm){C("Passwords do not match");return}try{F(!0);const{error:te}=await r({email:p.email,password:p.password});if(te)throw te}catch(te){C(te.message)}finally{F(!1)}};return e?l.jsxs("div",{className:"container py-8",children:[l.jsxs("div",{className:"flex justify-between items-center mb-8",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-brand-burgundy",children:"Test Page"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Testing authentication and API functionality"})]}),l.jsx(xt,{onClick:n,variant:"outline",children:"Sign Out"})]}),l.jsxs("div",{className:"grid gap-6",children:[l.jsxs(Mt,{className:"p-6",children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Profile Information"}),q?l.jsx("p",{children:"Loading..."}):k?l.jsxs("div",{className:"space-y-2",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Email:"})," ",e.email]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Name:"})," ",k.first_name," ",k.last_name]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Phone:"})," ",k.phone_number||"Not set"]})]}):l.jsx("p",{children:"No profile data found"})]}),l.jsxs(Mt,{className:"p-6",children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Saved Venues"}),q?l.jsx("p",{children:"Loading..."}):O.length>0?l.jsx("div",{className:"grid gap-4",children:O.map(W=>l.jsxs(Mt,{className:"p-4",children:[l.jsx("h3",{className:"font-semibold",children:W.venues.name}),l.jsx("p",{className:"text-sm text-brand-burgundy/70",children:W.venues.type}),l.jsx(xt,{onClick:()=>CU.removeSavedVenue(e.id,W.venue_id),variant:"outline",className:"mt-2 text-red-500 border-red-500 hover:bg-red-50",children:"Remove"})]},W.id))}):l.jsx("p",{children:"No saved venues"})]}),l.jsxs(Mt,{className:"p-6",children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Bookings"}),q?l.jsx("p",{children:"Loading..."}):L.length>0?l.jsx("div",{className:"grid gap-4",children:L.map(W=>l.jsx(Mt,{className:"p-4",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold",children:W.venues.name}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[new Date(W.booking_date).toLocaleDateString()," at ",W.start_time]}),l.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[W.number_of_guests," guests"]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-sm font-medium text-brand-burgundy",children:W.status.charAt(0).toUpperCase()+W.status.slice(1)}),W.status==="confirmed"&&l.jsx(xt,{onClick:()=>PU.updateBookingStatus(W.id,"cancelled"),variant:"outline",className:"mt-2 text-red-500 border-red-500 hover:bg-red-50",children:"Cancel"})]})]})},W.id))}):l.jsx("p",{children:"No bookings found"})]})]})]}):l.jsx("div",{className:"container max-w-md mx-auto mt-16 p-8",children:l.jsxs(Mt,{className:"p-6",children:[l.jsx("h2",{className:"text-2xl font-bold mb-4 text-brand-burgundy",children:i?"Sign Up":"Login"}),i?l.jsxs("form",{onSubmit:re,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"email",children:"Email"}),l.jsx(Lt,{id:"email",type:"email",value:p.email,onChange:W=>y({...p,email:W.target.value}),required:!0})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"password",children:"Password"}),l.jsx(Lt,{id:"password",type:"password",value:p.password,onChange:W=>y({...p,password:W.target.value}),required:!0})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"confirm",children:"Confirm Password"}),l.jsx(Lt,{id:"confirm",type:"password",value:p.confirm,onChange:W=>y({...p,confirm:W.target.value}),required:!0})]}),E&&l.jsx("div",{className:"text-red-500",children:E}),l.jsx(xt,{type:"submit",className:"w-full",disabled:q,children:q?"Signing up...":"Sign Up"}),l.jsx("div",{className:"text-center",children:l.jsx("button",{type:"button",onClick:()=>o(!1),className:"text-brand-burgundy hover:underline",children:"Already have an account? Login"})})]}):l.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"email",children:"Email"}),l.jsx(Lt,{id:"email",type:"email",value:h.email,onChange:W=>s({...h,email:W.target.value}),required:!0})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"password",children:"Password"}),l.jsx(Lt,{id:"password",type:"password",value:h.password,onChange:W=>s({...h,password:W.target.value}),required:!0})]}),b&&l.jsx("div",{className:"text-red-500",children:b}),l.jsx(xt,{type:"submit",className:"w-full",disabled:q,children:q?"Logging in...":"Login"}),l.jsx("div",{className:"text-center",children:l.jsx("button",{type:"button",onClick:()=>o(!0),className:"text-brand-burgundy hover:underline",children:"Don't have an account? Sign up"})})]})]})})},gUe=()=>{const e=Array.from({length:50},(t,r)=>({id:r,x:Math.random()*100,y:Math.random()*100,delay:Math.random()*2,duration:3+Math.random()*2}));return l.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.map(t=>l.jsx(tt.div,{className:"absolute w-1 h-1 bg-white/20 rounded-full",style:{left:`${t.x}%`,top:`${t.y}%`},animate:{y:[0,-30,0],opacity:[0,1,0],scale:[.5,1,.5]},transition:{duration:t.duration,repeat:1/0,delay:t.delay,ease:"easeInOut"}},t.id))})},yUe=()=>l.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[l.jsx(tt.div,{className:"absolute inset-0 opacity-50",animate:{background:["linear-gradient(45deg, #8B1538, #A0263A, #8B1538)","linear-gradient(135deg, #A0263A, #B8344F, #A0263A)","linear-gradient(225deg, #8B1538, #A0263A, #8B1538)"]},transition:{duration:8,repeat:1/0,ease:"easeInOut"}}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-brand-burgundy/90 via-brand-burgundy-light/80 to-brand-burgundy/90"})]}),vUe=({text:e,delay:t=0})=>{const[r,n]=I.useState(""),[i,o]=I.useState(!0);return I.useEffect(()=>{const h=setTimeout(()=>{let s=0;const p=setInterval(()=>{s<=e.length?(n(e.slice(0,s)),s++):(clearInterval(p),o(!1))},100);return()=>clearInterval(p)},t);return()=>clearTimeout(h)},[e,t]),l.jsxs("span",{children:[r,i&&l.jsx(tt.span,{animate:{opacity:[1,0]},transition:{duration:.5,repeat:1/0,ease:"easeInOut"},className:"inline-block w-0.5 h-8 md:h-12 bg-white/90 ml-1"})]})},xUe=()=>{const[e,t]=I.useState(!1),[r,n]=I.useState(!1),i=ts(),o=JG();I.useEffect(()=>{n(!0),o.start({opacity:1,y:0,transition:{duration:1,ease:"easeOut"}})},[o]);const h=[{id:"restaurant",name:"Restaurants",description:"Discover the finest dining experiences in Lagos",icon:xE,color:"from-orange-600 to-red-600",count:"50+ venues",features:["Fine Dining","Private Rooms","Chef's Table"]},{id:"club",name:"Clubs",description:"Experience the vibrant nightlife and premium entertainment",icon:I8,color:"from-purple-600 to-pink-600",count:"30+ venues",features:["VIP Tables","Premium Sound","Top DJs"]},{id:"lounge",name:"Lounges",description:"Relax in sophisticated lounges across the city",icon:$c,color:"from-blue-600 to-indigo-600",count:"25+ venues",features:["Cocktail Bar","Sky Views","Premium Service"]}],s=()=>{t(!0)},p=()=>{i("/venue-owner/login")},y=E=>{i(`/venues?type=${E}`)},b={hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.3,staggerChildren:.2}}},_={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100,damping:10}}};return l.jsx("div",{className:"min-h-screen bg-brand-cream overflow-hidden",children:l.jsx(KG,{mode:"wait",children:e?l.jsxs(tt.section,{className:"relative bg-brand-cream py-20 min-h-screen flex items-center overflow-hidden",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[l.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[l.jsx(tt.div,{className:"absolute inset-0 opacity-5",animate:{backgroundImage:["radial-gradient(circle at 20% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 80% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 40% 60%, #8B1538 0%, transparent 50%)","radial-gradient(circle at 80% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 20% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 60% 40%, #8B1538 0%, transparent 50%)","radial-gradient(circle at 20% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 80% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 40% 60%, #8B1538 0%, transparent 50%)"]},transition:{duration:10,repeat:1/0,ease:"easeInOut"}}),Array.from({length:8}).map((E,C)=>l.jsx(tt.div,{className:"absolute w-20 h-20 border-2 border-brand-burgundy/10 rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-30,0],x:[0,15,0],rotate:[0,180,360],scale:[1,1.2,1]},transition:{duration:8+Math.random()*4,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},C))]}),l.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[l.jsxs(tt.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"text-center mb-20",children:[l.jsx(tt.div,{className:"inline-block mb-6",animate:{rotate:[0,2,-2,0],scale:[1,1.02,1]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:l.jsxs("span",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-brand-burgundy/10 to-brand-gold/10 backdrop-blur-sm border border-brand-burgundy/20 rounded-full px-6 py-2 text-brand-burgundy/70 font-medium",children:[l.jsx(T1,{className:"w-4 h-4 text-brand-gold"}),"Premium Venue Categories"]})}),l.jsxs(tt.h2,{className:"text-5xl md:text-6xl lg:text-7xl font-heading text-brand-burgundy mb-6 font-bold",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:1,delay:.3},children:["Browse by"," ",l.jsxs(tt.span,{className:"relative inline-block",whileHover:{scale:1.05},children:[l.jsx("span",{className:"text-brand-gold font-extrabold",children:"Category"}),l.jsx(tt.div,{className:"absolute -bottom-2 left-0 right-0 h-1 bg-gradient-to-r from-brand-gold to-brand-burgundy rounded-full",initial:{scaleX:0},animate:{scaleX:1},transition:{duration:1,delay:.8}})]})]}),l.jsx(tt.p,{className:"text-xl md:text-2xl text-brand-burgundy/70 max-w-3xl mx-auto leading-relaxed",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.5},children:"Choose your perfect venue type and discover the best experiences Lagos has to offer"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 lg:gap-12",children:h.map((E,C)=>l.jsx(tt.div,{initial:{opacity:0,y:60,rotateY:-15},animate:{opacity:1,y:0,rotateY:0},transition:{duration:.8,delay:.6+C*.15,ease:"easeOut"},whileHover:{y:-15,scale:1.03,rotateY:5,transition:{duration:.4,ease:"easeOut",type:"spring",stiffness:200}},className:"group cursor-pointer perspective-1000",onClick:()=>y(E.id),style:{perspective:"1000px"},children:l.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl overflow-hidden border-2 border-brand-burgundy/10 group-hover:border-brand-gold/50 group-hover:shadow-3xl transition-all duration-500 transform-gpu",children:[l.jsxs(tt.div,{className:`relative h-80 bg-gradient-to-br ${E.color} flex items-center justify-center overflow-hidden`,whileHover:{scale:1.02},transition:{duration:.4},children:[l.jsx(tt.div,{className:"absolute inset-0 opacity-20",animate:{background:["radial-gradient(circle at 0% 0%, rgba(255,255,255,0.3) 0%, transparent 50%)","radial-gradient(circle at 100% 100%, rgba(255,255,255,0.3) 0%, transparent 50%)","radial-gradient(circle at 0% 0%, rgba(255,255,255,0.3) 0%, transparent 50%)"]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}}),Array.from({length:12}).map((k,N)=>l.jsx(tt.div,{className:"absolute w-2 h-2 bg-white/30 rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-20,0],x:[0,10,0],opacity:[.3,.8,.3],scale:[.5,1,.5]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},N)),l.jsx(tt.div,{className:"relative z-10",whileHover:{scale:1.15,rotate:[0,-5,5,0],y:-5},transition:{duration:.4,rotate:{duration:.6}},children:l.jsx(tt.div,{className:"relative",animate:{filter:["drop-shadow(0 0 20px rgba(255,255,255,0.5))","drop-shadow(0 0 30px rgba(255,255,255,0.8))","drop-shadow(0 0 20px rgba(255,255,255,0.5))"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:l.jsx(E.icon,{className:"w-28 h-28 text-white drop-shadow-2xl"})})}),l.jsx(tt.div,{className:"absolute top-6 right-6 bg-white/25 backdrop-blur-sm rounded-2xl px-4 py-2 border border-white/30",initial:{opacity:0,x:30,scale:.8},animate:{opacity:1,x:0,scale:1},transition:{delay:.8+C*.1,duration:.5},whileHover:{scale:1.05,y:-2},children:l.jsx("span",{className:"text-white text-sm font-bold",children:E.count})}),l.jsx(tt.div,{className:"absolute bottom-6 left-6 w-8 h-8 border-l-2 border-b-2 border-white/40",animate:{scale:[1,1.1,1],opacity:[.4,.8,.4]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})]}),l.jsxs(tt.div,{className:"p-8 relative",whileHover:{backgroundColor:"rgba(139, 21, 56, 0.02)"},transition:{duration:.3},children:[l.jsx(tt.h3,{className:"text-3xl md:text-4xl font-bold text-brand-burgundy mb-4 group-hover:text-brand-gold transition-colors duration-300",whileHover:{x:5},children:E.name}),l.jsx(tt.p,{className:"text-brand-burgundy/70 text-lg mb-8 leading-relaxed",initial:{opacity:.7},whileHover:{opacity:1},children:E.description}),l.jsx("div",{className:"space-y-3 mb-8",children:E.features.map((k,N)=>l.jsxs(tt.div,{className:"flex items-center text-brand-burgundy/60 group-hover:text-brand-burgundy/80",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1+C*.1+N*.1},whileHover:{x:5,scale:1.02},children:[l.jsx(tt.div,{className:"mr-3",animate:{rotate:[0,180,360]},transition:{duration:8,repeat:1/0,ease:"linear",delay:N*.2},children:l.jsx(Gs,{className:"w-4 h-4 text-brand-gold fill-brand-gold"})}),l.jsx("span",{className:"font-medium",children:k})]},N))}),l.jsxs(tt.div,{className:"relative overflow-hidden bg-gradient-to-r from-brand-burgundy/5 to-brand-gold/5 rounded-2xl p-4 group-hover:from-brand-burgundy/10 group-hover:to-brand-gold/10 transition-all duration-300",whileHover:{scale:1.02},children:[l.jsx(tt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/20 to-brand-burgundy/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.8}}),l.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[l.jsxs("div",{children:[l.jsxs(tt.span,{className:"font-bold text-brand-burgundy group-hover:text-brand-gold transition-colors duration-300 text-lg",whileHover:{scale:1.05},children:["Explore ",E.name]}),l.jsx("p",{className:"text-sm text-brand-burgundy/60 mt-1",children:"Discover premium venues"})]}),l.jsx(tt.div,{className:"flex items-center justify-center w-12 h-12 bg-brand-burgundy group-hover:bg-brand-gold rounded-full transition-colors duration-300",whileHover:{scale:1.1,rotate:90,boxShadow:"0 8px 25px rgba(139, 21, 56, 0.3)"},whileTap:{scale:.9},children:l.jsx(Bl,{className:"w-5 h-5 text-white group-hover:text-brand-burgundy transition-colors duration-300"})})]})]}),l.jsx(tt.div,{className:"absolute top-4 right-4 w-16 h-16 bg-gradient-to-br from-brand-gold/10 to-brand-burgundy/10 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500",animate:{scale:[1,1.2,1],rotate:[0,180,360]},transition:{duration:8,repeat:1/0,ease:"linear"}})]}),l.jsx(tt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/0 via-brand-gold/5 to-brand-burgundy/0 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-500",initial:{scale:.8,opacity:0},whileHover:{scale:1,opacity:1}})]})},E.id))}),l.jsxs(tt.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:1.2},className:"text-center mt-20",children:[l.jsx(tt.p,{className:"text-brand-burgundy/60 mb-6 text-lg",animate:{opacity:[.6,1,.6]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:"Can't find what you're looking for?"}),l.jsx(tt.button,{whileHover:{scale:1.05,y:-3,boxShadow:"0 15px 35px rgba(139, 21, 56, 0.2)"},whileTap:{scale:.95},onClick:()=>i("/venues"),className:"bg-gradient-to-r from-brand-burgundy to-brand-burgundy-light hover:from-brand-gold hover:to-yellow-500 text-white px-8 py-4 rounded-2xl font-semibold text-lg shadow-xl transition-all duration-300",children:"Browse All Venues"})]})]})]},"categories"):l.jsxs(tt.section,{className:"relative bg-brand-burgundy flex items-center justify-center overflow-hidden min-h-screen",initial:{opacity:1},exit:{opacity:0,scale:.95,transition:{duration:.6,ease:"easeInOut"}},children:[l.jsx(yUe,{}),l.jsx(gUe,{}),l.jsx("div",{className:"container mx-auto px-4 flex flex-col items-center justify-center h-full relative z-10",children:l.jsxs(tt.div,{className:"max-w-5xl w-full text-white text-center",variants:b,initial:"hidden",animate:"visible",children:[l.jsx(tt.div,{variants:_,className:"mb-8 pt-8 pb-4 md:pt-0 md:pb-0",children:l.jsxs(tt.div,{className:"inline-flex items-center gap-3 mb-6",whileHover:{scale:1.05},transition:{type:"spring",stiffness:400,damping:10},children:[l.jsx(tt.div,{className:"p-3 bg-brand-gold rounded-2xl",animate:{rotate:[0,5,-5,0],scale:[1,1.1,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:l.jsx(T1,{className:"w-8 h-8 text-brand-burgundy"})}),l.jsx("span",{className:"text-2xl font-bold tracking-wider text-brand-gold",children:"VIP CLUB"})]})}),l.jsxs(tt.h1,{variants:_,className:"text-5xl md:text-7xl lg:text-8xl font-heading mb-8 font-bold tracking-tight leading-tight",children:[l.jsx(tt.span,{className:"block mb-4 text-white/90",initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.8,delay:.5},children:"Discover"}),l.jsx(tt.span,{className:"block text-6xl md:text-8xl lg:text-9xl mb-4",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:1,delay:.8},children:l.jsx("span",{className:"text-brand-gold font-extrabold drop-shadow-2xl",children:l.jsx(vUe,{text:"Eddys'",delay:1200})})}),l.jsx(tt.span,{className:"block text-4xl md:text-6xl lg:text-7xl text-white/95",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:1.5},children:"Finest Venues"})]}),l.jsx(tt.p,{variants:_,className:"text-xl md:text-2xl lg:text-3xl mb-12 text-white/80 font-medium max-w-3xl mx-auto leading-relaxed",children:"Book tables, enjoy exclusive experiences, and make unforgettable memories in Lagos' most prestigious venues"}),l.jsxs(tt.div,{variants:_,className:"flex flex-col md:flex-row gap-6 lg:gap-8 justify-center items-center mb-12",children:[l.jsxs(tt.button,{whileHover:{scale:1.05,boxShadow:"0 20px 40px rgba(0,0,0,0.3)",y:-2},whileTap:{scale:.98},onClick:s,className:"group relative overflow-hidden flex items-center gap-4 bg-brand-cream text-brand-burgundy text-xl lg:text-2xl px-10 py-5 rounded-2xl font-semibold shadow-2xl hover:shadow-3xl transition-all duration-300 min-w-[250px] justify-center",children:[l.jsx(tt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/20 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6}}),l.jsx(Kn,{className:"w-6 h-6 group-hover:scale-110 transition-transform duration-200"}),l.jsx("span",{children:"I'm a Customer"}),l.jsx(Bl,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-200"})]}),l.jsxs(tt.button,{whileHover:{scale:1.05,y:-2,boxShadow:"0 20px 40px rgba(255,255,255,0.1)"},whileTap:{scale:.98},onClick:p,className:"group relative overflow-hidden flex items-center gap-4 bg-transparent border-2 border-brand-cream text-brand-cream text-xl lg:text-2xl px-10 py-5 rounded-2xl font-semibold shadow-2xl hover:bg-brand-cream/10 backdrop-blur-sm transition-all duration-300 min-w-[250px] justify-center",children:[l.jsx(tt.div,{className:"absolute inset-0 bg-brand-cream/10",initial:{scale:0,opacity:0},whileHover:{scale:1,opacity:1},transition:{duration:.3}}),l.jsx(yd,{className:"w-6 h-6 group-hover:scale-110 transition-transform duration-200"}),l.jsx("span",{children:"I'm a Venue Owner"}),l.jsx(Bl,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-200"})]})]}),l.jsxs(tt.div,{variants:_,className:"flex flex-wrap justify-center items-center gap-6 md:gap-8 text-white/60 text-sm pt-4 pb-8 md:pt-0 md:pb-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Gs,{className:"w-4 h-4 text-brand-gold fill-brand-gold"}),l.jsx("span",{children:"4.9/5 Customer Rating"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx($c,{className:"w-4 h-4 text-brand-gold"}),l.jsx("span",{children:"100+ Premium Venues"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Is,{className:"w-4 h-4 text-brand-gold"}),l.jsx("span",{children:"50K+ Happy Customers"})]})]})]})})]},"hero")})})},bUe=()=>{const[e,t]=I.useState(""),[r,n]=I.useState(!1),[i,o]=I.useState([]),{toast:h}=Ui(),s={serviceId:"service_55v7svp",templateId:"template_wh2h7sn",publicKey:"_DltRvDA4UAiyUt1E"},p=(b,_="info")=>{const E=new Date().toLocaleTimeString();o(C=>[...C,{message:b,type:_,timestamp:E}])},y=async()=>{if(!e){h({title:"Please enter an email",variant:"destructive"});return}n(!0),o([]);try{p("Checking EmailJS configuration...","info"),!s.serviceId||!s.templateId||s.publicKey,p(" Configuration looks good","success"),p(`Service ID: ${s.serviceId}`,"info"),p(`Template ID: ${s.templateId}`,"info"),p("Testing with simple parameters...","info");const b={to_email:e,to_name:"Test User",from_name:"Eddys Members",subject:"Eddys Members Test Email",message:"This is a test email to verify EmailJS configuration."};try{const C=await Ws.send(s.serviceId,s.templateId,b);p(" Simple test successful!","success"),p(`Response: ${C.text}`,"success")}catch(C){p(` Simple test failed: ${C.text||C.message}`,"error"),p(`Error status: ${C.status}`,"error")}p("Testing with alternative parameter names...","info");const _={user_email:e,email:e,to:e,recipient:e,user_name:"Test User",name:"Test User",from_name:"Eddys Members",message:"Testing alternative parameter names for EmailJS template."};try{const C=await Ws.send(s.serviceId,s.templateId,_);p(" Alternative parameters test successful!","success"),p(`Response: ${C.text}`,"success")}catch(C){p(` Alternative parameters test failed: ${C.text||C.message}`,"error"),p(`Error status: ${C.status}`,"error")}p("Testing with your template parameters...","info");const E={customerName:"Test Customer",customerEmail:e,customerPhone:"+234 XXX XXX XXXX",bookingReference:"VIP-TEST123",partySize:"2",bookingDate:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),bookingTime:"7:00 PM",bookingDuration:"4",tableNumber:"VIP-001",tableType:"VIP Table",tableCapacity:"2",tableLocation:"Prime Location",tableFeatures:"Premium seating with excellent view",venueName:"Test Venue",venueDescription:"Experience luxury dining and entertainment in Lagos' most exclusive venue.",venueAddress:"Lagos, Nigeria",venuePhone:"+234 XXX XXX XXXX",venueDressCode:"Smart Casual",venueParking:"Valet parking available",venueCuisine:"International cuisine",venueHours:"6:00 PM - 2:00 AM",specialRequests:"None specified",viewBookingUrl:window.location.origin+"/profile",modifyBookingUrl:window.location.origin+"/profile",cancelBookingUrl:window.location.origin+"/profile",websiteUrl:window.location.origin,supportUrl:"mailto:info@oneeddy.com",unsubscribeUrl:window.location.origin+"/settings"};try{const C=await Ws.send(s.serviceId,s.templateId,E);p(" Booking test successful!","success"),p(`Response: ${C.text}`,"success")}catch(C){p(` Booking test failed: ${C.text||C.message}`,"error"),p(`Error status: ${C.status}`,"error")}h({title:"Email tests completed",description:"Check the results below and your email inbox"})}catch(b){p(` Unexpected error: ${b.message}`,"error")}finally{n(!1)}};return l.jsx("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:l.jsxs(Mt,{children:[l.jsxs(Dr,{children:[l.jsx(Lr,{className:"text-brand-burgundy",children:"EmailJS Debug Test"}),l.jsx("p",{className:"text-gray-600",children:"Test your EmailJS configuration to fix booking confirmation emails"})]}),l.jsxs(Ht,{className:"space-y-6",children:[l.jsxs("div",{className:"flex gap-4",children:[l.jsx(Lt,{type:"email",placeholder:"Enter your email to test",value:e,onChange:b=>t(b.target.value),className:"flex-1"}),l.jsx(xt,{onClick:y,disabled:r,className:"bg-brand-burgundy hover:bg-brand-burgundy/90",children:r?"Testing...":"Test EmailJS"})]}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium mb-2",children:"Current Configuration:"}),l.jsxs("div",{className:"text-sm space-y-1",children:[l.jsxs("div",{children:["Service ID: ",l.jsx("code",{className:"bg-white px-1 rounded",children:s.serviceId})]}),l.jsxs("div",{children:["Template ID: ",l.jsx("code",{className:"bg-white px-1 rounded",children:s.templateId})]}),l.jsxs("div",{children:["Public Key: ",l.jsx("code",{className:"bg-white px-1 rounded",children:" Set"})]})]})]}),i.length>0&&l.jsxs("div",{className:"border rounded-lg p-4 bg-white max-h-96 overflow-y-auto",children:[l.jsx("h3",{className:"font-medium mb-2",children:"Test Results:"}),l.jsx("div",{className:"space-y-1 text-sm font-mono",children:i.map((b,_)=>l.jsxs("div",{className:`p-2 rounded ${b.type==="success"?"bg-green-50 text-green-800":b.type==="error"?"bg-red-50 text-red-800":"bg-gray-50 text-gray-700"}`,children:[l.jsxs("span",{className:"text-gray-500",children:["[",b.timestamp,"]"]})," ",b.message]},_))})]}),l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:"Instructions:"}),l.jsxs("ol",{className:"text-sm text-blue-700 space-y-1 list-decimal list-inside",children:[l.jsx("li",{children:"Enter your email address above"}),l.jsx("li",{children:'Click "Test EmailJS" to run the tests'}),l.jsx("li",{children:"Check the results below for any errors"}),l.jsx("li",{children:"Check your email inbox for test messages"}),l.jsx("li",{children:"If tests fail, check your EmailJS template configuration"})]})]})]})]})})};var GZ={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(us,function(){var r,n,i;function o(s,p){if(!r)r=p;else if(!n)n=p;else{var y="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",b={};r(b),i=p(b),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(i.workerUrl=window.URL.createObjectURL(new Blob([y],{type:"text/javascript"})))}}o(["exports"],function(s){var p=typeof self<"u"?self:{},y="2.15.0";let b;const _={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(b==null){const c=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{b={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):c}catch{b=c}}return b},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!_.API_URL)return null;try{const c=new URL(_.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},E={supported:!1,testSupport:function(c){!N&&k&&(O?R(c):C=c)}};let C,k,N=!1,O=!1;function R(c){const a=c.createTexture();c.bindTexture(c.TEXTURE_2D,a);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,k),c.isContextLost())return;E.supported=!0}catch{}c.deleteTexture(a),N=!0}p.document&&(k=p.document.createElement("img"),k.onload=function(){C&&R(C),C=null,O=!0},k.onerror=function(){N=!0,C=null},k.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const L="01";function B(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var q=F;function F(c,a,u,f){this.cx=3*c,this.bx=3*(u-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=a,this.p2x=u,this.p2y=f}F.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,a){if(a===void 0&&(a=1e-6),c<0)return 0;if(c>1)return 1;for(var u=c,f=0;f<8;f++){var g=this.sampleCurveX(u)-c;if(Math.abs(g)<a)return u;var x=this.sampleCurveDerivativeX(u);if(Math.abs(x)<1e-6)break;u-=g/x}var S=0,j=1;for(u=c,f=0;f<20&&(g=this.sampleCurveX(u),!(Math.abs(g-c)<a));f++)c>g?S=u:j=u,u=.5*(j-S)+S;return u},solve:function(c,a){return this.sampleCurveY(this.solveCurveX(c,a))}};var H=B(q),Z=re;function re(c,a){this.x=c,this.y=a}re.prototype={clone:function(){return new re(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,a){return this.clone()._rotateAround(c,a)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var a=c.x-this.x,u=c.y-this.y;return a*a+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,a){return Math.atan2(this.x*a-this.y*c,this.x*c+this.y*a)},_matMult:function(c){var a=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=a,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var a=Math.cos(c),u=Math.sin(c),f=u*this.x+a*this.y;return this.x=a*this.x-u*this.y,this.y=f,this},_rotateAround:function(c,a){var u=Math.cos(c),f=Math.sin(c),g=a.y+f*(this.x-a.x)+u*(this.y-a.y);return this.x=a.x+u*(this.x-a.x)-f*(this.y-a.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},re.convert=function(c){return c instanceof re?c:Array.isArray(c)?new re(c[0],c[1]):c};var W=B(Z);const te=Math.PI/180,oe=180/Math.PI;function ie(c){return c*te}function ue(c){return c*oe}const _e=[[0,0],[1,0],[1,1],[0,1]];function xe(c){if(c<=0)return 0;if(c>=1)return 1;const a=c*c,u=a*c;return 4*(c<.5?u:3*(c-a)+u-.75)}function be(c,a,u,f){const g=new H(c,a,u,f);return function(x){return g.solve(x)}}const Ae=be(.25,.1,.25,1);function me(c,a,u){return Math.min(u,Math.max(a,c))}function ke(c,a,u){return(u=me((u-c)/(a-c),0,1))*u*(3-2*u)}function Ne(c,a,u){const f=u-a,g=((c-a)%f+f)%f+a;return g===a?u:g}function Be(c,a,u){if(!c.length)return u(null,[]);let f=c.length;const g=new Array(c.length);let x=null;c.forEach((S,j)=>{a(S,(A,M)=>{A&&(x=A),g[j]=M,--f==0&&u(x,g)})})}function We(c){const a=[];for(const u in c)a.push(c[u]);return a}function ut(c,...a){for(const u of a)for(const f in u)c[f]=u[f];return c}let nt=1;function Pt(){return nt++}function It(){return function c(a){return a?(a^Math.random()*(16>>a/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function at(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function Ut(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function ct(c,a){c.forEach(u=>{a[u]&&(a[u]=a[u].bind(a))})}function gt(c,a){return c.indexOf(a,c.length-a.length)!==-1}function it(c,a,u){const f={};for(const g in c)f[g]=a.call(u||this,c[g],g,c);return f}function rt(c,a,u){const f={};for(const g in c)a.call(u||this,c[g],g,c)&&(f[g]=c[g]);return f}function rr(c){return Array.isArray(c)?c.map(rr):typeof c=="object"&&c?it(c,rr):c}const ir={};function or(c){ir[c]||(typeof console<"u"&&console.warn(c),ir[c]=!0)}function Sr(c,a,u){return(u.y-c.y)*(a.x-c.x)>(a.y-c.y)*(u.x-c.x)}function tn(c){let a=0;for(let u,f,g=0,x=c.length,S=x-1;g<x;S=g++)u=c[g],f=c[S],a+=(f.x-u.x)*(u.y+f.y);return a}function Mn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function vn(c){const a={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,g,x)=>{const S=g||x;return a[f]=!S||S.toLowerCase(),""}),a["max-age"]){const u=parseInt(a["max-age"],10);isNaN(u)?delete a["max-age"]:a["max-age"]=u}return a}let Zs=null;function qi(c){if(Zs==null){const a=c.navigator?c.navigator.userAgent:null;Zs=!!c.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return Zs}function ns(c){try{const a=p[c];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch{return!1}}function ms(c,a){return[c[4*a],c[4*a+1],c[4*a+2],c[4*a+3]]}const xa="mapbox-tiles";let Fa=500,ft=50,Kt,Ar;function Zr(){try{return p.caches}catch{}}function In(){Zr()&&!Kt&&(Kt=p.caches.open(xa))}function Ii(c){const a=c.indexOf("?");if(a<0)return c;const u=function(g){const x=g.indexOf("?");return x>0?g.slice(x+1).split("&"):[]}(c),f=u.filter(g=>{const x=g.split("=");return x[0]==="language"||x[0]==="worldview"});return f.length?`${c.slice(0,a)}?${f.join("&")}`:c.slice(0,a)}let Wi=1/0;const Ua={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ua);class Oi extends Error{constructor(a,u,f){u===401&&Ge(f)&&(a+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(a),this.status=u,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const wo=Mn()?()=>self.worker&&self.worker.referrer:()=>(p.location.protocol==="blob:"?p.parent:p).location.href,Zl=function(c,a){if(!(/^file:/.test(u=c.url)||/^file:/.test(wo())&&!/^\w+:/.test(u))){if(p.fetch&&p.Request&&p.AbortController&&p.Request.prototype.hasOwnProperty("signal"))return function(f,g){const x=new p.AbortController,S=new p.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:wo(),referrerPolicy:f.referrerPolicy,signal:x.signal});let j=!1,A=!1;const M=($=S.url).indexOf("sku=")>0&&Ge($);var $;f.type==="json"&&S.headers.set("Accept","application/json");const V=(Y,J,ne)=>{if(A)return;if(Y&&Y.message!=="SecurityError"&&or(Y.toString()),J&&ne)return G(J);const ce=Date.now();p.fetch(S).then(ye=>{if(ye.ok){const Pe=M?ye.clone():null;return G(ye,Pe,ce)}return g(new Oi(ye.statusText,ye.status,f.url))}).catch(ye=>{ye.name!=="AbortError"&&g(new Error(`${ye.message} ${f.url}`))})},G=(Y,J,ne)=>{(f.type==="arrayBuffer"?Y.arrayBuffer():f.type==="json"?Y.json():Y.text()).then(ce=>{A||(J&&ne&&function(ye,Pe,ve){if(In(),!Kt)return;const Te={status:Pe.status,statusText:Pe.statusText,headers:new p.Headers};Pe.headers.forEach((Ye,Xe)=>Te.headers.set(Xe,Ye));const Ie=vn(Pe.headers.get("Cache-Control")||"");if(Ie["no-store"])return;Ie["max-age"]&&Te.headers.set("Expires",new Date(ve+1e3*Ie["max-age"]).toUTCString());const Me=Te.headers.get("Expires");Me&&(new Date(Me).getTime()-ve<42e4||function(Ye,Xe){if(Ar===void 0)try{new Response(new ReadableStream),Ar=!0}catch{Ar=!1}Ar?Xe(Ye.body):Ye.blob().then(Xe)}(Pe,Ye=>{const Xe=new p.Response(Ye,Te);In(),Kt&&Kt.then(lt=>lt.put(Ii(ye.url),Xe)).catch(lt=>or(lt.message))}))}(S,J,ne),j=!0,g(null,ce,Y.headers.get("Cache-Control"),Y.headers.get("Expires")))}).catch(ce=>{A||g(new Error(ce.message))})};return M?function(Y,J){if(In(),!Kt)return J(null);const ne=Ii(Y.url);Kt.then(ce=>{ce.match(ne).then(ye=>{const Pe=function(ve){if(!ve)return!1;const Te=new Date(ve.headers.get("Expires")||0),Ie=vn(ve.headers.get("Cache-Control")||"");return Te>Date.now()&&!Ie["no-cache"]}(ye);ce.delete(ne),Pe&&ce.put(ne,ye.clone()),J(null,ye,Pe)}).catch(J)}).catch(J)}(S,V):V(null,null),{cancel:()=>{A=!0,j||x.abort()}}}(c,a);if(Mn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,a,void 0,!0)}var u;return function(f,g){const x=new p.XMLHttpRequest;x.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(x.responseType="arraybuffer");for(const S in f.headers)x.setRequestHeader(S,f.headers[S]);return f.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=f.credentials==="include",x.onerror=()=>{g(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let S=x.response;if(f.type==="json")try{S=JSON.parse(x.response)}catch(j){return g(j)}g(null,S,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else g(new Oi(x.statusText,x.status,f.url))},x.send(f.body),{cancel:()=>x.abort()}}(c,a)},ru=function(c,a){return Zl(ut(c,{type:"arrayBuffer"}),a)};function Nf(c){const a=p.document.createElement("a");return a.href=c,a.protocol===p.document.location.protocol&&a.host===p.document.location.host}const Ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let se,ae;se=[],ae=0;const Ee=function(c,a){if(E.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),ae>=_.MAX_PARALLEL_IMAGE_REQUESTS){const x={requestParameters:c,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return se.push(x),x}ae++;let u=!1;const f=()=>{if(!u)for(u=!0,ae--;se.length&&ae<_.MAX_PARALLEL_IMAGE_REQUESTS;){const x=se.shift(),{requestParameters:S,callback:j,cancelled:A}=x;A||(x.cancel=Ee(S,j).cancel)}},g=ru(c,(x,S,j,A)=>{f(),x?a(x):S&&(p.createImageBitmap?function(M,$){const V=new p.Blob([new Uint8Array(M)],{type:"image/png"});p.createImageBitmap(V).then(G=>{$(null,G)}).catch(G=>{$(new Error(`Could not load image because of ${G.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(S,(M,$)=>a(M,$,j,A)):function(M,$){const V=new p.Image,G=p.URL;V.onload=()=>{$(null,V),G.revokeObjectURL(V.src),V.onload=null,p.requestAnimationFrame(()=>{V.src=Ce})},V.onerror=()=>$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Y=new p.Blob([new Uint8Array(M)],{type:"image/png"});V.src=M.byteLength?G.createObjectURL(Y):Ce}(S,(M,$)=>a(M,$,j,A)))});return{cancel:()=>{g.cancel(),f()}}},Oe="NO_ACCESS_TOKEN";function $e(c){return c.indexOf("mapbox:")===0}function Ge(c){return _.API_URL_REGEX.test(c)}function qe(c){return _.API_CDN_URL_REGEX.test(c)}function ze(c){return _.API_STYLE_REGEX.test(c)&&!et(c)}function et(c){return _.API_SPRITE_REGEX.test(c)}const kt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ot(c){const a=c.match(kt);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function Ct(c){const a=c.params.length?`?${c.params.join("&")}`:"";return`${c.protocol}://${c.authority}${c.path}${a}`}const pr="mapbox.eventData";function br(c){if(!c)return null;const a=c.split(".");if(!a||a.length!==3)return null;try{return JSON.parse(decodeURIComponent(p.atob(a[1]).split("").map(u=>"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class mr{constructor(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(a){const u=br(_.ACCESS_TOKEN);let f="";return f=u&&u.u?p.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,(g,x)=>String.fromCharCode(+("0x"+x)))):_.ACCESS_TOKEN||"",a?`${pr}.${a}:${f}`:`${pr}:${f}`}fetchEventData(){const a=ns("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(a)try{const g=p.localStorage.getItem(u);g&&(this.eventData=JSON.parse(g));const x=p.localStorage.getItem(f);x&&(this.anonId=x)}catch{or("Unable to read from LocalStorage")}}saveEventData(){const a=ns("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(a)try{p.localStorage.setItem(f,this.anonId),Object.keys(this.eventData).length>=1&&p.localStorage.setItem(u,JSON.stringify(this.eventData))}catch{or("Unable to write to LocalStorage")}}processRequests(a){}postEvent(a,u,f,g){if(!_.EVENTS_URL)return;const x=Ot(_.EVENTS_URL);x.params.push(`access_token=${g||_.ACCESS_TOKEN||""}`);const S={event:this.type,created:new Date(a).toISOString()},j=u?ut(S,u):S,A={url:Ct(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([j])};this.pendingRequest=function(M,$){return Zl(ut(M,{method:"POST"}),$)}(A,M=>{this.pendingRequest=null,f(M),this.saveEventData(),this.processRequests(g)})}queueRequest(a,u){this.queue.push(a),this.processRequests(u)}}const _r=new class extends mr{constructor(c){super("appUserTurnstile"),this._customAccessToken=c}postTurnstileEvent(c,a){_.EVENTS_URL&&_.ACCESS_TOKEN&&Array.isArray(c)&&c.some(u=>$e(u)||Ge(u))&&this.queueRequest(Date.now(),a)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const a=br(_.ACCESS_TOKEN),u=a?a.u:_.ACCESS_TOKEN;let f=u!==this.eventData.tokenU;Ut(this.anonId)||(this.anonId=It(),f=!0);const g=this.queue.shift();if(this.eventData.lastSuccess){const x=new Date(this.eventData.lastSuccess),S=new Date(g),j=(g-this.eventData.lastSuccess)/864e5;f=f||j>=1||j<-1||x.getDate()!==S.getDate()}else f=!0;f?this.postEvent(g,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:L,"enabled.telemetry":!1,userId:this.anonId},x=>{x||(this.eventData.lastSuccess=g,this.eventData.tokenU=u)},c):this.processRequests()}},Nr=_r.postTurnstileEvent.bind(_r),Pn=new class extends mr{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(c,a,u,f){this.skuToken=a,this.errorCb=f,_.EVENTS_URL&&(u||_.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(Oe)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||(this.anonId||this.fetchEventData(),Ut(this.anonId)||(this.anonId=It()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:L,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):a&&(this.success[a]=!0)},c))}},Yn=Pn.postMapLoadEvent.bind(Pn),Gi=new class extends mr{constructor(){super("gljs.performance")}postPerformanceEvent(c,a){_.EVENTS_URL&&(c||_.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:a},c)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:a,performanceData:u}=this.queue.shift(),f=function(g){const x=p.performance.getEntriesByType("resource"),S=p.performance.getEntriesByType("mark"),j=function(G){const Y={};if(G){for(const J in G)if(J!=="other")for(const ne of G[J]){const ce=`${J}ResolveRangeMin`,ye=`${J}ResolveRangeMax`,Pe=`${J}RequestCount`,ve=`${J}RequestCachedCount`;Y[ce]=Math.min(Y[ce]||1/0,ne.startTime),Y[ye]=Math.max(Y[ye]||-1/0,ne.responseEnd);const Te=Ie=>{Y[Ie]===void 0&&(Y[Ie]=0),++Y[Ie]};ne.transferSize!==void 0&&ne.transferSize===0&&Te(ve),Te(Pe)}}return Y}(function(G,Y){const J={};if(G)for(const ne of G){const ce=Y(ne);J[ce]===void 0&&(J[ce]=[]),J[ce].push(ne)}return J}(x,cb)),A=p.devicePixelRatio,M=p.navigator.connection||p.navigator.mozConnection||p.navigator.webkitConnection,$={counters:[],metadata:[],attributes:[]},V=(G,Y,J)=>{J!=null&&G.push({name:Y,value:J.toString()})};for(const G in j)V($.counters,G,j[G]);if(g.interactionRange[0]!==1/0&&g.interactionRange[1]!==-1/0&&(V($.counters,"interactionRangeMin",g.interactionRange[0]),V($.counters,"interactionRangeMax",g.interactionRange[1])),S)for(const G of Object.keys(nu)){const Y=nu[G],J=S.find(ne=>ne.name===Y);J&&V($.counters,Y,J.startTime)}return V($.counters,"visibilityHidden",g.visibilityHidden),V($.attributes,"style",function(G){if(G)for(const Y of G){const J=Y.name.split("?")[0];if(ze(J)){const ne=J.split("/").slice(-2);if(ne.length===2)return`mapbox://styles/${ne[0]}/${ne[1]}`}}}(x)),V($.attributes,"terrainEnabled",g.terrainEnabled?"true":"false"),V($.attributes,"fogEnabled",g.fogEnabled?"true":"false"),V($.attributes,"projection",g.projection),V($.attributes,"zoom",g.zoom),V($.metadata,"devicePixelRatio",A),V($.metadata,"connectionEffectiveType",M?M.effectiveType:void 0),V($.metadata,"navigatorUserAgent",p.navigator.userAgent),V($.metadata,"screenWidth",p.screen.width),V($.metadata,"screenHeight",p.screen.height),V($.metadata,"windowWidth",p.innerWidth),V($.metadata,"windowHeight",p.innerHeight),V($.metadata,"mapWidth",g.width/A),V($.metadata,"mapHeight",g.height/A),V($.metadata,"webglRenderer",g.renderer),V($.metadata,"webglVendor",g.vendor),V($.metadata,"sdkVersion",y),V($.metadata,"sdkIdentifier","mapbox-gl-js"),$}(u);for(const g of f.metadata);for(const g of f.counters);for(const g of f.attributes);this.postEvent(a,f,()=>{},c)}},ui=Gi.postPerformanceEvent.bind(Gi),Va=new class extends mr{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(c,a,u,f){if(!_.API_URL||!_.SESSION_PATH)return;const g=Ot(_.API_URL+_.SESSION_PATH);g.params.push(`sku=${a||""}`),g.params.push(`access_token=${f||_.ACCESS_TOKEN||""}`);const x={url:Ct(g),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(S,j){return Zl(ut(S,{method:"GET"}),j)}(x,S=>{this.pendingRequest=null,u(S),this.saveEventData(),this.processRequests(f)})}getSessionAPI(c,a,u,f){this.skuToken=a,this.errorCb=f,_.SESSION_PATH&&_.API_URL&&(u||_.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(Oe)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||this.getSession(u,this.skuToken,f=>{f?this.errorCb(f):a&&(this.success[a]=!0)},c)}},xi=Va.getSessionAPI.bind(Va),is=new Set,nu={create:"create",load:"load",fullLoad:"fullLoad"},W2={mark(c){p.performance.mark(c)},measure(c,a,u){p.performance.measure(c,a,u)}};function cb(c){const a=c.name.split("?")[0];return qe(a)&&a.includes("mapbox-gl.js")?"javascript":qe(a)&&a.includes("mapbox-gl.css")?"css":function(u){return _.API_FONTS_REGEX.test(u)}(a)?"fontRange":et(a)?"sprite":ze(a)?"style":function(u){return _.API_TILEJSON_REGEX.test(u)}(a)?"tilejson":"other"}const qr=p.performance;function Lg(c){const a=c?c.url.toString():void 0;return qr.getEntriesByName(a)}let Ld,Bg,kf,qa;const So={now:()=>kf!==void 0?kf:p.performance.now(),setNow(c){kf=c},restoreNow(){kf=void 0},frame(c){const a=p.requestAnimationFrame(c);return{cancel:()=>p.cancelAnimationFrame(a)}},getImageData(c,a=0){const{width:u,height:f}=c;qa||(qa=p.document.createElement("canvas"));const g=qa.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(u>qa.width||f>qa.height)&&(qa.width=u,qa.height=f),g.clearRect(-a,-a,u+2*a,f+2*a),g.drawImage(c,0,0,u,f),g.getImageData(-a,-a,u+2*a,f+2*a)},resolveURL:c=>(Ld||(Ld=p.document.createElement("a")),Ld.href=c,Ld.href),get devicePixelRatio(){return p.devicePixelRatio},get prefersReducedMotion(){return!!p.matchMedia&&(Bg==null&&(Bg=p.matchMedia("(prefers-reduced-motion: reduce)")),Bg.matches)}};function zg(c,a,u){u[c]&&u[c].indexOf(a)!==-1||(u[c]=u[c]||[],u[c].push(a))}function $g(c,a,u){if(u&&u[c]){const f=u[c].indexOf(a);f!==-1&&u[c].splice(f,1)}}class Yl{constructor(a,u={}){ut(this,u),this.type=a}}class Eo extends Yl{constructor(a,u={}){super("error",ut({error:a},u))}}class Bd{on(a,u){return this._listeners=this._listeners||{},zg(a,u,this._listeners),this}off(a,u){return $g(a,u,this._listeners),$g(a,u,this._oneTimeListeners),this}once(a,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},zg(a,u,this._oneTimeListeners),this):new Promise(f=>this.once(a,f))}fire(a,u){typeof a=="string"&&(a=new Yl(a,u||{}));const f=a.type;if(this.listens(f)){a.target=this;const g=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const j of g)j.call(this,a);const x=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const j of x)$g(f,j,this._oneTimeListeners),j.call(this,a);const S=this._eventedParent;S&&(ut(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(a))}else a instanceof Eo&&console.error(a.error);return this}listens(a){return!!(this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a))}setEventedParent(a,u){return this._eventedParent=a,this._eventedParentData=u,this}}var ot=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function To(c,...a){for(const u of a)for(const f in u)c[f]=u[f];return c}function Jn(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function bi(c){if(Array.isArray(c))return c.map(bi);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const a={};for(const u in c)a[u]=bi(c[u]);return a}return Jn(c)}class ub extends Error{constructor(a,u){super(u),this.message=u,this.key=a}}var Wa=ub;class Fg{constructor(a,u=[]){this.parent=a,this.bindings={};for(const[f,g]of u)this.bindings[f]=g}concat(a){return new Fg(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}var db=Fg;const iu={kind:"null"},$t={kind:"number"},Cr={kind:"string"},Er={kind:"boolean"},Rs={kind:"color"},ba={kind:"object"},Tr={kind:"value"},Ds={kind:"collator"},zd={kind:"formatted"},Jl={kind:"resolvedImage"};function Ys(c,a){return{kind:"array",itemType:c,N:a}}function Tn(c){if(c.kind==="array"){const a=Tn(c.itemType);return typeof c.N=="number"?`array<${a}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${a}>`}return c.kind}const hb=[iu,$t,Cr,Er,Rs,zd,ba,Ys(Tr),Jl];function jo(c,a){if(a.kind==="error")return null;if(c.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!jo(c.itemType,a.itemType))&&(typeof c.N!="number"||c.N===a.N))return null}else{if(c.kind===a.kind)return null;if(c.kind==="value"){for(const u of hb)if(!jo(u,a))return null}}return`Expected ${Tn(c)} but found ${Tn(a)} instead.`}function $d(c,a){return a.some(u=>u.kind===c.kind)}function Fd(c,a){return a.some(u=>u==="null"?c===null:u==="array"?Array.isArray(c):u==="object"?c&&!Array.isArray(c)&&typeof c=="object":u===typeof c)}var Ug,fb={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ud(c){return(c=Math.round(c))<0?0:c>255?255:c}function Vd(c){return Ud(c[c.length-1]==="%"?parseFloat(c)/100*255:parseInt(c))}function Mf(c){return(a=c[c.length-1]==="%"?parseFloat(c)/100:parseFloat(c))<0?0:a>1?1:a;var a}function su(c,a,u){return u<0?u+=1:u>1&&(u-=1),6*u<1?c+(a-c)*u*6:2*u<1?a:3*u<2?c+(a-c)*(2/3-u)*6:c}try{Ug={}.parseCSSColor=function(c){var a,u=c.replace(/ /g,"").toLowerCase();if(u in fb)return fb[u].slice();if(u[0]==="#")return u.length===4?(a=parseInt(u.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:u.length===7&&(a=parseInt(u.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var f=u.indexOf("("),g=u.indexOf(")");if(f!==-1&&g+1===u.length){var x=u.substr(0,f),S=u.substr(f+1,g-(f+1)).split(","),j=1;switch(x){case"rgba":if(S.length!==4)return null;j=Mf(S.pop());case"rgb":return S.length!==3?null:[Vd(S[0]),Vd(S[1]),Vd(S[2]),j];case"hsla":if(S.length!==4)return null;j=Mf(S.pop());case"hsl":if(S.length!==3)return null;var A=(parseFloat(S[0])%360+360)%360/360,M=Mf(S[1]),$=Mf(S[2]),V=$<=.5?$*(M+1):$+M-$*M,G=2*$-V;return[Ud(255*su(G,V,A+1/3)),Ud(255*su(G,V,A)),Ud(255*su(G,V,A-1/3)),j];default:return null}}return null}}catch{}class gs{constructor(a,u,f,g=1){this.r=a,this.g=u,this.b=f,this.a=g}static parse(a){if(!a)return;if(a instanceof gs)return a;if(typeof a!="string")return;const u=Ug(a);return u?new gs(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toString(){const[a,u,f,g]=this.toArray();return`rgba(${Math.round(a)},${Math.round(u)},${Math.round(f)},${g})`}toArray(){const{r:a,g:u,b:f,a:g}=this;return g===0?[0,0,0,0]:[255*a/g,255*u/g,255*f/g,g]}toArray01(){const{r:a,g:u,b:f,a:g}=this;return g===0?[0,0,0,0]:[a/g,u/g,f/g,g]}toArray01PremultipliedAlpha(){const{r:a,g:u,b:f,a:g}=this;return[a,u,f,g]}}gs.black=new gs(0,0,0,1),gs.white=new gs(1,1,1,1),gs.transparent=new gs(0,0,0,0),gs.red=new gs(1,0,0,1),gs.blue=new gs(0,0,1,1);var Gn=gs;class Vg{constructor(a,u,f){this.sensitivity=a?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,u){return this.collator.compare(a,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class qg{constructor(a,u,f,g,x){this.text=a.normalize?a.normalize():a,this.image=u,this.scale=f,this.fontStack=g,this.textColor=x}}class ys{constructor(a){this.sections=a}static fromString(a){return new ys([new qg(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof ys?a:ys.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}serialize(){const a=["format"];for(const u of this.sections){if(u.image){a.push(["image",u.image.name]);continue}a.push(u.text);const f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),a.push(f)}return a}}class Js{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Js({name:a,available:!1}):null}serialize(){return["image",this.name]}}function pb(c,a,u,f){return typeof c=="number"&&c>=0&&c<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[c,a,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[c,a,u,f]:[c,a,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function qd(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Gn||c instanceof Vg||c instanceof ys||c instanceof Js)return!0;if(Array.isArray(c)){for(const a of c)if(!qd(a))return!1;return!0}if(typeof c=="object"){for(const a in c)if(!qd(c[a]))return!1;return!0}return!1}function zn(c){if(c===null)return iu;if(typeof c=="string")return Cr;if(typeof c=="boolean")return Er;if(typeof c=="number")return $t;if(c instanceof Gn)return Rs;if(c instanceof Vg)return Ds;if(c instanceof ys)return zd;if(c instanceof Js)return Jl;if(Array.isArray(c)){const a=c.length;let u;for(const f of c){const g=zn(f);if(u){if(u===g)continue;u=Tr;break}u=g}return Ys(u||Tr,a)}return ba}function Wd(c){const a=typeof c;return c===null?"":a==="string"||a==="number"||a==="boolean"?String(c):c instanceof Gn||c instanceof ys||c instanceof Js?c.toString():JSON.stringify(c)}class Wg{constructor(a,u){this.type=a,this.value=u}static parse(a,u){if(a.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!qd(a[1]))return u.error("invalid value");const f=a[1];let g=zn(f);const x=u.expectedType;return g.kind!=="array"||g.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(g=x),new Wg(g,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Gn?["rgba"].concat(this.value.toArray()):this.value instanceof ys?this.value.serialize():this.value}}var Ql=Wg,Ri=class{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}};const Gg={string:Cr,number:$t,boolean:Er,object:ba};class Hg{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");let f,g=1;const x=a[0];if(x==="array"){let j,A;if(a.length>2){const M=a[1];if(typeof M!="string"||!(M in Gg)||M==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);j=Gg[M],g++}else j=Tr;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return u.error('The length argument to "array" must be a positive integer literal',2);A=a[2],g++}f=Ys(j,A)}else f=Gg[x];const S=[];for(;g<a.length;g++){const j=u.parse(a[g],g,Tr);if(!j)return null;S.push(j)}return new Hg(f,S)}evaluate(a){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(a);if(!jo(this.type,zn(f)))return f;if(u===this.args.length-1)throw new Ri(`Expected value to be of type ${Tn(this.type)}, but found ${Tn(zn(f))} instead.`)}return null}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=this.type,u=[a.kind];if(a.kind==="array"){const f=a.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){u.push(f.kind);const g=a.N;(typeof g=="number"||this.args.length>1)&&u.push(g)}}return u.concat(this.args.map(f=>f.serialize()))}}var Co=Hg;class vl{constructor(a){this.type=zd,this.sections=a}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const f=a[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const g=[];let x=!1;for(let S=1;S<=a.length-1;++S){const j=a[S];if(x&&typeof j=="object"&&!Array.isArray(j)){x=!1;let A=null;if(j["font-scale"]&&(A=u.parse(j["font-scale"],1,$t),!A))return null;let M=null;if(j["text-font"]&&(M=u.parse(j["text-font"],1,Ys(Cr)),!M))return null;let $=null;if(j["text-color"]&&($=u.parse(j["text-color"],1,Rs),!$))return null;const V=g[g.length-1];V.scale=A,V.font=M,V.textColor=$}else{const A=u.parse(a[S],1,Tr);if(!A)return null;const M=A.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,g.push({content:A,scale:null,font:null,textColor:null})}}return new vl(g)}evaluate(a){return new ys(this.sections.map(u=>{const f=u.content.evaluate(a);return zn(f)===Jl?new qg("",f,null,null,null):new qg(Wd(f),null,u.scale?u.scale.evaluate(a):null,u.font?u.font.evaluate(a).join(","):null,u.textColor?u.textColor.evaluate(a):null)}))}eachChild(a){for(const u of this.sections)a(u.content),u.scale&&a(u.scale),u.font&&a(u.font),u.textColor&&a(u.textColor)}outputDefined(){return!1}serialize(){const a=["format"];for(const u of this.sections){a.push(u.content.serialize());const f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),a.push(f)}return a}}class If{constructor(a){this.type=Jl,this.input=a}static parse(a,u){if(a.length!==2)return u.error("Expected two arguments.");const f=u.parse(a[1],1,Cr);return f?new If(f):u.error("No image name provided.")}evaluate(a){const u=this.input.evaluate(a),f=Js.fromString(u);return f&&a.availableImages&&(f.available=a.availableImages.indexOf(u)>-1),f}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const G2={"to-boolean":Er,"to-color":Rs,"to-number":$t,"to-string":Cr};class Xg{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const f=a[0];if((f==="to-boolean"||f==="to-string")&&a.length!==2)return u.error("Expected one argument.");const g=G2[f],x=[];for(let S=1;S<a.length;S++){const j=u.parse(a[S],S,Tr);if(!j)return null;x.push(j)}return new Xg(g,x)}evaluate(a){if(this.type.kind==="boolean")return!!this.args[0].evaluate(a);if(this.type.kind==="color"){let u,f;for(const g of this.args){if(u=g.evaluate(a),f=null,u instanceof Gn)return u;if(typeof u=="string"){const x=a.parseColor(u);if(x)return x}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:pb(u[0],u[1],u[2],u[3]),!f))return new Gn(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new Ri(f||`Could not parse color from value '${typeof u=="string"?u:String(JSON.stringify(u))}'`)}if(this.type.kind==="number"){let u=null;for(const f of this.args){if(u=f.evaluate(a),u===null)return 0;const g=Number(u);if(!isNaN(g))return g}throw new Ri(`Could not convert ${JSON.stringify(u)} to number.`)}return this.type.kind==="formatted"?ys.fromString(Wd(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?Js.fromString(Wd(this.args[0].evaluate(a))):Wd(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){if(this.type.kind==="formatted")return new vl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new If(this.args[0]).serialize();const a=[`to-${this.type.kind}`];return this.eachChild(u=>{a.push(u.serialize())}),a}}var au=Xg;const Ga=["Unknown","Point","LineString","Polygon"];var Kg=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ga[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const c=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:u,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*a-c[0])+this.featureDistanceData.bearing[1]*(f*a-c[1])}return 0}parseColor(c){let a=this._parseColorCache[c];return a||(a=this._parseColorCache[c]=Gn.parse(c)),a}};class ec{constructor(a,u,f,g){this.name=a,this.type=u,this._evaluate=f,this.args=g}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(a=>a.serialize()))}static parse(a,u){const f=a[0],g=ec.definitions[f];if(!g)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(g)?g[0]:g.type,S=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,j=S.filter(([M])=>!Array.isArray(M)||M.length===a.length-1);let A=null;for(const[M,$]of j){A=new ty(u.registry,u.path,null,u.scope);const V=[];let G=!1;for(let Y=1;Y<a.length;Y++){const J=a[Y],ne=Array.isArray(M)?M[Y-1]:M.type,ce=A.parse(J,1+V.length,ne);if(!ce){G=!0;break}V.push(ce)}if(!G)if(Array.isArray(M)&&M.length!==V.length)A.error(`Expected ${M.length} arguments, but found ${V.length} instead.`);else{for(let Y=0;Y<V.length;Y++){const J=Array.isArray(M)?M[Y]:M.type,ne=V[Y];A.concat(Y+1).checkSubtype(J,ne.type)}if(A.errors.length===0)return new ec(f,x,$,V)}}if(j.length===1)u.errors.push(...A.errors);else{const M=(j.length?j:S).map(([V])=>{return G=V,Array.isArray(G)?`(${G.map(Tn).join(", ")})`:`(${Tn(G.type)}...)`;var G}).join(" | "),$=[];for(let V=1;V<a.length;V++){const G=u.parse(a[V],1+$.length);if(!G)return null;$.push(Tn(G.type))}u.error(`Expected arguments of type ${M}, but found (${$.join(", ")}) instead.`)}return null}static register(a,u){ec.definitions=u;for(const f in u)a[f]=ec}}var Po=ec;class Gd{constructor(a,u,f){this.type=Ds,this.locale=f,this.caseSensitive=a,this.diacriticSensitive=u}static parse(a,u){if(a.length!==2)return u.error("Expected one argument.");const f=a[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const g=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,Er);if(!g)return null;const x=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,Er);if(!x)return null;let S=null;return f.locale&&(S=u.parse(f.locale,1,Cr),!S)?null:new Gd(g,x,S)}evaluate(a){return new Vg(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}serialize(){const a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]}}const Ao=8192;function Of(c,a){c[0]=Math.min(c[0],a[0]),c[1]=Math.min(c[1],a[1]),c[2]=Math.max(c[2],a[0]),c[3]=Math.max(c[3],a[1])}function ou(c,a){return!(c[0]<=a[0]||c[2]>=a[2]||c[1]<=a[1]||c[3]>=a[3])}function Hd(c,a){const u=(180+c[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,a.z);return[Math.round(u*g*Ao),Math.round(f*g*Ao)]}function mb(c,a,u){const f=c[0]-a[0],g=c[1]-a[1],x=c[0]-u[0],S=c[1]-u[1];return f*S-x*g==0&&f*x<=0&&g*S<=0}function Rf(c,a){let u=!1;for(let S=0,j=a.length;S<j;S++){const A=a[S];for(let M=0,$=A.length;M<$-1;M++){if(mb(c,A[M],A[M+1]))return!1;(g=A[M])[1]>(f=c)[1]!=(x=A[M+1])[1]>f[1]&&f[0]<(x[0]-g[0])*(f[1]-g[1])/(x[1]-g[1])+g[0]&&(u=!u)}}var f,g,x;return u}function Zg(c,a){for(let u=0;u<a.length;u++)if(Rf(c,a[u]))return!0;return!1}function Yg(c,a,u,f){const g=f[0]-u[0],x=f[1]-u[1],S=(c[0]-u[0])*x-g*(c[1]-u[1]),j=(a[0]-u[0])*x-g*(a[1]-u[1]);return S>0&&j<0||S<0&&j>0}function lu(c,a,u){for(const M of u)for(let $=0;$<M.length-1;++$)if((j=[(S=M[$+1])[0]-(x=M[$])[0],S[1]-x[1]])[0]*(A=[(g=a)[0]-(f=c)[0],g[1]-f[1]])[1]-j[1]*A[0]!=0&&Yg(f,g,x,S)&&Yg(x,S,f,g))return!0;var f,g,x,S,j,A;return!1}function Wr(c,a){for(let u=0;u<c.length;++u)if(!Rf(c[u],a))return!1;for(let u=0;u<c.length-1;++u)if(lu(c[u],c[u+1],a))return!1;return!0}function H2(c,a){for(let u=0;u<a.length;u++)if(Wr(c,a[u]))return!0;return!1}function Jg(c,a,u){const f=[];for(let g=0;g<c.length;g++){const x=[];for(let S=0;S<c[g].length;S++){const j=Hd(c[g][S],u);Of(a,j),x.push(j)}f.push(x)}return f}function gb(c,a,u){const f=[];for(let g=0;g<c.length;g++){const x=Jg(c[g],a,u);f.push(x)}return f}function Qg(c,a,u,f){if(c[0]<u[0]||c[0]>u[2]){const g=.5*f;let x=c[0]-u[0]>g?-f:u[0]-c[0]>g?f:0;x===0&&(x=c[0]-u[2]>g?-f:u[2]-c[0]>g?f:0),c[0]+=x}Of(a,c)}function yb(c,a,u,f){const g=Math.pow(2,f.z)*Ao,x=[f.x*Ao,f.y*Ao],S=[];if(!c)return S;for(const j of c)for(const A of j){const M=[A.x+x[0],A.y+x[1]];Qg(M,a,u,g),S.push(M)}return S}function ey(c,a,u,f){const g=Math.pow(2,f.z)*Ao,x=[f.x*Ao,f.y*Ao],S=[];if(!c)return S;for(const A of c){const M=[];for(const $ of A){const V=[$.x+x[0],$.y+x[1]];Of(a,V),M.push(V)}S.push(M)}if(a[2]-a[0]<=g/2){(j=a)[0]=j[1]=1/0,j[2]=j[3]=-1/0;for(const A of S)for(const M of A)Qg(M,a,u,g)}var j;return S}class cu{constructor(a,u){this.type=Er,this.geojson=a,this.geometries=u}static parse(a,u){if(a.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(qd(a[1])){const f=a[1];if(f.type==="FeatureCollection")for(let g=0;g<f.features.length;++g){const x=f.features[g].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new cu(f,f.features[g].geometry)}else if(f.type==="Feature"){const g=f.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new cu(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new cu(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],S=u.canonicalID();if(!S)return!1;if(f.type==="Polygon"){const j=Jg(f.coordinates,x,S),A=yb(u.geometry(),g,x,S);if(!ou(g,x))return!1;for(const M of A)if(!Rf(M,j))return!1}if(f.type==="MultiPolygon"){const j=gb(f.coordinates,x,S),A=yb(u.geometry(),g,x,S);if(!ou(g,x))return!1;for(const M of A)if(!Zg(M,j))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],S=u.canonicalID();if(!S)return!1;if(f.type==="Polygon"){const j=Jg(f.coordinates,x,S),A=ey(u.geometry(),g,x,S);if(!ou(g,x))return!1;for(const M of A)if(!Wr(M,j))return!1}if(f.type==="MultiPolygon"){const j=gb(f.coordinates,x,S),A=ey(u.geometry(),g,x,S);if(!ou(g,x))return!1;for(const M of A)if(!H2(M,j))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Df=cu;function uu(c){if(c instanceof Po&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Df)return!1;let a=!0;return c.eachChild(u=>{a&&!uu(u)&&(a=!1)}),a}function No(c){if(c instanceof Po&&c.name==="feature-state")return!1;let a=!0;return c.eachChild(u=>{a&&!No(u)&&(a=!1)}),a}function tc(c,a){if(c instanceof Po&&a.indexOf(c.name)>=0)return!1;let u=!0;return c.eachChild(f=>{u&&!tc(f,a)&&(u=!1)}),u}class Lf{constructor(a,u){this.type=u.type,this.name=a,this.boundExpression=u}static parse(a,u){if(a.length!==2||typeof a[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=a[1];return u.scope.has(f)?new Lf(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var vb=Lf;class Xd{constructor(a,u=[],f,g=new db,x=[]){this.registry=a,this.path=u,this.key=u.map(S=>`[${S}]`).join(""),this.scope=g,this.errors=x,this.expectedType=f}parse(a,u,f,g,x={}){return u?this.concat(u,f,g)._parse(a,x):this._parse(a,x)}_parse(a,u){function f(g,x,S){return S==="assert"?new Co(x,[g]):S==="coerce"?new au(x,[g]):g}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=a[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[g];if(x){let S=x.parse(a,this);if(!S)return null;if(this.expectedType){const j=this.expectedType,A=S.type;if(j.kind!=="string"&&j.kind!=="number"&&j.kind!=="boolean"&&j.kind!=="object"&&j.kind!=="array"||A.kind!=="value")if(j.kind!=="color"&&j.kind!=="formatted"&&j.kind!=="resolvedImage"||A.kind!=="value"&&A.kind!=="string"){if(this.checkSubtype(j,A))return null}else S=f(S,j,u.typeAnnotation||"coerce");else S=f(S,j,u.typeAnnotation||"assert")}if(!(S instanceof Ql)&&S.type.kind!=="resolvedImage"&&ry(S)){const j=new Kg;try{S=new Ql(S.type,S.evaluate(j))}catch(A){return this.error(A.message),null}}return S}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,u,f){const g=typeof a=="number"?this.path.concat(a):this.path,x=f?this.scope.concat(f):this.scope;return new Xd(this.registry,g,u||null,x,this.errors)}error(a,...u){const f=`${this.key}${u.map(g=>`[${g}]`).join("")}`;this.errors.push(new Wa(f,a))}checkSubtype(a,u){const f=jo(a,u);return f&&this.error(f),f}}var ty=Xd;function ry(c){if(c instanceof vb)return ry(c.boundExpression);if(c instanceof Po&&c.name==="error"||c instanceof Gd||c instanceof Df)return!1;const a=c instanceof au||c instanceof Co;let u=!0;return c.eachChild(f=>{u=a?u&&ry(f):u&&f instanceof Ql}),!!u&&uu(c)&&tc(c,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Bf(c,a){const u=c.length-1;let f,g,x=0,S=u,j=0;for(;x<=S;)if(j=Math.floor((x+S)/2),f=c[j],g=c[j+1],f<=a){if(j===u||a<g)return j;x=j+1}else{if(!(f>a))throw new Ri("Input is not a number.");S=j-1}return 0}class zf{constructor(a,u,f){this.type=a,this.input=u,this.labels=[],this.outputs=[];for(const[g,x]of f)this.labels.push(g),this.outputs.push(x)}static parse(a,u){if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(a[1],1,$t);if(!f)return null;const g=[];let x=null;u.expectedType&&u.expectedType.kind!=="value"&&(x=u.expectedType);for(let S=1;S<a.length;S+=2){const j=S===1?-1/0:a[S],A=a[S+1],M=S,$=S+1;if(typeof j!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(g.length&&g[g.length-1][0]>=j)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const V=u.parse(A,$,x);if(!V)return null;x=x||V.type,g.push([j,V])}return new zf(x,f,g)}evaluate(a){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(a);const g=this.input.evaluate(a);if(g<=u[0])return f[0].evaluate(a);const x=u.length;return g>=u[x-1]?f[x-1].evaluate(a):f[Bf(u,g)].evaluate(a)}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){const a=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&a.push(this.labels[u]),a.push(this.outputs[u].serialize());return a}}var ny=zf;function Or(c,a,u){return c*(1-u)+a*u}var Kd=Object.freeze({__proto__:null,array:function(c,a,u){return c.map((f,g)=>Or(f,a[g],u))},color:function(c,a,u){return new Gn(Or(c.r,a.r,u),Or(c.g,a.g,u),Or(c.b,a.b,u),Or(c.a,a.a,u))},number:Or});const xb=.95047,iy=1.08883,bb=4/29,rc=6/29,sy=3*rc*rc,X2=rc*rc*rc,K2=Math.PI/180,Z2=180/Math.PI;function ay(c){return c>X2?Math.pow(c,1/3):c/sy+bb}function oy(c){return c>rc?c*c*c:sy*(c-bb)}function ly(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function $f(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function _b(c){const a=$f(c.r),u=$f(c.g),f=$f(c.b),g=ay((.4124564*a+.3575761*u+.1804375*f)/xb),x=ay((.2126729*a+.7151522*u+.072175*f)/1);return{l:116*x-16,a:500*(g-x),b:200*(x-ay((.0193339*a+.119192*u+.9503041*f)/iy)),alpha:c.a}}function wb(c){let a=(c.l+16)/116,u=isNaN(c.a)?a:a+c.a/500,f=isNaN(c.b)?a:a-c.b/200;return a=1*oy(a),u=xb*oy(u),f=iy*oy(f),new Gn(ly(3.2404542*u-1.5371385*a-.4985314*f),ly(-.969266*u+1.8760108*a+.041556*f),ly(.0556434*u-.2040259*a+1.0572252*f),c.alpha)}function Y2(c,a,u){const f=a-c;return c+u*(f>180||f<-180?f-360*Math.round(f/360):f)}const Zd={forward:_b,reverse:wb,interpolate:function(c,a,u){return{l:Or(c.l,a.l,u),a:Or(c.a,a.a,u),b:Or(c.b,a.b,u),alpha:Or(c.alpha,a.alpha,u)}}},du={forward:function(c){const{l:a,a:u,b:f}=_b(c),g=Math.atan2(f,u)*Z2;return{h:g<0?g+360:g,c:Math.sqrt(u*u+f*f),l:a,alpha:c.a}},reverse:function(c){const a=c.h*K2,u=c.c;return wb({l:c.l,a:Math.cos(a)*u,b:Math.sin(a)*u,alpha:c.alpha})},interpolate:function(c,a,u){return{h:Y2(c.h,a.h,u),c:Or(c.c,a.c,u),l:Or(c.l,a.l,u),alpha:Or(c.alpha,a.alpha,u)}}};var cy=Object.freeze({__proto__:null,hcl:du,lab:Zd});class Yd{constructor(a,u,f,g,x){this.type=a,this.operator=u,this.interpolation=f,this.input=g,this.labels=[],this.outputs=[];for(const[S,j]of x)this.labels.push(S),this.outputs.push(j)}static interpolationFactor(a,u,f,g){let x=0;if(a.name==="exponential")x=uy(u,a.base,f,g);else if(a.name==="linear")x=uy(u,1,f,g);else if(a.name==="cubic-bezier"){const S=a.controlPoints;x=new H(S[0],S[1],S[2],S[3]).solve(uy(u,1,f,g))}return x}static parse(a,u){let[f,g,x,...S]=a;if(!Array.isArray(g)||g.length===0)return u.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const M=g[1];if(typeof M!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:M}}else{if(g[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const M=g.slice(1);if(M.length!==4||M.some($=>typeof $!="number"||$<0||$>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:M}}}if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(x=u.parse(x,2,$t),!x)return null;const j=[];let A=null;f==="interpolate-hcl"||f==="interpolate-lab"?A=Rs:u.expectedType&&u.expectedType.kind!=="value"&&(A=u.expectedType);for(let M=0;M<S.length;M+=2){const $=S[M],V=S[M+1],G=M+3,Y=M+4;if(typeof $!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(j.length&&j[j.length-1][0]>=$)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const J=u.parse(V,Y,A);if(!J)return null;A=A||J.type,j.push([$,J])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new Yd(A,f,g,x,j):u.error(`Type ${Tn(A)} is not interpolatable.`)}evaluate(a){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(a);const g=this.input.evaluate(a);if(g<=u[0])return f[0].evaluate(a);const x=u.length;if(g>=u[x-1])return f[x-1].evaluate(a);const S=Bf(u,g),j=Yd.interpolationFactor(this.interpolation,g,u[S],u[S+1]),A=f[S].evaluate(a),M=f[S+1].evaluate(a);return this.operator==="interpolate"?Kd[this.type.kind.toLowerCase()](A,M,j):this.operator==="interpolate-hcl"?du.reverse(du.interpolate(du.forward(A),du.forward(M),j)):Zd.reverse(Zd.interpolate(Zd.forward(A),Zd.forward(M),j))}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a;a=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const u=[this.operator,a,this.input.serialize()];for(let f=0;f<this.labels.length;f++)u.push(this.labels[f],this.outputs[f].serialize());return u}}function uy(c,a,u,f){const g=f-u,x=c-u;return g===0?0:a===1?x/g:(Math.pow(a,x)-1)/(Math.pow(a,g)-1)}var Ha=Yd;class Ff{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expectected at least one argument.");let f=null;const g=u.expectedType;g&&g.kind!=="value"&&(f=g);const x=[];for(const j of a.slice(1)){const A=u.parse(j,1+x.length,f,void 0,{typeAnnotation:"omit"});if(!A)return null;f=f||A.type,x.push(A)}const S=g&&x.some(j=>jo(g,j.type));return new Ff(S?Tr:f,x)}evaluate(a){let u,f=null,g=0;for(const x of this.args){if(g++,f=x.evaluate(a),f&&f instanceof Js&&!f.available&&(u||(u=f),f=null,g===this.args.length))return u;if(f!==null)break}return f}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=["coalesce"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var dy=Ff;class Uf{constructor(a,u){this.type=u.type,this.bindings=[].concat(a),this.result=u}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const u of this.bindings)a(u[1]);a(this.result)}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const f=[];for(let x=1;x<a.length-1;x+=2){const S=a[x];if(typeof S!="string")return u.error(`Expected string, but found ${typeof S} instead.`,x);if(/[^a-zA-Z0-9_]/.test(S))return u.error("Variable names must contain only alphanumeric characters or '_'.",x);const j=u.parse(a[x+1],x+1);if(!j)return null;f.push([S,j])}const g=u.parse(a[a.length-1],a.length-1,u.expectedType,f);return g?new Uf(f,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const a=["let"];for(const[u,f]of this.bindings)a.push(u,f.serialize());return a.push(this.result.serialize()),a}}var Sb=Uf;class hy{constructor(a,u,f){this.type=a,this.index=u,this.input=f}static parse(a,u){if(a.length!==3)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,$t),g=u.parse(a[2],2,Ys(u.expectedType||Tr));return f&&g?new hy(g.type.itemType,f,g):null}evaluate(a){const u=this.index.evaluate(a),f=this.input.evaluate(a);if(u<0)throw new Ri(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new Ri(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new Ri(`Array index must be an integer, but found ${u} instead.`);return f[u]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var J2=hy;class fy{constructor(a,u){this.type=Er,this.needle=a,this.haystack=u}static parse(a,u){if(a.length!==3)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,Tr),g=u.parse(a[2],2,Tr);return f&&g?$d(f.type,[Er,Cr,$t,iu,Tr])?new fy(f,g):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(f.type)} instead`):null}evaluate(a){const u=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(f==null)return!1;if(!Fd(u,["boolean","string","number","null"]))throw new Ri(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(zn(u))} instead.`);if(!Fd(f,["string","array"]))throw new Ri(`Expected second argument to be of type array or string, but found ${Tn(zn(f))} instead.`);return f.indexOf(u)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Vf=fy;class Jd{constructor(a,u,f){this.type=$t,this.needle=a,this.haystack=u,this.fromIndex=f}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,Tr),g=u.parse(a[2],2,Tr);if(!f||!g)return null;if(!$d(f.type,[Er,Cr,$t,iu,Tr]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(f.type)} instead`);if(a.length===4){const x=u.parse(a[3],3,$t);return x?new Jd(f,g,x):null}return new Jd(f,g)}evaluate(a){const u=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!Fd(u,["boolean","string","number","null"]))throw new Ri(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(zn(u))} instead.`);if(!Fd(f,["string","array"]))throw new Ri(`Expected second argument to be of type array or string, but found ${Tn(zn(f))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(a);return f.indexOf(u,g)}return f.indexOf(u)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Eb=Jd;class py{constructor(a,u,f,g,x,S){this.inputType=a,this.type=u,this.input=f,this.cases=g,this.outputs=x,this.otherwise=S}static parse(a,u){if(a.length<5)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return u.error("Expected an even number of arguments.");let f,g;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);const x={},S=[];for(let M=2;M<a.length-1;M+=2){let $=a[M];const V=a[M+1];Array.isArray($)||($=[$]);const G=u.concat(M);if($.length===0)return G.error("Expected at least one branch label.");for(const J of $){if(typeof J!="number"&&typeof J!="string")return G.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return G.error("Numeric branch labels must be integer values.");if(f){if(G.checkSubtype(f,zn(J)))return null}else f=zn(J);if(x[String(J)]!==void 0)return G.error("Branch labels must be unique.");x[String(J)]=S.length}const Y=u.parse(V,M,g);if(!Y)return null;g=g||Y.type,S.push(Y)}const j=u.parse(a[1],1,Tr);if(!j)return null;const A=u.parse(a[a.length-1],a.length-1,g);return A?j.type.kind!=="value"&&u.concat(1).checkSubtype(f,j.type)?null:new py(f,g,j,x,S,A):null}evaluate(a){const u=this.input.evaluate(a);return(zn(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),f=[],g={};for(const S of u){const j=g[this.cases[S]];j===void 0?(g[this.cases[S]]=f.length,f.push([this.cases[S],[S]])):f[j][1].push(S)}const x=S=>this.inputType.kind==="number"?Number(S):S;for(const[S,j]of f)a.push(j.length===1?x(j[0]):j.map(x)),a.push(this.outputs[S].serialize());return a.push(this.otherwise.serialize()),a}}var Q2=py;class my{constructor(a,u,f){this.type=a,this.branches=u,this.otherwise=f}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const g=[];for(let S=1;S<a.length-1;S+=2){const j=u.parse(a[S],S,Er);if(!j)return null;const A=u.parse(a[S+1],S+1,f);if(!A)return null;g.push([j,A]),f=f||A.type}const x=u.parse(a[a.length-1],a.length-1,f);return x?new my(f,g,x):null}evaluate(a){for(const[u,f]of this.branches)if(u.evaluate(a))return f.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[u,f]of this.branches)a(u),a(f);a(this.otherwise)}outputDefined(){return this.branches.every(([a,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["case"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var Tb=my;class Qd{constructor(a,u,f,g){this.type=a,this.input=u,this.beginIndex=f,this.endIndex=g}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,Tr),g=u.parse(a[2],2,$t);if(!f||!g)return null;if(!$d(f.type,[Ys(Tr),Cr,Tr]))return u.error(`Expected first argument to be of type array or string, but found ${Tn(f.type)} instead`);if(a.length===4){const x=u.parse(a[3],3,$t);return x?new Qd(f.type,f,g,x):null}return new Qd(f.type,f,g)}evaluate(a){const u=this.input.evaluate(a),f=this.beginIndex.evaluate(a);if(!Fd(u,["string","array"]))throw new Ri(`Expected first argument to be of type array or string, but found ${Tn(zn(u))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(a);return u.slice(f,g)}return u.slice(f)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var jb=Qd;function qf(c,a){return c==="=="||c==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function Cb(c,a,u,f){return f.compare(a,u)===0}function hu(c,a,u){const f=c!=="=="&&c!=="!=";return class HZ{constructor(x,S,j){this.type=Er,this.lhs=x,this.rhs=S,this.collator=j,this.hasUntypedArgument=x.type.kind==="value"||S.type.kind==="value"}static parse(x,S){if(x.length!==3&&x.length!==4)return S.error("Expected two or three arguments.");const j=x[0];let A=S.parse(x[1],1,Tr);if(!A)return null;if(!qf(j,A.type))return S.concat(1).error(`"${j}" comparisons are not supported for type '${Tn(A.type)}'.`);let M=S.parse(x[2],2,Tr);if(!M)return null;if(!qf(j,M.type))return S.concat(2).error(`"${j}" comparisons are not supported for type '${Tn(M.type)}'.`);if(A.type.kind!==M.type.kind&&A.type.kind!=="value"&&M.type.kind!=="value")return S.error(`Cannot compare types '${Tn(A.type)}' and '${Tn(M.type)}'.`);f&&(A.type.kind==="value"&&M.type.kind!=="value"?A=new Co(M.type,[A]):A.type.kind!=="value"&&M.type.kind==="value"&&(M=new Co(A.type,[M])));let $=null;if(x.length===4){if(A.type.kind!=="string"&&M.type.kind!=="string"&&A.type.kind!=="value"&&M.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if($=S.parse(x[3],3,Ds),!$)return null}return new HZ(A,M,$)}evaluate(x){const S=this.lhs.evaluate(x),j=this.rhs.evaluate(x);if(f&&this.hasUntypedArgument){const A=zn(S),M=zn(j);if(A.kind!==M.kind||A.kind!=="string"&&A.kind!=="number")throw new Ri(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${A.kind}, ${M.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const A=zn(S),M=zn(j);if(A.kind!=="string"||M.kind!=="string")return a(x,S,j)}return this.collator?u(x,S,j,this.collator.evaluate(x)):a(x,S,j)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}serialize(){const x=[c];return this.eachChild(S=>{x.push(S.serialize())}),x}}}const eT=hu("==",function(c,a,u){return a===u},Cb),tT=hu("!=",function(c,a,u){return a!==u},function(c,a,u,f){return!Cb(0,a,u,f)}),rT=hu("<",function(c,a,u){return a<u},function(c,a,u,f){return f.compare(a,u)<0}),nT=hu(">",function(c,a,u){return a>u},function(c,a,u,f){return f.compare(a,u)>0}),iT=hu("<=",function(c,a,u){return a<=u},function(c,a,u,f){return f.compare(a,u)<=0}),Pb=hu(">=",function(c,a,u){return a>=u},function(c,a,u,f){return f.compare(a,u)>=0});class Wf{constructor(a,u,f,g,x,S){this.type=Cr,this.number=a,this.locale=u,this.currency=f,this.unit=g,this.minFractionDigits=x,this.maxFractionDigits=S}static parse(a,u){if(a.length!==3)return u.error("Expected two arguments.");const f=u.parse(a[1],1,$t);if(!f)return null;const g=a[2];if(typeof g!="object"||Array.isArray(g))return u.error("NumberFormat options argument must be an object.");let x=null;if(g.locale&&(x=u.parse(g.locale,1,Cr),!x))return null;let S=null;if(g.currency&&(S=u.parse(g.currency,1,Cr),!S))return null;let j=null;if(g.unit&&(j=u.parse(g.unit,1,Cr),!j))return null;let A=null;if(g["min-fraction-digits"]&&(A=u.parse(g["min-fraction-digits"],1,$t),!A))return null;let M=null;return g["max-fraction-digits"]&&(M=u.parse(g["max-fraction-digits"],1,$t),!M)?null:new Wf(f,x,S,j,A,M)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(a):void 0,unit:this.unit?this.unit.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.unit&&a(this.unit),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.unit&&(a.unit=this.unit.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]}}class fu{constructor(a){this.type=$t,this.input=a}static parse(a,u){if(a.length!==2)return u.error(`Expected 1 argument, but found ${a.length-1} instead.`);const f=u.parse(a[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${Tn(f.type)} instead.`):new fu(f):null}evaluate(a){const u=this.input.evaluate(a);if(typeof u=="string"||Array.isArray(u))return u.length;throw new Ri(`Expected value to be of type string or array, but found ${Tn(zn(u))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){const a=["length"];return this.eachChild(u=>{a.push(u.serialize())}),a}}const Ab={"==":eT,"!=":tT,">":nT,"<":rT,">=":Pb,"<=":iT,array:Co,at:J2,boolean:Co,case:Tb,coalesce:dy,collator:Gd,format:vl,image:If,in:Vf,"index-of":Eb,interpolate:Ha,"interpolate-hcl":Ha,"interpolate-lab":Ha,length:fu,let:Sb,literal:Ql,match:Q2,number:Co,"number-format":Wf,object:Co,slice:jb,step:ny,string:Co,"to-boolean":au,"to-color":au,"to-number":au,"to-string":au,var:vb,within:Df};function Nb(c,[a,u,f,g]){a=a.evaluate(c),u=u.evaluate(c),f=f.evaluate(c);const x=g?g.evaluate(c):1,S=pb(a,u,f,x);if(S)throw new Ri(S);return new Gn(a/255*x,u/255*x,f/255*x,x)}function ko(c,a){return c in a}function Gf(c,a){const u=a[c];return u===void 0?null:u}function Qs(c){return{type:c}}Po.register(Ab,{error:[{kind:"error"},[Cr],(c,[a])=>{throw new Ri(a.evaluate(c))}],typeof:[Cr,[Tr],(c,[a])=>Tn(zn(a.evaluate(c)))],"to-rgba":[Ys($t,4),[Rs],(c,[a])=>a.evaluate(c).toArray()],rgb:[Rs,[$t,$t,$t],Nb],rgba:[Rs,[$t,$t,$t,$t],Nb],has:{type:Er,overloads:[[[Cr],(c,[a])=>ko(a.evaluate(c),c.properties())],[[Cr,ba],(c,[a,u])=>ko(a.evaluate(c),u.evaluate(c))]]},get:{type:Tr,overloads:[[[Cr],(c,[a])=>Gf(a.evaluate(c),c.properties())],[[Cr,ba],(c,[a,u])=>Gf(a.evaluate(c),u.evaluate(c))]]},"feature-state":[Tr,[Cr],(c,[a])=>Gf(a.evaluate(c),c.featureState||{})],properties:[ba,[],c=>c.properties()],"geometry-type":[Cr,[],c=>c.geometryType()],id:[Tr,[],c=>c.id()],zoom:[$t,[],c=>c.globals.zoom],pitch:[$t,[],c=>c.globals.pitch||0],"distance-from-center":[$t,[],c=>c.distanceFromCenter()],"heatmap-density":[$t,[],c=>c.globals.heatmapDensity||0],"line-progress":[$t,[],c=>c.globals.lineProgress||0],"sky-radial-progress":[$t,[],c=>c.globals.skyRadialProgress||0],accumulated:[Tr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[$t,Qs($t),(c,a)=>{let u=0;for(const f of a)u+=f.evaluate(c);return u}],"*":[$t,Qs($t),(c,a)=>{let u=1;for(const f of a)u*=f.evaluate(c);return u}],"-":{type:$t,overloads:[[[$t,$t],(c,[a,u])=>a.evaluate(c)-u.evaluate(c)],[[$t],(c,[a])=>-a.evaluate(c)]]},"/":[$t,[$t,$t],(c,[a,u])=>a.evaluate(c)/u.evaluate(c)],"%":[$t,[$t,$t],(c,[a,u])=>a.evaluate(c)%u.evaluate(c)],ln2:[$t,[],()=>Math.LN2],pi:[$t,[],()=>Math.PI],e:[$t,[],()=>Math.E],"^":[$t,[$t,$t],(c,[a,u])=>Math.pow(a.evaluate(c),u.evaluate(c))],sqrt:[$t,[$t],(c,[a])=>Math.sqrt(a.evaluate(c))],log10:[$t,[$t],(c,[a])=>Math.log(a.evaluate(c))/Math.LN10],ln:[$t,[$t],(c,[a])=>Math.log(a.evaluate(c))],log2:[$t,[$t],(c,[a])=>Math.log(a.evaluate(c))/Math.LN2],sin:[$t,[$t],(c,[a])=>Math.sin(a.evaluate(c))],cos:[$t,[$t],(c,[a])=>Math.cos(a.evaluate(c))],tan:[$t,[$t],(c,[a])=>Math.tan(a.evaluate(c))],asin:[$t,[$t],(c,[a])=>Math.asin(a.evaluate(c))],acos:[$t,[$t],(c,[a])=>Math.acos(a.evaluate(c))],atan:[$t,[$t],(c,[a])=>Math.atan(a.evaluate(c))],min:[$t,Qs($t),(c,a)=>Math.min(...a.map(u=>u.evaluate(c)))],max:[$t,Qs($t),(c,a)=>Math.max(...a.map(u=>u.evaluate(c)))],abs:[$t,[$t],(c,[a])=>Math.abs(a.evaluate(c))],round:[$t,[$t],(c,[a])=>{const u=a.evaluate(c);return u<0?-Math.round(-u):Math.round(u)}],floor:[$t,[$t],(c,[a])=>Math.floor(a.evaluate(c))],ceil:[$t,[$t],(c,[a])=>Math.ceil(a.evaluate(c))],"filter-==":[Er,[Cr,Tr],(c,[a,u])=>c.properties()[a.value]===u.value],"filter-id-==":[Er,[Tr],(c,[a])=>c.id()===a.value],"filter-type-==":[Er,[Cr],(c,[a])=>c.geometryType()===a.value],"filter-<":[Er,[Cr,Tr],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[Er,[Tr],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u<f}],"filter->":[Er,[Cr,Tr],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[Er,[Tr],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u>f}],"filter-<=":[Er,[Cr,Tr],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[Er,[Tr],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u<=f}],"filter->=":[Er,[Cr,Tr],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[Er,[Tr],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u>=f}],"filter-has":[Er,[Tr],(c,[a])=>a.value in c.properties()],"filter-has-id":[Er,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Er,[Ys(Cr)],(c,[a])=>a.value.indexOf(c.geometryType())>=0],"filter-id-in":[Er,[Ys(Tr)],(c,[a])=>a.value.indexOf(c.id())>=0],"filter-in-small":[Er,[Cr,Ys(Tr)],(c,[a,u])=>u.value.indexOf(c.properties()[a.value])>=0],"filter-in-large":[Er,[Cr,Ys(Tr)],(c,[a,u])=>function(f,g,x,S){for(;x<=S;){const j=x+S>>1;if(g[j]===f)return!0;g[j]>f?S=j-1:x=j+1}return!1}(c.properties()[a.value],u.value,0,u.value.length-1)],all:{type:Er,overloads:[[[Er,Er],(c,[a,u])=>a.evaluate(c)&&u.evaluate(c)],[Qs(Er),(c,a)=>{for(const u of a)if(!u.evaluate(c))return!1;return!0}]]},any:{type:Er,overloads:[[[Er,Er],(c,[a,u])=>a.evaluate(c)||u.evaluate(c)],[Qs(Er),(c,a)=>{for(const u of a)if(u.evaluate(c))return!0;return!1}]]},"!":[Er,[Er],(c,[a])=>!a.evaluate(c)],"is-supported-script":[Er,[Cr],(c,[a])=>{const u=c.globals&&c.globals.isSupportedScript;return!u||u(a.evaluate(c))}],upcase:[Cr,[Cr],(c,[a])=>a.evaluate(c).toUpperCase()],downcase:[Cr,[Cr],(c,[a])=>a.evaluate(c).toLowerCase()],concat:[Cr,Qs(Tr),(c,a)=>a.map(u=>Wd(u.evaluate(c))).join("")],"resolved-locale":[Cr,[Ds],(c,[a])=>a.evaluate(c).resolvedLocale()]});var eh=Ab;function kb(c){return{result:"success",value:c}}function nc(c){return{result:"error",value:c}}function pu(c){return c["property-type"]==="data-driven"}function Hf(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Xf(c){return!!c.expression&&c.expression.interpolated}function Br(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function th(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Mb(c){return c}function Kf(c,a){const u=a.type==="color",f=c.stops&&typeof c.stops[0][0]=="object",g=f||!(f||c.property!==void 0),x=c.type||(Xf(a)?"exponential":"interval");if(u&&((c=To({},c)).stops&&(c.stops=c.stops.map(M=>[M[0],Gn.parse(M[1])])),c.default=Gn.parse(c.default?c.default:a.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!cy[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let S,j,A;if(x==="exponential")S=Mo;else if(x==="interval")S=Zf;else if(x==="categorical"){S=Ib,j=Object.create(null);for(const M of c.stops)j[M[0]]=M[1];A=typeof c.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);S=Ob}if(f){const M={},$=[];for(let Y=0;Y<c.stops.length;Y++){const J=c.stops[Y],ne=J[0].zoom;M[ne]===void 0&&(M[ne]={zoom:ne,type:c.type,property:c.property,default:c.default,stops:[]},$.push(ne)),M[ne].stops.push([J[0].value,J[1]])}const V=[];for(const Y of $)V.push([M[Y].zoom,Kf(M[Y],a)]);const G={name:"linear"};return{kind:"composite",interpolationType:G,interpolationFactor:Ha.interpolationFactor.bind(void 0,G),zoomStops:V.map(Y=>Y[0]),evaluate:({zoom:Y},J)=>Mo({stops:V,base:c.base},a,Y).evaluate(Y,J)}}if(g){const M=x==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Ha.interpolationFactor.bind(void 0,M),zoomStops:c.stops.map($=>$[0]),evaluate:({zoom:$})=>S(c,a,$,j,A)}}return{kind:"source",evaluate(M,$){const V=$&&$.properties?$.properties[c.property]:void 0;return V===void 0?mu(c.default,a.default):S(c,a,V,j,A)}}}function mu(c,a,u){return c!==void 0?c:a!==void 0?a:u!==void 0?u:void 0}function Ib(c,a,u,f,g){return mu(typeof u===g?f[u]:void 0,c.default,a.default)}function Zf(c,a,u){if(Br(u)!=="number")return mu(c.default,a.default);const f=c.stops.length;if(f===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[f-1][0])return c.stops[f-1][1];const g=Bf(c.stops.map(x=>x[0]),u);return c.stops[g][1]}function Mo(c,a,u){const f=c.base!==void 0?c.base:1;if(Br(u)!=="number")return mu(c.default,a.default);const g=c.stops.length;if(g===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[g-1][0])return c.stops[g-1][1];const x=Bf(c.stops.map($=>$[0]),u),S=function($,V,G,Y){const J=Y-G,ne=$-G;return J===0?0:V===1?ne/J:(Math.pow(V,ne)-1)/(Math.pow(V,J)-1)}(u,f,c.stops[x][0],c.stops[x+1][0]),j=c.stops[x][1],A=c.stops[x+1][1];let M=Kd[a.type]||Mb;if(c.colorSpace&&c.colorSpace!=="rgb"){const $=cy[c.colorSpace];M=(V,G)=>$.reverse($.interpolate($.forward(V),$.forward(G),S))}return typeof j.evaluate=="function"?{evaluate(...$){const V=j.evaluate.apply(void 0,$),G=A.evaluate.apply(void 0,$);if(V!==void 0&&G!==void 0)return M(V,G,S)}}:M(j,A,S)}function Ob(c,a,u){return a.type==="color"?u=Gn.parse(u):a.type==="formatted"?u=ys.fromString(u.toString()):a.type==="resolvedImage"?u=Js.fromString(u.toString()):Br(u)===a.type||a.type==="enum"&&a.values[u]||(u=void 0),mu(u,c.default,a.default)}class Yf{constructor(a,u){this.expression=a,this._warningHistory={},this._evaluator=new Kg,this._defaultValue=u?function(f){return f.type==="color"&&(th(f.default)||Array.isArray(f.default))?new Gn(0,0,0,0):f.type==="color"?Gn.parse(f.default)||null:f.default===void 0?null:f.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(a,u,f,g,x,S,j,A){return this._evaluator.globals=a,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=g||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=S,this._evaluator.featureTileCoord=j||null,this._evaluator.featureDistanceData=A||null,this.expression.evaluate(this._evaluator)}evaluate(a,u,f,g,x,S,j,A){this._evaluator.globals=a,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=S||null,this._evaluator.featureTileCoord=j||null,this._evaluator.featureDistanceData=A||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new Ri(`Expected value to be one of ${Object.keys(this._enumValues).map($=>JSON.stringify($)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function gu(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in eh}function yu(c,a){const u=new ty(eh,[],a?function(g){const x={color:Rs,string:Cr,number:$t,enum:Cr,boolean:Er,formatted:zd,resolvedImage:Jl};return g.type==="array"?Ys(x[g.value]||Tr,g.length):x[g.type]}(a):void 0),f=u.parse(c,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?kb(new Yf(f,a)):nc(u.errors)}class gy{constructor(a,u){this.kind=a,this._styleExpression=u,this.isStateDependent=a!=="constant"&&!No(u.expression)}evaluateWithoutErrorHandling(a,u,f,g,x,S){return this._styleExpression.evaluateWithoutErrorHandling(a,u,f,g,x,S)}evaluate(a,u,f,g,x,S){return this._styleExpression.evaluate(a,u,f,g,x,S)}}class rh{constructor(a,u,f,g){this.kind=a,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=a!=="camera"&&!No(u.expression),this.interpolationType=g}evaluateWithoutErrorHandling(a,u,f,g,x,S){return this._styleExpression.evaluateWithoutErrorHandling(a,u,f,g,x,S)}evaluate(a,u,f,g,x,S){return this._styleExpression.evaluate(a,u,f,g,x,S)}interpolationFactor(a,u,f){return this.interpolationType?Ha.interpolationFactor(this.interpolationType,a,u,f):0}}function nh(c,a){if((c=yu(c,a)).result==="error")return c;const u=c.value.expression,f=uu(u);if(!f&&!pu(a))return nc([new Wa("","data expressions not supported")]);const g=tc(u,["zoom","pitch","distance-from-center"]);if(!g&&!Hf(a))return nc([new Wa("","zoom expressions not supported")]);const x=Qf(u);return x||g?x instanceof Wa?nc([x]):x instanceof Ha&&!Xf(a)?nc([new Wa("",'"interpolate" expressions cannot be used with this property')]):kb(x?new rh(f?"camera":"composite",c.value,x.labels,x instanceof Ha?x.interpolation:void 0):new gy(f?"constant":"source",c.value)):nc([new Wa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Jf{constructor(a,u){this._parameters=a,this._specification=u,To(this,Kf(this._parameters,this._specification))}static deserialize(a){return new Jf(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Qf(c){let a=null;if(c instanceof Sb)a=Qf(c.result);else if(c instanceof dy){for(const u of c.args)if(a=Qf(u),a)break}else(c instanceof ny||c instanceof Ha)&&c.input instanceof Po&&c.input.name==="zoom"&&(a=c);return a instanceof Wa||c.eachChild(u=>{const f=Qf(u);f instanceof Wa?a=f:!a&&f?a=new Wa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&f&&a!==f&&(a=new Wa("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}class Ft{constructor(a,u,f,g){this.message=(a?`${a}: `:"")+f,g&&(this.identifier=g),u!=null&&u.__line__&&(this.line=u.__line__)}}function _a(c){const a=c.key,u=c.value,f=c.valueSpec||{},g=c.objectElementValidators||{},x=c.style,S=c.styleSpec;let j=[];const A=Br(u);if(A!=="object")return[new Ft(a,u,`object expected, ${A} found`)];for(const M in u){const $=M.split(".")[0];let V;g[$]?V=g[$]:f[$]?V=Hi:g["*"]?V=g["*"]:f["*"]&&(V=Hi),V?j=j.concat(V({key:(a&&`${a}.`)+M,value:u[M],valueSpec:f[$]||f["*"],style:x,styleSpec:S,object:u,objectKey:M},u)):j.push(new Ft(a,u[M],`unknown property "${M}"`))}for(const M in f)g[M]||f[M].required&&f[M].default===void 0&&u[M]===void 0&&j.push(new Ft(a,u,`missing required property "${M}"`));return j}function Rb(c){const a=c.value,u=c.valueSpec,f=c.style,g=c.styleSpec,x=c.key,S=c.arrayElementValidator||Hi;if(Br(a)!=="array")return[new Ft(x,a,`array expected, ${Br(a)} found`)];if(u.length&&a.length!==u.length)return[new Ft(x,a,`array length ${u.length} expected, length ${a.length} found`)];if(u["min-length"]&&a.length<u["min-length"])return[new Ft(x,a,`array length at least ${u["min-length"]} expected, length ${a.length} found`)];let j={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};g.$version<7&&(j.function=u.function),Br(u.value)==="object"&&(j=u.value);let A=[];for(let M=0;M<a.length;M++)A=A.concat(S({array:a,arrayIndex:M,value:a[M],valueSpec:j,style:f,styleSpec:g,key:`${x}[${M}]`}));return A}function ih(c){const a=c.key,u=c.value,f=c.valueSpec;let g=Br(u);if(g==="number"&&u!=u&&(g="NaN"),g!=="number")return[new Ft(a,u,`number expected, ${g} found`)];if("minimum"in f){let x=f.minimum;if(Br(f.minimum)==="array"&&(x=f.minimum[c.arrayIndex]),u<x)return[new Ft(a,u,`${u} is less than the minimum value ${x}`)]}if("maximum"in f){let x=f.maximum;if(Br(f.maximum)==="array"&&(x=f.maximum[c.arrayIndex]),u>x)return[new Ft(a,u,`${u} is greater than the maximum value ${x}`)]}return[]}function sh(c){const a=c.valueSpec,u=Jn(c.value.type);let f,g,x,S={};const j=u!=="categorical"&&c.value.property===void 0,A=!j,M=Br(c.value.stops)==="array"&&Br(c.value.stops[0])==="array"&&Br(c.value.stops[0][0])==="object",$=_a({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(Y){if(u==="identity")return[new Ft(Y.key,Y.value,'identity function may not have a "stops" property')];let J=[];const ne=Y.value;return J=J.concat(Rb({key:Y.key,value:ne,valueSpec:Y.valueSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:V})),Br(ne)==="array"&&ne.length===0&&J.push(new Ft(Y.key,ne,"array must have at least one stop")),J},default:function(Y){return Hi({key:Y.key,value:Y.value,valueSpec:a,style:Y.style,styleSpec:Y.styleSpec})}}});return u==="identity"&&j&&$.push(new Ft(c.key,c.value,'missing required property "property"')),u==="identity"||c.value.stops||$.push(new Ft(c.key,c.value,'missing required property "stops"')),u==="exponential"&&c.valueSpec.expression&&!Xf(c.valueSpec)&&$.push(new Ft(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(A&&!pu(c.valueSpec)?$.push(new Ft(c.key,c.value,"property functions not supported")):j&&!Hf(c.valueSpec)&&$.push(new Ft(c.key,c.value,"zoom functions not supported"))),u!=="categorical"&&!M||c.value.property!==void 0||$.push(new Ft(c.key,c.value,'"property" property is required')),$;function V(Y){let J=[];const ne=Y.value,ce=Y.key;if(Br(ne)!=="array")return[new Ft(ce,ne,`array expected, ${Br(ne)} found`)];if(ne.length!==2)return[new Ft(ce,ne,`array length 2 expected, length ${ne.length} found`)];if(M){if(Br(ne[0])!=="object")return[new Ft(ce,ne,`object expected, ${Br(ne[0])} found`)];if(ne[0].zoom===void 0)return[new Ft(ce,ne,"object stop key must have zoom")];if(ne[0].value===void 0)return[new Ft(ce,ne,"object stop key must have value")];const ye=Jn(ne[0].zoom);if(typeof ye!="number")return[new Ft(ce,ne[0].zoom,"stop zoom values must be numbers")];if(x&&x>ye)return[new Ft(ce,ne[0].zoom,"stop zoom values must appear in ascending order")];ye!==x&&(x=ye,g=void 0,S={}),J=J.concat(_a({key:`${ce}[0]`,value:ne[0],valueSpec:{zoom:{}},style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:ih,value:G}}))}else J=J.concat(G({key:`${ce}[0]`,value:ne[0],valueSpec:{},style:Y.style,styleSpec:Y.styleSpec},ne));return gu(bi(ne[1]))?J.concat([new Ft(`${ce}[1]`,ne[1],"expressions are not allowed in function stops.")]):J.concat(Hi({key:`${ce}[1]`,value:ne[1],valueSpec:a,style:Y.style,styleSpec:Y.styleSpec}))}function G(Y,J){const ne=Br(Y.value),ce=Jn(Y.value),ye=Y.value!==null?Y.value:J;if(f){if(ne!==f)return[new Ft(Y.key,ye,`${ne} stop domain type must match previous stop domain type ${f}`)]}else f=ne;if(ne!=="number"&&ne!=="string"&&ne!=="boolean"&&typeof ce!="number"&&typeof ce!="string"&&typeof ce!="boolean")return[new Ft(Y.key,ye,"stop domain value must be a number, string, or boolean")];if(ne!=="number"&&u!=="categorical"){let Pe=`number expected, ${ne} found`;return pu(a)&&u===void 0&&(Pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ft(Y.key,ye,Pe)]}return u!=="categorical"||ne!=="number"||typeof ce=="number"&&isFinite(ce)&&Math.floor(ce)===ce?u!=="categorical"&&ne==="number"&&typeof ce=="number"&&typeof g=="number"&&g!==void 0&&ce<g?[new Ft(Y.key,ye,"stop domain values must appear in ascending order")]:(g=ce,u==="categorical"&&ce in S?[new Ft(Y.key,ye,"stop domain values must be unique")]:(S[ce]=!0,[])):[new Ft(Y.key,ye,`integer expected, found ${String(ce)}`)]}}function _i(c){const a=(c.expressionContext==="property"?nh:yu)(bi(c.value),c.valueSpec);if(a.result==="error")return a.value.map(f=>new Ft(`${c.key}${f.key}`,c.value,f.message));const u=a.value.expression||a.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!u.outputDefined())return[new Ft(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!No(u))return[new Ft(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter")return ah(u,c);if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!tc(u,["zoom","feature-state"]))return[new Ft(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!uu(u))return[new Ft(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ah(c,a){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(a.valueSpec&&a.valueSpec.expression)for(const g of a.valueSpec.expression.parameters)u.delete(g);if(u.size===0)return[];const f=[];return c instanceof Po&&u.has(c.name)?[new Ft(a.key,a.value,`["${c.name}"] expression is not supported in a filter for a ${a.object.type} layer with id: ${a.object.id}`)]:(c.eachChild(g=>{f.push(...ah(g,a))}),f)}function ep(c){const a=c.key,u=c.value,f=c.valueSpec,g=[];return Array.isArray(f.values)?f.values.indexOf(Jn(u))===-1&&g.push(new Ft(a,u,`expected one of [${f.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(f.values).indexOf(Jn(u))===-1&&g.push(new Ft(a,u,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(u)} found`)),g}function yy(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const a of c.slice(1))if(!yy(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}function tp(c,a="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};yy(c)||(c=xu(c));const u=c;let f=!0;try{f=function(M){if(!vu(M))return M;let $=bi(M);return rp($),$=Db($),$}(u)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(u,null,2)}
        `)}const g=ot[`filter_${a}`],x=yu(f,g);let S=null;if(x.result==="error")throw new Error(x.value.map(M=>`${M.key}: ${M.message}`).join(", "));S=(M,$,V)=>x.value.evaluate(M,$,{},V);let j=null,A=null;if(f!==u){const M=yu(u,g);if(M.result==="error")throw new Error(M.value.map($=>`${$.key}: ${$.message}`).join(", "));j=($,V,G,Y,J)=>M.value.evaluate($,V,{},G,void 0,void 0,Y,J),A=!uu(M.value.expression)}return{filter:S,dynamicFilter:j||void 0,needGeometry:Lb(f),needFeature:!!A}}function Db(c){if(!Array.isArray(c))return c;const a=function(u){if(vy.has(u[0])){for(let f=1;f<u.length;f++)if(vu(u[f]))return!0}return u}(c);return a===!0?a:a.map(u=>Db(u))}function rp(c){let a=!1;const u=[];if(c[0]==="case"){for(let f=1;f<c.length-1;f+=2)a=a||vu(c[f]),u.push(c[f+1]);u.push(c[c.length-1])}else if(c[0]==="match"){a=a||vu(c[1]);for(let f=2;f<c.length-1;f+=2)u.push(c[f+1]);u.push(c[c.length-1])}else if(c[0]==="step"){a=a||vu(c[1]);for(let f=1;f<c.length-1;f+=2)u.push(c[f+1])}a&&(c.length=0,c.push("any",...u));for(let f=1;f<c.length;f++)rp(c[f])}function vu(c){if(!Array.isArray(c))return!1;if((a=c[0])==="pitch"||a==="distance-from-center")return!0;var a;for(let u=1;u<c.length;u++)if(vu(c[u]))return!0;return!1}const vy=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function sT(c,a){return c<a?-1:c>a?1:0}function Lb(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let a=1;a<c.length;a++)if(Lb(c[a]))return!0;return!1}function xu(c){if(!c)return!0;const a=c[0];return c.length<=1?a!=="any":a==="=="?xy(c[1],c[2],"=="):a==="!="?np(xy(c[1],c[2],"==")):a==="<"||a===">"||a==="<="||a===">="?xy(c[1],c[2],a):a==="any"?(u=c.slice(1),["any"].concat(u.map(xu))):a==="all"?["all"].concat(c.slice(1).map(xu)):a==="none"?["all"].concat(c.slice(1).map(xu).map(np)):a==="in"?by(c[1],c.slice(2)):a==="!in"?np(by(c[1],c.slice(2))):a==="has"?_y(c[1]):a==="!has"?np(_y(c[1])):a!=="within"||c;var u}function xy(c,a,u){switch(c){case"$type":return[`filter-type-${u}`,a];case"$id":return[`filter-id-${u}`,a];default:return[`filter-${u}`,c,a]}}function by(c,a){if(a.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(u=>typeof u!=typeof a[0])?["filter-in-large",c,["literal",a.sort(sT)]]:["filter-in-small",c,["literal",a]]}}function _y(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function np(c){return["!",c]}function oh(c){return yy(bi(c.value))?_i(To({},c,{expressionContext:"filter",valueSpec:c.styleSpec[`filter_${c.layerType||"fill"}`]})):lh(c)}function lh(c){const a=c.value,u=c.key;if(Br(a)!=="array")return[new Ft(u,a,`array expected, ${Br(a)} found`)];const f=c.styleSpec;let g,x=[];if(a.length<1)return[new Ft(u,a,"filter array must have at least 1 element")];switch(x=x.concat(ep({key:`${u}[0]`,value:a[0],valueSpec:f.filter_operator,style:c.style,styleSpec:c.styleSpec})),Jn(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&Jn(a[1])==="$type"&&x.push(new Ft(u,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&x.push(new Ft(u,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(g=Br(a[1]),g!=="string"&&x.push(new Ft(`${u}[1]`,a[1],`string expected, ${g} found`)));for(let S=2;S<a.length;S++)g=Br(a[S]),Jn(a[1])==="$type"?x=x.concat(ep({key:`${u}[${S}]`,value:a[S],valueSpec:f.geometry_type,style:c.style,styleSpec:c.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&x.push(new Ft(`${u}[${S}]`,a[S],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let S=1;S<a.length;S++)x=x.concat(lh({key:`${u}[${S}]`,value:a[S],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":g=Br(a[1]),a.length!==2?x.push(new Ft(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):g!=="string"&&x.push(new Ft(`${u}[1]`,a[1],`string expected, ${g} found`));break;case"within":g=Br(a[1]),a.length!==2?x.push(new Ft(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):g!=="object"&&x.push(new Ft(`${u}[1]`,a[1],`object expected, ${g} found`))}return x}function wy(c,a){const u=c.key,f=c.style,g=c.styleSpec,x=c.value,S=c.objectKey,j=g[`${a}_${c.layerType}`];if(!j)return[];const A=S.match(/^(.*)-transition$/);if(a==="paint"&&A&&j[A[1]]&&j[A[1]].transition)return Hi({key:u,value:x,valueSpec:g.transition,style:f,styleSpec:g});const M=c.valueSpec||j[S];if(!M)return[new Ft(u,x,`unknown property "${S}"`)];let $;if(Br(x)==="string"&&pu(M)&&!M.tokens&&($=/^{([^}]+)}$/.exec(x))){const G=`\`{ "type": "identity", "property": ${$?JSON.stringify($[1]):'"_"'} }\``;return[new Ft(u,x,`"${S}" does not support interpolation syntax
Use an identity property function instead: ${G}.`)]}const V=[];return c.layerType==="symbol"&&(S==="text-field"&&f&&!f.glyphs&&V.push(new Ft(u,x,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&th(bi(x))&&Jn(x.type)==="identity"&&V.push(new Ft(u,x,'"text-font" does not support identity functions'))),V.concat(Hi({key:c.key,value:x,valueSpec:M,style:f,styleSpec:g,expressionContext:"property",propertyType:a,propertyKey:S}))}function Bb(c){return wy(c,"paint")}function Sy(c){return wy(c,"layout")}function zb(c){let a=[];const u=c.value,f=c.key,g=c.style,x=c.styleSpec;u.type||u.ref||a.push(new Ft(f,u,'either "type" or "ref" is required'));let S=Jn(u.type);const j=Jn(u.ref);if(u.id){const A=Jn(u.id);for(let M=0;M<c.arrayIndex;M++){const $=g.layers[M];Jn($.id)===A&&a.push(new Ft(f,u.id,`duplicate layer id "${u.id}", previously used at line ${$.id.__line__}`))}}if("ref"in u){let A;["type","source","source-layer","filter","layout"].forEach(M=>{M in u&&a.push(new Ft(f,u[M],`"${M}" is prohibited for ref layers`))}),g.layers.forEach(M=>{Jn(M.id)===j&&(A=M)}),A?A.ref?a.push(new Ft(f,u.ref,"ref cannot reference another ref layer")):S=Jn(A.type):typeof j=="string"&&a.push(new Ft(f,u.ref,`ref layer "${j}" not found`))}else if(S!=="background"&&S!=="sky")if(u.source){const A=g.sources&&g.sources[u.source],M=A&&Jn(A.type);A?M==="vector"&&S==="raster"?a.push(new Ft(f,u.source,`layer "${u.id}" requires a raster source`)):M==="raster"&&S!=="raster"?a.push(new Ft(f,u.source,`layer "${u.id}" requires a vector source`)):M!=="vector"||u["source-layer"]?M==="raster-dem"&&S!=="hillshade"?a.push(new Ft(f,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):S!=="line"||!u.paint||!u.paint["line-gradient"]&&!u.paint["line-trim-offset"]||M==="geojson"&&A.lineMetrics||a.push(new Ft(f,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new Ft(f,u,`layer "${u.id}" must specify a "source-layer"`)):a.push(new Ft(f,u.source,`source "${u.source}" not found`))}else a.push(new Ft(f,u,'missing required property "source"'));return a=a.concat(_a({key:f,value:u,valueSpec:x.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Hi({key:`${f}.type`,value:u.type,valueSpec:x.layer.type,style:c.style,styleSpec:c.styleSpec,object:u,objectKey:"type"}),filter:A=>oh(To({layerType:S},A)),layout:A=>_a({layer:u,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":M=>Sy(To({layerType:S},M))}}),paint:A=>_a({layer:u,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":M=>Bb(To({layerType:S},M))}})}})),a}function xl(c){const a=c.value,u=c.key,f=Br(a);return f!=="string"?[new Ft(u,a,`string expected, ${f} found`)]:[]}const $b={promoteId:function({key:c,value:a}){if(Br(a)==="string")return xl({key:c,value:a});{const u=[];for(const f in a)u.push(...xl({key:`${c}.${f}`,value:a[f]}));return u}}};function Fb(c){const a=c.value,u=c.key,f=c.styleSpec,g=c.style;if(!a.type)return[new Ft(u,a,'"type" is required')];const x=Jn(a.type);let S;switch(x){case"vector":case"raster":case"raster-dem":return S=_a({key:u,value:a,valueSpec:f[`source_${x.replace("-","_")}`],style:c.style,styleSpec:f,objectElementValidators:$b}),S;case"geojson":if(S=_a({key:u,value:a,valueSpec:f.source_geojson,style:g,styleSpec:f,objectElementValidators:$b}),a.cluster)for(const j in a.clusterProperties){const[A,M]=a.clusterProperties[j],$=typeof A=="string"?[A,["accumulated"],["get",j]]:A;S.push(..._i({key:`${u}.${j}.map`,value:M,expressionContext:"cluster-map"})),S.push(..._i({key:`${u}.${j}.reduce`,value:$,expressionContext:"cluster-reduce"}))}return S;case"video":return _a({key:u,value:a,valueSpec:f.source_video,style:g,styleSpec:f});case"image":return _a({key:u,value:a,valueSpec:f.source_image,style:g,styleSpec:f});case"canvas":return[new Ft(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ep({key:`${u}.type`,value:a.type,valueSpec:{values:aT(f)},style:g,styleSpec:f})}}function aT(c){return c.source.reduce((a,u)=>{const f=c[u];return f.type.type==="enum"&&(a=a.concat(Object.keys(f.type.values))),a},[])}function Ub(c){const a=c.value,u=c.styleSpec,f=u.light,g=c.style;let x=[];const S=Br(a);if(a===void 0)return x;if(S!=="object")return x=x.concat([new Ft("light",a,`object expected, ${S} found`)]),x;for(const j in a){const A=j.match(/^(.*)-transition$/);x=x.concat(A&&f[A[1]]&&f[A[1]].transition?Hi({key:j,value:a[j],valueSpec:u.transition,style:g,styleSpec:u}):f[j]?Hi({key:j,value:a[j],valueSpec:f[j],style:g,styleSpec:u}):[new Ft(j,a[j],`unknown property "${j}"`)])}return x}function Ey(c){const a=c.value,u=c.key,f=c.style,g=c.styleSpec,x=g.terrain;let S=[];const j=Br(a);if(a===void 0)return S;if(j!=="object")return S=S.concat([new Ft("terrain",a,`object expected, ${j} found`)]),S;for(const A in a){const M=A.match(/^(.*)-transition$/);S=S.concat(M&&x[M[1]]&&x[M[1]].transition?Hi({key:A,value:a[A],valueSpec:g.transition,style:f,styleSpec:g}):x[A]?Hi({key:A,value:a[A],valueSpec:x[A],style:f,styleSpec:g}):[new Ft(A,a[A],`unknown property "${A}"`)])}if(a.source){const A=f.sources&&f.sources[a.source],M=A&&Jn(A.type);A?M!=="raster-dem"&&S.push(new Ft(u,a.source,`terrain cannot be used with a source of type ${String(M)}, it only be used with a "raster-dem" source type`)):S.push(new Ft(u,a.source,`source "${a.source}" not found`))}else S.push(new Ft(u,a,'terrain is missing required property "source"'));return S}function Vb(c){const a=c.value,u=c.style,f=c.styleSpec,g=f.fog;let x=[];const S=Br(a);if(a===void 0)return x;if(S!=="object")return x=x.concat([new Ft("fog",a,`object expected, ${S} found`)]),x;for(const j in a){const A=j.match(/^(.*)-transition$/);x=x.concat(A&&g[A[1]]&&g[A[1]].transition?Hi({key:j,value:a[j],valueSpec:f.transition,style:u,styleSpec:f}):g[j]?Hi({key:j,value:a[j],valueSpec:g[j],style:u,styleSpec:f}):[new Ft(j,a[j],`unknown property "${j}"`)])}return x}const qb={"*":()=>[],array:Rb,boolean:function(c){const a=c.value,u=c.key,f=Br(a);return f!=="boolean"?[new Ft(u,a,`boolean expected, ${f} found`)]:[]},number:ih,color:function(c){const a=c.key,u=c.value,f=Br(u);return f!=="string"?[new Ft(a,u,`color expected, ${f} found`)]:Ug(u)===null?[new Ft(a,u,`color expected, "${u}" found`)]:[]},enum:ep,filter:oh,function:sh,layer:zb,object:_a,source:Fb,light:Ub,terrain:Ey,fog:Vb,string:xl,formatted:function(c){return xl(c).length===0?[]:_i(c)},resolvedImage:function(c){return xl(c).length===0?[]:_i(c)},projection:function(c){const a=c.value,u=c.styleSpec,f=u.projection,g=c.style;let x=[];const S=Br(a);if(S==="object")for(const j in a)x=x.concat(Hi({key:j,value:a[j],valueSpec:f[j],style:g,styleSpec:u}));else S!=="string"&&(x=x.concat([new Ft("projection",a,`object or string expected, ${S} found`)]));return x}};function Hi(c){const a=c.value,u=c.valueSpec,f=c.styleSpec;return u.expression&&th(Jn(a))?sh(c):u.expression&&gu(bi(a))?_i(c):u.type&&qb[u.type]?qb[u.type](c):_a(To({},c,{valueSpec:u.type?f[u.type]:u}))}function oT(c){const a=c.value,u=c.key,f=xl(c);return f.length||(a.indexOf("{fontstack}")===-1&&f.push(new Ft(u,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&f.push(new Ft(u,a,'"glyphs" url must include a "{range}" token'))),f}function Wb(c,a=ot){return ea(Hi({key:"",value:c,valueSpec:a.$root,styleSpec:a,style:c,objectElementValidators:{glyphs:oT,"*":()=>[]}}))}const lT=c=>ea(Bb(c)),cT=c=>ea(Sy(c));function ea(c){return c.slice().sort((a,u)=>a.line&&u.line?a.line-u.line:0)}function Gb(c,a){let u=!1;if(a&&a.length)for(const f of a)c.fire(new Eo(new Error(f.message))),u=!0;return u}var uT=Xa,wa=3;function Xa(c,a,u){var f=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var g=new Int32Array(this.arrayBuffer);c=g[0],this.d=(a=g[1])+2*(u=g[2]);for(var x=0;x<this.d*this.d;x++){var S=g[wa+x],j=g[wa+x+1];f.push(S===j?null:g.subarray(S,j))}var A=g[wa+f.length+1];this.keys=g.subarray(g[wa+f.length],A),this.bboxes=g.subarray(A),this.insert=this._insertReadonly}else{this.d=a+2*u;for(var M=0;M<this.d*this.d;M++)f.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=c,this.padding=u,this.scale=a/c,this.uid=0;var $=u/a*c;this.min=-$,this.max=c+$}Xa.prototype.insert=function(c,a,u,f,g){this._forEachCell(a,u,f,g,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g)},Xa.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Xa.prototype._insertCell=function(c,a,u,f,g,x){this.cells[g].push(x)},Xa.prototype.query=function(c,a,u,f,g){var x=this.min,S=this.max;if(c<=x&&a<=x&&S<=u&&S<=f&&!g)return Array.prototype.slice.call(this.keys);var j=[];return this._forEachCell(c,a,u,f,this._queryCell,j,{},g),j},Xa.prototype._queryCell=function(c,a,u,f,g,x,S,j){var A=this.cells[g];if(A!==null)for(var M=this.keys,$=this.bboxes,V=0;V<A.length;V++){var G=A[V];if(S[G]===void 0){var Y=4*G;(j?j($[Y+0],$[Y+1],$[Y+2],$[Y+3]):c<=$[Y+2]&&a<=$[Y+3]&&u>=$[Y+0]&&f>=$[Y+1])?(S[G]=!0,x.push(M[G])):S[G]=!1}}},Xa.prototype._forEachCell=function(c,a,u,f,g,x,S,j){for(var A=this._convertToCellCoord(c),M=this._convertToCellCoord(a),$=this._convertToCellCoord(u),V=this._convertToCellCoord(f),G=A;G<=$;G++)for(var Y=M;Y<=V;Y++){var J=this.d*Y+G;if((!j||j(this._convertFromCellCoord(G),this._convertFromCellCoord(Y),this._convertFromCellCoord(G+1),this._convertFromCellCoord(Y+1)))&&g.call(this,c,a,u,f,J,x,S,j))return}},Xa.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},Xa.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},Xa.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,a=wa+this.cells.length+1+1,u=0,f=0;f<this.cells.length;f++)u+=this.cells[f].length;var g=new Int32Array(a+u+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var x=a,S=0;S<c.length;S++){var j=c[S];g[wa+S]=x,g.set(j,x),x+=j.length}return g[wa+c.length]=x,g.set(this.keys,x),g[wa+c.length+1]=x+=this.keys.length,g.set(this.bboxes,x),x+=this.bboxes.length,g.buffer};var ic=B(uT);const ip={};function Vt(c,a,u={}){Object.defineProperty(c,"_classRegistryKey",{value:a,writeable:!1}),ip[a]={klass:c,omit:u.omit||[]}}Vt(Object,"Object"),ic.serialize=function(c,a){const u=c.toArrayBuffer();return a&&a.push(u),{buffer:u}},ic.deserialize=function(c){return new ic(c.buffer)},Object.defineProperty(ic,"name",{value:"Grid"}),Vt(ic,"Grid"),Vt(Gn,"Color"),Vt(Error,"Error"),Vt(Oi,"AJAXError"),Vt(Js,"ResolvedImage"),Vt(Jf,"StylePropertyFunction"),Vt(Yf,"StyleExpression",{omit:["_evaluator"]}),Vt(rh,"ZoomDependentExpression"),Vt(gy,"ZoomConstantExpression"),Vt(Po,"CompoundExpression",{omit:["_evaluate"]});for(const c in eh)ip[eh[c]._classRegistryKey]||Vt(eh[c],`Expression${c}`);function Ty(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function jy(c){return p.ImageBitmap&&c instanceof p.ImageBitmap}function bu(c,a){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Ty(c)||jy(c))return a&&a.push(c),c;if(ArrayBuffer.isView(c)){const u=c;return a&&a.push(u.buffer),u}if(c instanceof p.ImageData)return a&&a.push(c.data.buffer),c;if(Array.isArray(c)){const u=[];for(const f of c)u.push(bu(f,a));return u}if(typeof c=="object"){const u=c.constructor,f=u._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${f}`);const g=u.serialize?u.serialize(c,a):{};if(!u.serialize){for(const x in c)c.hasOwnProperty(x)&&(ip[f].omit.indexOf(x)>=0||(g[x]=bu(c[x],a)));c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(g.$name=f),g}throw new Error("can't serialize object of type "+typeof c)}function sc(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Ty(c)||jy(c)||ArrayBuffer.isView(c)||c instanceof p.ImageData)return c;if(Array.isArray(c))return c.map(sc);if(typeof c=="object"){const a=c.$name||"Object",{klass:u}=ip[a];if(!u)throw new Error(`can't deserialize unregistered class ${a}`);if(u.deserialize)return u.deserialize(c);const f=Object.create(u.prototype);for(const g of Object.keys(c))g!=="$name"&&(f[g]=sc(c[g]));return f}throw new Error("can't deserialize object of type "+typeof c)}const zt={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function Cy(c){for(const a of c)if(Py(a.charCodeAt(0)))return!0;return!1}function dT(c){for(const a of c)if(!Hb(a.charCodeAt(0)))return!1;return!0}function Hb(c){return!(zt.Arabic(c)||zt["Arabic Supplement"](c)||zt["Arabic Extended-A"](c)||zt["Arabic Presentation Forms-A"](c)||zt["Arabic Presentation Forms-B"](c))}function Py(c){return!(c!==746&&c!==747&&(c<4352||!(zt["Bopomofo Extended"](c)||zt.Bopomofo(c)||zt["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||zt["CJK Compatibility Ideographs"](c)||zt["CJK Compatibility"](c)||zt["CJK Radicals Supplement"](c)||zt["CJK Strokes"](c)||!(!zt["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||zt["CJK Unified Ideographs Extension A"](c)||zt["CJK Unified Ideographs"](c)||zt["Enclosed CJK Letters and Months"](c)||zt["Hangul Compatibility Jamo"](c)||zt["Hangul Jamo Extended-A"](c)||zt["Hangul Jamo Extended-B"](c)||zt["Hangul Jamo"](c)||zt["Hangul Syllables"](c)||zt.Hiragana(c)||zt["Ideographic Description Characters"](c)||zt.Kanbun(c)||zt["Kangxi Radicals"](c)||zt["Katakana Phonetic Extensions"](c)||zt.Katakana(c)&&c!==12540||!(!zt["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!zt["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||zt["Unified Canadian Aboriginal Syllabics"](c)||zt["Unified Canadian Aboriginal Syllabics Extended"](c)||zt["Vertical Forms"](c)||zt["Yijing Hexagram Symbols"](c)||zt["Yi Syllables"](c)||zt["Yi Radicals"](c))))}function Xb(c){return!(Py(c)||function(a){return!!(zt["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||zt["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||zt["Letterlike Symbols"](a)||zt["Number Forms"](a)||zt["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||zt["Control Pictures"](a)&&a!==9251||zt["Optical Character Recognition"](a)||zt["Enclosed Alphanumerics"](a)||zt["Geometric Shapes"](a)||zt["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||zt["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||zt["CJK Symbols and Punctuation"](a)||zt.Katakana(a)||zt["Private Use Area"](a)||zt["CJK Compatibility Forms"](a)||zt["Small Form Variants"](a)||zt["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(c))}function Kb(c){return c>=1424&&c<=2303||zt["Arabic Presentation Forms-A"](c)||zt["Arabic Presentation Forms-B"](c)}function hT(c,a){return!(!a&&Kb(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||zt.Khmer(c))}function fT(c){for(const a of c)if(Kb(a.charCodeAt(0)))return!0;return!1}const Ay="deferred",Ny="loading",ky="loaded";let _u=null,v="unavailable",d=null;const m=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(v="error"),_u&&_u(c)};function w(){T.fire(new Yl("pluginStateChange",{pluginStatus:v,pluginURL:d}))}const T=new Bd,P=function(){return v},D=function(){if(v!==Ay||!d)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");v=Ny,w(),d&&ru({url:d},c=>{c?m(c):(v=ky,w())})},z={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>v===ky||z.applyArabicShaping!=null,isLoading:()=>v===Ny,setState(c){v=c.pluginStatus,d=c.pluginURL},isParsed:()=>z.applyArabicShaping!=null&&z.processBidirectionalText!=null&&z.processStyledBidirectionalText!=null,getPluginURL:()=>d};class U{constructor(a,u){this.zoom=a,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.transition=u.transition,this.pitch=u.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(a){return function(u,f){for(const g of u)if(!hT(g.charCodeAt(0),f))return!1;return!0}(a,z.isLoaded())}}class K{constructor(a,u){this.property=a,this.value=u,this.expression=function(f,g){if(th(f))return new Jf(f,g);if(gu(f)){const x=nh(f,g);if(x.result==="error")throw new Error(x.value.map(S=>`${S.key}: ${S.message}`).join(", "));return x.value}{let x=f;return typeof f=="string"&&g.type==="color"&&(x=Gn.parse(f)),{kind:"constant",evaluate:()=>x}}}(u===void 0?a.specification.default:u,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,u,f){return this.property.possiblyEvaluate(this,a,u,f)}}class X{constructor(a){this.property=a,this.value=new K(a,void 0)}transitioned(a,u){return new le(this.property,this.value,u,ut({},a.transition,this.transition),a.now)}untransitioned(){return new le(this.property,this.value,null,{},0)}}class Q{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return rr(this._values[a].value.value)}setValue(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new X(this._values[a].property)),this._values[a].value=new K(this._values[a].property,u===null?void 0:rr(u))}getTransition(a){return rr(this._values[a].transition)}setTransition(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new X(this._values[a].property)),this._values[a].transition=rr(u)||void 0}serialize(){const a={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(a[u]=f);const g=this.getTransition(u);g!==void 0&&(a[`${u}-transition`]=g)}return a}transitioned(a,u){const f=new he(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].transitioned(a,u._values[g]);return f}untransitioned(){const a=new he(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].untransitioned();return a}}class le{constructor(a,u,f,g,x){const S=g.delay||0,j=g.duration||0;x=x||0,this.property=a,this.value=u,this.begin=x+S,this.end=this.begin+j,a.specification.transition&&(g.delay||g.duration)&&(this.prior=f)}possiblyEvaluate(a,u,f){const g=a.now||0,x=this.value.possiblyEvaluate(a,u,f),S=this.prior;if(S){if(g>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(g<this.begin)return S.possiblyEvaluate(a,u,f);{const j=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(a,u,f),x,xe(j))}}return x}}class he{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,u,f){const g=new ge(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(a,u,f);return g}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class pe{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}getValue(a){return rr(this._values[a].value)}setValue(a,u){this._values[a]=new K(this._values[a].property,u===null?void 0:rr(u))}serialize(){const a={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(a[u]=f)}return a}possiblyEvaluate(a,u,f){const g=new ge(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(a,u,f);return g}}class fe{constructor(a,u,f){this.property=a,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,u,f,g){return this.property.evaluate(this.value,this.parameters,a,u,f,g)}}class ge{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class ee{constructor(a){this.specification=a}possiblyEvaluate(a,u){return a.expression.evaluate(u)}interpolate(a,u,f){const g=Kd[this.specification.type];return g?g(a,u,f):a}}class de{constructor(a,u){this.specification=a,this.overrides=u}possiblyEvaluate(a,u,f,g){return new fe(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(u,null,{},f,g)}:a.expression,u)}interpolate(a,u,f){if(a.value.kind!=="constant"||u.value.kind!=="constant")return a;if(a.value.value===void 0||u.value.value===void 0)return new fe(this,{kind:"constant",value:void 0},a.parameters);const g=Kd[this.specification.type];return g?new fe(this,{kind:"constant",value:g(a.value.value,u.value.value,f)},a.parameters):a}evaluate(a,u,f,g,x,S){return a.kind==="constant"?a.value:a.evaluate(u,f,g,x,S)}}class we{constructor(a){this.specification=a}possiblyEvaluate(a,u,f,g){return!!a.expression.evaluate(u,null,{},f,g)}interpolate(){return!1}}class Se{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const u=new U(0,{});for(const f in a){const g=a[f];g.specification.overridable&&this.overridableProperties.push(f);const x=this.defaultPropertyValues[f]=new K(g,void 0),S=this.defaultTransitionablePropertyValues[f]=new X(g);this.defaultTransitioningPropertyValues[f]=S.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=x.possiblyEvaluate(u)}}}function Re(c,a){return 256*(c=me(Math.floor(c),0,255))+me(Math.floor(a),0,255)}Vt(de,"DataDrivenProperty"),Vt(ee,"DataConstantProperty"),Vt(we,"ColorRampProperty");const Le={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class De{constructor(a,u){this._structArray=a,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ue{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,u){return a._trim(),u&&(a.isTransferred=!0,u.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const u=Object.create(this.prototype);return u.arrayBuffer=a.arrayBuffer,u.length=a.length,u.capacity=a.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Fe(c,a=1){let u=0,f=0;return{members:c.map(g=>{const x=Le[g.type].BYTES_PER_ELEMENT,S=u=Ze(u,Math.max(a,x)),j=g.components||1;return f=Math.max(f,x),u+=x*j,{name:g.name,type:g.type,components:j,offset:S}}),size:Ze(u,Math.max(f,a)),alignment:a}}function Ze(c,a){return Math.ceil(c/a)*a}class wt extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.int16[g+0]=u,this.int16[g+1]=f,a}}wt.prototype.bytesPerElement=4,Vt(wt,"StructArrayLayout2i4");class He extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const x=3*a;return this.int16[x+0]=u,this.int16[x+1]=f,this.int16[x+2]=g,a}}He.prototype.bytesPerElement=6,Vt(He,"StructArrayLayout3i6");class ht extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,a,u,f,g)}emplace(a,u,f,g,x){const S=4*a;return this.int16[S+0]=u,this.int16[S+1]=f,this.int16[S+2]=g,this.int16[S+3]=x,a}}ht.prototype.bytesPerElement=8,Vt(ht,"StructArrayLayout4i8");class Je extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j){const A=this.length;return this.resize(A+1),this.emplace(A,a,u,f,g,x,S,j)}emplace(a,u,f,g,x,S,j,A){const M=6*a,$=12*a,V=3*a;return this.int16[M+0]=u,this.int16[M+1]=f,this.uint8[$+4]=g,this.uint8[$+5]=x,this.uint8[$+6]=S,this.uint8[$+7]=j,this.float32[V+2]=A,a}}Je.prototype.bytesPerElement=12,Vt(Je,"StructArrayLayout2i4ub1f12");class _t extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,a,u,f,g)}emplace(a,u,f,g,x){const S=4*a;return this.float32[S+0]=u,this.float32[S+1]=f,this.float32[S+2]=g,this.float32[S+3]=x,a}}_t.prototype.bytesPerElement=16,Vt(_t,"StructArrayLayout4f16");class Ke extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x){const S=this.length;return this.resize(S+1),this.emplace(S,a,u,f,g,x)}emplace(a,u,f,g,x,S){const j=6*a,A=3*a;return this.uint16[j+0]=u,this.uint16[j+1]=f,this.uint16[j+2]=g,this.uint16[j+3]=x,this.float32[A+2]=S,a}}Ke.prototype.bytesPerElement=12,Vt(Ke,"StructArrayLayout4ui1f12");class dt extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,a,u,f,g)}emplace(a,u,f,g,x){const S=4*a;return this.uint16[S+0]=u,this.uint16[S+1]=f,this.uint16[S+2]=g,this.uint16[S+3]=x,a}}dt.prototype.bytesPerElement=8,Vt(dt,"StructArrayLayout4ui8");class Et extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S){const j=this.length;return this.resize(j+1),this.emplace(j,a,u,f,g,x,S)}emplace(a,u,f,g,x,S,j){const A=6*a;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=g,this.int16[A+3]=x,this.int16[A+4]=S,this.int16[A+5]=j,a}}Et.prototype.bytesPerElement=12,Vt(Et,"StructArrayLayout6i12");class yt extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j,A,M,$,V,G){const Y=this.length;return this.resize(Y+1),this.emplace(Y,a,u,f,g,x,S,j,A,M,$,V,G)}emplace(a,u,f,g,x,S,j,A,M,$,V,G,Y){const J=12*a;return this.int16[J+0]=u,this.int16[J+1]=f,this.int16[J+2]=g,this.int16[J+3]=x,this.uint16[J+4]=S,this.uint16[J+5]=j,this.uint16[J+6]=A,this.uint16[J+7]=M,this.int16[J+8]=$,this.int16[J+9]=V,this.int16[J+10]=G,this.int16[J+11]=Y,a}}yt.prototype.bytesPerElement=24,Vt(yt,"StructArrayLayout4i4ui4i24");class jt extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S){const j=this.length;return this.resize(j+1),this.emplace(j,a,u,f,g,x,S)}emplace(a,u,f,g,x,S,j){const A=10*a,M=5*a;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=g,this.float32[M+2]=x,this.float32[M+3]=S,this.float32[M+4]=j,a}}jt.prototype.bytesPerElement=20,Vt(jt,"StructArrayLayout3i3f20");class Jt extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint32[1*a+0]=u,a}}Jt.prototype.bytesPerElement=4,Vt(Jt,"StructArrayLayout1ul4");class lr extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j,A,M,$,V,G,Y){const J=this.length;return this.resize(J+1),this.emplace(J,a,u,f,g,x,S,j,A,M,$,V,G,Y)}emplace(a,u,f,g,x,S,j,A,M,$,V,G,Y,J){const ne=20*a,ce=10*a;return this.int16[ne+0]=u,this.int16[ne+1]=f,this.int16[ne+2]=g,this.int16[ne+3]=x,this.int16[ne+4]=S,this.float32[ce+3]=j,this.float32[ce+4]=A,this.float32[ce+5]=M,this.float32[ce+6]=$,this.int16[ne+14]=V,this.uint32[ce+8]=G,this.uint16[ne+18]=Y,this.uint16[ne+19]=J,a}}lr.prototype.bytesPerElement=40,Vt(lr,"StructArrayLayout5i4f1i1ul2ui40");class Wt extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j){const A=this.length;return this.resize(A+1),this.emplace(A,a,u,f,g,x,S,j)}emplace(a,u,f,g,x,S,j,A){const M=8*a;return this.int16[M+0]=u,this.int16[M+1]=f,this.int16[M+2]=g,this.int16[M+4]=x,this.int16[M+5]=S,this.int16[M+6]=j,this.int16[M+7]=A,a}}Wt.prototype.bytesPerElement=16,Vt(Wt,"StructArrayLayout3i2i2i16");class sr extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x){const S=this.length;return this.resize(S+1),this.emplace(S,a,u,f,g,x)}emplace(a,u,f,g,x,S){const j=4*a,A=8*a;return this.float32[j+0]=u,this.float32[j+1]=f,this.float32[j+2]=g,this.int16[A+6]=x,this.int16[A+7]=S,a}}sr.prototype.bytesPerElement=16,Vt(sr,"StructArrayLayout2f1f2i16");class jr extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,a,u,f,g)}emplace(a,u,f,g,x){const S=12*a,j=3*a;return this.uint8[S+0]=u,this.uint8[S+1]=f,this.float32[j+1]=g,this.float32[j+2]=x,a}}jr.prototype.bytesPerElement=12,Vt(jr,"StructArrayLayout2ub2f12");class wr extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const x=3*a;return this.float32[x+0]=u,this.float32[x+1]=f,this.float32[x+2]=g,a}}wr.prototype.bytesPerElement=12,Vt(wr,"StructArrayLayout3f12");class Yt extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const x=3*a;return this.uint16[x+0]=u,this.uint16[x+1]=f,this.uint16[x+2]=g,a}}Yt.prototype.bytesPerElement=6,Vt(Yt,"StructArrayLayout3ui6");class Xr extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j,A,M,$,V,G,Y,J,ne,ce,ye,Pe,ve,Te,Ie){const Me=this.length;return this.resize(Me+1),this.emplace(Me,a,u,f,g,x,S,j,A,M,$,V,G,Y,J,ne,ce,ye,Pe,ve,Te,Ie)}emplace(a,u,f,g,x,S,j,A,M,$,V,G,Y,J,ne,ce,ye,Pe,ve,Te,Ie,Me){const Ye=30*a,Xe=15*a,lt=60*a;return this.int16[Ye+0]=u,this.int16[Ye+1]=f,this.int16[Ye+2]=g,this.float32[Xe+2]=x,this.float32[Xe+3]=S,this.uint16[Ye+8]=j,this.uint16[Ye+9]=A,this.uint32[Xe+5]=M,this.uint32[Xe+6]=$,this.uint32[Xe+7]=V,this.uint16[Ye+16]=G,this.uint16[Ye+17]=Y,this.uint16[Ye+18]=J,this.float32[Xe+10]=ne,this.float32[Xe+11]=ce,this.uint8[lt+48]=ye,this.uint8[lt+49]=Pe,this.uint8[lt+50]=ve,this.uint32[Xe+13]=Te,this.int16[Ye+28]=Ie,this.uint8[lt+58]=Me,a}}Xr.prototype.bytesPerElement=60,Vt(Xr,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class rn extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j,A,M,$,V,G,Y,J,ne,ce,ye,Pe,ve,Te,Ie,Me,Ye,Xe,lt,St,Qe,pt,mt,bt){const At=this.length;return this.resize(At+1),this.emplace(At,a,u,f,g,x,S,j,A,M,$,V,G,Y,J,ne,ce,ye,Pe,ve,Te,Ie,Me,Ye,Xe,lt,St,Qe,pt,mt,bt)}emplace(a,u,f,g,x,S,j,A,M,$,V,G,Y,J,ne,ce,ye,Pe,ve,Te,Ie,Me,Ye,Xe,lt,St,Qe,pt,mt,bt,At){const st=38*a,Dt=19*a;return this.int16[st+0]=u,this.int16[st+1]=f,this.int16[st+2]=g,this.float32[Dt+2]=x,this.float32[Dt+3]=S,this.int16[st+8]=j,this.int16[st+9]=A,this.int16[st+10]=M,this.int16[st+11]=$,this.int16[st+12]=V,this.int16[st+13]=G,this.uint16[st+14]=Y,this.uint16[st+15]=J,this.uint16[st+16]=ne,this.uint16[st+17]=ce,this.uint16[st+18]=ye,this.uint16[st+19]=Pe,this.uint16[st+20]=ve,this.uint16[st+21]=Te,this.uint16[st+22]=Ie,this.uint16[st+23]=Me,this.uint16[st+24]=Ye,this.uint16[st+25]=Xe,this.uint16[st+26]=lt,this.uint16[st+27]=St,this.uint16[st+28]=Qe,this.uint32[Dt+15]=pt,this.float32[Dt+16]=mt,this.float32[Dt+17]=bt,this.float32[Dt+18]=At,a}}rn.prototype.bytesPerElement=76,Vt(rn,"StructArrayLayout3i2f6i15ui1ul3f76");class nn extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.float32[1*a+0]=u,a}}nn.prototype.bytesPerElement=4,Vt(nn,"StructArrayLayout1f4");class sn extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x){const S=this.length;return this.resize(S+1),this.emplace(S,a,u,f,g,x)}emplace(a,u,f,g,x,S){const j=5*a;return this.float32[j+0]=u,this.float32[j+1]=f,this.float32[j+2]=g,this.float32[j+3]=x,this.float32[j+4]=S,a}}sn.prototype.bytesPerElement=20,Vt(sn,"StructArrayLayout5f20");class Xi extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,a,u,f,g)}emplace(a,u,f,g,x){const S=6*a;return this.uint32[3*a+0]=u,this.uint16[S+2]=f,this.uint16[S+3]=g,this.uint16[S+4]=x,a}}Xi.prototype.bytesPerElement=12,Vt(Xi,"StructArrayLayout1ul3ui12");class wi extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.uint16[g+0]=u,this.uint16[g+1]=f,a}}wi.prototype.bytesPerElement=4,Vt(wi,"StructArrayLayout2ui4");class ta extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint16[1*a+0]=u,a}}ta.prototype.bytesPerElement=2,Vt(ta,"StructArrayLayout1ui2");class Ka extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.float32[g+0]=u,this.float32[g+1]=f,a}}Ka.prototype.bytesPerElement=8,Vt(Ka,"StructArrayLayout2f8");class jn extends De{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}jn.prototype.size=40;class an extends lr{get(a){return new jn(this,a)}}Vt(an,"CollisionBoxArray");class $r extends De{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(a){this._structArray.uint8[this._pos1+49]=a}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(a){this._structArray.uint8[this._pos1+50]=a}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(a){this._structArray.uint32[this._pos4+13]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(a){this._structArray.uint8[this._pos1+58]=a}}$r.prototype.size=60;class Qn extends Xr{get(a){return new $r(this,a)}}Vt(Qn,"PlacedSymbolArray");class ss extends De{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(a){this._structArray.uint32[this._pos4+15]=a}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}ss.prototype.size=76;class xn extends rn{get(a){return new ss(this,a)}}Vt(xn,"SymbolInstanceArray");class vs extends nn{getoffsetX(a){return this.float32[1*a+0]}}Vt(vs,"GlyphOffsetArray");class sp extends wt{getx(a){return this.int16[2*a+0]}gety(a){return this.int16[2*a+1]}}Vt(sp,"SymbolLineVertexArray");class ac extends De{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ac.prototype.size=12;class ch extends Xi{get(a){return new ac(this,a)}}Vt(ch,"FeatureIndexArray");class Io extends wi{geta_centroid_pos0(a){return this.uint16[2*a+0]}geta_centroid_pos1(a){return this.uint16[2*a+1]}}Vt(Io,"FillExtrusionCentroidArray");const bl=Fe([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),oc=Fe([{name:"a_dash",components:4,type:"Uint16"}]);var ap={exports:{}},uh={exports:{}};uh.exports=function(c,a){var u,f,g,x,S,j,A,M;for(f=c.length-(u=3&c.length),g=a,S=3432918353,j=461845907,M=0;M<f;)A=255&c.charCodeAt(M)|(255&c.charCodeAt(++M))<<8|(255&c.charCodeAt(++M))<<16|(255&c.charCodeAt(++M))<<24,++M,g=27492+(65535&(x=5*(65535&(g=(g^=A=(65535&(A=(A=(65535&A)*S+(((A>>>16)*S&65535)<<16)&4294967295)<<15|A>>>17))*j+(((A>>>16)*j&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(A=0,u){case 3:A^=(255&c.charCodeAt(M+2))<<16;case 2:A^=(255&c.charCodeAt(M+1))<<8;case 1:g^=A=(65535&(A=(A=(65535&(A^=255&c.charCodeAt(M)))*S+(((A>>>16)*S&65535)<<16)&4294967295)<<15|A>>>17))*j+(((A>>>16)*j&65535)<<16)&4294967295}return g^=c.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var My=uh.exports,HO={exports:{}};HO.exports=function(c,a){for(var u,f=c.length,g=a^f,x=0;f>=4;)u=1540483477*(65535&(u=255&c.charCodeAt(x)|(255&c.charCodeAt(++x))<<8|(255&c.charCodeAt(++x))<<16|(255&c.charCodeAt(++x))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:g^=(255&c.charCodeAt(x+2))<<16;case 2:g^=(255&c.charCodeAt(x+1))<<8;case 1:g=1540483477*(65535&(g^=255&c.charCodeAt(x)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var XO=My,KZ=HO.exports;ap.exports=XO,ap.exports.murmur3=XO,ap.exports.murmur2=KZ;var pT=B(ap.exports);class Zb{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,u,f,g){this.ids.push(KO(a)),this.positions.push(u,f,g)}getPositions(a){const u=KO(a);let f=0,g=this.ids.length-1;for(;f<g;){const S=f+g>>1;this.ids[S]>=u?g=S:f=S+1}const x=[];for(;this.ids[f]===u;)x.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return x}static serialize(a,u){const f=new Float64Array(a.ids),g=new Uint32Array(a.positions);return mT(f,g,0,f.length-1),u&&u.push(f.buffer,g.buffer),{ids:f,positions:g}}static deserialize(a){const u=new Zb;return u.ids=a.ids,u.positions=a.positions,u.indexed=!0,u}}function KO(c){const a=+c;return!isNaN(a)&&Number.MIN_SAFE_INTEGER<=a&&a<=Number.MAX_SAFE_INTEGER?a:pT(String(c))}function mT(c,a,u,f){for(;u<f;){const g=c[u+f>>1];let x=u-1,S=f+1;for(;;){do x++;while(c[x]<g);do S--;while(c[S]>g);if(x>=S)break;Yb(c,x,S),Yb(a,3*x,3*S),Yb(a,3*x+1,3*S+1),Yb(a,3*x+2,3*S+2)}S-u<f-S?(mT(c,a,u,S),u=S+1):(mT(c,a,S+1,f),f=S)}}function Yb(c,a,u){const f=c[a];c[a]=c[u],c[u]=f}Vt(Zb,"FeaturePositionMap");class lc{constructor(a){this.gl=a.gl,this.initialized=!1}fetchUniformLocation(a,u){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(a,u),this.initialized=!0),!!this.location}}class Jb extends lc{constructor(a){super(a),this.current=0}set(a,u,f){this.fetchUniformLocation(a,u)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class ZO extends lc{constructor(a){super(a),this.current=[0,0,0,0]}set(a,u,f){this.fetchUniformLocation(a,u)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class YO extends lc{constructor(a){super(a),this.current=Gn.transparent}set(a,u,f){this.fetchUniformLocation(a,u)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const ZZ=new Float32Array(16),YZ=new Float32Array(9),JZ=new Float32Array(4);function gT(c){return[Re(255*c.r,255*c.g),Re(255*c.b,255*c.a)]}class Iy{constructor(a,u,f){this.value=a,this.uniformNames=u.map(g=>`u_${g}`),this.type=f}setUniform(a,u,f,g,x){u.set(a,x,g.constantOr(this.value))}getBinding(a,u){return this.type==="color"?new YO(a):new Jb(a)}}class op{constructor(a,u){this.uniformNames=u.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(a){this.pixelRatio=a.pixelRatio||1,this.pattern=a.tl.concat(a.br)}setUniform(a,u,f,g,x){const S=x==="u_pattern"||x==="u_dash"?this.pattern:x==="u_pixel_ratio"?this.pixelRatio:null;S&&u.set(a,x,S)}getBinding(a,u){return u==="u_pattern"||u==="u_dash"?new ZO(a):new Jb(a)}}class cc{constructor(a,u,f,g){this.expression=a,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(x=>({name:`a_${x}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(a,u,f,g,x,S){const j=this.paintVertexArray.length,A=this.expression.evaluate(new U(0),u,{},x,g,S);this.paintVertexArray.resize(a),this._setPaintValue(j,a,A)}updatePaintArray(a,u,f,g,x){const S=this.expression.evaluate({zoom:0},f,g,void 0,x);this._setPaintValue(a,u,S)}_setPaintValue(a,u,f){if(this.type==="color"){const g=gT(f);for(let x=a;x<u;x++)this.paintVertexArray.emplace(x,g[0],g[1])}else{for(let g=a;g<u;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Oo{constructor(a,u,f,g,x,S){this.expression=a,this.uniformNames=u.map(j=>`u_${j}_t`),this.type=f,this.useIntegerZoom=g,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=u.map(j=>({name:`a_${j}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(a,u,f,g,x,S){const j=this.expression.evaluate(new U(this.zoom),u,{},x,g,S),A=this.expression.evaluate(new U(this.zoom+1),u,{},x,g,S),M=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(M,a,j,A)}updatePaintArray(a,u,f,g,x){const S=this.expression.evaluate({zoom:this.zoom},f,g,void 0,x),j=this.expression.evaluate({zoom:this.zoom+1},f,g,void 0,x);this._setPaintValue(a,u,S,j)}_setPaintValue(a,u,f,g){if(this.type==="color"){const x=gT(f),S=gT(g);for(let j=a;j<u;j++)this.paintVertexArray.emplace(j,x[0],x[1],S[0],S[1])}else{for(let x=a;x<u;x++)this.paintVertexArray.emplace(x,f,g);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(g))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,u,f,g,x){const S=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,j=me(this.expression.interpolationFactor(S,this.zoom,this.zoom+1),0,1);u.set(a,x,j)}getBinding(a,u){return new Jb(a)}}class wu{constructor(a,u,f,g,x){this.expression=a,this.layerId=x,this.paintVertexAttributes=(f==="array"?oc:bl).members;for(let S=0;S<u.length;++S);this.paintVertexArray=new g}populatePaintArray(a,u,f){const g=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValues(g,a,u.patterns&&u.patterns[this.layerId],f)}updatePaintArray(a,u,f,g,x,S){this._setPaintValues(a,u,f.patterns&&f.patterns[this.layerId],S)}_setPaintValues(a,u,f,g){if(!g||!f)return;const x=g[f];if(!x)return;const{tl:S,br:j,pixelRatio:A}=x;for(let M=a;M<u;M++)this.paintVertexArray.emplace(M,S[0],S[1],j[0],j[1],A)}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Su{constructor(a,u,f=()=>!0){this.binders={},this._buffers=[];const g=[];for(const x in a.paint._values){if(!f(x))continue;const S=a.paint.get(x);if(!(S instanceof fe&&pu(S.property.specification)))continue;const j=eY(x,a.type),A=S.value,M=S.property.specification.type,$=!!S.property.useIntegerZoom,V=x==="line-dasharray"||x.endsWith("pattern"),G=x==="line-dasharray"&&a.layout.get("line-cap").value.kind!=="constant";if(A.kind!=="constant"||G)if(A.kind==="source"||G||V){const Y=JO(x,M,"source");this.binders[x]=V?new wu(A,j,M,Y,a.id):new cc(A,j,M,Y),g.push(`/a_${x}`)}else{const Y=JO(x,M,"composite");this.binders[x]=new Oo(A,j,M,$,u,Y),g.push(`/z_${x}`)}else this.binders[x]=V?new op(A.value,j):new Iy(A.value,j,M),g.push(`/u_${x}`)}this.cacheKey=g.sort().join("")}getMaxValue(a){const u=this.binders[a];return u instanceof cc||u instanceof Oo?u.maxValue:0}populatePaintArrays(a,u,f,g,x,S){for(const j in this.binders){const A=this.binders[j];(A instanceof cc||A instanceof Oo||A instanceof wu)&&A.populatePaintArray(a,u,f,g,x,S)}}setConstantPatternPositions(a){for(const u in this.binders){const f=this.binders[u];f instanceof op&&f.setConstantPatternPositions(a)}}updatePaintArrays(a,u,f,g,x,S){let j=!1;for(const A in a){const M=u.getPositions(A);for(const $ of M){const V=f.feature($.index);for(const G in this.binders){const Y=this.binders[G];if((Y instanceof cc||Y instanceof Oo||Y instanceof wu)&&Y.expression.isStateDependent===!0){const J=g.paint.get(G);Y.expression=J.value,Y.updatePaintArray($.start,$.end,V,a[A],x,S),j=!0}}}}return j}defines(){const a=[];for(const u in this.binders){const f=this.binders[u];(f instanceof Iy||f instanceof op)&&a.push(...f.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return a}getBinderAttributes(){const a=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof cc||f instanceof Oo||f instanceof wu)for(let g=0;g<f.paintVertexAttributes.length;g++)a.push(f.paintVertexAttributes[g].name)}return a}getBinderUniforms(){const a=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Iy||f instanceof op||f instanceof Oo)for(const g of f.uniformNames)a.push(g)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a){const u=[];for(const f in this.binders){const g=this.binders[f];if(g instanceof Iy||g instanceof op||g instanceof Oo)for(const x of g.uniformNames)u.push({name:x,property:f,binding:g.getBinding(a,x)})}return u}setUniforms(a,u,f,g,x){for(const{name:S,property:j,binding:A}of f)this.binders[j].setUniform(a,A,x,g.get(j),S)}updatePaintBuffers(){this._buffers=[];for(const a in this.binders){const u=this.binders[a];(u instanceof cc||u instanceof Oo||u instanceof wu)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(a){for(const u in this.binders){const f=this.binders[u];(f instanceof cc||f instanceof Oo||f instanceof wu)&&f.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const u=this.binders[a];(u instanceof cc||u instanceof Oo||u instanceof wu)&&u.destroy()}}}class dh{constructor(a,u,f=()=>!0){this.programConfigurations={};for(const g of a)this.programConfigurations[g.id]=new Su(g,u,f);this.needsUpload=!1,this._featureMap=new Zb,this._bufferOffset=0}populatePaintArrays(a,u,f,g,x,S,j){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(a,u,g,x,S,j);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,u,f,g,x){for(const S of f)this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(a,this._featureMap,u,S,g,x)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}const QZ={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function eY(c,a){return QZ[c]||[c.replace(`${a}-`,"").replace(/-/g,"_")]}const tY={"line-pattern":{source:Ke,composite:Ke},"fill-pattern":{source:Ke,composite:Ke},"fill-extrusion-pattern":{source:Ke,composite:Ke},"line-dasharray":{source:dt,composite:dt}},rY={color:{source:Ka,composite:_t},number:{source:nn,composite:Ka}};function JO(c,a,u){const f=tY[c];return f&&f[u]||rY[a][u]}Vt(Iy,"ConstantBinder"),Vt(op,"PatternConstantBinder"),Vt(cc,"SourceExpressionBinder"),Vt(wu,"PatternCompositeBinder"),Vt(Oo,"CompositeExpressionBinder"),Vt(Su,"ProgramConfiguration",{omit:["_buffers"]}),Vt(dh,"ProgramConfigurationSet");const QO="-transition";class Ro extends Bd{constructor(a,u){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&a.type!=="sky"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),u.layout&&(this._unevaluatedLayout=new pe(u.layout)),u.paint)){this._transitionablePaint=new Q(u.paint);for(const f in a.paint)this.setPaintProperty(f,a.paint[f],{validate:!1});for(const f in a.layout)this.setLayoutProperty(f,a.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ge(u.paint)}}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,u,f={}){u!=null&&this._validate(cT,`layers.${this.id}.layout.${a}`,a,u,f)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,u):this.visibility=u)}getPaintProperty(a){return gt(a,QO)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,u,f={}){if(u!=null&&this._validate(lT,`layers.${this.id}.paint.${a}`,a,u,f))return!1;if(gt(a,QO))return this._transitionablePaint.setTransition(a.slice(0,-11),u||void 0),!1;{const g=this._transitionablePaint._values[a],x=g.value.isDataDriven(),S=g.value;this._transitionablePaint.setValue(a,u),this._handleSpecialPaintPropertyUpdate(a);const j=this._transitionablePaint._values[a].value,A=j.isDataDriven(),M=gt(a,"pattern")||a==="line-dasharray";return A||x||M||this._handleOverridablePaintPropertyUpdate(a,S,j)}}_handleSpecialPaintPropertyUpdate(a){}getProgramIds(){return null}getProgramConfiguration(a){return null}_handleOverridablePaintPropertyUpdate(a,u,f){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,u){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,u)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),rt(a,(u,f)=>!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length))}_validate(a,u,f,g,x={}){return(!x||x.validate!==!1)&&Gb(this,a.call(Wb,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:ot,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const u=this.paint.get(a);if(u instanceof fe&&pu(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=tp(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const nY=Fe([{name:"a_pos",components:2,type:"Int16"}],4),iY=Fe([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ei{constructor(a=[]){this.segments=a}prepareSegment(a,u,f,g){let x=this.segments[this.segments.length-1];return a>ei.MAX_VERTEX_ARRAY_LENGTH&&or(`Max vertices per segment is ${ei.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!x||x.vertexLength+a>ei.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==g)&&(x={vertexOffset:u.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},g!==void 0&&(x.sortKey=g),this.segments.push(x)),x}get(){return this.segments}destroy(){for(const a of this.segments)for(const u in a.vaos)a.vaos[u].destroy()}static simpleSegment(a,u,f,g){return new ei([{vertexOffset:a,primitiveOffset:u,vertexLength:f,primitiveLength:g,vaos:{},sortKey:0}])}}ei.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Vt(ei,"SegmentVector");var nr=8192;class Eu{constructor(a,u){a&&(u?this.setSouthWest(a).setNorthEast(u):a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))}setNorthEast(a){return this._ne=a instanceof on?new on(a.lng,a.lat):on.convert(a),this}setSouthWest(a){return this._sw=a instanceof on?new on(a.lng,a.lat):on.convert(a),this}extend(a){const u=this._sw,f=this._ne;let g,x;if(a instanceof on)g=a,x=a;else{if(!(a instanceof Eu))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(Eu.convert(a)):this.extend(on.convert(a)):typeof a=="object"&&a!==null&&a.hasOwnProperty("lat")&&(a.hasOwnProperty("lon")||a.hasOwnProperty("lng"))?this.extend(on.convert(a)):this;if(g=a._sw,x=a._ne,!g||!x)return this}return u||f?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),f.lng=Math.max(x.lng,f.lng),f.lat=Math.max(x.lat,f.lat)):(this._sw=new on(g.lng,g.lat),this._ne=new on(x.lng,x.lat)),this}getCenter(){return new on((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new on(this.getWest(),this.getNorth())}getSouthEast(){return new on(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:u,lat:f}=on.convert(a);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(a){return!a||a instanceof Eu?a:new Eu(a)}}var Qb=1e-6,ra=typeof Float32Array<"u"?Float32Array:Array;function eR(){var c=new ra(9);return ra!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function tR(c,a,u){var f=a[0],g=a[1],x=a[2],S=a[3],j=a[4],A=a[5],M=a[6],$=a[7],V=a[8],G=u[0],Y=u[1],J=u[2],ne=u[3],ce=u[4],ye=u[5],Pe=u[6],ve=u[7],Te=u[8];return c[0]=G*f+Y*S+J*M,c[1]=G*g+Y*j+J*$,c[2]=G*x+Y*A+J*V,c[3]=ne*f+ce*S+ye*M,c[4]=ne*g+ce*j+ye*$,c[5]=ne*x+ce*A+ye*V,c[6]=Pe*f+ve*S+Te*M,c[7]=Pe*g+ve*j+Te*$,c[8]=Pe*x+ve*A+Te*V,c}function Do(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function yT(c,a){var u=a[0],f=a[1],g=a[2],x=a[3],S=a[4],j=a[5],A=a[6],M=a[7],$=a[8],V=a[9],G=a[10],Y=a[11],J=a[12],ne=a[13],ce=a[14],ye=a[15],Pe=u*j-f*S,ve=u*A-g*S,Te=u*M-x*S,Ie=f*A-g*j,Me=f*M-x*j,Ye=g*M-x*A,Xe=$*ne-V*J,lt=$*ce-G*J,St=$*ye-Y*J,Qe=V*ce-G*ne,pt=V*ye-Y*ne,mt=G*ye-Y*ce,bt=Pe*mt-ve*pt+Te*Qe+Ie*St-Me*lt+Ye*Xe;return bt?(c[0]=(j*mt-A*pt+M*Qe)*(bt=1/bt),c[1]=(g*pt-f*mt-x*Qe)*bt,c[2]=(ne*Ye-ce*Me+ye*Ie)*bt,c[3]=(G*Me-V*Ye-Y*Ie)*bt,c[4]=(A*St-S*mt-M*lt)*bt,c[5]=(u*mt-g*St+x*lt)*bt,c[6]=(ce*Te-J*Ye-ye*ve)*bt,c[7]=($*Ye-G*Te+Y*ve)*bt,c[8]=(S*pt-j*St+M*Xe)*bt,c[9]=(f*St-u*pt-x*Xe)*bt,c[10]=(J*Me-ne*Te+ye*Pe)*bt,c[11]=(V*Te-$*Me-Y*Pe)*bt,c[12]=(j*lt-S*Qe-A*Xe)*bt,c[13]=(u*Qe-f*lt+g*Xe)*bt,c[14]=(ne*ve-J*Ie-ce*Pe)*bt,c[15]=($*Ie-V*ve+G*Pe)*bt,c):null}function hh(c,a,u){var f=a[0],g=a[1],x=a[2],S=a[3],j=a[4],A=a[5],M=a[6],$=a[7],V=a[8],G=a[9],Y=a[10],J=a[11],ne=a[12],ce=a[13],ye=a[14],Pe=a[15],ve=u[0],Te=u[1],Ie=u[2],Me=u[3];return c[0]=ve*f+Te*j+Ie*V+Me*ne,c[1]=ve*g+Te*A+Ie*G+Me*ce,c[2]=ve*x+Te*M+Ie*Y+Me*ye,c[3]=ve*S+Te*$+Ie*J+Me*Pe,c[4]=(ve=u[4])*f+(Te=u[5])*j+(Ie=u[6])*V+(Me=u[7])*ne,c[5]=ve*g+Te*A+Ie*G+Me*ce,c[6]=ve*x+Te*M+Ie*Y+Me*ye,c[7]=ve*S+Te*$+Ie*J+Me*Pe,c[8]=(ve=u[8])*f+(Te=u[9])*j+(Ie=u[10])*V+(Me=u[11])*ne,c[9]=ve*g+Te*A+Ie*G+Me*ce,c[10]=ve*x+Te*M+Ie*Y+Me*ye,c[11]=ve*S+Te*$+Ie*J+Me*Pe,c[12]=(ve=u[12])*f+(Te=u[13])*j+(Ie=u[14])*V+(Me=u[15])*ne,c[13]=ve*g+Te*A+Ie*G+Me*ce,c[14]=ve*x+Te*M+Ie*Y+Me*ye,c[15]=ve*S+Te*$+Ie*J+Me*Pe,c}function Oy(c,a,u){var f,g,x,S,j,A,M,$,V,G,Y,J,ne=u[0],ce=u[1],ye=u[2];return a===c?(c[12]=a[0]*ne+a[4]*ce+a[8]*ye+a[12],c[13]=a[1]*ne+a[5]*ce+a[9]*ye+a[13],c[14]=a[2]*ne+a[6]*ce+a[10]*ye+a[14],c[15]=a[3]*ne+a[7]*ce+a[11]*ye+a[15]):(g=a[1],x=a[2],S=a[3],j=a[4],A=a[5],M=a[6],$=a[7],V=a[8],G=a[9],Y=a[10],J=a[11],c[0]=f=a[0],c[1]=g,c[2]=x,c[3]=S,c[4]=j,c[5]=A,c[6]=M,c[7]=$,c[8]=V,c[9]=G,c[10]=Y,c[11]=J,c[12]=f*ne+j*ce+V*ye+a[12],c[13]=g*ne+A*ce+G*ye+a[13],c[14]=x*ne+M*ce+Y*ye+a[14],c[15]=S*ne+$*ce+J*ye+a[15]),c}function fh(c,a,u){var f=u[0],g=u[1],x=u[2];return c[0]=a[0]*f,c[1]=a[1]*f,c[2]=a[2]*f,c[3]=a[3]*f,c[4]=a[4]*g,c[5]=a[5]*g,c[6]=a[6]*g,c[7]=a[7]*g,c[8]=a[8]*x,c[9]=a[9]*x,c[10]=a[10]*x,c[11]=a[11]*x,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c}function vT(c,a,u){var f=Math.sin(u),g=Math.cos(u),x=a[4],S=a[5],j=a[6],A=a[7],M=a[8],$=a[9],V=a[10],G=a[11];return a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[4]=x*g+M*f,c[5]=S*g+$*f,c[6]=j*g+V*f,c[7]=A*g+G*f,c[8]=M*g-x*f,c[9]=$*g-S*f,c[10]=V*g-j*f,c[11]=G*g-A*f,c}function e_(c,a,u){var f=Math.sin(u),g=Math.cos(u),x=a[0],S=a[1],j=a[2],A=a[3],M=a[8],$=a[9],V=a[10],G=a[11];return a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=x*g-M*f,c[1]=S*g-$*f,c[2]=j*g-V*f,c[3]=A*g-G*f,c[8]=x*f+M*g,c[9]=S*f+$*g,c[10]=j*f+V*g,c[11]=A*f+G*g,c}function rR(c,a){return c[0]=a[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=a[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=a[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function nR(c,a,u){var f,g,x,S=u[0],j=u[1],A=u[2],M=Math.hypot(S,j,A);return M<Qb?null:(S*=M=1/M,j*=M,A*=M,f=Math.sin(a),g=Math.cos(a),c[0]=S*S*(x=1-g)+g,c[1]=j*S*x+A*f,c[2]=A*S*x-j*f,c[3]=0,c[4]=S*j*x-A*f,c[5]=j*j*x+g,c[6]=A*j*x+S*f,c[7]=0,c[8]=S*A*x+j*f,c[9]=j*A*x-S*f,c[10]=A*A*x+g,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}Math.hypot||(Math.hypot=function(){for(var c=0,a=arguments.length;a--;)c+=arguments[a]*arguments[a];return Math.sqrt(c)});var sY=hh;function xT(){var c=new ra(3);return ra!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function iR(c){var a=new ra(3);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a}function Ry(c){return Math.hypot(c[0],c[1],c[2])}function lp(c,a,u){var f=new ra(3);return f[0]=c,f[1]=a,f[2]=u,f}function uc(c,a,u){return c[0]=a[0]+u[0],c[1]=a[1]+u[1],c[2]=a[2]+u[2],c}function bT(c,a,u){return c[0]=a[0]-u[0],c[1]=a[1]-u[1],c[2]=a[2]-u[2],c}function sR(c,a,u){return c[0]=a[0]*u[0],c[1]=a[1]*u[1],c[2]=a[2]*u[2],c}function Dy(c,a,u){return c[0]=Math.min(a[0],u[0]),c[1]=Math.min(a[1],u[1]),c[2]=Math.min(a[2],u[2]),c}function Ly(c,a,u){return c[0]=Math.max(a[0],u[0]),c[1]=Math.max(a[1],u[1]),c[2]=Math.max(a[2],u[2]),c}function Sa(c,a,u){return c[0]=a[0]*u,c[1]=a[1]*u,c[2]=a[2]*u,c}function By(c,a,u,f){return c[0]=a[0]+u[0]*f,c[1]=a[1]+u[1]*f,c[2]=a[2]+u[2]*f,c}function xs(c,a){var u=a[0],f=a[1],g=a[2],x=u*u+f*f+g*g;return x>0&&(x=1/Math.sqrt(x)),c[0]=a[0]*x,c[1]=a[1]*x,c[2]=a[2]*x,c}function Za(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]}function _T(c,a,u){var f=a[0],g=a[1],x=a[2],S=u[0],j=u[1],A=u[2];return c[0]=g*A-x*j,c[1]=x*S-f*A,c[2]=f*j-g*S,c}function Hn(c,a,u){var f=a[0],g=a[1],x=a[2],S=u[3]*f+u[7]*g+u[11]*x+u[15];return c[0]=(u[0]*f+u[4]*g+u[8]*x+u[12])/(S=S||1),c[1]=(u[1]*f+u[5]*g+u[9]*x+u[13])/S,c[2]=(u[2]*f+u[6]*g+u[10]*x+u[14])/S,c}function aR(c,a,u){var f=u[0],g=u[1],x=u[2],S=a[0],j=a[1],A=a[2],M=g*A-x*j,$=x*S-f*A,V=f*j-g*S,G=g*V-x*$,Y=x*M-f*V,J=f*$-g*M,ne=2*u[3];return $*=ne,V*=ne,Y*=2,J*=2,c[0]=S+(M*=ne)+(G*=2),c[1]=j+$+Y,c[2]=A+V+J,c}var zy,Lo=bT,aY=sR,oY=Ry;function oR(c,a,u){return c[0]=a[0]*u,c[1]=a[1]*u,c[2]=a[2]*u,c[3]=a[3]*u,c}function lR(c,a){var u=a[0],f=a[1],g=a[2],x=a[3],S=u*u+f*f+g*g+x*x;return S>0&&(S=1/Math.sqrt(S)),c[0]=u*S,c[1]=f*S,c[2]=g*S,c[3]=x*S,c}function ph(c,a,u){var f=a[0],g=a[1],x=a[2],S=a[3];return c[0]=u[0]*f+u[4]*g+u[8]*x+u[12]*S,c[1]=u[1]*f+u[5]*g+u[9]*x+u[13]*S,c[2]=u[2]*f+u[6]*g+u[10]*x+u[14]*S,c[3]=u[3]*f+u[7]*g+u[11]*x+u[15]*S,c}function cR(){var c=new ra(4);return ra!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function uR(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function dR(c,a,u){u*=.5;var f=a[0],g=a[1],x=a[2],S=a[3],j=Math.sin(u),A=Math.cos(u);return c[0]=f*A+S*j,c[1]=g*A+x*j,c[2]=x*A-g*j,c[3]=S*A-f*j,c}function hR(c,a,u){u*=.5;var f=a[0],g=a[1],x=a[2],S=a[3],j=Math.sin(u),A=Math.cos(u);return c[0]=f*A-x*j,c[1]=g*A+S*j,c[2]=x*A+f*j,c[3]=S*A-g*j,c}xT(),zy=new ra(4),ra!=Float32Array&&(zy[0]=0,zy[1]=0,zy[2]=0,zy[3]=0);var lY=lR;xT(),lp(1,0,0),lp(0,1,0),cR(),cR(),eR();const cY=Fe([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:fR}=cY,pR=Fe([{name:"a_pos_3",components:3,type:"Int16"}]);var $y=Fe([{name:"a_pos",type:"Int16",components:2}]);class wT{constructor(a,u){this.pos=a,this.dir=u}intersectsPlane(a,u,f){const g=Za(u,this.dir);if(Math.abs(g)<1e-6)return!1;const x=((a[0]-this.pos[0])*u[0]+(a[1]-this.pos[1])*u[1]+(a[2]-this.pos[2])*u[2])/g;return f[0]=this.pos[0]+this.dir[0]*x,f[1]=this.pos[1]+this.dir[1]*x,f[2]=this.pos[2]+this.dir[2]*x,!0}closestPointOnSphere(a,u,f){if(function(Y,J){var ne=Y[0],ce=Y[1],ye=Y[2],Pe=J[0],ve=J[1],Te=J[2];return Math.abs(ne-Pe)<=Qb*Math.max(1,Math.abs(ne),Math.abs(Pe))&&Math.abs(ce-ve)<=Qb*Math.max(1,Math.abs(ce),Math.abs(ve))&&Math.abs(ye-Te)<=Qb*Math.max(1,Math.abs(ye),Math.abs(Te))}(this.pos,a)||u===0)return f[0]=f[1]=f[2]=0,!1;const[g,x,S]=this.dir,j=this.pos[0]-a[0],A=this.pos[1]-a[1],M=this.pos[2]-a[2],$=g*g+x*x+S*S,V=2*(j*g+A*x+M*S),G=V*V-4*$*(j*j+A*A+M*M-u*u);if(G<0){const Y=Math.max(-V/2,0),J=j+g*Y,ne=A+x*Y,ce=M+S*Y,ye=Math.hypot(J,ne,ce);return f[0]=J*u/ye,f[1]=ne*u/ye,f[2]=ce*u/ye,!1}{const Y=(-V-Math.sqrt(G))/(2*$);if(Y<0){const J=Math.hypot(j,A,M);return f[0]=j*u/J,f[1]=A*u/J,f[2]=M*u/J,!1}return f[0]=j+g*Y,f[1]=A+x*Y,f[2]=M+S*Y,!0}}}class ST{constructor(a,u,f,g,x){this.TL=a,this.TR=u,this.BR=f,this.BL=g,this.horizon=x}static fromInvProjectionMatrix(a,u,f){const g=[-1,1,1],x=[1,1,1],S=[1,-1,1],j=[-1,-1,1],A=Hn(g,g,a),M=Hn(x,x,a),$=Hn(S,S,a),V=Hn(j,j,a);return new ST(A,M,$,V,u/f)}}class ET{constructor(a,u){this.points=a,this.planes=u}static fromInvProjectionMatrix(a,u,f,g){const x=Math.pow(2,f),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const M=ph([],A,a),$=1/M[3]/u*x;return function(V,G,Y){return V[0]=G[0]*Y[0],V[1]=G[1]*Y[1],V[2]=G[2]*Y[2],V[3]=G[3]*Y[3],V}(M,M,[$,$,g?1/M[3]:$,$])}),j=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const M=xs([],_T([],Lo([],S[A[0]],S[A[1]]),Lo([],S[A[2]],S[A[1]]))),$=-Za(M,S[A[1]]);return M.concat($)});return new ET(S,j)}}class bs{static fromPoints(a){const u=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const g of a)Dy(u,u,g),Ly(f,f,g);return new bs(u,f)}static applyTransform(a,u){const f=a.getCorners();for(let g=0;g<f.length;++g)Hn(f[g],f[g],u);return bs.fromPoints(f)}constructor(a,u){this.min=a,this.max=u,this.center=Sa([],uc([],this.min,this.max),.5)}quadrant(a){const u=[a%2==0,a<2],f=iR(this.min),g=iR(this.max);for(let x=0;x<u.length;x++)f[x]=u[x]?this.min[x]:this.center[x],g[x]=u[x]?this.center[x]:this.max[x];return g[2]=this.max[2],new bs(f,g)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}distanceZ(a){return Math.max(Math.min(this.max[2],a[2]),this.min[2])-a[2]}getCorners(){const a=this.min,u=this.max;return[[a[0],a[1],a[2]],[u[0],a[1],a[2]],[u[0],u[1],a[2]],[a[0],u[1],a[2]],[a[0],a[1],u[2]],[u[0],a[1],u[2]],[u[0],u[1],u[2]],[a[0],u[1],u[2]]]}intersects(a){const u=this.getCorners();let f=!0;for(let g=0;g<a.planes.length;g++){const x=a.planes[g];let S=0;for(let j=0;j<u.length;j++)S+=Za(x,u[j])+x[3]>=0;if(S===0)return 0;S!==u.length&&(f=!1)}if(f)return 2;for(let g=0;g<3;g++){let x=Number.MAX_VALUE,S=-Number.MAX_VALUE;for(let j=0;j<a.points.length;j++){const A=a.points[j][g]-this.min[g];x=Math.min(x,A),S=Math.max(S,A)}if(S<0||x>this.max[g]-this.min[g])return 0}return 1}}const TT=5,mR=6,_l=nr/Math.PI/2,uY=16383,mh=64,Fy=[mh,32,16],Ya=-_l,Ja=_l,dY=[new bs([Ya,Ya,Ya],[Ja,Ja,Ja]),new bs([Ya,Ya,Ya],[0,0,Ja]),new bs([0,Ya,Ya],[Ja,0,Ja]),new bs([Ya,0,Ya],[0,Ja,Ja]),new bs([0,0,Ya],[Ja,Ja,Ja])];function t_(c){return c*_l/qy}function gR(c,a,u,f=!0){const g=Sa([],c._camera.position,c.worldSize),x=[a,u,1,1];ph(x,x,c.pixelMatrixInverse),oR(x,x,1/x[3]);const S=xs([],Lo([],x,g)),j=c.globeMatrix,A=[j[12],j[13],j[14]],M=Lo([],A,g),$=Ry(M),V=xs([],M),G=c.worldSize/(2*Math.PI),Y=Za(V,S),J=Math.asin(G/$);if(J<Math.acos(Y)){if(!f)return null;const St=[],Qe=[];Sa(St,S,$/Y),xs(Qe,Lo(Qe,St,M)),xs(S,uc(S,M,Sa(S,Qe,Math.tan(J)*$)))}const ne=[];new wT(g,S).closestPointOnSphere(A,G,ne);const ce=xs([],ms(j,0)),ye=xs([],ms(j,1)),Pe=xs([],ms(j,2)),ve=Za(ce,ne),Te=Za(ye,ne),Ie=Za(Pe,ne),Me=ue(Math.asin(-Te/G));let Ye=ue(Math.atan2(ve,Ie));Ye=c.center.lng+function(St,Qe){const pt=(Qe-St+180)%360-180;return pt<-180?pt+360:pt}(c.center.lng,Ye);const Xe=Sl(Ye),lt=me(El(Me),0,1);return new hp(Xe,lt)}class hY{constructor(a,u,f){this.a=Lo([],a,f),this.b=Lo([],u,f),this.center=f;const g=xs([],this.a),x=xs([],this.b);this.angle=Math.acos(Za(g,x))}}function jT(c,a){if(c.angle===0)return null;let u;return u=c.a[a]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[a]/c.a[a]/Math.sin(c.angle)-1/Math.tan(c.angle)),u<0||u>1?null:function(f,g,x,S){const j=Math.sin(x);return f*(Math.sin((1-S)*x)/j)+g*(Math.sin(S*x)/j)}(c.a[a],c.b[a],c.angle,me(u,0,1))+c.center[a]}function wl(c){if(c.z<=1)return dY[c.z+2*c.y+c.x];const a=CT(r_(c));return bs.fromPoints(a)}function gh(c,a,u){return Sa(c,c,1-u),By(c,c,a,u)}function yR(c,a){const u=dp(a.zoom);if(u===0)return wl(c);const f=r_(c),g=CT(f),x=Sl(f.getWest())*a.worldSize,S=Sl(f.getEast())*a.worldSize,j=El(f.getNorth())*a.worldSize,A=El(f.getSouth())*a.worldSize,M=[x,j,0],$=[S,j,0],V=[x,A,0],G=[S,A,0],Y=yT([],a.globeMatrix);return Hn(M,M,Y),Hn($,$,Y),Hn(V,V,Y),Hn(G,G,Y),g[0]=gh(g[0],V,u),g[1]=gh(g[1],G,u),g[2]=gh(g[2],$,u),g[3]=gh(g[3],M,u),bs.fromPoints(g)}function vR(c,a,u){for(const f of c)Hn(f,f,a),Sa(f,f,u)}function fY(c,a,u){const f=a/c.worldSize,g=c.globeMatrix;if(u.z<=1){const Xe=wl(u).getCorners();return vR(Xe,g,f),bs.fromPoints(Xe)}const x=r_(u),S=CT(x);vR(S,g,f);const j=Number.MAX_VALUE,A=[-j,-j,-j],M=[j,j,j];if(x.contains(c.center)){for(const St of S)Dy(M,M,St),Ly(A,A,St);A[2]=0;const Xe=c.point,lt=[Xe.x*f,Xe.y*f,0];return Dy(M,M,lt),Ly(A,A,lt),new bs(M,A)}const $=[g[12]*f,g[13]*f,g[14]*f],V=x.getCenter(),G=me(c.center.lat,-Zi,Zi),Y=me(V.lat,-Zi,Zi),J=Sl(c.center.lng),ne=El(G);let ce=J-Sl(V.lng);const ye=ne-El(Y);ce>.5?ce-=1:ce<-.5&&(ce+=1);let Pe=0;Math.abs(ce)>Math.abs(ye)?Pe=ce>=0?1:3:(Pe=ye>=0?0:2,By($,$,[g[4]*f,g[5]*f,g[6]*f],-Math.sin(ie(ye>=0?x.getSouth():x.getNorth()))*_l));const ve=S[Pe],Te=S[(Pe+1)%4],Ie=new hY(ve,Te,$),Me=[jT(Ie,0)||ve[0],jT(Ie,1)||ve[1],jT(Ie,2)||ve[2]],Ye=dp(c.zoom);if(Ye>0){const Xe=function({x:St,y:Qe,z:pt},mt,bt,At,st){const Dt=1/(1<<pt);let Gt=St*Dt,Bt=Gt+Dt,ur=Qe*Dt,Nt=ur+Dt,Qt=0;const dr=(Gt+Bt)/2-At;return dr>.5?Qt=-1:dr<-.5&&(Qt=1),Gt=((Gt+Qt)*mt-(At*=mt))*bt+At,Bt=((Bt+Qt)*mt-At)*bt+At,ur=(ur*mt-(st*=mt))*bt+st,Nt=(Nt*mt-st)*bt+st,[[Gt,Nt,0],[Bt,Nt,0],[Bt,ur,0],[Gt,ur,0]]}(u,a,c._pixelsPerMercatorPixel,J,ne);for(let St=0;St<S.length;St++)gh(S[St],Xe[St],Ye);const lt=uc([],Xe[Pe],Xe[(Pe+1)%4]);Sa(lt,lt,.5),gh(Me,lt,Ye)}for(const Xe of S)Dy(M,M,Xe),Ly(A,A,Xe);return M[2]=Math.min(ve[2],Te[2]),Dy(M,M,Me),Ly(A,A,Me),new bs(M,A)}function r_({x:c,y:a,z:u}){const f=1/(1<<u),g=new on(Ea(c*f),Ki((a+1)*f)),x=new on(Ea((c+1)*f),Ki(a*f));return new Eu(g,x)}function CT(c){const a=ie(c.getNorth()),u=ie(c.getSouth()),f=Math.cos(a),g=Math.cos(u),x=Math.sin(a),S=Math.sin(u),j=c.getWest(),A=c.getEast();return[cp(g,S,j),cp(g,S,A),cp(f,x,A),cp(f,x,j)]}function cp(c,a,u,f=_l){return u=ie(u),[c*Math.sin(u)*f,-a*f,c*Math.cos(u)*f]}function up(c,a,u){return cp(Math.cos(ie(c)),Math.sin(ie(c)),a,u)}function Uy(c,a,u,f){const g=1<<u.z,x=(c/nr+u.x)/g;return up(Ki((a/nr+u.y)/g),Ea(x),f)}function n_({min:c,max:a}){return uY/Math.max(a[0]-c[0],a[1]-c[1],a[2]-c[2])}const xR=new Float64Array(16);function Vy(c){const a=n_(c),u=rR(xR,[a,a,a]);return Oy(u,u,((f=[])[0]=-(g=c.min)[0],f[1]=-g[1],f[2]=-g[2],f));var f,g}function PT(c){const a=(f=c.min,(u=xR)[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=f[0],u[13]=f[1],u[14]=f[2],u[15]=1,u);var u,f;const g=1/n_(c);return fh(a,a,[g,g,g])}function bR(c,a,u,f,g){const x=function(A){const M=nr/(2*Math.PI);return A/(2*Math.PI)/M}(u),S=[c,a,-u/(2*Math.PI)],j=Do(new Float64Array(16));return Oy(j,j,S),fh(j,j,[x,x,x]),vT(j,j,ie(-g)),e_(j,j,ie(-f)),j}function dp(c){return ke(TT,mR,c)}function _R(c,a){const u=up(a.lat,a.lng),f=function(J){const ne=up(J._center.lat,J._center.lng);let ce=_T([],lp(0,1,0),ne);const ye=nR([],-J.angle,ne);ce=Hn(ce,ce,ye),nR(ye,-J._pitch,ce);const Pe=xs([],ne);return Sa(Pe,Pe,t_(J.cameraToCenterDistance/J.pixelsPerMeter)),Hn(Pe,Pe,ye),uc([],ne,Pe)}(c);return S=(g=bT([],f,u))[0],j=g[1],A=g[2],M=(x=u)[0],$=x[1],V=x[2],Y=(G=Math.sqrt(S*S+j*j+A*A)*Math.sqrt(M*M+$*$+V*V))&&Za(g,x)/G,Math.acos(Math.min(Math.max(Y,-1),1));var g,x,S,j,A,M,$,V,G,Y}function AT(c,a){return _R(c,a)>Math.PI/2*1.01}const wR=ie(85),pY=Math.cos(wR),mY=Math.sin(wR),qy=63710088e-1,SR=2*Math.PI*qy;class Tu{constructor(a,u){if(isNaN(a)||isNaN(u))throw new Error(`Invalid LngLat object: (${a}, ${u})`);if(this.lng=+a,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Tu(Ne(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const u=Math.PI/180,f=this.lat*u,g=a.lat*u,x=Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos((a.lng-this.lng)*u);return qy*Math.acos(Math.min(x,1))}toBounds(a=0){const u=360*a/40075017,f=u/Math.cos(Math.PI/180*this.lat);return new Eu(new Tu(this.lng-f,this.lat-u),new Tu(this.lng+f,this.lat+u))}toEcef(a){const u=t_(a);return up(this.lat,this.lng,_l+u)}static convert(a){if(a instanceof Tu)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new Tu(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new Tu(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var on=Tu;function NT(c){return SR*Math.cos(c*Math.PI/180)}function Sl(c){return(180+c)/360}function El(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Bo(c,a){return c/NT(a)}function Ea(c){return 360*c-180}function Ki(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function ER(c,a){return c*NT(Ki(a))}const Zi=85.051129;function TR(c){return 1/Math.cos(c*Math.PI/180)}class hp{constructor(a,u,f=0){this.x=+a,this.y=+u,this.z=+f}static fromLngLat(a,u=0){const f=on.convert(a);return new hp(Sl(f.lng),El(f.lat),Bo(u,f.lat))}toLngLat(){return new on(Ea(this.x),Ki(this.y))}toAltitude(){return ER(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/SR*TR(Ki(this.y))}}function kT(c,a,u,f,g,x,S,j,A){const M=(a+f)/2,$=(u+g)/2,V=new W(M,$);j(V),function(G,Y,J,ne,ce,ye){const Pe=J-ce,ve=ne-ye;return Math.abs((ne-Y)*Pe-(J-G)*ve)/Math.hypot(Pe,ve)}(V.x,V.y,x.x,x.y,S.x,S.y)>=A?(kT(c,a,u,M,$,x,V,j,A),kT(c,M,$,f,g,V,S,j,A)):c.push(S)}function jR(c,a,u){let f=c[0],g=f.x,x=f.y;a(f);const S=[f];for(let j=1;j<c.length;j++){const A=c[j],{x:M,y:$}=A;a(A),kT(S,g,x,M,$,f,A,a,u),g=M,x=$,f=A}return S}function MT(c,a,u,f){if(f(a,u)){const g=a.add(u)._mult(.5);MT(c,a,g,f),MT(c,g,u,f)}else c.push(u)}function gY(c,a){let u=c[0];const f=[u];for(let g=1;g<c.length;g++){const x=c[g];MT(f,u,x,a),u=x}return f}const IT=Math.pow(2,14)-1,CR=-IT-1;function yY(c,a){const u=Math.round(c.x*a),f=Math.round(c.y*a);return c.x=me(u,CR,IT),c.y=me(f,CR,IT),(u<c.x||u>c.x+1||f<c.y||f>c.y+1)&&or("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function dc(c,a,u){const f=c.loadGeometry(),g=c.extent,x=nr/g;if(a&&u&&u.projection.isReprojectedInTileSpace){const S=1<<a.z,{scale:j,x:A,y:M,projection:$}=u,V=G=>{const Y=Ea((a.x+G.x/g)/S),J=Ki((a.y+G.y/g)/S),ne=$.project(Y,J);G.x=(ne.x*j-A)*g,G.y=(ne.y*j-M)*g};for(let G=0;G<f.length;G++)if(c.type!==1)f[G]=jR(f[G],V,1);else{const Y=[];for(const J of f[G])J.x<0||J.x>=g||J.y<0||J.y>=g||(V(J),Y.push(J));f[G]=Y}}for(const S of f)for(const j of S)yY(j,x);return f}function yh(c,a){return{type:c.type,id:c.id,properties:c.properties,geometry:a?dc(c):[]}}function i_(c,a,u,f,g){c.emplaceBack(2*a+(f+1)/2,2*u+(g+1)/2)}function s_(c,a,u){c.emplaceBack(a.x,a.y,a.z,u[0]*16384,u[1]*16384,u[2]*16384)}class OT{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.projection=a.projection,this.layoutVertexArray=new wt,this.indexArray=new Yt,this.segments=new ei,this.programConfigurations=new dh(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,f,g){const x=this.layers[0],S=[];let j=null;x.type==="circle"&&(j=x.layout.get("circle-sort-key"));for(const{feature:M,id:$,index:V,sourceLayerIndex:G}of a){const Y=this.layers[0]._featureFilter.needGeometry,J=yh(M,Y);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),J,f))continue;const ne=j?j.evaluate(J,{},f):void 0,ce={id:$,properties:M.properties,type:M.type,sourceLayerIndex:G,index:V,geometry:Y?J.geometry:dc(M,f,g),patterns:{},sortKey:ne};S.push(ce)}j&&S.sort((M,$)=>M.sortKey-$.sortKey);let A=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new Et,A=g.projection);for(const M of S){const{geometry:$,index:V,sourceLayerIndex:G}=M,Y=a[V].feature;this.addFeature(M,$,V,u.availableImages,f,A),u.featureIndex.insert(Y,$,V,G,this.index)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,nY.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,iY.members))),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(a,u,f,g,x,S){for(const j of u)for(const A of j){const M=A.x,$=A.y;if(M<0||M>=nr||$<0||$>=nr)continue;if(S){const Y=S.projectTilePoint(M,$,x),J=S.upVector(x,M,$),ne=this.globeExtVertexArray;s_(ne,Y,J),s_(ne,Y,J),s_(ne,Y,J),s_(ne,Y,J)}const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),G=V.vertexLength;i_(this.layoutVertexArray,M,$,-1,-1),i_(this.layoutVertexArray,M,$,1,-1),i_(this.layoutVertexArray,M,$,1,1),i_(this.layoutVertexArray,M,$,-1,1),this.indexArray.emplaceBack(G,G+1,G+2),this.indexArray.emplaceBack(G,G+2,G+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{},g,x)}}function PR(c,a){for(let u=0;u<c.length;u++)if(vh(a,c[u]))return!0;for(let u=0;u<a.length;u++)if(vh(c,a[u]))return!0;return!!RT(c,a)}function vY(c,a,u){return!!vh(c,a)||!!DT(a,c,u)}function AR(c,a){if(c.length===1)return kR(a,c[0]);for(let u=0;u<a.length;u++){const f=a[u];for(let g=0;g<f.length;g++)if(vh(c,f[g]))return!0}for(let u=0;u<c.length;u++)if(kR(a,c[u]))return!0;for(let u=0;u<a.length;u++)if(RT(c,a[u]))return!0;return!1}function xY(c,a,u){if(c.length>1){if(RT(c,a))return!0;for(let f=0;f<a.length;f++)if(DT(a[f],c,u))return!0}for(let f=0;f<c.length;f++)if(DT(c[f],a,u))return!0;return!1}function RT(c,a){if(c.length===0||a.length===0)return!1;for(let u=0;u<c.length-1;u++){const f=c[u],g=c[u+1];for(let x=0;x<a.length-1;x++)if(bY(f,g,a[x],a[x+1]))return!0}return!1}function bY(c,a,u,f){return Sr(c,u,f)!==Sr(a,u,f)&&Sr(c,a,u)!==Sr(c,a,f)}function DT(c,a,u){const f=u*u;if(a.length===1)return c.distSqr(a[0])<f;for(let g=1;g<a.length;g++)if(NR(c,a[g-1],a[g])<f)return!0;return!1}function NR(c,a,u){const f=a.distSqr(u);if(f===0)return c.distSqr(a);const g=((c.x-a.x)*(u.x-a.x)+(c.y-a.y)*(u.y-a.y))/f;return c.distSqr(g<0?a:g>1?u:u.sub(a)._mult(g)._add(a))}function kR(c,a){let u,f,g,x=!1;for(let S=0;S<c.length;S++){u=c[S];for(let j=0,A=u.length-1;j<u.length;A=j++)f=u[j],g=u[A],f.y>a.y!=g.y>a.y&&a.x<(g.x-f.x)*(a.y-f.y)/(g.y-f.y)+f.x&&(x=!x)}return x}function vh(c,a){let u=!1;for(let f=0,g=c.length-1;f<c.length;g=f++){const x=c[f],S=c[g];x.y>a.y!=S.y>a.y&&a.x<(S.x-x.x)*(a.y-x.y)/(S.y-x.y)+x.x&&(u=!u)}return u}function MR(c,a,u,f,g){for(const S of c)if(a<=S.x&&u<=S.y&&f>=S.x&&g>=S.y)return!0;const x=[new W(a,u),new W(a,g),new W(f,g),new W(f,u)];if(c.length>2){for(const S of x)if(vh(c,S))return!0}for(let S=0;S<c.length-1;S++)if(_Y(c[S],c[S+1],x))return!0;return!1}function _Y(c,a,u){const f=u[0],g=u[2];if(c.x<f.x&&a.x<f.x||c.x>g.x&&a.x>g.x||c.y<f.y&&a.y<f.y||c.y>g.y&&a.y>g.y)return!1;const x=Sr(c,a,u[0]);return x!==Sr(c,a,u[1])||x!==Sr(c,a,u[2])||x!==Sr(c,a,u[3])}function fp(c,a,u){const f=a.paint.get(c).value;return f.kind==="constant"?f.value:u.programConfigurations.get(a.id).getMaxValue(c)}function a_(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function IR(c,a,u,f,g){if(!a[0]&&!a[1])return c;const x=W.convert(a)._mult(g);u==="viewport"&&x._rotate(-f);const S=[];for(let j=0;j<c.length;j++)S.push(c[j].sub(x));return S}function OR(c,a,u,f){const g=W.convert(c)._mult(f);return a==="viewport"&&g._rotate(-u),g}Vt(OT,"CircleBucket",{omit:["layers"]});const wY=new Se({"circle-sort-key":new de(ot.layout_circle["circle-sort-key"])});var SY={paint:new Se({"circle-radius":new de(ot.paint_circle["circle-radius"]),"circle-color":new de(ot.paint_circle["circle-color"]),"circle-blur":new de(ot.paint_circle["circle-blur"]),"circle-opacity":new de(ot.paint_circle["circle-opacity"]),"circle-translate":new ee(ot.paint_circle["circle-translate"]),"circle-translate-anchor":new ee(ot.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ee(ot.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ee(ot.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new de(ot.paint_circle["circle-stroke-width"]),"circle-stroke-color":new de(ot.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new de(ot.paint_circle["circle-stroke-opacity"])}),layout:wY};function RR(c,a,u,f,g,x,S,j,A){if(x&&c.queryGeometry.isAboveHorizon)return!1;x&&(A*=c.pixelToTileUnitsFactor);const M=c.tileID.canonical,$=u.projection.upVectorScale(M,u.center.lat,u.worldSize).metersToTile;for(const V of a)for(const G of V){const Y=G.add(j),J=g&&u.elevation?u.elevation.exaggeration()*g.getElevationAt(Y.x,Y.y,!0):0,ne=u.projection.projectTilePoint(Y.x,Y.y,M);if(J>0){const ve=u.projection.upVector(M,Y.x,Y.y);ne.x+=ve[0]*$*J,ne.y+=ve[1]*$*J,ne.z+=ve[2]*$*J}const ce=x?Y:EY(ne.x,ne.y,ne.z,f),ye=x?c.tilespaceRays.map(ve=>jY(ve,J)):c.queryGeometry.screenGeometry,Pe=ph([],[ne.x,ne.y,ne.z,1],f);if(!S&&x?A*=Pe[3]/u.cameraToCenterDistance:S&&!x&&(A*=u.cameraToCenterDistance/Pe[3]),x){const ve=Ki((G.y/nr+M.y)/(1<<M.z));A/=u.projection.pixelsPerMeter(ve,1)/Bo(1,ve)}if(vY(ye,ce,A))return!0}return!1}function EY(c,a,u,f){const g=ph([],[c,a,u,1],f);return new W(g[0]/g[3],g[1]/g[3])}const DR=lp(0,0,0),TY=lp(0,0,1);function jY(c,a){const u=xT();return DR[2]=a,c.intersectsPlane(DR,TY,u),new W(u[0],u[1])}class LR extends OT{}function BR(c,{width:a,height:u},f,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==a*u*f)throw new RangeError("mismatched image size")}else g=new Uint8Array(a*u*f);return c.width=a,c.height=u,c.data=g,c}function zR(c,a,u){const{width:f,height:g}=a;f===c.width&&g===c.height||(LT(c,a,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,f),height:Math.min(c.height,g)},u),c.width=f,c.height=g,c.data=a.data)}function LT(c,a,u,f,g,x){if(g.width===0||g.height===0)return a;if(g.width>c.width||g.height>c.height||u.x>c.width-g.width||u.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>a.width||g.height>a.height||f.x>a.width-g.width||f.y>a.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const S=c.data,j=a.data;for(let A=0;A<g.height;A++){const M=((u.y+A)*c.width+u.x)*x,$=((f.y+A)*a.width+f.x)*x;for(let V=0;V<g.width*x;V++)j[$+V]=S[M+V]}return a}Vt(LR,"HeatmapBucket",{omit:["layers"]});class hc{constructor(a,u){BR(this,a,1,u)}resize(a){zR(this,new hc(a),1)}clone(){return new hc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,f,g,x){LT(a,u,f,g,x,1)}}class na{constructor(a,u){BR(this,a,4,u)}resize(a){zR(this,new na(a),4)}replace(a,u){u?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new na({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,f,g,x){LT(a,u,f,g,x,4)}}Vt(hc,"AlphaImage"),Vt(na,"RGBAImage");var CY={paint:new Se({"heatmap-radius":new de(ot.paint_heatmap["heatmap-radius"]),"heatmap-weight":new de(ot.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ee(ot.paint_heatmap["heatmap-intensity"]),"heatmap-color":new we(ot.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ee(ot.paint_heatmap["heatmap-opacity"])})};function BT(c){const a={},u=c.resolution||256,f=c.clips?c.clips.length:1,g=c.image||new na({width:u,height:f}),x=(S,j,A)=>{a[c.evaluationKey]=A;const M=c.expression.evaluate(a);g.data[S+j+0]=Math.floor(255*M.r/M.a),g.data[S+j+1]=Math.floor(255*M.g/M.a),g.data[S+j+2]=Math.floor(255*M.b/M.a),g.data[S+j+3]=Math.floor(255*M.a)};if(c.clips)for(let S=0,j=0;S<f;++S,j+=4*u)for(let A=0,M=0;A<u;A++,M+=4){const $=A/(u-1),{start:V,end:G}=c.clips[S];x(j,M,V*(1-$)+G*$)}else for(let S=0,j=0;S<u;S++,j+=4)x(0,j,S/(u-1));return g}var PY={paint:new Se({"hillshade-illumination-direction":new ee(ot.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ee(ot.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ee(ot.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ee(ot.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ee(ot.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ee(ot.paint_hillshade["hillshade-accent-color"])})};const AY=Fe([{name:"a_pos",components:2,type:"Int16"}],4),{members:NY}=AY;var zT={exports:{}};function o_(c,a,u){u=u||2;var f,g,x,S,j,A,M,$=a&&a.length,V=$?a[0]*u:c.length,G=$R(c,0,V,u,!0),Y=[];if(!G||G.next===G.prev)return Y;if($&&(G=function(ne,ce,ye,Pe){var ve,Te,Ie,Me=[];for(ve=0,Te=ce.length;ve<Te;ve++)(Ie=$R(ne,ce[ve]*Pe,ve<Te-1?ce[ve+1]*Pe:ne.length,Pe,!1))===Ie.next&&(Ie.steiner=!0),Me.push(BY(Ie));for(Me.sort(RY),ve=0;ve<Me.length;ve++)ye=DY(Me[ve],ye);return ye}(c,a,G,u)),c.length>80*u){f=x=c[0],g=S=c[1];for(var J=u;J<V;J+=u)(j=c[J])<f&&(f=j),(A=c[J+1])<g&&(g=A),j>x&&(x=j),A>S&&(S=A);M=(M=Math.max(x-f,S-g))!==0?32767/M:0}return Wy(G,Y,u,f,g,M,0),Y}function $R(c,a,u,f,g){var x,S;if(g===UT(c,a,u,f)>0)for(x=a;x<u;x+=f)S=VR(x,c[x],c[x+1],S);else for(x=u-f;x>=a;x-=f)S=VR(x,c[x],c[x+1],S);return S&&l_(S,S.next)&&(Hy(S),S=S.next),S}function xh(c,a){if(!c)return c;a||(a=c);var u,f=c;do if(u=!1,f.steiner||!l_(f,f.next)&&ti(f.prev,f,f.next)!==0)f=f.next;else{if(Hy(f),(f=a=f.prev)===f.next)break;u=!0}while(u||f!==a);return a}function Wy(c,a,u,f,g,x,S){if(c){!S&&x&&function($,V,G,Y){var J=$;do J.z===0&&(J.z=$T(J.x,J.y,V,G,Y)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==$);J.prevZ.nextZ=null,J.prevZ=null,function(ne){var ce,ye,Pe,ve,Te,Ie,Me,Ye,Xe=1;do{for(ye=ne,ne=null,Te=null,Ie=0;ye;){for(Ie++,Pe=ye,Me=0,ce=0;ce<Xe&&(Me++,Pe=Pe.nextZ);ce++);for(Ye=Xe;Me>0||Ye>0&&Pe;)Me!==0&&(Ye===0||!Pe||ye.z<=Pe.z)?(ve=ye,ye=ye.nextZ,Me--):(ve=Pe,Pe=Pe.nextZ,Ye--),Te?Te.nextZ=ve:ne=ve,ve.prevZ=Te,Te=ve;ye=Pe}Te.nextZ=null,Xe*=2}while(Ie>1)}(J)}(c,f,g,x);for(var j,A,M=c;c.prev!==c.next;)if(j=c.prev,A=c.next,x?MY(c,f,g,x):kY(c))a.push(j.i/u|0),a.push(c.i/u|0),a.push(A.i/u|0),Hy(c),c=A.next,M=A.next;else if((c=A)===M){S?S===1?Wy(c=IY(xh(c),a,u),a,u,f,g,x,2):S===2&&OY(c,a,u,f,g,x):Wy(xh(c),a,u,f,g,x,1);break}}}function kY(c){var a=c.prev,u=c,f=c.next;if(ti(a,u,f)>=0)return!1;for(var g=a.x,x=u.x,S=f.x,j=a.y,A=u.y,M=f.y,$=g<x?g<S?g:S:x<S?x:S,V=j<A?j<M?j:M:A<M?A:M,G=g>x?g>S?g:S:x>S?x:S,Y=j>A?j>M?j:M:A>M?A:M,J=f.next;J!==a;){if(J.x>=$&&J.x<=G&&J.y>=V&&J.y<=Y&&pp(g,j,x,A,S,M,J.x,J.y)&&ti(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function MY(c,a,u,f){var g=c.prev,x=c,S=c.next;if(ti(g,x,S)>=0)return!1;for(var j=g.x,A=x.x,M=S.x,$=g.y,V=x.y,G=S.y,Y=j<A?j<M?j:M:A<M?A:M,J=$<V?$<G?$:G:V<G?V:G,ne=j>A?j>M?j:M:A>M?A:M,ce=$>V?$>G?$:G:V>G?V:G,ye=$T(Y,J,a,u,f),Pe=$T(ne,ce,a,u,f),ve=c.prevZ,Te=c.nextZ;ve&&ve.z>=ye&&Te&&Te.z<=Pe;){if(ve.x>=Y&&ve.x<=ne&&ve.y>=J&&ve.y<=ce&&ve!==g&&ve!==S&&pp(j,$,A,V,M,G,ve.x,ve.y)&&ti(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,Te.x>=Y&&Te.x<=ne&&Te.y>=J&&Te.y<=ce&&Te!==g&&Te!==S&&pp(j,$,A,V,M,G,Te.x,Te.y)&&ti(Te.prev,Te,Te.next)>=0))return!1;Te=Te.nextZ}for(;ve&&ve.z>=ye;){if(ve.x>=Y&&ve.x<=ne&&ve.y>=J&&ve.y<=ce&&ve!==g&&ve!==S&&pp(j,$,A,V,M,G,ve.x,ve.y)&&ti(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;Te&&Te.z<=Pe;){if(Te.x>=Y&&Te.x<=ne&&Te.y>=J&&Te.y<=ce&&Te!==g&&Te!==S&&pp(j,$,A,V,M,G,Te.x,Te.y)&&ti(Te.prev,Te,Te.next)>=0)return!1;Te=Te.nextZ}return!0}function IY(c,a,u){var f=c;do{var g=f.prev,x=f.next.next;!l_(g,x)&&FR(g,f,f.next,x)&&Gy(g,x)&&Gy(x,g)&&(a.push(g.i/u|0),a.push(f.i/u|0),a.push(x.i/u|0),Hy(f),Hy(f.next),f=c=x),f=f.next}while(f!==c);return xh(f)}function OY(c,a,u,f,g,x){var S=c;do{for(var j=S.next.next;j!==S.prev;){if(S.i!==j.i&&zY(S,j)){var A=UR(S,j);return S=xh(S,S.next),A=xh(A,A.next),Wy(S,a,u,f,g,x,0),void Wy(A,a,u,f,g,x,0)}j=j.next}S=S.next}while(S!==c)}function RY(c,a){return c.x-a.x}function DY(c,a){var u=function(g,x){var S,j=x,A=g.x,M=g.y,$=-1/0;do{if(M<=j.y&&M>=j.next.y&&j.next.y!==j.y){var V=j.x+(M-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(V<=A&&V>$&&($=V,S=j.x<j.next.x?j:j.next,V===A))return S}j=j.next}while(j!==x);if(!S)return null;var G,Y=S,J=S.x,ne=S.y,ce=1/0;j=S;do A>=j.x&&j.x>=J&&A!==j.x&&pp(M<ne?A:$,M,J,ne,M<ne?$:A,M,j.x,j.y)&&(G=Math.abs(M-j.y)/(A-j.x),Gy(j,g)&&(G<ce||G===ce&&(j.x>S.x||j.x===S.x&&LY(S,j)))&&(S=j,ce=G)),j=j.next;while(j!==Y);return S}(c,a);if(!u)return a;var f=UR(u,c);return xh(f,f.next),xh(u,u.next)}function LY(c,a){return ti(c.prev,c,a.prev)<0&&ti(a.next,c,c.next)<0}function $T(c,a,u,f,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-u)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-f)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function BY(c){var a=c,u=c;do(a.x<u.x||a.x===u.x&&a.y<u.y)&&(u=a),a=a.next;while(a!==c);return u}function pp(c,a,u,f,g,x,S,j){return(g-S)*(a-j)>=(c-S)*(x-j)&&(c-S)*(f-j)>=(u-S)*(a-j)&&(u-S)*(x-j)>=(g-S)*(f-j)}function zY(c,a){return c.next.i!==a.i&&c.prev.i!==a.i&&!function(u,f){var g=u;do{if(g.i!==u.i&&g.next.i!==u.i&&g.i!==f.i&&g.next.i!==f.i&&FR(g,g.next,u,f))return!0;g=g.next}while(g!==u);return!1}(c,a)&&(Gy(c,a)&&Gy(a,c)&&function(u,f){var g=u,x=!1,S=(u.x+f.x)/2,j=(u.y+f.y)/2;do g.y>j!=g.next.y>j&&g.next.y!==g.y&&S<(g.next.x-g.x)*(j-g.y)/(g.next.y-g.y)+g.x&&(x=!x),g=g.next;while(g!==u);return x}(c,a)&&(ti(c.prev,c,a.prev)||ti(c,a.prev,a))||l_(c,a)&&ti(c.prev,c,c.next)>0&&ti(a.prev,a,a.next)>0)}function ti(c,a,u){return(a.y-c.y)*(u.x-a.x)-(a.x-c.x)*(u.y-a.y)}function l_(c,a){return c.x===a.x&&c.y===a.y}function FR(c,a,u,f){var g=u_(ti(c,a,u)),x=u_(ti(c,a,f)),S=u_(ti(u,f,c)),j=u_(ti(u,f,a));return g!==x&&S!==j||!(g!==0||!c_(c,u,a))||!(x!==0||!c_(c,f,a))||!(S!==0||!c_(u,c,f))||!(j!==0||!c_(u,a,f))}function c_(c,a,u){return a.x<=Math.max(c.x,u.x)&&a.x>=Math.min(c.x,u.x)&&a.y<=Math.max(c.y,u.y)&&a.y>=Math.min(c.y,u.y)}function u_(c){return c>0?1:c<0?-1:0}function Gy(c,a){return ti(c.prev,c,c.next)<0?ti(c,a,c.next)>=0&&ti(c,c.prev,a)>=0:ti(c,a,c.prev)<0||ti(c,c.next,a)<0}function UR(c,a){var u=new FT(c.i,c.x,c.y),f=new FT(a.i,a.x,a.y),g=c.next,x=a.prev;return c.next=a,a.prev=c,u.next=g,g.prev=u,f.next=u,u.prev=f,x.next=f,f.prev=x,f}function VR(c,a,u,f){var g=new FT(c,a,u);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function Hy(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function FT(c,a,u){this.i=c,this.x=a,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function UT(c,a,u,f){for(var g=0,x=a,S=u-f;x<u;x+=f)g+=(c[S]-c[x])*(c[x+1]+c[S+1]),S=x;return g}zT.exports=o_,zT.exports.default=o_,o_.deviation=function(c,a,u,f){var g=a&&a.length,x=Math.abs(UT(c,0,g?a[0]*u:c.length,u));if(g)for(var S=0,j=a.length;S<j;S++)x-=Math.abs(UT(c,a[S]*u,S<j-1?a[S+1]*u:c.length,u));var A=0;for(S=0;S<f.length;S+=3){var M=f[S]*u,$=f[S+1]*u,V=f[S+2]*u;A+=Math.abs((c[M]-c[V])*(c[$+1]-c[M+1])-(c[M]-c[$])*(c[V+1]-c[M+1]))}return x===0&&A===0?0:Math.abs((A-x)/x)},o_.flatten=function(c){for(var a=c[0][0].length,u={vertices:[],holes:[],dimensions:a},f=0,g=0;g<c.length;g++){for(var x=0;x<c[g].length;x++)for(var S=0;S<a;S++)u.vertices.push(c[g][x][S]);g>0&&u.holes.push(f+=c[g-1].length)}return u};var VT=B(zT.exports);function $Y(c,a,u,f,g){qR(c,a,u||0,f||c.length-1,g||FY)}function qR(c,a,u,f,g){for(;f>u;){if(f-u>600){var x=f-u+1,S=a-u+1,j=Math.log(x),A=.5*Math.exp(2*j/3),M=.5*Math.sqrt(j*A*(x-A)/x)*(S-x/2<0?-1:1);qR(c,a,Math.max(u,Math.floor(a-S*A/x+M)),Math.min(f,Math.floor(a+(x-S)*A/x+M)),g)}var $=c[a],V=u,G=f;for(Xy(c,u,a),g(c[f],$)>0&&Xy(c,u,f);V<G;){for(Xy(c,V,G),V++,G--;g(c[V],$)<0;)V++;for(;g(c[G],$)>0;)G--}g(c[u],$)===0?Xy(c,u,G):Xy(c,++G,f),G<=a&&(u=G+1),a<=G&&(f=G-1)}}function Xy(c,a,u){var f=c[a];c[a]=c[u],c[u]=f}function FY(c,a){return c<a?-1:c>a?1:0}function qT(c,a){const u=c.length;if(u<=1)return[c];const f=[];let g,x;for(let S=0;S<u;S++){const j=tn(c[S]);j!==0&&(c[S].area=Math.abs(j),x===void 0&&(x=j<0),x===j<0?(g&&f.push(g),g=[c[S]]):g.push(c[S]))}if(g&&f.push(g),a>1)for(let S=0;S<f.length;S++)f[S].length<=a||($Y(f[S],a,1,f[S].length-1,UY),f[S]=f[S].slice(0,a));return f}function UY(c,a){return a.area-c.area}function WT(c,a,u){const f=u.patternDependencies;let g=!1;for(const x of a){const S=x.paint.get(`${c}-pattern`);S.isConstant()||(g=!0);const j=S.constantOr(null);j&&(g=!0,f[j]=!0)}return g}function GT(c,a,u,f,g){const x=g.patternDependencies;for(const S of a){const j=S.paint.get(`${c}-pattern`).value;if(j.kind!=="constant"){let A=j.evaluate({zoom:f},u,{},g.availableImages);A=A&&A.name?A.name:A,x[A]=!0,u.patterns[S.id]=A}}return u}class d_{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new wt,this.indexArray=new Yt,this.indexArray2=new wi,this.programConfigurations=new dh(a.layers,a.zoom),this.segments=new ei,this.segments2=new ei,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.projection=a.projection}populate(a,u,f,g){this.hasPattern=WT("fill",this.layers,u);const x=this.layers[0].layout.get("fill-sort-key"),S=[];for(const{feature:j,id:A,index:M,sourceLayerIndex:$}of a){const V=this.layers[0]._featureFilter.needGeometry,G=yh(j,V);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),G,f))continue;const Y=x?x.evaluate(G,{},f,u.availableImages):void 0,J={id:A,properties:j.properties,type:j.type,sourceLayerIndex:$,index:M,geometry:V?G.geometry:dc(j,f,g),patterns:{},sortKey:Y};S.push(J)}x&&S.sort((j,A)=>j.sortKey-A.sortKey);for(const j of S){const{geometry:A,index:M,sourceLayerIndex:$}=j;if(this.hasPattern){const V=GT("fill",this.layers,j,this.zoom,u);this.patternFeatures.push(V)}else this.addFeature(j,A,M,f,{},u.availableImages);u.featureIndex.insert(a[M].feature,A,M,$,this.index)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}addFeatures(a,u,f,g,x){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,u,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,NY),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,u,f,g,x,S=[]){for(const j of qT(u,500)){let A=0;for(const J of j)A+=J.length;const M=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),$=M.vertexLength,V=[],G=[];for(const J of j){if(J.length===0)continue;J!==j[0]&&G.push(V.length/2);const ne=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),ce=ne.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(ce+J.length-1,ce),V.push(J[0].x),V.push(J[0].y);for(let ye=1;ye<J.length;ye++)this.layoutVertexArray.emplaceBack(J[ye].x,J[ye].y),this.indexArray2.emplaceBack(ce+ye-1,ce+ye),V.push(J[ye].x),V.push(J[ye].y);ne.vertexLength+=J.length,ne.primitiveLength+=J.length}const Y=VT(V,G);for(let J=0;J<Y.length;J+=3)this.indexArray.emplaceBack($+Y[J],$+Y[J+1],$+Y[J+2]);M.vertexLength+=A,M.primitiveLength+=Y.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,x,S,g)}}Vt(d_,"FillBucket",{omit:["layers","patternFeatures"]});const VY=new Se({"fill-sort-key":new de(ot.layout_fill["fill-sort-key"])});var qY={paint:new Se({"fill-antialias":new ee(ot.paint_fill["fill-antialias"]),"fill-opacity":new de(ot.paint_fill["fill-opacity"]),"fill-color":new de(ot.paint_fill["fill-color"]),"fill-outline-color":new de(ot.paint_fill["fill-outline-color"]),"fill-translate":new ee(ot.paint_fill["fill-translate"]),"fill-translate-anchor":new ee(ot.paint_fill["fill-translate-anchor"]),"fill-pattern":new de(ot.paint_fill["fill-pattern"])}),layout:VY};const WY=Fe([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),GY=Fe([{name:"a_centroid_pos",components:2,type:"Uint16"}]),HY=Fe([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:XY}=WY;var h_={},KY=Z,WR=mp;function mp(c,a,u,f,g){this.properties={},this.extent=u,this.type=0,this._pbf=c,this._geometry=-1,this._keys=f,this._values=g,c.readFields(ZY,this,a)}function ZY(c,a,u){c==1?a.id=u.readVarint():c==2?function(f,g){for(var x=f.readVarint()+f.pos;f.pos<x;){var S=g._keys[f.readVarint()],j=g._values[f.readVarint()];g.properties[S]=j}}(u,a):c==3?a.type=u.readVarint():c==4&&(a._geometry=u.pos)}function YY(c){for(var a,u,f=0,g=0,x=c.length,S=x-1;g<x;S=g++)f+=((u=c[S]).x-(a=c[g]).x)*(a.y+u.y);return f}mp.types=["Unknown","Point","LineString","Polygon"],mp.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var a,u=c.readVarint()+c.pos,f=1,g=0,x=0,S=0,j=[];c.pos<u;){if(g<=0){var A=c.readVarint();f=7&A,g=A>>3}if(g--,f===1||f===2)x+=c.readSVarint(),S+=c.readSVarint(),f===1&&(a&&j.push(a),a=[]),a.push(new KY(x,S));else{if(f!==7)throw new Error("unknown command "+f);a&&a.push(a[0].clone())}}return a&&j.push(a),j},mp.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var a=c.readVarint()+c.pos,u=1,f=0,g=0,x=0,S=1/0,j=-1/0,A=1/0,M=-1/0;c.pos<a;){if(f<=0){var $=c.readVarint();u=7&$,f=$>>3}if(f--,u===1||u===2)(g+=c.readSVarint())<S&&(S=g),g>j&&(j=g),(x+=c.readSVarint())<A&&(A=x),x>M&&(M=x);else if(u!==7)throw new Error("unknown command "+u)}return[S,A,j,M]},mp.prototype.toGeoJSON=function(c,a,u){var f,g,x=this.extent*Math.pow(2,u),S=this.extent*c,j=this.extent*a,A=this.loadGeometry(),M=mp.types[this.type];function $(Y){for(var J=0;J<Y.length;J++){var ne=Y[J];Y[J]=[360*(ne.x+S)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(ne.y+j)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(f=0;f<A.length;f++)V[f]=A[f][0];$(A=V);break;case 2:for(f=0;f<A.length;f++)$(A[f]);break;case 3:for(A=function(Y){var J=Y.length;if(J<=1)return[Y];for(var ne,ce,ye=[],Pe=0;Pe<J;Pe++){var ve=YY(Y[Pe]);ve!==0&&(ce===void 0&&(ce=ve<0),ce===ve<0?(ne&&ye.push(ne),ne=[Y[Pe]]):ne.push(Y[Pe]))}return ne&&ye.push(ne),ye}(A),f=0;f<A.length;f++)for(g=0;g<A[f].length;g++)$(A[f][g])}A.length===1?A=A[0]:M="Multi"+M;var G={type:"Feature",geometry:{type:M,coordinates:A},properties:this.properties};return"id"in this&&(G.id=this.id),G};var JY=WR,GR=HR;function HR(c,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(QY,this,a),this.length=this._features.length}function QY(c,a,u){c===15?a.version=u.readVarint():c===1?a.name=u.readString():c===5?a.extent=u.readVarint():c===2?a._features.push(u.pos):c===3?a._keys.push(u.readString()):c===4&&a._values.push(function(f){for(var g=null,x=f.readVarint()+f.pos;f.pos<x;){var S=f.readVarint()>>3;g=S===1?f.readString():S===2?f.readFloat():S===3?f.readDouble():S===4?f.readVarint64():S===5?f.readVarint():S===6?f.readSVarint():S===7?f.readBoolean():null}return g}(u))}HR.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var a=this._pbf.readVarint()+this._pbf.pos;return new JY(this._pbf,a,this.extent,this._keys,this._values)};var eJ=GR;function tJ(c,a,u){if(c===3){var f=new eJ(u,u.readVarint()+u.pos);f.length&&(a[f.name]=f)}}var HT=h_.VectorTile=function(c,a){this.layers=c.readFields(tJ,{},a)},f_=h_.VectorTileFeature=WR;function p_(c,a,u,f){const g=[],x=f===0?(S,j,A,M,$,V)=>{S.push(new W(V,A+(V-j)/(M-j)*($-A)))}:(S,j,A,M,$,V)=>{S.push(new W(j+(V-A)/($-A)*(M-j),V))};for(const S of c){const j=[];for(const A of S){if(A.length<=2)continue;const M=[];for(let G=0;G<A.length-1;G++){const Y=A[G].x,J=A[G].y,ne=A[G+1].x,ce=A[G+1].y,ye=f===0?Y:J,Pe=f===0?ne:ce;ye<a?Pe>a&&x(M,Y,J,ne,ce,a):ye>u?Pe<u&&x(M,Y,J,ne,ce,u):M.push(A[G]),Pe<a&&ye>=a&&x(M,Y,J,ne,ce,a),Pe>u&&ye<=u&&x(M,Y,J,ne,ce,u)}let $=A[A.length-1];const V=f===0?$.x:$.y;V>=a&&V<=u&&M.push($),M.length&&($=M[M.length-1],M[0].x===$.x&&M[0].y===$.y||M.push(M[0]),j.push(M))}j.length&&g.push(j)}return g}h_.VectorTileLayer=GR;const rJ=f_.types,nJ=Math.pow(2,13);function Ky(c,a,u,f,g,x,S,j){c.emplaceBack((a<<1)+S,(u<<1)+x,(Math.floor(f*nJ)<<1)+g,Math.round(j))}function Zy(c,a,u){c.emplaceBack(a.x,a.y,a.z,u[0]*16384,u[1]*16384,u[2]*16384)}class XR{constructor(){this.acc=new W(0,0),this.polyCount=[]}startRing(a){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new W(a.x,a.y),this.max=new W(a.x,a.y))}append(a,u){this.currentPolyCount.edges++,this.acc._add(a);const f=this.min,g=this.max;a.x<f.x?f.x=a.x:a.x>g.x&&(g.x=a.x),a.y<f.y?f.y=a.y:a.y>g.y&&(g.y=a.y),((a.x===0||a.x===nr)&&a.x===u.x)!=((a.y===0||a.y===nr)&&a.y===u.y)&&this.processBorderOverlap(a,u),u.x<0!=a.x<0&&this.addBorderIntersection(0,Or(u.y,a.y,(0-u.x)/(a.x-u.x))),u.x>nr!=a.x>nr&&this.addBorderIntersection(1,Or(u.y,a.y,(nr-u.x)/(a.x-u.x))),u.y<0!=a.y<0&&this.addBorderIntersection(2,Or(u.x,a.x,(0-u.y)/(a.y-u.y))),u.y>nr!=a.y>nr&&this.addBorderIntersection(3,Or(u.x,a.x,(nr-u.y)/(a.y-u.y)))}addBorderIntersection(a,u){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[a];u<f[0]&&(f[0]=u),u>f[1]&&(f[1]=u)}processBorderOverlap(a,u){if(a.x===u.x){if(a.y===u.y)return;const f=a.x===0?0:1;this.addBorderIntersection(f,u.y),this.addBorderIntersection(f,a.y)}else{const f=a.y===0?2:3;this.addBorderIntersection(f,u.x),this.addBorderIntersection(f,a.x)}}centroid(){const a=this.polyCount.reduce((u,f)=>u+f.edges,0);return a!==0?this.acc.div(a)._round():new W(0,0)}span(){return new W(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((a,u)=>a+ +(u[0]!==Number.MAX_VALUE),0)}}class Yy{constructor(a){this.zoom=a.zoom,this.canonical=a.canonical,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=a.projection,this.layoutVertexArray=new ht,this.centroidVertexArray=new Io,this.indexArray=new Yt,this.programConfigurations=new dh(a.layers,a.zoom),this.segments=new ei,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.enableTerrain=a.enableTerrain}populate(a,u,f,g){this.features=[],this.hasPattern=WT("fill-extrusion",this.layers,u),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(x){const S=Math.exp(Math.PI*(1-x.y/(1<<x.z)*2));return 80150034*S/(S*S+1)/nr/(1<<x.z)}(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:x,id:S,index:j,sourceLayerIndex:A}of a){const M=this.layers[0]._featureFilter.needGeometry,$=yh(x,M);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),$,f))continue;const V={id:S,sourceLayerIndex:A,index:j,geometry:M?$.geometry:dc(x,f,g),properties:x.properties,type:x.type,patterns:{}},G=this.layoutVertexArray.length;this.hasPattern?this.features.push(GT("fill-extrusion",this.layers,V,this.zoom,u)):this.addFeature(V,V.geometry,j,f,{},u.availableImages,g),u.featureIndex.insert(x,V.geometry,j,A,this.index,G)}this.sortBorders()}addFeatures(a,u,f,g,x){for(const S of this.features){const{geometry:j}=S;this.addFeature(S,j,S.index,u,f,g,x)}this.sortBorders()}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,XY),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=a.createVertexBuffer(this.layoutVertexExtArray,HY.members,!0))),this.programConfigurations.upload(a),this.uploaded=!0}uploadCentroid(a){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,GY.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,u,f,g,x,S,j){const A=[new W(0,0),new W(nr,nr)],M=j.projection,$=M.name==="globe",V=this.enableTerrain&&!$?new XR:null,G=rJ[a.type]==="Polygon";$&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Et);const Y=qT(u,500);for(let ye=Y.length-1;ye>=0;ye--){const Pe=Y[ye];(Pe.length===0||(J=Pe[0]).every(ve=>ve.x<=0)||J.every(ve=>ve.x>=nr)||J.every(ve=>ve.y<=0)||J.every(ve=>ve.y>=nr))&&Y.splice(ye,1)}var J;let ne;if($)ne=tD(Y,A,g);else{ne=[];for(const ye of Y)ne.push({polygon:ye,bounds:A})}const ce=G?this.edgeRadius:0;for(const{polygon:ye,bounds:Pe}of ne){let ve=0,Te=0;for(const Me of ye)G&&!Me[0].equals(Me[Me.length-1])&&Me.push(Me[0]),Te+=G?Me.length-1:Me.length;const Ie=this.segments.prepareSegment((G?5:4)*Te,this.layoutVertexArray,this.indexArray);if(G){const Me=[],Ye=[];ve=Ie.vertexLength;for(const lt of ye){let St,Qe;lt.length&&lt!==ye[0]&&Ye.push(Me.length/2),St=lt[1].sub(lt[0])._perp()._unit();for(let pt=1;pt<lt.length;pt++){const mt=lt[pt],bt=lt[pt===lt.length-1?1:pt+1];let{x:At,y:st}=mt;if(ce){Qe=bt.sub(mt)._perp()._unit();const Dt=St.add(Qe)._unit(),Gt=ce*Math.min(4,1/(St.x*Dt.x+St.y*Dt.y));At+=Gt*Dt.x,st+=Gt*Dt.y,St=Qe}Ky(this.layoutVertexArray,At,st,0,0,1,1,0),Ie.vertexLength++,Me.push(mt.x,mt.y),$&&Zy(this.layoutVertexExtArray,M.projectTilePoint(At,st,g),M.upVector(g,At,st))}}const Xe=VT(Me,Ye);for(let lt=0;lt<Xe.length;lt+=3)this.indexArray.emplaceBack(ve+Xe[lt],ve+Xe[lt+2],ve+Xe[lt+1]),Ie.primitiveLength++}for(const Me of ye){V&&Me.length&&V.startRing(Me[0]);let Ye,Xe,lt,St=Me.length>4&&JR(Me[Me.length-2],Me[0],Me[1]),Qe=ce?iJ(Me[Me.length-2],Me[0],Me[1],ce):0;Xe=Me[1].sub(Me[0])._perp()._unit();let pt=!0;for(let mt=1,bt=0;mt<Me.length;mt++){let At=Me[mt-1],st=Me[mt];const Dt=Me[mt===Me.length-1?1:mt+1];if(V&&G&&V.currentPolyCount.top++,YR(st,At,Pe)){ce&&(Xe=Dt.sub(st)._perp()._unit(),pt=!pt);continue}V&&V.append(st,At);const Gt=st.sub(At)._perp(),Bt=Gt.x/(Math.abs(Gt.x)+Math.abs(Gt.y)),ur=Gt.y>0?1:0,Nt=At.dist(st);if(bt+Nt>32768&&(bt=0),ce){lt=Dt.sub(st)._perp()._unit();let hr=ZR(At,st,Dt,KR(Xe,lt),ce);isNaN(hr)&&(hr=0);const ar=st.sub(At)._unit();At=At.add(ar.mult(Qe))._round(),st=st.add(ar.mult(-hr))._round(),Qe=hr,Xe=lt}const Qt=Ie.vertexLength,dr=Me.length>4&&JR(At,st,Dt);let zr=QR(bt,St,pt);if(Ky(this.layoutVertexArray,At.x,At.y,Bt,ur,0,0,zr),Ky(this.layoutVertexArray,At.x,At.y,Bt,ur,0,1,zr),bt+=Nt,zr=QR(bt,dr,!pt),St=dr,Ky(this.layoutVertexArray,st.x,st.y,Bt,ur,0,0,zr),Ky(this.layoutVertexArray,st.x,st.y,Bt,ur,0,1,zr),Ie.vertexLength+=4,this.indexArray.emplaceBack(Qt+0,Qt+1,Qt+2),this.indexArray.emplaceBack(Qt+1,Qt+3,Qt+2),Ie.primitiveLength+=2,ce){const hr=ve+(mt===1?Me.length-2:mt-2),ar=mt===1?ve:hr+1;if(this.indexArray.emplaceBack(Qt+1,hr,Qt+3),this.indexArray.emplaceBack(hr,ar,Qt+3),Ie.primitiveLength+=2,Ye===void 0&&(Ye=Qt),!YR(Dt,Me[mt],Pe)){const yn=mt===Me.length-1?Ye:Ie.vertexLength;this.indexArray.emplaceBack(Qt+2,Qt+3,yn),this.indexArray.emplaceBack(Qt+3,yn+1,yn),this.indexArray.emplaceBack(Qt+3,ar,yn+1),Ie.primitiveLength+=3}pt=!pt}if($){const hr=this.layoutVertexExtArray,ar=M.projectTilePoint(At.x,At.y,g),yn=M.projectTilePoint(st.x,st.y,g),gr=M.upVector(g,At.x,At.y),yr=M.upVector(g,st.x,st.y);Zy(hr,ar,gr),Zy(hr,ar,gr),Zy(hr,yn,yr),Zy(hr,yn,yr)}}G&&(ve+=Me.length-1)}}if(V&&V.polyCount.length>0){if(V.borders){V.vertexArrayOffset=this.centroidVertexArray.length;const ye=V.borders,Pe=this.featuresOnBorder.push(V)-1;for(let ve=0;ve<4;ve++)ye[ve][0]!==Number.MAX_VALUE&&this.borders[ve].push(Pe)}this.encodeCentroid(V.borders?void 0:V.centroid(),V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,x,S,g)}sortBorders(){for(let a=0;a<4;a++)this.borders[a].sort((u,f)=>this.featuresOnBorder[u].borders[a][0]-this.featuresOnBorder[f].borders[a][0])}encodeCentroid(a,u,f=!0){let g,x;if(a)if(a.y!==0){const j=u.span()._mult(this.tileToMeter);g=(Math.max(a.x,1)<<3)+Math.min(7,Math.round(j.x/10)),x=(Math.max(a.y,1)<<3)+Math.min(7,Math.round(j.y/10))}else g=Math.ceil(7*(a.x+450)),x=0;else g=0,x=+f;let S=f?this.centroidVertexArray.length:u.vertexArrayOffset;for(const j of u.polyCount){f&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*j.edges+j.top);for(let A=0;A<j.top;A++)this.centroidVertexArray.emplace(S++,g,x);for(let A=0;A<2*j.edges;A++)this.centroidVertexArray.emplace(S++,0,x),this.centroidVertexArray.emplace(S++,g,x)}}}function KR(c,a){const u=c.add(a)._unit();return c.x*u.x+c.y*u.y}function iJ(c,a,u,f){const g=a.sub(c)._perp()._unit(),x=u.sub(a)._perp()._unit();return ZR(c,a,u,KR(g,x),f)}function ZR(c,a,u,f,g){const x=Math.sqrt(1-f*f);return Math.min(c.dist(a)/3,a.dist(u)/3,g*x/f)}function YR(c,a,u){return c.x<u[0].x&&a.x<u[0].x||c.x>u[1].x&&a.x>u[1].x||c.y<u[0].y&&a.y<u[0].y||c.y>u[1].y&&a.y>u[1].y}function JR(c,a,u){if(c.x<0||c.x>=nr||a.x<0||a.x>=nr||u.x<0||u.x>=nr)return!1;const f=u.sub(a),g=f.perp(),x=c.sub(a);return(f.x*x.x+f.y*x.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(x.x*x.x+x.y*x.y))>-.866&&g.x*x.x+g.y*x.y<0}function QR(c,a,u){const f=a?2|c:-3&c;return u?1|f:-2&f}function eD(){const c=Math.PI/32,a=Math.tan(c),u=qy;return u*Math.sqrt(1+2*a*a)-u}function tD(c,a,u){const f=1<<u.z,g=Ea(u.x/f),x=Ea((u.x+1)/f),S=Ki(u.y/f),j=Ki((u.y+1)/f);return function(A,M,$,V,G=0,Y){const J=[];if(!A.length||!$||!V)return J;const ne=(Me,Ye)=>{for(const Xe of Me)J.push({polygon:Xe,bounds:Ye})},ce=Math.ceil(Math.log2($)),ye=Math.ceil(Math.log2(V)),Pe=ce-ye,ve=[];for(let Me=0;Me<Math.abs(Pe);Me++)ve.push(Pe>0?0:1);for(let Me=0;Me<Math.min(ce,ye);Me++)ve.push(0),ve.push(1);let Te=A;if(Te=p_(Te,M[0].y-G,M[1].y+G,1),Te=p_(Te,M[0].x-G,M[1].x+G,0),!Te.length)return J;const Ie=[];for(ve.length?Ie.push({polygons:Te,bounds:M,depth:0}):ne(Te,M);Ie.length;){const Me=Ie.pop(),Ye=Me.depth,Xe=ve[Ye],lt=Me.bounds[0],St=Me.bounds[1],Qe=Xe===0?lt.x:lt.y,pt=Xe===0?St.x:St.y,mt=Y?Y(Xe,Qe,pt):.5*(Qe+pt),bt=p_(Me.polygons,Qe-G,mt+G,Xe),At=p_(Me.polygons,mt-G,pt+G,Xe);if(bt.length){const st=[lt,new W(Xe===0?mt:St.x,Xe===1?mt:St.y)];ve.length>Ye+1?Ie.push({polygons:bt,bounds:st,depth:Ye+1}):ne(bt,st)}if(At.length){const st=[new W(Xe===0?mt:lt.x,Xe===1?mt:lt.y),St];ve.length>Ye+1?Ie.push({polygons:At,bounds:st,depth:Ye+1}):ne(At,st)}}return J}(c,a,Math.ceil((x-g)/11.25),Math.ceil((S-j)/11.25),1,(A,M,$)=>{if(A===0)return .5*(M+$);{const V=Ki((u.y+M/nr)/f);return(El(.5*(Ki((u.y+$/nr)/f)+V))*f-u.y)*nr}})}Vt(Yy,"FillExtrusionBucket",{omit:["layers","features"]}),Vt(XR,"PartMetadata");const sJ=new Se({"fill-extrusion-edge-radius":new ee(ot["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var aJ={paint:new Se({"fill-extrusion-opacity":new ee(ot["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new de(ot["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ee(ot["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ee(ot["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new de(ot["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new de(ot["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new de(ot["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ee(ot["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ee(ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ee(ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ee(ot["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:sJ};function rD(c,a,u){var f=2*Math.PI*6378137/256/Math.pow(2,u);return[c*f-2*Math.PI*6378137/2,a*f-2*Math.PI*6378137/2]}class m_{constructor(a,u,f){this.z=a,this.x=u,this.y=f,this.key=Jy(0,a,a,u,f)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,u){const f=function(x,S,j){var A=rD(256*x,256*(S=Math.pow(2,j)-S-1),j),M=rD(256*(x+1),256*(S+1),j);return A[0]+","+A[1]+","+M[0]+","+M[1]}(this.x,this.y,this.z),g=function(x,S,j){let A,M="";for(let $=x;$>0;$--)A=1<<$-1,M+=(S&A?1:0)+(j&A?2:0);return M}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class nD{constructor(a,u){this.wrap=a,this.canonical=u,this.key=Jy(a,u.z,u.z,u.x,u.y)}}class _s{constructor(a,u,f,g,x){this.overscaledZ=a,this.wrap=u,this.canonical=new m_(f,+g,+x),this.key=u===0&&a===f?this.canonical.key:Jy(u,a,f,g,x)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){const u=this.canonical.z-a;return a>this.canonical.z?new _s(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new _s(a,this.wrap,a,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(a,u=!0){if(this.overscaledZ===a&&u)return this.key;if(a>this.canonical.z)return Jy(this.wrap*+u,a,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-a;return Jy(this.wrap*+u,a,a,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(a){if(a.wrap!==this.wrap)return!1;const u=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>u&&a.canonical.y===this.canonical.y>>u}children(a){if(this.overscaledZ>=a)return[new _s(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,g=2*this.canonical.y;return[new _s(u,this.wrap,u,f,g),new _s(u,this.wrap,u,f+1,g),new _s(u,this.wrap,u,f,g+1),new _s(u,this.wrap,u,f+1,g+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new _s(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new _s(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new nD(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Jy(c,a,u,f,g){const x=1<<Math.min(u,22);let S=x*(g%x)+f%x;return c&&u<22&&(S+=x*x*((c<0?-2*c-1:2*c)%(1<<2*(22-u)))),16*(32*S+u)+(a-u)}Vt(m_,"CanonicalTileID"),Vt(_s,"OverscaledTileID",{omit:["projMatrix"]});class gp extends W{constructor(a,u,f){super(a,u),this.z=f}}function Qy(c,a){return c.x*a.x+c.y*a.y}function iD(c,a){if(c.length===1){let u=0;const f=a[u++];let g;for(;!g||f.equals(g);)if(g=a[u++],!g)return 1/0;for(;u<a.length;u++){const x=a[u],S=c[0],j=g.sub(f),A=x.sub(f),M=S.sub(f),$=Qy(j,j),V=Qy(j,A),G=Qy(A,A),Y=Qy(M,j),J=Qy(M,A),ne=$*G-V*V,ce=(G*Y-V*J)/ne,ye=($*J-V*Y)/ne,Pe=f.z*(1-ce-ye)+g.z*ce+x.z*ye;if(isFinite(Pe))return Pe}return 1/0}{let u=1/0;for(const f of a)u=Math.min(u,f.z);return u}}function sD(c,a,u,f,g,x,S,j){const A=S*g.getElevationAt(c,a,!0,!0),M=x[0]!==0,$=M?x[1]===0?S*(x[0]/7-450):S*function(V,G,Y){const J=Math.floor(G[0]/8),ne=Math.floor(G[1]/8),ce=10*(G[0]-8*J),ye=10*(G[1]-8*ne),Pe=V.getElevationAt(J,ne,!0,!0),ve=V.getMeterToDEM(Y),Te=Math.floor(.5*(ce*ve-1)),Ie=Math.floor(.5*(ye*ve-1)),Me=V.tileCoordToPixel(J,ne),Ye=2*Te+1,Xe=2*Ie+1,lt=function(At,st,Dt,Gt,Bt){return[At.getElevationAtPixel(st,Dt,!0),At.getElevationAtPixel(st+Bt,Dt,!0),At.getElevationAtPixel(st,Dt+Bt,!0),At.getElevationAtPixel(st+Gt,Dt+Bt,!0)]}(V,Me.x-Te,Me.y-Ie,Ye,Xe),St=Math.abs(lt[0]-lt[1]),Qe=Math.abs(lt[2]-lt[3]),pt=Math.abs(lt[0]-lt[2])+Math.abs(lt[1]-lt[3]),mt=Math.min(.25,.5*ve*(St+Qe)/Ye),bt=Math.min(.25,.5*ve*pt/Xe);return Pe+Math.max(mt*ce,bt*ye)}(g,x,j):A;return{base:A+(u===0)?-1:u,top:M?Math.max($+f,A+u+2):A+f}}const oJ=Fe([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:lJ}=oJ,cJ=Fe([{name:"a_packed",components:4,type:"Float32"}]),{members:uJ}=cJ,dJ=f_.types,hJ=Math.cos(Math.PI/180*37.5);class g_{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.projection=a.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new Je,this.layoutVertexArray2=new _t,this.indexArray=new Yt,this.programConfigurations=new dh(a.layers,a.zoom),this.segments=new ei,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,f,g){this.hasPattern=WT("line",this.layers,u);const x=this.layers[0].layout.get("line-sort-key"),S=[];for(const{feature:$,id:V,index:G,sourceLayerIndex:Y}of a){const J=this.layers[0]._featureFilter.needGeometry,ne=yh($,J);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),ne,f))continue;const ce=x?x.evaluate(ne,{},f):void 0,ye={id:V,properties:$.properties,type:$.type,sourceLayerIndex:Y,index:G,geometry:J?ne.geometry:dc($,f,g),patterns:{},sortKey:ce};S.push(ye)}x&&S.sort(($,V)=>$.sortKey-V.sortKey);const{lineAtlas:j,featureIndex:A}=u,M=this.addConstantDashes(j);for(const $ of S){const{geometry:V,index:G,sourceLayerIndex:Y}=$;if(M&&this.addFeatureDashes($,j),this.hasPattern){const J=GT("line",this.layers,$,this.zoom,u);this.patternFeatures.push(J)}else this.addFeature($,V,G,f,j.positions,u.availableImages);A.insert(a[G].feature,V,G,Y,this.index)}}addConstantDashes(a){let u=!1;for(const f of this.layers){const g=f.paint.get("line-dasharray").value,x=f.layout.get("line-cap").value;if(g.kind!=="constant"||x.kind!=="constant")u=!0;else{const S=x.value,j=g.value;if(!j)continue;a.addDash(j,S)}}return u}addFeatureDashes(a,u){const f=this.zoom;for(const g of this.layers){const x=g.paint.get("line-dasharray").value,S=g.layout.get("line-cap").value;if(x.kind==="constant"&&S.kind==="constant")continue;let j,A;if(x.kind==="constant"){if(j=x.value,!j)continue}else j=x.evaluate({zoom:f},a);A=S.kind==="constant"?S.value:S.evaluate({zoom:f},a),u.addDash(j,A),a.patterns[g.id]=u.getKey(j,A)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}addFeatures(a,u,f,g,x){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,u,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,uJ)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,lJ),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,u,f,g,x,S){const j=this.layers[0].layout,A=j.get("line-join").evaluate(a,{}),M=j.get("line-cap").evaluate(a,{}),$=j.get("line-miter-limit"),V=j.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const G of u)this.addLine(G,a,A,M,$,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,x,S,g)}addLine(a,u,f,g,x,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ye=0;ye<a.length-1;ye++)this.totalDistance+=a[ye].dist(a[ye+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=dJ[u.type]==="Polygon";let A=a.length;for(;A>=2&&a[A-1].equals(a[A-2]);)A--;let M=0;for(;M<A-1&&a[M].equals(a[M+1]);)M++;if(A<(j?3:2))return;f==="bevel"&&(x=1.05);const $=this.overscaling<=16?15*nr/(512*this.overscaling):0,V=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let G,Y,J,ne,ce;this.e1=this.e2=-1,j&&(G=a[A-2],ce=a[M].sub(G)._unit()._perp());for(let ye=M;ye<A;ye++){if(J=ye===A-1?j?a[M+1]:void 0:a[ye+1],J&&a[ye].equals(J))continue;ce&&(ne=ce),G&&(Y=G),G=a[ye],ce=J?J.sub(G)._unit()._perp():ne,ne=ne||ce;let Pe=ne.add(ce);Pe.x===0&&Pe.y===0||Pe._unit();const ve=ne.x*ce.x+ne.y*ce.y,Te=Pe.x*ce.x+Pe.y*ce.y,Ie=Te!==0?1/Te:1/0,Me=2*Math.sqrt(2-2*Te),Ye=Te<hJ&&Y&&J,Xe=ne.x*ce.y-ne.y*ce.x>0;if(Ye&&ye>M){const Qe=G.dist(Y);if(Qe>2*$){const pt=G.sub(G.sub(Y)._mult($/Qe)._round());this.updateDistance(Y,pt),this.addCurrentVertex(pt,ne,0,0,V),Y=pt}}const lt=Y&&J;let St=lt?f:j?"butt":g;if(lt&&St==="round"&&(Ie<S?St="miter":Ie<=2&&(St="fakeround")),St==="miter"&&Ie>x&&(St="bevel"),St==="bevel"&&(Ie>2&&(St="flipbevel"),Ie<x&&(St="miter")),Y&&this.updateDistance(Y,G),St==="miter")Pe._mult(Ie),this.addCurrentVertex(G,Pe,0,0,V);else if(St==="flipbevel"){if(Ie>100)Pe=ce.mult(-1);else{const Qe=Ie*ne.add(ce).mag()/ne.sub(ce).mag();Pe._perp()._mult(Qe*(Xe?-1:1))}this.addCurrentVertex(G,Pe,0,0,V),this.addCurrentVertex(G,Pe.mult(-1),0,0,V)}else if(St==="bevel"||St==="fakeround"){const Qe=-Math.sqrt(Ie*Ie-1),pt=Xe?Qe:0,mt=Xe?0:Qe;if(Y&&this.addCurrentVertex(G,ne,pt,mt,V),St==="fakeround"){const bt=Math.round(180*Me/Math.PI/20);for(let At=1;At<bt;At++){let st=At/bt;if(st!==.5){const Gt=st-.5;st+=st*Gt*(st-1)*((1.0904+ve*(ve*(3.55645-1.43519*ve)-3.2452))*Gt*Gt+(.848013+ve*(.215638*ve-1.06021)))}const Dt=ce.sub(ne)._mult(st)._add(ne)._unit()._mult(Xe?-1:1);this.addHalfVertex(G,Dt.x,Dt.y,!1,Xe,0,V)}}J&&this.addCurrentVertex(G,ce,-pt,-mt,V)}else if(St==="butt")this.addCurrentVertex(G,Pe,0,0,V);else if(St==="square"){const Qe=Y?1:-1;Y||this.addCurrentVertex(G,Pe,Qe,Qe,V),this.addCurrentVertex(G,Pe,0,0,V),Y&&this.addCurrentVertex(G,Pe,Qe,Qe,V)}else St==="round"&&(Y&&(this.addCurrentVertex(G,ne,0,0,V),this.addCurrentVertex(G,ne,1,1,V,!0)),J&&(this.addCurrentVertex(G,ce,-1,-1,V,!0),this.addCurrentVertex(G,ce,0,0,V)));if(Ye&&ye<A-1){const Qe=G.dist(J);if(Qe>2*$){const pt=G.add(J.sub(G)._mult($/Qe)._round());this.updateDistance(G,pt),this.addCurrentVertex(pt,ce,0,0,V),G=pt}}}}addCurrentVertex(a,u,f,g,x,S=!1){const j=u.y*g-u.x,A=-u.y-u.x*g;this.addHalfVertex(a,u.x+u.y*f,u.y-u.x*f,S,!1,f,x),this.addHalfVertex(a,j,A,S,!0,-g,x)}addHalfVertex({x:a,y:u},f,g,x,S,j,A){this.layoutVertexArray.emplaceBack((a<<1)+(x?1:0),(u<<1)+(S?1:0),Math.round(63*f)+128,Math.round(63*g)+128,1+(j===0?0:j<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const M=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),A.primitiveLength++),S?this.e2=M:this.e1=M}updateScaledDistance(){if(this.lineClips){const a=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=a*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(a,u){this.distance+=a.dist(u),this.updateScaledDistance()}}Vt(g_,"LineBucket",{omit:["layers","patternFeatures"]});const fJ=new Se({"line-cap":new de(ot.layout_line["line-cap"]),"line-join":new de(ot.layout_line["line-join"]),"line-miter-limit":new ee(ot.layout_line["line-miter-limit"]),"line-round-limit":new ee(ot.layout_line["line-round-limit"]),"line-sort-key":new de(ot.layout_line["line-sort-key"])});var aD={paint:new Se({"line-opacity":new de(ot.paint_line["line-opacity"]),"line-color":new de(ot.paint_line["line-color"]),"line-translate":new ee(ot.paint_line["line-translate"]),"line-translate-anchor":new ee(ot.paint_line["line-translate-anchor"]),"line-width":new de(ot.paint_line["line-width"]),"line-gap-width":new de(ot.paint_line["line-gap-width"]),"line-offset":new de(ot.paint_line["line-offset"]),"line-blur":new de(ot.paint_line["line-blur"]),"line-dasharray":new de(ot.paint_line["line-dasharray"]),"line-pattern":new de(ot.paint_line["line-pattern"]),"line-gradient":new we(ot.paint_line["line-gradient"]),"line-trim-offset":new ee(ot.paint_line["line-trim-offset"])}),layout:fJ};const oD=new class extends de{possiblyEvaluate(c,a){return a=new U(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition}),super.possiblyEvaluate(c,a)}evaluate(c,a,u,f){return a=ut({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(c,a,u,f)}}(aD.paint.properties["line-width"].specification);function lD(c,a){return a>0?a+2*c:c}oD.useIntegerZoom=!0;const pJ=Fe([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),mJ=Fe([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),gJ=Fe([{name:"a_projected_pos",components:4,type:"Float32"}],4);Fe([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const yJ=Fe([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),vJ=Fe([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Fe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const cD=Fe([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),xJ=Fe([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Fe([{name:"triangle",components:3,type:"Uint16"}]),Fe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Fe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Fe([{type:"Float32",name:"offsetX"}]),Fe([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Di=24;const zo=128;function XT(c,a){const{expression:u}=a;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new U(c+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:g}=u;let x=0;for(;x<f.length&&f[x]<=c;)x++;x=Math.max(0,x-1);let S=x;for(;S<f.length&&f[S]<c+1;)S++;S=Math.min(f.length-1,S);const j=f[x],A=f[S];return u.kind==="composite"?{kind:"composite",minZoom:j,maxZoom:A,interpolationType:g}:{kind:"camera",minZoom:j,maxZoom:A,minSize:u.evaluate(new U(j)),maxSize:u.evaluate(new U(A)),interpolationType:g}}}function y_(c,{uSize:a,uSizeT:u},{lowerSize:f,upperSize:g}){return c.kind==="source"?f/zo:c.kind==="composite"?Or(f/zo,g/zo,u):a}function yp(c,a){let u=0,f=0;if(c.kind==="constant")f=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:g,minZoom:x,maxZoom:S}=c,j=g?me(Ha.interpolationFactor(g,a,x,S),0,1):0;c.kind==="camera"?f=Or(c.minSize,c.maxSize,j):u=j}return{uSizeT:u,uSize:f}}var bJ=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:zo,evaluateSizeForFeature:y_,evaluateSizeForZoom:yp,getSizeData:XT});function _J(c,a,u){return c.sections.forEach(f=>{f.text=function(g,x,S){const j=x.layout.get("text-transform").evaluate(S,{});return j==="uppercase"?g=g.toLocaleUpperCase():j==="lowercase"&&(g=g.toLocaleLowerCase()),z.applyArabicShaping&&(g=z.applyArabicShaping(g)),g}(f.text,a,u)}),c}const ev={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function wJ(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}function SJ(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}var uD=hn,dD=function(c,a,u,f,g){var x,S,j=8*g-f-1,A=(1<<j)-1,M=A>>1,$=-7,V=u?g-1:0,G=u?-1:1,Y=c[a+V];for(V+=G,x=Y&(1<<-$)-1,Y>>=-$,$+=j;$>0;x=256*x+c[a+V],V+=G,$-=8);for(S=x&(1<<-$)-1,x>>=-$,$+=f;$>0;S=256*S+c[a+V],V+=G,$-=8);if(x===0)x=1-M;else{if(x===A)return S?NaN:1/0*(Y?-1:1);S+=Math.pow(2,f),x-=M}return(Y?-1:1)*S*Math.pow(2,x-f)},hD=function(c,a,u,f,g,x){var S,j,A,M=8*x-g-1,$=(1<<M)-1,V=$>>1,G=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=f?0:x-1,J=f?1:-1,ne=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(j=isNaN(a)?1:0,S=$):(S=Math.floor(Math.log(a)/Math.LN2),a*(A=Math.pow(2,-S))<1&&(S--,A*=2),(a+=S+V>=1?G/A:G*Math.pow(2,1-V))*A>=2&&(S++,A/=2),S+V>=$?(j=0,S=$):S+V>=1?(j=(a*A-1)*Math.pow(2,g),S+=V):(j=a*Math.pow(2,V-1)*Math.pow(2,g),S=0));g>=8;c[u+Y]=255&j,Y+=J,j/=256,g-=8);for(S=S<<g|j,M+=g;M>0;c[u+Y]=255&S,Y+=J,S/=256,M-=8);c[u+Y-J]|=128*ne};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function hn(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}hn.Varint=0,hn.Fixed64=1,hn.Bytes=2,hn.Fixed32=5;var KT=4294967296,fD=1/KT,pD=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function fc(c){return c.type===hn.Bytes?c.readVarint()+c.pos:c.pos+1}function vp(c,a,u){return u?4294967296*a+(c>>>0):4294967296*(a>>>0)+(c>>>0)}function mD(c,a,u){var f=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));u.realloc(f);for(var g=u.pos-1;g>=c;g--)u.buf[g+f]=u.buf[g]}function EJ(c,a){for(var u=0;u<c.length;u++)a.writeVarint(c[u])}function TJ(c,a){for(var u=0;u<c.length;u++)a.writeSVarint(c[u])}function jJ(c,a){for(var u=0;u<c.length;u++)a.writeFloat(c[u])}function CJ(c,a){for(var u=0;u<c.length;u++)a.writeDouble(c[u])}function PJ(c,a){for(var u=0;u<c.length;u++)a.writeBoolean(c[u])}function AJ(c,a){for(var u=0;u<c.length;u++)a.writeFixed32(c[u])}function NJ(c,a){for(var u=0;u<c.length;u++)a.writeSFixed32(c[u])}function kJ(c,a){for(var u=0;u<c.length;u++)a.writeFixed64(c[u])}function MJ(c,a){for(var u=0;u<c.length;u++)a.writeSFixed64(c[u])}function v_(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+16777216*c[a+3]}function xp(c,a,u){c[u]=a,c[u+1]=a>>>8,c[u+2]=a>>>16,c[u+3]=a>>>24}function gD(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+(c[a+3]<<24)}hn.prototype={destroy:function(){this.buf=null},readFields:function(c,a,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),g=f>>3,x=this.pos;this.type=7&f,c(g,a,this),this.pos===x&&this.skip(f)}return a},readMessage:function(c,a){return this.readFields(c,a,this.readVarint()+this.pos)},readFixed32:function(){var c=v_(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=gD(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=v_(this.buf,this.pos)+v_(this.buf,this.pos+4)*KT;return this.pos+=8,c},readSFixed64:function(){var c=v_(this.buf,this.pos)+gD(this.buf,this.pos+4)*KT;return this.pos+=8,c},readFloat:function(){var c=dD(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=dD(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var a,u,f=this.buf;return a=127&(u=f[this.pos++]),u<128?a:(a|=(127&(u=f[this.pos++]))<<7,u<128?a:(a|=(127&(u=f[this.pos++]))<<14,u<128?a:(a|=(127&(u=f[this.pos++]))<<21,u<128?a:function(g,x,S){var j,A,M=S.buf;if(j=(112&(A=M[S.pos++]))>>4,A<128||(j|=(127&(A=M[S.pos++]))<<3,A<128)||(j|=(127&(A=M[S.pos++]))<<10,A<128)||(j|=(127&(A=M[S.pos++]))<<17,A<128)||(j|=(127&(A=M[S.pos++]))<<24,A<128)||(j|=(1&(A=M[S.pos++]))<<31,A<128))return vp(g,j,x);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(u=f[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,a=this.pos;return this.pos=c,c-a>=12&&pD?function(u,f,g){return pD.decode(u.subarray(f,g))}(this.buf,a,c):function(u,f,g){for(var x="",S=f;S<g;){var j,A,M,$=u[S],V=null,G=$>239?4:$>223?3:$>191?2:1;if(S+G>g)break;G===1?$<128&&(V=$):G===2?(192&(j=u[S+1]))==128&&(V=(31&$)<<6|63&j)<=127&&(V=null):G===3?(A=u[S+2],(192&(j=u[S+1]))==128&&(192&A)==128&&((V=(15&$)<<12|(63&j)<<6|63&A)<=2047||V>=55296&&V<=57343)&&(V=null)):G===4&&(A=u[S+2],M=u[S+3],(192&(j=u[S+1]))==128&&(192&A)==128&&(192&M)==128&&((V=(15&$)<<18|(63&j)<<12|(63&A)<<6|63&M)<=65535||V>=1114112)&&(V=null)),V===null?(V=65533,G=1):V>65535&&(V-=65536,x+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),x+=String.fromCharCode(V),S+=G}return x}(this.buf,a,c)},readBytes:function(){var c=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,c);return this.pos=c,a},readPackedVarint:function(c,a){if(this.type!==hn.Bytes)return c.push(this.readVarint(a));var u=fc(this);for(c=c||[];this.pos<u;)c.push(this.readVarint(a));return c},readPackedSVarint:function(c){if(this.type!==hn.Bytes)return c.push(this.readSVarint());var a=fc(this);for(c=c||[];this.pos<a;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==hn.Bytes)return c.push(this.readBoolean());var a=fc(this);for(c=c||[];this.pos<a;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==hn.Bytes)return c.push(this.readFloat());var a=fc(this);for(c=c||[];this.pos<a;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==hn.Bytes)return c.push(this.readDouble());var a=fc(this);for(c=c||[];this.pos<a;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==hn.Bytes)return c.push(this.readFixed32());var a=fc(this);for(c=c||[];this.pos<a;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==hn.Bytes)return c.push(this.readSFixed32());var a=fc(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==hn.Bytes)return c.push(this.readFixed64());var a=fc(this);for(c=c||[];this.pos<a;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==hn.Bytes)return c.push(this.readSFixed64());var a=fc(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed64());return c},skip:function(c){var a=7&c;if(a===hn.Varint)for(;this.buf[this.pos++]>127;);else if(a===hn.Bytes)this.pos=this.readVarint()+this.pos;else if(a===hn.Fixed32)this.pos+=4;else{if(a!==hn.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(c,a){this.writeVarint(c<<3|a)},realloc:function(c){for(var a=this.length||16;a<this.pos+c;)a*=2;if(a!==this.length){var u=new Uint8Array(a);u.set(this.buf),this.buf=u,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),xp(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),xp(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),xp(this.buf,-1&c,this.pos),xp(this.buf,Math.floor(c*fD),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),xp(this.buf,-1&c,this.pos),xp(this.buf,Math.floor(c*fD),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(a,u){var f,g;if(a>=0?(f=a%4294967296|0,g=a/4294967296|0):(g=~(-a/4294967296),4294967295^(f=~(-a%4294967296))?f=f+1|0:(f=0,g=g+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(x,S,j){j.buf[j.pos++]=127&x|128,x>>>=7,j.buf[j.pos++]=127&x|128,x>>>=7,j.buf[j.pos++]=127&x|128,x>>>=7,j.buf[j.pos++]=127&x|128,j.buf[j.pos]=127&(x>>>=7)}(f,0,u),function(x,S){var j=(7&x)<<4;S.buf[S.pos++]|=j|((x>>>=3)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x)))))}(g,u)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var a=this.pos;this.pos=function(f,g,x){for(var S,j,A=0;A<g.length;A++){if((S=g.charCodeAt(A))>55295&&S<57344){if(!j){S>56319||A+1===g.length?(f[x++]=239,f[x++]=191,f[x++]=189):j=S;continue}if(S<56320){f[x++]=239,f[x++]=191,f[x++]=189,j=S;continue}S=j-55296<<10|S-56320|65536,j=null}else j&&(f[x++]=239,f[x++]=191,f[x++]=189,j=null);S<128?f[x++]=S:(S<2048?f[x++]=S>>6|192:(S<65536?f[x++]=S>>12|224:(f[x++]=S>>18|240,f[x++]=S>>12&63|128),f[x++]=S>>6&63|128),f[x++]=63&S|128)}return x}(this.buf,c,this.pos);var u=this.pos-a;u>=128&&mD(a,u,this),this.pos=a-1,this.writeVarint(u),this.pos+=u},writeFloat:function(c){this.realloc(4),hD(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),hD(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var a=c.length;this.writeVarint(a),this.realloc(a);for(var u=0;u<a;u++)this.buf[this.pos++]=c[u]},writeRawMessage:function(c,a){this.pos++;var u=this.pos;c(a,this);var f=this.pos-u;f>=128&&mD(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(c,a,u){this.writeTag(c,hn.Bytes),this.writeRawMessage(a,u)},writePackedVarint:function(c,a){a.length&&this.writeMessage(c,EJ,a)},writePackedSVarint:function(c,a){a.length&&this.writeMessage(c,TJ,a)},writePackedBoolean:function(c,a){a.length&&this.writeMessage(c,PJ,a)},writePackedFloat:function(c,a){a.length&&this.writeMessage(c,jJ,a)},writePackedDouble:function(c,a){a.length&&this.writeMessage(c,CJ,a)},writePackedFixed32:function(c,a){a.length&&this.writeMessage(c,AJ,a)},writePackedSFixed32:function(c,a){a.length&&this.writeMessage(c,NJ,a)},writePackedFixed64:function(c,a){a.length&&this.writeMessage(c,kJ,a)},writePackedSFixed64:function(c,a){a.length&&this.writeMessage(c,MJ,a)},writeBytesField:function(c,a){this.writeTag(c,hn.Bytes),this.writeBytes(a)},writeFixed32Field:function(c,a){this.writeTag(c,hn.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(c,a){this.writeTag(c,hn.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(c,a){this.writeTag(c,hn.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(c,a){this.writeTag(c,hn.Fixed64),this.writeSFixed64(a)},writeVarintField:function(c,a){this.writeTag(c,hn.Varint),this.writeVarint(a)},writeSVarintField:function(c,a){this.writeTag(c,hn.Varint),this.writeSVarint(a)},writeStringField:function(c,a){this.writeTag(c,hn.Bytes),this.writeString(a)},writeFloatField:function(c,a){this.writeTag(c,hn.Fixed32),this.writeFloat(a)},writeDoubleField:function(c,a){this.writeTag(c,hn.Fixed64),this.writeDouble(a)},writeBooleanField:function(c,a){this.writeVarintField(c,!!a)}};var x_=B(uD);const ZT=3;function IJ(c,a,u){a.glyphs=[],c===1&&u.readMessage(OJ,a)}function OJ(c,a,u){if(c===3){const{id:f,bitmap:g,width:x,height:S,left:j,top:A,advance:M}=u.readMessage(RJ,{});a.glyphs.push({id:f,bitmap:new hc({width:x+2*ZT,height:S+2*ZT},g),metrics:{width:x,height:S,left:j,top:A,advance:M}})}else c===4?a.ascender=u.readSVarint():c===5&&(a.descender=u.readSVarint())}function RJ(c,a,u){c===1?a.id=u.readVarint():c===2?a.bitmap=u.readBytes():c===3?a.width=u.readVarint():c===4?a.height=u.readVarint():c===5?a.left=u.readSVarint():c===6?a.top=u.readSVarint():c===7&&(a.advance=u.readVarint())}const yD=ZT;function YT(c){let a=0,u=0;for(const S of c)a+=S.w*S.h,u=Math.max(u,S.w);c.sort((S,j)=>j.h-S.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),u),h:1/0}];let g=0,x=0;for(const S of c)for(let j=f.length-1;j>=0;j--){const A=f[j];if(!(S.w>A.w||S.h>A.h)){if(S.x=A.x,S.y=A.y,x=Math.max(x,S.y+S.h),g=Math.max(g,S.x+S.w),S.w===A.w&&S.h===A.h){const M=f.pop();j<f.length&&(f[j]=M)}else S.h===A.h?(A.x+=S.w,A.w-=S.w):S.w===A.w?(A.y+=S.h,A.h-=S.h):(f.push({x:A.x+S.w,y:A.y,w:A.w-S.w,h:S.h}),A.y+=S.h,A.h-=S.h);break}}return{w:g,h:x,fill:a/(g*x)||0}}const Ls=1;class JT{constructor(a,{pixelRatio:u,version:f,stretchX:g,stretchY:x,content:S}){this.paddedRect=a,this.pixelRatio=u,this.stretchX=g,this.stretchY=x,this.content=S,this.version=f}get tl(){return[this.paddedRect.x+Ls,this.paddedRect.y+Ls]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ls,this.paddedRect.y+this.paddedRect.h-Ls]}get displaySize(){return[(this.paddedRect.w-2*Ls)/this.pixelRatio,(this.paddedRect.h-2*Ls)/this.pixelRatio]}}class vD{constructor(a,u){const f={},g={};this.haveRenderCallbacks=[];const x=[];this.addImages(a,f,x),this.addImages(u,g,x);const{w:S,h:j}=YT(x),A=new na({width:S||1,height:j||1});for(const M in a){const $=a[M],V=f[M].paddedRect;na.copy($.data,A,{x:0,y:0},{x:V.x+Ls,y:V.y+Ls},$.data)}for(const M in u){const $=u[M],V=g[M].paddedRect,G=V.x+Ls,Y=V.y+Ls,J=$.data.width,ne=$.data.height;na.copy($.data,A,{x:0,y:0},{x:G,y:Y},$.data),na.copy($.data,A,{x:0,y:ne-1},{x:G,y:Y-1},{width:J,height:1}),na.copy($.data,A,{x:0,y:0},{x:G,y:Y+ne},{width:J,height:1}),na.copy($.data,A,{x:J-1,y:0},{x:G-1,y:Y},{width:1,height:ne}),na.copy($.data,A,{x:0,y:0},{x:G+J,y:Y},{width:1,height:ne})}this.image=A,this.iconPositions=f,this.patternPositions=g}addImages(a,u,f){for(const g in a){const x=a[g],S={x:0,y:0,w:x.data.width+2*Ls,h:x.data.height+2*Ls};f.push(S),u[g]=new JT(S,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(a,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>a.hasImage(f)),a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in a.updatedImages)this.patchUpdatedImage(this.iconPositions[f],a.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],a.getImage(f),u)}patchUpdatedImage(a,u,f){if(!a||!u||a.version===u.version)return;a.version=u.version;const[g,x]=a.tl;f.update(u.data,void 0,{x:g,y:x})}}Vt(JT,"ImagePosition"),Vt(vD,"ImageAtlas");const Ta={horizontal:1,vertical:2,horizontalOnly:3},xD=-17;class tv{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,u){const f=new tv;return f.scale=a||1,f.fontStack=u,f}static forImage(a){const u=new tv;return u.imageName=a,u}}class bp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,u){const f=new bp;for(let g=0;g<a.sections.length;g++){const x=a.sections[g];x.image?f.addImageSection(x):f.addTextSection(x,u)}return f}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSections(){return this.sections}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(a){this.text=function(u,f){let g="";for(let x=0;x<u.length;x++){const S=u.charCodeAt(x+1)||null,j=u.charCodeAt(x-1)||null;g+=!f&&(S&&Xb(S)&&!ev[u[x+1]]||j&&Xb(j)&&!ev[u[x-1]])||!ev[u[x]]?u[x]:ev[u[x]]}return g}(this.text,a)}trim(){let a=0;for(let f=0;f<this.text.length&&b_[this.text.charCodeAt(f)];f++)a++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=a&&b_[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(a,u),this.sectionIndex=this.sectionIndex.slice(a,u)}substring(a,u){const f=new bp;return f.text=this.text.substring(a,u),f.sectionIndex=this.sectionIndex.slice(a,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,u)=>Math.max(a,this.sections[u].scale),0)}addTextSection(a,u){this.text+=a.text,this.sections.push(tv.forText(a.scale,a.fontStack||u));const f=this.sections.length-1;for(let g=0;g<a.text.length;++g)this.sectionIndex.push(f)}addImageSection(a){const u=a.image?a.image.name:"";if(u.length===0)return void or("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(tv.forImage(u)),this.sectionIndex.push(this.sections.length-1)):or("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function QT(c,a,u,f,g,x,S,j,A,M,$,V,G,Y,J){const ne=bp.fromFeature(c,g);V===Ta.vertical&&ne.verticalizePunctuation(G);let ce=[];const ye=function(Me,Ye,Xe,lt,St,Qe){if(!Me)return[];const pt=[],mt=function(Dt,Gt,Bt,ur,Nt,Qt){let dr=0;for(let zr=0;zr<Dt.length();zr++){const hr=Dt.getSection(zr);dr+=bD(Dt.getCharCode(zr),hr,ur,Nt,Gt,Qt)}return dr/Math.max(1,Math.ceil(dr/Bt))}(Me,Ye,Xe,lt,St,Qe),bt=Me.text.indexOf("")>=0;let At=0;for(let Dt=0;Dt<Me.length();Dt++){const Gt=Me.getSection(Dt),Bt=Me.getCharCode(Dt);if(b_[Bt]||(At+=bD(Bt,Gt,lt,St,Ye,Qe)),Dt<Me.length()-1){const ur=!((st=Bt)<11904||!(zt["Bopomofo Extended"](st)||zt.Bopomofo(st)||zt["CJK Compatibility Forms"](st)||zt["CJK Compatibility Ideographs"](st)||zt["CJK Compatibility"](st)||zt["CJK Radicals Supplement"](st)||zt["CJK Strokes"](st)||zt["CJK Symbols and Punctuation"](st)||zt["CJK Unified Ideographs Extension A"](st)||zt["CJK Unified Ideographs"](st)||zt["Enclosed CJK Letters and Months"](st)||zt["Halfwidth and Fullwidth Forms"](st)||zt.Hiragana(st)||zt["Ideographic Description Characters"](st)||zt["Kangxi Radicals"](st)||zt["Katakana Phonetic Extensions"](st)||zt.Katakana(st)||zt["Vertical Forms"](st)||zt["Yi Radicals"](st)||zt["Yi Syllables"](st)));(DJ[Bt]||ur||Gt.imageName)&&pt.push(wD(Dt+1,At,mt,pt,LJ(Bt,Me.getCharCode(Dt+1),ur&&bt),!1))}}var st;return SD(wD(Me.length(),At,mt,pt,0,!0))}(ne,M,x,a,f,Y),{processBidirectionalText:Pe,processStyledBidirectionalText:ve}=z;if(Pe&&ne.sections.length===1){const Me=Pe(ne.toString(),ye);for(const Ye of Me){const Xe=new bp;Xe.text=Ye,Xe.sections=ne.sections;for(let lt=0;lt<Ye.length;lt++)Xe.sectionIndex.push(0);ce.push(Xe)}}else if(ve){const Me=ve(ne.text,ne.sectionIndex,ye);for(const Ye of Me){const Xe=new bp;Xe.text=Ye[0],Xe.sectionIndex=Ye[1],Xe.sections=ne.sections,ce.push(Xe)}}else ce=function(Me,Ye){const Xe=[],lt=Me.text;let St=0;for(const Qe of Ye)Xe.push(Me.substring(St,Qe)),St=Qe;return St<lt.length&&Xe.push(Me.substring(St,lt.length)),Xe}(ne,ye);const Te=[],Ie={positionedLines:Te,text:ne.toString(),top:$[1],bottom:$[1],left:$[0],right:$[0],writingMode:V,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Me,Ye,Xe,lt,St,Qe,pt,mt,bt,At,st,Dt){let Gt=0,Bt=0,ur=0;const Nt=mt==="right"?1:mt==="left"?0:.5;let Qt=!1;for(const gr of St){const yr=gr.getSections();for(const ln of yr){if(ln.imageName)continue;const fn=Ye[ln.fontStack];if(fn&&(Qt=fn.ascender!==void 0&&fn.descender!==void 0,!Qt))break}if(!Qt)break}let dr=0;for(const gr of St){gr.trim();const yr=gr.getMaxScale(),ln=(yr-1)*Di,fn={positionedGlyphs:[],lineOffset:0};Me.positionedLines[dr]=fn;const pn=fn.positionedGlyphs;let cn=0;if(!gr.length()){Bt+=Qe,++dr;continue}let An=0,$n=0;for(let un=0;un<gr.length();un++){const di=gr.getSection(un),ni=gr.getSectionIndex(un),On=gr.getCharCode(un);let Fr=di.scale,ii=null,mn=null,ws=null,si=Di,Li=0;const Si=!(bt===Ta.horizontal||!st&&!Py(On)||st&&(b_[On]||(zr=On,zt.Arabic(zr)||zt["Arabic Supplement"](zr)||zt["Arabic Extended-A"](zr)||zt["Arabic Presentation Forms-A"](zr)||zt["Arabic Presentation Forms-B"](zr))));if(di.imageName){const Ss=lt[di.imageName];if(!Ss)continue;ws=di.imageName,Me.iconsInText=Me.iconsInText||!0,mn=Ss.paddedRect;const Ei=Ss.displaySize;Fr=Fr*Di/Dt,ii={width:Ei[0],height:Ei[1],left:Ls,top:-yD,advance:Si?Ei[1]:Ei[0],localGlyph:!1},Li=Qt?-ii.height*Fr:xD+yr*Di-Ei[1]*Fr,si=ii.advance;const Uo=(Si?Ei[0]:Ei[1])*Fr-Di*yr;Uo>0&&Uo>cn&&(cn=Uo)}else{const Ss=Xe[di.fontStack];if(!Ss)continue;Ss[On]&&(mn=Ss[On]);const Ei=Ye[di.fontStack];if(!Ei)continue;const Uo=Ei.glyphs[On];if(!Uo)continue;if(ii=Uo.metrics,si=On!==8203?Di:0,Qt){const Cp=Ei.ascender!==void 0?Math.abs(Ei.ascender):0,dv=Ei.descender!==void 0?Math.abs(Ei.descender):0,hv=(Cp+dv)*Fr;An<hv&&(An=hv,$n=(Cp-dv)/2*Fr),Li=-Cp*Fr}else Li=xD+(yr-Fr)*Di}Si?(Me.verticalizable=!0,pn.push({glyph:On,imageName:ws,x:Gt,y:Bt+Li,vertical:Si,scale:Fr,localGlyph:ii.localGlyph,fontStack:di.fontStack,sectionIndex:ni,metrics:ii,rect:mn}),Gt+=si*Fr+At):(pn.push({glyph:On,imageName:ws,x:Gt,y:Bt+Li,vertical:Si,scale:Fr,localGlyph:ii.localGlyph,fontStack:di.fontStack,sectionIndex:ni,metrics:ii,rect:mn}),Gt+=ii.advance*Fr+At)}pn.length!==0&&(ur=Math.max(Gt-At,ur),Qt?ED(pn,Nt,cn,$n,Qe*yr/2):ED(pn,Nt,cn,0,Qe/2)),Gt=0;const ri=Qe*yr+cn;fn.lineOffset=Math.max(cn,ln),Bt+=ri,++dr}var zr;const hr=Bt,{horizontalAlign:ar,verticalAlign:yn}=ej(pt);(function(gr,yr,ln,fn,pn,cn){const An=(yr-ln)*pn,$n=-cn*fn;for(const ri of gr)for(const un of ri.positionedGlyphs)un.x+=An,un.y+=$n})(Me.positionedLines,Nt,ar,yn,ur,hr),Me.top+=-yn*hr,Me.bottom=Me.top+hr,Me.left+=-ar*ur,Me.right=Me.left+ur,Me.hasBaseline=Qt}(Ie,a,u,f,ce,S,j,A,V,M,G,J),!function(Me){for(const Ye of Me)if(Ye.positionedGlyphs.length!==0)return!1;return!0}(Te)&&Ie}const b_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},DJ={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function bD(c,a,u,f,g,x){if(a.imageName){const S=f[a.imageName];return S?S.displaySize[0]*a.scale*Di/x+g:0}{const S=u[a.fontStack],j=S&&S.glyphs[c];return j?j.metrics.advance*a.scale+g:0}}function _D(c,a,u,f){const g=Math.pow(c-a,2);return f?c<a?g/2:2*g:g+Math.abs(u)*u}function LJ(c,a,u){let f=0;return c===10&&(f-=1e4),u&&(f+=150),c!==40&&c!==65288||(f+=50),a!==41&&a!==65289||(f+=50),f}function wD(c,a,u,f,g,x){let S=null,j=_D(a,u,g,x);for(const A of f){const M=_D(a-A.x,u,g,x)+A.badness;M<=j&&(S=A,j=M)}return{index:c,x:a,priorBreak:S,badness:j}}function SD(c){return c?SD(c.priorBreak).concat(c.index):[]}function ej(c){let a=.5,u=.5;switch(c){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:a,verticalAlign:u}}function ED(c,a,u,f,g){if(!(a||u||f||g))return;const x=c.length-1,S=c[x],j=(S.x+S.metrics.advance*S.scale)*a;for(let A=0;A<=x;A++)c[A].x-=j,c[A].y+=u+f+g}function BJ(c,a,u){const{horizontalAlign:f,verticalAlign:g}=ej(u),x=a[0]-c.displaySize[0]*f,S=a[1]-c.displaySize[1]*g;return{image:c,top:S,bottom:S+c.displaySize[1],left:x,right:x+c.displaySize[0]}}function TD(c,a,u,f,g,x){const S=c.image;let j;if(S.content){const ce=S.content,ye=S.pixelRatio||1;j=[ce[0]/ye,ce[1]/ye,S.displaySize[0]-ce[2]/ye,S.displaySize[1]-ce[3]/ye]}const A=a.left*x,M=a.right*x;let $,V,G,Y;u==="width"||u==="both"?(Y=g[0]+A-f[3],V=g[0]+M+f[1]):(Y=g[0]+(A+M-S.displaySize[0])/2,V=Y+S.displaySize[0]);const J=a.top*x,ne=a.bottom*x;return u==="height"||u==="both"?($=g[1]+J-f[0],G=g[1]+ne+f[2]):($=g[1]+(J+ne-S.displaySize[1])/2,G=$+S.displaySize[1]),{image:S,top:$,right:V,bottom:G,left:Y,collisionPadding:j}}class pc extends W{constructor(a,u,f,g,x){super(a,u),this.angle=g,this.z=f,x!==void 0&&(this.segment=x)}clone(){return new pc(this.x,this.y,this.z,this.angle,this.segment)}}function jD(c,a,u,f,g){if(a.segment===void 0)return!0;let x=a,S=a.segment+1,j=0;for(;j>-u/2;){if(S--,S<0)return!1;j-=c[S].dist(x),x=c[S]}j+=c[S].dist(c[S+1]),S++;const A=[];let M=0;for(;j<u/2;){const $=c[S],V=c[S+1];if(!V)return!1;let G=c[S-1].angleTo($)-$.angleTo(V);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:j,angleDelta:G}),M+=G;j-A[0].distance>f;)M-=A.shift().angleDelta;if(M>g)return!1;S++,j+=$.dist(V)}return!0}function CD(c){let a=0;for(let u=0;u<c.length-1;u++)a+=c[u].dist(c[u+1]);return a}function PD(c,a,u){return c?.6*a*u:0}function AD(c,a){return Math.max(c?c.right-c.left:0,a?a.right-a.left:0)}function zJ(c,a,u,f,g,x){const S=PD(u,g,x),j=AD(u,f)*x;let A=0;const M=CD(c)/2;for(let $=0;$<c.length-1;$++){const V=c[$],G=c[$+1],Y=V.dist(G);if(A+Y>M){const J=(M-A)/Y,ne=Or(V.x,G.x,J),ce=Or(V.y,G.y,J),ye=new pc(ne,ce,0,G.angleTo(V),$);return!S||jD(c,ye,j,S,a)?ye:void 0}A+=Y}}function $J(c,a,u,f,g,x,S,j,A){const M=PD(f,x,S),$=AD(f,g),V=$*S,G=c[0].x===0||c[0].x===A||c[0].y===0||c[0].y===A;return a-V<a/4&&(a=V+a/4),ND(c,G?a/2*j%a:($/2+2*x)*S*j%a,a,M,u,V,G,!1,A)}function ND(c,a,u,f,g,x,S,j,A){const M=x/2,$=CD(c);let V=0,G=a-u,Y=[];for(let J=0;J<c.length-1;J++){const ne=c[J],ce=c[J+1],ye=ne.dist(ce),Pe=ce.angleTo(ne);for(;G+u<V+ye;){G+=u;const ve=(G-V)/ye,Te=Or(ne.x,ce.x,ve),Ie=Or(ne.y,ce.y,ve);if(Te>=0&&Te<A&&Ie>=0&&Ie<A&&G-M>=0&&G+M<=$){const Me=new pc(Te,Ie,0,Pe,J);Me._round(),f&&!jD(c,Me,x,f,g)||Y.push(Me)}}V+=ye}return j||Y.length||S||(Y=ND(c,V/2,u,f,g,x,S,!0,A)),Y}function kD(c,a,u,f,g){const x=[];for(let S=0;S<c.length;S++){const j=c[S];let A;for(let M=0;M<j.length-1;M++){let $=j[M],V=j[M+1];$.x<a&&V.x<a||($.x<a?$=new W(a,$.y+(a-$.x)/(V.x-$.x)*(V.y-$.y))._round():V.x<a&&(V=new W(a,$.y+(a-$.x)/(V.x-$.x)*(V.y-$.y))._round()),$.y<u&&V.y<u||($.y<u?$=new W($.x+(u-$.y)/(V.y-$.y)*(V.x-$.x),u)._round():V.y<u&&(V=new W($.x+(u-$.y)/(V.y-$.y)*(V.x-$.x),u)._round()),$.x>=f&&V.x>=f||($.x>=f?$=new W(f,$.y+(f-$.x)/(V.x-$.x)*(V.y-$.y))._round():V.x>=f&&(V=new W(f,$.y+(f-$.x)/(V.x-$.x)*(V.y-$.y))._round()),$.y>=g&&V.y>=g||($.y>=g?$=new W($.x+(g-$.y)/(V.y-$.y)*(V.x-$.x),g)._round():V.y>=g&&(V=new W($.x+(g-$.y)/(V.y-$.y)*(V.x-$.x),g)._round()),A&&$.equals(A[A.length-1])||(A=[$],x.push(A)),A.push(V)))))}}return x}Vt(pc,"Anchor");const rv=1e20;function MD(c,a,u,f,g,x,S,j,A){for(let M=a;M<a+f;M++)ID(c,u*x+M,x,g,S,j,A);for(let M=u;M<u+g;M++)ID(c,M*x+a,1,f,S,j,A)}function ID(c,a,u,f,g,x,S){x[0]=0,S[0]=-rv,S[1]=rv,g[0]=c[a];for(let j=1,A=0,M=0;j<f;j++){g[j]=c[a+j*u];const $=j*j;do{const V=x[A];M=(g[j]-g[V]+$-V*V)/(j-V)/2}while(M<=S[A]&&--A>-1);A++,x[A]=j,S[A]=M,S[A+1]=rv}for(let j=0,A=0;j<f;j++){for(;S[A+1]<j;)A++;const M=x[A],$=j-M;c[a+j*u]=g[M]+$*$}}const $o=2,tj={none:0,ideographs:1,all:2};class _p{constructor(a,u,f){this.requestManager=a,this.localGlyphMode=u,this.localFontFamily=f,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(a){this.url=a}getGlyphs(a,u){const f=[];for(const g in a)for(const x of a[g])f.push({stack:g,id:x});Be(f,({stack:g,id:x},S)=>{let j=this.entries[g];j||(j=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let A=j.glyphs[x];if(A!==void 0)return void S(null,{stack:g,id:x,glyph:A});if(A=this._tinySDF(j,g,x),A)return j.glyphs[x]=A,void S(null,{stack:g,id:x,glyph:A});const M=Math.floor(x/256);if(256*M>65535)return void S(new Error("glyphs > 65535 not supported"));if(j.ranges[M])return void S(null,{stack:g,id:x,glyph:A});let $=j.requests[M];$||($=j.requests[M]=[],_p.loadGlyphRange(g,M,this.url,this.requestManager,(V,G)=>{if(G){j.ascender=G.ascender,j.descender=G.descender;for(const Y in G.glyphs)this._doesCharSupportLocalGlyph(+Y)||(j.glyphs[+Y]=G.glyphs[+Y]);j.ranges[M]=!0}for(const Y of $)Y(V,G);delete j.requests[M]})),$.push((V,G)=>{V?S(V):G&&S(null,{stack:g,id:x,glyph:G.glyphs[x]||null})})},(g,x)=>{if(g)u(g);else if(x){const S={};for(const{stack:j,id:A,glyph:M}of x)S[j]===void 0&&(S[j]={}),S[j].glyphs===void 0&&(S[j].glyphs={}),S[j].glyphs[A]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},S[j].ascender=this.entries[j].ascender,S[j].descender=this.entries[j].descender;u(null,S)}})}_doesCharSupportLocalGlyph(a){return this.localGlyphMode!==tj.none&&(this.localGlyphMode===tj.all?!!this.localFontFamily:!!this.localFontFamily&&(zt["CJK Unified Ideographs"](a)||zt["Hangul Syllables"](a)||zt.Hiragana(a)||zt.Katakana(a)||zt["CJK Symbols and Punctuation"](a)))}_tinySDF(a,u,f){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let x=a.tinySDF;if(!x){let ne="400";/bold/i.test(u)?ne="900":/medium/i.test(u)?ne="500":/light/i.test(u)&&(ne="200"),x=a.tinySDF=new _p.TinySDF({fontFamily:g,fontWeight:ne,fontSize:24*$o,buffer:3*$o,radius:8*$o}),x.fontWeight=ne}if(this.localGlyphs[x.fontWeight][f])return this.localGlyphs[x.fontWeight][f];const S=String.fromCharCode(f),{data:j,width:A,height:M,glyphWidth:$,glyphHeight:V,glyphLeft:G,glyphTop:Y,glyphAdvance:J}=x.draw(S);return this.localGlyphs[x.fontWeight][f]={id:f,bitmap:new hc({width:A,height:M},j),metrics:{width:$/$o,height:V/$o,left:G/$o,top:Y/$o-27,advance:J/$o,localGlyph:!0}}}}_p.loadGlyphRange=function(c,a,u,f,g){const x=256*a,S=x+255,j=f.transformRequest(f.normalizeGlyphsURL(u).replace("{fontstack}",c).replace("{range}",`${x}-${S}`),Ua.Glyphs);ru(j,(A,M)=>{if(A)g(A);else if(M){const $={},V=function(G){return new x_(G).readFields(IJ,{})}(M);for(const G of V.glyphs)$[G.id]=G;g(null,{glyphs:$,ascender:V.ascender,descender:V.descender})}})},_p.TinySDF=class{constructor({fontSize:c=24,buffer:a=3,radius:u=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:x="normal",fontStyle:S="normal"}={}){this.buffer=a,this.cutoff=f,this.radius=u;const j=this.size=c+4*a,A=this._createCanvas(j),M=this.ctx=A.getContext("2d",{willReadFrequently:!0});M.font=`${S} ${x} ${c}px ${g}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(j*j),this.gridInner=new Float64Array(j*j),this.f=new Float64Array(j),this.z=new Float64Array(j+1),this.v=new Uint16Array(j)}_createCanvas(c){const a=document.createElement("canvas");return a.width=a.height=c,a}draw(c){const{width:a,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:x}=this.ctx.measureText(c),S=Math.ceil(u),j=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-g))),A=Math.min(this.size-this.buffer,S+Math.ceil(f)),M=j+2*this.buffer,$=A+2*this.buffer,V=Math.max(M*$,0),G=new Uint8ClampedArray(V),Y={data:G,width:M,height:$,glyphWidth:j,glyphHeight:A,glyphTop:S,glyphLeft:0,glyphAdvance:a};if(j===0||A===0)return Y;const{ctx:J,buffer:ne,gridInner:ce,gridOuter:ye}=this;J.clearRect(ne,ne,j,A),J.fillText(c,ne,ne+S);const Pe=J.getImageData(ne,ne,j,A);ye.fill(rv,0,V),ce.fill(0,0,V);for(let ve=0;ve<A;ve++)for(let Te=0;Te<j;Te++){const Ie=Pe.data[4*(ve*j+Te)+3]/255;if(Ie===0)continue;const Me=(ve+ne)*M+Te+ne;if(Ie===1)ye[Me]=0,ce[Me]=rv;else{const Ye=.5-Ie;ye[Me]=Ye>0?Ye*Ye:0,ce[Me]=Ye<0?Ye*Ye:0}}MD(ye,0,0,M,$,M,this.f,this.v,this.z),MD(ce,ne,ne,j,A,M,this.f,this.v,this.z);for(let ve=0;ve<V;ve++){const Te=Math.sqrt(ye[ve])-Math.sqrt(ce[ve]);G[ve]=Math.round(255-255*(Te/this.radius+this.cutoff))}return Y}};const wp=Ls;function OD(c,a,u,f){const g=[],x=c.image,S=x.pixelRatio,j=x.paddedRect.w-2*wp,A=x.paddedRect.h-2*wp,M=c.right-c.left,$=c.bottom-c.top,V=x.stretchX||[[0,j]],G=x.stretchY||[[0,A]],Y=(Qe,pt)=>Qe+pt[1]-pt[0],J=V.reduce(Y,0),ne=G.reduce(Y,0),ce=j-J,ye=A-ne;let Pe=0,ve=J,Te=0,Ie=ne,Me=0,Ye=ce,Xe=0,lt=ye;if(x.content&&f){const Qe=x.content;Pe=__(V,0,Qe[0]),Te=__(G,0,Qe[1]),ve=__(V,Qe[0],Qe[2]),Ie=__(G,Qe[1],Qe[3]),Me=Qe[0]-Pe,Xe=Qe[1]-Te,Ye=Qe[2]-Qe[0]-ve,lt=Qe[3]-Qe[1]-Ie}const St=(Qe,pt,mt,bt)=>{const At=w_(Qe.stretch-Pe,ve,M,c.left),st=S_(Qe.fixed-Me,Ye,Qe.stretch,J),Dt=w_(pt.stretch-Te,Ie,$,c.top),Gt=S_(pt.fixed-Xe,lt,pt.stretch,ne),Bt=w_(mt.stretch-Pe,ve,M,c.left),ur=S_(mt.fixed-Me,Ye,mt.stretch,J),Nt=w_(bt.stretch-Te,Ie,$,c.top),Qt=S_(bt.fixed-Xe,lt,bt.stretch,ne),dr=new W(At,Dt),zr=new W(Bt,Dt),hr=new W(Bt,Nt),ar=new W(At,Nt),yn=new W(st/S,Gt/S),gr=new W(ur/S,Qt/S),yr=a*Math.PI/180;if(yr){const pn=Math.sin(yr),cn=Math.cos(yr),An=[cn,-pn,pn,cn];dr._matMult(An),zr._matMult(An),ar._matMult(An),hr._matMult(An)}const ln=Qe.stretch+Qe.fixed,fn=pt.stretch+pt.fixed;return{tl:dr,tr:zr,bl:ar,br:hr,tex:{x:x.paddedRect.x+wp+ln,y:x.paddedRect.y+wp+fn,w:mt.stretch+mt.fixed-ln,h:bt.stretch+bt.fixed-fn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:yn,pixelOffsetBR:gr,minFontScaleX:Ye/S/M,minFontScaleY:lt/S/$,isSDF:u}};if(f&&(x.stretchX||x.stretchY)){const Qe=RD(V,ce,J),pt=RD(G,ye,ne);for(let mt=0;mt<Qe.length-1;mt++){const bt=Qe[mt],At=Qe[mt+1];for(let st=0;st<pt.length-1;st++)g.push(St(bt,pt[st],At,pt[st+1]))}}else g.push(St({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:j+1},{fixed:0,stretch:A+1}));return g}function __(c,a,u){let f=0;for(const g of c)f+=Math.max(a,Math.min(u,g[1]))-Math.max(a,Math.min(u,g[0]));return f}function RD(c,a,u){const f=[{fixed:-wp,stretch:0}];for(const[g,x]of c){const S=f[f.length-1];f.push({fixed:g-S.stretch,stretch:S.stretch}),f.push({fixed:g-S.stretch,stretch:S.stretch+(x-g)})}return f.push({fixed:a+wp,stretch:u}),f}function w_(c,a,u,f){return c/a*u+f}function S_(c,a,u,f){return c-a*u/f}function FJ(c,a,u,f){const g=a+c.positionedLines[f].lineOffset;return f===0?u+g/2:u+(g+(a+c.positionedLines[f-1].lineOffset))/2}class UJ{constructor(a=[],u=VJ){if(this.data=a,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const a=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:u,compare:f}=this,g=u[a];for(;a>0;){const x=a-1>>1,S=u[x];if(f(g,S)>=0)break;u[a]=S,a=x}u[a]=g}_down(a){const{data:u,compare:f}=this,g=this.length>>1,x=u[a];for(;a<g;){let S=1+(a<<1),j=u[S];const A=S+1;if(A<this.length&&f(u[A],j)<0&&(S=A,j=u[A]),f(j,x)>=0)break;u[a]=j,a=S}u[a]=x}}function VJ(c,a){return c<a?-1:c>a?1:0}function qJ(c,a=1,u=!1){let f=1/0,g=1/0,x=-1/0,S=-1/0;const j=c[0];for(let Y=0;Y<j.length;Y++){const J=j[Y];(!Y||J.x<f)&&(f=J.x),(!Y||J.y<g)&&(g=J.y),(!Y||J.x>x)&&(x=J.x),(!Y||J.y>S)&&(S=J.y)}const A=Math.min(x-f,S-g);let M=A/2;const $=new UJ([],WJ);if(A===0)return new W(f,g);for(let Y=f;Y<x;Y+=A)for(let J=g;J<S;J+=A)$.push(new Sp(Y+M,J+M,M,c));let V=function(Y){let J=0,ne=0,ce=0;const ye=Y[0];for(let Pe=0,ve=ye.length,Te=ve-1;Pe<ve;Te=Pe++){const Ie=ye[Pe],Me=ye[Te],Ye=Ie.x*Me.y-Me.x*Ie.y;ne+=(Ie.x+Me.x)*Ye,ce+=(Ie.y+Me.y)*Ye,J+=3*Ye}return new Sp(ne/J,ce/J,0,Y)}(c),G=$.length;for(;$.length;){const Y=$.pop();(Y.d>V.d||!V.d)&&(V=Y,u&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,G)),Y.max-V.d<=a||(M=Y.h/2,$.push(new Sp(Y.p.x-M,Y.p.y-M,M,c)),$.push(new Sp(Y.p.x+M,Y.p.y-M,M,c)),$.push(new Sp(Y.p.x-M,Y.p.y+M,M,c)),$.push(new Sp(Y.p.x+M,Y.p.y+M,M,c)),G+=4)}return u&&(console.log(`num probes: ${G}`),console.log(`best distance: ${V.d}`)),V.p}function WJ(c,a){return a.max-c.max}class Sp{constructor(a,u,f,g){this.p=new W(a,u),this.h=f,this.d=function(x,S){let j=!1,A=1/0;for(let M=0;M<S.length;M++){const $=S[M];for(let V=0,G=$.length,Y=G-1;V<G;Y=V++){const J=$[V],ne=$[Y];J.y>x.y!=ne.y>x.y&&x.x<(ne.x-J.x)*(x.y-J.y)/(ne.y-J.y)+J.x&&(j=!j),A=Math.min(A,NR(x,J,ne))}}return(j?1:-1)*Math.sqrt(A)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}}const Ep=7,rj=Number.POSITIVE_INFINITY,GJ=Math.sqrt(2);function DD(c,[a,u]){let f=0,g=0;if(u===rj){a<0&&(a=0);const x=a/GJ;switch(c){case"top-right":case"top-left":g=x-Ep;break;case"bottom-right":case"bottom-left":g=-x+Ep;break;case"bottom":g=-a+Ep;break;case"top":g=a-Ep}switch(c){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=a;break;case"right":f=-a}}else{switch(a=Math.abs(a),u=Math.abs(u),c){case"top-right":case"top-left":case"top":g=u-Ep;break;case"bottom-right":case"bottom-left":case"bottom":g=-u+Ep}switch(c){case"top-right":case"bottom-right":case"right":f=-a;break;case"top-left":case"bottom-left":case"left":f=a}}return[f,g]}function HJ(c,a,u,f,g,x,S,j,A,M){c.createArrays(),c.tilePixelRatio=nr/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const $=c.layers[0].layout,V=c.layers[0]._unevaluatedLayout._values,G={};if(c.textSizeData.kind==="composite"){const{minZoom:ne,maxZoom:ce}=c.textSizeData;G.compositeTextSizes=[V["text-size"].possiblyEvaluate(new U(ne),j),V["text-size"].possiblyEvaluate(new U(ce),j)]}if(c.iconSizeData.kind==="composite"){const{minZoom:ne,maxZoom:ce}=c.iconSizeData;G.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new U(ne),j),V["icon-size"].possiblyEvaluate(new U(ce),j)]}G.layoutTextSize=V["text-size"].possiblyEvaluate(new U(A+1),j),G.layoutIconSize=V["icon-size"].possiblyEvaluate(new U(A+1),j),G.textMaxSize=V["text-size"].possiblyEvaluate(new U(18),j);const Y=$.get("text-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",J=$.get("text-size");for(const ne of c.features){const ce=$.get("text-font").evaluate(ne,{},j).join(","),ye=J.evaluate(ne,{},j),Pe=G.layoutTextSize.evaluate(ne,{},j),ve=(G.layoutIconSize.evaluate(ne,{},j),{horizontal:{},vertical:void 0}),Te=ne.text;let Ie,Me=[0,0];if(Te){const lt=Te.toString(),St=$.get("text-letter-spacing").evaluate(ne,{},j)*Di,Qe=$.get("text-line-height").evaluate(ne,{},j)*Di,pt=dT(lt)?St:0,mt=$.get("text-anchor").evaluate(ne,{},j),bt=$.get("text-variable-anchor");if(!bt){const Bt=$.get("text-radial-offset").evaluate(ne,{},j);Me=Bt?DD(mt,[Bt*Di,rj]):$.get("text-offset").evaluate(ne,{},j).map(ur=>ur*Di)}let At=Y?"center":$.get("text-justify").evaluate(ne,{},j);const st=$.get("symbol-placement")==="point",Dt=st?$.get("text-max-width").evaluate(ne,{},j)*Di:1/0,Gt=Bt=>{c.allowVerticalPlacement&&Cy(lt)&&(ve.vertical=QT(Te,a,u,g,ce,Dt,Qe,mt,Bt,pt,Me,Ta.vertical,!0,Pe,ye))};if(!Y&&bt){const Bt=At==="auto"?bt.map(Nt=>nj(Nt)):[At];let ur=!1;for(let Nt=0;Nt<Bt.length;Nt++){const Qt=Bt[Nt];if(!ve.horizontal[Qt])if(ur)ve.horizontal[Qt]=ve.horizontal[0];else{const dr=QT(Te,a,u,g,ce,Dt,Qe,"center",Qt,pt,Me,Ta.horizontal,!1,Pe,ye);dr&&(ve.horizontal[Qt]=dr,ur=dr.positionedLines.length===1)}}Gt("left")}else{if(At==="auto"&&(At=nj(mt)),st||$.get("text-writing-mode").indexOf("horizontal")>=0||!Cy(lt)){const Bt=QT(Te,a,u,g,ce,Dt,Qe,mt,At,pt,Me,Ta.horizontal,!1,Pe,ye);Bt&&(ve.horizontal[At]=Bt)}Gt(st?"left":At)}}let Ye=!1;if(ne.icon&&ne.icon.name){const lt=f[ne.icon.name];lt&&(Ie=BJ(g[ne.icon.name],$.get("icon-offset").evaluate(ne,{},j),$.get("icon-anchor").evaluate(ne,{},j)),Ye=lt.sdf,c.sdfIcons===void 0?c.sdfIcons=lt.sdf:c.sdfIcons!==lt.sdf&&or("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(lt.pixelRatio!==c.pixelRatio||$.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const Xe=BD(ve.horizontal)||ve.vertical;c.iconsInText||(c.iconsInText=!!Xe&&Xe.iconsInText),(Xe||Ie)&&XJ(c,ne,ve,Ie,f,G,Pe,0,Me,Ye,S,j,M)}x&&c.generateCollisionDebugBuffers(A,c.collisionBoxArray)}function nj(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function XJ(c,a,u,f,g,x,S,j,A,M,$,V,G){let Y=x.textMaxSize.evaluate(a,{},V);Y===void 0&&(Y=S);const J=c.layers[0].layout,ne=J.get("icon-offset").evaluate(a,{},V),ce=BD(u.horizontal)||u.vertical,ye=G.name==="globe",Pe=Di,ve=S/Pe,Te=c.tilePixelRatio*Y/Pe,Ie=(mt=c.overscaling,c.zoom>18&&mt>2&&(mt>>=1),Math.max(nr/(512*mt),1)*J.get("symbol-spacing")),Me=J.get("text-padding")*c.tilePixelRatio,Ye=J.get("icon-padding")*c.tilePixelRatio,Xe=ie(J.get("text-max-angle")),lt=J.get("text-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",St=J.get("icon-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",Qe=J.get("symbol-placement"),pt=Ie/2;var mt;const bt=J.get("icon-text-fit");let At;f&&bt!=="none"&&(c.allowVerticalPlacement&&u.vertical&&(At=TD(f,u.vertical,bt,J.get("icon-text-fit-padding"),ne,ve)),ce&&(f=TD(f,ce,bt,J.get("icon-text-fit-padding"),ne,ve)));const st=(Dt,Gt,Bt)=>{if(Gt.x<0||Gt.x>=nr||Gt.y<0||Gt.y>=nr)return;let ur=null;if(ye){const{x:Nt,y:Qt,z:dr}=G.projectTilePoint(Gt.x,Gt.y,Bt);ur={anchor:new pc(Nt,Qt,dr,0,void 0),up:G.upVector(Bt,Gt.x,Gt.y)}}(function(Nt,Qt,dr,zr,hr,ar,yn,gr,yr,ln,fn,pn,cn,An,$n,ri,un,di,ni,On,Fr,ii,mn,ws,si){const Li=Nt.addToLineVertexArray(Qt,zr);let Si,Ss,Ei,Uo,Cp,dv,hv,yL=0,vL=0,xL=0,bL=0,vj=-1,xj=-1;const Pl={};let _L=pT("");const wh=dr?dr.anchor:Qt;let bj=0,_j=0;if(yr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[bj,_j]=yr.layout.get("text-offset").evaluate(Fr,{},si).map(ia=>ia*Di):(bj=yr.layout.get("text-radial-offset").evaluate(Fr,{},si)*Di,_j=rj),Nt.allowVerticalPlacement&&hr.vertical){const ia=hr.vertical;if($n)dv=ij(ia),gr&&(hv=ij(gr));else{const sa=yr.layout.get("text-rotate").evaluate(Fr,{},si)+90;Ei=E_(ln,wh,Qt,fn,pn,cn,ia,An,sa,ri),gr&&(Uo=E_(ln,wh,Qt,fn,pn,cn,gr,di,sa))}}if(ar){const ia=yr.layout.get("icon-rotate").evaluate(Fr,{},si),sa=yr.layout.get("icon-text-fit")!=="none",fv=OD(ar,ia,mn,sa),Sj=gr?OD(gr,ia,mn,sa):void 0;Ss=E_(ln,wh,Qt,fn,pn,cn,ar,di,ia),yL=4*fv.length;const wL=Nt.iconSizeData;let Sh=null;wL.kind==="source"?(Sh=[zo*yr.layout.get("icon-size").evaluate(Fr,{},si)],Sh[0]>ju&&or(`${Nt.layerIds[0]}: Value for "icon-size" is >= ${nv}. Reduce your "icon-size".`)):wL.kind==="composite"&&(Sh=[zo*ii.compositeIconSizes[0].evaluate(Fr,{},si),zo*ii.compositeIconSizes[1].evaluate(Fr,{},si)],(Sh[0]>ju||Sh[1]>ju)&&or(`${Nt.layerIds[0]}: Value for "icon-size" is >= ${nv}. Reduce your "icon-size".`)),Nt.addSymbols(Nt.icon,fv,Sh,On,ni,Fr,!1,dr,Qt,Li.lineStartIndex,Li.lineLength,-1,ws,si),vj=Nt.icon.placedSymbolArray.length-1,Sj&&(vL=4*Sj.length,Nt.addSymbols(Nt.icon,Sj,Sh,On,ni,Fr,Ta.vertical,dr,Qt,Li.lineStartIndex,Li.lineLength,-1,ws,si),xj=Nt.icon.placedSymbolArray.length-1)}for(const ia in hr.horizontal){const sa=hr.horizontal[ia];Si||(_L=pT(sa.text),$n?Cp=ij(sa):Si=E_(ln,wh,Qt,fn,pn,cn,sa,An,yr.layout.get("text-rotate").evaluate(Fr,{},si),ri));const fv=sa.positionedLines.length===1;if(xL+=LD(Nt,dr,Qt,sa,yn,yr,$n,Fr,ri,Li,hr.vertical?Ta.horizontal:Ta.horizontalOnly,fv?Object.keys(hr.horizontal):[ia],Pl,vj,ii,ws,si),fv)break}hr.vertical&&(bL+=LD(Nt,dr,Qt,hr.vertical,yn,yr,$n,Fr,ri,Li,Ta.vertical,["vertical"],Pl,xj,ii,ws,si));let Mu=-1;const wj=(ia,sa)=>ia?Math.max(ia,sa):sa;Mu=wj(Cp,Mu),Mu=wj(dv,Mu),Mu=wj(hv,Mu);const wQ=Mu>-1?1:0;Nt.glyphOffsetArray.length>=Pu.MAX_GLYPHS&&or("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Fr.sortKey!==void 0&&Nt.addToSortKeyRanges(Nt.symbolInstances.length,Fr.sortKey),Nt.symbolInstances.emplaceBack(wh.x,wh.y,wh.z,Qt.x,Qt.y,Pl.right>=0?Pl.right:-1,Pl.center>=0?Pl.center:-1,Pl.left>=0?Pl.left:-1,Pl.vertical>=0?Pl.vertical:-1,vj,xj,_L,Si!==void 0?Si:Nt.collisionBoxArray.length,Si!==void 0?Si+1:Nt.collisionBoxArray.length,Ei!==void 0?Ei:Nt.collisionBoxArray.length,Ei!==void 0?Ei+1:Nt.collisionBoxArray.length,Ss!==void 0?Ss:Nt.collisionBoxArray.length,Ss!==void 0?Ss+1:Nt.collisionBoxArray.length,Uo||Nt.collisionBoxArray.length,Uo?Uo+1:Nt.collisionBoxArray.length,fn,xL,bL,yL,vL,wQ,0,bj,_j,Mu)})(c,Gt,ur,Dt,u,f,g,At,c.layers[0],c.collisionBoxArray,a.index,a.sourceLayerIndex,c.index,Me,lt,A,0,Ye,St,ne,a,x,M,$,V)};if(Qe==="line")for(const Dt of kD(a.geometry,0,0,nr,nr)){const Gt=$J(Dt,Ie,Xe,u.vertical||ce,f,Pe,Te,c.overscaling,nr);for(const Bt of Gt)ce&&KJ(c,ce.text,pt,Bt)||st(Dt,Bt,V)}else if(Qe==="line-center"){for(const Dt of a.geometry)if(Dt.length>1){const Gt=zJ(Dt,Xe,u.vertical||ce,f,Pe,Te);Gt&&st(Dt,Gt,V)}}else if(a.type==="Polygon")for(const Dt of qT(a.geometry,0)){const Gt=qJ(Dt,16);st(Dt[0],new pc(Gt.x,Gt.y,0,0,void 0),V)}else if(a.type==="LineString")for(const Dt of a.geometry)st(Dt,new pc(Dt[0].x,Dt[0].y,0,0,void 0),V);else if(a.type==="Point")for(const Dt of a.geometry)for(const Gt of Dt)st([Gt],new pc(Gt.x,Gt.y,0,0,void 0),V)}const nv=255,ju=nv*zo;function LD(c,a,u,f,g,x,S,j,A,M,$,V,G,Y,J,ne,ce){const ye=function(Te,Ie,Me,Ye,Xe,lt,St,Qe){const pt=[];if(Ie.positionedLines.length===0)return pt;const mt=Ye.layout.get("text-rotate").evaluate(lt,{})*Math.PI/180,bt=function(Bt){const ur=Bt[0],Nt=Bt[1],Qt=ur*Nt;return Qt>0?[ur,-Nt]:Qt<0?[-ur,Nt]:ur===0?[Nt,ur]:[Nt,-ur]}(Me);let At=Math.abs(Ie.top-Ie.bottom);for(const Bt of Ie.positionedLines)At-=Bt.lineOffset;const st=Ie.positionedLines.length,Dt=At/st;let Gt=Ie.top-Me[1];for(let Bt=0;Bt<st;++Bt){const ur=Ie.positionedLines[Bt];Gt=FJ(Ie,Dt,Gt,Bt);for(const Nt of ur.positionedGlyphs){if(!Nt.rect)continue;const Qt=Nt.rect||{};let dr=yD+1,zr=!0,hr=1,ar=0;if(Nt.imageName){const mn=St[Nt.imageName];if(!mn)continue;if(mn.sdf){or("SDF images are not supported in formatted text and will be ignored.");continue}zr=!1,hr=mn.pixelRatio,dr=Ls/hr}const yn=(Xe||Qe)&&Nt.vertical,gr=Nt.metrics.advance*Nt.scale/2,yr=Nt.metrics,ln=Nt.rect;if(ln===null)continue;Qe&&Ie.verticalizable&&(ar=Nt.imageName?gr-Nt.metrics.width*Nt.scale/2:0);const fn=Xe?[Nt.x+gr,Nt.y]:[0,0];let pn=[0,0],cn=[0,0],An=!1;Xe||(yn?(cn=[Nt.x+gr+bt[0],Nt.y+bt[1]-ar],An=!0):pn=[Nt.x+gr+Me[0],Nt.y+Me[1]-ar]);const $n=ln.w*Nt.scale/(hr*(Nt.localGlyph?$o:1)),ri=ln.h*Nt.scale/(hr*(Nt.localGlyph?$o:1));let un,di,ni,On;if(yn){const mn=Nt.y-Gt,ws=new W(-gr,gr-mn),si=-Math.PI/2,Li=new W(...cn);un=new W(-gr+pn[0],pn[1]),un._rotateAround(si,ws)._add(Li),un.x+=-mn+gr,un.y-=(yr.left-dr)*Nt.scale;const Si=Nt.imageName?yr.advance*Nt.scale:Di*Nt.scale,Ss=String.fromCharCode(Nt.glyph);wJ(Ss)?un.x+=(1-dr)*Nt.scale:SJ(Ss)?un.x+=Si-yr.height*Nt.scale+(-dr-1)*Nt.scale:un.x+=Nt.imageName||yr.width+2*dr===ln.w&&yr.height+2*dr===ln.h?(Si-ri)/2:(Si-(yr.height+2*dr)*Nt.scale)/2,di=new W(un.x,un.y-$n),ni=new W(un.x+ri,un.y),On=new W(un.x+ri,un.y-$n)}else{const mn=(yr.left-dr)*Nt.scale-gr+pn[0],ws=(-yr.top-dr)*Nt.scale+pn[1],si=mn+$n,Li=ws+ri;un=new W(mn,ws),di=new W(si,ws),ni=new W(mn,Li),On=new W(si,Li)}if(mt){let mn;mn=Xe?new W(0,0):An?new W(bt[0],bt[1]):new W(Me[0],Me[1]),un._rotateAround(mt,mn),di._rotateAround(mt,mn),ni._rotateAround(mt,mn),On._rotateAround(mt,mn)}const Fr=new W(0,0),ii=new W(0,0);pt.push({tl:un,tr:di,bl:ni,br:On,tex:Qt,writingMode:Ie.writingMode,glyphOffset:fn,sectionIndex:Nt.sectionIndex,isSDF:zr,pixelOffsetTL:Fr,pixelOffsetBR:ii,minFontScaleX:0,minFontScaleY:0})}}return pt}(0,f,A,x,S,j,g,c.allowVerticalPlacement),Pe=c.textSizeData;let ve=null;Pe.kind==="source"?(ve=[zo*x.layout.get("text-size").evaluate(j,{},ce)],ve[0]>ju&&or(`${c.layerIds[0]}: Value for "text-size" is >= ${nv}. Reduce your "text-size".`)):Pe.kind==="composite"&&(ve=[zo*J.compositeTextSizes[0].evaluate(j,{},ce),zo*J.compositeTextSizes[1].evaluate(j,{},ce)],(ve[0]>ju||ve[1]>ju)&&or(`${c.layerIds[0]}: Value for "text-size" is >= ${nv}. Reduce your "text-size".`)),c.addSymbols(c.text,ye,ve,A,S,j,$,a,u,M.lineStartIndex,M.lineLength,Y,ne,ce);for(const Te of V)G[Te]=c.text.placedSymbolArray.length-1;return 4*ye.length}function BD(c){for(const a in c)return c[a];return null}function E_(c,a,u,f,g,x,S,j,A,M){let $=S.top,V=S.bottom,G=S.left,Y=S.right;const J=S.collisionPadding;if(J&&(G-=J[0],$-=J[1],Y+=J[2],V+=J[3]),A){const ne=new W(G,$),ce=new W(Y,$),ye=new W(G,V),Pe=new W(Y,V),ve=ie(A);let Te=new W(0,0);M&&(Te=new W(M[0],M[1])),ne._rotateAround(ve,Te),ce._rotateAround(ve,Te),ye._rotateAround(ve,Te),Pe._rotateAround(ve,Te),G=Math.min(ne.x,ce.x,ye.x,Pe.x),Y=Math.max(ne.x,ce.x,ye.x,Pe.x),$=Math.min(ne.y,ce.y,ye.y,Pe.y),V=Math.max(ne.y,ce.y,ye.y,Pe.y)}return c.emplaceBack(a.x,a.y,a.z,u.x,u.y,G,$,Y,V,j,f,g,x),c.length-1}function ij(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const a=c.bottom-c.top;return a>0?Math.max(10,a):null}function KJ(c,a,u,f){const g=c.compareText;if(a in g){const x=g[a];for(let S=x.length-1;S>=0;S--)if(f.dist(x[S])<u)return!0}else g[a]=[];return g[a].push(f),!1}function zD(c,a){const u=c.fovAboveCenter,f=c.elevation?c.elevation.getMinElevationBelowMSL()*a:0,g=(c._camera.position[2]*c.worldSize-f)/Math.cos(c._pitch),x=Math.sin(u)*g/Math.sin(Math.max(Math.PI/2-c._pitch-u,.01)),S=Math.sin(c._pitch)*x+g;return Math.min(1.01*S,g*(1/c._horizonShift))}function bh(c,a){if(!a.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:a};const u=Math.pow(2,-c.z),f=c.x*u,g=(c.x+1)*u,x=c.y*u,S=(c.y+1)*u,j=Ea(f),A=Ea(g),M=Ki(x),$=Ki(S),V=a.project(j,M),G=a.project(A,M),Y=a.project(A,$),J=a.project(j,$);let ne=Math.min(V.x,G.x,Y.x,J.x),ce=Math.min(V.y,G.y,Y.y,J.y),ye=Math.max(V.x,G.x,Y.x,J.x),Pe=Math.max(V.y,G.y,Y.y,J.y);const ve=u/16;function Te(Me,Ye,Xe,lt,St,Qe){const pt=(Xe+St)/2,mt=(lt+Qe)/2,bt=a.project(Ea(pt),Ki(mt)),At=Math.max(0,ne-bt.x,ce-bt.y,bt.x-ye,bt.y-Pe);ne=Math.min(ne,bt.x),ye=Math.max(ye,bt.x),ce=Math.min(ce,bt.y),Pe=Math.max(Pe,bt.y),At>ve&&(Te(Me,bt,Xe,lt,pt,mt),Te(bt,Ye,pt,mt,St,Qe))}Te(V,G,f,x,g,x),Te(G,Y,g,x,g,S),Te(Y,J,g,S,f,S),Te(J,V,f,S,f,x),ne-=ve,ce-=ve,ye+=ve,Pe+=ve;const Ie=1/Math.max(ye-ne,Pe-ce);return{scale:Ie,x:ne*Ie,y:ce*Ie,x2:ye*Ie,y2:Pe*Ie,projection:a}}const ZJ=Do(new Float32Array(16));class Cu{constructor(a){this.spec=a,this.name=a.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(a,u){return{x:0,y:0,z:0}}unproject(a,u){return new on(0,0)}projectTilePoint(a,u,f){return{x:a,y:u,z:0}}locationPoint(a,u,f=!0){return a._coordinatePoint(a.locationCoordinate(u),f)}pixelsPerMeter(a,u){return Bo(1,a)*u}pixelSpaceConversion(a,u,f){return 1}farthestPixelDistance(a){return zD(a,a.pixelsPerMeter)}pointCoordinate(a,u,f,g){const x=a.horizonLineFromTop(!1),S=new W(u,Math.max(x,f));return a.rayIntersectionCoordinate(a.pointRayIntersection(S,g))}pointCoordinate3D(a,u,f){const g=new W(u,f);if(a.elevation)return a.elevation.pointCoordinate(g);{const x=this.pointCoordinate(a,g.x,g.y,0);return[x.x,x.y,x.z]}}isPointAboveHorizon(a,u){if(a.elevation)return!this.pointCoordinate3D(a,u.x,u.y);const f=a.horizonLineFromTop();return u.y<f}createInversionMatrix(a,u){return ZJ}createTileMatrix(a,u,f){let g,x,S;const j=f.canonical,A=Do(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=bh(j,this);g=1,x=M.x+f.wrap*M.scale,S=M.y,fh(A,A,[g/M.scale,g/M.scale,a.pixelsPerMeter/u])}else g=u/a.zoomScale(j.z),x=(j.x+Math.pow(2,j.z)*f.wrap)*g,S=j.y*g;return Oy(A,A,[x,S,0]),fh(A,A,[g/nr,g/nr,1]),A}upVector(a,u,f){return[0,0,1]}upVectorScale(a,u,f){return{metersToTile:1}}}class YJ extends Cu{constructor(a){super(a),this.range=[4,7],this.center=a.center||[-96,37.5];const[u,f]=this.parallels=a.parallels||[29.5,45.5],g=Math.sin(ie(u));this.n=(g+Math.sin(ie(f)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(a,u){const{n:f,c:g,r0:x}=this,S=ie(a-this.center[0]),j=ie(u),A=Math.sqrt(g-2*f*Math.sin(j))/f;return{x:A*Math.sin(S*f),y:A*Math.cos(S*f)-x,z:0}}unproject(a,u){const{n:f,c:g,r0:x}=this,S=x+u;let j=Math.atan2(a,Math.abs(S))*Math.sign(S);S*f<0&&(j-=Math.PI*Math.sign(a)*Math.sign(S));const A=ie(this.center[0])*f;j=Ne(j,-Math.PI-A,Math.PI-A);const M=me(ue(j/f)+this.center[0],-180,180),$=Math.asin(me((g-(a*a+S*S)*f*f)/(2*f),-1,1)),V=me(ue($),-Zi,Zi);return new on(M,V)}}const iv=1.340264,sv=-.081106,av=893e-6,ov=.003796,T_=Math.sqrt(3)/2;class JJ extends Cu{project(a,u){u=u/180*Math.PI,a=a/180*Math.PI;const f=Math.asin(T_*Math.sin(u)),g=f*f,x=g*g*g;return{x:.5*(a*Math.cos(f)/(T_*(iv+3*sv*g+x*(7*av+9*ov*g)))/Math.PI+.5),y:1-.5*(f*(iv+sv*g+x*(av+ov*g))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,g=f*f,x=g*g*g;for(let $,V,G,Y=0;Y<12&&(V=f*(iv+sv*g+x*(av+ov*g))-u,G=iv+3*sv*g+x*(7*av+9*ov*g),$=V/G,f=me(f-$,-Math.PI/3,Math.PI/3),g=f*f,x=g*g*g,!(Math.abs($)<1e-12));++Y);const S=T_*a*(iv+3*sv*g+x*(7*av+9*ov*g))/Math.cos(f),j=Math.asin(Math.sin(f)/T_),A=me(180*S/Math.PI,-180,180),M=me(180*j/Math.PI,-Zi,Zi);return new on(A,M)}}class QJ extends Cu{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){return{x:.5+a/360,y:.5-u/360,z:0}}unproject(a,u){const f=360*(a-.5),g=me(360*(.5-u),-Zi,Zi);return new on(f,g)}}const Tp=Math.PI/2;function j_(c){return Math.tan((Tp+c)/2)}class eQ extends Cu{constructor(a){super(a),this.center=a.center||[0,30];const[u,f]=this.parallels=a.parallels||[30,30];let g=ie(u),x=ie(f);this.southernCenter=g+x<0,this.southernCenter&&(g=-g,x=-x);const S=Math.cos(g),j=j_(g);this.n=g===x?Math.sin(g):Math.log(S/Math.cos(x))/Math.log(j_(x)/j),this.f=S*Math.pow(j_(g),this.n)/this.n}project(a,u){u=ie(u),this.southernCenter&&(u=-u),a=ie(a-this.center[0]);const f=1e-6,{n:g,f:x}=this;x>0?u<-Tp+f&&(u=-Tp+f):u>Tp-f&&(u=Tp-f);const S=x/Math.pow(j_(u),g);let j=S*Math.sin(g*a),A=x-S*Math.cos(g*a);return j=.5*(j/Math.PI+.5),A=.5*(A/Math.PI+.5),{x:j,y:this.southernCenter?A:1-A,z:0}}unproject(a,u){a=(2*a-.5)*Math.PI,this.southernCenter&&(u=1-u),u=(2*(1-u)-.5)*Math.PI;const{n:f,f:g}=this,x=g-u,S=Math.sign(x),j=Math.sign(f)*Math.sqrt(a*a+x*x);let A=Math.atan2(a,Math.abs(x))*S;x*f<0&&(A-=Math.PI*Math.sign(a)*S);const M=me(ue(A/f)+this.center[0],-180,180),$=me(ue(2*Math.atan(Math.pow(g/j,1/f))-Tp),-Zi,Zi);return new on(M,this.southernCenter?-$:$)}}class $D extends Cu{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(a,u){return{x:Sl(a),y:El(u),z:0}}unproject(a,u){const f=Ea(a),g=Ki(u);return new on(f,g)}}const FD=ie(Zi);class tQ extends Cu{project(a,u){const f=(u=ie(u))*u,g=f*f;return{x:.5*((a=ie(a))*(.8707-.131979*f+g*(g*(.003971*f-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(u*(1.007226+f*(.015085+g*(.028874*f-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,g=25,x=0,S=f*f;do{S=f*f;const M=S*S;x=(f*(1.007226+S*(.015085+M*(.028874*S-.044475-.005916*M)))-u)/(1.007226+S*(.045255+M*(.259866*S-.311325-.005916*11*M))),f=me(f-x,-FD,FD)}while(Math.abs(x)>1e-6&&--g>0);S=f*f;const j=me(ue(a/(.8707+S*(S*(S*S*S*(.003971-.001529*S)-.013791)-.131979))),-180,180),A=ue(f);return new on(j,A)}}const UD=ie(Zi);class rQ extends Cu{project(a,u){u=ie(u),a=ie(a);const f=Math.cos(u),g=2/Math.PI,x=Math.acos(f*Math.cos(a/2)),S=Math.sin(x)/x,j=.5*(a*g+2*f*Math.sin(a/2)/S)||0,A=.5*(u+Math.sin(u)/S)||0;return{x:.5*(j/Math.PI+.5),y:1-.5*(A/Math.PI+1),z:0}}unproject(a,u){let f=a=(2*a-.5)*Math.PI,g=u=(2*(1-u)-1)*Math.PI,x=25;const S=1e-6;let j=0,A=0;do{const M=Math.cos(g),$=Math.sin(g),V=2*$*M,G=$*$,Y=M*M,J=Math.cos(f/2),ne=Math.sin(f/2),ce=2*J*ne,ye=ne*ne,Pe=1-Y*J*J,ve=Pe?1/Pe:0,Te=Pe?Math.acos(M*J)*Math.sqrt(1/Pe):0,Ie=.5*(2*Te*M*ne+2*f/Math.PI)-a,Me=.5*(Te*$+g)-u,Ye=.5*ve*(Y*ye+Te*M*J*G)+1/Math.PI,Xe=ve*(ce*V/4-Te*$*ne),lt=.125*ve*(V*ne-Te*$*Y*ce),St=.5*ve*(G*J+Te*ye*M)+.5,Qe=Xe*lt-St*Ye;j=(Me*Xe-Ie*St)/Qe,A=(Ie*lt-Me*Ye)/Qe,f=me(f-j,-Math.PI,Math.PI),g=me(g-A,-UD,UD)}while((Math.abs(j)>S||Math.abs(A)>S)&&--x>0);return new on(ue(f),ue(g))}}class VD extends Cu{constructor(a){super(a),this.center=a.center||[0,0],this.parallels=a.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ie(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){const{scale:f,cosPhi:g}=this;return{x:ie(a)*g*f+.5,y:-Math.sin(ie(u))/g*f+.5,z:0}}unproject(a,u){const{scale:f,cosPhi:g}=this,x=-(u-.5)/f,S=me(ue((a-.5)/f)/g,-180,180),j=Math.asin(me(x*g,-1,1)),A=me(ue(j),-Zi,Zi);return new on(S,A)}}class nQ extends $D{constructor(a){super(a),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(a,u,f){const g=Uy(a,u,f);return Hn(g,g,Vy(wl(f))),{x:g[0],y:g[1],z:g[2]}}locationPoint(a,u){const f=up(u.lat,u.lng),g=xs([],f),x=a.elevation?a.elevation.getAtPointOrZero(a.locationCoordinate(u),a._centerAltitude):a._centerAltitude;By(f,f,g,Bo(1,0)*nr*x);const S=Do(new Float64Array(16));return hh(S,a.pixelMatrix,a.globeMatrix),Hn(f,f,S),new W(f[0],f[1])}pixelsPerMeter(a,u){return Bo(1,0)*u}pixelSpaceConversion(a,u,f){const g=Bo(1,a)*u,x=Or(Bo(1,45)*u,g,f);return this.pixelsPerMeter(a,u)/x}createTileMatrix(a,u,f){const g=PT(wl(f.canonical));return hh(new Float64Array(16),a.globeMatrix,g)}createInversionMatrix(a,u){const{center:f}=a,g=Vy(wl(u));return e_(g,g,ie(f.lng)),vT(g,g,ie(f.lat)),fh(g,g,[a._pixelsPerMercatorPixel,a._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(a,u,f,g){return gR(a,u,f,!0)||new hp(0,0)}pointCoordinate3D(a,u,f){const g=this.pointCoordinate(a,u,f,0);return[g.x,g.y,g.z]}isPointAboveHorizon(a,u){return!gR(a,u.x,u.y,!1)}farthestPixelDistance(a){const u=function(g,x){const S=g.cameraToCenterDistance,j=g._centerAltitude*x,A=g._camera,M=g._camera.forward(),$=uc([],Sa([],M,-S),[0,0,j]),V=g.worldSize/(2*Math.PI),G=[0,0,-V],Y=g.width/g.height,J=Math.tan(g.fovAboveCenter),ne=Sa([],A.up(),J),ce=Sa([],A.right(),J*Y),ye=xs([],uc([],uc([],M,ne),ce)),Pe=[];let ve;if(new wT($,ye).closestPointOnSphere(G,V,Pe)){const Te=uc([],Pe,G),Ie=Lo([],Te,$);ve=Math.cos(g.fovAboveCenter)*Ry(Ie)}else{const Te=Lo([],$,G),Ie=Lo([],G,$);xs(Ie,Ie);const Me=Ry(Te)-V;ve=Math.sqrt(Me*(Me+2*V));const Ye=Math.acos(ve/(V+Me))-Math.acos(Za(M,Ie));ve*=Math.cos(Ye)}return 1.01*ve}(a,this.pixelsPerMeter(a.center.lat,a.worldSize)),f=dp(a.zoom);if(f>0){const g=zD(a,Bo(1,a.center.lat)*a.worldSize),x=a.worldSize/(2*Math.PI),S=Math.max(a.width,a.height)/a.worldSize*Math.PI;return Or(u,g+x*(1-Math.cos(S)),Math.pow(f,10))}return u}upVector(a,u,f){return Uy(u,f,a,1)}upVectorScale(a){return{metersToTile:t_(n_(wl(a)))}}}function qD(c){const a=c.parallels,u=!!a&&Math.abs(a[0]+a[1])<.01;switch(c.name){case"mercator":return new $D(c);case"equirectangular":return new QJ(c);case"naturalEarth":return new tQ(c);case"equalEarth":return new JJ(c);case"winkelTripel":return new rQ(c);case"albers":return u?new VD(c):new YJ(c);case"lambertConformalConic":return u?new VD(c):new eQ(c);case"globe":return new nQ(c)}throw new Error(`Invalid projection name: ${c.name}`)}const iQ=f_.types,sQ=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function C_(c,a,u,f,g,x,S,j,A,M,$,V,G){const Y=j?Math.min(ju,Math.round(j[0])):0,J=j?Math.min(ju,Math.round(j[1])):0;c.emplaceBack(a,u,Math.round(32*f),Math.round(32*g),x,S,(Y<<1)+(A?1:0),J,16*M,16*$,256*V,256*G)}function P_(c,a,u,f,g,x,S){c.emplaceBack(a,u,f,g,x,S)}function A_(c,a,u,f,g){c.emplaceBack(a,u,f,g),c.emplaceBack(a,u,f,g),c.emplaceBack(a,u,f,g),c.emplaceBack(a,u,f,g)}function aQ(c){for(const a of c.sections)if(fT(a.text))return!0;return!1}class sj{constructor(a){this.layoutVertexArray=new yt,this.indexArray=new Yt,this.programConfigurations=a,this.segments=new ei,this.dynamicLayoutVertexArray=new _t,this.opacityVertexArray=new Jt,this.placedSymbolArray=new Qn,this.globeExtVertexArray=new jt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,u,f,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,pJ.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,gJ.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,sQ,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,mJ.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||g)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Vt(sj,"SymbolBuffers");class aj{constructor(a,u,f){this.layoutVertexArray=new a,this.layoutAttributes=u,this.indexArray=new f,this.segments=new ei,this.collisionVertexArray=new jr,this.collisionVertexArrayExt=new wr}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,yJ.members,!0),this.collisionVertexBufferExt=a.createVertexBuffer(this.collisionVertexArrayExt,vJ.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Vt(aj,"CollisionBuffers");class Pu{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(S=>S.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Do([]),this.placementViewportMatrix=Do([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=XT(this.zoom,u["text-size"]),this.iconSizeData=XT(this.zoom,u["icon-size"]);const f=this.layers[0].layout,g=f.get("symbol-sort-key"),x=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(S=>Ta[S]),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=a.sourceID,this.projection=a.projection}createArrays(){this.text=new sj(new dh(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new sj(new dh(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new vs,this.lineVertexArray=new sp,this.symbolInstances=new xn}calculateGlyphDependencies(a,u,f,g,x){for(let S=0;S<a.length;S++)if(u[a.charCodeAt(S)]=!0,g&&x){const j=ev[a.charAt(S)];j&&(u[j.charCodeAt(0)]=!0)}}populate(a,u,f,g){const x=this.layers[0],S=x.layout,j=this.projection.name==="globe",A=S.get("text-font"),M=S.get("text-field"),$=S.get("icon-image"),V=(M.value.kind!=="constant"||M.value.value instanceof ys&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),G=$.value.kind!=="constant"||!!$.value.value||Object.keys($.parameters).length>0,Y=S.get("symbol-sort-key");if(this.features=[],!V&&!G)return;const J=u.iconDependencies,ne=u.glyphDependencies,ce=u.availableImages,ye=new U(this.zoom);for(const{feature:Pe,id:ve,index:Te,sourceLayerIndex:Ie}of a){const Me=x._featureFilter.needGeometry,Ye=yh(Pe,Me);if(!x._featureFilter.filter(ye,Ye,f))continue;if(Me||(Ye.geometry=dc(Pe,f,g)),j&&Pe.type!==1&&f.z<=5){const Qe=Ye.geometry,pt=.98078528056,mt=(bt,At)=>Za(Uy(bt.x,bt.y,f,1),Uy(At.x,At.y,f,1))<pt;for(let bt=0;bt<Qe.length;bt++)Qe[bt]=gY(Qe[bt],mt)}let Xe,lt;if(V){const Qe=x.getValueAndResolveTokens("text-field",Ye,f,ce),pt=ys.factory(Qe);aQ(pt)&&(this.hasRTLText=!0),(!this.hasRTLText||P()==="unavailable"||this.hasRTLText&&z.isParsed())&&(Xe=_J(pt,x,Ye))}if(G){const Qe=x.getValueAndResolveTokens("icon-image",Ye,f,ce);lt=Qe instanceof Js?Qe:Js.fromString(Qe)}if(!Xe&&!lt)continue;const St=this.sortFeaturesByKey?Y.evaluate(Ye,{},f):void 0;if(this.features.push({id:ve,text:Xe,icon:lt,index:Te,sourceLayerIndex:Ie,geometry:Ye.geometry,properties:Pe.properties,type:iQ[Pe.type],sortKey:St}),lt&&(J[lt.name]=!0),Xe){const Qe=A.evaluate(Ye,{},f).join(","),pt=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ta.vertical)>=0;for(const mt of Xe.sections)if(mt.image)J[mt.image.name]=!0;else{const bt=Cy(Xe.toString()),At=mt.fontStack||Qe,st=ne[At]=ne[At]||{};this.calculateGlyphDependencies(mt.text,st,pt,this.allowVerticalPlacement,bt)}}}S.get("symbol-placement")==="line"&&(this.features=function(Pe){const ve={},Te={},Ie=[];let Me=0;function Ye(Qe){Ie.push(Pe[Qe]),Me++}function Xe(Qe,pt,mt){const bt=Te[Qe];return delete Te[Qe],Te[pt]=bt,Ie[bt].geometry[0].pop(),Ie[bt].geometry[0]=Ie[bt].geometry[0].concat(mt[0]),bt}function lt(Qe,pt,mt){const bt=ve[pt];return delete ve[pt],ve[Qe]=bt,Ie[bt].geometry[0].shift(),Ie[bt].geometry[0]=mt[0].concat(Ie[bt].geometry[0]),bt}function St(Qe,pt,mt){const bt=mt?pt[0][pt[0].length-1]:pt[0][0];return`${Qe}:${bt.x}:${bt.y}`}for(let Qe=0;Qe<Pe.length;Qe++){const pt=Pe[Qe],mt=pt.geometry,bt=pt.text?pt.text.toString():null;if(!bt){Ye(Qe);continue}const At=St(bt,mt),st=St(bt,mt,!0);if(At in Te&&st in ve&&Te[At]!==ve[st]){const Dt=lt(At,st,mt),Gt=Xe(At,st,Ie[Dt].geometry);delete ve[At],delete Te[st],Te[St(bt,Ie[Gt].geometry,!0)]=Gt,Ie[Dt].geometry=null}else At in Te?Xe(At,st,mt):st in ve?lt(At,st,mt):(Ye(Qe),ve[At]=Me-1,Te[st]=Me-1)}return Ie.filter(Qe=>Qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Pe,ve)=>Pe.sortKey-ve.sortKey)}update(a,u,f,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,u,this.layers,f,g),this.icon.programConfigurations.updatePaintArrays(a,u,this.layers,f,g))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=qD(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,u){const f=this.lineVertexArray.length;if(a.segment!==void 0)for(const{x:g,y:x}of u)this.lineVertexArray.emplaceBack(g,x);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(a,u,f,g,x,S,j,A,M,$,V,G,Y,J){const ne=a.indexArray,ce=a.layoutVertexArray,ye=a.globeExtVertexArray,Pe=a.segments.prepareSegment(4*u.length,ce,ne,this.canOverlap?S.sortKey:void 0),ve=this.glyphOffsetArray.length,Te=Pe.vertexLength,Ie=this.allowVerticalPlacement&&j===Ta.vertical?Math.PI/2:0,Me=S.text&&S.text.sections;for(let Xe=0;Xe<u.length;Xe++){const{tl:lt,tr:St,bl:Qe,br:pt,tex:mt,pixelOffsetTL:bt,pixelOffsetBR:At,minFontScaleX:st,minFontScaleY:Dt,glyphOffset:Gt,isSDF:Bt,sectionIndex:ur}=u[Xe],Nt=Pe.vertexLength,Qt=Gt[1];if(C_(ce,M.x,M.y,lt.x,Qt+lt.y,mt.x,mt.y,f,Bt,bt.x,bt.y,st,Dt),C_(ce,M.x,M.y,St.x,Qt+St.y,mt.x+mt.w,mt.y,f,Bt,At.x,bt.y,st,Dt),C_(ce,M.x,M.y,Qe.x,Qt+Qe.y,mt.x,mt.y+mt.h,f,Bt,bt.x,At.y,st,Dt),C_(ce,M.x,M.y,pt.x,Qt+pt.y,mt.x+mt.w,mt.y+mt.h,f,Bt,At.x,At.y,st,Dt),A){const{x:dr,y:zr,z:hr}=A.anchor,[ar,yn,gr]=A.up;P_(ye,dr,zr,hr,ar,yn,gr),P_(ye,dr,zr,hr,ar,yn,gr),P_(ye,dr,zr,hr,ar,yn,gr),P_(ye,dr,zr,hr,ar,yn,gr),A_(a.dynamicLayoutVertexArray,dr,zr,hr,Ie)}else A_(a.dynamicLayoutVertexArray,M.x,M.y,M.z,Ie);ne.emplaceBack(Nt,Nt+1,Nt+2),ne.emplaceBack(Nt+1,Nt+2,Nt+3),Pe.vertexLength+=4,Pe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Gt[0]),Xe!==u.length-1&&ur===u[Xe+1].sectionIndex||a.programConfigurations.populatePaintArrays(ce.length,S,S.index,{},Y,J,Me&&Me[ur])}const Ye=A?A.anchor:M;a.placedSymbolArray.emplaceBack(Ye.x,Ye.y,Ye.z,M.x,M.y,ve,this.glyphOffsetArray.length-ve,Te,$,V,M.segment,f?f[0]:0,f?f[1]:0,g[0],g[1],j,0,!1,0,G,0)}_commitLayoutVertex(a,u,f,g,x,S,j){a.emplaceBack(u,f,g,x,S,Math.round(j.x),Math.round(j.y))}_addCollisionDebugVertices(a,u,f,g,x,S,j){const A=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),M=A.vertexLength,$=j.tileAnchorX,V=j.tileAnchorY;for(let Y=0;Y<4;Y++)f.collisionVertexArray.emplaceBack(0,0,0,0);f.collisionVertexArrayExt.emplaceBack(u,-a.padding,-a.padding),f.collisionVertexArrayExt.emplaceBack(u,a.padding,-a.padding),f.collisionVertexArrayExt.emplaceBack(u,a.padding,a.padding),f.collisionVertexArrayExt.emplaceBack(u,-a.padding,a.padding),this._commitLayoutVertex(f.layoutVertexArray,g,x,S,$,V,new W(a.x1,a.y1)),this._commitLayoutVertex(f.layoutVertexArray,g,x,S,$,V,new W(a.x2,a.y1)),this._commitLayoutVertex(f.layoutVertexArray,g,x,S,$,V,new W(a.x2,a.y2)),this._commitLayoutVertex(f.layoutVertexArray,g,x,S,$,V,new W(a.x1,a.y2)),A.vertexLength+=4;const G=f.indexArray;G.emplaceBack(M,M+1),G.emplaceBack(M+1,M+2),G.emplaceBack(M+2,M+3),G.emplaceBack(M+3,M),A.primitiveLength+=4}_addTextDebugCollisionBoxes(a,u,f,g,x,S){for(let j=g;j<x;j++){const A=f.get(j),M=this.getSymbolInstanceTextSize(a,S,u,j);this._addCollisionDebugVertices(A,M,this.textCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,S)}}_addIconDebugCollisionBoxes(a,u,f,g,x,S){for(let j=g;j<x;j++){const A=f.get(j),M=this.getSymbolInstanceIconSize(a,u,S.placedIconSymbolIndex);this._addCollisionDebugVertices(A,M,this.iconCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,S)}}generateCollisionDebugBuffers(a,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new aj(Wt,cD.members,wi),this.iconCollisionBox=new aj(Wt,cD.members,wi);const f=yp(this.iconSizeData,a),g=yp(this.textSizeData,a);for(let x=0;x<this.symbolInstances.length;x++){const S=this.symbolInstances.get(x);this._addTextDebugCollisionBoxes(g,a,u,S.textBoxStartIndex,S.textBoxEndIndex,S),this._addTextDebugCollisionBoxes(g,a,u,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S),this._addIconDebugCollisionBoxes(f,a,u,S.iconBoxStartIndex,S.iconBoxEndIndex,S),this._addIconDebugCollisionBoxes(f,a,u,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex,S)}}getSymbolInstanceTextSize(a,u,f,g){const x=this.text.placedSymbolArray.get(u.rightJustifiedTextSymbolIndex>=0?u.rightJustifiedTextSymbolIndex:u.centerJustifiedTextSymbolIndex>=0?u.centerJustifiedTextSymbolIndex:u.leftJustifiedTextSymbolIndex>=0?u.leftJustifiedTextSymbolIndex:u.verticalPlacedTextSymbolIndex>=0?u.verticalPlacedTextSymbolIndex:g),S=y_(this.textSizeData,a,x)/Di;return this.tilePixelRatio*S}getSymbolInstanceIconSize(a,u,f){const g=this.icon.placedSymbolArray.get(f),x=y_(this.iconSizeData,a,g);return this.tilePixelRatio*x}_commitDebugCollisionVertexUpdate(a,u,f){a.emplaceBack(u,-f,-f),a.emplaceBack(u,f,-f),a.emplaceBack(u,f,f),a.emplaceBack(u,-f,f)}_updateTextDebugCollisionBoxes(a,u,f,g,x,S){for(let j=g;j<x;j++){const A=f.get(j),M=this.getSymbolInstanceTextSize(a,S,u,j);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,M,A.padding)}}_updateIconDebugCollisionBoxes(a,u,f,g,x,S){for(let j=g;j<x;j++){const A=f.get(j),M=this.getSymbolInstanceIconSize(a,u,S);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,M,A.padding)}}updateCollisionDebugBuffers(a,u){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=yp(this.iconSizeData,a),g=yp(this.textSizeData,a);for(let x=0;x<this.symbolInstances.length;x++){const S=this.symbolInstances.get(x);this._updateTextDebugCollisionBoxes(g,a,u,S.textBoxStartIndex,S.textBoxEndIndex,S),this._updateTextDebugCollisionBoxes(g,a,u,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S),this._updateIconDebugCollisionBoxes(f,a,u,S.iconBoxStartIndex,S.iconBoxEndIndex,S.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(f,a,u,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex,S.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(a,u,f,g,x,S,j,A,M){const $={};if(u<f){const{x1:V,y1:G,x2:Y,y2:J,padding:ne,projectedAnchorX:ce,projectedAnchorY:ye,projectedAnchorZ:Pe,tileAnchorX:ve,tileAnchorY:Te,featureIndex:Ie}=a.get(u);$.textBox={x1:V,y1:G,x2:Y,y2:J,padding:ne,projectedAnchorX:ce,projectedAnchorY:ye,projectedAnchorZ:Pe,tileAnchorX:ve,tileAnchorY:Te},$.textFeatureIndex=Ie}if(g<x){const{x1:V,y1:G,x2:Y,y2:J,padding:ne,projectedAnchorX:ce,projectedAnchorY:ye,projectedAnchorZ:Pe,tileAnchorX:ve,tileAnchorY:Te,featureIndex:Ie}=a.get(g);$.verticalTextBox={x1:V,y1:G,x2:Y,y2:J,padding:ne,projectedAnchorX:ce,projectedAnchorY:ye,projectedAnchorZ:Pe,tileAnchorX:ve,tileAnchorY:Te},$.verticalTextFeatureIndex=Ie}if(S<j){const{x1:V,y1:G,x2:Y,y2:J,padding:ne,projectedAnchorX:ce,projectedAnchorY:ye,projectedAnchorZ:Pe,tileAnchorX:ve,tileAnchorY:Te,featureIndex:Ie}=a.get(S);$.iconBox={x1:V,y1:G,x2:Y,y2:J,padding:ne,projectedAnchorX:ce,projectedAnchorY:ye,projectedAnchorZ:Pe,tileAnchorX:ve,tileAnchorY:Te},$.iconFeatureIndex=Ie}if(A<M){const{x1:V,y1:G,x2:Y,y2:J,padding:ne,projectedAnchorX:ce,projectedAnchorY:ye,projectedAnchorZ:Pe,tileAnchorX:ve,tileAnchorY:Te,featureIndex:Ie}=a.get(A);$.verticalIconBox={x1:V,y1:G,x2:Y,y2:J,padding:ne,projectedAnchorX:ce,projectedAnchorY:ye,projectedAnchorZ:Pe,tileAnchorX:ve,tileAnchorY:Te},$.verticalIconFeatureIndex=Ie}return $}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,u){const f=a.placedSymbolArray.get(u),g=f.vertexStartIndex+4*f.numGlyphs;for(let x=f.vertexStartIndex;x<g;x+=4)a.indexArray.emplaceBack(x,x+1,x+2),a.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(a),f=Math.cos(a),g=[],x=[],S=[];for(let j=0;j<this.symbolInstances.length;++j){S.push(j);const A=this.symbolInstances.get(j);g.push(0|Math.round(u*A.tileAnchorX+f*A.tileAnchorY)),x.push(A.featureIndex)}return S.sort((j,A)=>g[j]-g[A]||x[A]-x[j]),S}addToSortKeyRanges(a,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:x,leftJustifiedTextSymbolIndex:S,verticalPlacedTextSymbolIndex:j,placedIconSymbolIndex:A,verticalPlacedIconSymbolIndex:M}=f;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),x>=0&&x!==g&&this.addIndicesForPlacedSymbol(this.text,x),S>=0&&S!==x&&S!==g&&this.addIndicesForPlacedSymbol(this.text,S),j>=0&&this.addIndicesForPlacedSymbol(this.text,j),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Vt(Pu,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Pu.MAX_GLYPHS=65535,Pu.addDynamicAttributes=A_;const oQ=new Se({"symbol-placement":new ee(ot.layout_symbol["symbol-placement"]),"symbol-spacing":new ee(ot.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ee(ot.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new de(ot.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ee(ot.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ee(ot.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ee(ot.layout_symbol["icon-ignore-placement"]),"icon-optional":new ee(ot.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ee(ot.layout_symbol["icon-rotation-alignment"]),"icon-size":new de(ot.layout_symbol["icon-size"]),"icon-text-fit":new ee(ot.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ee(ot.layout_symbol["icon-text-fit-padding"]),"icon-image":new de(ot.layout_symbol["icon-image"]),"icon-rotate":new de(ot.layout_symbol["icon-rotate"]),"icon-padding":new ee(ot.layout_symbol["icon-padding"]),"icon-keep-upright":new ee(ot.layout_symbol["icon-keep-upright"]),"icon-offset":new de(ot.layout_symbol["icon-offset"]),"icon-anchor":new de(ot.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ee(ot.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ee(ot.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ee(ot.layout_symbol["text-rotation-alignment"]),"text-field":new de(ot.layout_symbol["text-field"]),"text-font":new de(ot.layout_symbol["text-font"]),"text-size":new de(ot.layout_symbol["text-size"]),"text-max-width":new de(ot.layout_symbol["text-max-width"]),"text-line-height":new de(ot.layout_symbol["text-line-height"]),"text-letter-spacing":new de(ot.layout_symbol["text-letter-spacing"]),"text-justify":new de(ot.layout_symbol["text-justify"]),"text-radial-offset":new de(ot.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ee(ot.layout_symbol["text-variable-anchor"]),"text-anchor":new de(ot.layout_symbol["text-anchor"]),"text-max-angle":new ee(ot.layout_symbol["text-max-angle"]),"text-writing-mode":new ee(ot.layout_symbol["text-writing-mode"]),"text-rotate":new de(ot.layout_symbol["text-rotate"]),"text-padding":new ee(ot.layout_symbol["text-padding"]),"text-keep-upright":new ee(ot.layout_symbol["text-keep-upright"]),"text-transform":new de(ot.layout_symbol["text-transform"]),"text-offset":new de(ot.layout_symbol["text-offset"]),"text-allow-overlap":new ee(ot.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ee(ot.layout_symbol["text-ignore-placement"]),"text-optional":new ee(ot.layout_symbol["text-optional"])});var oj={paint:new Se({"icon-opacity":new de(ot.paint_symbol["icon-opacity"]),"icon-color":new de(ot.paint_symbol["icon-color"]),"icon-halo-color":new de(ot.paint_symbol["icon-halo-color"]),"icon-halo-width":new de(ot.paint_symbol["icon-halo-width"]),"icon-halo-blur":new de(ot.paint_symbol["icon-halo-blur"]),"icon-translate":new ee(ot.paint_symbol["icon-translate"]),"icon-translate-anchor":new ee(ot.paint_symbol["icon-translate-anchor"]),"text-opacity":new de(ot.paint_symbol["text-opacity"]),"text-color":new de(ot.paint_symbol["text-color"],{runtimeType:Rs,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new de(ot.paint_symbol["text-halo-color"]),"text-halo-width":new de(ot.paint_symbol["text-halo-width"]),"text-halo-blur":new de(ot.paint_symbol["text-halo-blur"]),"text-translate":new ee(ot.paint_symbol["text-translate"]),"text-translate-anchor":new ee(ot.paint_symbol["text-translate-anchor"])}),layout:oQ};class WD{constructor(a){this.type=a.property.overrides?a.property.overrides.runtimeType:iu,this.defaultValue=a}evaluate(a){if(a.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(a.formattedSection))return u.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Vt(WD,"FormatSectionOverride",{omit:["defaultValue"]});class N_ extends Ro{constructor(a){super(a,oj)}recalculate(a,u){super.recalculate(a,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const g=[];for(const x of f)g.indexOf(x)<0&&g.push(x);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(a,u,f,g){const x=this.layout.get(a).evaluate(u,{},f,g),S=this._unevaluatedLayout._values[a];return S.isDataDriven()||gu(S.value)||!x?x:function(j,A){return A.replace(/{([^{}]+)}/g,(M,$)=>$ in j?String(j[$]):"")}(u.properties,x)}createBucket(a){return new Pu(a)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const a of oj.paint.overridableProperties){if(!N_.hasPaintOverride(this.layout,a))continue;const u=this.paint.get(a),f=new WD(u),g=new Yf(f,u.property.specification);let x=null;x=u.value.kind==="constant"||u.value.kind==="source"?new gy("source",g):new rh("composite",g,u.value.zoomStops,u.value._interpolationType),this.paint._values[a]=new fe(u.property,x,u.parameters)}}_handleOverridablePaintPropertyUpdate(a,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&N_.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,u){const f=a.get("text-field"),g=oj.paint.properties[u];let x=!1;const S=j=>{for(const A of j)if(g.overrides&&g.overrides.hasOverride(A))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof ys)S(f.value.value.sections);else if(f.value.kind==="source"){const j=M=>{x||(M instanceof Ql&&zn(M.value)===zd?S(M.value.sections):M instanceof vl?S(M.sections):M.eachChild(j))},A=f.value;A._styleExpression&&j(A._styleExpression.expression)}return x}getProgramConfiguration(a){return new Su(this,a)}}var lQ={paint:new Se({"background-color":new ee(ot.paint_background["background-color"]),"background-pattern":new ee(ot.paint_background["background-pattern"]),"background-opacity":new ee(ot.paint_background["background-opacity"])})},cQ={paint:new Se({"raster-opacity":new ee(ot.paint_raster["raster-opacity"]),"raster-hue-rotate":new ee(ot.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ee(ot.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ee(ot.paint_raster["raster-brightness-max"]),"raster-saturation":new ee(ot.paint_raster["raster-saturation"]),"raster-contrast":new ee(ot.paint_raster["raster-contrast"]),"raster-resampling":new ee(ot.paint_raster["raster-resampling"]),"raster-fade-duration":new ee(ot.paint_raster["raster-fade-duration"])})};class uQ extends Ro{constructor(a){super(a,{}),this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)}onRemove(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)}}var dQ={paint:new Se({"sky-type":new ee(ot.paint_sky["sky-type"]),"sky-atmosphere-sun":new ee(ot.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ee(ot.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ee(ot.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ee(ot.paint_sky["sky-gradient-radius"]),"sky-gradient":new we(ot.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ee(ot.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ee(ot.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ee(ot.paint_sky["sky-opacity"])})};function lj(c,a,u){const f=[0,0,1],g=uR([]);return hR(g,g,u?-ie(c)+Math.PI:ie(c)),dR(g,g,-ie(a)),aR(f,f,g),xs(f,f)}const hQ={circle:class extends Ro{constructor(c){super(c,SY)}createBucket(c){return new OT(c)}queryRadius(c){const a=c;return fp("circle-radius",this,a)+fp("circle-stroke-width",this,a)+a_(this.paint.get("circle-translate"))}queryIntersectsFeature(c,a,u,f,g,x,S,j){const A=OR(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,c.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(a,u)+this.paint.get("circle-stroke-width").evaluate(a,u);return RR(c,f,x,S,j,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",A,M)}getProgramIds(){return["circle"]}getProgramConfiguration(c){return new Su(this,c)}},heatmap:class extends Ro{createBucket(c){return new LR(c)}constructor(c){super(c,CY),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=BT({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return fp("heatmap-radius",this,c)}queryIntersectsFeature(c,a,u,f,g,x,S,j){const A=this.paint.get("heatmap-radius").evaluate(a,u);return RR(c,f,x,S,j,!0,!0,new W(0,0),A)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(c){return new Su(this,c)}},hillshade:class extends Ro{constructor(c){super(c,PY)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Ro{constructor(c){super(c,qY)}getProgramIds(){const c=this.paint.get("fill-pattern"),a=c&&c.constantOr(1),u=[a?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&u.push(a&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),u}getProgramConfiguration(c){return new Su(this,c)}recalculate(c,a){super.recalculate(c,a);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new d_(c)}queryRadius(){return a_(this.paint.get("fill-translate"))}queryIntersectsFeature(c,a,u,f,g,x){return!c.queryGeometry.isAboveHorizon&&AR(IR(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,c.pixelToTileUnitsFactor),f)}isTileClipped(){return!0}},"fill-extrusion":class extends Ro{constructor(c){super(c,aJ)}createBucket(c){return new Yy(c)}queryRadius(){return a_(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(c){return new Su(this,c)}queryIntersectsFeature(c,a,u,f,g,x,S,j,A){const M=OR(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,c.pixelToTileUnitsFactor),$=this.paint.get("fill-extrusion-height").evaluate(a,u),V=this.paint.get("fill-extrusion-base").evaluate(a,u),G=[0,0],Y=j&&x.elevation,J=x.elevation?x.elevation.exaggeration():1,ne=c.tile.getBucket(this);if(Y&&ne instanceof Yy){const Te=ne.centroidVertexArray,Ie=A+1;Ie<Te.length&&(G[0]=Te.geta_centroid_pos0(Ie),G[1]=Te.geta_centroid_pos1(Ie))}if(G[0]===0&&G[1]===1)return!1;x.projection.name==="globe"&&(f=tD([f],[new W(0,0),new W(nr,nr)],c.tileID.canonical).map(Te=>Te.polygon).flat());const ce=Y?j:null,[ye,Pe]=function(Te,Ie,Me,Ye,Xe,lt,St,Qe,pt,mt,bt){return Te.projection.name==="globe"?function(At,st,Dt,Gt,Bt,ur,Nt,Qt,dr,zr,hr){const ar=[],yn=[],gr=At.projection.upVectorScale(hr,At.center.lat,At.worldSize).metersToTile,yr=[0,0,0,1],ln=[0,0,0,1],fn=(cn,An,$n,ri)=>{cn[0]=An,cn[1]=$n,cn[2]=ri,cn[3]=1},pn=eD();Dt>0&&(Dt+=pn),Gt+=pn;for(const cn of st){const An=[],$n=[];for(const ri of cn){const un=ri.x+Bt.x,di=ri.y+Bt.y,ni=At.projection.projectTilePoint(un,di,hr),On=At.projection.upVector(hr,ri.x,ri.y);let Fr=Dt,ii=Gt;if(Nt){const mn=sD(un,di,Dt,Gt,Nt,Qt,dr,zr);Fr+=mn.base,ii+=mn.top}Dt!==0?fn(yr,ni.x+On[0]*gr*Fr,ni.y+On[1]*gr*Fr,ni.z+On[2]*gr*Fr):fn(yr,ni.x,ni.y,ni.z),fn(ln,ni.x+On[0]*gr*ii,ni.y+On[1]*gr*ii,ni.z+On[2]*gr*ii),Hn(yr,yr,ur),Hn(ln,ln,ur),An.push(new gp(yr[0],yr[1],yr[2])),$n.push(new gp(ln[0],ln[1],ln[2]))}ar.push(An),yn.push($n)}return[ar,yn]}(Te,Ie,Me,Ye,Xe,lt,St,Qe,pt,mt,bt):St?function(At,st,Dt,Gt,Bt,ur,Nt,Qt,dr){const zr=[],hr=[],ar=[0,0,0,1];for(const yn of At){const gr=[],yr=[];for(const ln of yn){const fn=ln.x+Gt.x,pn=ln.y+Gt.y,cn=sD(fn,pn,st,Dt,ur,Nt,Qt,dr);ar[0]=fn,ar[1]=pn,ar[2]=cn.base,ar[3]=1,ph(ar,ar,Bt),ar[3]=Math.max(ar[3],1e-5);const An=new gp(ar[0]/ar[3],ar[1]/ar[3],ar[2]/ar[3]);ar[0]=fn,ar[1]=pn,ar[2]=cn.top,ar[3]=1,ph(ar,ar,Bt),ar[3]=Math.max(ar[3],1e-5);const $n=new gp(ar[0]/ar[3],ar[1]/ar[3],ar[2]/ar[3]);gr.push(An),yr.push($n)}zr.push(gr),hr.push(yr)}return[zr,hr]}(Ie,Me,Ye,Xe,lt,St,Qe,pt,mt):function(At,st,Dt,Gt,Bt){const ur=[],Nt=[],Qt=Bt[8]*st,dr=Bt[9]*st,zr=Bt[10]*st,hr=Bt[11]*st,ar=Bt[8]*Dt,yn=Bt[9]*Dt,gr=Bt[10]*Dt,yr=Bt[11]*Dt;for(const ln of At){const fn=[],pn=[];for(const cn of ln){const An=cn.x+Gt.x,$n=cn.y+Gt.y,ri=Bt[0]*An+Bt[4]*$n+Bt[12],un=Bt[1]*An+Bt[5]*$n+Bt[13],di=Bt[2]*An+Bt[6]*$n+Bt[14],ni=Bt[3]*An+Bt[7]*$n+Bt[15],On=ri+Qt,Fr=un+dr,ii=di+zr,mn=Math.max(ni+hr,1e-5),ws=ri+ar,si=un+yn,Li=di+gr,Si=Math.max(ni+yr,1e-5);fn.push(new gp(On/mn,Fr/mn,ii/mn)),pn.push(new gp(ws/Si,si/Si,Li/Si))}ur.push(fn),Nt.push(pn)}return[ur,Nt]}(Ie,Me,Ye,Xe,lt)}(x,f,V,$,M,S,ce,G,J,x.center.lat,c.tileID.canonical),ve=c.queryGeometry;return function(Te,Ie,Me){let Ye=1/0;AR(Me,Ie)&&(Ye=iD(Me,Ie[0]));for(let Xe=0;Xe<Ie.length;Xe++){const lt=Ie[Xe],St=Te[Xe];for(let Qe=0;Qe<lt.length-1;Qe++){const pt=lt[Qe],mt=[pt,lt[Qe+1],St[Qe+1],St[Qe],pt];PR(Me,mt)&&(Ye=Math.min(Ye,iD(Me,mt)))}}return Ye!==1/0&&Ye}(ye,Pe,ve.isPointQuery()?ve.screenBounds:ve.screenGeometry)}},line:class extends Ro{constructor(c){super(c,aD),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const a=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=a._styleExpression&&a._styleExpression.expression instanceof ny,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,a){super.recalculate(c,a),this.paint._values["line-floorwidth"]=oD.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new g_(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(c){return new Su(this,c)}queryRadius(c){const a=c,u=lD(fp("line-width",this,a),fp("line-gap-width",this,a)),f=fp("line-offset",this,a);return u/2+Math.abs(f)+a_(this.paint.get("line-translate"))}queryIntersectsFeature(c,a,u,f,g,x){if(c.queryGeometry.isAboveHorizon)return!1;const S=IR(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,c.pixelToTileUnitsFactor),j=c.pixelToTileUnitsFactor/2*lD(this.paint.get("line-width").evaluate(a,u),this.paint.get("line-gap-width").evaluate(a,u)),A=this.paint.get("line-offset").evaluate(a,u);return A&&(f=function(M,$){const V=[],G=new W(0,0);for(let Y=0;Y<M.length;Y++){const J=M[Y],ne=[];for(let ce=0;ce<J.length;ce++){const ye=J[ce],Pe=J[ce+1],ve=ce===0?G:ye.sub(J[ce-1])._unit()._perp(),Te=ce===J.length-1?G:Pe.sub(ye)._unit()._perp(),Ie=ve._add(Te)._unit();Ie._mult(1/(Ie.x*Te.x+Ie.y*Te.y)),ne.push(Ie._mult($)._add(ye))}V.push(ne)}return V}(f,A*c.pixelToTileUnitsFactor)),function(M,$,V){for(let G=0;G<$.length;G++){const Y=$[G];if(M.length>=3){for(let J=0;J<Y.length;J++)if(vh(M,Y[J]))return!0}if(xY(M,Y,V))return!0}return!1}(S,f,j)}isTileClipped(){return!0}},symbol:N_,background:class extends Ro{constructor(c){super(c,lQ)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ro{constructor(c){super(c,cQ)}getProgramIds(){return["raster"]}},sky:class extends Ro{constructor(c){super(c,dQ),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=BT({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const a=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==a.azimuthal||this._lightPosition.polar!==a.polar}return!1}getCenter(c,a){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),g=!f,x=c.style.light,S=x.properties.get("position");return g&&x.properties.get("anchor")==="viewport"&&or("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?lj(S.azimuthal,90-S.polar,a):lj(f[0],90-f[1],a)}const u=this.paint.get("sky-gradient-center");return lj(u[0],90-u[1],a)}is3D(){return!1}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}}};class lv{constructor(a,u,f,g){this.context=a,this.format=f,this.texture=a.gl.createTexture(),this.update(u,g)}update(a,u,f){const{width:g,height:x}=a,{context:S}=this,{gl:j}=S,{HTMLImageElement:A,HTMLCanvasElement:M,HTMLVideoElement:$,ImageData:V,ImageBitmap:G}=p;if(j.bindTexture(j.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===j.RGBA&&(!u||u.premultiply!==!1)),f||this.size&&this.size[0]===g&&this.size[1]===x){const{x:Y,y:J}=f||{x:0,y:0};a instanceof A||a instanceof M||a instanceof $||a instanceof V||G&&a instanceof G?j.texSubImage2D(j.TEXTURE_2D,0,Y,J,j.RGBA,j.UNSIGNED_BYTE,a):j.texSubImage2D(j.TEXTURE_2D,0,Y,J,g,x,j.RGBA,j.UNSIGNED_BYTE,a.data)}else this.size=[g,x],a instanceof A||a instanceof M||a instanceof $||a instanceof V||G&&a instanceof G?j.texImage2D(j.TEXTURE_2D,0,this.format,this.format,j.UNSIGNED_BYTE,a):j.texImage2D(j.TEXTURE_2D,0,this.format,g,x,0,this.format,j.UNSIGNED_BYTE,a.data);this.useMipmap=!!(u&&u.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&j.generateMipmap(j.TEXTURE_2D)}bind(a,u){const{context:f}=this,{gl:g}=f;g.bindTexture(g.TEXTURE_2D,this.texture),a!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,a),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?a===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_NEAREST:a),this.filter=a),u!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,u),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class fQ{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class pQ{constructor(){this.tasks={},this.taskQueue=[],ct(["process"],this),this.invoker=new fQ(this.process),this.nextId=0}add(a,u){const f=this.nextId++,g=function({type:x,isSymbolTile:S,zoom:j}){return j=j||0,x==="message"?0:x!=="maybePrepare"||S?x!=="parseTile"||S?x==="parseTile"&&S?300-j:x==="maybePrepare"&&S?400-j:500:200-j:100-j}(u);if(g===0){Mn();try{a()}finally{}return{cancel:()=>{}}}return this.tasks[f]={fn:a,metadata:u,priority:g,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){Mn();try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const a=this.pick();if(a===null)return;const u=this.tasks[a];if(delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),!u)return;u.fn()}finally{}}pick(){let a=null,u=1/0;for(let g=0;g<this.taskQueue.length;g++){const x=this.tasks[this.taskQueue[g]];x.priority<u&&(u=x.priority,a=g)}if(a===null)return null;const f=this.taskQueue[a];return this.taskQueue.splice(a,1),f}remove(){this.invoker.remove()}}class GD{constructor(a){this._stringToNumber={},this._numberToString=[];for(let u=0;u<a.length;u++){const f=a[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(a){return this._stringToNumber[a]}decode(a){return this._numberToString[a]}}const mQ=["tile","layer","source","sourceLayer","state"];class HD{constructor(a,u,f,g,x){this.type="Feature",this._vectorTileFeature=a,this._z=u,this._x=f,this._y=g,this.properties=a.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(a.id=this.id);for(const u of mQ)this[u]!==void 0&&(a[u]=this[u]);return a}}const Qa=32,Tl=33,Au=new Uint16Array(8184);for(let c=0;c<2046;c++){let a=c+2,u=0,f=0,g=0,x=0,S=0,j=0;for(1&a?g=x=S=Qa:u=f=j=Qa;(a>>=1)>1;){const M=u+g>>1,$=f+x>>1;1&a?(g=u,x=f,u=S,f=j):(u=g,f=x,g=S,x=j),S=M,j=$}const A=4*c;Au[A+0]=u,Au[A+1]=f,Au[A+2]=g,Au[A+3]=x}const jl=new Uint16Array(2178),Nu=new Uint8Array(1089),k_=new Uint16Array(1089);function XD(c){return c===0?-.03125:c===32?.03125:0}var KD=Fe([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const ZD={type:2,extent:nr,loadGeometry:()=>[[new W(0,0),new W(nr+1,0),new W(nr+1,nr+1),new W(0,nr+1),new W(0,0)]]};class cj{constructor(a,u,f,g,x){this.tileID=a,this.uid=Pt(),this.uses=0,this.tileSize=u,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=x,this.expiredRequestCount=0,this.state="loading",g&&g.transform&&(this.projection=g.transform.projection)}registerFadeDuration(a){const u=a+this.timeAdded;u<So.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=bh(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(a,u,f){if(this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(g,x){const S={};if(!x)return S;for(const j of g){const A=j.layerIds.map(M=>x.getLayer(M)).filter(Boolean);if(A.length!==0){j.layers=A,j.stateDependentLayerIds&&(j.stateDependentLayers=j.stateDependentLayerIds.map(M=>A.filter($=>$.id===M)[0]));for(const M of A)S[M.id]=j}}return S}(a.buckets,u.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const x=this.buckets[g];if(x instanceof Pu){if(this.hasSymbolBuckets=!0,!f)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const x=this.buckets[g];if(x instanceof Pu&&x.hasRTLText){this.hasRTLText=!0,z.isLoading()||z.isLoaded()||P()!=="deferred"||D();break}}this.queryPadding=0;for(const g in this.buckets){const x=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(g).queryRadius(x))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas)}else this.collisionBoxArray=new an}unloadVectorData(){if(this.hasData()){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(a){return this.buckets[a.id]}upload(a){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(a)}const u=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new lv(a,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new lv(a,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new lv(a,this.lineAtlas.image,u.ALPHA),this.lineAtlas.uploaded=!0)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,u,f,g,x,S,j,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:g,pixelPosMatrix:j,transform:S,params:x,tileTransform:this.tileTransform},a,u,f):{}}querySourceFeatures(a,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),x=u?u.sourceLayer:"",S=g._geojsonTileLayer||g[x];if(!S)return;const j=tp(u&&u.filter),{z:A,x:M,y:$}=this.tileID.canonical,V={z:A,x:M,y:$};for(let G=0;G<S.length;G++){const Y=S.feature(G);if(j.needGeometry){const ce=yh(Y,!0);if(!j.filter(new U(this.tileID.overscaledZ),ce,this.tileID.canonical))continue}else if(!j.filter(new U(this.tileID.overscaledZ),Y))continue;const J=f.getId(Y,x),ne=new HD(Y,A,M,$,J);ne.tile=V,a.push(ne)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const u=this.expirationTime;if(a.cacheControl){const f=vn(a.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(u)if(this.expirationTime<u)g=!0;else{const x=this.expirationTime-u;x?this.expirationTime=f+Math.max(x,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(a,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(a).length===0||!u)return;const f=this.latestFeatureIndex.loadVTLayers(),g=u.style.listImages();for(const x in this.buckets){if(!u.style.hasLayer(x))continue;const S=this.buckets[x],j=S.layers[0].sourceLayer||"_geojsonTileLayer",A=f[j],M=a[j];if(!A||!M||Object.keys(M).length===0)continue;if(S.update(M,A,g,this.imageAtlas&&this.imageAtlas.patternPositions||{}),S instanceof g_||S instanceof d_){const V=u.style._getSourceCache(S.layers[0].source);u._terrain&&u._terrain.enabled&&V&&S.programConfigurations.needsUpload&&u._terrain._clearRenderCacheForTile(V.id,this.tileID)}const $=u&&u.style&&u.style.getLayer(x);$&&(this.queryPadding=Math.max(this.queryPadding,$.queryRadius(S)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<So.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=So.now()+a}setTexture(a,u){const f=u.context,g=f.gl;this.texture=this.texture||u.getTileTexture(a.width),this.texture?this.texture.update(a,{useMipmap:!0}):(this.texture=new lv(f,a,g.RGBA,{useMipmap:!0}),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE))}setDependencies(a,u){const f={};for(const g of u)f[g]=!0;this.dependencies[a]=f}hasDependency(a,u){for(const f of a){const g=this.dependencies[f];if(g){for(const x of u)if(g[x])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(a,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const f=dc(ZD,this.tileID.canonical,this.tileTransform)[0],g=new wt,x=new ta;for(let S=0;S<f.length;S++){const{x:j,y:A}=f[S];g.emplaceBack(j,A),x.emplaceBack(S)}x.emplaceBack(0),this._tileDebugIndexBuffer=a.createIndexBuffer(x),this._tileDebugBuffer=a.createVertexBuffer(g,$y.members),this._tileDebugSegments=ei.simpleSegment(0,0,g.length,x.length)}_makeTileBoundsBuffers(a,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const f=dc(ZD,this.tileID.canonical,this.tileTransform)[0];let g,x;if(this.isRaster){const S=function(j,A){const M=bh(j,A),$=Math.pow(2,j.z);for(let ce=0;ce<Tl;ce++)for(let ye=0;ye<Tl;ye++){const Pe=Ea((j.x+(ye+XD(ye))/Qa)/$),ve=Ki((j.y+(ce+XD(ce))/Qa)/$),Te=A.project(Pe,ve),Ie=ce*Tl+ye;jl[2*Ie+0]=Math.round((Te.x*M.scale-M.x)*nr),jl[2*Ie+1]=Math.round((Te.y*M.scale-M.y)*nr)}Nu.fill(0),k_.fill(0);for(let ce=2045;ce>=0;ce--){const ye=4*ce,Pe=Au[ye+0],ve=Au[ye+1],Te=Au[ye+2],Ie=Au[ye+3],Me=Pe+Te>>1,Ye=ve+Ie>>1,Xe=Me+Ye-ve,lt=Ye+Pe-Me,St=ve*Tl+Pe,Qe=Ie*Tl+Te,pt=Ye*Tl+Me,mt=Math.hypot((jl[2*St+0]+jl[2*Qe+0])/2-jl[2*pt+0],(jl[2*St+1]+jl[2*Qe+1])/2-jl[2*pt+1])>=16;Nu[pt]=Nu[pt]||(mt?1:0),ce<1022&&(Nu[pt]=Nu[pt]||Nu[(ve+lt>>1)*Tl+(Pe+Xe>>1)]||Nu[(Ie+lt>>1)*Tl+(Te+Xe>>1)])}const V=new ht,G=new Yt;let Y=0;function J(ce,ye){const Pe=ye*Tl+ce;return k_[Pe]===0&&(V.emplaceBack(jl[2*Pe+0],jl[2*Pe+1],ce*nr/Qa,ye*nr/Qa),k_[Pe]=++Y),k_[Pe]-1}function ne(ce,ye,Pe,ve,Te,Ie){const Me=ce+Pe>>1,Ye=ye+ve>>1;if(Math.abs(ce-Te)+Math.abs(ye-Ie)>1&&Nu[Ye*Tl+Me])ne(Te,Ie,ce,ye,Me,Ye),ne(Pe,ve,Te,Ie,Me,Ye);else{const Xe=J(ce,ye),lt=J(Pe,ve),St=J(Te,Ie);G.emplaceBack(Xe,lt,St)}}return ne(0,0,Qa,Qa,Qa,0),ne(Qa,Qa,0,0,0,Qa),{vertices:V,indices:G}}(this.tileID.canonical,u);g=S.vertices,x=S.indices}else{g=new ht,x=new Yt;for(const{x:j,y:A}of f)g.emplaceBack(j,A,0,0);const S=VT(g.int16,void 0,4);for(let j=0;j<S.length;j+=3)x.emplaceBack(S[j],S[j+1],S[j+2])}this._tileBoundsBuffer=a.createVertexBuffer(g,KD.members),this._tileBoundsIndexBuffer=a.createIndexBuffer(x),this._tileBoundsSegments=ei.simpleSegment(0,0,g.length,x.length)}_makeGlobeTileDebugBuffers(a,u){const f=u.projection;if(!f||f.name!=="globe"||u.freezeTileCoverage)return;const g=this.tileID.canonical,x=Vy(yR(g,u)),S=dp(u.zoom);let j;S>0&&(j=yT(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(a,g,u,x,j,S),this._makeGlobeTileDebugTextBuffer(a,g,u,x,j,S)}_globePoint(a,u,f,g,x,S,j){let A=Uy(a,u,f);if(S){const M=1<<f.z,$=Sl(g.center.lng),V=El(g.center.lat),G=(f.x+.5)/M-$;let Y=0;G>.5?Y=-1:G<-.5&&(Y=1);let J=(a/nr+f.x)/M+Y,ne=(u/nr+f.y)/M;J=(J-$)*g._pixelsPerMercatorPixel+$,ne=(ne-V)*g._pixelsPerMercatorPixel+V;const ce=[J*g.worldSize,ne*g.worldSize,0];Hn(ce,ce,S),A=gh(A,ce,j)}return Hn(A,A,x)}_makeGlobeTileDebugBorderBuffer(a,u,f,g,x,S){const j=new wt,A=new ta,M=new He,$=(G,Y,J,ne,ce)=>{const ye=(J-G)/(ce-1),Pe=(ne-Y)/(ce-1),ve=j.length;for(let Te=0;Te<ce;Te++){const Ie=G+Te*ye,Me=Y+Te*Pe;j.emplaceBack(Ie,Me);const Ye=this._globePoint(Ie,Me,u,f,g,x,S);M.emplaceBack(Ye[0],Ye[1],Ye[2]),A.emplaceBack(ve+Te)}},V=nr;$(0,0,V,0,16),$(V,0,V,V,16),$(V,V,0,V,16),$(0,V,0,0,16),this._tileDebugIndexBuffer=a.createIndexBuffer(A),this._tileDebugBuffer=a.createVertexBuffer(j,$y.members),this._globeTileDebugBorderBuffer=a.createVertexBuffer(M,pR.members),this._tileDebugSegments=ei.simpleSegment(0,0,j.length,A.length)}_makeGlobeTileDebugTextBuffer(a,u,f,g,x,S){const j=nr/4,A=new wt,M=new Yt,$=new He,V=25;M.reserve(32),A.reserve(V),$.reserve(V);const G=(Y,J)=>V*Y+J;for(let Y=0;Y<V;Y++){const J=Y*j;for(let ne=0;ne<V;ne++){const ce=ne*j;A.emplaceBack(ce,J);const ye=this._globePoint(ce,J,u,f,g,x,S);$.emplaceBack(ye[0],ye[1],ye[2])}}for(let Y=0;Y<4;Y++)for(let J=0;J<4;J++){const ne=G(Y,J),ce=G(Y,J+1),ye=G(Y+1,J),Pe=G(Y+1,J+1);M.emplaceBack(ne,ce,ye),M.emplaceBack(ye,ce,Pe)}this._tileDebugTextIndexBuffer=a.createIndexBuffer(M),this._tileDebugTextBuffer=a.createVertexBuffer(A,$y.members),this._globeTileDebugTextBuffer=a.createVertexBuffer($,pR.members),this._tileDebugTextSegments=ei.simpleSegment(0,0,V,32)}}class gQ{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,u,f){const g=String(u);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][g]=this.stateChanges[a][g]||{},ut(this.stateChanges[a][g],f),this.deletedStates[a]===null){this.deletedStates[a]={};for(const x in this.state[a])x!==g&&(this.deletedStates[a][x]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][g]===null){this.deletedStates[a][g]={};for(const x in this.state[a][g])f[x]||(this.deletedStates[a][g][x]=null)}else for(const x in f)this.deletedStates[a]&&this.deletedStates[a][g]&&this.deletedStates[a][g][x]===null&&delete this.deletedStates[a][g][x]}removeFeatureState(a,u,f){if(this.deletedStates[a]===null)return;const g=String(u);if(this.deletedStates[a]=this.deletedStates[a]||{},f&&u!==void 0)this.deletedStates[a][g]!==null&&(this.deletedStates[a][g]=this.deletedStates[a][g]||{},this.deletedStates[a][g][f]=null);else if(u!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][g])for(f in this.deletedStates[a][g]={},this.stateChanges[a][g])this.deletedStates[a][g][f]=null;else this.deletedStates[a][g]=null;else this.deletedStates[a]=null}getState(a,u){const f=String(u),g=ut({},(this.state[a]||{})[f],(this.stateChanges[a]||{})[f]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){const x=this.deletedStates[a][u];if(x===null)return{};for(const S in x)delete g[S]}return g}initializeTileState(a,u){a.setFeatureState(this.state,u)}coalesceChanges(a,u){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const x={};for(const S in this.stateChanges[g])this.state[g][S]||(this.state[g][S]={}),ut(this.state[g][S],this.stateChanges[g][S]),x[S]=this.state[g][S];f[g]=x}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const x={};if(this.deletedStates[g]===null)for(const S in this.state[g])x[S]={},this.state[g][S]={};else for(const S in this.deletedStates[g]){if(this.deletedStates[g][S]===null)this.state[g][S]={};else if(this.state[g][S])for(const j of Object.keys(this.deletedStates[g][S]))delete this.state[g][S][j];x[S]=this.state[g][S]}f[g]=f[g]||{},ut(f[g],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in a)a[g].setFeatureState(f,u)}}class YD{constructor(a){this.size=a,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(a,u){const f=this.toIdx(a,u);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(a,u){return this.leaves[this.toIdx(a,u)]}toIdx(a,u){return u*this.size+a}}function JD(c,a,u,f){let g=0,x=Number.MAX_VALUE;for(let S=0;S<3;S++)if(Math.abs(f[S])<1e-15){if(u[S]<c[S]||u[S]>a[S])return null}else{const j=1/f[S];let A=(c[S]-u[S])*j,M=(a[S]-u[S])*j;if(A>M){const $=A;A=M,M=$}if(A>g&&(g=A),M<x&&(x=M),g>x)return null}return g}function QD(c,a,u,f,g,x,S,j,A,M,$){const V=f-c,G=g-a,Y=x-u,J=S-c,ne=j-a,ce=A-u,ye=$[1]*ce-$[2]*ne,Pe=$[2]*J-$[0]*ce,ve=$[0]*ne-$[1]*J,Te=V*ye+G*Pe+Y*ve;if(Math.abs(Te)<1e-15)return null;const Ie=1/Te,Me=M[0]-c,Ye=M[1]-a,Xe=M[2]-u,lt=(Me*ye+Ye*Pe+Xe*ve)*Ie;if(lt<0||lt>1)return null;const St=Ye*Y-Xe*G,Qe=Xe*V-Me*Y,pt=Me*G-Ye*V,mt=($[0]*St+$[1]*Qe+$[2]*pt)*Ie;return mt<0||lt+mt>1?null:(J*St+ne*Qe+ce*pt)*Ie}function eL(c,a,u){return(c-a)/(u-a)}function tL(c,a,u,f,g,x,S,j,A){const M=1<<u,$=x-f,V=S-g,G=(c+1)/M*$+f,Y=(a+0)/M*V+g,J=(a+1)/M*V+g;j[0]=(c+0)/M*$+f,j[1]=Y,A[0]=G,A[1]=J}class rL{constructor(a){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=a,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const u=function(x){const S=Math.ceil(Math.log2(x.dim/8)),j=[];let A=Math.ceil(Math.pow(2,S));const M=1/A,$=(Y,J,ne,ce,ye)=>{const Pe=ce?1:0,ve=(Y+1)*ne-Pe,Te=J*ne,Ie=(J+1)*ne-Pe;ye[0]=Y*ne,ye[1]=Te,ye[2]=ve,ye[3]=Ie};let V=new YD(A);const G=[];for(let Y=0;Y<A*A;Y++){$(Y%A,Math.floor(Y/A),M,!1,G);const J=ku(G[0],G[1],x),ne=ku(G[2],G[1],x),ce=ku(G[2],G[3],x),ye=ku(G[0],G[3],x);V.minimums.push(Math.min(J,ne,ce,ye)),V.maximums.push(Math.max(J,ne,ce,ye)),V.leaves.push(1)}for(j.push(V),A/=2;A>=1;A/=2){const Y=j[j.length-1];V=new YD(A);for(let J=0;J<A*A;J++){$(J%A,Math.floor(J/A),2,!0,G);const ne=Y.getElevation(G[0],G[1]),ce=Y.getElevation(G[2],G[1]),ye=Y.getElevation(G[2],G[3]),Pe=Y.getElevation(G[0],G[3]),ve=Y.isLeaf(G[0],G[1]),Te=Y.isLeaf(G[2],G[1]),Ie=Y.isLeaf(G[2],G[3]),Me=Y.isLeaf(G[0],G[3]),Ye=Math.min(ne.min,ce.min,ye.min,Pe.min),Xe=Math.max(ne.max,ce.max,ye.max,Pe.max),lt=ve&&Te&&Ie&&Me;V.maximums.push(Xe),V.minimums.push(Ye),V.leaves.push(Xe-Ye<=5&&lt?1:0)}j.push(V)}return j}(this.dem),f=u.length-1,g=u[f];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(u,0,0,f,0)}raycastRoot(a,u,f,g,x,S,j=1){return JD([a,u,-100],[f,g,this.maximums[0]*j],x,S)}raycast(a,u,f,g,x,S,j=1){if(!this.nodeCount)return null;const A=this.raycastRoot(a,u,f,g,x,S,j);if(A==null)return null;const M=[],$=[],V=[],G=[],Y=[{idx:0,t:A,nodex:0,nodey:0,depth:0}];for(;Y.length>0;){const{idx:J,t:ne,nodex:ce,nodey:ye,depth:Pe}=Y.pop();if(this.leaves[J]){tL(ce,ye,Pe,a,u,f,g,V,G);const Te=1<<Pe,Ie=(ce+0)/Te,Me=(ce+1)/Te,Ye=(ye+0)/Te,Xe=(ye+1)/Te,lt=ku(Ie,Ye,this.dem)*j,St=ku(Me,Ye,this.dem)*j,Qe=ku(Me,Xe,this.dem)*j,pt=ku(Ie,Xe,this.dem)*j,mt=QD(V[0],V[1],lt,G[0],V[1],St,G[0],G[1],Qe,x,S),bt=QD(G[0],G[1],Qe,V[0],G[1],pt,V[0],V[1],lt,x,S),At=Math.min(mt!==null?mt:Number.MAX_VALUE,bt!==null?bt:Number.MAX_VALUE);if(At!==Number.MAX_VALUE)return At;{const st=By([],x,S,ne);if(nL(lt,St,pt,Qe,eL(st[0],V[0],G[0]),eL(st[1],V[1],G[1]))>=st[2])return ne}continue}let ve=0;for(let Te=0;Te<this._siblingOffset.length;Te++){tL((ce<<1)+this._siblingOffset[Te][0],(ye<<1)+this._siblingOffset[Te][1],Pe+1,a,u,f,g,V,G),V[2]=-100,G[2]=this.maximums[this.childOffsets[J]+Te]*j;const Ie=JD(V,G,x,S);if(Ie!=null){const Me=Ie;M[Te]=Me;let Ye=!1;for(let Xe=0;Xe<ve&&!Ye;Xe++)Me>=M[$[Xe]]&&($.splice(Xe,0,Te),Ye=!0);Ye||($[ve]=Te),ve++}}for(let Te=0;Te<ve;Te++){const Ie=$[Te];Y.push({idx:this.childOffsets[J]+Ie,t:M[Ie],nodex:(ce<<1)+this._siblingOffset[Ie][0],nodey:(ye<<1)+this._siblingOffset[Ie][1],depth:Pe+1})}}return null}_addNode(a,u,f){return this.minimums.push(a),this.maximums.push(u),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(a,u,f,g,x){if(a[g].isLeaf(u,f)===1)return;this.childOffsets[x]||(this.childOffsets[x]=this.nodeCount);const S=g-1,j=a[S];let A=0,M=0;for(let $=0;$<this._siblingOffset.length;$++){const V=2*u+this._siblingOffset[$][0],G=2*f+this._siblingOffset[$][1],Y=j.getElevation(V,G),J=j.isLeaf(V,G),ne=this._addNode(Y.min,Y.max,J);J&&(A|=1<<$),M||(M=ne)}for(let $=0;$<this._siblingOffset.length;$++)A&1<<$||this._construct(a,2*u+this._siblingOffset[$][0],2*f+this._siblingOffset[$][1],S,M+$)}}function nL(c,a,u,f,g,x){return Or(Or(c,u,x),Or(a,f,x),g)}function ku(c,a,u){const f=u.dim,g=me(c*f-.5,0,f-1),x=me(a*f-.5,0,f-1),S=Math.floor(g),j=Math.floor(x),A=Math.min(S+1,f-1),M=Math.min(j+1,f-1);return nL(u.get(S,j),u.get(A,j),u.get(S,M),u.get(A,M),g-S,x-j)}const iL={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function yQ(c,a,u){return(256*c*256+256*a+u)/10-1e4}function vQ(c,a,u){return 256*c+a+u/256-32768}class M_{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(a,u,f,g=!1,x=!1){if(this.uid=a,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return or(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const S=this.dim=u.height-2,j=new Uint32Array(u.data.buffer);if(this.pixels=new Uint8Array(u.data.buffer),this.encoding=f||"mapbox",this.borderReady=g,!g){for(let A=0;A<S;A++)j[this._idx(-1,A)]=j[this._idx(0,A)],j[this._idx(S,A)]=j[this._idx(S-1,A)],j[this._idx(A,-1)]=j[this._idx(A,0)],j[this._idx(A,S)]=j[this._idx(A,S-1)];j[this._idx(-1,-1)]=j[this._idx(0,0)],j[this._idx(S,-1)]=j[this._idx(S-1,0)],j[this._idx(-1,S)]=j[this._idx(0,S-1)],j[this._idx(S,S)]=j[this._idx(S-1,S-1)],x&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new rL(this)}get(a,u,f=!1){f&&(a=me(a,-1,this.dim),u=me(u,-1,this.dim));const g=4*this._idx(a,u);return(this.encoding==="terrarium"?vQ:yQ)(this.pixels[g],this.pixels[g+1],this.pixels[g+2])}static getUnpackVector(a){return iL[a]}get unpackVector(){return iL[this.encoding]}_idx(a,u){if(a<-1||a>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(a+1)}static pack(a,u){const f=[0,0,0,0],g=M_.getUnpackVector(u);let x=Math.floor((a+g[3])/g[2]);return f[2]=x%256,x=Math.floor(x/256),f[1]=x%256,x=Math.floor(x/256),f[0]=x,f}getPixels(){return new na({width:this.stride,height:this.stride},this.pixels)}backfillBorder(a,u,f){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let g=u*this.dim,x=u*this.dim+this.dim,S=f*this.dim,j=f*this.dim+this.dim;switch(u){case-1:g=x-1;break;case 1:x=g+1}switch(f){case-1:S=j-1;break;case 1:j=S+1}const A=-u*this.dim,M=-f*this.dim;for(let $=S;$<j;$++)for(let V=g;V<x;V++){const G=4*this._idx(V,$),Y=4*this._idx(V+A,$+M);this.pixels[G+0]=a.pixels[Y+0],this.pixels[G+1]=a.pixels[Y+1],this.pixels[G+2]=a.pixels[Y+2],this.pixels[G+3]=a.pixels[Y+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Vt(M_,"DEMData"),Vt(rL,"DemMinMaxQuadTree",{omit:["dem"]});class xQ{constructor(a,u){this.max=a,this.onRemove=u,this.reset()}reset(){for(const a in this.data)for(const u of this.data[a])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(a,u,f){const g=a.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const x={value:u,timeout:void 0};if(f!==void 0&&(x.timeout=setTimeout(()=>{this.remove(a,x)},f)),this.data[g].push(x),this.order.push(g),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const u=this.data[a].shift();return u.timeout&&clearTimeout(u.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),u.value}getByKey(a){const u=this.data[a];return u?u[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,u){if(!this.has(a))return this;const f=a.wrapped().key,g=u===void 0?0:this.data[f].indexOf(u),x=this.data[f][g];return this.data[f].splice(g,1),x.timeout&&clearTimeout(x.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(x.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(a){const u=[];for(const f in this.data)for(const g of this.data[f])a(g.value)||u.push(g);for(const f of u)this.remove(f.value.tileID,f)}}class jp{constructor(a,u,f){this.func=a,this.mask=u,this.range=f}}jp.ReadOnly=!1,jp.ReadWrite=!0,jp.disabled=new jp(519,jp.ReadOnly,[0,1]);const uj=7680;class dj{constructor(a,u,f,g,x,S){this.test=a,this.ref=u,this.mask=f,this.fail=g,this.depthFail=x,this.pass=S}}dj.disabled=new dj({func:519,mask:0},0,0,uj,uj,uj);class Cl{constructor(a,u,f){this.blendFunction=a,this.blendColor=u,this.mask=f}}Cl.Replace=[1,0],Cl.disabled=new Cl(Cl.Replace,Gn.transparent,[!1,!1,!1,!1]),Cl.unblended=new Cl(Cl.Replace,Gn.transparent,[!0,!0,!0,!0]),Cl.alphaBlended=new Cl([1,771],Gn.transparent,[!0,!0,!0,!0]);const hj=1029,fj=2305;class Fo{constructor(a,u,f){this.enable=a,this.mode=u,this.frontFace=f}}Fo.disabled=new Fo(!1,hj,fj),Fo.backCCW=new Fo(!0,hj,fj),Fo.backCW=new Fo(!0,hj,2304),Fo.frontCW=new Fo(!0,1028,2304),Fo.frontCCW=new Fo(!0,1028,fj);class _h extends Bd{constructor(a,u,f){super(),this.id=a,this._onlySymbols=f,u.on("data",g=>{g.dataType==="source"&&g.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&g.dataType==="source"&&g.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new xQ(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new gQ,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(a){this.map=a,this._minTileCacheSize=this._minTileCacheSize===void 0&&a?a._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&a?a._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles){const u=this._tiles[a];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,u){return a.isSymbolTile=this._onlySymbols,this._source.loadTile(a,u)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a,()=>{})}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(a),f.prepare(this.map.style.imageManager)}}getIds(){return We(this._tiles).map(a=>a.tileID).sort(sL).map(a=>a.key)}getRenderableIds(a){const u=[];for(const f in this._tiles)this._isIdRenderable(+f,a)&&u.push(this._tiles[f]);return a?u.sort((f,g)=>{const x=f.tileID,S=g.tileID,j=new W(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),A=new W(S.canonical.x,S.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-S.overscaledZ||A.y-j.y||A.x-j.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(sL).map(f=>f.key)}hasRenderableParent(a){const u=this.findLoadedParent(a,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(a,u){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(u||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(+a,"reloading")}}_reloadTile(a,u){const f=this._tiles[a];f&&(f.state!=="loading"&&(f.state=u),this._loadTile(f,this._tileLoaded.bind(this,f,a,u)))}_tileLoaded(a,u,f,g){if(g)if(a.state="errored",g.status!==404)this._source.fire(new Eo(g,{tile:a}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const x=this.map.painter.terrain;this.update(this.transform,x.getScaledDemTileSize(),!0),x.resetTileLookupCache(this.id)}else this.update(this.transform);else a.timeAdded=So.now(),f==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(u,a),this._source.type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new Yl("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id}))}_backfillDEM(a){const u=this.getRenderableIds();for(let g=0;g<u.length;g++){const x=u[g];if(a.neighboringTiles&&a.neighboringTiles[x]){const S=this.getTileByID(x);f(a,S),f(S,a)}}function f(g,x){if(!g.dem||g.dem.borderReady)return;g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0;let S=x.tileID.canonical.x-g.tileID.canonical.x;const j=x.tileID.canonical.y-g.tileID.canonical.y,A=Math.pow(2,g.tileID.canonical.z),M=x.tileID.key;S===0&&j===0||Math.abs(j)>1||(Math.abs(S)>1&&(Math.abs(S+A)===1?S+=A:Math.abs(S-A)===1&&(S-=A)),x.dem&&g.dem&&(g.dem.backfillBorder(x.dem,S,j),g.neighboringTiles&&g.neighboringTiles[M]&&(g.neighboringTiles[M].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,u,f,g){for(const x in this._tiles){let S=this._tiles[x];if(g[x]||!S.hasData()||S.tileID.overscaledZ<=u||S.tileID.overscaledZ>f)continue;let j=S.tileID;for(;S&&S.tileID.overscaledZ>u+1;){const M=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[M.key],S&&S.hasData()&&(j=M)}let A=j;for(;A.overscaledZ>u;)if(A=A.scaledTo(A.overscaledZ-1),a[A.key]){g[j.key]=j;break}}}findLoadedParent(a,u){if(a.key in this._loadedParentTiles){const f=this._loadedParentTiles[a.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=a.overscaledZ-1;f>=u;f--){const g=a.scaledTo(f),x=this._getLoadedTile(g);if(x)return x}}_getLoadedTile(a){const u=this._tiles[a.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,u){u=u||this._source.tileSize;const f=Math.ceil(a.width/u)+1,g=Math.ceil(a.height/u)+1,x=Math.floor(f*g*5),S=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,x):x,j=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(j)}handleWrapJump(a){const u=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,u){const f={};for(const g in this._tiles){const x=this._tiles[g];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+u),f[x.tileID.key]=x}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(+g,this._tiles[g])}}update(a,u,f){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;let g;this.updateCacheSize(a,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new _s(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(g=a.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(g=g.filter(j=>this._source.hasTile(j)))):g=[];const x=this._updateRetainedTiles(g);if(aL(this._source.type)&&g.length!==0){const j={},A={},M=Object.keys(x);for(const V of M){const G=x[V],Y=this._tiles[V];if(!Y||Y.fadeEndTime&&Y.fadeEndTime<=So.now())continue;const J=this.findLoadedParent(G,Math.max(G.overscaledZ-_h.maxOverzooming,this._source.minzoom));J&&(this._addTile(J.tileID),j[J.tileID.key]=J.tileID),A[V]=G}const $=g[g.length-1].overscaledZ;for(const V in this._tiles){const G=this._tiles[V];if(x[V]||!G.hasData())continue;let Y=G.tileID;for(;Y.overscaledZ>$;){Y=Y.scaledTo(Y.overscaledZ-1);const J=this._tiles[Y.key];if(J&&J.hasData()&&A[Y.key]){x[V]=G.tileID;break}}}for(const V in j)x[V]||(this._coveredTiles[V]=!0,x[V]=j[V])}for(const j in x)this._tiles[j].clearFadeHold();const S=function(j,A){const M=[];for(const $ in j)$ in A||M.push($);return M}(this._tiles,x);for(const j of S){const A=this._tiles[j];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(+j)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){const u={};if(a.length===0)return u;const f={},g=a.reduce((M,$)=>Math.min(M,$.overscaledZ),1/0),x=a[0].overscaledZ,S=Math.max(x-_h.maxOverzooming,this._source.minzoom),j=Math.max(x+_h.maxUnderzooming,this._source.minzoom),A={};for(const M of a){const $=this._addTile(M);u[M.key]=M,$.hasData()||g<this._source.maxzoom&&(A[M.key]=M)}this._retainLoadedChildren(A,g,j,u);for(const M of a){let $=this._tiles[M.key];if($.hasData())continue;if(M.canonical.z>=this._source.maxzoom){const G=M.children(this._source.maxzoom)[0],Y=this.getTile(G);if(Y&&Y.hasData()){u[G.key]=G;continue}}else{const G=M.children(this._source.maxzoom);if(u[G[0].key]&&u[G[1].key]&&u[G[2].key]&&u[G[3].key])continue}let V=$.wasRequested();for(let G=M.overscaledZ-1;G>=S;--G){const Y=M.scaledTo(G);if(f[Y.key]||(f[Y.key]=!0,$=this.getTile(Y),!$&&V&&($=this._addTile(Y)),$&&(u[Y.key]=Y,V=$.wasRequested(),$.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const u=[];let f,g=this._tiles[a].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}u.push(g.key);const x=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(x),f)break;g=x}for(const x of u)this._loadedParentTiles[x]=f}}_addTile(a){let u=this._tiles[a.key];if(u)return u;u=this._cache.getAndRemove(a),u&&(this._setTileReloadTimer(a.key,u),u.tileID=a,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,u)));const f=!!u;if(!f){const g=this.map?this.map.painter:null;u=new cj(a,this._source.tileSize*a.overscaleFactor(),this.transform.tileZoom,g,this._isRaster),this._loadTile(u,this._tileLoaded.bind(this,u,a.key,u.state))}return u?(u.uses++,this._tiles[a.key]=u,f||this._source.fire(new Yl("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null}_setTileReloadTimer(a,u){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const f=u.getExpiryTimeout();f&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},f))}_removeTile(a){const u=this._tiles[a];u&&(u.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(+a);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(a,u,f){const g=[],x=this.transform;if(!x)return g;const S=x.projection.name==="globe",j=Sl(x.center.lng);for(const A in this._tiles){const M=this._tiles[A];if(f&&M.clearQueryDebugViz(),M.holdingForFade())continue;let $;if(S){const V=M.tileID.canonical;if(V.z===0){const G=[Math.abs(me(j,...cv(V,-1))-j),Math.abs(me(j,...cv(V,1))-j)];$=[0,2*G.indexOf(Math.min(...G))-1]}else{const G=[Math.abs(me(j,...cv(V,-1))-j),Math.abs(me(j,...cv(V,0))-j),Math.abs(me(j,...cv(V,1))-j)];$=[G.indexOf(Math.min(...G))-1]}}else $=[0];for(const V of $){const G=a.containsTile(M,x,u,V);G&&g.push(G)}}return g}getVisibleCoordinates(a){const u=this.getRenderableIds(a).map(f=>this._tiles[f].tileID);for(const f of u)f.projMatrix=this.transform.calculateProjMatrix(f.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(aL(this._source.type))for(const a in this._tiles){const u=this._tiles[a];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=So.now())return!0}return!1}setFeatureState(a,u,f){this._state.updateState(a=a||"_geojsonTileLayer",u,f)}removeFeatureState(a,u,f){this._state.removeFeatureState(a=a||"_geojsonTileLayer",u,f)}getFeatureState(a,u){return this._state.getState(a=a||"_geojsonTileLayer",u)}setDependencies(a,u,f){const g=this._tiles[a];g&&g.setDependencies(u,f)}reloadTilesForDependencies(a,u){for(const f in this._tiles)this._tiles[f].hasDependency(a,u)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(a,u))}_preloadTiles(a,u){if(!this._sourceLoaded){const j=()=>{this._sourceLoaded&&(this._source.off("data",j),this._preloadTiles(a,u))};return void this._source.on("data",j)}const f=new Map,g=Array.isArray(a)?a:[a],x=this.map.painter.terrain,S=this.usedForTerrain&&x?x.getScaledDemTileSize():this._source.tileSize;for(const j of g){const A=j.coveringTiles({tileSize:S,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const M of A)f.set(M.key,M);this.usedForTerrain&&j.updateElevation(!1)}Be(Array.from(f.values()),(j,A)=>{const M=new cj(j,this._source.tileSize*j.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(M,$=>{this._source.type==="raster-dem"&&M.dem&&this._backfillDEM(M),A($,M)})},u)}}function sL(c,a){const u=Math.abs(2*c.wrap)-+(c.wrap<0),f=Math.abs(2*a.wrap)-+(a.wrap<0);return c.overscaledZ-a.overscaledZ||f-u||a.canonical.y-c.canonical.y||a.canonical.x-c.canonical.x}function aL(c){return c==="raster"||c==="image"||c==="video"||c==="custom"}function cv(c,a){const u=1<<c.z;return[c.x/u+a,(c.x+1)/u+a]}_h.maxOverzooming=10,_h.maxUnderzooming=3;class I_{constructor(a,u,f){this._demTile=a,this._dem=this._demTile.dem,this._scale=u,this._offset=f}static create(a,u,f){const g=f||a.findDEMTileFor(u);if(!g||!g.dem)return;const x=g.dem,S=g.tileID,j=1<<u.canonical.z-S.canonical.z;return new I_(g,g.tileSize/nr/j,[(u.canonical.x/j-S.canonical.x)*x.dim,(u.canonical.y/j-S.canonical.y)*x.dim])}tileCoordToPixel(a,u){const f=u*this._scale+this._offset[1],g=Math.floor(a*this._scale+this._offset[0]),x=Math.floor(f);return new W(g,x)}getElevationAt(a,u,f,g){const x=a*this._scale+this._offset[0],S=u*this._scale+this._offset[1],j=Math.floor(x),A=Math.floor(S),M=this._dem;return g=!!g,f?Or(Or(M.get(j,A,g),M.get(j,A+1,g),S-A),Or(M.get(j+1,A,g),M.get(j+1,A+1,g),S-A),x-j):M.get(j,A,g)}getElevationAtPixel(a,u,f){return this._dem.get(a,u,!!f)}getMeterToDEM(a){return(1<<this._demTile.tileID.canonical.z)*Bo(1,a)*this._dem.stride}}class oL{constructor(a,u){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new ic(nr,16,0),this.featureIndexArray=new ch,this.promoteId=u}insert(a,u,f,g,x,S=0){const j=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,g,x,S);const A=this.grid;for(let M=0;M<u.length;M++){const $=u[M],V=[1/0,1/0,-1/0,-1/0];for(let G=0;G<$.length;G++){const Y=$[G];V[0]=Math.min(V[0],Y.x),V[1]=Math.min(V[1],Y.y),V[2]=Math.max(V[2],Y.x),V[3]=Math.max(V[3],Y.y)}V[0]<nr&&V[1]<nr&&V[2]>=0&&V[3]>=0&&A.insert(j,V[0],V[1],V[2],V[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new HT(new x_(this.rawTileData)).layers,this.sourceLayerCoder=new GD(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const a in this.vtLayers)this.vtFeatures[a]=[]}return this.vtLayers}query(a,u,f,g){this.loadVTLayers();const x=a.params||{},S=tp(x.filter),j=a.tileResult,A=a.transform,M=j.bufferedTilespaceBounds,$=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(J,ne,ce,ye)=>MR(j.bufferedTilespaceGeometry,J,ne,ce,ye));$.sort(bQ);let V=null;A.elevation&&$.length>0&&(V=I_.create(A.elevation,this.tileID));const G={};let Y;for(let J=0;J<$.length;J++){const ne=$[J];if(ne===Y)continue;Y=ne;const ce=this.featureIndexArray.get(ne);let ye=null;this.loadMatchingFeature(G,ce,S,x.layers,x.availableImages,u,f,g,(Pe,ve,Te,Ie=0)=>(ye||(ye=dc(Pe,this.tileID.canonical,a.tileTransform)),ve.queryIntersectsFeature(j,Pe,Te,ye,this.z,a.transform,a.pixelPosMatrix,V,Ie)))}return G}loadMatchingFeature(a,u,f,g,x,S,j,A,M){const{featureIndex:$,bucketIndex:V,sourceLayerIndex:G,layoutVertexArrayOffset:Y}=u,J=this.bucketLayerIDs[V];if(g&&!function(Pe,ve){for(let Te=0;Te<Pe.length;Te++)if(ve.indexOf(Pe[Te])>=0)return!0;return!1}(g,J))return;const ne=this.sourceLayerCoder.decode(G),ce=this.vtLayers[ne].feature($);if(f.needGeometry){const Pe=yh(ce,!0);if(!f.filter(new U(this.tileID.overscaledZ),Pe,this.tileID.canonical))return}else if(!f.filter(new U(this.tileID.overscaledZ),ce))return;const ye=this.getId(ce,ne);for(let Pe=0;Pe<J.length;Pe++){const ve=J[Pe];if(g&&g.indexOf(ve)<0)continue;const Te=S[ve];if(!Te)continue;let Ie={};ye!==void 0&&A&&(Ie=A.getState(Te.sourceLayer||"_geojsonTileLayer",ye));const Me=ut({},j[ve]);Me.paint=lL(Me.paint,Te.paint,ce,Ie,x),Me.layout=lL(Me.layout,Te.layout,ce,Ie,x);const Ye=!M||M(ce,Te,Ie,Y);if(!Ye)continue;const Xe=new HD(ce,this.z,this.x,this.y,ye);Xe.layer=Me;let lt=a[ve];lt===void 0&&(lt=a[ve]=[]),lt.push({featureIndex:$,feature:Xe,intersectionZ:Ye})}}lookupSymbolFeatures(a,u,f,g,x,S,j,A){const M={};this.loadVTLayers();const $=tp(x);for(const V of a)this.loadMatchingFeature(M,{bucketIndex:f,sourceLayerIndex:g,featureIndex:V,layoutVertexArrayOffset:0},$,S,j,A,u);return M}loadFeature(a){const{featureIndex:u,sourceLayerIndex:f}=a;this.loadVTLayers();const g=this.sourceLayerCoder.decode(f),x=this.vtFeatures[g];if(x[u])return x[u];const S=this.vtLayers[g].feature(u);return x[u]=S,S}hasLayer(a){for(const u of this.bucketLayerIDs)for(const f of u)if(a===f)return!0;return!1}getId(a,u){let f=a.id;if(this.promoteId){const g=typeof this.promoteId=="string"?this.promoteId:this.promoteId[u];g!=null&&(f=a.properties[g]),typeof f=="boolean"&&(f=Number(f))}return f}}function lL(c,a,u,f,g){return it(c,(x,S)=>{const j=a instanceof ge?a.get(S):null;return j&&j.evaluate?j.evaluate(u,f,g):j})}function bQ(c,a){return a-c}Vt(oL,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class cL{constructor(a,u){this.width=a,this.height=u,this.nextRow=0,this.image=new hc({width:a,height:u}),this.positions={},this.uploaded=!1}getDash(a,u){const f=this.getKey(a,u);return this.positions[f]}trim(){const a=this.width,u=this.height=at(this.nextRow);this.image.resize({width:a,height:u})}getKey(a,u){return a.join(",")+u}getDashRanges(a,u,f){const g=[];let x=a.length%2==1?-a[a.length-1]*f:0,S=a[0]*f,j=!0;g.push({left:x,right:S,isDash:j,zeroLength:a[0]===0});let A=a[0];for(let M=1;M<a.length;M++){j=!j;const $=a[M];x=A*f,A+=$,S=A*f,g.push({left:x,right:S,isDash:j,zeroLength:$===0})}return g}addRoundDash(a,u,f){const g=u/2;for(let x=-f;x<=f;x++){const S=this.width*(this.nextRow+f+x);let j=0,A=a[j];for(let M=0;M<this.width;M++){M/A.right>1&&(A=a[++j]);const $=Math.abs(M-A.left),V=Math.abs(M-A.right),G=Math.min($,V);let Y;const J=x/f*(g+1);if(A.isDash){const ne=g-Math.abs(J);Y=Math.sqrt(G*G+ne*ne)}else Y=g-Math.sqrt(G*G+J*J);this.image.data[S+M]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(a,u){for(let A=a.length-1;A>=0;--A){const M=a[A],$=a[A+1];M.zeroLength?a.splice(A,1):$&&$.isDash===M.isDash&&($.left=M.left,a.splice(A,1))}const f=a[0],g=a[a.length-1];f.isDash===g.isDash&&(f.left=g.left-this.width,g.right=f.right+this.width);const x=this.width*this.nextRow;let S=0,j=a[S];for(let A=0;A<this.width;A++){A/j.right>1&&(j=a[++S]);const M=Math.abs(A-j.left),$=Math.abs(A-j.right),V=Math.min(M,$);this.image.data[x+A]=Math.max(0,Math.min(255,(j.isDash?V:-V)+u+128))}}addDash(a,u){const f=this.getKey(a,u);if(this.positions[f])return this.positions[f];const g=u==="round",x=g?7:0,S=2*x+1;if(this.nextRow+S>this.height)return or("LineAtlas out of space"),null;a.length===0&&a.push(1);let j=0;for(let $=0;$<a.length;$++)a[$]<0&&(or("Negative value is found in line dasharray, replacing values with 0"),a[$]=0),j+=a[$];if(j!==0){const $=this.width/j,V=this.getDashRanges(a,this.width,$);g?this.addRoundDash(V,$,x):this.addRegularDash(V,u==="square"?.5*$:0)}const A=this.nextRow+x;this.nextRow+=S;const M={tl:[A,x],br:[j,0]};return this.positions[f]=M,M}}Vt(cL,"LineAtlas");const uL=1*$o;class dL{constructor(a){const u={},f=[];for(const j in a){const A=a[j],M=u[j]={};for(const $ in A.glyphs){const V=A.glyphs[+$];if(!V||V.bitmap.width===0||V.bitmap.height===0)continue;const G=V.metrics.localGlyph?uL:1,Y={x:0,y:0,w:V.bitmap.width+2*G,h:V.bitmap.height+2*G};f.push(Y),M[$]=Y}}const{w:g,h:x}=YT(f),S=new hc({width:g||1,height:x||1});for(const j in a){const A=a[j];for(const M in A.glyphs){const $=A.glyphs[+M];if(!$||$.bitmap.width===0||$.bitmap.height===0)continue;const V=u[j][M],G=$.metrics.localGlyph?uL:1;hc.copy($.bitmap,S,{x:0,y:0},{x:V.x+G,y:V.y+G},$.bitmap)}}this.image=S,this.positions=u}}Vt(dL,"GlyphAtlas");class _Q{constructor(a){this.tileID=new _s(a.tileID.overscaledZ,a.tileID.wrap,a.tileID.canonical.z,a.tileID.canonical.x,a.tileID.canonical.y),this.tileZoom=a.tileZoom,this.uid=a.uid,this.zoom=a.zoom,this.canonical=a.tileID.canonical,this.pixelRatio=a.pixelRatio,this.tileSize=a.tileSize,this.source=a.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=a.showCollisionBoxes,this.collectResourceTiming=!!a.collectResourceTiming,this.returnDependencies=!!a.returnDependencies,this.promoteId=a.promoteId,this.enableTerrain=!!a.enableTerrain,this.isSymbolTile=a.isSymbolTile,this.tileTransform=bh(a.tileID.canonical,a.projection),this.projection=a.projection}parse(a,u,f,g,x){this.status="parsing",this.data=a,this.collisionBoxArray=new an;const S=new GD(Object.keys(a.layers).sort()),j=new oL(this.tileID,this.promoteId);j.bucketLayerIDs=[];const A={},M=new cL(256,256),$={featureIndex:j,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:M,availableImages:f},V=u.familiesBySource[this.source];for(const Ie in V){const Me=a.layers[Ie];if(!Me)continue;let Ye=!1,Xe=!1;for(const Qe of V[Ie])Qe[0].type==="symbol"?Ye=!0:Xe=!0;if(this.isSymbolTile===!0&&!Ye||this.isSymbolTile===!1&&!Xe)continue;Me.version===1&&or(`Vector tile source "${this.source}" layer "${Ie}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const lt=S.encode(Ie),St=[];for(let Qe=0;Qe<Me.length;Qe++){const pt=Me.feature(Qe),mt=j.getId(pt,Ie);St.push({feature:pt,id:mt,index:Qe,sourceLayerIndex:lt})}for(const Qe of V[Ie]){const pt=Qe[0];this.isSymbolTile!==void 0&&pt.type==="symbol"!==this.isSymbolTile||pt.minzoom&&this.zoom<Math.floor(pt.minzoom)||pt.maxzoom&&this.zoom>=pt.maxzoom||pt.visibility!=="none"&&(pj(Qe,this.zoom,f),(A[pt.id]=pt.createBucket({index:j.bucketLayerIDs.length,layers:Qe,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:lt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:f})).populate(St,$,this.tileID.canonical,this.tileTransform),j.bucketLayerIDs.push(Qe.map(mt=>mt.id)))}}let G,Y,J,ne;M.trim();const ce={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ye=()=>{if(G)return x(G);if(Y&&J&&ne){const Ie=new dL(Y),Me=new vD(J,ne);for(const Ye in A){const Xe=A[Ye];Xe instanceof Pu?(pj(Xe.layers,this.zoom,f),HJ(Xe,Y,Ie.positions,J,Me.iconPositions,this.showCollisionBoxes,f,this.tileID.canonical,this.tileZoom,this.projection)):Xe.hasPattern&&(Xe instanceof g_||Xe instanceof d_||Xe instanceof Yy)&&(pj(Xe.layers,this.zoom,f),Xe.addFeatures($,this.tileID.canonical,Me.patternPositions,f,this.tileTransform))}this.status="done",x(null,{buckets:We(A).filter(Ye=>!Ye.isEmpty()),featureIndex:j,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ie.image,lineAtlas:M,imageAtlas:Me,glyphMap:this.returnDependencies?Y:null,iconMap:this.returnDependencies?J:null,glyphPositions:this.returnDependencies?Ie.positions:null})}},Pe=it($.glyphDependencies,Ie=>Object.keys(Ie).map(Number));Object.keys(Pe).length?g.send("getGlyphs",{uid:this.uid,stacks:Pe},(Ie,Me)=>{G||(G=Ie,Y=Me,ye())},void 0,!1,ce):Y={};const ve=Object.keys($.iconDependencies);ve.length?g.send("getImages",{icons:ve,source:this.source,tileID:this.tileID,type:"icons"},(Ie,Me)=>{G||(G=Ie,J=Me,ye())},void 0,!1,ce):J={};const Te=Object.keys($.patternDependencies);Te.length?g.send("getImages",{icons:Te,source:this.source,tileID:this.tileID,type:"patterns"},(Ie,Me)=>{G||(G=Ie,ne=Me,ye())},void 0,!1,ce):ne={},ye()}}function pj(c,a,u){const f=new U(a);for(const g of c)g.recalculate(f,u)}class hL{constructor(a){this.entries={},this.scheduler=a}request(a,u,f,g){const x=this.entries[a]=this.entries[a]||{callbacks:[]};if(x.result){const[S,j]=x.result;return this.scheduler?this.scheduler.add(()=>{g(S,j)},u):g(S,j),()=>{}}return x.callbacks.push(g),x.cancel||(x.cancel=f((S,j)=>{x.result=[S,j];for(const A of x.callbacks)this.scheduler?this.scheduler.add(()=>{A(S,j)},u):A(S,j);setTimeout(()=>delete this.entries[a],3e3)})),()=>{x.result||(x.callbacks=x.callbacks.filter(S=>S!==g),x.callbacks.length||(x.cancel(),delete this.entries[a]))}}}function fL(c,a,u){const f=JSON.stringify(c.request);return c.data&&(this.deduped.entries[f]={result:[null,c.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},g=>{const x=ru(c.request,(S,j,A,M)=>{S?g(S):j&&g(null,{vectorTile:u?void 0:new HT(new x_(j)),rawData:j,cacheControl:A,expires:M})});return()=>{x.cancel(),g()}},a)}const pL=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class mj{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,f]=new Uint8Array(a,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=f>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const x=pL[15&f];if(!x)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(a,2,1),[j]=new Uint32Array(a,4,1);return new mj(j,S,x,a)}constructor(a,u=64,f=Float64Array,g){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=f,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;const x=pL.indexOf(this.ArrayType),S=2*a*this.ArrayType.BYTES_PER_ELEMENT,j=a*this.IndexArrayType.BYTES_PER_ELEMENT,A=(8-j%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${f}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+j+A,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+S+j+A),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+j+A,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=a)}add(a,u){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=a,this.coords[this._pos++]=u,f}finish(){const a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return gj(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,u,f,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:S,nodeSize:j}=this,A=[0,x.length-1,0],M=[];for(;A.length;){const $=A.pop()||0,V=A.pop()||0,G=A.pop()||0;if(V-G<=j){for(let ce=G;ce<=V;ce++){const ye=S[2*ce],Pe=S[2*ce+1];ye>=a&&ye<=f&&Pe>=u&&Pe<=g&&M.push(x[ce])}continue}const Y=G+V>>1,J=S[2*Y],ne=S[2*Y+1];J>=a&&J<=f&&ne>=u&&ne<=g&&M.push(x[Y]),($===0?a<=J:u<=ne)&&(A.push(G),A.push(Y-1),A.push(1-$)),($===0?f>=J:g>=ne)&&(A.push(Y+1),A.push(V),A.push(1-$))}return M}within(a,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:x,nodeSize:S}=this,j=[0,g.length-1,0],A=[],M=f*f;for(;j.length;){const $=j.pop()||0,V=j.pop()||0,G=j.pop()||0;if(V-G<=S){for(let ce=G;ce<=V;ce++)gL(x[2*ce],x[2*ce+1],a,u)<=M&&A.push(g[ce]);continue}const Y=G+V>>1,J=x[2*Y],ne=x[2*Y+1];gL(J,ne,a,u)<=M&&A.push(g[Y]),($===0?a-f<=J:u-f<=ne)&&(j.push(G),j.push(Y-1),j.push(1-$)),($===0?a+f>=J:u+f>=ne)&&(j.push(Y+1),j.push(V),j.push(1-$))}return A}}function gj(c,a,u,f,g,x){if(g-f<=u)return;const S=f+g>>1;mL(c,a,S,f,g,x),gj(c,a,u,f,S-1,1-x),gj(c,a,u,S+1,g,1-x)}function mL(c,a,u,f,g,x){for(;g>f;){if(g-f>600){const M=g-f+1,$=u-f+1,V=Math.log(M),G=.5*Math.exp(2*V/3),Y=.5*Math.sqrt(V*G*(M-G)/M)*($-M/2<0?-1:1);mL(c,a,u,Math.max(f,Math.floor(u-$*G/M+Y)),Math.min(g,Math.floor(u+(M-$)*G/M+Y)),x)}const S=a[2*u+x];let j=f,A=g;for(uv(c,a,f,u),a[2*g+x]>S&&uv(c,a,f,g);j<A;){for(uv(c,a,j,A),j++,A--;a[2*j+x]<S;)j++;for(;a[2*A+x]>S;)A--}a[2*f+x]===S?uv(c,a,f,A):(A++,uv(c,a,A,g)),A<=u&&(f=A+1),u<=A&&(g=A-1)}}function uv(c,a,u,f){yj(c,u,f),yj(a,2*u,2*f),yj(a,2*u+1,2*f+1)}function yj(c,a,u){const f=c[a];c[a]=c[u],c[u]=f}function gL(c,a,u,f){const g=c-u,x=a-f;return g*g+x*x}s.ARRAY_TYPE=ra,s.AUTH_ERR_MSG=Oe,s.Aabb=bs,s.Actor=class{constructor(c,a,u){this.target=c,this.parent=a,this.mapId=u,this.callbacks={},this.cancelCallbacks={},ct(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Mn()?c:p,this.scheduler=new pQ}send(c,a,u,f,g=!1,x){const S=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=x,this.callbacks[S]=u);const j=qi(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:c,hasCallback:!!u,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:bu(a,j)},j),{cancel:()=>{u&&delete this.callbacks[S],this.target.postMessage({id:S,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(c){const a=c.data,u=a.id;if(u&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){const f=this.cancelCallbacks[u];delete this.cancelCallbacks[u],f&&f.cancel()}else if(a.mustQueue||Mn()){const f=this.callbacks[u];this.cancelCallbacks[u]=this.scheduler.add(()=>this.processTask(u,a),f&&f.metadata||{type:"message"})}else this.processTask(u,a)}processTask(c,a){if(a.type==="<response>"){const u=this.callbacks[c];delete this.callbacks[c],u&&(a.error?u(sc(a.error)):u(null,sc(a.data)))}else{const u=qi(this.globalScope)?void 0:[],f=a.hasCallback?(x,S)=>{delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:x?bu(x):null,data:bu(S,u)},u)}:x=>{},g=sc(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,g,f);else if(this.parent.getWorkerSource){const x=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,x[0],g.source)[x[1]](g,f)}else f(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=m_,s.Color=Gn,s.ColorMode=Cl,s.CullFaceMode=Fo,s.DEMData=M_,s.DataConstantProperty=ee,s.DedupedRequest=hL,s.DepthMode=jp,s.EXTENT=nr,s.Elevation=class{isDataAvailableAtPoint(c){const a=this._source();if(this.isUsingMockSource()||!a||c.y<0||c.y>1)return!1;const u=a.getSource().maxzoom,f=1<<u,g=Math.floor(c.x),x=Math.floor((c.x-g)*f),S=Math.floor(c.y*f),j=this.findDEMTileFor(new _s(u,g,u,x,S));return!(!j||!j.dem)}getAtPointOrZero(c,a=0){return this.getAtPoint(c,a)||0}getAtPoint(c,a,u=!0){if(this.isUsingMockSource())return null;a==null&&(a=null);const f=this._source();if(!f||c.y<0||c.y>1)return a;const g=f.getSource().maxzoom,x=1<<g,S=Math.floor(c.x),j=c.x-S,A=new _s(g,S,g,Math.floor(j*x),Math.floor(c.y*x)),M=this.findDEMTileFor(A);if(!M||!M.dem)return a;const $=M.dem,V=1<<M.tileID.canonical.z,G=(j*V-M.tileID.canonical.x)*$.dim,Y=(c.y*V-M.tileID.canonical.y)*$.dim,J=Math.floor(G),ne=Math.floor(Y);return(u?this.exaggeration():1)*Or(Or($.get(J,ne),$.get(J,ne+1),Y-ne),Or($.get(J+1,ne),$.get(J+1,ne+1),Y-ne),G-J)}getAtTileOffset(c,a,u){const f=1<<c.canonical.z;return this.getAtPointOrZero(new hp(c.wrap+(c.canonical.x+a/nr)/f,(c.canonical.y+u/nr)/f))}getAtTileOffsetFunc(c,a,u,f){return g=>{const x=this.getAtTileOffset(c,g.x,g.y),S=f.upVector(c.canonical,g.x,g.y);return Sa(S,S,x*f.upVectorScale(c.canonical,a,u).metersToTile),S}}getForTilePoints(c,a,u,f){if(this.isUsingMockSource())return!1;const g=I_.create(this,c,f);return!!g&&(a.forEach(x=>{x[2]=this.exaggeration()*g.getElevationAt(x[0],x[1],u)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const a=this.findDEMTileFor(c);if(!a||!a.dem)return null;const u=a.dem.tree,f=a.tileID,g=1<<c.canonical.z-f.canonical.z;let x=c.canonical.x/g-f.canonical.x,S=c.canonical.y/g-f.canonical.y,j=0;for(let A=0;A<c.canonical.z-f.canonical.z&&!u.leaves[j];A++){x*=2,S*=2;const M=2*Math.floor(S)+Math.floor(x);j=u.childOffsets[j]+M,x%=1,S%=1}return{min:this.exaggeration()*u.minimums[j],max:this.exaggeration()*u.maximums[j]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,a,u){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=Eo,s.EvaluationParameters=U,s.Event=Yl,s.Evented=Bd,s.FillExtrusionBucket=Yy,s.Frustum=ET,s.FrustumCorners=ST,s.GLOBE_RADIUS=_l,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=mR,s.GLOBE_ZOOM_THRESHOLD_MIN=TT,s.GlobeSharedBuffers=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const c of this._wireframeSegments)c.destroy()}}_fillGridMeshWithLods(c,a){const u=new wt,f=new Yt,g=[],x=c+1+2,S=a[0]+1,j=a[0]+1+(1+a.length),A=(M,$,V)=>{let G=M===x-1?M-2:M===0?M:M-1;return G+=V?24575:0,[G,$]};for(let M=0;M<x;++M)u.emplaceBack(...A(M,0,!0));for(let M=0;M<S;++M)for(let $=0;$<x;++$)u.emplaceBack(...A($,M,($===0||$===x-1)&&!0));for(let M=0;M<a.length;++M){const $=a[M];for(let V=0;V<x;++V)u.emplaceBack(...A(V,$,!0))}for(let M=0;M<a.length;++M){const $=f.length,V=a[M]+1+2,G=new Yt;for(let ne=0;ne<V-1;ne++){const ce=ne===V-2,ye=ce?x*(j-a.length+M-ne):x;for(let Pe=0;Pe<x-1;Pe++){const ve=ne*x+Pe;ne===0||ce||Pe===0||Pe===x-2?(G.emplaceBack(ve+1,ve,ve+ye),G.emplaceBack(ve+ye,ve+ye+1,ve+1)):(f.emplaceBack(ve+1,ve,ve+ye),f.emplaceBack(ve+ye,ve+ye+1,ve+1))}}const Y=ei.simpleSegment(0,$,u.length,f.length-$);for(let ne=0;ne<G.uint16.length;ne+=3)f.emplaceBack(G.uint16[ne],G.uint16[ne+1],G.uint16[ne+2]);const J=ei.simpleSegment(0,$,u.length,f.length-$);g.push({withoutSkirts:Y,withSkirts:J})}return{vertices:u,indices:f,segments:g}}_createGrid(c){const a=this._fillGridMeshWithLods(mh,Fy);this._gridSegments=a.segments,this._gridBuffer=c.createVertexBuffer(a.vertices,$y.members),this._gridIndexBuffer=c.createIndexBuffer(a.indices,!0)}_createPoles(c){const a=new Yt;for(let g=0;g<=mh;g++)a.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=c.createIndexBuffer(a,!0);const u=new sn,f=new sn;this._poleSegments=[];for(let g=0,x=0;g<TT;g++){const S=360/(1<<g);u.emplaceBack(0,-_l,0,.5,0),f.emplaceBack(0,-_l,0,.5,1);for(let j=0;j<=mh;j++){const A=j/mh,M=Or(0,S,A),[$,V,G]=cp(pY,mY,M,_l);u.emplaceBack($,V,G,A,0),f.emplaceBack($,V,G,A,1)}this._poleSegments.push(ei.simpleSegment(x,0,66,64)),x+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(u,fR,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(f,fR,!1)}getGridBuffers(c,a){return[this._gridBuffer,this._gridIndexBuffer,a?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}getWirefameBuffers(c,a){if(!this._wireframeSegments){const u=new wi,f=mh,g=f+1+2,x=1;this._wireframeSegments=[];for(let S=0,j=0;S<Fy.length;S++){const A=Fy[S];for(let $=x;$<A+x;$++)for(let V=x;V<f+x;V++){const G=$*g+V;u.emplaceBack(G,G+1),u.emplaceBack(G,G+g),u.emplaceBack(G,G+g+1)}const M=A*f*3;this._wireframeSegments.push(ei.simpleSegment(0,j,(A+1)*g,M)),j+=M}this._wireframeIndexBuffer=c.createIndexBuffer(u)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[a]]}},s.GlyphManager=_p,s.ImagePosition=JT,s.KDBush=mj,s.LivePerformanceUtils=W2,s.LngLat=on,s.LngLatBounds=Eu,s.LocalGlyphMode=tj,s.MAX_MERCATOR_LATITUDE=Zi,s.MercatorCoordinate=hp,s.ONE_EM=Di,s.OverscaledTileID=_s,s.PerformanceMarkers=nu,s.Point=W,s.Properties=Se,s.RGBAImage=na,s.Ray=wT,s.RequestManager=class{constructor(c,a,u){this._transformRequestFn=c,this._customAccessToken=a,this._silenceAuthErrors=!!u,this._createSkuToken()}_createSkuToken(){const c=function(){let a="";for(let u=0;u<10;u++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",L,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(c,a){return this._transformRequestFn&&this._transformRequestFn(c,a)||{url:c}}normalizeStyleURL(c,a){if(!$e(c))return c;const u=Ot(c);return u.path=`/styles/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeGlyphsURL(c,a){if(!$e(c))return c;const u=Ot(c);return u.path=`/fonts/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeSourceURL(c,a,u,f){if(!$e(c))return c;const g=Ot(c);return g.path=`/v4/${g.authority}.json`,g.params.push("secure"),u&&g.params.push(`language=${u}`),f&&g.params.push(`worldview=${f}`),this._makeAPIURL(g,this._customAccessToken||a)}normalizeSpriteURL(c,a,u,f){const g=Ot(c);return $e(c)?(g.path=`/styles/v1${g.path}/sprite${a}${u}`,this._makeAPIURL(g,this._customAccessToken||f)):(g.path+=`${a}${u}`,Ct(g))}normalizeTileURL(c,a,u){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!$e(c))return c;const f=Ot(c);f.path=f.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${a||u&&f.authority!=="raster"&&u===512?"@2x":""}${E.supported?".webp":"$1"}`),f.authority==="raster"?f.path=`/${_.RASTER_URL_PREFIX}${f.path}`:(f.path=f.path.replace(/^.+\/v4\//,"/"),f.path=`/${_.TILE_URL_VERSION}${f.path}`);const g=this._customAccessToken||function(x){for(const S of x){const j=S.match(/^access_token=(.*)$/);if(j)return j[1]}return null}(f.params)||_.ACCESS_TOKEN;return _.REQUIRE_ACCESS_TOKEN&&g&&this._skuToken&&f.params.push(`sku=${this._skuToken}`),this._makeAPIURL(f,g)}canonicalizeTileURL(c,a){const u=Ot(c);if(!u.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!u.path.match(/\.[\w]+$/))return c;let f="mapbox://";u.path.match(/^\/raster\/v1\//)?f+=`raster/${u.path.replace(`/${_.RASTER_URL_PREFIX}/`,"")}`:f+=`tiles/${u.path.replace(`/${_.TILE_URL_VERSION}/`,"")}`;let g=u.params;return a&&(g=g.filter(x=>!x.match(/^access_token=/))),g.length&&(f+=`?${g.join("&")}`),f}canonicalizeTileset(c,a){const u=!!a&&$e(a),f=[];for(const g of c.tiles||[])Ge(g)?f.push(this.canonicalizeTileURL(g,u)):f.push(g);return f}_makeAPIURL(c,a){const u="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",f=Ot(_.API_URL);if(c.protocol=f.protocol,c.authority=f.authority,c.protocol==="http"){const g=c.params.indexOf("secure");g>=0&&c.params.splice(g,1)}if(f.path!=="/"&&(c.path=`${f.path}${c.path}`),!_.REQUIRE_ACCESS_TOKEN)return Ct(c);if(a=a||_.ACCESS_TOKEN,!this._silenceAuthErrors){if(!a)throw new Error(`An API access token is required to use Mapbox GL. ${u}`);if(a[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${u}`)}return c.params=c.params.filter(g=>g.indexOf("access_token")===-1),c.params.push(`access_token=${a||""}`),Ct(c)}},s.ResourceType=Ua,s.SegmentVector=ei,s.SourceCache=_h,s.StencilMode=dj,s.StructArrayLayout1ui2=ta,s.StructArrayLayout2f1f2i16=sr,s.StructArrayLayout2i4=wt,s.StructArrayLayout2ui4=wi,s.StructArrayLayout3f12=wr,s.StructArrayLayout3ui6=Yt,s.StructArrayLayout4i8=ht,s.StructArrayLayout5f20=sn,s.Texture=lv,s.Tile=cj,s.Transitionable=Q,s.Uniform1f=Jb,s.Uniform1i=class extends lc{constructor(c){super(c),this.current=0}set(c,a,u){this.fetchUniformLocation(c,a)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},s.Uniform2f=class extends lc{constructor(c){super(c),this.current=[0,0]}set(c,a,u){this.fetchUniformLocation(c,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}},s.Uniform3f=class extends lc{constructor(c){super(c),this.current=[0,0,0]}set(c,a,u){this.fetchUniformLocation(c,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}},s.Uniform4f=ZO,s.UniformColor=YO,s.UniformMatrix2f=class extends lc{constructor(c){super(c),this.current=JZ}set(c,a,u){if(this.fetchUniformLocation(c,a)){for(let f=0;f<4;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}},s.UniformMatrix3f=class extends lc{constructor(c){super(c),this.current=YZ}set(c,a,u){if(this.fetchUniformLocation(c,a)){for(let f=0;f<9;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix3fv(this.location,!1,u);break}}}},s.UniformMatrix4f=class extends lc{constructor(c){super(c),this.current=ZZ}set(c,a,u){if(this.fetchUniformLocation(c,a)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let f=1;f<16;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}},s.UnwrappedTileID=nD,s.ValidationError=Ft,s.VectorTileFeature=f_,s.VectorTileWorkerSource=class extends Bd{constructor(c,a,u,f,g){super(),this.actor=c,this.layerIndex=a,this.availableImages=u,this.loadVectorData=g||fL,this.loading={},this.loaded={},this.deduped=new hL(c.scheduler),this.isSpriteLoaded=f,this.scheduler=c.scheduler}loadTile(c,a){const u=c.uid,f=c&&c.request,g=f&&f.collectResourceTiming,x=this.loading[u]=new _Q(c);x.abort=this.loadVectorData(c,(S,j)=>{const A=!this.loading[u];if(delete this.loading[u],A||S||!j)return x.status="done",A||(this.loaded[u]=x),a(S);const M=j.rawData,$={};j.expires&&($.expires=j.expires),j.cacheControl&&($.cacheControl=j.cacheControl),x.vectorTile=j.vectorTile||new HT(new x_(M));const V=()=>{x.parse(x.vectorTile,this.layerIndex,this.availableImages,this.actor,(G,Y)=>{if(G||!Y)return a(G);const J={};if(g){const ne=Lg(f);ne.length>0&&(J.resourceTiming=JSON.parse(JSON.stringify(ne)))}a(null,ut({rawTileData:M.slice(0)},Y,$,J))})};this.isSpriteLoaded?V():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(V,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom}):V()}),this.loaded=this.loaded||{},this.loaded[u]=x})}reloadTile(c,a){const u=this.loaded,f=c.uid,g=this;if(u&&u[f]){const x=u[f];x.showCollisionBoxes=c.showCollisionBoxes,x.enableTerrain=!!c.enableTerrain,x.projection=c.projection,x.tileTransform=bh(c.tileID.canonical,c.projection);const S=(j,A)=>{const M=x.reloadCallback;M&&(delete x.reloadCallback,x.parse(x.vectorTile,g.layerIndex,this.availableImages,g.actor,M)),a(j,A)};x.status==="parsing"?x.reloadCallback=S:x.status==="done"&&(x.vectorTile?x.parse(x.vectorTile,this.layerIndex,this.availableImages,this.actor,S):S())}}abortTile(c,a){const u=c.uid,f=this.loading[u];f&&(f.abort&&f.abort(),delete this.loading[u]),a()}removeTile(c,a){const u=this.loaded,f=c.uid;u&&u[f]&&delete u[f],a()}},s.WritingMode=Ta,s.ZoomDependentExpression=rh,s.add=uc,s.addDynamicAttributes=A_,s.adjoint=function(c,a){var u=a[0],f=a[1],g=a[2],x=a[3],S=a[4],j=a[5],A=a[6],M=a[7],$=a[8];return c[0]=S*$-j*M,c[1]=g*M-f*$,c[2]=f*j-g*S,c[3]=j*A-x*$,c[4]=u*$-g*A,c[5]=g*x-u*j,c[6]=x*M-S*A,c[7]=f*A-u*M,c[8]=u*S-f*x,c},s.asyncAll=Be,s.bezier=be,s.bindAll=ct,s.boundsAttributes=KD,s.bufferConvexPolygon=function(c,a){const u=[];for(let f=0;f<c.length;f++){const g=Ne(f-1,-1,c.length-1),x=Ne(f+1,-1,c.length-1),S=c[f],j=c[x],A=c[g].sub(S).unit(),M=j.sub(S).unit(),$=M.angleWithSep(A.x,A.y),V=A.add(M).unit().mult(-1*a/Math.sin($/2));u.push(S.add(V))}return u},s.cacheEntryPossiblyAdded=function(c){Wi++,Wi>ft&&(c.getActor().send("enforceCacheSizeLimit",Fa),Wi=0)},s.calculateGlobeLabelMatrix=function(c,a){const{x:u,y:f}=c.point,g=bR(u,f,c.worldSize/c._pixelsPerMercatorPixel,0,0);return hh(g,g,PT(wl(a)))},s.calculateGlobeMatrix=function(c){const{x:a,y:u}=c.point,{lng:f,lat:g}=c._center;return bR(a,u,c.worldSize,f,g)},s.calculateGlobeMercatorMatrix=function(c){const a=c.pixelsPerMeter,u=a/Bo(1,c.center.lat),f=Do(new Float64Array(16));return Oy(f,f,[c.point.x,c.point.y,0]),fh(f,f,[u,u,a]),Float32Array.from(f)},s.circumferenceAtLatitude=NT,s.clamp=me,s.clearTileCache=function(c){if(!Zr())return;const a=p.caches.delete(xa);c&&a.catch(c).then(()=>c())},s.clipLine=kD,s.clone=function(c){var a=new ra(16);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15],a},s.clone$1=rr,s.collisionCircleLayout=xJ,s.config=_,s.conjugate=function(c,a){return c[0]=-a[0],c[1]=-a[1],c[2]=-a[2],c[3]=a[3],c},s.create=function(){var c=new ra(16);return ra!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},s.create$1=eR,s.createExpression=yu,s.createLayout=Fe,s.createStyleLayer=function(c){return c.type==="custom"?new uQ(c):new hQ[c.type](c)},s.cross=_T,s.degToRad=ie,s.distance=function(c,a){return Math.hypot(a[0]-c[0],a[1]-c[1],a[2]-c[2])},s.div=function(c,a,u){return c[0]=a[0]/u[0],c[1]=a[1]/u[1],c[2]=a[2]/u[2],c},s.dot=Za,s.earthRadius=qy,s.ease=Ae,s.easeCubicInOut=xe,s.ecefToLatLng=function([c,a,u]){const f=Math.hypot(c,a,u),g=Math.atan2(c,u),x=.5*Math.PI-Math.acos(-a/f);return new on(ue(g),ue(x))},s.emitValidationErrors=Gb,s.endsWith=gt,s.enforceCacheSizeLimit=function(c){In(),Kt&&Kt.then(a=>{a.keys().then(u=>{for(let f=0;f<u.length-c;f++)a.delete(u[f])})})},s.evaluateSizeForFeature=y_,s.evaluateSizeForZoom=yp,s.evaluateVariableOffset=DD,s.evented=T,s.exactEquals=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]},s.exactEquals$1=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]},s.exported=So,s.exported$1=E,s.extend=ut,s.extend$1=To,s.fillExtrusionHeightLift=eD,s.filterObject=rt,s.fromMat4=function(c,a){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[4],c[4]=a[5],c[5]=a[6],c[6]=a[8],c[7]=a[9],c[8]=a[10],c},s.fromQuat=function(c,a){var u=a[0],f=a[1],g=a[2],x=a[3],S=u+u,j=f+f,A=g+g,M=u*S,$=f*S,V=f*j,G=g*S,Y=g*j,J=g*A,ne=x*S,ce=x*j,ye=x*A;return c[0]=1-V-J,c[1]=$+ye,c[2]=G-ce,c[3]=0,c[4]=$-ye,c[5]=1-M-J,c[6]=Y+ne,c[7]=0,c[8]=G+ce,c[9]=Y-ne,c[10]=1-M-V,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},s.fromRotation=function(c,a){var u=Math.sin(a),f=Math.cos(a);return c[0]=f,c[1]=u,c[2]=0,c[3]=-u,c[4]=f,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},s.fromScaling=rR,s.furthestTileCorner=function(c){const a=Math.round((c+45+360)%360/90)%4;return _e[a]},s.getAABBPointSquareDist=function(c,a,u){let f=0;for(let g=0;g<2;++g){const x=u?u[g]:0;c[g]>x&&(f+=(c[g]-x)*(c[g]-x)),a[g]<x&&(f+=(x-a[g])*(x-a[g]))}return f},s.getAnchorAlignment=ej,s.getAnchorJustification=nj,s.getBounds=function(c){let a=1/0,u=1/0,f=-1/0,g=-1/0;for(const x of c)a=Math.min(a,x.x),u=Math.min(u,x.y),f=Math.max(f,x.x),g=Math.max(g,x.y);return{min:new W(a,u),max:new W(f,g)}},s.getColumn=ms,s.getDefaultExportFromCjs=B,s.getGridMatrix=function(c,a,u,f){const g=a.getNorth(),x=a.getSouth(),S=a.getWest(),j=a.getEast(),A=1<<c.z,M=j-S,$=g-x,V=M/mh,G=-$/Fy[u],Y=[0,V,0,G,0,0,g,S,0];if(c.z>0){const J=180/f;tR(Y,Y,[J/M+1,0,0,0,J/$+1,0,-.5*J/V,.5*J/G,1])}return Y[2]=A,Y[5]=c.x,Y[8]=c.y,Y},s.getImage=Ee,s.getJSON=function(c,a){return Zl(ut(c,{type:"json"}),a)},s.getLatitudinalLod=function(c){const a=Zi-5;c=me(c,-a,a)/a*90;const u=Math.pow(Math.abs(Math.sin(ie(c))),3);return Math.round(u*(Fy.length-1))},s.getMapSessionAPI=xi,s.getPerformanceMeasurement=Lg,s.getProjection=qD,s.getRTLTextPluginStatus=P,s.getReferrer=wo,s.getTilePoint=function(c,{x:a,y:u},f=0){return new W(((a-f)*c.scale-c.x)*nr,(u*c.scale-c.y)*nr)},s.getTileVec3=function(c,a,u=0){return lp(((a.x-u)*c.scale-c.x)*nr,(a.y*c.scale-c.y)*nr,ER(a.z,a.y))},s.getVideo=function(c,a){const u=p.document.createElement("video");u.muted=!0,u.onloadstart=function(){a(null,u)};for(let f=0;f<c.length;f++){const g=p.document.createElement("source");Nf(c[f])||(u.crossOrigin="Anonymous"),g.src=c[f],u.appendChild(g)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(c){const a=[0,0,0],u=Do(new Float64Array(16));return hh(u,c.pixelMatrix,c.globeMatrix),Hn(a,a,u),new W(a[0],a[1])},s.globeDenormalizeECEF=PT,s.globeECEFOrigin=function(c,a){const u=[0,0,0];return Hn(u,u,Vy(wl(a.canonical))),Hn(u,u,c),u},s.globeMetersToEcef=t_,s.globeNormalizeECEF=Vy,s.globePixelsToTileUnits=function(c,a){return nr/(512*Math.pow(2,c))*n_(wl(a))},s.globePoleMatrixForTile=function(c,a,u){const f=Do(new Float64Array(16)),g=(a/(1<<c)-.5)*Math.PI*2;return e_(f,u.globeMatrix,g),Float32Array.from(f)},s.globeTileBounds=wl,s.globeTiltAtLngLat=_R,s.globeToMercatorTransition=dp,s.globeUseCustomAntiAliasing=function(c,a,u){const f=dp(u.zoom),g=c.style.map._antialias,x=!!a.extStandardDerivatives,S=a.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return f===0&&!g&&!S&&x},s.identity=Do,s.identity$1=uR,s.invert=yT,s.isFullscreen=function(){return!!p.document.fullscreenElement||!!p.document.webkitFullscreenElement},s.isLngLatBehindGlobe=AT,s.isMapAuthenticated=function(c){return is.has(c)},s.isMapboxURL=$e,s.isSafariWithAntialiasingBug=function(c){const a=c.navigator?c.navigator.userAgent:null;return!!qi(c)&&a&&(a.match("Version/15.4")||a.match("Version/15.5")||a.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=Ki,s.latLngToECEF=up,s.len=oY,s.length=Ry,s.length$1=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},s.lngFromMercatorX=Ea,s.loadVectorTile=fL,s.makeRequest=Zl,s.mapValue=function(c,a,u,f,g){return me((c-a)/(u-a)*(g-f)+f,f,g)},s.mercatorScale=TR,s.mercatorXfromLng=Sl,s.mercatorYfromLat=El,s.mercatorZfromAltitude=Bo,s.mul=sY,s.mul$1=aY,s.multiply=hh,s.multiply$1=tR,s.multiply$2=sR,s.nextPowerOfTwo=at,s.normalize=xs,s.normalize$1=lY,s.normalize$2=lR,s.number=Or,s.ortho=function(c,a,u,f,g,x,S){var j=1/(a-u),A=1/(f-g),M=1/(x-S);return c[0]=-2*j,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*A,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*M,c[11]=0,c[12]=(a+u)*j,c[13]=(g+f)*A,c[14]=(S+x)*M,c[15]=1,c},s.pbf=uD,s.perspective=function(c,a,u,f,g){var x,S=1/Math.tan(a/2);return c[0]=S/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=S,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,g!=null&&g!==1/0?(c[10]=(g+f)*(x=1/(f-g)),c[14]=2*g*f*x):(c[10]=-1,c[14]=-2*f),c},s.pick=function(c,a){const u={};for(let f=0;f<a.length;f++){const g=a[f];g in c&&(u[g]=c[g])}return u},s.plugin=z,s.pointGeometry=Z,s.polesInViewport=function(c){const a=Do(new Float64Array(16));hh(a,c.pixelMatrix,c.globeMatrix);const u=[0,Ya,0],f=[0,Ja,0];return Hn(u,u,a),Hn(f,f,a),[u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!AT(c,new on(c.center.lat,90)),f[0]>0&&f[0]<=c.width&&f[1]>0&&f[1]<=c.height&&!AT(c,new on(c.center.lat,-90))]},s.polygonContainsPoint=vh,s.polygonIntersectsBox=MR,s.polygonIntersectsPolygon=PR,s.polygonizeBounds=function(c,a,u=0,f=!0){const g=new W(u,u),x=c.sub(g),S=a.add(g),j=[x,new W(S.x,x.y),S,new W(x.x,S.y)];return f&&j.push(x.clone()),j},s.posAttributes=$y,s.postMapLoadEvent=Yn,s.postPerformanceEvent=ui,s.postTurnstileEvent=Nr,s.potpack=YT,s.prevPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},s.radToDeg=ue,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(c){return c({pluginStatus:v,pluginURL:d}),T.on("pluginStateChange",c),c},s.removeAuthState=function(c){is.delete(c)},s.renderColorRamp=BT,s.resample=jR,s.rotateX=vT,s.rotateX$1=dR,s.rotateY=e_,s.rotateY$1=hR,s.rotateZ=function(c,a,u){var f=Math.sin(u),g=Math.cos(u),x=a[0],S=a[1],j=a[2],A=a[3],M=a[4],$=a[5],V=a[6],G=a[7];return a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=x*g+M*f,c[1]=S*g+$*f,c[2]=j*g+V*f,c[3]=A*g+G*f,c[4]=M*g-x*f,c[5]=$*g-S*f,c[6]=V*g-j*f,c[7]=G*g-A*f,c},s.rotateZ$1=function(c,a,u){u*=.5;var f=a[0],g=a[1],x=a[2],S=a[3],j=Math.sin(u),A=Math.cos(u);return c[0]=f*A+g*j,c[1]=g*A-f*j,c[2]=x*A+S*j,c[3]=S*A-x*j,c},s.scale=fh,s.scale$1=oR,s.scale$2=Sa,s.scaleAndAdd=By,s.set=function(c,a,u,f){return c[0]=a,c[1]=u,c[2]=f,c},s.setCacheLimits=function(c,a){Fa=c,ft=a},s.setColumn=function(c,a,u){c[4*a+0]=u[0],c[4*a+1]=u[1],c[4*a+2]=u[2],c[4*a+3]=u[3]},s.setRTLTextPlugin=function(c,a,u=!1){if(v===Ay||v===Ny||v===ky)throw new Error("setRTLTextPlugin cannot be called multiple times.");d=So.resolveURL(c),v=Ay,_u=a,w(),u||D()},s.smoothstep=ke,s.spec=ot,s.squaredLength=function(c){var a=c[0],u=c[1],f=c[2];return a*a+u*u+f*f},s.storeAuthState=function(c,a){a?is.add(c):is.delete(c)},s.sub=Lo,s.subtract=bT,s.symbolSize=bJ,s.tileAABB=function(c,a,u,f,g,x,S,j,A){if(A.name==="globe")return fY(c,a,new m_(u,f,g));const M=bh({z:u,x:f,y:g},A);return new bs([(x+M.x/M.scale)*a,a*(M.y/M.scale),S],[(x+M.x2/M.scale)*a,a*(M.y2/M.scale),j])},s.tileCornersToBounds=r_,s.tileTransform=bh,s.transformMat3=function(c,a,u){var f=a[0],g=a[1],x=a[2];return c[0]=f*u[0]+g*u[3]+x*u[6],c[1]=f*u[1]+g*u[4]+x*u[7],c[2]=f*u[2]+g*u[5]+x*u[8],c},s.transformMat4=Hn,s.transformMat4$1=ph,s.transformQuat=aR,s.transitionTileAABBinECEF=yR,s.translate=Oy,s.transpose=function(c,a){if(c===a){var u=a[1],f=a[2],g=a[5];c[1]=a[3],c[2]=a[6],c[3]=u,c[5]=a[7],c[6]=f,c[7]=g}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c},s.triggerPluginCompletionEvent=m,s.uniqueId=Pt,s.updateGlobeVertexNormal=function(c,a,u,f,g){const x=5*a+2;c.float32[x+0]=u,c.float32[x+1]=f,c.float32[x+2]=g},s.validateCustomStyleLayer=function(c){const a=[],u=c.id;return u===void 0&&a.push({message:`layers.${u}: missing required property "id"`}),c.render===void 0&&a.push({message:`layers.${u}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&a.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),a},s.validateFilter=c=>ea(oh(c)),s.validateFog=c=>ea(Vb(c)),s.validateLayer=c=>ea(zb(c)),s.validateLight=c=>ea(Ub(c)),s.validateSource=c=>ea(Fb(c)),s.validateStyle=Wb,s.validateTerrain=c=>ea(Ey(c)),s.values=We,s.vectorTile=h_,s.version=y,s.warnOnce=or,s.window=p,s.wrap=Ne}),o(["./shared"],function(s){function p(Ce){if(typeof Ce=="number"||typeof Ce=="boolean"||typeof Ce=="string"||Ce==null)return JSON.stringify(Ce);if(Array.isArray(Ce)){let ae="[";for(const Ee of Ce)ae+=`${p(Ee)},`;return`${ae}]`}let se="{";for(const ae of Object.keys(Ce).sort())se+=`${ae}:${p(Ce[ae])},`;return`${se}}`}function y(Ce){let se="";for(const ae of s.refProperties)se+=`/${p(Ce[ae])}`;return se}class b{constructor(se){this.keyCache={},se&&this.replace(se)}replace(se){this._layerConfigs={},this._layers={},this.update(se,[])}update(se,ae){for(const Oe of se)this._layerConfigs[Oe.id]=Oe,(this._layers[Oe.id]=s.createStyleLayer(Oe)).compileFilter(),this.keyCache[Oe.id]&&delete this.keyCache[Oe.id];for(const Oe of ae)delete this.keyCache[Oe],delete this._layerConfigs[Oe],delete this._layers[Oe];this.familiesBySource={};const Ee=function(Oe,$e){const Ge={};for(let ze=0;ze<Oe.length;ze++){const et=$e&&$e[Oe[ze].id]||y(Oe[ze]);$e&&($e[Oe[ze].id]=et);let kt=Ge[et];kt||(kt=Ge[et]=[]),kt.push(Oe[ze])}const qe=[];for(const ze in Ge)qe.push(Ge[ze]);return qe}(s.values(this._layerConfigs),this.keyCache);for(const Oe of Ee){const $e=Oe.map(Ot=>this._layers[Ot.id]),Ge=$e[0];if(Ge.visibility==="none")continue;const qe=Ge.source||"";let ze=this.familiesBySource[qe];ze||(ze=this.familiesBySource[qe]={});const et=Ge.sourceLayer||"_geojsonTileLayer";let kt=ze[et];kt||(kt=ze[et]=[]),kt.push($e)}}}class _{loadTile(se,ae){const{uid:Ee,encoding:Oe,rawImageData:$e,padding:Ge,buildQuadTree:qe}=se,ze=s.window.ImageBitmap&&$e instanceof s.window.ImageBitmap?this.getImageData($e,Ge):$e;ae(null,new s.DEMData(Ee,ze,Oe,Ge<1,qe))}getImageData(se,ae){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(se.width,se.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=se.width,this.offscreenCanvas.height=se.height,this.offscreenCanvasContext.drawImage(se,0,0,se.width,se.height);const Ee=this.offscreenCanvasContext.getImageData(-ae,-ae,se.width+2*ae,se.height+2*ae);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ee}}function E(Ce,se){if(Ce.length!==0){C(Ce[0],se);for(var ae=1;ae<Ce.length;ae++)C(Ce[ae],!se)}}function C(Ce,se){for(var ae=0,Ee=0,Oe=0,$e=Ce.length,Ge=$e-1;Oe<$e;Ge=Oe++){var qe=(Ce[Oe][0]-Ce[Ge][0])*(Ce[Ge][1]+Ce[Oe][1]),ze=ae+qe;Ee+=Math.abs(ae)>=Math.abs(qe)?ae-ze+qe:qe-ze+ae,ae=ze}ae+Ee>=0!=!!se&&Ce.reverse()}var k=s.getDefaultExportFromCjs(function Ce(se,ae){var Ee,Oe=se&&se.type;if(Oe==="FeatureCollection")for(Ee=0;Ee<se.features.length;Ee++)Ce(se.features[Ee],ae);else if(Oe==="GeometryCollection")for(Ee=0;Ee<se.geometries.length;Ee++)Ce(se.geometries[Ee],ae);else if(Oe==="Feature")Ce(se.geometry,ae);else if(Oe==="Polygon")E(se.coordinates,ae);else if(Oe==="MultiPolygon")for(Ee=0;Ee<se.coordinates.length;Ee++)E(se.coordinates[Ee],ae);return se});const N=s.VectorTileFeature.prototype.toGeoJSON;var O={exports:{}},R=s.pointGeometry,L=s.vectorTile.VectorTileFeature,B=q;function q(Ce,se){this.options=se||{},this.features=Ce,this.length=Ce.length}function F(Ce,se){this.id=typeof Ce.id=="number"?Ce.id:void 0,this.type=Ce.type,this.rawGeometry=Ce.type===1?[Ce.geometry]:Ce.geometry,this.properties=Ce.tags,this.extent=se||4096}q.prototype.feature=function(Ce){return new F(this.features[Ce],this.options.extent)},F.prototype.loadGeometry=function(){var Ce=this.rawGeometry;this.geometry=[];for(var se=0;se<Ce.length;se++){for(var ae=Ce[se],Ee=[],Oe=0;Oe<ae.length;Oe++)Ee.push(new R(ae[Oe][0],ae[Oe][1]));this.geometry.push(Ee)}return this.geometry},F.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ce=this.geometry,se=1/0,ae=-1/0,Ee=1/0,Oe=-1/0,$e=0;$e<Ce.length;$e++)for(var Ge=Ce[$e],qe=0;qe<Ge.length;qe++){var ze=Ge[qe];se=Math.min(se,ze.x),ae=Math.max(ae,ze.x),Ee=Math.min(Ee,ze.y),Oe=Math.max(Oe,ze.y)}return[se,Ee,ae,Oe]},F.prototype.toGeoJSON=L.prototype.toGeoJSON;var H=s.pbf,Z=B;function re(Ce){var se=new H;return function(ae,Ee){for(var Oe in ae.layers)Ee.writeMessage(3,W,ae.layers[Oe])}(Ce,se),se.finish()}function W(Ce,se){var ae;se.writeVarintField(15,Ce.version||1),se.writeStringField(1,Ce.name||""),se.writeVarintField(5,Ce.extent||4096);var Ee={keys:[],values:[],keycache:{},valuecache:{}};for(ae=0;ae<Ce.length;ae++)Ee.feature=Ce.feature(ae),se.writeMessage(2,te,Ee);var Oe=Ee.keys;for(ae=0;ae<Oe.length;ae++)se.writeStringField(3,Oe[ae]);var $e=Ee.values;for(ae=0;ae<$e.length;ae++)se.writeMessage(4,xe,$e[ae])}function te(Ce,se){var ae=Ce.feature;ae.id!==void 0&&se.writeVarintField(1,ae.id),se.writeMessage(2,oe,Ce),se.writeVarintField(3,ae.type),se.writeMessage(4,_e,ae)}function oe(Ce,se){var ae=Ce.feature,Ee=Ce.keys,Oe=Ce.values,$e=Ce.keycache,Ge=Ce.valuecache;for(var qe in ae.properties){var ze=ae.properties[qe],et=$e[qe];if(ze!==null){et===void 0&&(Ee.push(qe),$e[qe]=et=Ee.length-1),se.writeVarint(et);var kt=typeof ze;kt!=="string"&&kt!=="boolean"&&kt!=="number"&&(ze=JSON.stringify(ze));var Ot=kt+":"+ze,Ct=Ge[Ot];Ct===void 0&&(Oe.push(ze),Ge[Ot]=Ct=Oe.length-1),se.writeVarint(Ct)}}}function ie(Ce,se){return(se<<3)+(7&Ce)}function ue(Ce){return Ce<<1^Ce>>31}function _e(Ce,se){for(var ae=Ce.loadGeometry(),Ee=Ce.type,Oe=0,$e=0,Ge=ae.length,qe=0;qe<Ge;qe++){var ze=ae[qe],et=1;Ee===1&&(et=ze.length),se.writeVarint(ie(1,et));for(var kt=Ee===3?ze.length-1:ze.length,Ot=0;Ot<kt;Ot++){Ot===1&&Ee!==1&&se.writeVarint(ie(2,kt-1));var Ct=ze[Ot].x-Oe,pr=ze[Ot].y-$e;se.writeVarint(ue(Ct)),se.writeVarint(ue(pr)),Oe+=Ct,$e+=pr}Ee===3&&se.writeVarint(ie(7,1))}}function xe(Ce,se){var ae=typeof Ce;ae==="string"?se.writeStringField(1,Ce):ae==="boolean"?se.writeBooleanField(7,Ce):ae==="number"&&(Ce%1!=0?se.writeDoubleField(3,Ce):Ce<0?se.writeSVarintField(6,Ce):se.writeVarintField(5,Ce))}O.exports=re,O.exports.fromVectorTileJs=re,O.exports.fromGeojsonVt=function(Ce,se){se=se||{};var ae={};for(var Ee in Ce)ae[Ee]=new Z(Ce[Ee].features,se),ae[Ee].name=Ee,ae[Ee].version=se.version,ae[Ee].extent=se.extent;return re({layers:ae})},O.exports.GeoJSONWrapper=Z;var be=s.getDefaultExportFromCjs(O.exports);const Ae={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ce=>Ce},me=Math.fround||(ke=new Float32Array(1),Ce=>(ke[0]=+Ce,ke[0]));var ke;const Ne=3,Be=5,We=6;class ut{constructor(se){this.options=Object.assign(Object.create(Ae),se),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(se){const{log:ae,minZoom:Ee,maxZoom:Oe}=this.options;ae&&console.time("total time");const $e=`prepare ${se.length} points`;ae&&console.time($e),this.points=se;const Ge=[];for(let ze=0;ze<se.length;ze++){const et=se[ze];if(!et.geometry)continue;const[kt,Ot]=et.geometry.coordinates,Ct=me(It(kt)),pr=me(at(Ot));Ge.push(Ct,pr,1/0,ze,-1,1),this.options.reduce&&Ge.push(0)}let qe=this.trees[Oe+1]=this._createTree(Ge);ae&&console.timeEnd($e);for(let ze=Oe;ze>=Ee;ze--){const et=+Date.now();qe=this.trees[ze]=this._createTree(this._cluster(qe,ze)),ae&&console.log("z%d: %d clusters in %dms",ze,qe.numItems,+Date.now()-et)}return ae&&console.timeEnd("total time"),this}getClusters(se,ae){let Ee=((se[0]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,se[1]));let $e=se[2]===180?180:((se[2]+180)%360+360)%360-180;const Ge=Math.max(-90,Math.min(90,se[3]));if(se[2]-se[0]>=360)Ee=-180,$e=180;else if(Ee>$e){const Ot=this.getClusters([Ee,Oe,180,Ge],ae),Ct=this.getClusters([-180,Oe,$e,Ge],ae);return Ot.concat(Ct)}const qe=this.trees[this._limitZoom(ae)],ze=qe.range(It(Ee),at(Ge),It($e),at(Oe)),et=qe.data,kt=[];for(const Ot of ze){const Ct=this.stride*Ot;kt.push(et[Ct+Be]>1?nt(et,Ct,this.clusterProps):this.points[et[Ct+Ne]])}return kt}getChildren(se){const ae=this._getOriginId(se),Ee=this._getOriginZoom(se),Oe="No cluster with the specified id.",$e=this.trees[Ee];if(!$e)throw new Error(Oe);const Ge=$e.data;if(ae*this.stride>=Ge.length)throw new Error(Oe);const qe=this.options.radius/(this.options.extent*Math.pow(2,Ee-1)),ze=$e.within(Ge[ae*this.stride],Ge[ae*this.stride+1],qe),et=[];for(const kt of ze){const Ot=kt*this.stride;Ge[Ot+4]===se&&et.push(Ge[Ot+Be]>1?nt(Ge,Ot,this.clusterProps):this.points[Ge[Ot+Ne]])}if(et.length===0)throw new Error(Oe);return et}getLeaves(se,ae,Ee){const Oe=[];return this._appendLeaves(Oe,se,ae=ae||10,Ee=Ee||0,0),Oe}getTile(se,ae,Ee){const Oe=this.trees[this._limitZoom(se)],$e=Math.pow(2,se),{extent:Ge,radius:qe}=this.options,ze=qe/Ge,et=(Ee-ze)/$e,kt=(Ee+1+ze)/$e,Ot={features:[]};return this._addTileFeatures(Oe.range((ae-ze)/$e,et,(ae+1+ze)/$e,kt),Oe.data,ae,Ee,$e,Ot),ae===0&&this._addTileFeatures(Oe.range(1-ze/$e,et,1,kt),Oe.data,$e,Ee,$e,Ot),ae===$e-1&&this._addTileFeatures(Oe.range(0,et,ze/$e,kt),Oe.data,-1,Ee,$e,Ot),Ot.features.length?Ot:null}getClusterExpansionZoom(se){let ae=this._getOriginZoom(se)-1;for(;ae<=this.options.maxZoom;){const Ee=this.getChildren(se);if(ae++,Ee.length!==1)break;se=Ee[0].properties.cluster_id}return ae}_appendLeaves(se,ae,Ee,Oe,$e){const Ge=this.getChildren(ae);for(const qe of Ge){const ze=qe.properties;if(ze&&ze.cluster?$e+ze.point_count<=Oe?$e+=ze.point_count:$e=this._appendLeaves(se,ze.cluster_id,Ee,Oe,$e):$e<Oe?$e++:se.push(qe),se.length===Ee)break}return $e}_createTree(se){const ae=new s.KDBush(se.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ee=0;Ee<se.length;Ee+=this.stride)ae.add(se[Ee],se[Ee+1]);return ae.finish(),ae.data=se,ae}_addTileFeatures(se,ae,Ee,Oe,$e,Ge){for(const qe of se){const ze=qe*this.stride,et=ae[ze+Be]>1;let kt,Ot,Ct;if(et)kt=Pt(ae,ze,this.clusterProps),Ot=ae[ze],Ct=ae[ze+1];else{const mr=this.points[ae[ze+Ne]];kt=mr.properties;const[_r,Nr]=mr.geometry.coordinates;Ot=It(_r),Ct=at(Nr)}const pr={type:1,geometry:[[Math.round(this.options.extent*(Ot*$e-Ee)),Math.round(this.options.extent*(Ct*$e-Oe))]],tags:kt};let br;br=et||this.options.generateId?ae[ze+Ne]:this.points[ae[ze+Ne]].id,br!==void 0&&(pr.id=br),Ge.features.push(pr)}}_limitZoom(se){return Math.max(this.options.minZoom,Math.min(Math.floor(+se),this.options.maxZoom+1))}_cluster(se,ae){const{radius:Ee,extent:Oe,reduce:$e,minPoints:Ge}=this.options,qe=Ee/(Oe*Math.pow(2,ae)),ze=se.data,et=[],kt=this.stride;for(let Ot=0;Ot<ze.length;Ot+=kt){if(ze[Ot+2]<=ae)continue;ze[Ot+2]=ae;const Ct=ze[Ot],pr=ze[Ot+1],br=se.within(ze[Ot],ze[Ot+1],qe),mr=ze[Ot+Be];let _r=mr;for(const Nr of br){const Pn=Nr*kt;ze[Pn+2]>ae&&(_r+=ze[Pn+Be])}if(_r>mr&&_r>=Ge){let Nr,Pn=Ct*mr,Yn=pr*mr,Gi=-1;const ui=((Ot/kt|0)<<5)+(ae+1)+this.points.length;for(const Va of br){const xi=Va*kt;if(ze[xi+2]<=ae)continue;ze[xi+2]=ae;const is=ze[xi+Be];Pn+=ze[xi]*is,Yn+=ze[xi+1]*is,ze[xi+4]=ui,$e&&(Nr||(Nr=this._map(ze,Ot,!0),Gi=this.clusterProps.length,this.clusterProps.push(Nr)),$e(Nr,this._map(ze,xi)))}ze[Ot+4]=ui,et.push(Pn/_r,Yn/_r,1/0,ui,-1,_r),$e&&et.push(Gi)}else{for(let Nr=0;Nr<kt;Nr++)et.push(ze[Ot+Nr]);if(_r>1)for(const Nr of br){const Pn=Nr*kt;if(!(ze[Pn+2]<=ae)){ze[Pn+2]=ae;for(let Yn=0;Yn<kt;Yn++)et.push(ze[Pn+Yn])}}}}return et}_getOriginId(se){return se-this.points.length>>5}_getOriginZoom(se){return(se-this.points.length)%32}_map(se,ae,Ee){if(se[ae+Be]>1){const Ge=this.clusterProps[se[ae+We]];return Ee?Object.assign({},Ge):Ge}const Oe=this.points[se[ae+Ne]].properties,$e=this.options.map(Oe);return Ee&&$e===Oe?Object.assign({},$e):$e}}function nt(Ce,se,ae){return{type:"Feature",id:Ce[se+Ne],properties:Pt(Ce,se,ae),geometry:{type:"Point",coordinates:[(Ee=Ce[se],360*(Ee-.5)),Ut(Ce[se+1])]}};var Ee}function Pt(Ce,se,ae){const Ee=Ce[se+Be],Oe=Ee>=1e4?`${Math.round(Ee/1e3)}k`:Ee>=1e3?Math.round(Ee/100)/10+"k":Ee,$e=Ce[se+We],Ge=$e===-1?{}:Object.assign({},ae[$e]);return Object.assign(Ge,{cluster:!0,cluster_id:Ce[se+Ne],point_count:Ee,point_count_abbreviated:Oe})}function It(Ce){return Ce/360+.5}function at(Ce){const se=Math.sin(Ce*Math.PI/180),ae=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ae<0?0:ae>1?1:ae}function Ut(Ce){const se=(180-360*Ce)*Math.PI/180;return 360*Math.atan(Math.exp(se))/Math.PI-90}function ct(Ce,se,ae,Ee){for(var Oe,$e=Ee,Ge=ae-se>>1,qe=ae-se,ze=Ce[se],et=Ce[se+1],kt=Ce[ae],Ot=Ce[ae+1],Ct=se+3;Ct<ae;Ct+=3){var pr=gt(Ce[Ct],Ce[Ct+1],ze,et,kt,Ot);if(pr>$e)Oe=Ct,$e=pr;else if(pr===$e){var br=Math.abs(Ct-Ge);br<qe&&(Oe=Ct,qe=br)}}$e>Ee&&(Oe-se>3&&ct(Ce,se,Oe,Ee),Ce[Oe+2]=$e,ae-Oe>3&&ct(Ce,Oe,ae,Ee))}function gt(Ce,se,ae,Ee,Oe,$e){var Ge=Oe-ae,qe=$e-Ee;if(Ge!==0||qe!==0){var ze=((Ce-ae)*Ge+(se-Ee)*qe)/(Ge*Ge+qe*qe);ze>1?(ae=Oe,Ee=$e):ze>0&&(ae+=Ge*ze,Ee+=qe*ze)}return(Ge=Ce-ae)*Ge+(qe=se-Ee)*qe}function it(Ce,se,ae,Ee){var Oe={id:Ce===void 0?null:Ce,type:se,geometry:ae,tags:Ee,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function($e){var Ge=$e.geometry,qe=$e.type;if(qe==="Point"||qe==="MultiPoint"||qe==="LineString")rt($e,Ge);else if(qe==="Polygon"||qe==="MultiLineString")for(var ze=0;ze<Ge.length;ze++)rt($e,Ge[ze]);else if(qe==="MultiPolygon")for(ze=0;ze<Ge.length;ze++)for(var et=0;et<Ge[ze].length;et++)rt($e,Ge[ze][et])}(Oe),Oe}function rt(Ce,se){for(var ae=0;ae<se.length;ae+=3)Ce.minX=Math.min(Ce.minX,se[ae]),Ce.minY=Math.min(Ce.minY,se[ae+1]),Ce.maxX=Math.max(Ce.maxX,se[ae]),Ce.maxY=Math.max(Ce.maxY,se[ae+1])}function rr(Ce,se,ae,Ee){if(se.geometry){var Oe=se.geometry.coordinates,$e=se.geometry.type,Ge=Math.pow(ae.tolerance/((1<<ae.maxZoom)*ae.extent),2),qe=[],ze=se.id;if(ae.promoteId?ze=se.properties[ae.promoteId]:ae.generateId&&(ze=Ee||0),$e==="Point")ir(Oe,qe);else if($e==="MultiPoint")for(var et=0;et<Oe.length;et++)ir(Oe[et],qe);else if($e==="LineString")or(Oe,qe,Ge,!1);else if($e==="MultiLineString"){if(ae.lineMetrics){for(et=0;et<Oe.length;et++)or(Oe[et],qe=[],Ge,!1),Ce.push(it(ze,"LineString",qe,se.properties));return}Sr(Oe,qe,Ge,!1)}else if($e==="Polygon")Sr(Oe,qe,Ge,!0);else{if($e!=="MultiPolygon"){if($e==="GeometryCollection"){for(et=0;et<se.geometry.geometries.length;et++)rr(Ce,{id:ze,geometry:se.geometry.geometries[et],properties:se.properties},ae,Ee);return}throw new Error("Input data is not a valid GeoJSON object.")}for(et=0;et<Oe.length;et++){var kt=[];Sr(Oe[et],kt,Ge,!0),qe.push(kt)}}Ce.push(it(ze,$e,qe,se.properties))}}function ir(Ce,se){se.push(tn(Ce[0])),se.push(Mn(Ce[1])),se.push(0)}function or(Ce,se,ae,Ee){for(var Oe,$e,Ge=0,qe=0;qe<Ce.length;qe++){var ze=tn(Ce[qe][0]),et=Mn(Ce[qe][1]);se.push(ze),se.push(et),se.push(0),qe>0&&(Ge+=Ee?(Oe*et-ze*$e)/2:Math.sqrt(Math.pow(ze-Oe,2)+Math.pow(et-$e,2))),Oe=ze,$e=et}var kt=se.length-3;se[2]=1,ct(se,0,kt,ae),se[kt+2]=1,se.size=Math.abs(Ge),se.start=0,se.end=se.size}function Sr(Ce,se,ae,Ee){for(var Oe=0;Oe<Ce.length;Oe++){var $e=[];or(Ce[Oe],$e,ae,Ee),se.push($e)}}function tn(Ce){return Ce/360+.5}function Mn(Ce){var se=Math.sin(Ce*Math.PI/180),ae=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ae<0?0:ae>1?1:ae}function vn(Ce,se,ae,Ee,Oe,$e,Ge,qe){if(Ee/=se,$e>=(ae/=se)&&Ge<Ee)return Ce;if(Ge<ae||$e>=Ee)return null;for(var ze=[],et=0;et<Ce.length;et++){var kt=Ce[et],Ot=kt.geometry,Ct=kt.type,pr=Oe===0?kt.minX:kt.minY,br=Oe===0?kt.maxX:kt.maxY;if(pr>=ae&&br<Ee)ze.push(kt);else if(!(br<ae||pr>=Ee)){var mr=[];if(Ct==="Point"||Ct==="MultiPoint")Zs(Ot,mr,ae,Ee,Oe);else if(Ct==="LineString")qi(Ot,mr,ae,Ee,Oe,!1,qe.lineMetrics);else if(Ct==="MultiLineString")ms(Ot,mr,ae,Ee,Oe,!1);else if(Ct==="Polygon")ms(Ot,mr,ae,Ee,Oe,!0);else if(Ct==="MultiPolygon")for(var _r=0;_r<Ot.length;_r++){var Nr=[];ms(Ot[_r],Nr,ae,Ee,Oe,!0),Nr.length&&mr.push(Nr)}if(mr.length){if(qe.lineMetrics&&Ct==="LineString"){for(_r=0;_r<mr.length;_r++)ze.push(it(kt.id,Ct,mr[_r],kt.tags));continue}Ct!=="LineString"&&Ct!=="MultiLineString"||(mr.length===1?(Ct="LineString",mr=mr[0]):Ct="MultiLineString"),Ct!=="Point"&&Ct!=="MultiPoint"||(Ct=mr.length===3?"Point":"MultiPoint"),ze.push(it(kt.id,Ct,mr,kt.tags))}}}return ze.length?ze:null}function Zs(Ce,se,ae,Ee,Oe){for(var $e=0;$e<Ce.length;$e+=3){var Ge=Ce[$e+Oe];Ge>=ae&&Ge<=Ee&&(se.push(Ce[$e]),se.push(Ce[$e+1]),se.push(Ce[$e+2]))}}function qi(Ce,se,ae,Ee,Oe,$e,Ge){for(var qe,ze,et=ns(Ce),kt=Oe===0?Fa:ft,Ot=Ce.start,Ct=0;Ct<Ce.length-3;Ct+=3){var pr=Ce[Ct],br=Ce[Ct+1],mr=Ce[Ct+2],_r=Ce[Ct+3],Nr=Ce[Ct+4],Pn=Oe===0?pr:br,Yn=Oe===0?_r:Nr,Gi=!1;Ge&&(qe=Math.sqrt(Math.pow(pr-_r,2)+Math.pow(br-Nr,2))),Pn<ae?Yn>ae&&(ze=kt(et,pr,br,_r,Nr,ae),Ge&&(et.start=Ot+qe*ze)):Pn>Ee?Yn<Ee&&(ze=kt(et,pr,br,_r,Nr,Ee),Ge&&(et.start=Ot+qe*ze)):xa(et,pr,br,mr),Yn<ae&&Pn>=ae&&(ze=kt(et,pr,br,_r,Nr,ae),Gi=!0),Yn>Ee&&Pn<=Ee&&(ze=kt(et,pr,br,_r,Nr,Ee),Gi=!0),!$e&&Gi&&(Ge&&(et.end=Ot+qe*ze),se.push(et),et=ns(Ce)),Ge&&(Ot+=qe)}var ui=Ce.length-3;pr=Ce[ui],br=Ce[ui+1],mr=Ce[ui+2],(Pn=Oe===0?pr:br)>=ae&&Pn<=Ee&&xa(et,pr,br,mr),ui=et.length-3,$e&&ui>=3&&(et[ui]!==et[0]||et[ui+1]!==et[1])&&xa(et,et[0],et[1],et[2]),et.length&&se.push(et)}function ns(Ce){var se=[];return se.size=Ce.size,se.start=Ce.start,se.end=Ce.end,se}function ms(Ce,se,ae,Ee,Oe,$e){for(var Ge=0;Ge<Ce.length;Ge++)qi(Ce[Ge],se,ae,Ee,Oe,$e,!1)}function xa(Ce,se,ae,Ee){Ce.push(se),Ce.push(ae),Ce.push(Ee)}function Fa(Ce,se,ae,Ee,Oe,$e){var Ge=($e-se)/(Ee-se);return Ce.push($e),Ce.push(ae+(Oe-ae)*Ge),Ce.push(1),Ge}function ft(Ce,se,ae,Ee,Oe,$e){var Ge=($e-ae)/(Oe-ae);return Ce.push(se+(Ee-se)*Ge),Ce.push($e),Ce.push(1),Ge}function Kt(Ce,se){for(var ae=[],Ee=0;Ee<Ce.length;Ee++){var Oe,$e=Ce[Ee],Ge=$e.type;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")Oe=Ar($e.geometry,se);else if(Ge==="MultiLineString"||Ge==="Polygon"){Oe=[];for(var qe=0;qe<$e.geometry.length;qe++)Oe.push(Ar($e.geometry[qe],se))}else if(Ge==="MultiPolygon")for(Oe=[],qe=0;qe<$e.geometry.length;qe++){for(var ze=[],et=0;et<$e.geometry[qe].length;et++)ze.push(Ar($e.geometry[qe][et],se));Oe.push(ze)}ae.push(it($e.id,Ge,Oe,$e.tags))}return ae}function Ar(Ce,se){var ae=[];ae.size=Ce.size,Ce.start!==void 0&&(ae.start=Ce.start,ae.end=Ce.end);for(var Ee=0;Ee<Ce.length;Ee+=3)ae.push(Ce[Ee]+se,Ce[Ee+1],Ce[Ee+2]);return ae}function Zr(Ce,se){if(Ce.transformed)return Ce;var ae,Ee,Oe,$e=1<<Ce.z,Ge=Ce.x,qe=Ce.y;for(ae=0;ae<Ce.features.length;ae++){var ze=Ce.features[ae],et=ze.geometry,kt=ze.type;if(ze.geometry=[],kt===1)for(Ee=0;Ee<et.length;Ee+=2)ze.geometry.push(In(et[Ee],et[Ee+1],se,$e,Ge,qe));else for(Ee=0;Ee<et.length;Ee++){var Ot=[];for(Oe=0;Oe<et[Ee].length;Oe+=2)Ot.push(In(et[Ee][Oe],et[Ee][Oe+1],se,$e,Ge,qe));ze.geometry.push(Ot)}}return Ce.transformed=!0,Ce}function In(Ce,se,ae,Ee,Oe,$e){return[Math.round(ae*(Ce*Ee-Oe)),Math.round(ae*(se*Ee-$e))]}function Ii(Ce,se,ae,Ee,Oe){for(var $e=se===Oe.maxZoom?0:Oe.tolerance/((1<<se)*Oe.extent),Ge={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ae,y:Ee,z:se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},qe=0;qe<Ce.length;qe++){Ge.numFeatures++,Wi(Ge,Ce[qe],$e,Oe);var ze=Ce[qe].minX,et=Ce[qe].minY,kt=Ce[qe].maxX,Ot=Ce[qe].maxY;ze<Ge.minX&&(Ge.minX=ze),et<Ge.minY&&(Ge.minY=et),kt>Ge.maxX&&(Ge.maxX=kt),Ot>Ge.maxY&&(Ge.maxY=Ot)}return Ge}function Wi(Ce,se,ae,Ee){var Oe=se.geometry,$e=se.type,Ge=[];if($e==="Point"||$e==="MultiPoint")for(var qe=0;qe<Oe.length;qe+=3)Ge.push(Oe[qe]),Ge.push(Oe[qe+1]),Ce.numPoints++,Ce.numSimplified++;else if($e==="LineString")Ua(Ge,Oe,Ce,ae,!1,!1);else if($e==="MultiLineString"||$e==="Polygon")for(qe=0;qe<Oe.length;qe++)Ua(Ge,Oe[qe],Ce,ae,$e==="Polygon",qe===0);else if($e==="MultiPolygon")for(var ze=0;ze<Oe.length;ze++){var et=Oe[ze];for(qe=0;qe<et.length;qe++)Ua(Ge,et[qe],Ce,ae,!0,qe===0)}if(Ge.length){var kt=se.tags||null;if($e==="LineString"&&Ee.lineMetrics){for(var Ot in kt={},se.tags)kt[Ot]=se.tags[Ot];kt.mapbox_clip_start=Oe.start/Oe.size,kt.mapbox_clip_end=Oe.end/Oe.size}var Ct={geometry:Ge,type:$e==="Polygon"||$e==="MultiPolygon"?3:$e==="LineString"||$e==="MultiLineString"?2:1,tags:kt};se.id!==null&&(Ct.id=se.id),Ce.features.push(Ct)}}function Ua(Ce,se,ae,Ee,Oe,$e){var Ge=Ee*Ee;if(Ee>0&&se.size<(Oe?Ge:Ee))ae.numPoints+=se.length/3;else{for(var qe=[],ze=0;ze<se.length;ze+=3)(Ee===0||se[ze+2]>Ge)&&(ae.numSimplified++,qe.push(se[ze]),qe.push(se[ze+1])),ae.numPoints++;Oe&&function(et,kt){for(var Ot=0,Ct=0,pr=et.length,br=pr-2;Ct<pr;br=Ct,Ct+=2)Ot+=(et[Ct]-et[br])*(et[Ct+1]+et[br+1]);if(Ot>0===kt)for(Ct=0,pr=et.length;Ct<pr/2;Ct+=2){var mr=et[Ct],_r=et[Ct+1];et[Ct]=et[pr-2-Ct],et[Ct+1]=et[pr-1-Ct],et[pr-2-Ct]=mr,et[pr-1-Ct]=_r}}(qe,$e),Ce.push(qe)}}function Oi(Ce,se){var ae=(se=this.options=function(Oe,$e){for(var Ge in $e)Oe[Ge]=$e[Ge];return Oe}(Object.create(this.options),se)).debug;if(ae&&console.time("preprocess data"),se.maxZoom<0||se.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(se.promoteId&&se.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ee=function(Oe,$e){var Ge=[];if(Oe.type==="FeatureCollection")for(var qe=0;qe<Oe.features.length;qe++)rr(Ge,Oe.features[qe],$e,qe);else rr(Ge,Oe.type==="Feature"?Oe:{geometry:Oe},$e);return Ge}(Ce,se);this.tiles={},this.tileCoords=[],ae&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",se.indexMaxZoom,se.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ee=function(Oe,$e){var Ge=$e.buffer/$e.extent,qe=Oe,ze=vn(Oe,1,-1-Ge,Ge,0,-1,2,$e),et=vn(Oe,1,1-Ge,2+Ge,0,-1,2,$e);return(ze||et)&&(qe=vn(Oe,1,-Ge,1+Ge,0,-1,2,$e)||[],ze&&(qe=Kt(ze,1).concat(qe)),et&&(qe=qe.concat(Kt(et,-1)))),qe}(Ee,se),Ee.length&&this.splitTile(Ee,0,0,0),ae&&(Ee.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function wo(Ce,se,ae){return 32*((1<<Ce)*ae+se)+Ce}function Zl(Ce,se){const ae=Ce.tileID.canonical;if(!this._geoJSONIndex)return se(null,null);const Ee=this._geoJSONIndex.getTile(ae.z,ae.x,ae.y);if(!Ee)return se(null,null);const Oe=new class{constructor(Ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=Ge.length,this._features=Ge}feature(Ge){return new class{constructor(qe){this._feature=qe,this.extent=s.EXTENT,this.type=qe.type,this.properties=qe.tags,"id"in qe&&!isNaN(qe.id)&&(this.id=parseInt(qe.id,10))}loadGeometry(){if(this._feature.type===1){const qe=[];for(const ze of this._feature.geometry)qe.push([new s.Point(ze[0],ze[1])]);return qe}{const qe=[];for(const ze of this._feature.geometry){const et=[];for(const kt of ze)et.push(new s.Point(kt[0],kt[1]));qe.push(et)}return qe}}toGeoJSON(qe,ze,et){return N.call(this,qe,ze,et)}}(this._features[Ge])}}(Ee.features);let $e=be(Oe);$e.byteOffset===0&&$e.byteLength===$e.buffer.byteLength||($e=new Uint8Array($e)),se(null,{vectorTile:Oe,rawData:$e.buffer})}Oi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Oi.prototype.splitTile=function(Ce,se,ae,Ee,Oe,$e,Ge){for(var qe=[Ce,se,ae,Ee],ze=this.options,et=ze.debug;qe.length;){Ee=qe.pop(),ae=qe.pop(),se=qe.pop(),Ce=qe.pop();var kt=1<<se,Ot=wo(se,ae,Ee),Ct=this.tiles[Ot];if(!Ct&&(et>1&&console.time("creation"),Ct=this.tiles[Ot]=Ii(Ce,se,ae,Ee,ze),this.tileCoords.push({z:se,x:ae,y:Ee}),et)){et>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",se,ae,Ee,Ct.numFeatures,Ct.numPoints,Ct.numSimplified),console.timeEnd("creation"));var pr="z"+se;this.stats[pr]=(this.stats[pr]||0)+1,this.total++}if(Ct.source=Ce,Oe){if(se===ze.maxZoom||se===Oe)continue;var br=1<<Oe-se;if(ae!==Math.floor($e/br)||Ee!==Math.floor(Ge/br))continue}else if(se===ze.indexMaxZoom||Ct.numPoints<=ze.indexMaxPoints)continue;if(Ct.source=null,Ce.length!==0){et>1&&console.time("clipping");var mr,_r,Nr,Pn,Yn,Gi,ui=.5*ze.buffer/ze.extent,Va=.5-ui,xi=.5+ui,is=1+ui;mr=_r=Nr=Pn=null,Yn=vn(Ce,kt,ae-ui,ae+xi,0,Ct.minX,Ct.maxX,ze),Gi=vn(Ce,kt,ae+Va,ae+is,0,Ct.minX,Ct.maxX,ze),Ce=null,Yn&&(mr=vn(Yn,kt,Ee-ui,Ee+xi,1,Ct.minY,Ct.maxY,ze),_r=vn(Yn,kt,Ee+Va,Ee+is,1,Ct.minY,Ct.maxY,ze),Yn=null),Gi&&(Nr=vn(Gi,kt,Ee-ui,Ee+xi,1,Ct.minY,Ct.maxY,ze),Pn=vn(Gi,kt,Ee+Va,Ee+is,1,Ct.minY,Ct.maxY,ze),Gi=null),et>1&&console.timeEnd("clipping"),qe.push(mr||[],se+1,2*ae,2*Ee),qe.push(_r||[],se+1,2*ae,2*Ee+1),qe.push(Nr||[],se+1,2*ae+1,2*Ee),qe.push(Pn||[],se+1,2*ae+1,2*Ee+1)}}},Oi.prototype.getTile=function(Ce,se,ae){var Ee=this.options,Oe=Ee.extent,$e=Ee.debug;if(Ce<0||Ce>24)return null;var Ge=1<<Ce,qe=wo(Ce,se=(se%Ge+Ge)%Ge,ae);if(this.tiles[qe])return Zr(this.tiles[qe],Oe);$e>1&&console.log("drilling down to z%d-%d-%d",Ce,se,ae);for(var ze,et=Ce,kt=se,Ot=ae;!ze&&et>0;)et--,kt=Math.floor(kt/2),Ot=Math.floor(Ot/2),ze=this.tiles[wo(et,kt,Ot)];return ze&&ze.source?($e>1&&console.log("found parent tile z%d-%d-%d",et,kt,Ot),$e>1&&console.time("drilling down"),this.splitTile(ze.source,et,kt,Ot,Ce,se,ae),$e>1&&console.timeEnd("drilling down"),this.tiles[qe]?Zr(this.tiles[qe],Oe):null):null};class ru extends s.VectorTileWorkerSource{constructor(se,ae,Ee,Oe,$e){super(se,ae,Ee,Oe,Zl),$e&&(this.loadGeoJSON=$e)}loadData(se,ae){const Ee=se&&se.request,Oe=Ee&&Ee.collectResourceTiming;this.loadGeoJSON(se,($e,Ge)=>{if($e||!Ge)return ae($e);if(typeof Ge!="object")return ae(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`));{k(Ge,!0);try{if(se.filter){const ze=s.createExpression(se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ze.result==="error")throw new Error(ze.value.map(kt=>`${kt.key}: ${kt.message}`).join(", "));Ge={type:"FeatureCollection",features:Ge.features.filter(kt=>ze.value.evaluate({zoom:0},kt))}}this._geoJSONIndex=se.cluster?new ut(function({superclusterOptions:ze,clusterProperties:et}){if(!et||!ze)return ze;const kt={},Ot={},Ct={accumulated:null,zoom:0},pr={properties:null},br=Object.keys(et);for(const mr of br){const[_r,Nr]=et[mr],Pn=s.createExpression(Nr),Yn=s.createExpression(typeof _r=="string"?[_r,["accumulated"],["get",mr]]:_r);kt[mr]=Pn.value,Ot[mr]=Yn.value}return ze.map=mr=>{pr.properties=mr;const _r={};for(const Nr of br)_r[Nr]=kt[Nr].evaluate(Ct,pr);return _r},ze.reduce=(mr,_r)=>{pr.properties=_r;for(const Nr of br)Ct.accumulated=mr[Nr],mr[Nr]=Ot[Nr].evaluate(Ct,pr)},ze}(se)).load(Ge.features):function(ze,et){return new Oi(ze,et)}(Ge,se.geojsonVtOptions)}catch(ze){return ae(ze)}this.loaded={};const qe={};if(Oe){const ze=s.getPerformanceMeasurement(Ee);ze&&(qe.resourceTiming={},qe.resourceTiming[se.source]=JSON.parse(JSON.stringify(ze)))}ae(null,qe)}})}reloadTile(se,ae){const Ee=this.loaded;return Ee&&Ee[se.uid]?super.reloadTile(se,ae):this.loadTile(se,ae)}loadGeoJSON(se,ae){if(se.request)s.getJSON(se.request,ae);else{if(typeof se.data!="string")return ae(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`));try{return ae(null,JSON.parse(se.data))}catch{return ae(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(se,ae){try{ae(null,this._geoJSONIndex.getClusterExpansionZoom(se.clusterId))}catch(Ee){ae(Ee)}}getClusterChildren(se,ae){try{ae(null,this._geoJSONIndex.getChildren(se.clusterId))}catch(Ee){ae(Ee)}}getClusterLeaves(se,ae){try{ae(null,this._geoJSONIndex.getLeaves(se.clusterId,se.limit,se.offset))}catch(Ee){ae(Ee)}}}class Nf{constructor(se){this.self=se,this.actor=new s.Actor(se,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:ru},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ae,Ee)=>{if(this.workerSourceTypes[ae])throw new Error(`Worker source with name "${ae}" already registered.`);this.workerSourceTypes[ae]=Ee},this.self.registerRTLTextPlugin=ae=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=ae.applyArabicShaping,s.plugin.processBidirectionalText=ae.processBidirectionalText,s.plugin.processStyledBidirectionalText=ae.processStyledBidirectionalText}}clearCaches(se,ae,Ee){delete this.layerIndexes[se],delete this.availableImages[se],delete this.workerSources[se],delete this.demWorkerSources[se],Ee()}checkIfReady(se,ae,Ee){Ee()}setReferrer(se,ae){this.referrer=ae}spriteLoaded(se,ae){this.isSpriteLoaded[se]=ae;for(const Ee in this.workerSources[se]){const Oe=this.workerSources[se][Ee];for(const $e in Oe)Oe[$e]instanceof s.VectorTileWorkerSource&&(Oe[$e].isSpriteLoaded=ae,Oe[$e].fire(new s.Event("isSpriteLoaded")))}}setImages(se,ae,Ee){this.availableImages[se]=ae;for(const Oe in this.workerSources[se]){const $e=this.workerSources[se][Oe];for(const Ge in $e)$e[Ge].availableImages=ae}Ee()}enableTerrain(se,ae,Ee){this.terrain=ae,Ee()}setProjection(se,ae){this.projections[se]=s.getProjection(ae)}setLayers(se,ae,Ee){this.getLayerIndex(se).replace(ae),Ee()}updateLayers(se,ae,Ee){this.getLayerIndex(se).update(ae.layers,ae.removedIds),Ee()}loadTile(se,ae,Ee){const Oe=this.enableTerrain?s.extend({enableTerrain:this.terrain},ae):ae;Oe.projection=this.projections[se]||this.defaultProjection,this.getWorkerSource(se,ae.type,ae.source).loadTile(Oe,Ee)}loadDEMTile(se,ae,Ee){const Oe=this.enableTerrain?s.extend({buildQuadTree:this.terrain},ae):ae;this.getDEMWorkerSource(se,ae.source).loadTile(Oe,Ee)}reloadTile(se,ae,Ee){const Oe=this.enableTerrain?s.extend({enableTerrain:this.terrain},ae):ae;Oe.projection=this.projections[se]||this.defaultProjection,this.getWorkerSource(se,ae.type,ae.source).reloadTile(Oe,Ee)}abortTile(se,ae,Ee){this.getWorkerSource(se,ae.type,ae.source).abortTile(ae,Ee)}removeTile(se,ae,Ee){this.getWorkerSource(se,ae.type,ae.source).removeTile(ae,Ee)}removeSource(se,ae,Ee){if(!this.workerSources[se]||!this.workerSources[se][ae.type]||!this.workerSources[se][ae.type][ae.source])return;const Oe=this.workerSources[se][ae.type][ae.source];delete this.workerSources[se][ae.type][ae.source],Oe.removeSource!==void 0?Oe.removeSource(ae,Ee):Ee()}loadWorkerSource(se,ae,Ee){try{this.self.importScripts(ae.url),Ee()}catch(Oe){Ee(Oe.toString())}}syncRTLPluginState(se,ae,Ee){try{s.plugin.setState(ae);const Oe=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&Oe!=null){this.self.importScripts(Oe);const $e=s.plugin.isParsed();Ee($e?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Oe}`),$e)}}catch(Oe){Ee(Oe.toString())}}getAvailableImages(se){let ae=this.availableImages[se];return ae||(ae=[]),ae}getLayerIndex(se){let ae=this.layerIndexes[se];return ae||(ae=this.layerIndexes[se]=new b),ae}getWorkerSource(se,ae,Ee){if(this.workerSources[se]||(this.workerSources[se]={}),this.workerSources[se][ae]||(this.workerSources[se][ae]={}),!this.workerSources[se][ae][Ee]){const Oe={send:($e,Ge,qe,ze,et,kt)=>{this.actor.send($e,Ge,qe,se,et,kt)},scheduler:this.actor.scheduler};this.workerSources[se][ae][Ee]=new this.workerSourceTypes[ae](Oe,this.getLayerIndex(se),this.getAvailableImages(se),this.isSpriteLoaded[se])}return this.workerSources[se][ae][Ee]}getDEMWorkerSource(se,ae){return this.demWorkerSources[se]||(this.demWorkerSources[se]={}),this.demWorkerSources[se][ae]||(this.demWorkerSources[se][ae]=new _),this.demWorkerSources[se][ae]}enforceCacheSizeLimit(se,ae){s.enforceCacheSizeLimit(ae)}getWorkerPerformanceMetrics(se,ae,Ee){Ee(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Nf(self)),Nf}),o(["./shared"],function(s){function p(v,d){if(Array.isArray(v)){if(!Array.isArray(d)||v.length!==d.length)return!1;for(let m=0;m<v.length;m++)if(!p(v[m],d[m]))return!1;return!0}if(typeof v=="object"&&v!==null&&d!==null){if(typeof d!="object"||Object.keys(v).length!==Object.keys(d).length)return!1;for(const m in v)if(!p(v[m],d[m]))return!1;return!0}return v===d}var y=b;function b(v){return!function(d){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,T,P=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(P);try{T=new Worker(D),w=!0}catch{w=!1}return T&&T.terminate(),URL.revokeObjectURL(D),w}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var w=document.createElement("canvas");w.width=w.height=1;var T=w.getContext("2d");if(!T)return!1;var P=T.getImageData(0,0,1,1);return P&&P.width===w.width}()?(_[m=d&&d.failIfMajorPerformanceCaveat]===void 0&&(_[m]=function(w){var T,P=function(D){var z=document.createElement("canvas"),U=Object.create(b.webGLContextAttributes);return U.failIfMajorPerformanceCaveat=D,z.getContext("webgl",U)||z.getContext("experimental-webgl",U)}(w);if(!P)return!1;try{T=P.createShader(P.VERTEX_SHADER)}catch{return!1}return!(!T||P.isContextLost())&&(P.shaderSource(T,"void main() {}"),P.compileShader(T),P.getShaderParameter(T,P.COMPILE_STATUS)===!0)}(m)),_[m]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var m}(v)}var _={};function E(v,d,m){const w=s.window.document.createElement(v);return d!==void 0&&(w.className=d),m&&m.appendChild(w),w}function C(v,d,m){const w=s.window.document.createElementNS("http://www.w3.org/2000/svg",v);for(const T of Object.keys(d))w.setAttributeNS(null,T,d[T]);return m&&m.appendChild(w),w}b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const k=s.window.document&&s.window.document.documentElement.style,N=k&&k.userSelect!==void 0?"userSelect":"WebkitUserSelect";let O;function R(){k&&N&&(O=k[N],k[N]="none")}function L(){k&&N&&(k[N]=O)}function B(v){v.preventDefault(),v.stopPropagation(),s.window.removeEventListener("click",B,!0)}function q(){s.window.addEventListener("click",B,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",B,!0)},0)}function F(v,d){const m=v.getBoundingClientRect();return re(v,m,d)}function H(v,d){const m=v.getBoundingClientRect(),w=[];for(let T=0;T<d.length;T++)w.push(re(v,m,d[T]));return w}function Z(v){return s.window.InstallTrigger!==void 0&&v.button===2&&v.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button}function re(v,d,m){const w=v.offsetWidth===d.width?1:v.offsetWidth/d.width;return new s.Point((m.clientX-d.left)*w,(m.clientY-d.top)*w)}function W(v,d){var m=d[0],w=d[1],T=d[2],P=d[3],D=m*P-T*w;return D?(v[0]=P*(D=1/D),v[1]=-w*D,v[2]=-T*D,v[3]=m*D,v):null}function te(v){const{userImage:d}=v;return!!(d&&d.render&&d.render())&&(v.data.replace(new Uint8Array(d.data.buffer)),!0)}class oe extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(d){if(this.loaded!==d&&(this.loaded=d,d)){for(const{ids:m,callback:w}of this.requestors)this._notify(m,w);this.requestors=[]}}hasImage(d){return!!this.getImage(d)}getImage(d){return this.images[d]}addImage(d,m){this._validate(d,m)&&(this.images[d]=m)}_validate(d,m){let w=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${d}" has invalid "stretchX" value`))),w=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${d}" has invalid "stretchY" value`))),w=!1),this._validateContent(m.content,m)||(this.fire(new s.ErrorEvent(new Error(`Image "${d}" has invalid "content" value`))),w=!1),w}_validateStretch(d,m){if(!d)return!0;let w=0;for(const T of d){if(T[0]<w||T[1]<T[0]||m<T[1])return!1;w=T[1]}return!0}_validateContent(d,m){return!(d&&(d.length!==4||d[0]<0||m.data.width<d[0]||d[1]<0||m.data.height<d[1]||d[2]<0||m.data.width<d[2]||d[3]<0||m.data.height<d[3]||d[2]<d[0]||d[3]<d[1]))}updateImage(d,m){m.version=this.images[d].version+1,this.images[d]=m,this.updatedImages[d]=!0}removeImage(d){const m=this.images[d];delete this.images[d],delete this.patterns[d],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(d,m){let w=!0;if(!this.isLoaded())for(const T of d)this.images[T]||(w=!1);this.isLoaded()||w?this._notify(d,m):this.requestors.push({ids:d,callback:m})}_notify(d,m){const w={};for(const T of d){this.images[T]||this.fire(new s.Event("styleimagemissing",{id:T}));const P=this.images[T];P?w[T]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:s.warnOnce(`Image "${T}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,w)}getPixelSize(){const{width:d,height:m}=this.atlasImage;return{width:d,height:m}}getPattern(d){const m=this.patterns[d],w=this.getImage(d);if(!w)return null;if(m&&m.position.version===w.version)return m.position;if(m)m.position.version=w.version;else{const T={w:w.data.width+2,h:w.data.height+2,x:0,y:0},P=new s.ImagePosition(T,w);this.patterns[d]={bin:T,position:P}}return this._updatePatternAtlas(),this.patterns[d].position}bind(d){const m=d.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(d,this.atlasImage,m.RGBA),this.atlasTexture&&this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const d=[];for(const P in this.patterns)d.push(this.patterns[P].bin);const{w:m,h:w}=s.potpack(d),T=this.atlasImage;T.resize({width:m||1,height:w||1});for(const P in this.patterns){const{bin:D}=this.patterns[P],z=D.x+1,U=D.y+1,K=this.images[P].data,X=K.width,Q=K.height;s.RGBAImage.copy(K,T,{x:0,y:0},{x:z,y:U},{width:X,height:Q}),s.RGBAImage.copy(K,T,{x:0,y:Q-1},{x:z,y:U-1},{width:X,height:1}),s.RGBAImage.copy(K,T,{x:0,y:0},{x:z,y:U+Q},{width:X,height:1}),s.RGBAImage.copy(K,T,{x:X-1,y:0},{x:z-1,y:U},{width:1,height:Q}),s.RGBAImage.copy(K,T,{x:0,y:0},{x:z+X,y:U},{width:1,height:Q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(d){for(const m of d){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const w=this.images[m];te(w)&&this.updateImage(m,w)}}}const ie=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(v,d){return function([m,w,T]){const P=s.degToRad(w+90),D=s.degToRad(T);return{x:m*Math.cos(P)*Math.sin(D),y:m*Math.sin(P)*Math.sin(D),z:m*Math.cos(D),azimuthal:w,polar:T}}(v.expression.evaluate(d))}interpolate(v,d,m){return{x:s.number(v.x,d.x,m),y:s.number(v.y,d.y,m),z:s.number(v.z,d.z,m),azimuthal:s.number(v.azimuthal,d.azimuthal,m),polar:s.number(v.polar,d.polar,m)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)});class ue extends s.Evented{constructor(d){super(),this._transitionable=new s.Transitionable(ie),this.setLight(d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(d,m={}){if(!this._validate(s.validateLight,d,m))for(const w in d){const T=d[w];s.endsWith(w,"-transition")?this._transitionable.setTransition(w.slice(0,-11),T):this._transitionable.setValue(w,T)}}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,m,w){return(!w||w.validate!==!1)&&s.emitValidationErrors(this,d.call(s.validateStyle,s.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const _e=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)});let xe=class extends s.Evented{constructor(v,d){super(),this._transitionable=new s.Transitionable(_e),this.set(v),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=d}get(){return this._transitionable.serialize()}set(v){for(const d in v){const m=v[d];s.endsWith(d,"-transition")?this._transitionable.setTransition(d.slice(0,-11),m):this._transitionable.setValue(d,m)}}updateTransitions(v){this._transitioning=this._transitionable.transitioned(v,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(v){this.properties=this._transitioning.possiblyEvaluate(v)}};function be(v,d,m,w){const T=s.smoothstep(45,65,m),[P,D]=Ae(v,w),z=s.length(d);let U=1-Math.min(1,Math.exp((z-P)/(D-P)*-6));return U*=U*U,U=Math.min(1,1.00747*U),U*T*v.alpha}function Ae(v,d){const m=.5/Math.tan(.5*d);return[v.range[0]+m,v.range[1]+m]}const me=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])});class ke extends s.Evented{constructor(d,m){super(),this._transitionable=new s.Transitionable(me),this.set(d),this._transitioning=this._transitionable.untransitioned(),this._transform=m}get state(){const d=this._transform,m=d.projection.name==="globe",w=s.globeToMercatorTransition(d.zoom),T=this.properties.get("range"),P=[.5,3];return{range:m?[s.number(P[0],T[0],w),s.number(P[1],T[1],w)]:T,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(d,m={}){if(!this._validate(s.validateFog,d,m)){for(const w of Object.keys(s.spec.fog))d&&d[w]===void 0&&(d[w]=s.spec.fog[w].default);for(const w in d){const T=d[w];s.endsWith(w,"-transition")?this._transitionable.setTransition(w.slice(0,-11),T):this._transitionable.setValue(w,T)}}}getOpacity(d){if(!this._transform.projection.supportsFog)return 0;const m=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,d))*m.a}getOpacityAtLatLng(d,m){return this._transform.projection.supportsFog?function(w,T,P){const D=s.MercatorCoordinate.fromLngLat(T),z=P.elevation?P.elevation.getAtPointOrZero(D):0,U=[D.x,D.y,z];return s.transformMat4(U,U,P.mercatorFogMatrix),be(w,U,P.pitch,P._fov)}(this.state,d,m):0}getFovAdjustedRange(d){return this._transform.projection.supportsFog?Ae(this.state,d):[0,1]}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,m,w){return(!w||w.validate!==!1)&&s.emitValidationErrors(this,d.call(s.validateStyle,s.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class Ne{constructor(d,m){this.workerPool=d,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const w=this.workerPool.acquire(this.id);for(let T=0;T<w.length;T++){const P=new Ne.Actor(w[T],m,this.id);P.name=`Worker ${T}`,this.actors.push(P)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(d,m,w){s.asyncAll(this.actors,(T,P)=>{T.send(d,m,P)},w=w||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(d=>{d.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Be(v,d,m){return d*(s.EXTENT/(v.tileSize*Math.pow(2,m-v.tileID.overscaledZ)))}Ne.Actor=s.Actor;class We{constructor(d,m,w,T){this.screenBounds=d,this.cameraPoint=m,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=w,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,T)}static createFromScreenPoints(d,m){let w,T;if(d instanceof s.Point||typeof d[0]=="number"){const P=s.Point.convert(d);w=[P],T=m.isPointAboveHorizon(P)}else{const P=s.Point.convert(d[0]),D=s.Point.convert(d[1]);w=[P,D],T=s.polygonizeBounds(P,D).every(z=>m.isPointAboveHorizon(z))}return new We(w,m.getCameraPoint(),T,m)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(d){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],d)}bufferedCameraGeometry(d){const m=this.screenBounds[0],w=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],T=s.polygonizeBounds(m,w,0,!1);return this.cameraPoint.y>w.y&&(this.cameraPoint.x>m.x&&this.cameraPoint.x<w.x?T.splice(3,0,this.cameraPoint):this.cameraPoint.x>=w.x?T[2]=this.cameraPoint:this.cameraPoint.x<=m.x&&(T[3]=this.cameraPoint)),s.bufferConvexPolygon(T,d)}bufferedCameraGeometryGlobe(d){const m=this.screenBounds[0],w=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],T=s.polygonizeBounds(m,w,d),P=this.cameraPoint.clone();switch(3*((P.y>m.y)+(P.y>w.y))+((P.x>m.x)+(P.x>w.x))){case 0:T[0]=P,T[4]=P.clone();break;case 1:T.splice(1,0,P);break;case 2:T[1]=P;break;case 3:T.splice(4,0,P);break;case 5:T.splice(2,0,P);break;case 6:T[3]=P;break;case 7:T.splice(3,0,P);break;case 8:T[2]=P}return T}containsTile(d,m,w,T=0){const P=d.queryPadding/m._pixelsPerMercatorPixel+1,D=w?this._bufferedCameraMercator(P,m):this._bufferedScreenMercator(P,m);let z=d.tileID.wrap+(D.unwrapped?T:0);const U=D.polygon.map(ge=>s.getTilePoint(d.tileTransform,ge,z));if(!s.polygonIntersectsBox(U,0,0,s.EXTENT,s.EXTENT))return;z=d.tileID.wrap+(this.screenGeometryMercator.unwrapped?T:0);const K=this.screenGeometryMercator.polygon.map(ge=>s.getTileVec3(d.tileTransform,ge,z)),X=K.map(ge=>new s.Point(ge[0],ge[1])),Q=m.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),le=s.getTileVec3(d.tileTransform,Q,z),he=K.map(ge=>{const ee=s.sub(ge,ge,le);return s.normalize(ee,ee),new s.Ray(le,ee)}),pe=Be(d,1,m.zoom)*m._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:X,tilespaceRays:he,bufferedTilespaceGeometry:U,bufferedTilespaceBounds:(fe=s.getBounds(U),fe.min.x=s.clamp(fe.min.x,0,s.EXTENT),fe.min.y=s.clamp(fe.min.y,0,s.EXTENT),fe.max.x=s.clamp(fe.max.x,0,s.EXTENT),fe.max.y=s.clamp(fe.max.y,0,s.EXTENT),fe),tile:d,tileID:d.tileID,pixelToTileUnitsFactor:pe};var fe}_bufferedScreenMercator(d,m){const w=Pt(d);if(this._screenRaycastCache[w])return this._screenRaycastCache[w];{let T;return T=m.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(d),m):{polygon:this.bufferedScreenGeometry(d).map(P=>m.pointCoordinate3D(P)),unwrapped:!0},this._screenRaycastCache[w]=T,T}}_bufferedCameraMercator(d,m){const w=Pt(d);if(this._cameraRaycastCache[w])return this._cameraRaycastCache[w];{let T;return T=m.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(d),m):{polygon:this.bufferedCameraGeometry(d).map(P=>m.pointCoordinate3D(P)),unwrapped:!0},this._cameraRaycastCache[w]=T,T}}_projectAndResample(d,m){const w=function(P,D){const z=s.multiply([],D.pixelMatrix,D.globeMatrix),U=[0,-s.GLOBE_RADIUS,0,1],K=[0,s.GLOBE_RADIUS,0,1],X=[0,0,0,1];s.transformMat4$1(U,U,z),s.transformMat4$1(K,K,z),s.transformMat4$1(X,X,z);const Q=new s.Point(U[0]/U[3],U[1]/U[3]),le=new s.Point(K[0]/K[3],K[1]/K[3]),he=s.polygonContainsPoint(P,Q)&&U[3]<X[3],pe=s.polygonContainsPoint(P,le)&&K[3]<X[3];if(!he&&!pe)return null;const fe=function(De,Ue,Fe){for(let Ze=1;Ze<De.length;Ze++){const wt=nt(Ue.pointCoordinate3D(De[Ze-1]).x),He=nt(Ue.pointCoordinate3D(De[Ze]).x);if(Fe<0){if(wt<He)return{idx:Ze,t:-wt/(He-1-wt)}}else if(He<wt)return{idx:Ze,t:(1-wt)/(He+1-wt)}}return null}(P,D,he?-1:1);if(!fe)return null;const{idx:ge,t:ee}=fe;let de=ge>1?ut(P.slice(0,ge),D):[],we=ge<P.length?ut(P.slice(ge),D):[];de=de.map(De=>new s.Point(nt(De.x),De.y)),we=we.map(De=>new s.Point(nt(De.x),De.y));const Se=[...de];Se.length===0&&Se.push(we[we.length-1]);const Re=s.number(Se[Se.length-1].y,(we.length===0?de[0]:we[0]).y,ee);let Le;return Le=he?[new s.Point(0,Re),new s.Point(0,0),new s.Point(1,0),new s.Point(1,Re)]:[new s.Point(1,Re),new s.Point(1,1),new s.Point(0,1),new s.Point(0,Re)],Se.push(...Le),we.length===0?Se.push(de[0]):Se.push(...we),{polygon:Se.map(De=>new s.MercatorCoordinate(De.x,De.y)),unwrapped:!1}}(d,m);if(w)return w;const T=function(P,D){let z=!1,U=-1/0,K=0;for(let Q=0;Q<P.length-1;Q++)P[Q].x>U&&(U=P[Q].x,K=Q);for(let Q=0;Q<P.length-1;Q++){const le=(K+Q)%(P.length-1),he=P[le],pe=P[le+1];Math.abs(he.x-pe.x)>.5&&(he.x<pe.x?(he.x+=1,le===0&&(P[P.length-1].x+=1)):(pe.x+=1,le+1===P.length-1&&(P[0].x+=1)),z=!0)}const X=s.mercatorXfromLng(D.center.lng);return z&&X<Math.abs(X-1)&&P.forEach(Q=>{Q.x-=1}),{polygon:P,unwrapped:z}}(ut(d,m).map(P=>new s.Point(nt(P.x),P.y)),m);return{polygon:T.polygon.map(P=>new s.MercatorCoordinate(P.x,P.y)),unwrapped:T.unwrapped}}}function ut(v,d){return s.resample(v,m=>{const w=d.pointCoordinate3D(m);m.x=w.x,m.y=w.y},1/256)}function nt(v){return v<0?1+v%1:v%1}function Pt(v){return 100*v|0}function It(v,d,m,w,T){const P=function(D,z){if(D)return T(D);if(z){v.url&&z.tiles&&v.tiles&&delete v.tiles;const U=s.pick(s.extend(z,v),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);z.vector_layers&&(U.vectorLayers=z.vector_layers,U.vectorLayerIds=U.vectorLayers.map(K=>K.id)),U.tiles=d.canonicalizeTileset(U,v.url),T(null,U)}};return v.url?s.getJSON(d.transformRequest(d.normalizeSourceURL(v.url,null,m,w),s.ResourceType.Source),P):s.exported.frame(()=>P(null,v))}class at{constructor(d,m,w){this.bounds=s.LngLatBounds.convert(this.validateBounds(d)),this.minzoom=m||0,this.maxzoom=w||24}validateBounds(d){return Array.isArray(d)&&d.length===4?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]}contains(d){const m=Math.pow(2,d.z),w=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*m),T=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*m),P=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*m),D=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*m);return d.x>=w&&d.x<P&&d.y>=T&&d.y<D}}class Ut{constructor(d,m,w){this.context=d;const T=d.gl;this.buffer=T.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(d){const m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ct={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class gt{constructor(d,m,w,T){this.length=m.length,this.attributes=w,this.itemSize=m.bytesPerElement,this.dynamicDraw=T,this.context=d;const P=d.gl;this.buffer=P.createBuffer(),d.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(d){const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,d.arrayBuffer)}enableAttributes(d,m){for(let w=0;w<this.attributes.length;w++){const T=m.attributes[this.attributes[w].name];T!==void 0&&d.enableVertexAttribArray(T)}}setVertexAttribPointers(d,m,w){for(let T=0;T<this.attributes.length;T++){const P=this.attributes[T],D=m.attributes[P.name];D!==void 0&&d.vertexAttribPointer(D,P.components,d[ct[P.type]],!1,this.itemSize,P.offset+this.itemSize*(w||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class it{constructor(d){this.gl=d.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(d){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class rt extends it{getDefault(){return s.Color.transparent}set(d){const m=this.current;(d.r!==m.r||d.g!==m.g||d.b!==m.b||d.a!==m.a||this.dirty)&&(this.gl.clearColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class rr extends it{getDefault(){return 1}set(d){(d!==this.current||this.dirty)&&(this.gl.clearDepth(d),this.current=d,this.dirty=!1)}}class ir extends it{getDefault(){return 0}set(d){(d!==this.current||this.dirty)&&(this.gl.clearStencil(d),this.current=d,this.dirty=!1)}}class or extends it{getDefault(){return[!0,!0,!0,!0]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||d[2]!==m[2]||d[3]!==m[3]||this.dirty)&&(this.gl.colorMask(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class Sr extends it{getDefault(){return!0}set(d){(d!==this.current||this.dirty)&&(this.gl.depthMask(d),this.current=d,this.dirty=!1)}}class tn extends it{getDefault(){return 255}set(d){(d!==this.current||this.dirty)&&(this.gl.stencilMask(d),this.current=d,this.dirty=!1)}}class Mn extends it{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(d){const m=this.current;(d.func!==m.func||d.ref!==m.ref||d.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(d.func,d.ref,d.mask),this.current=d,this.dirty=!1)}}class vn extends it{getDefault(){const d=this.gl;return[d.KEEP,d.KEEP,d.KEEP]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||d[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(d[0],d[1],d[2]),this.current=d,this.dirty=!1)}}class Zs extends it{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=d,this.dirty=!1}}class qi extends it{getDefault(){return[0,1]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||this.dirty)&&(this.gl.depthRange(d[0],d[1]),this.current=d,this.dirty=!1)}}class ns extends it{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=d,this.dirty=!1}}class ms extends it{getDefault(){return this.gl.LESS}set(d){(d!==this.current||this.dirty)&&(this.gl.depthFunc(d),this.current=d,this.dirty=!1)}}class xa extends it{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.BLEND):m.disable(m.BLEND),this.current=d,this.dirty=!1}}class Fa extends it{getDefault(){const d=this.gl;return[d.ONE,d.ZERO]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(d[0],d[1]),this.current=d,this.dirty=!1)}}class ft extends it{getDefault(){return s.Color.transparent}set(d){const m=this.current;(d.r!==m.r||d.g!==m.g||d.b!==m.b||d.a!==m.a||this.dirty)&&(this.gl.blendColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class Kt extends it{getDefault(){return this.gl.FUNC_ADD}set(d){(d!==this.current||this.dirty)&&(this.gl.blendEquation(d),this.current=d,this.dirty=!1)}}class Ar extends it{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=d,this.dirty=!1}}class Zr extends it{getDefault(){return this.gl.BACK}set(d){(d!==this.current||this.dirty)&&(this.gl.cullFace(d),this.current=d,this.dirty=!1)}}class In extends it{getDefault(){return this.gl.CCW}set(d){(d!==this.current||this.dirty)&&(this.gl.frontFace(d),this.current=d,this.dirty=!1)}}let Ii,Wi=class extends it{getDefault(){return null}set(v){(v!==this.current||this.dirty)&&(this.gl.useProgram(v),this.current=v,this.dirty=!1)}};class Ua extends it{getDefault(){return this.gl.TEXTURE0}set(d){(d!==this.current||this.dirty)&&(this.gl.activeTexture(d),this.current=d,this.dirty=!1)}}class Oi extends it{getDefault(){const d=this.gl;return[0,0,d.drawingBufferWidth,d.drawingBufferHeight]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||d[2]!==m[2]||d[3]!==m[3]||this.dirty)&&(this.gl.viewport(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class wo extends it{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,d),this.current=d,this.dirty=!1}}class Zl extends it{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class ru extends it{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,d),this.current=d,this.dirty=!1}}class Nf extends it{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class Ce extends it{getDefault(){return null}set(d){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class se extends it{constructor(d){super(d),this.vao=d.extVertexArrayObject}getDefault(){return null}set(d){this.vao&&(d!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(d),this.current=d,this.dirty=!1)}}class ae extends it{getDefault(){return 4}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,d),this.current=d,this.dirty=!1}}class Ee extends it{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),this.current=d,this.dirty=!1}}class Oe extends it{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,d),this.current=d,this.dirty=!1}}class $e extends it{constructor(d,m){super(d),this.context=d,this.parent=m}getDefault(){return null}}class Ge extends $e{setDirty(){this.dirty=!0}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,d,0),this.current=d,this.dirty=!1}}class qe extends $e{attachment(){return this.gl.DEPTH_ATTACHMENT}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,this.attachment(),m.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class ze extends qe{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class et{constructor(d,m,w,T){this.context=d,this.width=m,this.height=w;const P=this.framebuffer=d.gl.createFramebuffer();this.colorAttachment=new Ge(d,P),T&&(this.depthAttachment=new qe(d,P))}destroy(){const d=this.context.gl,m=this.colorAttachment.get();if(m&&d.deleteTexture(m),this.depthAttachment){const w=this.depthAttachment.get();w&&d.deleteRenderbuffer(w)}d.deleteFramebuffer(this.framebuffer)}}class kt{constructor(d,m=!1){if(this.gl=d,this.isWebGL2=m,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),m){const w=d;this.extVertexArrayObject={createVertexArrayOES:w.createVertexArray.bind(d),deleteVertexArrayOES:w.deleteVertexArray.bind(d),bindVertexArrayOES:w.bindVertexArray.bind(d)}}this.clearColor=new rt(this),this.clearDepth=new rr(this),this.clearStencil=new ir(this),this.colorMask=new or(this),this.depthMask=new Sr(this),this.stencilMask=new tn(this),this.stencilFunc=new Mn(this),this.stencilOp=new vn(this),this.stencilTest=new Zs(this),this.depthRange=new qi(this),this.depthTest=new ns(this),this.depthFunc=new ms(this),this.blend=new xa(this),this.blendFunc=new Fa(this),this.blendColor=new ft(this),this.blendEquation=new Kt(this),this.cullFace=new Ar(this),this.cullFaceSide=new Zr(this),this.frontFace=new In(this),this.program=new Wi(this),this.activeTexture=new Ua(this),this.viewport=new Oi(this),this.bindFramebuffer=new wo(this),this.bindRenderbuffer=new Zl(this),this.bindTexture=new ru(this),this.bindVertexBuffer=new Nf(this),this.bindElementBuffer=new Ce(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new se(this),this.pixelStoreUnpack=new ae(this),this.pixelStoreUnpackPremultiplyAlpha=new Ee(this),this.pixelStoreUnpackFlipY=new Oe(this),this.extTextureFilterAnisotropic=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=d.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=d.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=d.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=d.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),m||(this.extTextureHalfFloat=d.getExtension("OES_texture_half_float")),(m||this.extTextureHalfFloat&&d.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=d.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=m||d.getExtension("OES_standard_derivatives"),this.extTimerQuery=d.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(d,m){return new Ut(this,d,m)}createVertexBuffer(d,m,w){return new gt(this,d,m,w)}createRenderbuffer(d,m,w){const T=this.gl,P=T.createRenderbuffer();return this.bindRenderbuffer.set(P),T.renderbufferStorage(T.RENDERBUFFER,d,m,w),this.bindRenderbuffer.set(null),P}createFramebuffer(d,m,w){return new et(this,d,m,w)}clear({color:d,depth:m,stencil:w}){const T=this.gl;let P=0;d&&(P|=T.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(P|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),w!==void 0&&(P|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),T.clear(P)}setCullFace(d){d.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))}setDepthMode(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)}setStencilMode(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)}setColorMode(d){p(d.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Ot extends s.Evented{constructor(d,m,w,T){if(super(),this.id=d,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(m,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(T),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(d){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const m=Array.isArray(this.map._language)?this.map._language.join():this.map._language,w=this.map._worldview;this._tileJSONRequest=It(this._options,this.map._requestManager,m,w,(T,P)=>{this._tileJSONRequest=null,this._loaded=!0,T?(m&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${m}`),w&&w.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${w}`),this.fire(new s.ErrorEvent(T))):P&&(s.extend(this,P),P.bounds&&(this.tileBounds=new at(P.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(P.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(T)})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(d,m){const w=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),T={request:this.map._requestManager.transformRequest(w,s.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(T.request.collectResourceTiming=this._collectResourceTiming,d.actor&&d.state!=="expired")d.state==="loading"?d.reloadCallback=m:d.request=d.actor.send("reloadTile",T,P.bind(this));else if(d.actor=this._tileWorkers[w]=this._tileWorkers[w]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",T,P.bind(this),void 0,!0);else{const D=s.loadVectorTile.call({deduped:this._deduped},T,(z,U)=>{z||!U?P.call(this,z):(T.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},d.actor&&d.actor.send("loadTile",T,P.bind(this),void 0,!0))},!0);d.request={cancel:D}}function P(D,z){return delete d.request,d.aborted?m(null):D&&D.status!==404?m(D):(z&&z.resourceTiming&&(d.resourceTiming=z.resourceTiming),this.map._refreshExpiredTiles&&z&&d.setExpiryData(z),d.loadVectorData(z,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ct extends s.Evented{constructor(d,m,w,T){super(),this.id=d,this.dispatcher=w,this.setEventedParent(T),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},m),s.extend(this,s.pick(m,["url","scheme","tileSize"]))}load(d){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=It(this._options,this.map._requestManager,null,null,(m,w)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new s.ErrorEvent(m)):w&&(s.extend(this,w),w.bounds&&(this.tileBounds=new at(w.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(w.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(m)})}loaded(){return this._loaded}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,m){const w=s.exported.devicePixelRatio>=2,T=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),w,this.tileSize);d.request=s.getImage(this.map._requestManager.transformRequest(T,s.ResourceType.Tile),(P,D,z,U)=>(delete d.request,d.aborted?(d.state="unloaded",m(null)):P?(d.state="errored",m(P)):D?(this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:z,expires:U}),d.setTexture(D,this.map.painter),d.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void m(null)):m(null)))}static loadTileData(d,m,w){d.setTexture(m,w)}static unloadTileData(d,m){d.texture&&m.saveTileTexture(d.texture)}abortTile(d,m){d.request&&(d.request.cancel(),delete d.request),m()}unloadTile(d,m){d.texture&&this.map.painter.saveTileTexture(d.texture),m()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function pr(v,d,m,w,T,P,D,z){const U=[v,m,T,d,w,P,1,1,1],K=[D,z,1],X=s.adjoint([],U),[Q,le,he]=s.transformMat3(K,K,s.transpose(X,X));return s.multiply$1(U,[Q,0,0,0,le,0,0,0,he],U)}class br extends s.Evented{constructor(d,m,w,T){super(),this.id=d,this.dispatcher=w,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(T),this.options=m,this._dirty=!1}load(d,m){this._loaded=m||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(w,T)=>{if(this._imageRequest=null,this._loaded=!0,w)this.fire(new s.ErrorEvent(w));else if(T){const{HTMLImageElement:P}=s.window;this.image=T instanceof P?s.exported.getImageData(T):T,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,d&&(this.coordinates=d),this._finishLoading()}})}loaded(){return this._loaded}updateImage(d){return this.image&&d.url?(this._imageRequest&&d.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=d.url,this.load(d.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(d){this.map=d,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(d){this.coordinates=d,this._boundsArray=void 0;const m=d.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(w){let T=1/0,P=1/0,D=-1/0,z=-1/0;for(const Q of w)T=Math.min(T,Q.x),P=Math.min(P,Q.y),D=Math.max(D,Q.x),z=Math.max(z,Q.y);const U=Math.max(D-T,z-P),K=Math.max(0,Math.floor(-Math.log(U)/Math.LN2)),X=Math.pow(2,K);return new s.CanonicalTileID(K,Math.floor((T+D)/2*X),Math.floor((P+z)/2*X))}(m),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(d){for(const U in this.tiles){const K=this.tiles[U];K.state!=="loaded"&&(K.state="loaded",K.texture=this.texture)}if(this._boundsArray)return;const m=s.tileTransform(this.tileID,this.map.transform.projection),[w,T,P,D]=this.coordinates.map(U=>{const K=m.projection.project(U[0],U[1]);return s.getTilePoint(m,K)._round()});this.perspectiveTransform=function(U,K,X,Q,le,he,pe,fe,ge,ee){const de=pr(0,0,U,0,0,K,U,K),we=pr(X,Q,le,he,pe,fe,ge,ee);return s.multiply$1(we,s.adjoint(de,de),we),[we[6]/we[8]*U/s.EXTENT,we[7]/we[8]*K/s.EXTENT]}(this.width,this.height,w.x,w.y,T.x,T.y,D.x,D.y,P.x,P.y);const z=this._boundsArray=new s.StructArrayLayout4i8;z.emplaceBack(w.x,w.y,0,0),z.emplaceBack(T.x,T.y,s.EXTENT,0),z.emplaceBack(D.x,D.y,0,s.EXTENT),z.emplaceBack(P.x,P.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=d.createVertexBuffer(z,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const d=this.map.painter.context,m=d.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(d,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(d)}loadTile(d,m){this.tileID&&this.tileID.equals(d.tileID.canonical)?(this.tiles[String(d.tileID.wrap)]=d,d.buckets={},m(null)):(d.state="errored",m(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const mr={vector:Ot,raster:Ct,"raster-dem":class extends Ct{constructor(v,d,m,w){super(v,d,m,w),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}loadTile(v,d){const m=this.map._requestManager.normalizeTileURL(v.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function w(T,P){T&&(v.state="errored",d(T)),P&&(v.dem=P,v.dem.onDeserialize(),v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0,v.state="loaded",d(null))}v.request=s.getImage(this.map._requestManager.transformRequest(m,s.ResourceType.Tile),(function(T,P,D,z){if(delete v.request,v.aborted)v.state="unloaded",d(null);else if(T)v.state="errored",d(T);else if(P){this.map._refreshExpiredTiles&&v.setExpiryData({cacheControl:D,expires:z});const U=s.window.ImageBitmap&&P instanceof s.window.ImageBitmap&&(Ii==null&&(Ii=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),Ii),K=1-(P.width-s.prevPowerOfTwo(P.width))/2;K<1||v.neighboringTiles||(v.neighboringTiles=this._getNeighboringTiles(v.tileID));const X=U?P:s.exported.getImageData(P,K),Q={uid:v.uid,coord:v.tileID,source:this.id,rawImageData:X,encoding:this.encoding,padding:K};v.actor&&v.state!=="expired"||(v.actor=this.dispatcher.getActor(),v.actor.send("loadDEMTile",Q,w.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(v){const d=v.canonical,m=Math.pow(2,d.z),w=(d.x-1+m)%m,T=d.x===0?v.wrap-1:v.wrap,P=(d.x+1+m)%m,D=d.x+1===m?v.wrap+1:v.wrap,z={};return z[new s.OverscaledTileID(v.overscaledZ,T,d.z,w,d.y).key]={backfilled:!1},z[new s.OverscaledTileID(v.overscaledZ,D,d.z,P,d.y).key]={backfilled:!1},d.y>0&&(z[new s.OverscaledTileID(v.overscaledZ,T,d.z,w,d.y-1).key]={backfilled:!1},z[new s.OverscaledTileID(v.overscaledZ,v.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},z[new s.OverscaledTileID(v.overscaledZ,D,d.z,P,d.y-1).key]={backfilled:!1}),d.y+1<m&&(z[new s.OverscaledTileID(v.overscaledZ,T,d.z,w,d.y+1).key]={backfilled:!1},z[new s.OverscaledTileID(v.overscaledZ,v.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},z[new s.OverscaledTileID(v.overscaledZ,D,d.z,P,d.y+1).key]={backfilled:!1}),z}unloadTile(v){v.demTexture&&this.map.painter.saveTileTexture(v.demTexture),v.fbo&&(v.fbo.destroy(),delete v.fbo),v.dem&&delete v.dem,delete v.neighboringTiles,v.state="unloaded"}},geojson:class extends s.Evented{constructor(v,d,m,w){super(),this.id=v,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(w),this._data=d.data,this._options=s.extend({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const T=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*T,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*T,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:s.EXTENT,radius:(d.clusterRadius!==void 0?d.clusterRadius:50)*T,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions)}onAdd(v){this.map=v,this.setData(this._data)}setData(v){return this._data=v,this._updateWorkerData(),this}getClusterExpansionZoom(v,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:v,source:this.id},d),this}getClusterChildren(v,d){return this.actor.send("geojson.getClusterChildren",{clusterId:v,source:this.id},d),this}getClusterLeaves(v,d,m,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:v,limit:d,offset:m},w),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const v=s.extend({},this.workerOptions),d=this._data;typeof d=="string"?(v.request=this.map._requestManager.transformRequest(s.exported.resolveURL(d),s.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,v,(m,w)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new s.ErrorEvent(m));else{const T={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&w&&w.resourceTiming&&w.resourceTiming[this.id]&&(T.resourceTiming=w.resourceTiming[this.id]),this.fire(new s.Event("data",T)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(v,d){const m=v.actor?"reloadTile":"loadTile";v.actor=this.actor,v.request=this.actor.send(m,{type:this.type,uid:v.uid,tileID:v.tileID,tileZoom:v.tileZoom,zoom:v.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(w,T)=>(delete v.request,v.unloadVectorData(),v.aborted?d(null):w?d(w):(v.loadVectorData(T,this.map.painter,m==="reloadTile"),d(null))),void 0,m==="loadTile")}abortTile(v){v.request&&(v.request.cancel(),delete v.request),v.aborted=!0}unloadTile(v){v.unloadVectorData(),this.actor.send("removeTile",{uid:v.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends br{constructor(v,d,m,w){super(v,d,m,w),this.roundZoom=!0,this.type="video",this.options=d}load(){this._loaded=!1;const v=this.options;this.urls=[];for(const d of v.urls)this.urls.push(this.map._requestManager.transformRequest(d,s.ResourceType.Source).url);s.getVideo(this.urls,(d,m)=>{this._loaded=!0,d?this.fire(new s.ErrorEvent(d)):m&&(this.video=m,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(v){if(this.video){const d=this.video.seekable;v<d.start(0)||v>d.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=v}}getVideo(){return this.video}onAdd(v){this.map||(this.map=v,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const v=this.map.painter.context,d=v.gl;this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(v,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(v)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:br,canvas:class extends br{constructor(v,d,m,w){super(v,d,m,w),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(T=>!Array.isArray(T)||T.length!==2||T.some(P=>typeof P!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${v}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${v}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${v}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${v}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${v}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(v){this.map=v,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const d=this.map.painter.context;this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(d,this.canvas,d.gl.RGBA,{premultiply:!0}),this._prepareData(d)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const v of[this.canvas.width,this.canvas.height])if(isNaN(v)||v<=0)return!0;return!1}},custom:class extends s.Evented{constructor(v,d,m,w){super(),this.id=v,this.type="custom",this._dataType="raster",this._dispatcher=m,this._implementation=d,this.setEventedParent(w),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new at(this._implementation.bounds,this.minzoom,this.maxzoom)),d.update=this._update.bind(this),d.clearTiles=this._clearTiles.bind(this),d.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(d,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(v){this._map=v,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(v),this.load()}onRemove(v){this._implementation.onRemove&&this._implementation.onRemove(v)}hasTile(v){if(this._implementation.hasTile){const{x:d,y:m,z:w}=v.canonical;return this._implementation.hasTile({x:d,y:m,z:w})}return!this.tileBounds||this.tileBounds.contains(v.canonical)}loadTile(v,d){const{x:m,y:w,z:T}=v.tileID.canonical,P=new s.window.AbortController;v.request=Promise.resolve(this._implementation.loadTile({x:m,y:w,z:T},{signal:P.signal})).then((function(D){return delete v.request,v.aborted?(v.state="unloaded",d(null)):D===void 0?(v.state="errored",d(null)):D===null?(this.loadTileData(v,{width:this.tileSize,height:this.tileSize,data:null}),v.state="loaded",d(null)):function(z){return z instanceof s.window.ImageData||z instanceof s.window.HTMLCanvasElement||z instanceof s.window.ImageBitmap||z instanceof s.window.HTMLImageElement}(D)?(this.loadTileData(v,D),v.state="loaded",void d(null)):(v.state="errored",d(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(D=>{D.code!==20&&(v.state="errored",d(D))}),v.request.cancel=()=>P.abort()}loadTileData(v,d){Ct.loadTileData(v,d,this._map.painter)}unloadTileData(v){Ct.unloadTileData(v,this._map.painter)}unloadTile(v,d){if(this.unloadTileData(v),this._implementation.unloadTile){const{x:m,y:w,z:T}=v.tileID.canonical;this._implementation.unloadTile({x:m,y:w,z:T})}d()}abortTile(v,d){v.request&&v.request.cancel&&(v.request.cancel(),delete v.request),d()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(v=>({x:v.canonical.x,y:v.canonical.y,z:v.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},_r=function(v,d,m,w){const T=new mr[d.type](v,d,m,w);if(T.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${T.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],T),T};function Nr(v,d){const m=s.identity([]);return s.scale(m,m,[.5*v.width,.5*-v.height,1]),s.translate(m,m,[1,-1,0]),s.multiply(m,m,v.calculateProjMatrix(d.toUnwrapped())),Float32Array.from(m)}function Pn(v,d,m,w,T,P,D,z=!1){const U=v.tilesIn(w,D,z);U.sort(Gi);const K=[];for(const Q of U)K.push({wrappedTileID:Q.tile.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(d,m,v._state,Q,T,P,Nr(v.transform,Q.tile.tileID),z)});const X=function(Q){const le={},he={};for(const pe of Q){const fe=pe.queryResults,ge=pe.wrappedTileID,ee=he[ge]=he[ge]||{};for(const de in fe){const we=fe[de],Se=ee[de]=ee[de]||{},Re=le[de]=le[de]||[];for(const Le of we)Se[Le.featureIndex]||(Se[Le.featureIndex]=!0,Re.push(Le))}}return le}(K);for(const Q in X)X[Q].forEach(le=>{const he=le.feature,pe=he.layer;pe&&pe.type!=="background"&&pe.type!=="sky"&&(he.source=pe.source,pe["source-layer"]&&(he.sourceLayer=pe["source-layer"]),he.state=he.id!==void 0?v.getFeatureState(pe["source-layer"],he.id):{})});return X}function Yn(v,d){const m=v.getRenderableIds().map(P=>v.getTileByID(P)),w=[],T={};for(let P=0;P<m.length;P++){const D=m[P],z=D.tileID.canonical.key;T[z]||(T[z]=!0,D.querySourceFeatures(w,d))}return w}function Gi(v,d){const m=v.tileID,w=d.tileID;return m.overscaledZ-w.overscaledZ||m.canonical.y-w.canonical.y||m.wrap-w.wrap||m.canonical.x-w.canonical.x}function ui(){return _u.workerClass!=null?new _u.workerClass:new s.window.Worker(_u.workerUrl)}const Va="mapboxgl_preloaded_worker_pool";class xi{constructor(){this.active={}}acquire(d){if(!this.workers)for(this.workers=[];this.workers.length<xi.workerCount;)this.workers.push(new ui);return this.active[d]=!0,this.workers.slice()}release(d){delete this.active[d],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Va]}numActive(){return Object.keys(this.active).length}}let is;function nu(){return is||(is=new xi),is}function W2(v,d){const m={};for(const w in v)w!=="ref"&&(m[w]=v[w]);return s.refProperties.forEach(w=>{w in d&&(m[w]=d[w])}),m}function cb(v){v=v.slice();const d=Object.create(null);for(let m=0;m<v.length;m++)d[v[m].id]=v[m];for(let m=0;m<v.length;m++)"ref"in v[m]&&(v[m]=W2(v[m],d[v[m].ref]));return v}xi.workerCount=2;const qr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Lg(v,d,m){m.push({command:qr.addSource,args:[v,d[v]]})}function Ld(v,d,m){d.push({command:qr.removeSource,args:[v]}),m[v]=!0}function Bg(v,d,m,w){Ld(v,m,w),Lg(v,d,m)}function kf(v,d,m){let w;for(w in v[m])if(v[m].hasOwnProperty(w)&&w!=="data"&&!p(v[m][w],d[m][w]))return!1;for(w in d[m])if(d[m].hasOwnProperty(w)&&w!=="data"&&!p(v[m][w],d[m][w]))return!1;return!0}function qa(v,d,m,w,T,P){let D;for(D in d=d||{},v=v||{})v.hasOwnProperty(D)&&(p(v[D],d[D])||m.push({command:P,args:[w,D,d[D],T]}));for(D in d)d.hasOwnProperty(D)&&!v.hasOwnProperty(D)&&(p(v[D],d[D])||m.push({command:P,args:[w,D,d[D],T]}))}function So(v){return v.id}function zg(v,d){return v[d.id]=d,v}class $g{constructor(d,m){this.reset(d,m)}reset(d,m){this.points=d||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(d){if(this.points.length===1)return this.points[0];d=s.clamp(d,0,1);let m=1,w=this._distances[m];const T=d*this.paddedLength+this.padding;for(;w<T&&m<this._distances.length;)w=this._distances[++m];const P=m-1,D=this._distances[P],z=w-D,U=z>0?(T-D)/z:0;return this.points[P].mult(1-U).add(this.points[m].mult(U))}}class Yl{constructor(d,m,w){const T=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(d/w),this.yCellCount=Math.ceil(m/w);for(let D=0;D<this.xCellCount*this.yCellCount;D++)T.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=d,this.height=m,this.xScale=this.xCellCount/d,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(d,m,w,T,P){this._forEachCell(m,w,T,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(m),this.bboxes.push(w),this.bboxes.push(T),this.bboxes.push(P)}insertCircle(d,m,w,T){this._forEachCell(m-T,w-T,m+T,w+T,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(m),this.circles.push(w),this.circles.push(T)}_insertBoxCell(d,m,w,T,P,D){this.boxCells[P].push(D)}_insertCircleCell(d,m,w,T,P,D){this.circleCells[P].push(D)}_query(d,m,w,T,P,D){if(w<0||d>this.width||T<0||m>this.height)return!P&&[];const z=[];if(d<=0&&m<=0&&this.width<=w&&this.height<=T){if(P)return!0;for(let U=0;U<this.boxKeys.length;U++)z.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const K=this.circles[3*U],X=this.circles[3*U+1],Q=this.circles[3*U+2];z.push({key:this.circleKeys[U],x1:K-Q,y1:X-Q,x2:K+Q,y2:X+Q})}return D?z.filter(D):z}return this._forEachCell(d,m,w,T,this._queryCell,z,{hitTest:P,seenUids:{box:{},circle:{}}},D),P?z.length>0:z}_queryCircle(d,m,w,T,P){const D=d-w,z=d+w,U=m-w,K=m+w;if(z<0||D>this.width||K<0||U>this.height)return!T&&[];const X=[];return this._forEachCell(D,U,z,K,this._queryCellCircle,X,{hitTest:T,circle:{x:d,y:m,radius:w},seenUids:{box:{},circle:{}}},P),T?X.length>0:X}query(d,m,w,T,P){return this._query(d,m,w,T,!1,P)}hitTest(d,m,w,T,P){return this._query(d,m,w,T,!0,P)}hitTestCircle(d,m,w,T){return this._queryCircle(d,m,w,!0,T)}_queryCell(d,m,w,T,P,D,z,U){const K=z.seenUids,X=this.boxCells[P];if(X!==null){const le=this.bboxes;for(const he of X)if(!K.box[he]){K.box[he]=!0;const pe=4*he;if(d<=le[pe+2]&&m<=le[pe+3]&&w>=le[pe+0]&&T>=le[pe+1]&&(!U||U(this.boxKeys[he]))){if(z.hitTest)return D.push(!0),!0;D.push({key:this.boxKeys[he],x1:le[pe],y1:le[pe+1],x2:le[pe+2],y2:le[pe+3]})}}}const Q=this.circleCells[P];if(Q!==null){const le=this.circles;for(const he of Q)if(!K.circle[he]){K.circle[he]=!0;const pe=3*he;if(this._circleAndRectCollide(le[pe],le[pe+1],le[pe+2],d,m,w,T)&&(!U||U(this.circleKeys[he]))){if(z.hitTest)return D.push(!0),!0;{const fe=le[pe],ge=le[pe+1],ee=le[pe+2];D.push({key:this.circleKeys[he],x1:fe-ee,y1:ge-ee,x2:fe+ee,y2:ge+ee})}}}}}_queryCellCircle(d,m,w,T,P,D,z,U){const K=z.circle,X=z.seenUids,Q=this.boxCells[P];if(Q!==null){const he=this.bboxes;for(const pe of Q)if(!X.box[pe]){X.box[pe]=!0;const fe=4*pe;if(this._circleAndRectCollide(K.x,K.y,K.radius,he[fe+0],he[fe+1],he[fe+2],he[fe+3])&&(!U||U(this.boxKeys[pe])))return D.push(!0),!0}}const le=this.circleCells[P];if(le!==null){const he=this.circles;for(const pe of le)if(!X.circle[pe]){X.circle[pe]=!0;const fe=3*pe;if(this._circlesCollide(he[fe],he[fe+1],he[fe+2],K.x,K.y,K.radius)&&(!U||U(this.circleKeys[pe])))return D.push(!0),!0}}}_forEachCell(d,m,w,T,P,D,z,U){const K=this._convertToXCellCoord(d),X=this._convertToYCellCoord(m),Q=this._convertToXCellCoord(w),le=this._convertToYCellCoord(T);for(let he=K;he<=Q;he++)for(let pe=X;pe<=le;pe++)if(P.call(this,d,m,w,T,this.xCellCount*pe+he,D,z,U))return}_convertToXCellCoord(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))}_convertToYCellCoord(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))}_circlesCollide(d,m,w,T,P,D){const z=T-d,U=P-m,K=w+D;return K*K>z*z+U*U}_circleAndRectCollide(d,m,w,T,P,D,z){const U=(D-T)/2,K=Math.abs(d-(T+U));if(K>U+w)return!1;const X=(z-P)/2,Q=Math.abs(m-(P+X));if(Q>X+w)return!1;if(K<=U||Q<=X)return!0;const le=K-U,he=Q-X;return le*le+he*he<=w*w}}const Eo={unknown:0,flipRequired:1,flipNotRequired:2},Bd=Math.tan(85*Math.PI/180);function ot(v,d,m,w,T,P,D){const z=s.create();if(m)if(P.name==="globe"){const U=s.calculateGlobeLabelMatrix(T,d);s.multiply(z,z,U)}else{const U=W([],D);z[0]=U[0],z[1]=U[1],z[4]=U[2],z[5]=U[3],w||s.rotateZ(z,z,T.angle)}else s.multiply(z,T.labelPlaneMatrix,v);return z}function To(v,d,m,w,T,P,D){const z=ot(v,d,m,w,T,P,D);return P.name==="globe"&&m||(z[2]=z[6]=z[10]=z[14]=0),z}function Jn(v,d,m,w,T,P,D){if(m){if(P.name==="globe"){const z=ot(v,d,m,w,T,P,D);return s.invert(z,z),s.multiply(z,v,z),z}{const z=s.clone(v),U=s.identity([]);return U[0]=D[0],U[1]=D[1],U[4]=D[2],U[5]=D[3],s.multiply(z,z,U),w||s.rotateZ(z,z,-T.angle),z}}return T.glCoordMatrix}function bi(v,d,m,w){const T=[v,d,m,1];m?s.transformMat4$1(T,T,w):Tr(T,T,w);const P=T[3];return T[0]/=P,T[1]/=P,T[2]/=P,T}function ub(v,d){return Math.min(.5+v/d*.5,1.5)}function Wa(v,d){const m=v[0]/v[3],w=v[1]/v[3];return m>=-d[0]&&m<=d[0]&&w>=-d[1]&&w<=d[1]}function Fg(v,d,m,w,T,P,D,z,U,K){const X=m.transform,Q=w?v.textSizeData:v.iconSizeData,le=s.evaluateSizeForZoom(Q,m.transform.zoom),he=X.projection.name==="globe",pe=[256/m.width*2+1,256/m.height*2+1],fe=w?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;fe.clear();let ge=null;he&&(ge=w?v.text.globeExtVertexArray:v.icon.globeExtVertexArray);const ee=v.lineVertexArray,de=w?v.text.placedSymbolArray:v.icon.placedSymbolArray,we=m.transform.width/m.transform.height;let Se,Re=!1;for(let Le=0;Le<de.length;Le++){const De=de.get(Le),{numGlyphs:Ue,writingMode:Fe}=De;if(Fe!==s.WritingMode.vertical||Re||Se===s.WritingMode.horizontal||(Re=!0),Se=Fe,(De.hidden||Fe===s.WritingMode.vertical)&&!Re){ba(Ue,fe);continue}Re=!1;const Ze=new s.Point(De.tileAnchorX,De.tileAnchorY);let{x:wt,y:He,z:ht}=X.projection.projectTilePoint(Ze.x,Ze.y,K.canonical);if(U){const[lr,Wt,sr]=U(Ze);wt+=lr,He+=Wt,ht+=sr}const Je=[wt,He,ht,1];if(s.transformMat4$1(Je,Je,d),!Wa(Je,pe)){ba(Ue,fe);continue}const _t=ub(m.transform.cameraToCenterDistance,Je[3]),Ke=s.evaluateSizeForFeature(Q,le,De),dt=D?Ke/_t:Ke*_t,Et=bi(wt,He,ht,T);if(Et[3]<=0){ba(Ue,fe);continue}let yt={};const jt=D?null:U,Jt=$t(De,dt,!1,z,d,T,P,v.glyphOffsetArray,ee,fe,ge,Et,Ze,yt,we,jt,X.projection,K,D);Re=Jt.useVertical,jt&&Jt.needsFlipping&&(yt={}),(Jt.notEnoughRoom||Re||Jt.needsFlipping&&$t(De,dt,!0,z,d,T,P,v.glyphOffsetArray,ee,fe,ge,Et,Ze,yt,we,jt,X.projection,K,D).notEnoughRoom)&&ba(Ue,fe)}w?(v.text.dynamicLayoutVertexBuffer.updateData(fe),ge&&v.text.globeExtVertexBuffer.updateData(ge)):(v.icon.dynamicLayoutVertexBuffer.updateData(fe),ge&&v.icon.globeExtVertexBuffer.updateData(ge))}function db(v,d,m,w,T,P,D,z,U,K,X,Q,le,he,pe,fe){const{lineStartIndex:ge,glyphStartIndex:ee,segment:de}=z,we=ee+z.numGlyphs,Se=ge+z.lineLength,Re=d.getoffsetX(ee),Le=d.getoffsetX(we-1),De=Rs(v*Re,m,w,T,P,D,de,ge,Se,U,K,X,Q,le,!0,he,pe,fe);if(!De)return null;const Ue=Rs(v*Le,m,w,T,P,D,de,ge,Se,U,K,X,Q,le,!0,he,pe,fe);return Ue?{first:De,last:Ue}:null}function iu(v,d,m,w){return v===s.WritingMode.horizontal&&Math.abs(w)>Math.abs(m)?{useVertical:!0}:v===s.WritingMode.vertical?w>0?{needsFlipping:!0}:null:d!==Eo.unknown&&function(T,P){return T===0||Math.abs(P/T)>Bd}(m,w)?d===Eo.flipRequired?{needsFlipping:!0}:null:m<0?{needsFlipping:!0}:null}function $t(v,d,m,w,T,P,D,z,U,K,X,Q,le,he,pe,fe,ge,ee,de){const we=d/24,Se=v.lineOffsetX*we,Re=v.lineOffsetY*we,{lineStartIndex:Le,glyphStartIndex:De,numGlyphs:Ue,segment:Fe,writingMode:Ze,flipState:wt}=v,He=Le+v.lineLength,ht=Je=>{if(X){const[Et,yt,jt]=Je.up,Jt=K.length;s.updateGlobeVertexNormal(X,Jt+0,Et,yt,jt),s.updateGlobeVertexNormal(X,Jt+1,Et,yt,jt),s.updateGlobeVertexNormal(X,Jt+2,Et,yt,jt),s.updateGlobeVertexNormal(X,Jt+3,Et,yt,jt)}const[_t,Ke,dt]=Je.point;s.addDynamicAttributes(K,_t,Ke,dt,Je.angle)};if(Ue>1){const Je=db(we,z,Se,Re,m,Q,le,v,U,P,he,fe,!1,ge,ee,de);if(!Je)return{notEnoughRoom:!0};if(w&&!m){let[_t,Ke,dt]=Je.first.point,[Et,yt,jt]=Je.last.point;[_t,Ke]=bi(_t,Ke,dt,D),[Et,yt]=bi(Et,yt,jt,D);const Jt=iu(Ze,wt,(Et-_t)*pe,yt-Ke);if(v.flipState=Jt&&Jt.needsFlipping?Eo.flipRequired:Eo.flipNotRequired,Jt)return Jt}ht(Je.first);for(let _t=De+1;_t<De+Ue-1;_t++){const Ke=Rs(we*z.getoffsetX(_t),Se,Re,m,Q,le,Fe,Le,He,U,P,he,fe,!1,!1,ge,ee,de);if(!Ke)return K.length-=4*(_t-De),{notEnoughRoom:!0};ht(Ke)}ht(Je.last)}else{if(w&&!m){const _t=bi(le.x,le.y,0,T),Ke=Le+Fe+1,dt=new s.Point(U.getx(Ke),U.gety(Ke)),Et=bi(dt.x,dt.y,0,T),yt=Et[3]>0?Et:Er(le,dt,_t,1,T,void 0,ge,ee.canonical),jt=iu(Ze,wt,(yt[0]-_t[0])*pe,yt[1]-_t[1]);if(v.flipState=jt&&jt.needsFlipping?Eo.flipRequired:Eo.flipNotRequired,jt)return jt}const Je=Rs(we*z.getoffsetX(De),Se,Re,m,Q,le,Fe,Le,He,U,P,he,fe,!1,!1,ge,ee,de);if(!Je)return{notEnoughRoom:!0};ht(Je)}return{}}function Cr(v,d,m,w,T){const{x:P,y:D,z}=w.projectTilePoint(v.x,v.y,d);if(!T)return bi(P,D,z,m);const[U,K,X]=T(v);return bi(P+U,D+K,z+X,m)}function Er(v,d,m,w,T,P,D,z){const U=Cr(v.sub(d)._unit()._add(v),z,T,D,P);return s.sub(U,m,U),s.normalize(U,U),s.scaleAndAdd(U,m,U,w)}function Rs(v,d,m,w,T,P,D,z,U,K,X,Q,le,he,pe,fe,ge,ee){const de=w?v-d:v+d;let we=de>0?1:-1,Se=0;w&&(we*=-1,Se=Math.PI),we<0&&(Se+=Math.PI);let Re=z+D+(we>0?0:1)|0,Le=T,De=T,Ue=0,Fe=0;const Ze=Math.abs(de),wt=[],He=[];let ht=P,Je=ht;const _t=()=>Er(Je,ht,De,Ze-Ue+1,X,le,fe,ge.canonical);for(;Ue+Fe<=Ze;){if(Re+=we,Re<z||Re>=U)return null;if(De=Le,Je=ht,wt.push(De),he&&He.push(Je),ht=new s.Point(K.getx(Re),K.gety(Re)),Le=Q[Re],!Le){const sr=Cr(ht,ge.canonical,X,fe,le);Le=sr[3]>0?Q[Re]=sr:_t()}Ue+=Fe,Fe=s.distance(De,Le)}pe&&le&&(Q[Re]&&(Le=_t(),Fe=s.distance(De,Le)),Q[Re]=Le);const Ke=(Ze-Ue)/Fe,dt=ht.sub(Je)._mult(Ke)._add(Je),Et=s.sub([],Le,De),yt=s.scaleAndAdd([],De,Et,Ke);let jt=[0,0,1],Jt=Et[0],lr=Et[1];if(ee&&(jt=fe.upVector(ge.canonical,dt.x,dt.y),jt[0]!==0||jt[1]!==0||jt[2]!==1)){const sr=[jt[2],0,-jt[0]],jr=s.cross([],jt,sr);s.normalize(sr,sr),s.normalize(jr,jr),Jt=s.dot(Et,sr),lr=s.dot(Et,jr)}if(m){const sr=s.cross([],jt,Et);s.normalize(sr,sr),s.scaleAndAdd(yt,yt,sr,m*we)}const Wt=Se+Math.atan2(lr,Jt);return wt.push(yt),he&&He.push(dt),{point:yt,angle:Wt,path:wt,tilePath:He,up:jt}}function ba(v,d){const m=d.length,w=m+4*v;d.resize(w),d.float32.fill(-1/0,4*m,4*w)}function Tr(v,d,m){const w=d[0],T=d[1];return v[0]=m[0]*w+m[4]*T+m[12],v[1]=m[1]*w+m[5]*T+m[13],v[3]=m[3]*w+m[7]*T+m[15],v}const Ds=100;class zd{constructor(d,m,w=new Yl(d.width+200,d.height+200,25),T=new Yl(d.width+200,d.height+200,25)){this.transform=d,this.grid=w,this.ignoredGrid=T,this.pitchfactor=Math.cos(d._pitch)*d.cameraToCenterDistance,this.screenRightBoundary=d.width+Ds,this.screenBottomBoundary=d.height+Ds,this.gridRightBoundary=d.width+200,this.gridBottomBoundary=d.height+200,this.fogState=m}placeCollisionBox(d,m,w,T,P,D,z,U){let K=w.projectedAnchorX,X=w.projectedAnchorY,Q=w.projectedAnchorZ;const le=w.elevation,he=w.tileID,pe=d.getProjection();if(le&&he){const[Le,De,Ue]=pe.upVector(he.canonical,w.tileAnchorX,w.tileAnchorY),Fe=pe.upVectorScale(he.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;K+=Le*le*Fe,X+=De*le*Fe,Q+=Ue*le*Fe}const fe=this.projectAndGetPerspectiveRatio(z,K,X,Q,w.tileID,pe.name==="globe"||!!le||this.transform.pitch>0,pe),ge=D*fe.perspectiveRatio,ee=(w.x1*m+T.x-w.padding)*ge+fe.point.x,de=(w.y1*m+T.y-w.padding)*ge+fe.point.y,we=(w.x2*m+T.x+w.padding)*ge+fe.point.x,Se=(w.y2*m+T.y+w.padding)*ge+fe.point.y,Re=fe.perspectiveRatio<=.55||fe.occluded;return!this.isInsideGrid(ee,de,we,Se)||!P&&this.grid.hitTest(ee,de,we,Se,U)||Re?{box:[],offscreen:!1,occluded:fe.occluded}:{box:[ee,de,we,Se],offscreen:this.isOffscreen(ee,de,we,Se),occluded:!1}}placeCollisionCircles(d,m,w,T,P,D,z,U,K,X,Q,le,he,pe,fe){const ge=[],ee=this.transform.elevation,de=d.getProjection(),we=ee?ee.getAtTileOffsetFunc(fe,this.transform.center.lat,this.transform.worldSize,de):null,Se=new s.Point(w.tileAnchorX,w.tileAnchorY);let{x:Re,y:Le,z:De}=de.projectTilePoint(Se.x,Se.y,fe.canonical);if(we){const[dt,Et,yt]=we(Se);Re+=dt,Le+=Et,De+=yt}const Ue=de.name==="globe",Fe=this.projectAndGetPerspectiveRatio(z,Re,Le,De,fe,Ue||!!ee||this.transform.pitch>0,de),{perspectiveRatio:Ze}=Fe,wt=(Q?D/Ze:D*Ze)/s.ONE_EM,He=bi(Re,Le,De,U),ht=Fe.signedDistanceFromCamera>0?db(wt,P,w.lineOffsetX*wt,w.lineOffsetY*wt,!1,He,Se,w,T,U,{},ee&&!Q?we:null,Q&&!!ee,de,fe,Q):null;let Je=!1,_t=!1,Ke=!0;if(ht&&!Fe.occluded){const dt=.5*he*Ze+pe,Et=new s.Point(-100,-100),yt=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),jt=new $g,{first:Jt,last:lr}=ht,Wt=Jt.path.length;let sr=[];for(let Yt=Wt-1;Yt>=1;Yt--)sr.push(Jt.path[Yt]);for(let Yt=1;Yt<lr.path.length;Yt++)sr.push(lr.path[Yt]);const jr=2.5*dt;K&&(sr=sr.map(([Yt,Xr,rn],nn)=>(we&&!Ue&&(rn=we(nn<Wt-1?Jt.tilePath[Wt-1-nn]:lr.tilePath[nn-Wt+2])[2]),bi(Yt,Xr,rn,K))),sr.some(Yt=>Yt[3]<=0)&&(sr=[]));let wr=[];if(sr.length>0){let Yt=1/0,Xr=-1/0,rn=1/0,nn=-1/0;for(const sn of sr)Yt=Math.min(Yt,sn[0]),rn=Math.min(rn,sn[1]),Xr=Math.max(Xr,sn[0]),nn=Math.max(nn,sn[1]);Xr>=Et.x&&Yt<=yt.x&&nn>=Et.y&&rn<=yt.y&&(wr=[sr.map(sn=>new s.Point(sn[0],sn[1]))],(Yt<Et.x||Xr>yt.x||rn<Et.y||nn>yt.y)&&(wr=s.clipLine(wr,Et.x,Et.y,yt.x,yt.y)))}for(const Yt of wr){jt.reset(Yt,.25*dt);let Xr=0;Xr=jt.length<=.5*dt?1:Math.ceil(jt.paddedLength/jr)+1;for(let rn=0;rn<Xr;rn++){const nn=rn/Math.max(Xr-1,1),sn=jt.lerp(nn),Xi=sn.x+Ds,wi=sn.y+Ds;ge.push(Xi,wi,dt,0);const ta=Xi-dt,Ka=wi-dt,jn=Xi+dt,an=wi+dt;if(Ke=Ke&&this.isOffscreen(ta,Ka,jn,an),_t=_t||this.isInsideGrid(ta,Ka,jn,an),!m&&this.grid.hitTestCircle(Xi,wi,dt,le)&&(Je=!0,!X))return{circles:[],offscreen:!1,collisionDetected:Je,occluded:!1}}}}return{circles:!X&&Je||!_t?[]:ge,offscreen:Ke,collisionDetected:Je,occluded:Fe.occluded}}queryRenderedSymbols(d){if(d.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[];let w=1/0,T=1/0,P=-1/0,D=-1/0;for(const X of d){const Q=new s.Point(X.x+Ds,X.y+Ds);w=Math.min(w,Q.x),T=Math.min(T,Q.y),P=Math.max(P,Q.x),D=Math.max(D,Q.y),m.push(Q)}const z=this.grid.query(w,T,P,D).concat(this.ignoredGrid.query(w,T,P,D)),U={},K={};for(const X of z){const Q=X.key;if(U[Q.bucketInstanceId]===void 0&&(U[Q.bucketInstanceId]={}),U[Q.bucketInstanceId][Q.featureIndex])continue;const le=[new s.Point(X.x1,X.y1),new s.Point(X.x2,X.y1),new s.Point(X.x2,X.y2),new s.Point(X.x1,X.y2)];s.polygonIntersectsPolygon(m,le)&&(U[Q.bucketInstanceId][Q.featureIndex]=!0,K[Q.bucketInstanceId]===void 0&&(K[Q.bucketInstanceId]=[]),K[Q.bucketInstanceId].push(Q.featureIndex))}return K}insertCollisionBox(d,m,w,T,P){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:w,featureIndex:T,collisionGroupID:P},d[0],d[1],d[2],d[3])}insertCollisionCircles(d,m,w,T,P){const D=m?this.ignoredGrid:this.grid,z={bucketInstanceId:w,featureIndex:T,collisionGroupID:P};for(let U=0;U<d.length;U+=4)D.insertCircle(z,d[U],d[U+1],d[U+2])}projectAndGetPerspectiveRatio(d,m,w,T,P,D,z){const U=[m,w,T,1];let K=!1;T||this.transform.pitch>0?(s.transformMat4$1(U,U,d),this.fogState&&P&&z.name!=="globe"&&(K=function(le,he,pe,fe,ge,ee){const de=ee.calculateFogTileMatrix(ge),we=[he,pe,fe];return s.transformMat4(we,we,de),be(le,we,ee.pitch,ee._fov)}(this.fogState,m,w,T,P.toUnwrapped(),this.transform)>.9)):Tr(U,U,d);const X=U[3];return{point:new s.Point((U[0]/X+1)/2*this.transform.width+Ds,(-U[1]/X+1)/2*this.transform.height+Ds),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(z)/X*.5,1.5),signedDistanceFromCamera:X,occluded:D&&U[2]>X||K}}isOffscreen(d,m,w,T){return w<Ds||d>=this.screenRightBoundary||T<Ds||m>this.screenBottomBoundary}isInsideGrid(d,m,w,T){return w>=0&&d<this.gridRightBoundary&&T>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const d=s.identity([]);return s.translate(d,d,[-100,-100,0]),d}}function Jl(v,d,m){const w=d.createTileMatrix(v,v.worldSize,m.toUnwrapped());return s.multiply(new Float32Array(16),v.projMatrix,w)}function Ys(v,d,m){if(d.projection.name===m.projection.name)return v.projMatrix;const w=m.clone();return w.setProjection(d.projection),Jl(w,d.getProjection(),v)}function Tn(v,d,m){return d.name===m.projection.name?v.projMatrix:Jl(m,d,v)}class hb{constructor(d,m,w,T){this.opacity=d?Math.max(0,Math.min(1,d.opacity+(d.placed?m:-m))):T&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class jo{constructor(d,m,w,T,P,D=!1){this.text=new hb(d?d.text:null,m,w,P),this.icon=new hb(d?d.icon:null,m,T,P),this.clipped=D}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class $d{constructor(d,m,w,T=!1){this.text=d,this.icon=m,this.skipFade=w,this.clipped=T}}class Fd{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Ug{constructor(d,m,w,T,P){this.bucketInstanceId=d,this.featureIndex=m,this.sourceLayerIndex=w,this.bucketIndex=T,this.tileID=P}}class fb{constructor(d){this.crossSourceCollisions=d,this.maxGroupID=0,this.collisionGroups={}}get(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){const m=++this.maxGroupID;this.collisionGroups[d]={ID:m,predicate:w=>w.collisionGroupID===m}}return this.collisionGroups[d]}}function Ud(v,d,m,w,T){const{horizontalAlign:P,verticalAlign:D}=s.getAnchorAlignment(v),z=-(P-.5)*d,U=-(D-.5)*m,K=s.evaluateVariableOffset(v,w);return new s.Point(z+K[0]*T,U+K[1]*T)}function Vd(v,d,m,w,T){const P=new s.Point(v,d);return m&&P._rotate(w?T:-T),P}class Mf{constructor(d,m,w,T,P){this.transform=d.clone(),this.projection=d.projection.name,this.collisionIndex=new zd(this.transform,P),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new fb(w),this.collisionCircleArrays={},this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(d,m,w,T){const P=w.getBucket(m),D=w.latestFeatureIndex;if(!P||!D||m.id!==P.layerIds[0])return;const z=P.layers[0].layout,U=w.collisionBoxArray,K=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),X=w.tileSize/s.EXTENT,Q=w.tileID.toUnwrapped();this.transform.setProjection(P.projection);const le=(he=w.tileID,pe=P.getProjection(),fe=this.transform,pe.name===this.projection?fe.calculateProjMatrix(he.toUnwrapped()):Jl(fe,pe,he));var he,pe,fe;const ge=z.get("text-pitch-alignment")==="map",ee=z.get("text-rotation-alignment")==="map";m.compileFilter();const de=m.dynamicFilter(),we=m.dynamicFilterNeedsFeature(),Se=this.transform.calculatePixelsToTileUnitsMatrix(w),Re=To(le,w.tileID.canonical,ge,ee,this.transform,P.getProjection(),Se);let Le=null;if(ge){const Fe=Jn(le,w.tileID.canonical,ge,ee,this.transform,P.getProjection(),Se);Le=s.multiply([],this.transform.labelPlaneMatrix,Fe)}let De=null;de&&w.latestFeatureIndex&&(De={unwrappedTileID:Q,dynamicFilter:de,dynamicFilterNeedsFeature:we,featureIndex:w.latestFeatureIndex}),this.retainedQueryData[P.bucketInstanceId]=new Ug(P.bucketInstanceId,D,P.sourceLayerIndex,P.index,w.tileID);const Ue={bucket:P,layout:z,posMatrix:le,textLabelPlaneMatrix:Re,labelToScreenMatrix:Le,clippingData:De,scale:K,textPixelRatio:X,holdingForFade:w.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(P.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(P.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(T)for(const Fe of P.sortKeyRanges){const{sortKey:Ze,symbolInstanceStart:wt,symbolInstanceEnd:He}=Fe;d.push({sortKey:Ze,symbolInstanceStart:wt,symbolInstanceEnd:He,parameters:Ue})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:Ue})}attemptAnchorPlacement(d,m,w,T,P,D,z,U,K,X,Q,le,he,pe,fe,ge,ee,de){const{textOffset0:we,textOffset1:Se,crossTileID:Re}=le,Le=[we,Se],De=Ud(d,w,T,Le,P),Ue=this.collisionIndex.placeCollisionBox(pe,P,m,Vd(De.x,De.y,D,z,this.transform.angle),Q,U,K,X.predicate);if(ge){const Fe=pe.getSymbolInstanceIconSize(de,this.transform.zoom,le.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(pe,Fe,ge,Vd(De.x,De.y,D,z,this.transform.angle),Q,U,K,X.predicate).box.length===0)return}if(Ue.box.length>0){let Fe;return this.prevPlacement&&this.prevPlacement.variableOffsets[Re]&&this.prevPlacement.placements[Re]&&this.prevPlacement.placements[Re].text&&(Fe=this.prevPlacement.variableOffsets[Re].anchor),this.variableOffsets[Re]={textOffset:Le,width:w,height:T,anchor:d,textScale:P,prevAnchor:Fe},this.markUsedJustification(pe,d,le,fe),pe.allowVerticalPlacement&&(this.markUsedOrientation(pe,fe,le),this.placedOrientations[Re]=fe),{shift:De,placedGlyphBoxes:Ue}}}placeLayerBucketPart(d,m,w,T){const{bucket:P,layout:D,posMatrix:z,textLabelPlaneMatrix:U,labelToScreenMatrix:K,clippingData:X,textPixelRatio:Q,holdingForFade:le,collisionBoxArray:he,partiallyEvaluatedTextSize:pe,partiallyEvaluatedIconSize:fe,collisionGroup:ge}=d.parameters,ee=D.get("text-optional"),de=D.get("icon-optional"),we=D.get("text-allow-overlap"),Se=D.get("icon-allow-overlap"),Re=D.get("text-rotation-alignment")==="map",Le=D.get("text-pitch-alignment")==="map",De=D.get("icon-text-fit")!=="none",Ue=D.get("symbol-z-order")==="viewport-y";this.transform.setProjection(P.projection);let Fe=we&&(Se||!P.hasIconData()||de),Ze=Se&&(we||!P.hasTextData()||ee);!P.collisionArrays&&he&&P.deserializeCollisionBoxes(he),w&&T&&P.updateCollisionDebugBuffers(this.transform.zoom,he);const wt=(He,ht,Je)=>{const{crossTileID:_t,numVerticalGlyphVertices:Ke}=He;if(X){const jn={zoom:this.transform.zoom,pitch:this.transform.pitch};let an=null;if(X.dynamicFilterNeedsFeature){const $r=this.retainedQueryData[P.bucketInstanceId];an=X.featureIndex.loadFeature({featureIndex:He.featureIndex,bucketIndex:$r.bucketIndex,sourceLayerIndex:$r.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,X.dynamicFilter)(jn,an,this.retainedQueryData[P.bucketInstanceId].tileID.canonical,new s.Point(He.tileAnchorX,He.tileAnchorY),this.transform.calculateDistanceTileData(X.unwrappedTileID)))return this.placements[_t]=new $d(!1,!1,!1,!0),void m.add(_t)}if(m.has(_t))return;if(le)return void(this.placements[_t]=new $d(!1,!1,!1));let dt=!1,Et=!1,yt=!0,jt=!1,Jt=!1,lr=null,Wt={box:null,offscreen:null,occluded:null},sr={box:null,offscreen:null,occluded:null},jr=null,wr=null,Yt=null,Xr=0,rn=0,nn=0;Je.textFeatureIndex?Xr=Je.textFeatureIndex:He.useRuntimeCollisionCircles&&(Xr=He.featureIndex),Je.verticalTextFeatureIndex&&(rn=Je.verticalTextFeatureIndex);const sn=jn=>{jn.tileID=this.retainedQueryData[P.bucketInstanceId].tileID;const an=this.transform.elevation;(an||jn.elevation)&&(jn.elevation=an?an.getAtTileOffset(jn.tileID,jn.tileAnchorX,jn.tileAnchorY):0)},Xi=Je.textBox;if(Xi){sn(Xi);const jn=$r=>{let Qn=s.WritingMode.horizontal;if(P.allowVerticalPlacement&&!$r&&this.prevPlacement){const ss=this.prevPlacement.placedOrientations[_t];ss&&(this.placedOrientations[_t]=ss,Qn=ss,this.markUsedOrientation(P,Qn,He))}return Qn},an=($r,Qn)=>{if(P.allowVerticalPlacement&&Ke>0&&Je.verticalTextBox){for(const ss of P.writingModes)if(ss===s.WritingMode.vertical?(Wt=Qn(),sr=Wt):Wt=$r(),Wt&&Wt.box&&Wt.box.length)break}else Wt=$r()};if(D.get("text-variable-anchor")){let $r=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[_t]){const xn=this.prevPlacement.variableOffsets[_t];$r.indexOf(xn.anchor)>0&&($r=$r.filter(vs=>vs!==xn.anchor),$r.unshift(xn.anchor))}const Qn=(xn,vs,sp)=>{const ac=P.getSymbolInstanceTextSize(pe,He,this.transform.zoom,ht),ch=(xn.x2-xn.x1)*ac+2*xn.padding,Io=(xn.y2-xn.y1)*ac+2*xn.padding,bl=De&&!Se?vs:null;bl&&sn(bl);let oc={box:[],offscreen:!1,occluded:!1};const ap=we?2*$r.length:$r.length;for(let uh=0;uh<ap;++uh){const My=this.attemptAnchorPlacement($r[uh%$r.length],xn,ch,Io,ac,Re,Le,Q,z,ge,uh>=$r.length,He,ht,P,sp,bl,pe,fe);if(My&&(oc=My.placedGlyphBoxes,oc&&oc.box&&oc.box.length)){dt=!0,lr=My.shift;break}}return oc};an(()=>Qn(Xi,Je.iconBox,s.WritingMode.horizontal),()=>{const xn=Je.verticalTextBox;return xn&&sn(xn),P.allowVerticalPlacement&&!(Wt&&Wt.box&&Wt.box.length)&&Ke>0&&xn?Qn(xn,Je.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Wt&&(dt=Wt.box,yt=Wt.offscreen,jt=Wt.occluded);const ss=jn(!(!Wt||!Wt.box));if(!dt&&this.prevPlacement){const xn=this.prevPlacement.variableOffsets[_t];xn&&(this.variableOffsets[_t]=xn,this.markUsedJustification(P,xn.anchor,He,ss))}}else{const $r=(Qn,ss)=>{const xn=P.getSymbolInstanceTextSize(pe,He,this.transform.zoom,ht),vs=this.collisionIndex.placeCollisionBox(P,xn,Qn,new s.Point(0,0),we,Q,z,ge.predicate);return vs&&vs.box&&vs.box.length&&(this.markUsedOrientation(P,ss,He),this.placedOrientations[_t]=ss),vs};an(()=>$r(Xi,s.WritingMode.horizontal),()=>{const Qn=Je.verticalTextBox;return P.allowVerticalPlacement&&Ke>0&&Qn?(sn(Qn),$r(Qn,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),jn(!!(Wt&&Wt.box&&Wt.box.length))}}if(jr=Wt,dt=jr&&jr.box&&jr.box.length>0,yt=jr&&jr.offscreen,jt=jr&&jr.occluded,He.useRuntimeCollisionCircles){const jn=P.text.placedSymbolArray.get(He.centerJustifiedTextSymbolIndex>=0?He.centerJustifiedTextSymbolIndex:He.verticalPlacedTextSymbolIndex),an=s.evaluateSizeForFeature(P.textSizeData,pe,jn),$r=D.get("text-padding");wr=this.collisionIndex.placeCollisionCircles(P,we,jn,P.lineVertexArray,P.glyphOffsetArray,an,z,U,K,w,Le,ge.predicate,He.collisionCircleDiameter*an/s.ONE_EM,$r,this.retainedQueryData[P.bucketInstanceId].tileID),dt=we||wr.circles.length>0&&!wr.collisionDetected,yt=yt&&wr.offscreen,jt=wr.occluded}if(Je.iconFeatureIndex&&(nn=Je.iconFeatureIndex),Je.iconBox){const jn=an=>{sn(an);const $r=De&&lr?Vd(lr.x,lr.y,Re,Le,this.transform.angle):new s.Point(0,0),Qn=P.getSymbolInstanceIconSize(fe,this.transform.zoom,He.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(P,Qn,an,$r,Se,Q,z,ge.predicate)};sr&&sr.box&&sr.box.length&&Je.verticalIconBox?(Yt=jn(Je.verticalIconBox),Et=Yt.box.length>0):(Yt=jn(Je.iconBox),Et=Yt.box.length>0),yt=yt&&Yt.offscreen,Jt=Yt.occluded}const wi=ee||He.numHorizontalGlyphVertices===0&&Ke===0,ta=de||He.numIconVertices===0;if(wi||ta?ta?wi||(Et=Et&&dt):dt=Et&&dt:Et=dt=Et&&dt,dt&&jr&&jr.box&&this.collisionIndex.insertCollisionBox(jr.box,D.get("text-ignore-placement"),P.bucketInstanceId,sr&&sr.box&&rn?rn:Xr,ge.ID),Et&&Yt&&this.collisionIndex.insertCollisionBox(Yt.box,D.get("icon-ignore-placement"),P.bucketInstanceId,nn,ge.ID),wr&&(dt&&this.collisionIndex.insertCollisionCircles(wr.circles,D.get("text-ignore-placement"),P.bucketInstanceId,Xr,ge.ID),w)){const jn=P.bucketInstanceId;let an=this.collisionCircleArrays[jn];an===void 0&&(an=this.collisionCircleArrays[jn]=new Fd);for(let $r=0;$r<wr.circles.length;$r+=4)an.circles.push(wr.circles[$r+0]),an.circles.push(wr.circles[$r+1]),an.circles.push(wr.circles[$r+2]),an.circles.push(wr.collisionDetected?1:0)}const Ka=P.projection.name!=="globe";Fe=Fe&&(Ka||!jt),Ze=Ze&&(Ka||!Jt),this.placements[_t]=new $d(dt||Fe,Et||Ze,yt||P.justReloaded),m.add(_t)};if(Ue){const He=P.getSortedSymbolIndexes(this.transform.angle);for(let ht=He.length-1;ht>=0;--ht){const Je=He[ht];wt(P.symbolInstances.get(Je),Je,P.collisionArrays[Je])}}else for(let He=d.symbolInstanceStart;He<d.symbolInstanceEnd;He++)wt(P.symbolInstances.get(He),He,P.collisionArrays[He]);if(w&&P.bucketInstanceId in this.collisionCircleArrays){const He=this.collisionCircleArrays[P.bucketInstanceId];s.invert(He.invProjMatrix,z),He.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1}markUsedJustification(d,m,w,T){const{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:U,crossTileID:K}=w,X=s.getAnchorJustification(m),Q=T===s.WritingMode.vertical?U:X==="left"?P:X==="center"?D:X==="right"?z:-1;P>=0&&(d.text.placedSymbolArray.get(P).crossTileID=Q>=0&&P!==Q?0:K),D>=0&&(d.text.placedSymbolArray.get(D).crossTileID=Q>=0&&D!==Q?0:K),z>=0&&(d.text.placedSymbolArray.get(z).crossTileID=Q>=0&&z!==Q?0:K),U>=0&&(d.text.placedSymbolArray.get(U).crossTileID=Q>=0&&U!==Q?0:K)}markUsedOrientation(d,m,w){const T=m===s.WritingMode.horizontal||m===s.WritingMode.horizontalOnly?m:0,P=m===s.WritingMode.vertical?m:0,{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:z,rightJustifiedTextSymbolIndex:U,verticalPlacedTextSymbolIndex:K}=w,X=d.text.placedSymbolArray;D>=0&&(X.get(D).placedOrientation=T),z>=0&&(X.get(z).placedOrientation=T),U>=0&&(X.get(U).placedOrientation=T),K>=0&&(X.get(K).placedOrientation=P)}commit(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let w=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const T=m?m.symbolFadeChange(d):1,P=m?m.opacities:{},D=m?m.variableOffsets:{},z=m?m.placedOrientations:{};for(const U in this.placements){const K=this.placements[U],X=P[U];X?(this.opacities[U]=new jo(X,T,K.text,K.icon,null,K.clipped),w=w||K.text!==X.text.placed||K.icon!==X.icon.placed):(this.opacities[U]=new jo(null,T,K.text,K.icon,K.skipFade,K.clipped),w=w||K.text||K.icon)}for(const U in P){const K=P[U];if(!this.opacities[U]){const X=new jo(K,T,!1,!1);X.isHidden()||(this.opacities[U]=X,w=w||K.text.placed||K.icon.placed)}}for(const U in D)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=D[U]);for(const U in z)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=z[U]);w?this.lastPlacementChangeTime=d:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:d)}updateLayerOpacities(d,m){const w=new Set;for(const T of m){const P=T.getBucket(d);P&&T.latestFeatureIndex&&d.id===P.layerIds[0]&&this.updateBucketOpacities(P,w,T.collisionBoxArray)}}updateBucketOpacities(d,m,w){d.hasTextData()&&d.text.opacityVertexArray.clear(),d.hasIconData()&&d.icon.opacityVertexArray.clear(),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();const T=d.layers[0].layout,P=!!d.layers[0].dynamicFilter(),D=new jo(null,0,!1,!1,!0),z=T.get("text-allow-overlap"),U=T.get("icon-allow-overlap"),K=T.get("text-variable-anchor"),X=T.get("text-rotation-alignment")==="map",Q=T.get("text-pitch-alignment")==="map",le=T.get("icon-text-fit")!=="none",he=new jo(null,0,z&&(U||!d.hasIconData()||T.get("icon-optional")),U&&(z||!d.hasTextData()||T.get("text-optional")),!0);!d.collisionArrays&&w&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(w);const pe=(ge,ee,de)=>{for(let we=0;we<ee/4;we++)ge.opacityVertexArray.emplaceBack(de)};let fe=0;for(let ge=0;ge<d.symbolInstances.length;ge++){const ee=d.symbolInstances.get(ge),{numHorizontalGlyphVertices:de,numVerticalGlyphVertices:we,crossTileID:Se,numIconVertices:Re}=ee,Le=m.has(Se);let De=this.opacities[Se];Le?De=D:De||(De=he,this.opacities[Se]=De),m.add(Se);const Ue=de>0||we>0,Fe=Re>0,Ze=this.placedOrientations[Se],wt=Ze===s.WritingMode.vertical,He=Ze===s.WritingMode.horizontal||Ze===s.WritingMode.horizontalOnly;if(!Ue&&!Fe||De.isHidden()||fe++,Ue){const ht=qd(De.text);pe(d.text,de,wt?zn:ht),pe(d.text,we,He?zn:ht);const Je=De.text.isHidden(),{leftJustifiedTextSymbolIndex:_t,centerJustifiedTextSymbolIndex:Ke,rightJustifiedTextSymbolIndex:dt,verticalPlacedTextSymbolIndex:Et}=ee,yt=d.text.placedSymbolArray,jt=Je||wt?1:0;_t>=0&&(yt.get(_t).hidden=jt),Ke>=0&&(yt.get(Ke).hidden=jt),dt>=0&&(yt.get(dt).hidden=jt),Et>=0&&(yt.get(Et).hidden=Je||He?1:0);const Jt=this.variableOffsets[Se];Jt&&this.markUsedJustification(d,Jt.anchor,ee,Ze);const lr=this.placedOrientations[Se];lr&&(this.markUsedJustification(d,"left",ee,lr),this.markUsedOrientation(d,lr,ee))}if(Fe){const ht=qd(De.icon),{placedIconSymbolIndex:Je,verticalPlacedIconSymbolIndex:_t}=ee,Ke=d.icon.placedSymbolArray,dt=De.icon.isHidden()?1:0;Je>=0&&(pe(d.icon,Re,wt?zn:ht),Ke.get(Je).hidden=dt),_t>=0&&(pe(d.icon,ee.numVerticalIconVertices,He?zn:ht),Ke.get(_t).hidden=dt)}if(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData()){const ht=d.collisionArrays[ge];if(ht){let Je=new s.Point(0,0),_t=!0;if(ht.textBox||ht.verticalTextBox){if(K){const dt=this.variableOffsets[Se];dt?(Je=Ud(dt.anchor,dt.width,dt.height,dt.textOffset,dt.textScale),X&&Je._rotate(Q?this.transform.angle:-this.transform.angle)):_t=!1}P&&(_t=!De.clipped),ht.textBox&&su(d.textCollisionBox.collisionVertexArray,De.text.placed,!_t||wt,Je.x,Je.y),ht.verticalTextBox&&su(d.textCollisionBox.collisionVertexArray,De.text.placed,!_t||He,Je.x,Je.y)}const Ke=_t&&!!(!He&&ht.verticalIconBox);ht.iconBox&&su(d.iconCollisionBox.collisionVertexArray,De.icon.placed,Ke,le?Je.x:0,le?Je.y:0),ht.verticalIconBox&&su(d.iconCollisionBox.collisionVertexArray,De.icon.placed,!Ke,le?Je.x:0,le?Je.y:0)}}}if(d.fullyClipped=fe===0,d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.bucketInstanceId in this.collisionCircleArrays){const ge=this.collisionCircleArrays[d.bucketInstanceId];d.placementInvProjMatrix=ge.invProjMatrix,d.placementViewportMatrix=ge.viewportMatrix,d.collisionCircleArray=ge.circles,delete this.collisionCircleArrays[d.bucketInstanceId]}}symbolFadeChange(d){return this.fadeDuration===0?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(d){return Math.max(0,(this.transform.zoom-d)/1.5)}hasTransitions(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(d,m){const w=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*w>d}setStale(){this.stale=!0}}function su(v,d,m,w,T){v.emplaceBack(d?1:0,m?1:0,w||0,T||0),v.emplaceBack(d?1:0,m?1:0,w||0,T||0),v.emplaceBack(d?1:0,m?1:0,w||0,T||0),v.emplaceBack(d?1:0,m?1:0,w||0,T||0)}const gs=Math.pow(2,25),Gn=Math.pow(2,24),Vg=Math.pow(2,17),qg=Math.pow(2,16),ys=Math.pow(2,9),Js=Math.pow(2,8),pb=Math.pow(2,1);function qd(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const d=v.placed?1:0,m=Math.floor(127*v.opacity);return m*gs+d*Gn+m*Vg+d*qg+m*ys+d*Js+m*pb+d}const zn=0;class Wd{constructor(d){this._sortAcrossTiles=d.layout.get("symbol-z-order")!=="viewport-y"&&d.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(d,m,w,T,P){const D=this._bucketParts;for(;this._currentTileIndex<d.length;)if(m.getBucketParts(D,T,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((z,U)=>z.sortKey-U.sortKey));this._currentPartIndex<D.length;){const z=D[this._currentPartIndex];if(m.placeLayerBucketPart(z,this._seenCrossTileIDs,w,z.symbolInstanceStart===0),this._currentPartIndex++,P())return!0}return!1}}class Wg{constructor(d,m,w,T,P,D,z,U){this.placement=new Mf(d,P,D,z,U),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=w,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(d,m,w){const T=s.exported.now(),P=()=>{const D=s.exported.now()-T;return!this._forceFullPlacement&&D>2};for(;this._currentPlacementIndex>=0;){const D=m[d[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(D.type==="symbol"&&(!D.minzoom||D.minzoom<=z)&&(!D.maxzoom||D.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new Wd(D)),this._inProgressLayer.continuePlacement(w[D.source],this.placement,this._showCollisionBoxes,D,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(d){return this.placement.commit(d),this.placement}}const Ql=512/s.EXTENT/2;class Ri{constructor(d,m,w){this.tileID=d,this.bucketInstanceId=w,this.index=new s.KDBush(m.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const T=d.canonical.x*s.EXTENT,P=d.canonical.y*s.EXTENT;for(let D=0;D<m.length;D++){const{key:z,crossTileID:U,tileAnchorX:K,tileAnchorY:X}=m.get(D),Q=Math.floor((T+K)*Ql),le=Math.floor((P+X)*Ql);this.index.add(Q,le),this.keys.push(z),this.crossTileIDs.push(U)}this.index.finish()}findMatches(d,m,w){const T=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z),P=Ql/Math.pow(2,m.canonical.z-this.tileID.canonical.z),D=m.canonical.x*s.EXTENT,z=m.canonical.y*s.EXTENT;for(let U=0;U<d.length;U++){const K=d.get(U);if(K.crossTileID)continue;const{key:X,tileAnchorX:Q,tileAnchorY:le}=K,he=Math.floor((D+Q)*P),pe=Math.floor((z+le)*P),fe=this.index.range(he-T,pe-T,he+T,pe+T);for(const ge of fe){const ee=this.crossTileIDs[ge];if(this.keys[ge]===X&&!w.has(ee)){w.add(ee),K.crossTileID=ee;break}}}}}class Gg{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Hg{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(d){const m=Math.round((d-this.lng)/360);if(m!==0)for(const w in this.indexes){const T=this.indexes[w],P={};for(const D in T){const z=T[D];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+m),P[z.tileID.key]=z}this.indexes[w]=P}this.lng=d}addBucket(d,m,w){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(let P=0;P<m.symbolInstances.length;P++)m.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]=new Set);const T=this.usedCrossTileIDs[d.overscaledZ];for(const P in this.indexes){const D=this.indexes[P];if(Number(P)>d.overscaledZ)for(const z in D){const U=D[z];U.tileID.isChildOf(d)&&U.findMatches(m.symbolInstances,d,T)}else{const z=D[d.scaledTo(Number(P)).key];z&&z.findMatches(m.symbolInstances,d,T)}}for(let P=0;P<m.symbolInstances.length;P++){const D=m.symbolInstances.get(P);D.crossTileID||(D.crossTileID=w.generate(),T.add(D.crossTileID))}return this.indexes[d.overscaledZ]===void 0&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new Ri(d,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(d,m){for(const w of m.crossTileIDs)this.usedCrossTileIDs[d].delete(w)}removeStaleBuckets(d){let m=!1;for(const w in this.indexes){const T=this.indexes[w];for(const P in T)d[T[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,T[P]),delete T[P],m=!0)}return m}}class Co{constructor(){this.layerIndexes={},this.crossTileIDs=new Gg,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(d,m,w,T){let P=this.layerIndexes[d.id];P===void 0&&(P=this.layerIndexes[d.id]=new Hg);let D=!1;const z={};T.name!=="globe"&&P.handleWrapJump(w);for(const U of m){const K=U.getBucket(d);K&&d.id===K.layerIds[0]&&(K.bucketInstanceId||(K.bucketInstanceId=++this.maxBucketInstanceId),P.addBucket(U.tileID,K,this.crossTileIDs)&&(D=!0),z[K.bucketInstanceId]=!0)}return P.removeStaleBuckets(z)&&(D=!0),D}pruneUnusedLayers(d){const m={};d.forEach(w=>{m[w]=!0});for(const w in this.layerIndexes)m[w]||delete this.layerIndexes[w]}}const vl=(v,d)=>s.emitValidationErrors(v,d&&d.filter(m=>m.identifier!=="source.canvas")),If=s.pick(qr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),G2=s.pick(qr,["setCenter","setZoom","setBearing","setPitch"]),Xg={version:8,layers:[],sources:{}},au={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ga extends s.Evented{constructor(d,m={}){super(),this.map=d,this.dispatcher=new Ne(nu(),this),this.imageManager=new oe,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(d._requestManager,m.localFontFamily?s.LocalGlyphMode.all:m.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,m.localFontFamily||m.localIdeographFontFamily),this.crossTileSymbolIndex=new Co,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const w=this;this._rtlTextPluginCallback=Ga.registerForPluginStateChange(T=>{w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},(P,D)=>{if(s.triggerPluginCompletionEvent(P),D&&D.every(z=>z))for(const z in w._sourceCaches){const U=w._sourceCaches[z],K=U.getSource().type;K!=="vector"&&K!=="geojson"||U.reload()}})}),this.on("data",T=>{if(T.dataType!=="source"||T.sourceDataType!=="metadata")return;const P=this.getSource(T.sourceId);if(P&&P.vectorLayerIds)for(const D in this._layers){const z=this._layers[D];z.source===P.id&&this._validateLayer(z)}})}loadURL(d,m={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const w=typeof m.validate=="boolean"?m.validate:!s.isMapboxURL(d);d=this.map._requestManager.normalizeStyleURL(d,m.accessToken);const T=this.map._requestManager.transformRequest(d,s.ResourceType.Style);this._request=s.getJSON(T,(P,D)=>{this._request=null,P?this.fire(new s.ErrorEvent(P)):D&&this._load(D,w)})}loadJSON(d,m={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(d,m.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Xg,!1)}_updateLayerCount(d,m){const w=m?1:-1;d.is3D()&&(this._num3DLayers+=w),d.type==="circle"&&(this._numCircleLayers+=w),d.type==="symbol"&&(this._numSymbolLayers+=w)}_load(d,m){if(m&&vl(this,s.validateStyle(d)))return;this._loaded=!0,this.stylesheet=s.clone$1(d),this._updateMapProjection();for(const T in d.sources)this.addSource(T,d.sources[T],{validate:!1});this._changed=!1,d.sprite?this._loadSprite(d.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(d.glyphs);const w=cb(this.stylesheet.layers);this._order=w.map(T=>T.id),this._layers={},this._serializedLayers={};for(const T of w){const P=s.createStyleLayer(T);P.setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize(),this._updateLayerCount(P,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ue(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(d){d?this.stylesheet.projection=d:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(d){this._spriteRequest=function(m,w,T){let P,D,z;const U=s.exported.devicePixelRatio>1?"@2x":"";let K=s.getJSON(w.transformRequest(w.normalizeSpriteURL(m,U,".json"),s.ResourceType.SpriteJSON),(le,he)=>{K=null,z||(z=le,P=he,Q())}),X=s.getImage(w.transformRequest(w.normalizeSpriteURL(m,U,".png"),s.ResourceType.SpriteImage),(le,he)=>{X=null,z||(z=le,D=he,Q())});function Q(){if(z)T(z);else if(P&&D){const le=s.exported.getImageData(D),he={};for(const pe in P){const{width:fe,height:ge,x:ee,y:de,sdf:we,pixelRatio:Se,stretchX:Re,stretchY:Le,content:De}=P[pe],Ue=new s.RGBAImage({width:fe,height:ge});s.RGBAImage.copy(le,Ue,{x:ee,y:de},{x:0,y:0},{width:fe,height:ge}),he[pe]={data:Ue,pixelRatio:Se,sdf:we,stretchX:Re,stretchY:Le,content:De}}T(null,he)}}return{cancel(){K&&(K.cancel(),K=null),X&&(X.cancel(),X=null)}}}(d,this.map._requestManager,(m,w)=>{if(this._spriteRequest=null,m)this.fire(new s.ErrorEvent(m));else if(w)for(const T in w)this.imageManager.addImage(T,w[T]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(d){const m=this.getSource(d.source);if(!m)return;const w=d.sourceLayer;w&&(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(w)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${w}" does not exist on source "${m.id}" as specified by style layer "${d.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const d in this._sourceCaches)if(!this._sourceCaches[d].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(d){const m=[];for(const w of d){const T=this._layers[w];T.type!=="custom"&&m.push(T.serialize())}return m}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const d in this._sourceCaches)if(this._sourceCaches[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(d){return!!this.terrain&&(typeof d.isLayerDraped=="function"?d.isLayerDraped():au[d.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(d){if(!this._loaded)return;const m=this._changed;if(this._changed){const T=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);(T.length||P.length)&&this._updateWorkerLayers(T,P);for(const D in this._updatedSources){const z=this._updatedSources[D];z==="reload"?this._reloadSource(D):z==="clear"&&this._clearSource(D)}this._updateTilesForChangedImages();for(const D in this._updatedPaintProps)this._layers[D].updateTransitions(d);this.light.updateTransitions(d),this.fog&&this.fog.updateTransitions(d),this._resetUpdates()}const w={};for(const T in this._sourceCaches){const P=this._sourceCaches[T];w[T]=P.used,P.used=!1}for(const T of this._order){const P=this._layers[T];if(P.recalculate(d,this._availableImages),!P.isHidden(d.zoom)){const z=this._getLayerSourceCache(P);z&&(z.used=!0)}const D=this.map.painter;if(D){const z=P.getProgramIds();if(!z)continue;const U=P.getProgramConfiguration(d.zoom);for(const K of z)D.useProgram(K,U)}}for(const T in w){const P=this._sourceCaches[T];w[T]!==P.used&&P.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:P.getSource().id}))}this.light.recalculate(d),this.terrain&&this.terrain.recalculate(d),this.fog&&this.fog.recalculate(d),this.z=d.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const d=Object.keys(this._changedImages);if(d.length){for(const m in this._sourceCaches)this._sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],d);this._changedImages={}}}_updateWorkerLayers(d,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(d),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(d){if(this._checkLoaded(),vl(this,s.validateStyle(d)))return!1;(d=s.clone$1(d)).layers=cb(d.layers);const m=function(T,P){if(!T)return[{command:qr.setStyle,args:[P]}];let D=[];try{if(!p(T.version,P.version))return[{command:qr.setStyle,args:[P]}];p(T.center,P.center)||D.push({command:qr.setCenter,args:[P.center]}),p(T.zoom,P.zoom)||D.push({command:qr.setZoom,args:[P.zoom]}),p(T.bearing,P.bearing)||D.push({command:qr.setBearing,args:[P.bearing]}),p(T.pitch,P.pitch)||D.push({command:qr.setPitch,args:[P.pitch]}),p(T.sprite,P.sprite)||D.push({command:qr.setSprite,args:[P.sprite]}),p(T.glyphs,P.glyphs)||D.push({command:qr.setGlyphs,args:[P.glyphs]}),p(T.transition,P.transition)||D.push({command:qr.setTransition,args:[P.transition]}),p(T.light,P.light)||D.push({command:qr.setLight,args:[P.light]}),p(T.fog,P.fog)||D.push({command:qr.setFog,args:[P.fog]}),p(T.projection,P.projection)||D.push({command:qr.setProjection,args:[P.projection]});const z={},U=[];(function(Q,le,he,pe){let fe;for(fe in le=le||{},Q=Q||{})Q.hasOwnProperty(fe)&&(le.hasOwnProperty(fe)||Ld(fe,he,pe));for(fe in le){if(!le.hasOwnProperty(fe))continue;const ge=le[fe];Q.hasOwnProperty(fe)?p(Q[fe],ge)||(Q[fe].type==="geojson"&&ge.type==="geojson"&&kf(Q,le,fe)?he.push({command:qr.setGeoJSONSourceData,args:[fe,ge.data]}):Bg(fe,le,he,pe)):Lg(fe,le,he)}})(T.sources,P.sources,U,z);const K=[];T.layers&&T.layers.forEach(Q=>{Q.source&&z[Q.source]?D.push({command:qr.removeLayer,args:[Q.id]}):K.push(Q)});let X=T.terrain;X&&z[X.source]&&(D.push({command:qr.setTerrain,args:[void 0]}),X=void 0),D=D.concat(U),p(X,P.terrain)||D.push({command:qr.setTerrain,args:[P.terrain]}),function(Q,le,he){le=le||[];const pe=(Q=Q||[]).map(So),fe=le.map(So),ge=Q.reduce(zg,{}),ee=le.reduce(zg,{}),de=pe.slice(),we=Object.create(null);let Se,Re,Le,De,Ue,Fe,Ze;for(Se=0,Re=0;Se<pe.length;Se++)Le=pe[Se],ee.hasOwnProperty(Le)?Re++:(he.push({command:qr.removeLayer,args:[Le]}),de.splice(de.indexOf(Le,Re),1));for(Se=0,Re=0;Se<fe.length;Se++)Le=fe[fe.length-1-Se],de[de.length-1-Se]!==Le&&(ge.hasOwnProperty(Le)?(he.push({command:qr.removeLayer,args:[Le]}),de.splice(de.lastIndexOf(Le,de.length-Re),1)):Re++,Fe=de[de.length-Se],he.push({command:qr.addLayer,args:[ee[Le],Fe]}),de.splice(de.length-Se,0,Le),we[Le]=!0);for(Se=0;Se<fe.length;Se++)if(Le=fe[Se],De=ge[Le],Ue=ee[Le],!we[Le]&&!p(De,Ue))if(p(De.source,Ue.source)&&p(De["source-layer"],Ue["source-layer"])&&p(De.type,Ue.type)){for(Ze in qa(De.layout,Ue.layout,he,Le,null,qr.setLayoutProperty),qa(De.paint,Ue.paint,he,Le,null,qr.setPaintProperty),p(De.filter,Ue.filter)||he.push({command:qr.setFilter,args:[Le,Ue.filter]}),p(De.minzoom,Ue.minzoom)&&p(De.maxzoom,Ue.maxzoom)||he.push({command:qr.setLayerZoomRange,args:[Le,Ue.minzoom,Ue.maxzoom]}),De)De.hasOwnProperty(Ze)&&Ze!=="layout"&&Ze!=="paint"&&Ze!=="filter"&&Ze!=="metadata"&&Ze!=="minzoom"&&Ze!=="maxzoom"&&(Ze.indexOf("paint.")===0?qa(De[Ze],Ue[Ze],he,Le,Ze.slice(6),qr.setPaintProperty):p(De[Ze],Ue[Ze])||he.push({command:qr.setLayerProperty,args:[Le,Ze,Ue[Ze]]}));for(Ze in Ue)Ue.hasOwnProperty(Ze)&&!De.hasOwnProperty(Ze)&&Ze!=="layout"&&Ze!=="paint"&&Ze!=="filter"&&Ze!=="metadata"&&Ze!=="minzoom"&&Ze!=="maxzoom"&&(Ze.indexOf("paint.")===0?qa(De[Ze],Ue[Ze],he,Le,Ze.slice(6),qr.setPaintProperty):p(De[Ze],Ue[Ze])||he.push({command:qr.setLayerProperty,args:[Le,Ze,Ue[Ze]]}))}else he.push({command:qr.removeLayer,args:[Le]}),Fe=de[de.lastIndexOf(Le)+1],he.push({command:qr.addLayer,args:[Ue,Fe]})}(K,P.layers,D)}catch(z){console.warn("Unable to compute style diff:",z),D=[{command:qr.setStyle,args:[P]}]}return D}(this.serialize(),d).filter(T=>!(T.command in G2));if(m.length===0)return!1;const w=m.filter(T=>!(T.command in If));if(w.length>0)throw new Error(`Unimplemented: ${w.map(T=>T.command).join(", ")}.`);return m.forEach(T=>{T.command!=="setTransition"&&T.command!=="setProjection"&&this[T.command].apply(this,T.args)}),this.stylesheet=d,this._updateMapProjection(),!0}addImage(d,m){return this.getImage(d)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(d,m),this._afterImageUpdated(d),this)}updateImage(d,m){this.imageManager.updateImage(d,m)}getImage(d){return this.imageManager.getImage(d)}removeImage(d){return this.getImage(d)?(this.imageManager.removeImage(d),this._afterImageUpdated(d),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(d){this._availableImages=this.imageManager.listImages(),this._changedImages[d]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(d,m,w={}){if(this._checkLoaded(),this.getSource(d)!==void 0)throw new Error("There is already a source with this ID");if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(s.validateSource,`sources.${d}`,m,null,w))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const T=_r(d,m,this.dispatcher,this);T.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(d),source:T.serialize(),sourceId:d}));const P=D=>{const z=(D?"symbol:":"other:")+d,U=this._sourceCaches[z]=new s.SourceCache(z,T,D);(D?this._symbolSourceCaches:this._otherSourceCaches)[d]=U,U.style=this,U.onAdd(this.map)};P(!1),m.type!=="vector"&&m.type!=="geojson"||P(!0),T.onAdd&&T.onAdd(this.map),this._changed=!0}removeSource(d){this._checkLoaded();const m=this.getSource(d);if(!m)throw new Error("There is no source with this ID");for(const T in this._layers)if(this._layers[T].source===d)return this.fire(new s.ErrorEvent(new Error(`Source "${d}" cannot be removed while layer "${T}" is using it.`)));if(this.terrain&&this.terrain.get().source===d)return this.fire(new s.ErrorEvent(new Error(`Source "${d}" cannot be removed while terrain is using it.`)));const w=this._getSourceCaches(d);for(const T of w)delete this._sourceCaches[T.id],delete this._updatedSources[T.id],T.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:T.getSource().id})),T.setEventedParent(null),T.clearTiles();return delete this._otherSourceCaches[d],delete this._symbolSourceCaches[d],m.setEventedParent(null),m.onRemove&&m.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(d,m){this._checkLoaded(),this.getSource(d).setData(m),this._changed=!0}getSource(d){const m=this._getSourceCache(d);return m&&m.getSource()}_getSources(){const d=[];for(const m in this._otherSourceCaches){const w=this._getSourceCache(m);w&&d.push(w.getSource())}return d}addLayer(d,m,w={}){this._checkLoaded();const T=d.id;if(this.getLayer(T))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${T}" already exists on this map`)));let P;if(d.type==="custom"){if(vl(this,s.validateCustomStyleLayer(d)))return;P=s.createStyleLayer(d)}else{if(typeof d.source=="object"&&(this.addSource(T,d.source),d=s.clone$1(d),d=s.extend(d,{source:T})),this._validate(s.validateLayer,`layers.${T}`,d,{arrayIndex:-1},w))return;P=s.createStyleLayer(d),this._validateLayer(P),P.setEventedParent(this,{layer:{id:T}}),this._serializedLayers[P.id]=P.serialize(),this._updateLayerCount(P,!0)}const D=m?this._order.indexOf(m):this._order.length;if(m&&D===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`)));this._order.splice(D,0,T),this._layerOrderChanged=!0,this._layers[T]=P;const z=this._getLayerSourceCache(P);if(this._removedLayers[T]&&P.source&&z&&P.type!=="custom"){const U=this._removedLayers[T];delete this._removedLayers[T],U.type!==P.type?this._updatedSources[P.source]="clear":(this._updatedSources[P.source]="reload",z.pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(d,m){if(this._checkLoaded(),this._changed=!0,!this._layers[d])return void this.fire(new s.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be moved.`)));if(d===m)return;const w=this._order.indexOf(d);this._order.splice(w,1);const T=m?this._order.indexOf(m):this._order.length;m&&T===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`))):(this._order.splice(T,0,d),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(d){this._checkLoaded();const m=this._layers[d];if(!m)return void this.fire(new s.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be removed.`)));m.setEventedParent(null),this._updateLayerCount(m,!1);const w=this._order.indexOf(d);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[d]=m,delete this._layers[d],delete this._serializedLayers[d],delete this._updatedLayers[d],delete this._updatedPaintProps[d],m.onRemove&&m.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(d){return this._layers[d]}hasLayer(d){return d in this._layers}hasLayerType(d){for(const m in this._layers)if(this._layers[m].type===d)return!0;return!1}setLayerZoomRange(d,m,w){this._checkLoaded();const T=this.getLayer(d);T?T.minzoom===m&&T.maxzoom===w||(m!=null&&(T.minzoom=m),w!=null&&(T.maxzoom=w),this._updateLayer(T)):this.fire(new s.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(d,m,w={}){this._checkLoaded();const T=this.getLayer(d);if(T){if(!p(T.filter,m))return m==null?(T.filter=void 0,void this._updateLayer(T)):void(this._validate(s.validateFilter,`layers.${T.id}.filter`,m,{layerType:T.type},w)||(T.filter=s.clone$1(m),this._updateLayer(T)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be filtered.`)))}getFilter(d){const m=this.getLayer(d);return m&&s.clone$1(m.filter)}setLayoutProperty(d,m,w,T={}){this._checkLoaded();const P=this.getLayer(d);P?p(P.getLayoutProperty(m),w)||(P.setLayoutProperty(m,w,T),this._updateLayer(P)):this.fire(new s.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(d,m){const w=this.getLayer(d);if(w)return w.getLayoutProperty(m);this.fire(new s.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style.`)))}setPaintProperty(d,m,w,T={}){this._checkLoaded();const P=this.getLayer(d);P?p(P.getPaintProperty(m),w)||(P.setPaintProperty(m,w,T)&&this._updateLayer(P),this._changed=!0,this._updatedPaintProps[d]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(d,m){const w=this.getLayer(d);return w&&w.getPaintProperty(m)}setFeatureState(d,m){this._checkLoaded();const w=d.source,T=d.sourceLayer,P=this.getSource(w);if(!P)return void this.fire(new s.ErrorEvent(new Error(`The source '${w}' does not exist in the map's style.`)));const D=P.type;if(D==="geojson"&&T)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(D==="vector"&&!T)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));d.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const z=this._getSourceCaches(w);for(const U of z)U.setFeatureState(T,d.id,m)}removeFeatureState(d,m){this._checkLoaded();const w=d.source,T=this.getSource(w);if(!T)return void this.fire(new s.ErrorEvent(new Error(`The source '${w}' does not exist in the map's style.`)));const P=T.type,D=P==="vector"?d.sourceLayer:void 0;if(P==="vector"&&!D)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(m&&typeof d.id!="string"&&typeof d.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const z=this._getSourceCaches(w);for(const U of z)U.removeFeatureState(D,d.id,m)}getFeatureState(d){this._checkLoaded();const m=d.source,w=d.sourceLayer,T=this.getSource(m);if(T){if(T.type!=="vector"||w)return d.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(m)[0].getFeatureState(w,d.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const d={};for(const m in this._sourceCaches){const w=this._sourceCaches[m].getSource();d[w.id]||(d[w.id]=w.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:d,layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateLayer(d){this._updatedLayers[d.id]=!0;const m=this._getLayerSourceCache(d);d.source&&!this._updatedSources[d.source]&&m&&m.getSource().type!=="raster"&&(this._updatedSources[d.source]="reload",m.pause()),this._changed=!0,d.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(d){const m=D=>this._layers[D].type==="fill-extrusion",w={},T=[];for(let D=this._order.length-1;D>=0;D--){const z=this._order[D];if(m(z)){w[z]=D;for(const U of d){const K=U[z];if(K)for(const X of K)T.push(X)}}}T.sort((D,z)=>z.intersectionZ-D.intersectionZ);const P=[];for(let D=this._order.length-1;D>=0;D--){const z=this._order[D];if(m(z))for(let U=T.length-1;U>=0;U--){const K=T[U].feature;if(w[K.layer.id]<D)break;P.push(K),T.pop()}else for(const U of d){const K=U[z];if(K)for(const X of K)P.push(X.feature)}}return P}queryRenderedFeatures(d,m,w){m&&m.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",m.filter,null,m);const T={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const U of m.layers){const K=this._layers[U];if(!K)return this.fire(new s.ErrorEvent(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];T[K.source]=!0}}const P=[];m.availableImages=this._availableImages;const D=m&&m.layers?m.layers.some(U=>{const K=this.getLayer(U);return K&&K.is3D()}):this.has3DLayers(),z=We.createFromScreenPoints(d,w);for(const U in this._sourceCaches){const K=this._sourceCaches[U].getSource().id;m.layers&&!T[K]||P.push(Pn(this._sourceCaches[U],this._layers,this._serializedLayers,z,m,w,D,!!this.map._showQueryGeometry))}return this.placement&&P.push(function(U,K,X,Q,le,he,pe){const fe={},ge=he.queryRenderedSymbols(Q),ee=[];for(const de of Object.keys(ge).map(Number))ee.push(pe[de]);ee.sort(Gi);for(const de of ee){const we=de.featureIndex.lookupSymbolFeatures(ge[de.bucketInstanceId],K,de.bucketIndex,de.sourceLayerIndex,le.filter,le.layers,le.availableImages,U);for(const Se in we){const Re=fe[Se]=fe[Se]||[],Le=we[Se];Le.sort((De,Ue)=>{const Fe=de.featureSortOrder;if(Fe){const Ze=Fe.indexOf(De.featureIndex);return Fe.indexOf(Ue.featureIndex)-Ze}return Ue.featureIndex-De.featureIndex});for(const De of Le)Re.push(De)}}for(const de in fe)fe[de].forEach(we=>{const Se=we.feature,Re=X(U[de]);if(!Re)return;const Le=Re.getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=Le});return fe}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),z.screenGeometry,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(d,m){m&&m.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",m.filter,null,m);const w=this._getSourceCaches(d);let T=[];for(const P of w)T=T.concat(Yn(P,m));return T}addSourceType(d,m,w){return Ga.getSourceType(d)?w(new Error(`A source type called "${d}" already exists.`)):(Ga.setSourceType(d,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:d,url:m.workerSourceURL},w):w(null,null))}getLight(){return this.light.getLight()}setLight(d,m={}){this._checkLoaded();const w=this.light.getLight();let T=!1;for(const D in d)if(!p(d[D],w[D])){T=!0;break}if(!T)return;const P=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(d,m),this.light.updateTransitions(P)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(d,m=1){if(this._checkLoaded(),!d)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let w=d;if(m===1){if(typeof w.source=="object"){const T="terrain-dem-src";this.addSource(T,w.source),w=s.clone$1(w),w=s.extend(w,{source:T})}if(this._validate(s.validateTerrain,"terrain",w))return}if(!this.terrain||this.terrain&&m!==this.terrain.drapeRenderMode){if(!w)return;this._createTerrain(w,m)}else{const T=this.terrain,P=T.get();for(const D of Object.keys(s.spec.terrain))!w.hasOwnProperty(D)&&s.spec.terrain[D].default&&(w[D]=s.spec.terrain[D].default);for(const D in w)if(!p(w[D],P[D])){T.set(w),this.stylesheet.terrain=w;const z=this._setTransitionParameters({duration:0});T.updateTransitions(z);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(d){const m=this.fog=new ke(d,this.map.transform);this.stylesheet.fog=d;const w=this._setTransitionParameters({duration:0});m.updateTransitions(w)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const d of this.map._markers)d._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(d){if(this._checkLoaded(),!d)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const m=this.fog,w=m.get();Object.keys(d).length===0&&m.set(d);for(const T in d)if(!p(d[T],w[T])){m.set(d),this.stylesheet.fog=d;const P=this._setTransitionParameters({duration:0});m.updateTransitions(P);break}}else this._createFog(d);this._markersNeedUpdate=!0}_setTransitionParameters(d){return{now:s.exported.now(),transition:s.extend(d,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const d=this._order.filter(w=>this.isLayerDraped(this._layers[w])),m=this._order.filter(w=>!this.isLayerDraped(this._layers[w]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...d),this._drapedFirstOrder.push(...m)}_createTerrain(d,m){const w=this.terrain=new xe(d,m);this.stylesheet.terrain=d,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const T=this._setTransitionParameters({duration:0});w.updateTransitions(T)}_force3DLayerUpdate(){for(const d in this._layers){const m=this._layers[d];m.type==="fill-extrusion"&&this._updateLayer(m)}}_forceSymbolLayerUpdate(){for(const d in this._layers){const m=this._layers[d];m.type==="symbol"&&this._updateLayer(m)}}_validate(d,m,w,T,P={}){return(!P||P.validate!==!1)&&vl(this,d.call(s.validateStyle,s.extend({key:m,style:this.serialize(),value:w,styleSpec:s.spec},T)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this._sourceCaches)this._sourceCaches[d].clearTiles(),this._sourceCaches[d].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(d){const m=this._getSourceCaches(d);for(const w of m)w.clearTiles()}_reloadSource(d){const m=this._getSourceCaches(d);for(const w of m)w.resume(),w.reload()}_reloadSources(){for(const d of this._getSources())d.reload&&d.reload()}_updateSources(d){for(const m in this._sourceCaches)this._sourceCaches[m].update(d)}_generateCollisionBoxes(){for(const d in this._sourceCaches){const m=this._sourceCaches[d];m.resume(),m.reload()}}_updatePlacement(d,m,w,T,P=!1){let D=!1,z=!1;const U={};for(const K of this._order){const X=this._layers[K];if(X.type!=="symbol")continue;if(!U[X.source]){const le=this._getLayerSourceCache(X);if(!le)continue;U[X.source]=le.getRenderableIds(!0).map(he=>le.getTileByID(he)).sort((he,pe)=>pe.tileID.overscaledZ-he.tileID.overscaledZ||(he.tileID.isLessThan(pe.tileID)?-1:1))}const Q=this.crossTileSymbolIndex.addLayer(X,U[X.source],d.center.lng,d.projection);D=D||Q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),P=P||this._layerOrderChanged||w===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(P||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),d.zoom))&&(this.pauseablePlacement=new Wg(d,this._order,P,m,w,T,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),z=!0),D&&this.pauseablePlacement.placement.setStale()),z||D)for(const K of this._order){const X=this._layers[K];X.type==="symbol"&&this.placement.updateLayerOpacities(X,U[X.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const d in this._sourceCaches)this._sourceCaches[d].releaseSymbolFadeTiles()}getImages(d,m,w){this.imageManager.getImages(m.icons,w),this._updateTilesForChangedImages();const T=P=>{P&&P.setDependencies(m.tileID.key,m.type,m.icons)};T(this._otherSourceCaches[m.source]),T(this._symbolSourceCaches[m.source])}getGlyphs(d,m,w){this.glyphManager.getGlyphs(m.stacks,w)}getResource(d,m,w){return s.makeRequest(m,w)}_getSourceCache(d){return this._otherSourceCaches[d]}_getLayerSourceCache(d){return d.type==="symbol"?this._symbolSourceCaches[d.source]:this._otherSourceCaches[d.source]}_getSourceCaches(d){const m=[];return this._otherSourceCaches[d]&&m.push(this._otherSourceCaches[d]),this._symbolSourceCaches[d]&&m.push(this._symbolSourceCaches[d]),m}_isSourceCacheLoaded(d){const m=this._getSourceCaches(d);return m.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${d}'`))),!1):m.every(w=>w.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ga.getSourceType=function(v){return mr[v]},Ga.setSourceType=function(v,d){mr[v]=d},Ga.registerForPluginStateChange=s.registerForPluginStateChange;var Kg=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,ec="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Po=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Gd=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Ao=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Of={},ou={};const Hd=[];lu(Kg,Hd),lu(Po,Hd),lu(Gd,Hd),lu(Ao,Hd),Of=Wr("",Po),ou=Wr(Ao,Gd);const mb=Wr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Rf=Kg,Zg=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Yg={background:Wr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Wr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Wr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Wr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Wr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Wr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Wr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Wr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Wr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Wr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Wr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Wr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Wr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Wr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Wr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Wr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Wr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Wr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Wr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Wr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Wr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Wr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Wr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Wr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Wr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ec),skyboxGradient:Wr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ec),skyboxCapture:Wr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Wr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Wr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function lu(v,d){const m=v.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let w of m)if(w=w.trim(),w[0]==="#"&&w.includes("if")&&!w.includes("endif")){w=w.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const T=w.split(" ");for(const P of T)d.includes(P)||d.push(P)}}function Wr(v,d){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=d.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),T={},P=[...Hd];return lu(v,P),lu(d,P),{fragmentSource:v=v.replace(m,(D,z,U,K,X)=>(T[X]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${X}
varying ${U} ${K} ${X};
#else
uniform ${U} ${K} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${U} ${K} ${X} = u_${X};
#endif
`)),vertexSource:d=d.replace(m,(D,z,U,K,X)=>{const Q=K==="float"?"vec2":"vec4",le=X.match(/color/)?"color":Q;return T[X]?z==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${U} ${Q} a_${X};
varying ${U} ${K} ${X};
#else
uniform ${U} ${K} u_${X};
#endif
`:le==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${U} ${K} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${le}(a_${X}, u_${X}_t);
#else
    ${U} ${K} ${X} = u_${X};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${U} ${Q} a_${X};
#else
uniform ${U} ${K} u_${X};
#endif
`:le==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${U} ${K} ${X} = a_${X};
#else
    ${U} ${K} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${U} ${K} ${X} = unpack_mix_${le}(a_${X}, u_${X}_t);
#else
    ${U} ${K} ${X} = u_${X};
#endif
`}),staticAttributes:w,usedDefines:P}}class H2{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(d,m,w,T,P,D,z){this.context=d;let U=this.boundPaintVertexBuffers.length!==T.length;for(let X=0;!U&&X<T.length;X++)this.boundPaintVertexBuffers[X]!==T[X]&&(U=!0);let K=this.boundDynamicVertexBuffers.length!==z.length;for(let X=0;!K&&X<z.length;X++)this.boundDynamicVertexBuffers[X]!==z[X]&&(K=!0);if(!d.extVertexArrayObject||!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==w||U||K||this.boundIndexBuffer!==P||this.boundVertexOffset!==D)this.freshBind(m,w,T,P,D,z);else{d.bindVertexArrayOES.set(this.vao);for(const X of z)X&&X.bind();P&&P.dynamicDraw&&P.bind()}}freshBind(d,m,w,T,P,D){let z;const U=d.numAttributes,K=this.context,X=K.gl;if(K.extVertexArrayObject)this.vao&&this.destroy(),this.vao=K.extVertexArrayObject.createVertexArrayOES(),K.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=d,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=T,this.boundVertexOffset=P,this.boundDynamicVertexBuffers=D;else{z=K.currentNumAttributes||0;for(let Q=U;Q<z;Q++)X.disableVertexAttribArray(Q)}m.enableAttributes(X,d),m.bind(),m.setVertexAttribPointers(X,d,P);for(const Q of w)Q.enableAttributes(X,d),Q.bind(),Q.setVertexAttribPointers(X,d,P);for(const Q of D)Q&&(Q.enableAttributes(X,d),Q.bind(),Q.setVertexAttribPointers(X,d,P));T&&T.bind(),K.currentNumAttributes=U}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Jg(v,d){const m=Math.pow(2,d.canonical.z),w=d.canonical.y;return[new s.MercatorCoordinate(0,w/m).toLngLat().lat,new s.MercatorCoordinate(0,(w+1)/m).toLngLat().lat]}function gb(v,d,m,w,T,P,D){const z=v.context,U=z.gl,K=m.fbo;if(!K)return;v.prepareDrawTile();const X=v.useProgram("hillshade");z.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,K.colorAttachment.get());const Q=((fe,ge,ee,de)=>{const we=ee.paint.get("hillshade-shadow-color"),Se=ee.paint.get("hillshade-highlight-color"),Re=ee.paint.get("hillshade-accent-color");let Le=ee.paint.get("hillshade-illumination-direction")*(Math.PI/180);ee.paint.get("hillshade-illumination-anchor")==="viewport"&&(Le-=fe.transform.angle);const De=!fe.options.moving;return{u_matrix:de||fe.transform.calculateProjMatrix(ge.tileID.toUnwrapped(),De),u_image:0,u_latrange:Jg(0,ge.tileID),u_light:[ee.paint.get("hillshade-exaggeration"),Le],u_shadow:we,u_highlight:Se,u_accent:Re}})(v,m,w,v.terrain?d.projMatrix:null);v.prepareDrawProgram(z,X,d.toUnwrapped());const{tileBoundsBuffer:le,tileBoundsIndexBuffer:he,tileBoundsSegments:pe}=v.getTileBoundsBuffers(m);X.draw(z,U.TRIANGLES,T,P,D,s.CullFaceMode.disabled,Q,w.id,le,he,pe)}function Qg(v,d,m){if(!d.needsDEMTextureUpload)return;const w=v.context,T=w.gl;w.pixelStoreUnpackPremultiplyAlpha.set(!1),d.demTexture=d.demTexture||v.getTileTexture(m.stride);const P=m.getPixels();d.demTexture?d.demTexture.update(P,{premultiply:!1}):d.demTexture=new s.Texture(w,P,T.RGBA,{premultiply:!1}),d.needsDEMTextureUpload=!1}function yb(v,d,m,w,T,P){const D=v.context,z=D.gl;if(!d.dem)return;const U=d.dem;if(D.activeTexture.set(z.TEXTURE1),Qg(v,d,U),!d.demTexture)return;d.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);const K=U.dim;D.activeTexture.set(z.TEXTURE0);let X=d.fbo;if(!X){const pe=new s.Texture(D,{width:K,height:K,data:null},z.RGBA);pe.bind(z.LINEAR,z.CLAMP_TO_EDGE),X=d.fbo=D.createFramebuffer(K,K,!0),X.colorAttachment.set(pe.texture)}D.bindFramebuffer.set(X.framebuffer),D.viewport.set([0,0,K,K]);const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:le,tileBoundsSegments:he}=v.getMercatorTileBoundsBuffers();v.useProgram("hillshadePrepare").draw(D,z.TRIANGLES,w,T,P,s.CullFaceMode.disabled,((pe,fe)=>{const ge=fe.stride,ee=s.create();return s.ortho(ee,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(ee,ee,[0,-s.EXTENT,0]),{u_matrix:ee,u_image:1,u_dimension:[ge,ge],u_zoom:pe.overscaledZ,u_unpack:fe.unpackVector}})(d.tileID,U),m.id,Q,le,he),d.needsHillshadePrepare=!1}const ey=v=>({u_matrix:new s.UniformMatrix4f(v),u_image0:new s.Uniform1i(v),u_skirt_height:new s.Uniform1f(v)}),cu=(v,d)=>({u_matrix:v,u_image0:0,u_skirt_height:d}),Df=(v,d,m,w,T,P,D,z,U,K,X,Q,le,he,pe)=>({u_proj_matrix:Float32Array.from(v),u_globe_matrix:d,u_normalize_matrix:Float32Array.from(w),u_merc_matrix:m,u_zoom_transition:T,u_merc_center:P,u_image0:0,u_frustum_tl:D,u_frustum_tr:z,u_frustum_br:U,u_frustum_bl:K,u_globe_pos:X,u_globe_radius:Q,u_viewport:le,u_grid_matrix:pe?Float32Array.from(pe):new Float32Array(9),u_skirt_height:he});function uu(v,d){return v!=null&&d!=null&&!(!v.hasData()||!d.hasData())&&v.demTexture!=null&&d.demTexture!=null&&v.tileID.key!==d.tileID.key}const No=new class{constructor(){this.operations={}}newMorphing(v,d,m,w,T){if(v in this.operations){const P=this.operations[v];P.to.tileID.key!==m.tileID.key&&(P.queued=m)}else this.operations[v]={startTime:w,phase:0,duration:T,from:d,to:m,queued:null}}getMorphValuesForProxy(v){if(!(v in this.operations))return null;const d=this.operations[v];return{from:d.from,to:d.to,phase:d.phase}}update(v){for(const d in this.operations){const m=this.operations[d];for(m.phase=(v-m.startTime)/m.duration;m.phase>=1||!this._validOp(m);)if(!this._nextOp(m,v)){delete this.operations[d];break}}}_nextOp(v,d){return!!v.queued&&(v.from=v.to,v.to=v.queued,v.queued=null,v.phase=0,v.startTime=d,!0)}_validOp(v){return v.from.hasData()&&v.to.hasData()}},tc={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Lf(v){return 6*Math.pow(1.5,22-v)}function vb(v,d){const m=1<<v.z;return!d&&(v.x===0||v.x===m-1)||v.y===0||v.y===m-1}const Xd=v=>({u_matrix:v});function ty(v,d,m,w,T){if(T>0){const P=s.exported.now(),D=(P-v.timeAdded)/T,z=d?(P-d.timeAdded)/T:-1,U=m.getSource(),K=w.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),X=!d||Math.abs(d.tileID.overscaledZ-K)>Math.abs(v.tileID.overscaledZ-K),Q=X&&v.refreshedUponExpiration?1:s.clamp(X?D:1-z,0,1);return v.refreshedUponExpiration&&D>=1&&(v.refreshedUponExpiration=!1),d?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}class ry extends s.SourceCache{constructor(d){const m={type:"raster-dem",maxzoom:d.transform.maxZoom},w=new Ne(nu(),null),T=_r("mock-dem",m,w,d.style);super("mock-dem",T,!1),T.setEventedParent(this),this._sourceLoaded=!0}_loadTile(d,m){d.state="loaded",m(null)}}class Bf extends s.SourceCache{constructor(d){const m=_r("proxy",{type:"geojson",maxzoom:d.transform.maxZoom},new Ne(nu(),null),d.style);super("proxy",m,!1),m.setEventedParent(this),this.map=this.getSource().map=d,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(d,m,w){if(d.freezeTileCoverage)return;this.transform=d;const T=d.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((P,D)=>{if(P[D.key]="",!this._tiles[D.key]){const z=new s.Tile(D,this._source.tileSize*D.overscaleFactor(),d.tileZoom);z.state="loaded",this._tiles[D.key]=z}return P},{});for(const P in this._tiles)P in T||(this.freeFBO(P),this._tiles[P].unloadVectorData(),delete this._tiles[P])}freeFBO(d){const m=this.proxyCachedFBO[d];if(m!==void 0){const w=Object.values(m);this.renderCachePool.push(...w),delete this.proxyCachedFBO[d]}}deallocRenderCache(){this.renderCache.forEach(d=>d.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class zf extends s.OverscaledTileID{constructor(d,m,w){super(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y),this.proxyTileKey=m,this.projMatrix=w}}class ny extends s.Elevation{constructor(d,m){super(),this.painter=d,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[w,T,P]=function(U){const K=new s.StructArrayLayout2i4,X=new s.StructArrayLayout3ui6,Q=131;K.reserve(17161),X.reserve(33800);const le=s.EXTENT/128,he=s.EXTENT+le/2,pe=he+le;for(let ge=-le;ge<pe;ge+=le)for(let ee=-le;ee<pe;ee+=le){const de=ee<0||ee>he||ge<0||ge>he?24575:0,we=s.clamp(Math.round(ee),0,s.EXTENT),Se=s.clamp(Math.round(ge),0,s.EXTENT);K.emplaceBack(we+de,Se)}const fe=(ge,ee)=>{const de=ee*Q+ge;X.emplaceBack(de+1,de,de+Q),X.emplaceBack(de+Q,de+Q+1,de+1)};for(let ge=1;ge<129;ge++)for(let ee=1;ee<129;ee++)fe(ee,ge);return[0,129].forEach(ge=>{for(let ee=0;ee<130;ee++)fe(ee,ge),fe(ge,ee)}),[K,X,32768]}(),D=d.context;this.gridBuffer=D.createVertexBuffer(w,s.posAttributes.members),this.gridIndexBuffer=D.createIndexBuffer(T),this.gridSegments=s.SegmentVector.simpleSegment(0,0,w.length,T.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,w.length,P),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Bf(m.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const z=D.gl;this._overlapStencilMode=new s.StencilMode({func:z.GEQUAL,mask:255},0,255,z.KEEP,z.KEEP,z.REPLACE),this._previousZoom=d.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=m,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ry(m.map)}set style(d){d.on("data",this._onStyleDataEvent.bind(this)),d.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=d,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(d,m,w){if(d&&d.terrain){this._style!==d&&(this.style=d),this.enabled=!0;const T=d.terrain.properties;this.sourceCache=d.terrain.drapeRenderMode===0?this._mockSourceCache:d._getSourceCache(T.get("source")),this._exaggeration=T.get("exaggeration");const P=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const D=this.getScaledDemTileSize();this.sourceCache.update(m,D,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,P(),this._initializing=!0),P(),m.updateElevation(!0,w),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(m),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(d){this._findCoveringTileCache[d]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const d=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||d.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${d.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${d.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(d){d.coord&&d.dataType==="source"?this._clearRenderCacheForTile(d.sourceCacheId,d.coord):d.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const d in this._style._sourceCaches)this._style._sourceCaches[d].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(d=>d.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const d=2*this.proxySourceCache.getSource().tileSize;return[d,d]}set useVertexMorphing(d){this._useVertexMorphing=d}updateTileBinding(d){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const m=this.proxySourceCache,w=this.painter.transform;this._initializing&&(this._initializing=w._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(w.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const T=this.proxyCoords=m.getIds().map(U=>{const K=m.getTileByID(U).tileID;return K.projMatrix=w.calculateProjMatrix(K.toUnwrapped()),K});(function(U,K){const X=K.transform.pointCoordinate(K.transform.getCameraPoint()),Q=new s.Point(X.x,X.y);U.sort((le,he)=>{if(he.overscaledZ-le.overscaledZ)return he.overscaledZ-le.overscaledZ;const pe=new s.Point(le.canonical.x+(1<<le.canonical.z)*le.wrap,le.canonical.y),fe=new s.Point(he.canonical.x+(1<<he.canonical.z)*he.wrap,he.canonical.y),ge=Q.mult(1<<le.canonical.z);return ge.x-=.5,ge.y-=.5,ge.distSqr(pe)-ge.distSqr(fe)})})(T,this.painter),this._previousZoom=w.zoom;const P=this.proxyToSource||{};this.proxyToSource={},T.forEach(U=>{this.proxyToSource[U.key]={}}),this.terrainTileForTile={};const D=this._style._sourceCaches;for(const U in D){const K=D[U];if(!K.used||(K!==this.sourceCache&&this.resetTileLookupCache(K.id),this._setupProxiedCoordsForOrtho(K,d[U],P),K.usedForTerrain))continue;const X=d[U];K.getSource().reparseOverscaled&&this._assignTerrainTiles(X)}this.proxiedCoords[m.id]=T.map(U=>new zf(U,U.key,this.orthoMatrix)),this._assignTerrainTiles(T),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(P),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const z={};this._visibleDemTiles=[];for(const U of this.proxyCoords){const K=this.terrainTileForTile[U.key];if(!K)continue;const X=K.tileID.key;X in z||(this._visibleDemTiles.push(K),z[X]=X)}}_assignTerrainTiles(d){this._initializing||d.forEach(m=>{if(this.terrainTileForTile[m.key])return;const w=this._findTileCoveringTileID(m,this.sourceCache);w&&(this.terrainTileForTile[m.key]=w)})}_prepareDEMTextures(){const d=this.painter.context,m=d.gl;for(const w in this.terrainTileForTile){const T=this.terrainTileForTile[w],P=T.dem;!P||T.demTexture&&!T.needsDEMTextureUpload||(d.activeTexture.set(m.TEXTURE1),Qg(this.painter,T,P))}}_prepareDemTileUniforms(d,m,w,T){if(!m||m.demTexture==null)return!1;const P=d.tileID.canonical,D=Math.pow(2,m.tileID.canonical.z-P.z),z=T||"";return w[`u_dem_tl${z}`]=[P.x*D%1,P.y*D%1],w[`u_dem_scale${z}`]=D,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const d=this.painter.context,m=d.gl;if(!this._emptyDepthBufferTexture){const w=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(d,w,m.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let d=0;const m=this._visibleDemTiles.reduce((w,T)=>{if(!T.dem)return w;const P=T.dem.tree.minimums[0];return P>0&&d++,w+P},0);return d?m/d:0}_updateEmptyDEMTexture(){const d=this.painter.context,m=d.gl;d.activeTexture.set(m.TEXTURE2);const w=this._getLoadedAreaMinimum(),T=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(w,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let P=this._emptyDEMTexture;return P?P.update(T,{premultiply:!1}):P=this._emptyDEMTexture=new s.Texture(d,T,m.RGBA,{premultiply:!1}),P}setupElevationDraw(d,m,w){const T=this.painter.context,P=T.gl,D=(z=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(z),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var z;D.u_dem_size=this.sourceCache.getSource().tileSize,D.u_exaggeration=this.exaggeration();let U=null,K=null,X=1;if(w&&w.morphing&&this._useVertexMorphing){const Q=w.morphing.srcDemTile,le=w.morphing.dstDemTile;X=w.morphing.phase,Q&&le&&(this._prepareDemTileUniforms(d,Q,D,"_prev")&&(K=Q),this._prepareDemTileUniforms(d,le,D)&&(U=le))}if(K&&U?(T.activeTexture.set(P.TEXTURE2),U.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE,P.NEAREST),T.activeTexture.set(P.TEXTURE4),K.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE,P.NEAREST),D.u_dem_lerp=X):(U=this.terrainTileForTile[d.tileID.key],T.activeTexture.set(P.TEXTURE2),(this._prepareDemTileUniforms(d,U,D)?U.demTexture:this.emptyDEMTexture).bind(P.NEAREST,P.CLAMP_TO_EDGE)),T.activeTexture.set(P.TEXTURE3),w&&w.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),this._depthFBO&&(D.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),D.u_depth_size_inv=[1,1]),w&&w.useMeterToDem&&U){const Q=(1<<U.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;D.u_meter_to_dem=Q}if(w&&w.labelPlaneMatrixInv&&(D.u_label_plane_matrix_inv=w.labelPlaneMatrixInv),m.setTerrainUniformValues(T,D),this.painter.transform.projection.name==="globe"){const Q=this.globeUniformValues(this.painter.transform,d.tileID.canonical,w&&w.useDenormalizedUpVectorScale);m.setGlobeUniformValues(T,Q)}}globeUniformValues(d,m,w){const T=d.projection;return{u_tile_tl_up:T.upVector(m,0,0),u_tile_tr_up:T.upVector(m,s.EXTENT,0),u_tile_br_up:T.upVector(m,s.EXTENT,s.EXTENT),u_tile_bl_up:T.upVector(m,0,s.EXTENT),u_tile_up_scale:w?s.globeMetersToEcef(1):T.upVectorScale(m,d.center.lat,d.worldSize).metersToTile}}renderToBackBuffer(d){const m=this.painter,w=this.painter.context;d.length!==0&&(w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height]),m.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(T,P,D,z,U){if(T.transform.projection.name==="globe")(function(K,X,Q,le,he){const pe=K.context,fe=pe.gl;let ge,ee;const de=K.options.showTerrainWireframe?2:0,we=K.transform,Se=s.globeUseCustomAntiAliasing(K,pe,we),Re=(_t,Ke)=>{if(ee===_t)return;const dt=[tc[_t],"PROJECTION_GLOBE_VIEW"];Se&&dt.push("CUSTOM_ANTIALIASING"),Ke&&dt.push(tc[de]),ge=K.useProgram("globeRaster",null,dt),ee=_t},Le=K.colorModeForRenderPass(),De=new s.DepthMode(fe.LEQUAL,s.DepthMode.ReadWrite,K.depthRangeFor3D);No.update(he);const Ue=s.calculateGlobeMercatorMatrix(we),Fe=[s.mercatorXfromLng(we.center.lng),s.mercatorYfromLat(we.center.lat)],Ze=de?[!1,!0]:[!1],wt=K.globeSharedBuffers,He=[we.width*s.exported.devicePixelRatio,we.height*s.exported.devicePixelRatio],ht=Float32Array.from(we.globeMatrix),Je={useDenormalizedUpVectorScale:!0};if(Ze.forEach(_t=>{const Ke=K.transform,dt=Lf(Ke.zoom)*X.exaggeration();ee=-1;const Et=_t?fe.LINES:fe.TRIANGLES;for(const yt of le){const jt=Q.getTile(yt),Jt=s.StencilMode.disabled,lr=X.prevTerrainTileForTile[yt.key],Wt=X.terrainTileForTile[yt.key];uu(lr,Wt)&&No.newMorphing(yt.key,lr,Wt,he,250),pe.activeTexture.set(fe.TEXTURE0),jt.texture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);const sr=No.getMorphValuesForProxy(yt.key),jr=sr?1:0;sr&&s.extend$1(Je,{morphing:{srcDemTile:sr.from,dstDemTile:sr.to,phase:s.easeCubicInOut(sr.phase)}});const wr=s.tileCornersToBounds(yt.canonical),Yt=s.getLatitudinalLod(wr.getCenter().lat),Xr=s.getGridMatrix(yt.canonical,wr,Yt,Ke.worldSize/Ke._pixelsPerMercatorPixel),rn=s.globeNormalizeECEF(s.globeTileBounds(yt.canonical)),nn=Df(Ke.projMatrix,ht,Ue,rn,s.globeToMercatorTransition(Ke.zoom),Fe,Ke.frustumCorners.TL,Ke.frustumCorners.TR,Ke.frustumCorners.BR,Ke.frustumCorners.BL,Ke.globeCenterInViewSpace,Ke.globeRadius,He,dt,Xr);if(Re(jr,_t),X.setupElevationDraw(jt,ge,Je),K.prepareDrawProgram(pe,ge,yt.toUnwrapped()),wt){const[sn,Xi,wi]=_t?wt.getWirefameBuffers(K.context,Yt):wt.getGridBuffers(Yt,dt!==0);ge.draw(pe,Et,De,Jt,Le,s.CullFaceMode.backCCW,nn,"globe_raster",sn,Xi,wi)}}}),wt){const _t=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Se&&_t.push("CUSTOM_ANTIALIASING"),ge=K.useProgram("globeRaster",null,_t);for(const Ke of le){const{x:dt,y:Et,z:yt}=Ke.canonical,jt=Et===0,Jt=Et===(1<<yt)-1,[lr,Wt,sr,jr]=wt.getPoleBuffers(yt);if(jr&&(jt||Jt)){const wr=Q.getTile(Ke);pe.activeTexture.set(fe.TEXTURE0),wr.texture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);let Yt=s.globePoleMatrixForTile(yt,dt,we);const Xr=s.globeNormalizeECEF(s.globeTileBounds(Ke.canonical)),rn=(nn,sn)=>nn.draw(pe,fe.TRIANGLES,De,s.StencilMode.disabled,Le,s.CullFaceMode.disabled,Df(we.projMatrix,Yt,Yt,Xr,0,Fe,we.frustumCorners.TL,we.frustumCorners.TR,we.frustumCorners.BR,we.frustumCorners.BL,we.globeCenterInViewSpace,we.globeRadius,He,0),"globe_pole_raster",sn,sr,jr);X.setupElevationDraw(wr,ge,Je),K.prepareDrawProgram(pe,ge,Ke.toUnwrapped()),jt&&rn(ge,lr),Jt&&(Yt=s.scale(s.create(),Yt,[1,-1,1]),rn(ge,Wt))}}}})(T,P,D,z,U);else{const K=T.context,X=K.gl;let Q,le;const he=T.options.showTerrainWireframe?2:0,pe=(we,Se)=>{if(le===we)return;const Re=[tc[we]];Se&&Re.push(tc[he]),Q=T.useProgram("terrainRaster",null,Re),le=we},fe=T.colorModeForRenderPass(),ge=new s.DepthMode(X.LEQUAL,s.DepthMode.ReadWrite,T.depthRangeFor3D);No.update(U);const ee=T.transform,de=Lf(ee.zoom)*P.exaggeration();(he?[!1,!0]:[!1]).forEach(we=>{le=-1;const Se=we?X.LINES:X.TRIANGLES,[Re,Le]=we?P.getWirefameBuffer():[P.gridIndexBuffer,P.gridSegments];for(const De of z){const Ue=D.getTile(De),Fe=s.StencilMode.disabled,Ze=P.prevTerrainTileForTile[De.key],wt=P.terrainTileForTile[De.key];uu(Ze,wt)&&No.newMorphing(De.key,Ze,wt,U,250),K.activeTexture.set(X.TEXTURE0),Ue.texture.bind(X.LINEAR,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST);const He=No.getMorphValuesForProxy(De.key),ht=He?1:0;let Je;He&&(Je={morphing:{srcDemTile:He.from,dstDemTile:He.to,phase:s.easeCubicInOut(He.phase)}});const _t=cu(De.projMatrix,vb(De.canonical,ee.renderWorldCopies)?de/10:de);pe(ht,we),P.setupElevationDraw(Ue,Q,Je),T.prepareDrawProgram(K,Q,De.toUnwrapped()),Q.draw(K,Se,ge,Fe,fe,s.CullFaceMode.backCCW,_t,"terrain_raster",P.gridBuffer,Re,Le)}})}}(m,this,this.proxySourceCache,d,this._updateTimestamp),this.renderingToTexture=!0,m.gpuTimingDeferredRenderEnd(),d.splice(0,d.length))}renderBatch(d){if(this._drapedRenderBatches.length===0)return d+1;this.renderingToTexture=!0;const m=this.painter,w=this.painter.context,T=this.proxySourceCache,P=this.proxiedCoords[T.id],D=this._drapedRenderBatches.shift(),z=[],U=m.style.order;let K=0;for(const X of P){const Q=T.getTileByID(X.proxyTileKey),le=T.proxyCachedFBO[X.key]?T.proxyCachedFBO[X.key][d]:void 0,he=le!==void 0?T.renderCache[le]:this.pool[K++],pe=le!==void 0;if(Q.texture=he.tex,pe&&!he.dirty){z.push(Q.tileID);continue}let fe;w.bindFramebuffer.set(he.fb.framebuffer),this.renderedToTile=!1,he.dirty&&(w.clear({color:s.Color.transparent,stencil:0}),he.dirty=!1);for(let ge=D.start;ge<=D.end;++ge){const ee=m.style._layers[U[ge]];if(ee.isHidden(m.transform.zoom))continue;const de=m.style._getLayerSourceCache(ee),we=de?this.proxyToSource[X.key][de.id]:[X];if(!we)continue;const Se=we;w.viewport.set([0,0,he.fb.width,he.fb.height]),fe!==(de?de.id:null)&&(this._setupStencil(he,we,ee,de),fe=de?de.id:null),m.renderLayer(m,de,ee,Se)}this.renderedToTile?(he.dirty=!0,z.push(Q.tileID)):pe||--K,K===5&&(K=0,this.renderToBackBuffer(z))}return this.renderToBackBuffer(z),this.renderingToTexture=!1,w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height]),D.end+1}postRender(){}renderCacheEfficiency(d){const m=d.order.length;if(m===0)return{efficiency:100};let w,T=0,P=0,D=!1;for(let z=0;z<m;++z){const U=d._layers[d.order[z]];this._style.isLayerDraped(U)?(D&&++T,++P):D||(D=!0,w=U.id)}return P===0?{efficiency:100}:{efficiency:100*(1-T/P),firstUndrapedLayer:w}}getMinElevationBelowMSL(){let d=0;return this._visibleDemTiles.filter(m=>m.dem).forEach(m=>{d=Math.min(d,m.dem.tree.minimums[0])}),d===0?d:(d-30)*this._exaggeration}raycast(d,m,w){if(!this._visibleDemTiles)return null;const T=this._visibleDemTiles.filter(P=>P.dem).map(P=>{const D=P.tileID,z=1<<D.overscaledZ,{x:U,y:K}=D.canonical,X=U/z,Q=(U+1)/z,le=K/z,he=(K+1)/z;return{minx:X,miny:le,maxx:Q,maxy:he,t:P.dem.tree.raycastRoot(X,le,Q,he,d,m,w),tile:P}});T.sort((P,D)=>(P.t!==null?P.t:Number.MAX_VALUE)-(D.t!==null?D.t:Number.MAX_VALUE));for(const P of T){if(P.t==null)return null;const D=P.tile.dem.tree.raycast(P.minx,P.miny,P.maxx,P.maxy,d,m,w);if(D!=null)return D}return null}_createFBO(){const d=this.painter.context,m=d.gl,w=this.drapeBufferSize;d.activeTexture.set(m.TEXTURE0);const T=new s.Texture(d,{width:w[0],height:w[1],data:null},m.RGBA);T.bind(m.LINEAR,m.CLAMP_TO_EDGE);const P=d.createFramebuffer(w[0],w[1],!1);return P.colorAttachment.set(T.texture),P.depthAttachment=new ze(d,P.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=d.createRenderbuffer(d.gl.DEPTH_STENCIL,w[0],w[1]),this._stencilRef=0,P.depthAttachment.set(this._sharedDepthStencil),d.clear({stencil:0})):P.depthAttachment.set(this._sharedDepthStencil),d.extTextureFilterAnisotropic&&!d.extTextureFilterAnisotropicForceOff&&m.texParameterf(m.TEXTURE_2D,d.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,d.extTextureFilterAnisotropicMax),{fb:P,tex:T,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const d in this._style._sourceCaches)if(this._style._sourceCaches[d].hasTransition())return!0;return this._style.order.some(d=>{const m=this._style._layers[d],w=m.isHidden(this.painter.transform.zoom);return m.type==="custom"?!w&&m.shouldRedrape():!w&&m.hasTransition()})}_clearLineLayersFromRenderCache(){let d=!1;for(const w of this._style._getSources())if(w instanceof Ot){d=!0;break}if(!d)return;const m={};for(let w=0;w<this._style.order.length;++w){const T=this._style._layers[this._style.order[w]],P=this._style._getLayerSourceCache(T);if(P&&!m[P.id]&&!T.isHidden(this.painter.transform.zoom)&&T.type==="line"&&T.widthExpression()instanceof s.ZoomDependentExpression){m[P.id]=!0;for(const D of this.proxyCoords){const z=this.proxyToSource[D.key][P.id];if(z)for(const U of z)this._clearRenderCacheForTile(P.id,U)}}}}_clearRasterLayersFromRenderCache(){let d=!1;for(const w in this._style._sourceCaches)if(this._style._sourceCaches[w]._source instanceof Ct){d=!0;break}if(!d)return;const m={};for(let w=0;w<this._style.order.length;++w){const T=this._style._layers[this._style.order[w]],P=this._style._getLayerSourceCache(T);if(!P||m[P.id]||T.isHidden(this.painter.transform.zoom)||T.type!=="raster")continue;const D=T.paint.get("raster-fade-duration");for(const z of this.proxyCoords){const U=this.proxyToSource[z.key][P.id];if(U)for(const K of U){const X=ty(P.getTile(K),P.findLoadedParent(K,0),P,this.painter.transform,D);(X.opacity!==1||X.mix!==0)&&this._clearRenderCacheForTile(P.id,K)}}}}_setupDrapedRenderBatches(){const d=this._style.order,m=d.length;if(m===0)return;const w=[];let T,P=0,D=this._style._layers[d[P]];for(;!this._style.isLayerDraped(D)&&D.isHidden(this.painter.transform.zoom)&&++P<m;)D=this._style._layers[d[P]];for(;P<m;++P){const z=this._style._layers[d[P]];z.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(z)?T===void 0&&(T=P):T!==void 0&&(w.push({start:T,end:P-1}),T=void 0))}T!==void 0&&w.push({start:T,end:P-1}),this._drapedRenderBatches=w}_setupRenderCache(d){const m=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,m.renderCache.length>m.renderCachePool.length){const D=Object.values(m.proxyCachedFBO);m.proxyCachedFBO={};for(let z=0;z<D.length;++z){const U=Object.values(D[z]);m.renderCachePool.push(...U)}}return}this._clearRasterLayersFromRenderCache();const w=this.proxyCoords,T=this._tilesDirty;for(let D=w.length-1;D>=0;D--){const z=w[D];if(m.getTileByID(z.key),m.proxyCachedFBO[z.key]!==void 0){const U=d[z.key],K=this.proxyToSource[z.key];let X=0;for(const Q in K){const le=K[Q],he=U[Q];if(!he||he.length!==le.length||le.some((pe,fe)=>pe!==he[fe]||T[Q]&&T[Q].hasOwnProperty(pe.key))){X=-1;break}++X}for(const Q in m.proxyCachedFBO[z.key])m.renderCache[m.proxyCachedFBO[z.key][Q]].dirty=X<0||X!==Object.values(U).length}}const P=[...this._drapedRenderBatches];P.sort((D,z)=>z.end-z.start-(D.end-D.start));for(const D of P)for(const z of w){if(m.proxyCachedFBO[z.key])continue;let U=m.renderCachePool.pop();U===void 0&&m.renderCache.length<50&&(U=m.renderCache.length,m.renderCache.push(this._createFBO())),U!==void 0&&(m.proxyCachedFBO[z.key]={},m.proxyCachedFBO[z.key][D.start]=U,m.renderCache[U].dirty=!0)}this._tilesDirty={}}_setupStencil(d,m,w,T){if(!T||!this._sourceTilesOverlap[T.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const P=this.painter.context,D=P.gl;if(m.length<=1)return void(this._overlapStencilType=!1);let z;if(w.isTileClipped())z=m.length,this._overlapStencilMode.test={func:D.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(m[0].overscaledZ>m[m.length-1].overscaledZ))return void(this._overlapStencilType=!1);z=1,this._overlapStencilMode.test={func:D.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+z>255&&(P.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=z,this._overlapStencilMode.ref=this._stencilRef,w.isTileClipped()&&this._renderTileClippingMasks(m,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(d){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[d.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(d,m){const w=this.painter,T=this.painter.context,P=T.gl;w._tileClippingMaskIDs={},T.setColorMode(s.ColorMode.disabled),T.setDepthMode(s.DepthMode.disabled);const D=w.useProgram("clippingMask");for(const z of d){const U=w._tileClippingMaskIDs[z.key]=--m;D.draw(T,P.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:P.ALWAYS,mask:0},U,255,P.KEEP,P.KEEP,P.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Xd(z.projMatrix),"$clipping",w.tileExtentBuffer,w.quadTriangleIndexBuffer,w.tileExtentSegments)}}pointCoordinate(d){const m=this.painter.transform;if(d.x<0||d.x>m.width||d.y<0||d.y>m.height)return null;const w=[d.x,d.y,1,1];s.transformMat4$1(w,w,m.pixelMatrixInverse),s.scale$1(w,w,1/w[3]),w[0]/=m.worldSize,w[1]/=m.worldSize;const T=m._camera.position,P=s.mercatorZfromAltitude(1,m.center.lat),D=[T[0],T[1],T[2]/P,0],z=s.subtract([],w.slice(0,3),D);s.normalize(z,z);const U=this.raycast(D,z,this._exaggeration);return U!==null&&U?(s.scaleAndAdd(D,D,z,U),D[3]=D[2],D[2]*=P,D):null}drawDepth(){const d=this.painter,m=d.context,w=this.proxySourceCache,T=Math.ceil(d.width),P=Math.ceil(d.height);if(!this._depthFBO||this._depthFBO.width===T&&this._depthFBO.height===P||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const D=m.gl,z=m.createFramebuffer(T,P,!0);m.activeTexture.set(D.TEXTURE0);const U=new s.Texture(m,{width:T,height:P,data:null},D.RGBA);U.bind(D.NEAREST,D.CLAMP_TO_EDGE),z.colorAttachment.set(U.texture);const K=m.createRenderbuffer(m.gl.DEPTH_COMPONENT16,T,P);z.depthAttachment.set(K),this._depthFBO=z,this._depthTexture=U}m.bindFramebuffer.set(this._depthFBO.framebuffer),m.viewport.set([0,0,T,P]),function(D,z,U,K){if(D.transform.projection.name==="globe")return;const X=D.context,Q=X.gl;X.clear({depth:1});const le=D.useProgram("terrainDepth"),he=new s.DepthMode(Q.LESS,s.DepthMode.ReadWrite,D.depthRangeFor3D);for(const pe of K){const fe=U.getTile(pe),ge=cu(pe.projMatrix,0);z.setupElevationDraw(fe,le),le.draw(X,Q.TRIANGLES,he,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,ge,"terrain_depth",z.gridBuffer,z.gridIndexBuffer,z.gridNoSkirtSegments)}}(d,this,w,this.proxyCoords)}_setupProxiedCoordsForOrtho(d,m,w){if(d.getSource()instanceof br)return this._setupProxiedCoordsForImageSource(d,m,w);this._findCoveringTileCache[d.id]=this._findCoveringTileCache[d.id]||{};const T=this.proxiedCoords[d.id]=[],P=this.proxyCoords;for(let z=0;z<P.length;z++){const U=P[z],K=this._findTileCoveringTileID(U,d);if(K){const X=this._createProxiedId(U,K,w[U.key]&&w[U.key][d.id]);T.push(X),this.proxyToSource[U.key][d.id]=[X]}}let D=!1;for(let z=0;z<m.length;z++){const U=d.getTile(m[z]);if(!U||!U.hasData())continue;const K=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if(K&&K.tileID.canonical.z!==U.tileID.canonical.z){const X=this.proxyToSource[K.tileID.key][d.id],Q=this._createProxiedId(K.tileID,U,w[K.tileID.key]&&w[K.tileID.key][d.id]);X?X.splice(X.length-1,0,Q):this.proxyToSource[K.tileID.key][d.id]=[Q],T.push(Q),D=!0}}this._sourceTilesOverlap[d.id]=D}_setupProxiedCoordsForImageSource(d,m,w){if(!d.getSource().loaded())return;const T=this.proxiedCoords[d.id]=[],P=this.proxyCoords,D=d.getSource(),z=new s.Point(D.tileID.x,D.tileID.y)._div(1<<D.tileID.z),U=D.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((X,Q)=>(X.min.x=Math.min(X.min.x,Q.x-z.x),X.min.y=Math.min(X.min.y,Q.y-z.y),X.max.x=Math.max(X.max.x,Q.x-z.x),X.max.y=Math.max(X.max.y,Q.y-z.y),X),{min:new s.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),K=(X,Q)=>{const le=X.wrap+X.canonical.x/(1<<X.canonical.z),he=X.canonical.y/(1<<X.canonical.z),pe=s.EXTENT/(1<<X.canonical.z),fe=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),ge=Q.canonical.y/(1<<Q.canonical.z);return le+pe<fe+U.min.x||le>fe+U.max.x||he+pe<ge+U.min.y||he>ge+U.max.y};for(let X=0;X<P.length;X++){const Q=P[X];for(let le=0;le<m.length;le++){const he=d.getTile(m[le]);if(!he||!he.hasData()||K(Q,he.tileID))continue;const pe=this._createProxiedId(Q,he,w[Q.key]&&w[Q.key][d.id]),fe=this.proxyToSource[Q.key][d.id];fe?fe.push(pe):this.proxyToSource[Q.key][d.id]=[pe],T.push(pe)}}}_createProxiedId(d,m,w){let T=this.orthoMatrix;if(w){const P=w.find(D=>D.key===m.tileID.key);if(P)return P}if(m.tileID.key!==d.key){const P=d.canonical.z-m.tileID.canonical.z;let D,z,U;T=s.create();const K=m.tileID.wrap-d.wrap<<d.overscaledZ;P>0?(D=s.EXTENT>>P,z=D*((m.tileID.canonical.x<<P)-d.canonical.x+K),U=D*((m.tileID.canonical.y<<P)-d.canonical.y)):(D=s.EXTENT<<-P,z=s.EXTENT*(m.tileID.canonical.x-(d.canonical.x+K<<-P)),U=s.EXTENT*(m.tileID.canonical.y-(d.canonical.y<<-P))),s.ortho(T,0,D,0,D,0,1),s.translate(T,T,[z,U,0])}return new zf(m.tileID,d.key,T)}_findTileCoveringTileID(d,m){let w=m.getTile(d);if(w&&w.hasData())return w;const T=this._findCoveringTileCache[m.id],P=T[d.key];if(w=P?m.getTileByID(P):null,w&&w.hasData()||P===null)return w;let D=w?w.tileID:d,z=D.overscaledZ;const U=m.getSource().minzoom,K=[];if(!P){const Q=m.getSource().maxzoom;if(d.canonical.z>=Q){const le=d.canonical.z-Q;m.getSource().reparseOverscaled?(z=Math.max(d.canonical.z+2,m.transform.tileZoom),D=new s.OverscaledTileID(z,d.wrap,Q,d.canonical.x>>le,d.canonical.y>>le)):le!==0&&(z=Q,D=new s.OverscaledTileID(z,d.wrap,Q,d.canonical.x>>le,d.canonical.y>>le))}D.key!==d.key&&(K.push(D.key),w=m.getTile(D))}const X=Q=>{K.forEach(le=>{T[le]=Q}),K.length=0};for(z-=1;z>=U&&(!w||!w.hasData());z--){w&&X(w.tileID.key);const Q=D.calculateScaledKey(z);if(w=m.getTileByID(Q),w&&w.hasData())break;const le=T[Q];if(le===null)break;le===void 0?K.push(Q):w=m.getTileByID(le)}return X(w?w.tileID.key:null),w&&w.hasData()?w:null}findDEMTileFor(d){return this.enabled?this._findTileCoveringTileID(d,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(d,m){let w=this._tilesDirty[d];w||(w=this._tilesDirty[d]={}),w[m.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const d=function(m){let w=0;const T=new s.StructArrayLayout2ui4,P=131;for(let D=1;D<129;D++){for(let z=1;z<129;z++)w=D*P+z,T.emplaceBack(w,w+1),T.emplaceBack(w,w+P),T.emplaceBack(w+1,w+P),D===128&&T.emplaceBack(w+P,w+P+1);T.emplaceBack(w+1,w+1+P)}return T}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(d),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,d.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Or{static cacheKey(d,m,w,T){let P=`${m}${T?T.cacheKey:""}`;for(const D of w)d.usedDefines.includes(D)&&(P+=`/${D}`);return P}constructor(d,m,w,T,P,D){const z=d.gl;this.program=z.createProgram();const U=function(ee){const de=[];for(let we=0;we<ee.length;we++){if(ee[we]===null)continue;const Se=ee[we].split(" ");de.push(Se.pop())}return de}(w.staticAttributes),K=T?T.getBinderAttributes():[],X=U.concat(K);let Q=T?T.defines():[];Q=Q.concat(D.map(ee=>`#define ${ee}`));const le=d.isWebGL2?`#version 300 es
`:"",he=le+Q.concat(d.extStandardDerivatives&&le.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Zg):Zg,Zg,Rf,mb.fragmentSource,ou.fragmentSource,w.fragmentSource).join(`
`),pe=le+Q.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Rf,mb.vertexSource,ou.vertexSource,Of.vertexSource,w.vertexSource).join(`
`),fe=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);z.shaderSource(fe,he),z.compileShader(fe),z.attachShader(this.program,fe);const ge=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())this.failedToCreate=!0;else{z.shaderSource(ge,pe),z.compileShader(ge),z.attachShader(this.program,ge),this.attributes={},this.numAttributes=X.length;for(let ee=0;ee<this.numAttributes;ee++)X[ee]&&(z.bindAttribLocation(this.program,ee,X[ee]),this.attributes[X[ee]]=ee);z.linkProgram(this.program),z.deleteShader(ge),z.deleteShader(fe),this.fixedUniforms=P(d),this.binderUniforms=T?T.getUniforms(d):[],D.includes("TERRAIN")&&(this.terrainUniforms=(ee=>({u_dem:new s.Uniform1i(ee),u_dem_prev:new s.Uniform1i(ee),u_dem_unpack:new s.Uniform4f(ee),u_dem_tl:new s.Uniform2f(ee),u_dem_scale:new s.Uniform1f(ee),u_dem_tl_prev:new s.Uniform2f(ee),u_dem_scale_prev:new s.Uniform1f(ee),u_dem_size:new s.Uniform1f(ee),u_dem_lerp:new s.Uniform1f(ee),u_exaggeration:new s.Uniform1f(ee),u_depth:new s.Uniform1i(ee),u_depth_size_inv:new s.Uniform2f(ee),u_meter_to_dem:new s.Uniform1f(ee),u_label_plane_matrix_inv:new s.UniformMatrix4f(ee)}))(d)),D.includes("GLOBE")&&(this.globeUniforms=(ee=>({u_tile_tl_up:new s.Uniform3f(ee),u_tile_tr_up:new s.Uniform3f(ee),u_tile_br_up:new s.Uniform3f(ee),u_tile_bl_up:new s.Uniform3f(ee),u_tile_up_scale:new s.Uniform1f(ee)}))(d)),D.includes("FOG")&&(this.fogUniforms=(ee=>({u_fog_matrix:new s.UniformMatrix4f(ee),u_fog_range:new s.Uniform2f(ee),u_fog_color:new s.Uniform4f(ee),u_fog_horizon_blend:new s.Uniform1f(ee),u_fog_temporal_offset:new s.Uniform1f(ee),u_frustum_tl:new s.Uniform3f(ee),u_frustum_tr:new s.Uniform3f(ee),u_frustum_br:new s.Uniform3f(ee),u_frustum_bl:new s.Uniform3f(ee),u_globe_pos:new s.Uniform3f(ee),u_globe_radius:new s.Uniform1f(ee),u_globe_transition:new s.Uniform1f(ee),u_is_globe:new s.Uniform1i(ee),u_viewport:new s.Uniform2f(ee)}))(d))}}setTerrainUniformValues(d,m){if(!this.terrainUniforms)return;const w=this.terrainUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const T in m)w[T]&&w[T].set(this.program,T,m[T])}}setGlobeUniformValues(d,m){if(!this.globeUniforms)return;const w=this.globeUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const T in m)w[T]&&w[T].set(this.program,T,m[T])}}setFogUniformValues(d,m){if(!this.fogUniforms)return;const w=this.fogUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const T in m)w[T].set(this.program,T,m[T])}}draw(d,m,w,T,P,D,z,U,K,X,Q,le,he,pe,fe){const ge=d.gl;if(this.failedToCreate)return;d.program.set(this.program),d.setDepthMode(w),d.setStencilMode(T),d.setColorMode(P),d.setCullFace(D);for(const de of Object.keys(this.fixedUniforms))this.fixedUniforms[de].set(this.program,de,z[de]);pe&&pe.setUniforms(this.program,d,this.binderUniforms,le,{zoom:he});const ee={[ge.LINES]:2,[ge.TRIANGLES]:3,[ge.LINE_STRIP]:1}[m];for(const de of Q.get()){const we=de.vaos||(de.vaos={});(we[U]||(we[U]=new H2)).bind(d,this,K,pe?pe.getPaintVertexBuffers():[],X,de.vertexOffset,fe||[]),ge.drawElements(m,de.primitiveLength*ee,ge.UNSIGNED_SHORT,de.primitiveOffset*ee*2)}}}function Kd(v,d){const m=Math.pow(2,d.tileID.overscaledZ),w=d.tileSize*Math.pow(2,v.transform.tileZoom)/m,T=w*(d.tileID.canonical.x+d.tileID.wrap*m),P=w*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_tile_units_to_pixels:1/Be(d,1,v.transform.tileZoom),u_pixel_coord_upper:[T>>16,P>>16],u_pixel_coord_lower:[65535&T,65535&P]}}const xb=s.create(),iy=(v,d,m,w,T,P,D,z,U,K,X)=>{const Q=d.style.light,le=Q.properties.get("position"),he=[le.x,le.y,le.z],pe=s.create$1();Q.properties.get("anchor")==="viewport"&&(s.fromRotation(pe,-d.transform.angle),s.transformMat3(he,he,pe));const fe=Q.properties.get("color"),ge=d.transform,ee={u_matrix:v,u_lightpos:he,u_lightintensity:Q.properties.get("intensity"),u_lightcolor:[fe.r,fe.g,fe.b],u_vertical_gradient:+m,u_opacity:w,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:xb,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:T,u_edge_radius:P};return ge.projection.name==="globe"&&(ee.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],ee.u_zoom_transition=U,ee.u_inv_rot_matrix=X,ee.u_merc_center=K,ee.u_up_dir=ge.projection.upVector(new s.CanonicalTileID(0,0,0),K[0]*s.EXTENT,K[1]*s.EXTENT),ee.u_height_lift=z),ee},bb=(v,d,m,w,T,P,D,z,U,K,X,Q)=>{const le=iy(v,d,m,w,T,P,D,U,K,X,Q),he={u_height_factor:-Math.pow(2,D.overscaledZ)/z.tileSize/8};return s.extend(le,Kd(d,z),he)},rc=v=>({u_matrix:v}),sy=(v,d,m)=>s.extend(rc(v),Kd(d,m)),X2=(v,d)=>({u_matrix:v,u_world:d}),K2=(v,d,m,w)=>s.extend(sy(v,d,m),{u_world:w}),Z2=s.create(),ay=(v,d,m,w,T,P)=>{const D=v.transform,z=D.projection.name==="globe";let U;if(P.paint.get("circle-pitch-alignment")==="map")if(z){const X=s.globePixelsToTileUnits(D.zoom,d.canonical)*D._pixelsPerMercatorPixel;U=Float32Array.from([X,0,0,X])}else U=D.calculatePixelsToTileUnitsMatrix(m);else U=new Float32Array([D.pixelsToGLUnits[0],0,0,D.pixelsToGLUnits[1]]);const K={u_camera_to_center_distance:D.cameraToCenterDistance,u_matrix:v.translatePosMatrix(d.projMatrix,m,P.paint.get("circle-translate"),P.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:U,u_inv_rot_matrix:Z2,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){K.u_inv_rot_matrix=w,K.u_merc_center=T,K.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],K.u_zoom_transition=s.globeToMercatorTransition(D.zoom);const X=T[0]*s.EXTENT,Q=T[1]*s.EXTENT;K.u_up_dir=D.projection.upVector(new s.CanonicalTileID(0,0,0),X,Q)}return K},oy=v=>{const d=[];return v.paint.get("circle-pitch-alignment")==="map"&&d.push("PITCH_WITH_MAP"),v.paint.get("circle-pitch-scale")==="map"&&d.push("SCALE_WITH_MAP"),d},ly=(v,d,m,w)=>{const T=s.EXTENT/m.tileSize;return{u_matrix:v,u_camera_to_center_distance:d.getCameraToCenterDistance(w),u_extrude_scale:[d.pixelsToGLUnits[0]/T,d.pixelsToGLUnits[1]/T]}},$f=(v,d,m=1)=>({u_matrix:v,u_color:d,u_overlay:0,u_overlay_scale:m}),_b=s.create(),wb=(v,d,m,w,T,P,D)=>{const z=v.transform,U=z.projection.name==="globe",K=U?s.globePixelsToTileUnits(z.zoom,d.canonical)*z._pixelsPerMercatorPixel:Be(m,1,P),X={u_matrix:d.projMatrix,u_extrude_scale:K,u_intensity:D,u_inv_rot_matrix:_b,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(U){X.u_inv_rot_matrix=w,X.u_merc_center=T,X.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],X.u_zoom_transition=s.globeToMercatorTransition(z.zoom);const Q=T[0]*s.EXTENT,le=T[1]*s.EXTENT;X.u_up_dir=z.projection.upVector(new s.CanonicalTileID(0,0,0),Q,le)}return X},Y2=(v,d,m,w,T,P,D)=>{const z=v.transform,U=z.calculatePixelsToTileUnitsMatrix(d);return{u_matrix:cy(v,d,m,w),u_pixels_to_tile_units:U,u_device_pixel_ratio:P,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:T,u_texsize:Yd(m)?d.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:du(d,v.transform),u_alpha_discard_threshold:0,u_trim_offset:D}},Zd=(v,d,m,w,T)=>{const P=v.transform;return{u_matrix:cy(v,d,m,w),u_texsize:d.imageAtlasTexture.size,u_pixels_to_tile_units:P.calculatePixelsToTileUnitsMatrix(d),u_device_pixel_ratio:T,u_image:0,u_tile_units_to_pixels:du(d,P),u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function du(v,d){return 1/Be(v,1,d.tileZoom)}function cy(v,d,m,w){return v.translatePosMatrix(w||d.tileID.projMatrix,d,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}function Yd(v){const d=v.paint.get("line-dasharray").value;return d.value||d.kind!=="constant"}const uy=(v,d,m,w,T,P)=>{return{u_matrix:v,u_tl_parent:d,u_scale_parent:m,u_fade_t:w.mix,u_opacity:w.opacity*T.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:T.paint.get("raster-brightness-min"),u_brightness_high:T.paint.get("raster-brightness-max"),u_saturation_factor:(z=T.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(D=T.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:Ha(T.paint.get("raster-hue-rotate")),u_perspective_transform:P};var D,z};function Ha(v){v*=Math.PI/180;const d=Math.sin(v),m=Math.cos(v);return[(2*m+1)/3,(-Math.sqrt(3)*d-m+1)/3,(Math.sqrt(3)*d-m+1)/3]}const Ff=s.create(),dy=(v,d,m,w,T,P,D,z,U,K,X,Q,le,he,pe,fe)=>{const ge=T.transform,ee={u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:d?d.uSizeT:0,u_size:d?d.uSize:0,u_camera_to_center_distance:ge.cameraToCenterDistance,u_rotate_symbol:+m,u_aspect_ratio:ge.width/ge.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:D,u_coord_matrix:z,u_is_text:+U,u_pitch_with_map:+w,u_texsize:K,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ff,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ff,u_up_vector:[0,-1,0]};return fe.name==="globe"&&(ee.u_tile_id=[X.canonical.x,X.canonical.y,1<<X.canonical.z],ee.u_zoom_transition=Q,ee.u_inv_rot_matrix=he,ee.u_merc_center=le,ee.u_camera_forward=ge._camera.forward(),ee.u_ecef_origin=s.globeECEFOrigin(ge.globeMatrix,X.toUnwrapped()),ee.u_tile_matrix=Float32Array.from(ge.globeMatrix),ee.u_up_vector=pe),ee},Uf=(v,d,m,w,T,P,D,z,U,K,X,Q,le,he,pe,fe,ge)=>s.extend(dy(v,d,m,w,T,P,D,z,U,K,Q,le,he,pe,fe,ge),{u_gamma_scale:w?T.transform.cameraToCenterDistance*Math.cos(T.terrain?0:T.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+X}),Sb=(v,d,m,w,T,P,D,z,U,K,X,Q,le,he,pe,fe)=>s.extend(Uf(v,d,m,w,T,P,D,z,!0,U,!0,X,Q,le,he,pe,fe),{u_texsize_icon:K,u_texture_icon:1}),hy=(v,d,m)=>({u_matrix:v,u_opacity:d,u_color:m}),J2=(v,d,m,w,T)=>s.extend(function(P,D,z){const U=D.imageManager.getPattern(P.toString()),{width:K,height:X}=D.imageManager.getPixelSize(),Q=Math.pow(2,z.tileID.overscaledZ),le=z.tileSize*Math.pow(2,D.transform.tileZoom)/Q,he=le*(z.tileID.canonical.x+z.tileID.wrap*Q),pe=le*z.tileID.canonical.y;return{u_image:0,u_pattern_tl:U.tl,u_pattern_br:U.br,u_texsize:[K,X],u_pattern_size:U.displaySize,u_tile_units_to_pixels:1/Be(z,1,D.transform.tileZoom),u_pixel_coord_upper:[he>>16,pe>>16],u_pixel_coord_lower:[65535&he,65535&pe]}}(w,m,T),{u_matrix:v,u_opacity:d}),fy={fillExtrusion:v=>({u_matrix:new s.UniformMatrix4f(v),u_lightpos:new s.Uniform3f(v),u_lightintensity:new s.Uniform1f(v),u_lightcolor:new s.Uniform3f(v),u_vertical_gradient:new s.Uniform1f(v),u_opacity:new s.Uniform1f(v),u_edge_radius:new s.Uniform1f(v),u_ao:new s.Uniform2f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_up_dir:new s.Uniform3f(v),u_height_lift:new s.Uniform1f(v)}),fillExtrusionPattern:v=>({u_matrix:new s.UniformMatrix4f(v),u_lightpos:new s.Uniform3f(v),u_lightintensity:new s.Uniform1f(v),u_lightcolor:new s.Uniform3f(v),u_vertical_gradient:new s.Uniform1f(v),u_height_factor:new s.Uniform1f(v),u_edge_radius:new s.Uniform1f(v),u_ao:new s.Uniform2f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_up_dir:new s.Uniform3f(v),u_height_lift:new s.Uniform1f(v),u_image:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_pixel_coord_upper:new s.Uniform2f(v),u_pixel_coord_lower:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v),u_opacity:new s.Uniform1f(v)}),fill:v=>({u_matrix:new s.UniformMatrix4f(v)}),fillPattern:v=>({u_matrix:new s.UniformMatrix4f(v),u_image:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_pixel_coord_upper:new s.Uniform2f(v),u_pixel_coord_lower:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v)}),fillOutline:v=>({u_matrix:new s.UniformMatrix4f(v),u_world:new s.Uniform2f(v)}),fillOutlinePattern:v=>({u_matrix:new s.UniformMatrix4f(v),u_world:new s.Uniform2f(v),u_image:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_pixel_coord_upper:new s.Uniform2f(v),u_pixel_coord_lower:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v)}),circle:v=>({u_camera_to_center_distance:new s.Uniform1f(v),u_extrude_scale:new s.UniformMatrix2f(v),u_device_pixel_ratio:new s.Uniform1f(v),u_matrix:new s.UniformMatrix4f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_up_dir:new s.Uniform3f(v)}),collisionBox:v=>({u_matrix:new s.UniformMatrix4f(v),u_camera_to_center_distance:new s.Uniform1f(v),u_extrude_scale:new s.Uniform2f(v)}),collisionCircle:v=>({u_matrix:new s.UniformMatrix4f(v),u_inv_matrix:new s.UniformMatrix4f(v),u_camera_to_center_distance:new s.Uniform1f(v),u_viewport_size:new s.Uniform2f(v)}),debug:v=>({u_color:new s.UniformColor(v),u_matrix:new s.UniformMatrix4f(v),u_overlay:new s.Uniform1i(v),u_overlay_scale:new s.Uniform1f(v)}),clippingMask:v=>({u_matrix:new s.UniformMatrix4f(v)}),heatmap:v=>({u_extrude_scale:new s.Uniform1f(v),u_intensity:new s.Uniform1f(v),u_matrix:new s.UniformMatrix4f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_up_dir:new s.Uniform3f(v)}),heatmapTexture:v=>({u_image:new s.Uniform1i(v),u_color_ramp:new s.Uniform1i(v),u_opacity:new s.Uniform1f(v)}),hillshade:v=>({u_matrix:new s.UniformMatrix4f(v),u_image:new s.Uniform1i(v),u_latrange:new s.Uniform2f(v),u_light:new s.Uniform2f(v),u_shadow:new s.UniformColor(v),u_highlight:new s.UniformColor(v),u_accent:new s.UniformColor(v)}),hillshadePrepare:v=>({u_matrix:new s.UniformMatrix4f(v),u_image:new s.Uniform1i(v),u_dimension:new s.Uniform2f(v),u_zoom:new s.Uniform1f(v),u_unpack:new s.Uniform4f(v)}),line:v=>({u_matrix:new s.UniformMatrix4f(v),u_pixels_to_tile_units:new s.UniformMatrix2f(v),u_device_pixel_ratio:new s.Uniform1f(v),u_units_to_pixels:new s.Uniform2f(v),u_dash_image:new s.Uniform1i(v),u_gradient_image:new s.Uniform1i(v),u_image_height:new s.Uniform1f(v),u_texsize:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v),u_alpha_discard_threshold:new s.Uniform1f(v),u_trim_offset:new s.Uniform2f(v)}),linePattern:v=>({u_matrix:new s.UniformMatrix4f(v),u_texsize:new s.Uniform2f(v),u_pixels_to_tile_units:new s.UniformMatrix2f(v),u_device_pixel_ratio:new s.Uniform1f(v),u_image:new s.Uniform1i(v),u_units_to_pixels:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v),u_alpha_discard_threshold:new s.Uniform1f(v)}),raster:v=>({u_matrix:new s.UniformMatrix4f(v),u_tl_parent:new s.Uniform2f(v),u_scale_parent:new s.Uniform1f(v),u_fade_t:new s.Uniform1f(v),u_opacity:new s.Uniform1f(v),u_image0:new s.Uniform1i(v),u_image1:new s.Uniform1i(v),u_brightness_low:new s.Uniform1f(v),u_brightness_high:new s.Uniform1f(v),u_saturation_factor:new s.Uniform1f(v),u_contrast_factor:new s.Uniform1f(v),u_spin_weights:new s.Uniform3f(v),u_perspective_transform:new s.Uniform2f(v)}),symbolIcon:v=>({u_is_size_zoom_constant:new s.Uniform1i(v),u_is_size_feature_constant:new s.Uniform1i(v),u_size_t:new s.Uniform1f(v),u_size:new s.Uniform1f(v),u_camera_to_center_distance:new s.Uniform1f(v),u_rotate_symbol:new s.Uniform1i(v),u_aspect_ratio:new s.Uniform1f(v),u_fade_change:new s.Uniform1f(v),u_matrix:new s.UniformMatrix4f(v),u_label_plane_matrix:new s.UniformMatrix4f(v),u_coord_matrix:new s.UniformMatrix4f(v),u_is_text:new s.Uniform1i(v),u_pitch_with_map:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_camera_forward:new s.Uniform3f(v),u_tile_matrix:new s.UniformMatrix4f(v),u_up_vector:new s.Uniform3f(v),u_ecef_origin:new s.Uniform3f(v),u_texture:new s.Uniform1i(v)}),symbolSDF:v=>({u_is_size_zoom_constant:new s.Uniform1i(v),u_is_size_feature_constant:new s.Uniform1i(v),u_size_t:new s.Uniform1f(v),u_size:new s.Uniform1f(v),u_camera_to_center_distance:new s.Uniform1f(v),u_rotate_symbol:new s.Uniform1i(v),u_aspect_ratio:new s.Uniform1f(v),u_fade_change:new s.Uniform1f(v),u_matrix:new s.UniformMatrix4f(v),u_label_plane_matrix:new s.UniformMatrix4f(v),u_coord_matrix:new s.UniformMatrix4f(v),u_is_text:new s.Uniform1i(v),u_pitch_with_map:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_texture:new s.Uniform1i(v),u_gamma_scale:new s.Uniform1f(v),u_device_pixel_ratio:new s.Uniform1f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_camera_forward:new s.Uniform3f(v),u_tile_matrix:new s.UniformMatrix4f(v),u_up_vector:new s.Uniform3f(v),u_ecef_origin:new s.Uniform3f(v),u_is_halo:new s.Uniform1i(v)}),symbolTextAndIcon:v=>({u_is_size_zoom_constant:new s.Uniform1i(v),u_is_size_feature_constant:new s.Uniform1i(v),u_size_t:new s.Uniform1f(v),u_size:new s.Uniform1f(v),u_camera_to_center_distance:new s.Uniform1f(v),u_rotate_symbol:new s.Uniform1i(v),u_aspect_ratio:new s.Uniform1f(v),u_fade_change:new s.Uniform1f(v),u_matrix:new s.UniformMatrix4f(v),u_label_plane_matrix:new s.UniformMatrix4f(v),u_coord_matrix:new s.UniformMatrix4f(v),u_is_text:new s.Uniform1i(v),u_pitch_with_map:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_texsize_icon:new s.Uniform2f(v),u_texture:new s.Uniform1i(v),u_texture_icon:new s.Uniform1i(v),u_gamma_scale:new s.Uniform1f(v),u_device_pixel_ratio:new s.Uniform1f(v),u_is_halo:new s.Uniform1i(v)}),background:v=>({u_matrix:new s.UniformMatrix4f(v),u_opacity:new s.Uniform1f(v),u_color:new s.UniformColor(v)}),backgroundPattern:v=>({u_matrix:new s.UniformMatrix4f(v),u_opacity:new s.Uniform1f(v),u_image:new s.Uniform1i(v),u_pattern_tl:new s.Uniform2f(v),u_pattern_br:new s.Uniform2f(v),u_texsize:new s.Uniform2f(v),u_pattern_size:new s.Uniform2f(v),u_pixel_coord_upper:new s.Uniform2f(v),u_pixel_coord_lower:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v)}),terrainRaster:ey,terrainDepth:ey,skybox:v=>({u_matrix:new s.UniformMatrix4f(v),u_sun_direction:new s.Uniform3f(v),u_cubemap:new s.Uniform1i(v),u_opacity:new s.Uniform1f(v),u_temporal_offset:new s.Uniform1f(v)}),skyboxGradient:v=>({u_matrix:new s.UniformMatrix4f(v),u_color_ramp:new s.Uniform1i(v),u_center_direction:new s.Uniform3f(v),u_radius:new s.Uniform1f(v),u_opacity:new s.Uniform1f(v),u_temporal_offset:new s.Uniform1f(v)}),skyboxCapture:v=>({u_matrix_3f:new s.UniformMatrix3f(v),u_sun_direction:new s.Uniform3f(v),u_sun_intensity:new s.Uniform1f(v),u_color_tint_r:new s.Uniform4f(v),u_color_tint_m:new s.Uniform4f(v),u_luminance:new s.Uniform1f(v)}),globeRaster:v=>({u_proj_matrix:new s.UniformMatrix4f(v),u_globe_matrix:new s.UniformMatrix4f(v),u_normalize_matrix:new s.UniformMatrix4f(v),u_merc_matrix:new s.UniformMatrix4f(v),u_zoom_transition:new s.Uniform1f(v),u_merc_center:new s.Uniform2f(v),u_image0:new s.Uniform1i(v),u_grid_matrix:new s.UniformMatrix3f(v),u_skirt_height:new s.Uniform1f(v),u_frustum_tl:new s.Uniform3f(v),u_frustum_tr:new s.Uniform3f(v),u_frustum_br:new s.Uniform3f(v),u_frustum_bl:new s.Uniform3f(v),u_globe_pos:new s.Uniform3f(v),u_globe_radius:new s.Uniform1f(v),u_viewport:new s.Uniform2f(v)}),globeAtmosphere:v=>({u_frustum_tl:new s.Uniform3f(v),u_frustum_tr:new s.Uniform3f(v),u_frustum_br:new s.Uniform3f(v),u_frustum_bl:new s.Uniform3f(v),u_horizon:new s.Uniform1f(v),u_transition:new s.Uniform1f(v),u_fadeout_range:new s.Uniform1f(v),u_color:new s.Uniform4f(v),u_high_color:new s.Uniform4f(v),u_space_color:new s.Uniform4f(v),u_star_intensity:new s.Uniform1f(v),u_star_density:new s.Uniform1f(v),u_star_size:new s.Uniform1f(v),u_temporal_offset:new s.Uniform1f(v),u_horizon_angle:new s.Uniform1f(v),u_rotation_matrix:new s.UniformMatrix4f(v)})};let Vf;function Jd(v,d,m,w,T,P,D){const z=v.context,U=z.gl,K=v.transform,X=v.useProgram("collisionBox"),Q=[];let le=0,he=0;for(let Se=0;Se<w.length;Se++){const Re=w[Se],Le=d.getTile(Re),De=Le.getBucket(m);if(!De)continue;const Ue=Ys(Re,De,K);let Fe=Ue;T[0]===0&&T[1]===0||(Fe=v.translatePosMatrix(Ue,Le,T,P));const Ze=D?De.textCollisionBox:De.iconCollisionBox,wt=De.collisionCircleArray;if(wt.length>0){const He=s.create(),ht=Fe;s.mul(He,De.placementInvProjMatrix,K.glCoordMatrix),s.mul(He,He,De.placementViewportMatrix),Q.push({circleArray:wt,circleOffset:he,transform:ht,invTransform:He,projection:De.getProjection()}),le+=wt.length/4,he=le}Ze&&(v.terrain&&v.terrain.setupElevationDraw(Le,X),X.draw(z,U.LINES,s.DepthMode.disabled,s.StencilMode.disabled,v.colorModeForRenderPass(),s.CullFaceMode.disabled,ly(Fe,K,Le,De.getProjection()),m.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,null,K.zoom,null,[Ze.collisionVertexBuffer,Ze.collisionVertexBufferExt]))}if(!D||!Q.length)return;const pe=v.useProgram("collisionCircle"),fe=new s.StructArrayLayout2f1f2i16;fe.resize(4*le),fe._trim();let ge=0;for(const Se of Q)for(let Re=0;Re<Se.circleArray.length/4;Re++){const Le=4*Re,De=Se.circleArray[Le+0],Ue=Se.circleArray[Le+1],Fe=Se.circleArray[Le+2],Ze=Se.circleArray[Le+3];fe.emplace(ge++,De,Ue,Fe,Ze,0),fe.emplace(ge++,De,Ue,Fe,Ze,1),fe.emplace(ge++,De,Ue,Fe,Ze,2),fe.emplace(ge++,De,Ue,Fe,Ze,3)}(!Vf||Vf.length<2*le)&&(Vf=function(Se){const Re=2*Se,Le=new s.StructArrayLayout3ui6;Le.resize(Re),Le._trim();for(let De=0;De<Re;De++){const Ue=6*De;Le.uint16[Ue+0]=4*De+0,Le.uint16[Ue+1]=4*De+1,Le.uint16[Ue+2]=4*De+2,Le.uint16[Ue+3]=4*De+2,Le.uint16[Ue+4]=4*De+3,Le.uint16[Ue+5]=4*De+0}return Le}(le));const ee=z.createIndexBuffer(Vf,!0),de=z.createVertexBuffer(fe,s.collisionCircleLayout.members,!0);for(const Se of Q){const Re={u_matrix:Se.transform,u_inv_matrix:Se.invTransform,u_camera_to_center_distance:(we=K).getCameraToCenterDistance(Se.projection),u_viewport_size:[we.width,we.height]};pe.draw(z,U.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,v.colorModeForRenderPass(),s.CullFaceMode.disabled,Re,m.id,de,ee,s.SegmentVector.simpleSegment(0,2*Se.circleOffset,Se.circleArray.length,Se.circleArray.length/2),null,K.zoom)}var we;de.destroy(),ee.destroy()}const Eb=s.create();function py({width:v,height:d,anchor:m,textOffset:w,textScale:T},P){const{horizontalAlign:D,verticalAlign:z}=s.getAnchorAlignment(m),U=-(D-.5)*v,K=-(z-.5)*d,X=s.evaluateVariableOffset(m,w);return new s.Point((U/T+X[0])*P,(K/T+X[1])*P)}function Q2(v,d,m,w,T,P,D,z,U,K,X){const Q=v.text.placedSymbolArray,le=v.text.dynamicLayoutVertexArray,he=v.icon.dynamicLayoutVertexArray,pe={},fe=v.getProjection(),ge=Tn(z,fe,P),ee=P.elevation,de=fe.upVectorScale(z.canonical,P.center.lat,P.worldSize).metersToTile;le.clear();for(let we=0;we<Q.length;we++){const Se=Q.get(we),{tileAnchorX:Re,tileAnchorY:Le,numGlyphs:De}=Se,Ue=Se.hidden||!Se.crossTileID||v.allowVerticalPlacement&&!Se.placedOrientation?null:w[Se.crossTileID];if(Ue){let Fe=0,Ze=0,wt=0;if(ee){const jt=ee?ee.getAtTileOffset(z,Re,Le):0,[Jt,lr,Wt]=fe.upVector(z.canonical,Re,Le);Fe=jt*Jt*de,Ze=jt*lr*de,wt=jt*Wt*de}let[He,ht,Je,_t]=bi(Se.projectedAnchorX+Fe,Se.projectedAnchorY+Ze,Se.projectedAnchorZ+wt,m?ge:D);const Ke=ub(P.getCameraToCenterDistance(fe),_t);let dt=T.evaluateSizeForFeature(v.textSizeData,K,Se)*Ke/s.ONE_EM;m&&(dt*=v.tilePixelRatio/U);const Et=py(Ue,dt);m?({x:He,y:ht,z:Je}=fe.projectTilePoint(Re+Et.x,Le+Et.y,z.canonical),[He,ht,Je]=bi(He+Fe,ht+Ze,Je+wt,D)):(d&&Et._rotate(-P.angle),He+=Et.x,ht+=Et.y,Je=0);const yt=v.allowVerticalPlacement&&Se.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let jt=0;jt<De;jt++)s.addDynamicAttributes(le,He,ht,Je,yt);X&&Se.associatedIconIndex>=0&&(pe[Se.associatedIconIndex]={x:He,y:ht,z:Je,angle:yt})}else ba(De,le)}if(X){he.clear();const we=v.icon.placedSymbolArray;for(let Se=0;Se<we.length;Se++){const Re=we.get(Se),{numGlyphs:Le}=Re,De=pe[Se];if(Re.hidden||!De)ba(Le,he);else{const{x:Ue,y:Fe,z:Ze,angle:wt}=De;for(let He=0;He<Le;He++)s.addDynamicAttributes(he,Ue,Fe,Ze,wt)}}v.icon.dynamicLayoutVertexBuffer.updateData(he)}v.text.dynamicLayoutVertexBuffer.updateData(le)}function my(v,d,m){return m.iconsInText&&d?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function Tb(v,d,m,w,T,P,D,z,U,K,X,Q){const le=v.context,he=le.gl,pe=v.transform,fe=z==="map",ge=U==="map",ee=fe&&m.layout.get("symbol-placement")!=="point",de=fe&&!ge&&!ee,we=m.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Se=!1;const Re=v.depthModeForSublayer(0,s.DepthMode.ReadOnly),Le=[s.mercatorXfromLng(pe.center.lng),s.mercatorYfromLat(pe.center.lat)],De=m.layout.get("text-variable-anchor"),Ue=pe.projection.name==="globe",Fe=[],Ze=[0,-1,0];let wt=Ze;!Ue&&!pe.mercatorFromTransition||fe||(wt=function(He){const ht=He._camera.getWorldToCamera(He.worldSize,1),Je=s.multiply([],ht,He.globeMatrix);s.invert(Je,Je);const _t=[0,0,0],Ke=[0,1,0,0];return s.transformMat4$1(Ke,Ke,Je),_t[0]=Ke[0],_t[1]=Ke[1],_t[2]=Ke[2],s.normalize(_t,_t),_t}(pe));for(const He of w){const ht=d.getTile(He),Je=ht.getBucket(m);if(!Je||Je.projection.name==="mercator"&&Ue)continue;const _t=T?Je.text:Je.icon;if(!_t||Je.fullyClipped||!_t.segments.get().length)continue;const Ke=_t.programConfigurations.get(m.id),dt=T||Je.sdfIcons,Et=T?Je.textSizeData:Je.iconSizeData,yt=ge||pe.pitch!==0,jt=s.evaluateSizeForZoom(Et,pe.zoom);let Jt,lr,Wt,sr,jr=[0,0],wr=null;if(T)lr=ht.glyphAtlasTexture,Wt=he.LINEAR,Jt=ht.glyphAtlasTexture.size,Je.iconsInText&&(jr=ht.imageAtlasTexture.size,wr=ht.imageAtlasTexture,sr=yt||v.options.rotating||v.options.zooming||Et.kind==="composite"||Et.kind==="camera"?he.LINEAR:he.NEAREST);else{const Io=m.layout.get("icon-size").constantOr(0)!==1||Je.iconsNeedLinear;lr=ht.imageAtlasTexture,Wt=dt||v.options.rotating||v.options.zooming||Io||yt?he.LINEAR:he.NEAREST,Jt=ht.imageAtlasTexture.size}const Yt=Je.projection.name==="globe",Xr=Yt?wt:Ze,rn=Yt?s.globeToMercatorTransition(pe.zoom):0,nn=Tn(He,Je.getProjection(),pe),sn=pe.calculatePixelsToTileUnitsMatrix(ht),Xi=ot(nn,ht.tileID.canonical,ge,fe,pe,Je.getProjection(),sn),wi=v.terrain&&ge&&ee?s.invert(s.create(),Xi):Eb,ta=Jn(nn,ht.tileID.canonical,ge,fe,pe,Je.getProjection(),sn),Ka=De&&Je.hasTextData(),jn=m.layout.get("icon-text-fit")!=="none"&&Ka&&Je.hasIconData();if(ee){const Io=pe.elevation,bl=Io?Io.getAtTileOffsetFunc(He,pe.center.lat,pe.worldSize,Je.getProjection()):null,oc=To(nn,ht.tileID.canonical,ge,fe,pe,Je.getProjection(),sn);Fg(Je,nn,v,T,oc,ta,ge,K,bl,He)}const an=ee||T&&De||jn,$r=v.translatePosMatrix(nn,ht,P,D),Qn=an?Eb:Xi,ss=v.translatePosMatrix(ta,ht,P,D,!0),xn=Je.getProjection().createInversionMatrix(pe,He.canonical),vs=[];v.terrainRenderModeElevated()&&ge&&vs.push("PITCH_WITH_MAP_TERRAIN"),Yt&&vs.push("PROJECTION_GLOBE_VIEW"),an&&vs.push("PROJECTED_POS_ON_VIEWPORT");const sp=dt&&m.paint.get(T?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ac;ac=dt?Je.iconsInText?Sb(Et.kind,jt,de,ge,v,$r,Qn,ss,Jt,jr,He,rn,Le,xn,Xr,Je.getProjection()):Uf(Et.kind,jt,de,ge,v,$r,Qn,ss,T,Jt,!0,He,rn,Le,xn,Xr,Je.getProjection()):dy(Et.kind,jt,de,ge,v,$r,Qn,ss,T,Jt,He,rn,Le,xn,Xr,Je.getProjection());const ch={program:v.useProgram(my(dt,T,Je),Ke,vs),buffers:_t,uniformValues:ac,atlasTexture:lr,atlasTextureIcon:wr,atlasInterpolation:Wt,atlasInterpolationIcon:sr,isSDF:dt,hasHalo:sp,tile:ht,labelPlaneMatrixInv:wi};if(we&&Je.canOverlap){Se=!0;const Io=_t.segments.get();for(const bl of Io)Fe.push({segments:new s.SegmentVector([bl]),sortKey:bl.sortKey,state:ch})}else Fe.push({segments:_t.segments,sortKey:0,state:ch})}Se&&Fe.sort((He,ht)=>He.sortKey-ht.sortKey);for(const He of Fe){const ht=He.state;if(v.terrain&&v.terrain.setupElevationDraw(ht.tile,ht.program,{useDepthForOcclusion:!Ue,labelPlaneMatrixInv:ht.labelPlaneMatrixInv}),le.activeTexture.set(he.TEXTURE0),ht.atlasTexture.bind(ht.atlasInterpolation,he.CLAMP_TO_EDGE),ht.atlasTextureIcon&&(le.activeTexture.set(he.TEXTURE1),ht.atlasTextureIcon&&ht.atlasTextureIcon.bind(ht.atlasInterpolationIcon,he.CLAMP_TO_EDGE)),ht.isSDF){const Je=ht.uniformValues;ht.hasHalo&&(Je.u_is_halo=1,Qd(ht.buffers,He.segments,m,v,ht.program,Re,X,Q,Je)),Je.u_is_halo=0}Qd(ht.buffers,He.segments,m,v,ht.program,Re,X,Q,ht.uniformValues)}}function Qd(v,d,m,w,T,P,D,z,U){const K=w.context,X=[v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer,v.globeExtVertexBuffer];T.draw(K,K.gl.TRIANGLES,P,D,z,s.CullFaceMode.disabled,U,m.id,v.layoutVertexBuffer,v.indexBuffer,d,m.paint,w.transform.zoom,v.programConfigurations.get(m.id),X)}function jb(v,d,m,w,T,P,D){const z=v.context.gl,U=m.paint.get("fill-pattern"),K=U&&U.constantOr(1);let X,Q,le,he,pe;D?(Q=K&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=z.LINES):(Q=K?"fillPattern":"fill",X=z.TRIANGLES);for(const fe of w){const ge=d.getTile(fe);if(K&&!ge.patternsLoaded())continue;const ee=ge.getBucket(m);if(!ee)continue;v.prepareDrawTile();const de=ee.programConfigurations.get(m.id),we=v.useProgram(Q,de);K&&(v.context.activeTexture.set(z.TEXTURE0),ge.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),de.updatePaintBuffers());const Se=U.constantOr(null);if(Se&&ge.imageAtlas){const Le=ge.imageAtlas.patternPositions[Se.toString()];Le&&de.setConstantPatternPositions(Le)}const Re=v.translatePosMatrix(fe.projMatrix,ge,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(D){he=ee.indexBuffer2,pe=ee.segments2;const Le=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[z.drawingBufferWidth,z.drawingBufferHeight];le=Q==="fillOutlinePattern"&&K?K2(Re,v,ge,Le):X2(Re,Le)}else he=ee.indexBuffer,pe=ee.segments,le=K?sy(Re,v,ge):rc(Re);v.prepareDrawProgram(v.context,we,fe.toUnwrapped()),we.draw(v.context,X,T,v.stencilModeForClipping(fe),P,s.CullFaceMode.disabled,le,m.id,ee.layoutVertexBuffer,he,pe,m.paint,v.transform.zoom,de)}}function qf(v,d,m,w,T,P,D){const z=v.context,U=z.gl,K=v.transform,X=m.paint.get("fill-extrusion-pattern"),Q=X.constantOr(1),le=m.paint.get("fill-extrusion-opacity"),he=[m.paint.get("fill-extrusion-ambient-occlusion-intensity"),m.paint.get("fill-extrusion-ambient-occlusion-radius")],pe=m.layout.get("fill-extrusion-edge-radius"),fe=pe>0&&!m.paint.get("fill-extrusion-rounded-roof"),ge=fe?0:pe,ee=K.projection.name==="globe"?s.fillExtrusionHeightLift():0,de=K.projection.name==="globe",we=de?s.globeToMercatorTransition(K.zoom):0,Se=[s.mercatorXfromLng(K.center.lng),s.mercatorYfromLat(K.center.lat)],Re=[];de&&Re.push("PROJECTION_GLOBE_VIEW"),he[0]>0&&Re.push("FAUX_AO"),fe&&Re.push("ZERO_ROOF_RADIUS");for(const Le of w){const De=d.getTile(Le),Ue=De.getBucket(m);if(!Ue||Ue.projection.name!==K.projection.name)continue;const Fe=Ue.programConfigurations.get(m.id),Ze=v.useProgram(Q?"fillExtrusionPattern":"fillExtrusion",Fe,Re);if(v.terrain){const dt=v.terrain;if(v.style.terrainSetForDrapingOnly())dt.setupElevationDraw(De,Ze,{useMeterToDem:!0});else{if(!Ue.enableTerrain)continue;if(dt.setupElevationDraw(De,Ze,{useMeterToDem:!0}),Cb(z,d,Le,Ue,m,dt),!Ue.centroidVertexBuffer){const Et=Ze.attributes.a_centroid_pos;Et!==void 0&&U.vertexAttrib2f(Et,0,0)}}}Q&&(v.context.activeTexture.set(U.TEXTURE0),De.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Fe.updatePaintBuffers());const wt=X.constantOr(null);if(wt&&De.imageAtlas){const dt=De.imageAtlas.patternPositions[wt.toString()];dt&&Fe.setConstantPatternPositions(dt)}const He=v.translatePosMatrix(Le.projMatrix,De,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),ht=K.projection.createInversionMatrix(K,Le.canonical),Je=m.paint.get("fill-extrusion-vertical-gradient"),_t=Q?bb(He,v,Je,le,he,ge,Le,De,ee,we,Se,ht):iy(He,v,Je,le,he,ge,Le,ee,we,Se,ht);v.prepareDrawProgram(z,Ze,Le.toUnwrapped());const Ke=[];v.terrain&&Ke.push(Ue.centroidVertexBuffer),de&&Ke.push(Ue.layoutVertexExtBuffer),Ze.draw(z,z.gl.TRIANGLES,T,P,D,s.CullFaceMode.backCCW,_t,m.id,Ue.layoutVertexBuffer,Ue.indexBuffer,Ue.segments,m.paint,v.transform.zoom,Fe,Ke)}}function Cb(v,d,m,w,T,P){const D=[ee=>{let de=ee.canonical.x-1,we=ee.wrap;return de<0&&(de=(1<<ee.canonical.z)-1,we--),new s.OverscaledTileID(ee.overscaledZ,we,ee.canonical.z,de,ee.canonical.y)},ee=>{let de=ee.canonical.x+1,we=ee.wrap;return de===1<<ee.canonical.z&&(de=0,we++),new s.OverscaledTileID(ee.overscaledZ,we,ee.canonical.z,de,ee.canonical.y)},ee=>new s.OverscaledTileID(ee.overscaledZ,ee.wrap,ee.canonical.z,ee.canonical.x,(ee.canonical.y===0?1<<ee.canonical.z:ee.canonical.y)-1),ee=>new s.OverscaledTileID(ee.overscaledZ,ee.wrap,ee.canonical.z,ee.canonical.x,ee.canonical.y===(1<<ee.canonical.z)-1?0:ee.canonical.y+1)],z=ee=>{const de=d.getSource().minzoom,we=Re=>{const Le=d.getTileByID(Re);if(Le&&Le.hasData())return Le.getBucket(T)},Se=[0,-1,1];for(const Re of Se){if(ee.overscaledZ+Re<de)continue;const Le=we(ee.calculateScaledKey(ee.overscaledZ+Re));if(Le)return Le}},U=[0,0,0],K=(ee,de)=>(U[0]=Math.min(ee.min.y,de.min.y),U[1]=Math.max(ee.max.y,de.max.y),U[2]=s.EXTENT-de.min.x>ee.max.x?de.min.x-s.EXTENT:ee.max.x,U),X=(ee,de)=>(U[0]=Math.min(ee.min.x,de.min.x),U[1]=Math.max(ee.max.x,de.max.x),U[2]=s.EXTENT-de.min.y>ee.max.y?de.min.y-s.EXTENT:ee.max.y,U),Q=[(ee,de)=>K(ee,de),(ee,de)=>K(de,ee),(ee,de)=>X(ee,de),(ee,de)=>X(de,ee)],le=new s.Point(0,0);let he,pe,fe;const ge=(ee,de,we,Se,Re)=>{const Le=[[Se?we:ee,Se?ee:we,0],[Se?we:de,Se?de:we,0]],De=Re<0?s.EXTENT+Re:Re,Ue=[Se?De:(ee+de)/2,Se?(ee+de)/2:De,0];return we===0&&Re<0||we!==0&&Re>0?P.getForTilePoints(fe,[Ue],!0,pe):Le.push(Ue),P.getForTilePoints(m,Le,!0,he),Math.max(Le[0][2],Le[1][2],Ue[2])/P.exaggeration()};for(let ee=0;ee<4;ee++){const de=(ee<2?1:5)-ee,we=w.borders[ee];if(we.length===0)continue;const Se=fe=D[ee](m),Re=z(Se);if(!(Re&&Re instanceof s.FillExtrusionBucket&&Re.enableTerrain)||w.borderDoneWithNeighborZ[ee]===Re.canonical.z&&Re.borderDoneWithNeighborZ[de]===w.canonical.z||(pe=P.findDEMTileFor(Se),!pe||!pe.dem))continue;if(!he){const Fe=P.findDEMTileFor(m);if(!Fe||!Fe.dem)return;he=Fe}const Le=Re.borders[de];let De=0;const Ue=Re.borderDoneWithNeighborZ[de]!==w.canonical.z;if(w.canonical.z===Re.canonical.z){for(let Fe=0;Fe<we.length;Fe++){const Ze=w.featuresOnBorder[we[Fe]],wt=Ze.borders[ee];let He;for(;De<Le.length&&(He=Re.featuresOnBorder[Le[De]],!(He.borders[de][1]>wt[0]+3));)Ue&&Re.encodeCentroid(void 0,He,!1),De++;if(He&&De<Le.length){const ht=De;let Je=0;for(;!(He.borders[de][0]>wt[1]-3)&&(Je++,++De!==Le.length);)He=Re.featuresOnBorder[Le[De]];if(He=Re.featuresOnBorder[Le[ht]],Ze.intersectsCount()>1||He.intersectsCount()>1||Je!==1){Je!==1&&(De=ht),w.encodeCentroid(void 0,Ze,!1),Ue&&Re.encodeCentroid(void 0,He,!1);continue}const _t=Q[ee](Ze,He),Ke=ee%2?s.EXTENT-1:0;le.x=ge(_t[0],Math.min(s.EXTENT-1,_t[1]),Ke,ee<2,_t[2]),le.y=0,w.encodeCentroid(le,Ze,!1),Ue&&Re.encodeCentroid(le,He,!1)}else w.encodeCentroid(void 0,Ze,!1)}w.borderDoneWithNeighborZ[ee]=Re.canonical.z,w.needsCentroidUpdate=!0,Ue&&(Re.borderDoneWithNeighborZ[de]=w.canonical.z,Re.needsCentroidUpdate=!0)}else{for(const Fe of we)w.encodeCentroid(void 0,w.featuresOnBorder[Fe],!1);if(Ue){for(const Fe of Le)Re.encodeCentroid(void 0,Re.featuresOnBorder[Fe],!1);Re.borderDoneWithNeighborZ[de]=w.canonical.z,Re.needsCentroidUpdate=!0}w.borderDoneWithNeighborZ[ee]=Re.canonical.z,w.needsCentroidUpdate=!0}}(w.needsCentroidUpdate||!w.centroidVertexBuffer&&w.centroidVertexArray.length!==0)&&w.uploadCentroid(v)}const hu=new s.Color(1,0,0,1),eT=new s.Color(0,1,0,1),tT=new s.Color(0,0,1,1),rT=new s.Color(1,0,1,1),nT=new s.Color(0,1,1,1);function iT(v,d,m){const w=v.context,T=v.transform,P=w.gl,D=T.projection.name==="globe",z=D?["PROJECTION_GLOBE_VIEW"]:null;let U=m.projMatrix;if(D&&s.globeToMercatorTransition(T.zoom)>0){const Ze=s.transitionTileAABBinECEF(m.canonical,T),wt=s.globeDenormalizeECEF(Ze);U=s.multiply(new Float32Array(16),T.globeMatrix,wt),s.multiply(U,T.projMatrix,U)}const K=v.useProgram("debug",null,z),X=d.getTileByID(m.key);v.terrain&&v.terrain.setupElevationDraw(X,K);const Q=s.DepthMode.disabled,le=s.StencilMode.disabled,he=v.colorModeForRenderPass(),pe="$debug";w.activeTexture.set(P.TEXTURE0),v.emptyTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),D?X._makeGlobeTileDebugBuffers(v.context,T):X._makeDebugTileBoundsBuffers(v.context,T.projection);const fe=X._tileDebugBuffer||v.debugBuffer,ge=X._tileDebugIndexBuffer||v.debugIndexBuffer,ee=X._tileDebugSegments||v.debugSegments;K.draw(w,P.LINE_STRIP,Q,le,he,s.CullFaceMode.disabled,$f(U,s.Color.red),pe,fe,ge,ee,null,null,null,[X._globeTileDebugBorderBuffer]);const de=X.latestRawTileData,we=Math.floor((de&&de.byteLength||0)/1024),Se=d.getTile(m).tileSize,Re=512/Math.min(Se,512)*(m.overscaledZ/T.zoom)*.5;let Le=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(Le+=` => ${m.overscaledZ}`),Le+=` ${we}kb`,function(Ze,wt){Ze.initDebugOverlayCanvas();const He=Ze.debugOverlayCanvas,ht=Ze.context.gl,Je=Ze.debugOverlayCanvas.getContext("2d");Je.clearRect(0,0,He.width,He.height),Je.shadowColor="white",Je.shadowBlur=2,Je.lineWidth=1.5,Je.strokeStyle="white",Je.textBaseline="top",Je.font="bold 36px Open Sans, sans-serif",Je.fillText(wt,5,5),Je.strokeText(wt,5,5),Ze.debugOverlayTexture.update(He),Ze.debugOverlayTexture.bind(ht.LINEAR,ht.CLAMP_TO_EDGE)}(v,Le);const De=X._tileDebugTextBuffer||v.debugBuffer,Ue=X._tileDebugTextIndexBuffer||v.quadTriangleIndexBuffer,Fe=X._tileDebugTextSegments||v.debugSegments;K.draw(w,P.TRIANGLES,Q,le,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,$f(U,s.Color.transparent,Re),pe,De,Ue,Fe,null,null,null,[X._globeTileDebugTextBuffer])}function Pb(v,d,m,w){fu(v,0,d+m/2,v.transform.width,m,w)}function Wf(v,d,m,w){fu(v,d-m/2,0,m,v.transform.height,w)}function fu(v,d,m,w,T,P){const D=v.context,z=D.gl;z.enable(z.SCISSOR_TEST),z.scissor(d*s.exported.devicePixelRatio,m*s.exported.devicePixelRatio,w*s.exported.devicePixelRatio,T*s.exported.devicePixelRatio),D.clear({color:P}),z.disable(z.SCISSOR_TEST)}const Ab=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Nb}=Ab;function ko(v,d,m,w){v.emplaceBack(d,m,w)}class Gf{constructor(d){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,ko(this.vertexArray,-1,-1,1),ko(this.vertexArray,1,-1,1),ko(this.vertexArray,-1,1,1),ko(this.vertexArray,1,1,1),ko(this.vertexArray,-1,-1,-1),ko(this.vertexArray,1,-1,-1),ko(this.vertexArray,-1,1,-1),ko(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=d.createVertexBuffer(this.vertexArray,Nb),this.indexBuffer=d.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function Qs(v,d,m,w,T,P){const D=v.gl,z=d.paint.get("sky-atmosphere-color"),U=d.paint.get("sky-atmosphere-halo-color"),K=d.paint.get("sky-atmosphere-sun-intensity"),X=((Q,le,he,pe,fe)=>({u_matrix_3f:Q,u_sun_direction:le,u_sun_intensity:he,u_color_tint_r:[pe.r,pe.g,pe.b,pe.a],u_color_tint_m:[fe.r,fe.g,fe.b,fe.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),w),T,K,z,U);D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_CUBE_MAP_POSITIVE_X+P,d.skyboxTexture,0),m.draw(v,D.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,X,"skyboxCapture",d.skyboxGeometry.vertexBuffer,d.skyboxGeometry.indexBuffer,d.skyboxGeometry.segment)}const eh=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class kb{constructor(d){const m=new s.StructArrayLayout5f20;m.emplaceBack(-1,1,1,0,0),m.emplaceBack(1,1,1,1,0),m.emplaceBack(1,-1,1,1,1),m.emplaceBack(-1,-1,1,0,1);const w=new s.StructArrayLayout3ui6;w.emplaceBack(0,1,2),w.emplaceBack(2,3,0),this.vertexBuffer=d.createVertexBuffer(m,eh.members),this.indexBuffer=d.createIndexBuffer(w),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const nc={symbol:function(v,d,m,w,T){if(v.renderPass!=="translucent")return;const P=s.StencilMode.disabled,D=v.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(z,U,K,X,Q,le,he){const pe=U.transform,fe=Q==="map",ge=le==="map";for(const ee of z){const de=X.getTile(ee),we=de.getBucket(K);if(!we||!we.text||!we.text.segments.get().length)continue;const Se=s.evaluateSizeForZoom(we.textSizeData,pe.zoom),Re=Tn(ee,we.getProjection(),pe),Le=pe.calculatePixelsToTileUnitsMatrix(de),De=ot(Re,de.tileID.canonical,ge,fe,pe,we.getProjection(),Le),Ue=K.layout.get("icon-text-fit")!=="none"&&we.hasIconData();if(Se){const Fe=Math.pow(2,pe.zoom-de.tileID.overscaledZ);Q2(we,fe,ge,he,s.symbolSize,pe,De,ee,Fe,Se,Ue)}}}(w,v,m,d,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),T),m.paint.get("icon-opacity").constantOr(1)!==0&&Tb(v,d,m,w,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),P,D),m.paint.get("text-opacity").constantOr(1)!==0&&Tb(v,d,m,w,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),P,D),d.map.showCollisionBoxes&&(Jd(v,d,m,w,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),Jd(v,d,m,w,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))},circle:function(v,d,m,w){if(v.renderPass!=="translucent")return;const T=m.paint.get("circle-opacity"),P=m.paint.get("circle-stroke-width"),D=m.paint.get("circle-stroke-opacity"),z=m.layout.get("circle-sort-key").constantOr(1)!==void 0;if(T.constantOr(1)===0&&(P.constantOr(1)===0||D.constantOr(1)===0))return;const U=v.context,K=U.gl,X=v.transform,Q=v.depthModeForSublayer(0,s.DepthMode.ReadOnly),le=s.StencilMode.disabled,he=v.colorModeForRenderPass(),pe=X.projection.name==="globe",fe=[s.mercatorXfromLng(X.center.lng),s.mercatorYfromLat(X.center.lat)],ge=[];for(let de=0;de<w.length;de++){const we=w[de],Se=d.getTile(we),Re=Se.getBucket(m);if(!Re||Re.projection.name!==X.projection.name)continue;const Le=Re.programConfigurations.get(m.id),De=oy(m);pe&&De.push("PROJECTION_GLOBE_VIEW");const Ue=v.useProgram("circle",Le,De),Fe=Re.layoutVertexBuffer,Ze=Re.globeExtVertexBuffer,wt=Re.indexBuffer,He=X.projection.createInversionMatrix(X,we.canonical),ht={programConfiguration:Le,program:Ue,layoutVertexBuffer:Fe,globeExtVertexBuffer:Ze,indexBuffer:wt,uniformValues:ay(v,we,Se,He,fe,m),tile:Se};if(z){const Je=Re.segments.get();for(const _t of Je)ge.push({segments:new s.SegmentVector([_t]),sortKey:_t.sortKey,state:ht})}else ge.push({segments:Re.segments,sortKey:0,state:ht})}z&&ge.sort((de,we)=>de.sortKey-we.sortKey);const ee={useDepthForOcclusion:!pe};for(const de of ge){const{programConfiguration:we,program:Se,layoutVertexBuffer:Re,globeExtVertexBuffer:Le,indexBuffer:De,uniformValues:Ue,tile:Fe}=de.state,Ze=de.segments;v.terrain&&v.terrain.setupElevationDraw(Fe,Se,ee),v.prepareDrawProgram(U,Se,Fe.tileID.toUnwrapped()),Se.draw(U,K.TRIANGLES,Q,le,he,s.CullFaceMode.disabled,Ue,m.id,Re,De,Ze,m.paint,X.zoom,we,[Le])}},heatmap:function(v,d,m,w){if(m.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const T=v.context,P=T.gl,D=s.StencilMode.disabled,z=new s.ColorMode([P.ONE,P.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(he,pe,fe,ge){const ee=he.gl,de=pe.width*ge,we=pe.height*ge;he.activeTexture.set(ee.TEXTURE1),he.viewport.set([0,0,de,we]);let Se=fe.heatmapFbo;if(!Se||Se&&(Se.width!==de||Se.height!==we)){Se&&Se.destroy();const Re=ee.createTexture();ee.bindTexture(ee.TEXTURE_2D,Re),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MAG_FILTER,ee.LINEAR),Se=fe.heatmapFbo=he.createFramebuffer(de,we,!1),function(Le,De,Ue,Fe,Ze,wt){const He=Le.gl;He.texImage2D(He.TEXTURE_2D,0,Le.isWebGL2&&Le.extRenderToTextureHalfFloat?He.RGBA16F:He.RGBA,Ze,wt,0,He.RGBA,Le.extRenderToTextureHalfFloat?Le.isWebGL2?He.HALF_FLOAT:Le.extTextureHalfFloat.HALF_FLOAT_OES:He.UNSIGNED_BYTE,null),Fe.colorAttachment.set(Ue)}(he,0,Re,Se,de,we)}else ee.bindTexture(ee.TEXTURE_2D,Se.colorAttachment.get()),he.bindFramebuffer.set(Se.framebuffer)})(T,v,m,v.transform.projection.name==="globe"?.5:.25),T.clear({color:s.Color.transparent});const U=v.transform,K=U.projection.name==="globe",X=K?["PROJECTION_GLOBE_VIEW"]:null,Q=K?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,le=[s.mercatorXfromLng(U.center.lng),s.mercatorYfromLat(U.center.lat)];for(let he=0;he<w.length;he++){const pe=w[he];if(d.hasRenderableParent(pe))continue;const fe=d.getTile(pe),ge=fe.getBucket(m);if(!ge||ge.projection.name!==U.projection.name)continue;const ee=ge.programConfigurations.get(m.id),de=v.useProgram("heatmap",ee,X),{zoom:we}=v.transform;v.terrain&&v.terrain.setupElevationDraw(fe,de),v.prepareDrawProgram(T,de,pe.toUnwrapped());const Se=U.projection.createInversionMatrix(U,pe.canonical);de.draw(T,P.TRIANGLES,s.DepthMode.disabled,D,z,Q,wb(v,pe,fe,Se,le,we,m.paint.get("heatmap-intensity")),m.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,m.paint,v.transform.zoom,ee,K?[ge.globeExtVertexBuffer]:null)}T.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(T,P){const D=T.context,z=D.gl,U=P.heatmapFbo;if(!U)return;D.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,U.colorAttachment.get()),D.activeTexture.set(z.TEXTURE1);let K=P.colorRampTexture;K||(K=P.colorRampTexture=new s.Texture(D,P.colorRamp,z.RGBA)),K.bind(z.LINEAR,z.CLAMP_TO_EDGE),T.useProgram("heatmapTexture").draw(D,z.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,T.colorModeForRenderPass(),s.CullFaceMode.disabled,((X,Q,le,he)=>({u_image:0,u_color_ramp:1,u_opacity:Q.paint.get("heatmap-opacity")}))(0,P),P.id,T.viewportBuffer,T.quadTriangleIndexBuffer,T.viewportSegments,P.paint,T.transform.zoom)}(v,m))},line:function(v,d,m,w){if(v.renderPass!=="translucent")return;const T=m.paint.get("line-opacity"),P=m.paint.get("line-width");if(T.constantOr(1)===0||P.constantOr(1)===0)return;const D=v.depthModeForSublayer(0,s.DepthMode.ReadOnly),z=v.colorModeForRenderPass(),U=v.terrain&&v.terrain.renderingToTexture?1:s.exported.devicePixelRatio,K=m.paint.get("line-dasharray"),X=K.constantOr(1),Q=m.layout.get("line-cap"),le=m.paint.get("line-pattern"),he=le.constantOr(1),pe=m.paint.get("line-gradient"),fe=he?"linePattern":"line",ge=v.context,ee=ge.gl,de=(Se=>{const Re=[];Yd(Se)&&Re.push("RENDER_LINE_DASH"),Se.paint.get("line-gradient")&&Re.push("RENDER_LINE_GRADIENT");const Le=Se.paint.get("line-trim-offset");Le[0]===0&&Le[1]===0||Re.push("RENDER_LINE_TRIM_OFFSET");const De=Se.paint.get("line-pattern").constantOr(1),Ue=Se.paint.get("line-opacity").constantOr(1)!==1;return!De&&Ue&&Re.push("RENDER_LINE_ALPHA_DISCARD"),Re})(m);let we=de.includes("RENDER_LINE_ALPHA_DISCARD");v.terrain&&v.terrain.clipOrMaskOverlapStencilType()&&(we=!1);for(const Se of w){const Re=d.getTile(Se);if(he&&!Re.patternsLoaded())continue;const Le=Re.getBucket(m);if(!Le)continue;v.prepareDrawTile();const De=Le.programConfigurations.get(m.id),Ue=v.useProgram(fe,De,de),Fe=le.constantOr(null);if(Fe&&Re.imageAtlas){const dt=Re.imageAtlas.patternPositions[Fe.toString()];dt&&De.setConstantPatternPositions(dt)}const Ze=K.constantOr(null),wt=Q.constantOr(null);if(!he&&Ze&&wt&&Re.lineAtlas){const dt=Re.lineAtlas.getDash(Ze,wt);dt&&De.setConstantPatternPositions(dt)}let[He,ht]=m.paint.get("line-trim-offset");(wt==="round"||wt==="square")&&He!==ht&&(He===0&&(He-=1),ht===1&&(ht+=1));const Je=v.terrain?Se.projMatrix:null,_t=he?Zd(v,Re,m,Je,U):Y2(v,Re,m,Je,Le.lineClipsArray.length,U,[He,ht]);if(pe){const dt=Le.gradients[m.id];let Et=dt.texture;if(m.gradientVersion!==dt.version){let yt=256;if(m.stepInterpolant){const jt=d.getSource().maxzoom,Jt=Se.canonical.z===jt?Math.ceil(1<<v.transform.maxZoom-Se.canonical.z):1;yt=s.clamp(s.nextPowerOfTwo(Le.maxLineLength/s.EXTENT*1024*Jt),256,ge.maxTextureSize)}dt.gradient=s.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:yt,image:dt.gradient||void 0,clips:Le.lineClipsArray}),dt.texture?dt.texture.update(dt.gradient):dt.texture=new s.Texture(ge,dt.gradient,ee.RGBA),dt.version=m.gradientVersion,Et=dt.texture}ge.activeTexture.set(ee.TEXTURE1),Et.bind(m.stepInterpolant?ee.NEAREST:ee.LINEAR,ee.CLAMP_TO_EDGE)}X&&(ge.activeTexture.set(ee.TEXTURE0),Re.lineAtlasTexture.bind(ee.LINEAR,ee.REPEAT),De.updatePaintBuffers()),he&&(ge.activeTexture.set(ee.TEXTURE0),Re.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),De.updatePaintBuffers()),v.prepareDrawProgram(ge,Ue,Se.toUnwrapped());const Ke=dt=>{Ue.draw(ge,ee.TRIANGLES,D,dt,z,s.CullFaceMode.disabled,_t,m.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,m.paint,v.transform.zoom,De,[Le.layoutVertexBuffer2])};if(we){const dt=v.stencilModeForClipping(Se).ref;dt===0&&v.terrain&&ge.clear({stencil:0});const Et={func:ee.EQUAL,mask:255};_t.u_alpha_discard_threshold=.8,Ke(new s.StencilMode(Et,dt,255,ee.KEEP,ee.KEEP,ee.INVERT)),_t.u_alpha_discard_threshold=0,Ke(new s.StencilMode(Et,dt,255,ee.KEEP,ee.KEEP,ee.KEEP))}else Ke(v.stencilModeForClipping(Se))}we&&(v.resetStencilClippingMasks(),v.terrain&&ge.clear({stencil:0}))},fill:function(v,d,m,w){const T=m.paint.get("fill-color"),P=m.paint.get("fill-opacity");if(P.constantOr(1)===0)return;const D=v.colorModeForRenderPass(),z=m.paint.get("fill-pattern"),U=v.opaquePassEnabledForLayer()&&!z.constantOr(1)&&T.constantOr(s.Color.transparent).a===1&&P.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===U){const K=v.depthModeForSublayer(1,v.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);jb(v,d,m,w,K,D,!1)}if(v.renderPass==="translucent"&&m.paint.get("fill-antialias")){const K=v.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);jb(v,d,m,w,K,D,!0)}},"fill-extrusion":function(v,d,m,w){const T=m.paint.get("fill-extrusion-opacity");if(T!==0&&v.renderPass==="translucent"){const P=new s.DepthMode(v.context.gl.LEQUAL,s.DepthMode.ReadWrite,v.depthRangeFor3D);if(T!==1||m.paint.get("fill-extrusion-pattern").constantOr(1))qf(v,d,m,w,P,s.StencilMode.disabled,s.ColorMode.disabled),qf(v,d,m,w,P,v.stencilModeFor3D(),v.colorModeForRenderPass()),v.resetStencilClippingMasks();else{const D=v.colorModeForRenderPass();qf(v,d,m,w,P,s.StencilMode.disabled,D)}}},hillshade:function(v,d,m,w){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const T=v.context,P=v.depthModeForSublayer(0,s.DepthMode.ReadOnly),D=v.colorModeForRenderPass(),z=v.terrain&&v.terrain.renderingToTexture,[U,K]=v.renderPass!=="translucent"||z?[{},w]:v.stencilConfigForOverlap(w);for(const X of K){const Q=d.getTile(X);if(Q.needsHillshadePrepare&&v.renderPass==="offscreen")yb(v,Q,m,P,s.StencilMode.disabled,D);else if(v.renderPass==="translucent"){const le=z&&v.terrain?v.terrain.stencilModeForRTTOverlap(X):U[X.overscaledZ];gb(v,X,Q,m,P,le,D)}}T.viewport.set([0,0,v.width,v.height]),v.resetStencilClippingMasks()},raster:function(v,d,m,w,T,P){if(v.renderPass!=="translucent"||m.paint.get("raster-opacity")===0||!w.length)return;const D=v.context,z=D.gl,U=d.getSource(),K=v.useProgram("raster"),X=v.colorModeForRenderPass(),Q=v.terrain&&v.terrain.renderingToTexture,[le,he]=U instanceof br||Q?[{},w]:v.stencilConfigForOverlap(w),pe=he[he.length-1].overscaledZ,fe=!v.options.moving;for(const ge of he){const ee=Q?s.DepthMode.disabled:v.depthModeForSublayer(ge.overscaledZ-pe,m.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,z.LESS),de=ge.toUnwrapped(),we=d.getTile(ge);if(Q&&(!we||!we.hasData()))continue;const Se=Q?ge.projMatrix:v.transform.calculateProjMatrix(de,fe),Re=v.terrain&&Q?v.terrain.stencilModeForRTTOverlap(ge):le[ge.overscaledZ],Le=P?0:m.paint.get("raster-fade-duration");we.registerFadeDuration(Le);const De=d.findLoadedParent(ge,0),Ue=ty(we,De,d,v.transform,Le);let Fe,Ze;v.terrain&&v.terrain.prepareDrawTile();const wt=m.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;D.activeTexture.set(z.TEXTURE0),we.texture.bind(wt,z.CLAMP_TO_EDGE),D.activeTexture.set(z.TEXTURE1),De?(De.texture.bind(wt,z.CLAMP_TO_EDGE),Fe=Math.pow(2,De.tileID.overscaledZ-we.tileID.overscaledZ),Ze=[we.tileID.canonical.x*Fe%1,we.tileID.canonical.y*Fe%1]):we.texture.bind(wt,z.CLAMP_TO_EDGE),we.texture.useMipmap&&D.extTextureFilterAnisotropic&&v.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,D.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,D.extTextureFilterAnisotropicMax);const He=uy(Se,Ze||[0,0],Fe||1,Ue,m,U instanceof br?U.perspectiveTransform:[0,0]);if(v.prepareDrawProgram(D,K,de),U instanceof br)U.boundsBuffer&&U.boundsSegments&&K.draw(D,z.TRIANGLES,ee,s.StencilMode.disabled,X,s.CullFaceMode.disabled,He,m.id,U.boundsBuffer,v.quadTriangleIndexBuffer,U.boundsSegments);else{const{tileBoundsBuffer:ht,tileBoundsIndexBuffer:Je,tileBoundsSegments:_t}=v.getTileBoundsBuffers(we);K.draw(D,z.TRIANGLES,ee,Re,X,s.CullFaceMode.disabled,He,m.id,ht,Je,_t)}}v.resetStencilClippingMasks()},background:function(v,d,m,w){const T=m.paint.get("background-color"),P=m.paint.get("background-opacity");if(P===0)return;const D=v.context,z=D.gl,U=v.transform,K=U.tileSize,X=m.paint.get("background-pattern");if(v.isPatternMissing(X))return;const Q=!X&&T.a===1&&P===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==Q)return;const le=s.StencilMode.disabled,he=v.depthModeForSublayer(0,Q==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),pe=v.colorModeForRenderPass(),fe=v.useProgram(X?"backgroundPattern":"background");let ge,ee=w;ee||(ge=v.getBackgroundTiles(),ee=Object.values(ge).map(de=>de.tileID)),X&&(D.activeTexture.set(z.TEXTURE0),v.imageManager.bind(v.context));for(const de of ee){const we=de.toUnwrapped(),Se=w?de.projMatrix:v.transform.calculateProjMatrix(we);v.prepareDrawTile();const Re=d?d.getTile(de):ge?ge[de.key]:new s.Tile(de,K,U.zoom,v),Le=X?J2(Se,P,v,X,{tileID:de,tileSize:K}):hy(Se,P,T);v.prepareDrawProgram(D,fe,we);const{tileBoundsBuffer:De,tileBoundsIndexBuffer:Ue,tileBoundsSegments:Fe}=v.getTileBoundsBuffers(Re);fe.draw(D,z.TRIANGLES,he,le,pe,s.CullFaceMode.disabled,Le,m.id,De,Ue,Fe)}},sky:function(v,d,m){const w=v.transform,T=w.projection.name==="mercator"||w.projection.name==="globe"?1:s.smoothstep(7,8,w.zoom),P=m.paint.get("sky-opacity")*T;if(P===0)return;const D=v.context,z=m.paint.get("sky-type"),U=new s.DepthMode(D.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),K=v.frameCounter/1e3%1;z==="atmosphere"?v.renderPass==="offscreen"?m.needsSkyboxCapture(v)&&(function(X,Q,le,he){const pe=X.context,fe=pe.gl;let ge=Q.skyboxFbo;if(!ge){ge=Q.skyboxFbo=pe.createFramebuffer(32,32,!1),Q.skyboxGeometry=new Gf(pe),Q.skyboxTexture=pe.gl.createTexture(),fe.bindTexture(fe.TEXTURE_CUBE_MAP,Q.skyboxTexture),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_WRAP_S,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_WRAP_T,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_MIN_FILTER,fe.LINEAR),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_MAG_FILTER,fe.LINEAR);for(let Se=0;Se<6;++Se)fe.texImage2D(fe.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,fe.RGBA,32,32,0,fe.RGBA,fe.UNSIGNED_BYTE,null)}pe.bindFramebuffer.set(ge.framebuffer),pe.viewport.set([0,0,32,32]);const ee=Q.getCenter(X,!0),de=X.useProgram("skyboxCapture"),we=new Float64Array(16);s.identity(we),s.rotateY(we,we,.5*-Math.PI),Qs(pe,Q,de,we,ee,0),s.identity(we),s.rotateY(we,we,.5*Math.PI),Qs(pe,Q,de,we,ee,1),s.identity(we),s.rotateX(we,we,.5*-Math.PI),Qs(pe,Q,de,we,ee,2),s.identity(we),s.rotateX(we,we,.5*Math.PI),Qs(pe,Q,de,we,ee,3),s.identity(we),Qs(pe,Q,de,we,ee,4),s.identity(we),s.rotateY(we,we,Math.PI),Qs(pe,Q,de,we,ee,5),pe.viewport.set([0,0,X.width,X.height])}(v,m),m.markSkyboxValid(v)):v.renderPass==="sky"&&function(X,Q,le,he,pe){const fe=X.context,ge=fe.gl,ee=X.transform,de=X.useProgram("skybox");fe.activeTexture.set(ge.TEXTURE0),ge.bindTexture(ge.TEXTURE_CUBE_MAP,Q.skyboxTexture);const we=((Se,Re,Le,De,Ue)=>({u_matrix:Se,u_sun_direction:Re,u_cubemap:0,u_opacity:De,u_temporal_offset:Ue}))(ee.skyboxMatrix,Q.getCenter(X,!1),0,he,pe);X.prepareDrawProgram(fe,de),de.draw(fe,ge.TRIANGLES,le,s.StencilMode.disabled,X.colorModeForRenderPass(),s.CullFaceMode.backCW,we,"skybox",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(v,m,U,P,K):z==="gradient"&&v.renderPass==="sky"&&function(X,Q,le,he,pe){const fe=X.context,ge=fe.gl,ee=X.transform,de=X.useProgram("skyboxGradient");Q.skyboxGeometry||(Q.skyboxGeometry=new Gf(fe)),fe.activeTexture.set(ge.TEXTURE0);let we=Q.colorRampTexture;we||(we=Q.colorRampTexture=new s.Texture(fe,Q.colorRamp,ge.RGBA)),we.bind(ge.LINEAR,ge.CLAMP_TO_EDGE);const Se=((Re,Le,De,Ue,Fe)=>({u_matrix:Re,u_color_ramp:0,u_center_direction:Le,u_radius:s.degToRad(De),u_opacity:Ue,u_temporal_offset:Fe}))(ee.skyboxMatrix,Q.getCenter(X,!1),Q.paint.get("sky-gradient-radius"),he,pe);X.prepareDrawProgram(fe,de),de.draw(fe,ge.TRIANGLES,le,s.StencilMode.disabled,X.colorModeForRenderPass(),s.CullFaceMode.backCW,Se,"skyboxGradient",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(v,m,U,P,K)},debug:function(v,d,m){for(let w=0;w<m.length;w++)iT(v,d,m[w])},custom:function(v,d,m,w){const T=v.context,P=m.implementation;if(!v.transform.projection.unsupportedLayers||!v.transform.projection.unsupportedLayers.includes("custom")||v.terrain&&(v.terrain.renderingToTexture||v.renderPass==="offscreen")&&m.isLayerDraped()){if(v.renderPass==="offscreen"){const D=P.prerender;if(D){if(v.setCustomLayerDefaults(),T.setColorMode(v.colorModeForRenderPass()),v.transform.projection.name==="globe"){const z=v.transform.pointMerc;D.call(P,T.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(v.transform.zoom),[z.x,z.y],v.transform.pixelsPerMeterRatio)}else D.call(P,T.gl,v.transform.customLayerMatrix());T.setDirty(),v.setBaseState()}}else if(v.renderPass==="translucent"){if(v.terrain&&v.terrain.renderingToTexture){const z=P.renderToTile;if(z){const U=w[0].canonical,K=new s.MercatorCoordinate(U.x+w[0].wrap*(1<<U.z),U.y,U.z);T.setDepthMode(s.DepthMode.disabled),T.setStencilMode(s.StencilMode.disabled),T.setColorMode(v.colorModeForRenderPass()),v.setCustomLayerDefaults(),z.call(P,T.gl,K),T.setDirty(),v.setBaseState()}return}v.setCustomLayerDefaults(),T.setColorMode(v.colorModeForRenderPass()),T.setStencilMode(s.StencilMode.disabled);const D=P.renderingMode==="3d"?new s.DepthMode(v.context.gl.LEQUAL,s.DepthMode.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(T.setDepthMode(D),v.transform.projection.name==="globe"){const z=v.transform.pointMerc;P.render(T.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(v.transform.zoom),[z.x,z.y],v.transform.pixelsPerMeterRatio)}else P.render(T.gl,v.transform.customLayerMatrix());T.setDirty(),v.setBaseState(),T.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class pu{constructor(d,m,w=!1){this.context=new kt(d,w),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(d,m){const w=!!d&&!!d.terrain&&this.transform.projection.supportsTerrain;if(!(w||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ny(this,d));const T=this._terrain;this.transform.elevation=w?T:null,T.update(d,this.transform,m)}_updateFog(d){const m=d.fog;if(!m||this.transform.projection.name==="globe"||m.getOpacity(this.transform.pitch)<1||m.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[w,T]=m.getFovAdjustedRange(this.transform._fov);if(w>T)return void(this.transform.fogCullDistSq=null);const P=w+.78*(T-w);this.transform.fogCullDistSq=P*P}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(d,m){if(this.width=d*s.exported.devicePixelRatio,this.height=m*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const w of this.style.order)this.style._layers[w].resize()}setup(){const d=this.context,m=new s.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(s.EXTENT,0),m.emplaceBack(0,s.EXTENT),m.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=d.createVertexBuffer(m,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const w=new s.StructArrayLayout2i4;w.emplaceBack(0,0),w.emplaceBack(s.EXTENT,0),w.emplaceBack(0,s.EXTENT),w.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=d.createVertexBuffer(w,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const T=new s.StructArrayLayout2i4;T.emplaceBack(-1,-1),T.emplaceBack(1,-1),T.emplaceBack(-1,1),T.emplaceBack(1,1),this.viewportBuffer=d.createVertexBuffer(T,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const P=new s.StructArrayLayout4i8;P.emplaceBack(0,0,0,0),P.emplaceBack(s.EXTENT,0,s.EXTENT,0),P.emplaceBack(0,s.EXTENT,0,s.EXTENT),P.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=d.createVertexBuffer(P,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const D=new s.StructArrayLayout3ui6;D.emplaceBack(0,1,2),D.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=d.createIndexBuffer(D);const z=new s.StructArrayLayout1ui2;for(const K of[0,1,3,2,0])z.emplaceBack(K);this.debugIndexBuffer=d.createIndexBuffer(z),this.emptyTexture=new s.Texture(d,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),d.gl.RGBA),this.identityMat=s.create();const U=this.context.gl;this.stencilClearMode=new s.StencilMode({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new kb(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(d){return d._makeTileBoundsBuffers(this.context,this.transform.projection),d._tileBoundsBuffer?{tileBoundsBuffer:d._tileBoundsBuffer,tileBoundsIndexBuffer:d._tileBoundsIndexBuffer,tileBoundsSegments:d._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const d=this.context,m=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(d,m.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,Xd(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(d,m,w){if(!m||this.currentStencilSource===m.id||!d.isTileClipped()||!w||w.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let z=!1;for(const U of w)if(this._tileClippingMaskIDs[U.key]===void 0){z=!0;break}if(!z)return}this.currentStencilSource=m.id;const T=this.context,P=T.gl;this.nextStencilID+w.length>256&&this.clearStencil(),T.setColorMode(s.ColorMode.disabled),T.setDepthMode(s.DepthMode.disabled);const D=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of w){const U=m.getTile(z),K=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,{tileBoundsBuffer:X,tileBoundsIndexBuffer:Q,tileBoundsSegments:le}=this.getTileBoundsBuffers(U);D.draw(T,P.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:P.ALWAYS,mask:0},K,255,P.KEEP,P.KEEP,P.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Xd(z.projMatrix),"$clipping",X,Q,le)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const d=this.nextStencilID++,m=this.context.gl;return new s.StencilMode({func:m.NOTEQUAL,mask:255},d,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(d){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(d);const m=this.context.gl;return new s.StencilMode({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(d){const m=this.context.gl,w=d.sort((D,z)=>z.overscaledZ-D.overscaledZ),T=w[w.length-1].overscaledZ,P=w[0].overscaledZ-T+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const D={};for(let z=0;z<P;z++)D[z+T]=new s.StencilMode({func:m.GEQUAL,mask:255},z+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=P,[D,w]}return[{[T]:s.StencilMode.disabled},w]}colorModeForRenderPass(){const d=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([d.CONSTANT_COLOR,d.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(d,m,w){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon;return new s.DepthMode(w||this.context.gl.LEQUAL,m,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(d,m){this.style=d,this.options=m,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const w=this.style.order,T=this.style._sourceCaches;for(const K in T){const X=T[K];X.used&&X.prepare(this.context)}const P={},D={},z={};for(const K in T){const X=T[K];P[K]=X.getVisibleCoordinates(),D[K]=P[K].slice().reverse(),z[K]=X.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let K=0;K<w.length;K++)if(this.style._layers[w[K]].is3D()){this.opaquePassCutoff=K;break}if(this.terrain&&(this.terrain.updateTileBinding(z),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const K of w){const X=this.style._layers[K],Q=d._getLayerSourceCache(X);if(!X.hasOffscreenPass()||X.isHidden(this.transform.zoom))continue;const le=Q?D[Q.id]:void 0;(X.type==="custom"||X.isSky()||le&&le.length)&&this.renderLayer(this,Q,X,le)}this.depthRangeFor3D=[0,1-(d.order.length+2)*this.numSublayers*this.depthEpsilon];const U=this.terrain;if(U&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&U.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:m.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const K=this.style._layers[w[this.currentLayer]],X=d._getLayerSourceCache(K);if(K.isSky())continue;const Q=X?D[X.id]:void 0;this._renderTileClippingMasks(K,X,Q),this.renderLayer(this,X,K,Q)}if(this.style.fog&&this.transform.projection.supportsFog&&function(K,X){const Q=K.context,le=Q.gl,he=K.transform,pe=new s.DepthMode(le.LEQUAL,s.DepthMode.ReadOnly,[0,1]),fe=K.useProgram("globeAtmosphere",null,he.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ge=s.globeToMercatorTransition(he.zoom),ee=X.properties.get("color").toArray01(),de=X.properties.get("high-color").toArray01(),we=X.properties.get("space-color").toArray01PremultipliedAlpha(),Se=s.identity$1([]);s.rotateY$1(Se,Se,-s.degToRad(he._center.lng)),s.rotateX$1(Se,Se,s.degToRad(he._center.lat)),s.rotateZ$1(Se,Se,he.angle),s.rotateX$1(Se,Se,-he._pitch);const Re=s.fromQuat(new Float32Array(16),Se),Le=s.mapValue(X.properties.get("star-intensity"),0,1,0,.25),De=5e-4,Ue=s.mapValue(X.properties.get("horizon-blend"),0,1,De,.25),Fe=s.globeUseCustomAntiAliasing(K,Q,he)&&Ue===De?he.worldSize/(2*Math.PI*1.025)-1:he.globeRadius,Ze=K.frameCounter/1e3%1,wt=s.length(he.globeCenterInViewSpace),He=Math.sqrt(Math.pow(wt,2)-Math.pow(Fe,2)),ht=Math.acos(He/wt),Je=((Ke,dt,Et,yt,jt,Jt,lr,Wt,sr,jr,wr,Yt,Xr,rn)=>({u_frustum_tl:Ke,u_frustum_tr:dt,u_frustum_br:Et,u_frustum_bl:yt,u_horizon:jt,u_transition:Jt,u_fadeout_range:lr,u_color:Wt,u_high_color:sr,u_space_color:jr,u_star_intensity:wr,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Yt,u_horizon_angle:Xr,u_rotation_matrix:rn}))(he.frustumCorners.TL,he.frustumCorners.TR,he.frustumCorners.BR,he.frustumCorners.BL,he.frustumCorners.horizon,ge,Ue,ee,de,we,Le,Ze,ht,Re);K.prepareDrawProgram(Q,fe);const _t=K.atmosphereBuffer;_t&&fe.draw(Q,le.TRIANGLES,pe,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,Je,"skybox",_t.vertexBuffer,_t.indexBuffer,_t.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const K=this.style._layers[w[this.currentLayer]],X=d._getLayerSourceCache(K);K.isSky()&&this.renderLayer(this,X,K,X?D[X.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<w.length;){const K=this.style._layers[w[this.currentLayer]],X=d._getLayerSourceCache(K);if(K.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(K)){if(K.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Q=X?(K.type==="symbol"?z:D)[X.id]:void 0;this._renderTileClippingMasks(K,X,X?P[X.id]:void 0),this.renderLayer(this,X,K,Q),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let K=null;s.values(this.style._layers).forEach(X=>{const Q=d._getLayerSourceCache(X);Q&&!X.isHidden(this.transform.zoom)&&(!K||K.getSource().maxzoom<Q.getSource().maxzoom)&&(K=Q)}),K&&this.options.showTileBoundaries&&nc.debug(this,K,K.getVisibleCoordinates())}this.options.showPadding&&function(K){const X=K.transform.padding;Pb(K,K.transform.height-(X.top||0),3,hu),Pb(K,X.bottom||0,3,eT),Wf(K,X.left||0,3,tT),Wf(K,K.transform.width-(X.right||0),3,rT);const Q=K.transform.centerPoint;(function(le,he,pe,fe){fu(le,he-1,pe-10,2,20,fe),fu(le,he-10,pe-1,20,2,fe)})(K,Q.x,K.transform.height-Q.y,nT)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(d,m,w,T){w.isHidden(this.transform.zoom)||(w.type==="background"||w.type==="sky"||w.type==="custom"||T&&T.length)&&(this.id=w.id,this.gpuTimingStart(w),(!d.transform.projection.unsupportedLayers||!d.transform.projection.unsupportedLayers.includes(w.type)||d.terrain&&w.type==="custom")&&nc[w.type](d,m,w,T,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(d){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery;let w=this.gpuTimers[d.id];w||(w=this.gpuTimers[d.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),w.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,w.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const d=this.context.extTimerQuery,m=d.createQueryEXT();this.deferredRenderGpuTimeQueries.push(m),d.beginQueryEXT(d.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}collectGpuTimers(){const d=this.gpuTimers;return this.gpuTimers={},d}collectDeferredRenderGpuQueries(){const d=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],d}queryGpuTimers(d){const m={};for(const w in d){const T=d[w],P=this.context.extTimerQuery,D=P.getQueryObjectEXT(T.query,P.QUERY_RESULT_EXT)/1e6;P.deleteQueryEXT(T.query),m[w]=D}return m}queryGpuTimeDeferredRender(d){if(!this.options.gpuTimingDeferredRender)return 0;const m=this.context.extTimerQuery;let w=0;for(const T of d)w+=m.getQueryObjectEXT(T,m.QUERY_RESULT_EXT)/1e6,m.deleteQueryEXT(T);return w}translatePosMatrix(d,m,w,T,P){if(!w[0]&&!w[1])return d;const D=P?T==="map"?this.transform.angle:0:T==="viewport"?-this.transform.angle:0;if(D){const K=Math.sin(D),X=Math.cos(D);w=[w[0]*X-w[1]*K,w[0]*K+w[1]*X]}const z=[P?w[0]:Be(m,w[0],this.transform.zoom),P?w[1]:Be(m,w[1],this.transform.zoom),0],U=new Float32Array(16);return s.translate(U,d,z),U}saveTileTexture(d){const m=this._tileTextures[d.size[0]];m?m.push(d):this._tileTextures[d.size[0]]=[d]}getTileTexture(d){const m=this._tileTextures[d];return m&&m.length>0?m.pop():null}isPatternMissing(d){return d===null||d!==void 0&&!this.imageManager.getPattern(d.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const d=this.terrain&&this.terrain.renderingToTexture,m=this.terrain&&this.terrain.exaggeration()===0,w=this.style&&this.style.fog,T=[];return this.terrainRenderModeElevated()&&T.push("TERRAIN"),this.transform.projection.name==="globe"&&T.push("GLOBE"),m&&T.push("ZERO_EXAGGERATION"),w&&!d&&w.getOpacity(this.transform.pitch)!==0&&T.push("FOG"),d&&T.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&T.push("OVERDRAW_INSPECTOR"),T}useProgram(d,m,w){this.cache=this.cache||{};const T=w||[],P=this.currentGlobalDefines().concat(T),D=Or.cacheKey(Yg[d],d,P,m);return this.cache[D]||(this.cache[D]=new Or(this.context,d,Yg[d],m,fy[d],P)),this.cache[D]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(d,m,w){if(this.terrain&&this.terrain.renderingToTexture)return;const T=this.style.fog;if(T){const P=T.getOpacity(this.transform.pitch),D=((z,U,K,X,Q,le,he,pe,fe,ge,ee)=>{const de=z.transform,we=U.properties.get("color").toArray01();we[3]=X;const Se=z.frameCounter/1e3%1;return{u_fog_matrix:K?de.calculateFogTileMatrix(K):z.identityMat,u_fog_range:U.getFovAdjustedRange(de._fov),u_fog_color:we,u_fog_horizon_blend:U.properties.get("horizon-blend"),u_fog_temporal_offset:Se,u_frustum_tl:Q,u_frustum_tr:le,u_frustum_br:he,u_frustum_bl:pe,u_globe_pos:fe,u_globe_radius:ge,u_viewport:ee,u_globe_transition:s.globeToMercatorTransition(de.zoom),u_is_globe:+(de.projection.name==="globe")}})(this,T,w,P,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);m.setFogUniformValues(d,D)}}setTileLoadedFlag(d){this.tileLoaded=d}saveCanvasCopy(){const d=this.canvasCopy();d&&(this.frameCopies.push(d),this.tileLoaded=!1)}canvasCopy(){const d=this.context.gl,m=d.createTexture();return d.bindTexture(d.TEXTURE_2D,m),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGBA,0,0,d.drawingBufferWidth,d.drawingBufferHeight,0),m}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const d=this.style&&this.style.fog;return!!d&&d.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const d=this._backgroundTiles,m=this._backgroundTiles={},w=this.transform.coveringTiles({tileSize:512});for(const T of w)m[T.key]=d[T.key]||new s.Tile(T,512,this.transform.tileZoom,this);return m}clearBackgroundTiles(){this._backgroundTiles={}}}class Hf{constructor(d=0,m=0,w=0,T=0){if(isNaN(d)||d<0||isNaN(m)||m<0||isNaN(w)||w<0||isNaN(T)||T<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=m,this.left=w,this.right=T}interpolate(d,m,w){return m.top!=null&&d.top!=null&&(this.top=s.number(d.top,m.top,w)),m.bottom!=null&&d.bottom!=null&&(this.bottom=s.number(d.bottom,m.bottom,w)),m.left!=null&&d.left!=null&&(this.left=s.number(d.left,m.left,w)),m.right!=null&&d.right!=null&&(this.right=s.number(d.right,m.right,w)),this}getCenter(d,m){const w=s.clamp((this.left+d-this.right)/2,0,d),T=s.clamp((this.top+m-this.bottom)/2,0,m);return new s.Point(w,T)}equals(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right}clone(){return new Hf(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Xf(v,d){const m=s.getColumn(v,3);s.fromQuat(v,d),s.setColumn(v,3,m)}function Br(v,d){const m=s.identity$1([]);return s.rotateZ$1(m,m,-d),s.rotateX$1(m,m,-v),m}function th(v,d){const m=[v[0],v[1],0],w=[d[0],d[1],0];if(s.length(m)>=1e-15){const D=s.normalize([],m);s.scale$2(w,D,s.dot(w,D)),d[0]=w[0],d[1]=w[1]}const T=s.cross([],d,v);if(s.len(T)<1e-15)return null;const P=Math.atan2(-T[1],T[0]);return Br(Math.atan2(Math.sqrt(v[0]*v[0]+v[1]*v[1]),-v[2]),P)}class Mb{constructor(d,m){this.position=d,this.orientation=m}get position(){return this._position}set position(d){if(d){const m=d instanceof s.MercatorCoordinate?d:new s.MercatorCoordinate(d[0],d[1],d[2]);this._renderWorldCopies&&(m.x=s.wrap(m.x,0,1)),this._position=m}else this._position=null}lookAtPoint(d,m){if(this.orientation=null,!this.position)return;const w=this.position,T=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(d)):0,P=s.MercatorCoordinate.fromLngLat(d,T),D=[P.x-w.x,P.y-w.y,P.z-w.z];m||(m=[0,0,1]),m[2]=Math.abs(m[2]),this.orientation=th(D,m)}setPitchBearing(d,m){this.orientation=Br(s.degToRad(d),s.degToRad(-m))}}class Kf{constructor(d,m){this._transform=s.identity([]),this.orientation=m,this.position=d}get mercatorPosition(){const d=this.position;return new s.MercatorCoordinate(d[0],d[1],d[2])}get position(){const d=s.getColumn(this._transform,3);return[d[0],d[1],d[2]]}set position(d){var m;d&&s.setColumn(this._transform,3,[(m=d)[0],m[1],m[2],1])}get orientation(){return this._orientation}set orientation(d){this._orientation=d||s.identity$1([]),d&&Xf(this._transform,this._orientation)}getPitchBearing(){const d=this.forward(),m=this.right();return{bearing:Math.atan2(-m[1],m[0]),pitch:Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2])}}setPitchBearing(d,m){this._orientation=Br(d,m),Xf(this._transform,this._orientation)}forward(){const d=s.getColumn(this._transform,2);return[-d[0],-d[1],-d[2]]}up(){const d=s.getColumn(this._transform,1);return[-d[0],-d[1],-d[2]]}right(){const d=s.getColumn(this._transform,0);return[d[0],d[1],d[2]]}getCameraToWorld(d,m){const w=new Float64Array(16);return s.invert(w,this.getWorldToCamera(d,m)),w}getWorldToCameraPosition(d,m,w){const T=this.position;s.scale$2(T,T,-d);const P=new Float64Array(16);return s.fromScaling(P,[w,w,w]),s.translate(P,P,T),P[10]*=m,P}getWorldToCamera(d,m){const w=new Float64Array(16),T=new Float64Array(4),P=this.position;return s.conjugate(T,this._orientation),s.scale$2(P,P,-d),s.fromQuat(w,T),s.translate(w,w,P),w[1]*=-1,w[5]*=-1,w[9]*=-1,w[13]*=-1,w[8]*=m,w[9]*=m,w[10]*=m,w[11]*=m,w}getCameraToClipPerspective(d,m,w,T){const P=new Float64Array(16);return s.perspective(P,d,m,w,T),P}getDistanceToElevation(d,m=!1){const w=d===0?0:s.mercatorZfromAltitude(d,m?s.latFromMercatorY(this.position[1]):this.position[1]),T=this.forward();return(w-this.position[2])/T[2]}clone(){return new Kf([...this.position],[...this.orientation])}}function mu(v,d){const m=Zf(v.projection,v.zoom,v.width,v.height),w=function(P,D,z,U,K){const X=new s.LngLat(z.lng-180*Mo,z.lat),Q=new s.LngLat(z.lng+180*Mo,z.lat),le=P.project(X.lng,X.lat),he=P.project(Q.lng,Q.lat),pe=-Math.atan2(he.y-le.y,he.x-le.x),fe=s.MercatorCoordinate.fromLngLat(z);fe.y=s.clamp(fe.y,-1+Mo,1-Mo);const ge=fe.toLngLat(),ee=P.project(ge.lng,ge.lat),de=s.MercatorCoordinate.fromLngLat(ge);de.x+=Mo;const we=de.toLngLat(),Se=P.project(we.lng,we.lat),Re=Yf(Se.x-ee.x,Se.y-ee.y,pe),Le=s.MercatorCoordinate.fromLngLat(ge);Le.y+=Mo;const De=Le.toLngLat(),Ue=P.project(De.lng,De.lat),Fe=Yf(Ue.x-ee.x,Ue.y-ee.y,pe),Ze=Math.abs(Re.x)/Math.abs(Fe.y),wt=s.identity([]);s.rotateZ(wt,wt,-pe*(1-(K?0:U)));const He=s.identity([]);return s.scale(He,He,[1,1-(1-Ze)*U,1]),He[4]=-Fe.x/Fe.y*U,s.rotateZ(He,He,pe),s.multiply(He,wt,He),He}(v.projection,0,v.center,m,d),T=Ib(v);return s.scale(w,w,[T,T,1]),w}function Ib(v){const d=v.projection,m=Zf(v.projection,v.zoom,v.width,v.height),w=Ob(d,v.center),T=Ob(d,s.LngLat.convert(d.center));return Math.pow(2,w*m+(1-m)*T)}function Zf(v,d,m,w,T=1/0){const P=v.range;if(!P)return 0;const D=Math.min(T,Math.max(m,w)),z=Math.log(D/1024)/Math.LN2;return s.smoothstep(P[0]+z,P[1]+z,d)}const Mo=1/4e4;function Ob(v,d){const m=s.clamp(d.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),w=new s.LngLat(d.lng-180*Mo,m),T=new s.LngLat(d.lng+180*Mo,m),P=v.project(w.lng,m),D=v.project(T.lng,m),z=s.MercatorCoordinate.fromLngLat(w),U=s.MercatorCoordinate.fromLngLat(T),K=D.x-P.x,X=D.y-P.y,Q=U.x-z.x,le=U.y-z.y,he=Math.sqrt((Q*Q+le*le)/(K*K+X*X));return Math.log(he)/Math.LN2}function Yf(v,d,m){const w=Math.cos(m),T=Math.sin(m);return{x:v*w-d*T,y:v*T+d*w}}class gu{constructor(d,m,w,T,P,D,z){this.tileSize=512,this._renderWorldCopies=P===void 0||P,this._minZoom=d||0,this._maxZoom=m||22,this._minPitch=w??0,this._maxPitch=T??60,this.setProjection(D),this.setMaxBounds(z),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Hf,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Kf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const d=new gu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return d._elevation=this._elevation,d._centerAltitude=this._centerAltitude,d._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,d.tileSize=this.tileSize,d.mercatorFromTransition=this.mercatorFromTransition,d.width=this.width,d.height=this.height,d.cameraElevationReference=this.cameraElevationReference,d._center=this._center,d._setZoom(this.zoom),d._seaLevelZoom=this._seaLevelZoom,d.angle=this.angle,d._fov=this._fov,d._pitch=this._pitch,d._nearZ=this._nearZ,d._farZ=this._farZ,d._averageElevation=this._averageElevation,d._unmodified=this._unmodified,d._edgeInsets=this._edgeInsets.clone(),d._camera=this._camera.clone(),d._calcMatrices(),d.freezeTileCoverage=this.freezeTileCoverage,d.frustumCorners=this.frustumCorners,d}get elevation(){return this._elevation}set elevation(d){this._elevation!==d&&(this._elevation=d,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(d,m=!1){const w=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||w)&&this._updateCameraOnTerrain(),(d||w)&&this._constrainCamera(m),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(d){this.projectionOptions=d||{name:"mercator"};const m=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const w=!p(m,this.getProjection());return w&&this._calcMatrices(),this.mercatorFromTransition=!1,w}setMercatorFromTransition(){const d=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const m=d!==this.projection.name;return m&&this._calcMatrices(),m}get minZoom(){return this._minZoom}set minZoom(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))}get maxZoom(){return this._maxZoom}set maxZoom(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))}get minPitch(){return this._minPitch}set minPitch(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))}get maxPitch(){return this._maxPitch}set maxPitch(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(d){d===void 0?d=!0:d===null&&(d=!1),this._renderWorldCopies=d}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get cameraWorldSize(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.Point(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(d){this.rotation=d}get rotation(){return-this.angle/Math.PI*180}set rotation(d){const m=-d*Math.PI/180;var w;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=(w=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w),function(T,P,D){var z=P[0],U=P[1],K=P[2],X=P[3],Q=Math.sin(D),le=Math.cos(D);T[0]=z*le+K*Q,T[1]=U*le+X*Q,T[2]=z*-Q+K*le,T[3]=U*-Q+X*le}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(d){const m=s.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const d=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/d)}set fov(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=s.degToRad(d),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(d){this._averageElevation=d,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(d){const m=Math.min(Math.max(d,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._setZoom(m),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(d){this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const d=this._elevation;this._centerAltitude=d.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=d.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const d=this._elevation,m=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],w=this.horizonLineFromTop();let T=0,P=0;for(let D=0;D<m.length;D++){const z=new s.Point(m[D][0]*this.width,w+m[D][1]*(this.height-w)),U=d.pointCoordinate(z);if(!U)continue;const K=1/Math.hypot(U[0]-this._camera.position[0],U[1]-this._camera.position[1]);T+=U[3]*K,P+=K}return P===0?NaN:T/P}get center(){return this._center}set center(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const d=this._seaLevelZoom,m=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),w=this.pixelsPerMeter/this.worldSize*m,T=this._mercatorZfromZoom(d),P=this._mercatorZfromZoom(this._maxZoom),D=Math.max(T-w,P);this._setZoom(this._zoomFromMercatorZ(D))}get padding(){return this._edgeInsets.toJSON()}set padding(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())}computeZoomRelativeTo(d){const m=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,d.toAltitude()));let w;w=d.z<this._camera.position[2]?[m.x,m.y,m.z]:[d.x,d.y,d.z];const T=s.length(s.sub([],this._camera.position,w));return s.clamp(this._zoomFromMercatorZ(T),this._minZoom,this._maxZoom)}setFreeCameraOptions(d){if(!this.height||!d.position&&!d.orientation)return;this._updateCameraState();let m=!1;if(d.orientation&&!s.exactEquals(d.orientation,this._camera.orientation)&&(m=this._setCameraOrientation(d.orientation)),d.position){const w=[d.position.x,d.position.y,d.position.z];s.exactEquals$1(w,this._camera.position)||(this._setCameraPosition(w),m=!0)}m&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const d=this._camera.position,m=new Mb;return m.position=new s.MercatorCoordinate(d[0],d[1],d[2]),m.orientation=this._camera.orientation,m._elevation=this.elevation,m._renderWorldCopies=this.renderWorldCopies,m}_setCameraOrientation(d){if(!s.length$1(d))return!1;s.normalize$1(d,d);const m=s.transformQuat([],[0,0,-1],d),w=s.transformQuat([],[0,-1,0],d);if(w[2]<0)return!1;const T=th(m,w);return!!T&&(this._camera.orientation=T,!0)}_setCameraPosition(d){const m=this.zoomScale(this.minZoom)*this.tileSize,w=this.zoomScale(this.maxZoom)*this.tileSize,T=this.cameraToCenterDistance;d[2]=s.clamp(d[2],T/w,T/m),this._camera.position=d}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(d){return this._edgeInsets.equals(d)}interpolatePadding(d,m,w){this._unmodified=!1,this._edgeInsets.interpolate(d,m,w),this._constrain(),this._calcMatrices()}coveringZoomLevel(d){const m=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(d){const m=[new s.UnwrappedTileID(0,d)];if(this.renderWorldCopies){const w=this.pointCoordinate(new s.Point(0,0)),T=this.pointCoordinate(new s.Point(this.width,0)),P=this.pointCoordinate(new s.Point(this.width,this.height)),D=this.pointCoordinate(new s.Point(0,this.height)),z=Math.floor(Math.min(w.x,T.x,P.x,D.x)),U=Math.floor(Math.max(w.x,T.x,P.x,D.x)),K=1;for(let X=z-K;X<=U+K;X++)X!==0&&m.push(new s.UnwrappedTileID(X,d))}return m}coveringTiles(d){let m=this.coveringZoomLevel(d);const w=m,T=this.elevation&&!d.isTerrainDEM,P=this.projection.name==="mercator";if(d.minzoom!==void 0&&m<d.minzoom)return[];d.maxzoom!==void 0&&m>d.maxzoom&&(m=d.maxzoom);const D=this.locationCoordinate(this.center),z=this.center.lat,U=1<<m,K=[U*D.x,U*D.y,0],X=this.projection.name==="globe",Q=!X,le=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m,Q),he=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),pe=U*s.mercatorZfromAltitude(1,this.center.lat),fe=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),ge=[U*he.x,U*he.y,fe*(Q?1:pe)],ee=this.cameraToCenterDistance/d.tileSize*(d.roundZoom?1:.502),de=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?m:0,we=d.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Se=d.isTerrainDEM?-we:this._elevation?this._elevation.getMinElevationBelowMSL():0,Re=this.projection.isReprojectedInTileSpace?Ib(this):1,Le=Ke=>{const Et=new s.MercatorCoordinate(Ke.x+25e-6,Ke.y,Ke.z),yt=new s.MercatorCoordinate(Ke.x,Ke.y+25e-6,Ke.z),jt=Ke.toLngLat(),Jt=Et.toLngLat(),lr=yt.toLngLat(),Wt=this.locationCoordinate(jt),sr=this.locationCoordinate(Jt),jr=this.locationCoordinate(lr),wr=Math.hypot(sr.x-Wt.x,sr.y-Wt.y),Yt=Math.hypot(jr.x-Wt.x,jr.y-Wt.y);return Math.sqrt(wr*Yt)*Re/25e-6},De=Ke=>{const dt=we,Et=Se;return{aabb:s.tileAABB(this,U,0,0,0,Ke,Et,dt,this.projection),zoom:0,x:0,y:0,minZ:Et,maxZ:dt,wrap:Ke,fullyVisible:!1}},Ue=[];let Fe=[];const Ze=m,wt=d.reparseOverscaled?w:m,He=Ke=>Ke*Ke,ht=He((fe-this._centerAltitude)*pe),Je=Ke=>{if(!this._elevation||!Ke.tileID||!P)return;const dt=this._elevation.getMinMaxForTile(Ke.tileID),Et=Ke.aabb;dt?(Et.min[2]=dt.min,Et.max[2]=dt.max,Et.center[2]=(Et.min[2]+Et.max[2])/2):(Ke.shouldSplit=_t(Ke),Ke.shouldSplit||(Et.min[2]=Et.max[2]=Et.center[2]=this._centerAltitude))},_t=Ke=>{if(Ke.zoom<de)return!0;if(Ke.zoom===Ze)return!1;if(Ke.shouldSplit!=null)return Ke.shouldSplit;const dt=Ke.aabb.distanceX(ge),Et=Ke.aabb.distanceY(ge);let yt=ht,jt=1;if(X){yt=He(Ke.aabb.distanceZ(ge));const Wt=Math.pow(2,Ke.zoom),sr=s.latFromMercatorY((Ke.y+1)/Wt),jr=s.latFromMercatorY(Ke.y/Wt),wr=Math.min(Math.max(z,sr),jr),Yt=s.circumferenceAtLatitude(wr)/s.circumferenceAtLatitude(z);if(jt=wr===z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Yt/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&Ke.zoom===Ze-1&&Yt>=.9)return!0}else if(T&&(yt=He(Ke.aabb.distanceZ(ge)*pe)),this.projection.isReprojectedInTileSpace&&w<=5){const Wt=Math.pow(2,Ke.zoom),sr=Le(new s.MercatorCoordinate((Ke.x+.5)/Wt,(Ke.y+.5)/Wt));jt=sr>.85?1:sr}const Jt=dt*dt+Et*Et+yt,lr=He((1<<Ze-Ke.zoom)*ee*jt*((Wt,sr)=>{if(sr*He(.707)<Wt)return 1;const jr=Math.sqrt(sr/Wt);return jr/(1.4144271570014144+(Math.pow(1.1,jr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(yt,ht),Jt));return Jt<lr};if(this.renderWorldCopies)for(let Ke=1;Ke<=3;Ke++)Ue.push(De(-Ke)),Ue.push(De(Ke));for(Ue.push(De(0));Ue.length>0;){const Ke=Ue.pop(),dt=Ke.x,Et=Ke.y;let yt=Ke.fullyVisible;if(!yt){const jt=Ke.aabb.intersects(le);if(jt===0)continue;yt=jt===2}if(Ke.zoom!==Ze&&_t(Ke))for(let jt=0;jt<4;jt++){const Jt=(dt<<1)+jt%2,lr=(Et<<1)+(jt>>1),Wt={aabb:P?Ke.aabb.quadrant(jt):s.tileAABB(this,U,Ke.zoom+1,Jt,lr,Ke.wrap,Ke.minZ,Ke.maxZ,this.projection),zoom:Ke.zoom+1,x:Jt,y:lr,wrap:Ke.wrap,fullyVisible:yt,tileID:void 0,shouldSplit:void 0,minZ:Ke.minZ,maxZ:Ke.maxZ};T&&!X&&(Wt.tileID=new s.OverscaledTileID(Ke.zoom+1===Ze?wt:Ke.zoom+1,Ke.wrap,Ke.zoom+1,Jt,lr),Je(Wt)),Ue.push(Wt)}else{const jt=Ke.zoom===Ze?wt:Ke.zoom;if(d.minzoom&&d.minzoom>jt)continue;const Jt=K[0]-(.5+dt+(Ke.wrap<<Ke.zoom))*(1<<m-Ke.zoom),lr=K[1]-.5-Et,Wt=Ke.tileID?Ke.tileID:new s.OverscaledTileID(jt,Ke.wrap,Ke.zoom,dt,Et);Fe.push({tileID:Wt,distanceSq:Jt*Jt+lr*lr})}}if(this.fogCullDistSq){const Ke=this.fogCullDistSq,dt=this.horizonLineFromTop();Fe=Fe.filter(Et=>{const yt=[0,0,0,1],jt=[s.EXTENT,s.EXTENT,0,1],Jt=this.calculateFogTileMatrix(Et.tileID.toUnwrapped());s.transformMat4$1(yt,yt,Jt),s.transformMat4$1(jt,jt,Jt);const lr=s.getAABBPointSquareDist(yt,jt);if(lr===0)return!0;let Wt=!1;const sr=this._elevation;if(sr&&lr>Ke&&dt!==0){const jr=this.calculateProjMatrix(Et.tileID.toUnwrapped());let wr;d.isTerrainDEM||(wr=sr.getMinMaxForTile(Et.tileID)),wr||(wr={min:Se,max:we});const Yt=s.furthestTileCorner(this.rotation),Xr=[Yt[0]*s.EXTENT,Yt[1]*s.EXTENT,wr.max];s.transformMat4(Xr,Xr,jr),Wt=(1-Xr[1])*this.height*.5<dt}return lr<Ke||Wt})}return Fe.sort((Ke,dt)=>Ke.distanceSq-dt.distanceSq).map(Ke=>Ke.tileID)}resize(d,m){this.width=d,this.height=m,this.pixelsToGLUnits=[2/d,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(d){return Math.pow(2,d)}scaleZoom(d){return Math.log(d)/Math.LN2}project(d){const m=s.clamp(d.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),w=this.projection.project(d.lng,m);return new s.Point(w.x*this.worldSize,w.y*this.worldSize)}unproject(d){return this.projection.unproject(d.x/this.worldSize,d.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(d,m){let w,T;const P=this.centerPoint;if(this.projection.name==="globe"){const z=this.worldSize;w=(m.x-P.x)/z,T=(m.y-P.y)/z}else{const z=this.pointCoordinate(m),U=this.pointCoordinate(P);w=z.x-U.x,T=z.y-U.y}const D=this.locationCoordinate(d);this.setLocation(new s.MercatorCoordinate(D.x-w,D.y-T))}setLocation(d){this.center=this.coordinateLocation(d),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(d){return this.projection.locationPoint(this,d)}locationPoint3D(d){return this.projection.locationPoint(this,d,!0)}pointLocation(d){return this.coordinateLocation(this.pointCoordinate(d))}pointLocation3D(d){return this.coordinateLocation(this.pointCoordinate3D(d))}locationCoordinate(d,m){const w=m?s.mercatorZfromAltitude(m,d.lat):void 0,T=this.projection.project(d.lng,d.lat);return new s.MercatorCoordinate(T.x,T.y,w)}coordinateLocation(d){return this.projection.unproject(d.x,d.y)}pointRayIntersection(d,m){const w=m??this._centerAltitude,T=[d.x,d.y,0,1],P=[d.x,d.y,1,1];s.transformMat4$1(T,T,this.pixelMatrixInverse),s.transformMat4$1(P,P,this.pixelMatrixInverse);const D=P[3];s.scale$1(T,T,1/T[3]),s.scale$1(P,P,1/D);const z=T[2],U=P[2];return{p0:T,p1:P,t:z===U?0:(w-z)/(U-z)}}screenPointToMercatorRay(d){const m=[d.x,d.y,0,1],w=[d.x,d.y,1,1];return s.transformMat4$1(m,m,this.pixelMatrixInverse),s.transformMat4$1(w,w,this.pixelMatrixInverse),s.scale$1(m,m,1/m[3]),s.scale$1(w,w,1/w[3]),m[2]=s.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,w[2]=s.mercatorZfromAltitude(w[2],this._center.lat)*this.worldSize,s.scale$1(m,m,1/this.worldSize),s.scale$1(w,w,1/this.worldSize),new s.Ray([m[0],m[1],m[2]],s.normalize([],s.sub([],w,m)))}rayIntersectionCoordinate(d){const{p0:m,p1:w,t:T}=d,P=s.mercatorZfromAltitude(m[2],this._center.lat),D=s.mercatorZfromAltitude(w[2],this._center.lat);return new s.MercatorCoordinate(s.number(m[0],w[0],T)/this.worldSize,s.number(m[1],w[1],T)/this.worldSize,s.number(P,D,T))}pointCoordinate(d,m=this._centerAltitude){return this.projection.pointCoordinate(this,d.x,d.y,m)}pointCoordinate3D(d){if(!this.elevation)return this.pointCoordinate(d);let m=this.projection.pointCoordinate3D(this,d.x,d.y);if(m)return new s.MercatorCoordinate(m[0],m[1],m[2]);let w=0,T=this.horizonLineFromTop();if(d.y>T)return this.pointCoordinate(d);const P=.02*T,D=d.clone();for(let z=0;z<10&&T-w>P;z++){D.y=s.number(w,T,.66);const U=this.projection.pointCoordinate3D(this,D.x,D.y);U?(T=D.y,m=U):w=D.y}return m?new s.MercatorCoordinate(m[0],m[1],m[2]):this.pointCoordinate(d)}isPointAboveHorizon(d){return this.projection.isPointAboveHorizon(this,d)}isPointOnSurface(d){if(d.y<0||d.y>this.height||d.x<0||d.x>this.width)return!1;if(this.elevation||this.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(d);const m=this.pointCoordinate(d);return m.y>=0&&m.y<=1}_coordinatePoint(d,m){const w=m&&this.elevation?this.elevation.getAtPointOrZero(d,this._centerAltitude):this._centerAltitude,T=[d.x*this.worldSize,d.y*this.worldSize,w+d.toAltitude(),1];return s.transformMat4$1(T,T,this.pixelMatrix),T[3]>0?new s.Point(T[0]/T[3],T[1]/T[3]):new s.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:d,left:m}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,T=this.width-this._edgeInsets.right,P=this.pointLocation3D(new s.Point(m,d)),D=this.pointLocation3D(new s.Point(T,d)),z=this.pointLocation3D(new s.Point(T,w)),U=this.pointLocation3D(new s.Point(m,w));let K=Math.min(P.lng,D.lng,z.lng,U.lng),X=Math.max(P.lng,D.lng,z.lng,U.lng),Q=Math.min(P.lat,D.lat,z.lat,U.lat),le=Math.max(P.lat,D.lat,z.lat,U.lat);const he=Math.pow(2,-this.zoom)/16*270,pe=this.projection.name==="globe"?1:4,fe=(ge,ee,de,we,Se)=>{const Re=(ge+de)/2,Le=(ee+we)/2,De=new s.Point(Re,Le),{lng:Ue,lat:Fe}=this.pointLocation3D(De),Ze=Math.max(0,K-Ue,Q-Fe,Ue-X,Fe-le);K=Math.min(K,Ue),X=Math.max(X,Ue),Q=Math.min(Q,Fe),le=Math.max(le,Fe),(Se<pe||Ze>he)&&(fe(ge,ee,Re,Le,Se+1),fe(Re,Le,de,we,Se+1))};if(fe(m,d,T,d,1),fe(T,d,T,w,1),fe(T,w,m,w,1),fe(m,w,m,d,1),this.projection.name==="globe"){const[ge,ee]=s.polesInViewport(this);ge?(le=90,X=180,K=-180):ee&&(Q=-90,X=180,K=-180)}return new s.LngLatBounds(new s.LngLat(K,Q),new s.LngLat(X,le))}_getBoundsRectangular(d,m){const{top:w,left:T}=this._edgeInsets,P=this.height-this._edgeInsets.bottom,D=this.width-this._edgeInsets.right,z=new s.Point(T,w),U=new s.Point(D,w),K=new s.Point(D,P),X=new s.Point(T,P);let Q=this.pointCoordinate(z,d),le=this.pointCoordinate(U,d);const he=this.pointCoordinate(K,m),pe=this.pointCoordinate(X,m),fe=(ge,ee)=>(ee.y-ge.y)/(ee.x-ge.x);return Q.y>1&&le.y>=0?Q=new s.MercatorCoordinate((1-pe.y)/fe(pe,Q)+pe.x,1):Q.y<0&&le.y<=1&&(Q=new s.MercatorCoordinate(-pe.y/fe(pe,Q)+pe.x,0)),le.y>1&&Q.y>=0?le=new s.MercatorCoordinate((1-he.y)/fe(he,le)+he.x,1):le.y<0&&Q.y<=1&&(le=new s.MercatorCoordinate(-he.y/fe(he,le)+he.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(le)).extend(this.coordinateLocation(pe)).extend(this.coordinateLocation(he))}_getBoundsRectangularTerrain(){const d=this.elevation;if(!d.visibleDemTiles.length||d.isUsingMockSource())return this._getBoundsRectangular(0,0);const m=d.visibleDemTiles.reduce((w,T)=>{if(T.dem){const P=T.dem.tree;w.min=Math.min(w.min,P.minimums[0]),w.max=Math.max(w.max,P.maximums[0])}return w},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(m.min*d.exaggeration(),m.max*d.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(d=!0){const m=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,w=this.height/2-m*(1-this._horizonShift);return d?Math.max(0,w):w}getMaxBounds(){return this.maxBounds}setMaxBounds(d){this.maxBounds=d,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,d&&(this.minLat=d.getSouth(),this.maxLat=d.getNorth(),this.minLng=d.getWest(),this.maxLng=d.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(d,m){return this.projection.createTileMatrix(this,m,d)}calculateDistanceTileData(d){const m=d.key,w=this._distanceTileDataCache;if(w[m])return w[m];const T=d.canonical,P=1/this.height,D=this.cameraWorldSize,z=D/this.zoomScale(T.z),U=(T.x+Math.pow(2,T.z)*d.wrap)*z,K=T.y*z,X=this.point;X.x*=D/this.worldSize,X.y*=D/this.worldSize;const Q=this.angle,le=Math.sin(-Q),he=-Math.cos(-Q);return w[m]={bearing:[le,he],center:[(X.x-U)*P,(X.y-K)*P],scale:z/s.EXTENT*P},w[m]}calculateFogTileMatrix(d){const m=d.key,w=this._fogTileMatrixCache;if(w[m])return w[m];const T=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,d);return s.multiply(T,this.worldToFogMatrix,T),w[m]=new Float32Array(T),w[m]}calculateProjMatrix(d,m=!1){const w=d.key,T=m?this._alignedProjMatrixCache:this._projMatrixCache;if(T[w])return T[w];const P=this.calculatePosMatrix(d,this.worldSize);return s.multiply(P,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.alignedProjMatrix:this.projMatrix,P),T[w]=new Float32Array(P),T[w]}calculatePixelsToTileUnitsMatrix(d){const m=d.tileID.key,w=this._pixelsToTileUnitsCache;if(w[m])return w[m];const T=function(P,D){const{scale:z}=P.tileTransform,U=z*s.EXTENT/(P.tileSize*Math.pow(2,D.zoom-P.tileID.overscaledZ+P.tileID.canonical.z));return K=new Float32Array(4),le=(X=D.inverseAdjustmentMatrix)[1],he=X[2],pe=X[3],ge=(Q=[U,U])[1],K[0]=X[0]*(fe=Q[0]),K[1]=le*fe,K[2]=he*ge,K[3]=pe*ge,K;var K,X,Q,le,he,pe,fe,ge}(d,this);return w[m]=T,w[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const d=1/this.worldSize,m=s.fromScaling([],[d,d,d]);return s.multiply(m,m,this.globeMatrix),m}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const d=this._elevation;this._updateCameraState();const m=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(m),T=this._camera.forward(),P=s.mercatorZfromAltitude(1,this._center.lat);w[2]/=P,T[2]/=P,s.normalize(T,T);const D=d.raycast(w,T,d.exaggeration());if(D){const z=s.scaleAndAdd([],w,T,D),U=new s.MercatorCoordinate(z[0],z[1],s.mercatorZfromAltitude(z[2],s.latFromMercatorY(z[1]))),K=(U.z+s.length([U.x-w[0],U.y-w[1],U.z-w[2]*P]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(K),this._centerAltitude=U.toAltitude(),this._center=this.coordinateLocation(U),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(d=!1){if(!this._elevation)return;const m=this._elevation,w=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,T=this._computeCameraPosition(w),P=m.getAtPointOrZero(new s.MercatorCoordinate(...T)),D=this.pixelsPerMeter/this.worldSize*P,z=this._minimumHeightOverTerrain(),U=T[2]-D;if(U<=z)if(U<0||d){const K=this.locationCoordinate(this._center,this._centerAltitude),X=[T[0],T[1],K.z-T[2]],Q=s.length(X);X[2]-=(z-U)/this._pixelsPerMercatorPixel;const le=s.length(X);if(le===0)return;s.scale$2(X,X,Q/le*this._pixelsPerMercatorPixel),this._camera.position=[T[0],T[1],K.z*this._pixelsPerMercatorPixel-X[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const d=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||d){const le=this.center;return le.lat=s.clamp(le.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!d)&&(le.lng=s.clamp(le.lng,this.minLng,this.maxLng)),this.center=le,void(this._constraining=!1)}const m=this._unmodified,{x:w,y:T}=this.point;let P=0,D=w,z=T;const U=this.width/2,K=this.height/2,X=this.worldMinY*this.scale,Q=this.worldMaxY*this.scale;if(T-K<X&&(z=X+K),T+K>Q&&(z=Q-K),Q-X<this.height&&(P=Math.max(P,this.height/(Q-X)),z=(Q+X)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const le=this.worldMinX*this.scale,he=this.worldMaxX*this.scale,pe=this.worldSize/2-(le+he)/2;D=(w+pe+this.worldSize)%this.worldSize-pe,D-U<le&&(D=le+U),D+U>he&&(D=he-U),he-le<this.width&&(P=Math.max(P,this.width/(he-le)),D=(he+le)/2)}D===w&&z===T||(this.center=this.unproject(new s.Point(D,z))),P&&(this.zoom+=this.scaleZoom(P)),this._constrainCamera(),this._unmodified=m,this._constraining=!1}_minZoomForBounds(){let d=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(d=Math.max(d,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),d}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const d=this.centerOffset,m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const w=Zf(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,w),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const T=this.projection.zAxisUnit==="meters"?m:1,P=this._camera.getWorldToCamera(this.worldSize,T),D=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);D[8]=2*-d.x/this.width,D[9]=2*d.y/this.height;let z=s.mul([],D,P);if(this.projection.isReprojectedInTileSpace){const Le=this.locationCoordinate(this.center),De=s.identity([]);s.translate(De,De,[Le.x*this.worldSize,Le.y*this.worldSize,0]),s.multiply(De,De,mu(this)),s.translate(De,De,[-Le.x*this.worldSize,-Le.y*this.worldSize,0]),s.multiply(z,z,De),this.inverseAdjustmentMatrix=function(Ue){const Fe=mu(Ue,!0);return W([],[Fe[0],Fe[1],Fe[4],Fe[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],z,[this.worldSize,this.worldSize,this.worldSize/T,1]),this.projMatrix=z,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const U=s.invert([],D);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(U,this.horizonLineFromTop(),this.height);const K=new Float32Array(16);s.identity(K),s.scale(K,K,[1,-1,1]),s.rotateX(K,K,this._pitch),s.rotateZ(K,K,this.angle);const X=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Q=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;X[8]=2*-d.x/this.width,X[9]=2*(d.y+Q)/this.height,this.skyboxMatrix=s.multiply(K,X,K);const le=this.point,he=le.x,pe=le.y,fe=this.width%2/2,ge=this.height%2/2,ee=Math.cos(this.angle),de=Math.sin(this.angle),we=he-Math.round(he)+ee*fe+de*ge,Se=pe-Math.round(pe)+ee*ge+de*fe,Re=new Float64Array(z);if(s.translate(Re,Re,[we>.5?we-1:we,Se>.5?Se-1:Se,0]),this.alignedProjMatrix=Re,z=s.create(),s.scale(z,z,[this.width/2,-this.height/2,1]),s.translate(z,z,[1,-1,0]),this.labelPlaneMatrix=z,z=s.create(),s.scale(z,z,[1,-1,1]),s.translate(z,z,[-1,-1,0]),s.scale(z,z,[2/this.width,2/this.height,1]),this.glCoordMatrix=z,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},z=s.invert(new Float64Array(16),this.pixelMatrix),!z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=z,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const Le=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(Le,Le,P),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const d=this.cameraWorldSizeForFog,m=this.cameraPixelsPerMeter,w=this._camera.position,T=1/this.height/this._pixelsPerMercatorPixel,P=[d,d,m];s.scale$2(P,P,T),s.scale$2(w,w,-1),s.multiply$2(w,w,P);const D=s.create();s.translate(D,D,w),s.scale(D,D,P),this.mercatorFogMatrix=D,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(d,m,T)}_computeCameraPosition(d){const m=(d=d||this.pixelsPerMeter)/this.pixelsPerMeter,w=this._camera.forward(),T=this.point,P=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*m-d/this.worldSize*this._centerAltitude;return[T.x/this.worldSize-w[0]*P,T.y/this.worldSize-w[1]*P,d/this.worldSize*this._centerAltitude-w[2]*P]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(d){const m=this._maxCameraBoundsDistance()*Math.cos(this._pitch),w=this._camera.position[2],T=d[2];let P=1;this.projection.wrap&&(this.center=this.center.wrap()),T>0&&(P=Math.min((m-w)/T,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,d,P),this._updateStateFromCamera()}_updateStateFromCamera(){const d=this._camera.position,m=this._camera.forward(),{pitch:w,bearing:T}=this._camera.getPitchBearing(),P=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,D=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),z=Math.max((d[2]-P)/Math.cos(w),D),U=this._zoomFromMercatorZ(z);s.scaleAndAdd(d,d,m,z),this._pitch=s.clamp(w,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(T,-Math.PI,Math.PI),this._setZoom(s.clamp(U,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(d[0],d[1],d[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(d){return Math.pow(2,d)*this.tileSize}_mercatorZfromZoom(d){return this.cameraToCenterDistance/this._worldSizeFromZoom(d)}_minimumHeightOverTerrain(){const d=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(d)}_zoomFromMercatorZ(d){return this.scaleZoom(this.cameraToCenterDistance/(d*this.tileSize))}zoomFromMercatorZAdjusted(d){let m=0,w=s.GLOBE_ZOOM_THRESHOLD_MAX,T=0,P=1/0;for(;w-m>1e-6&&w>m;){const D=m+.5*(w-m),z=this.tileSize*Math.pow(2,D),U=this.getCameraToCenterDistance(this.projection,D,z),K=this.scaleZoom(U/(d*this.tileSize)),X=Math.abs(D-K);X<P&&(P=X,T=D),D<K?m=D:w=D}return T}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(d,m){const w=Math.min(d.x,m.x),T=Math.max(d.x,m.x),P=Math.min(d.y,m.y),D=Math.max(d.y,m.y);if(P<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const z=[new s.Point(w,P),new s.Point(T,D),new s.Point(w,D),new s.Point(T,P)],U=this.renderWorldCopies?-3:0,K=this.renderWorldCopies?4:1;for(const X of z){const Q=this.pointRayIntersection(X);if(Q.t<0)return!0;const le=this.rayIntersectionCoordinate(Q);if(le.x<U||le.y<0||le.x>K||le.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.Point(0,0),new s.Point(this.width,this.height))}zoomDeltaToMovement(d,m){const w=s.length(s.sub([],this._camera.position,d)),T=this._zoomFromMercatorZ(w)+m;return w-this._mercatorZfromZoom(T)}getCameraPoint(){if(this.projection.name==="globe"){const d=function([m,w,T],P){const D=[m,w,T,1];s.transformMat4$1(D,D,P);const z=D[3]=Math.max(D[3],1e-6);return D[0]/=z,D[1]/=z,D[2]/=z,D}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.Point(d[0],d[1])}{const d=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,d))}}getCameraToCenterDistance(d,m=this.zoom,w=this.worldSize){const T=Zf(d,m,this.width,this.height,1024),P=d.pixelSpaceConversion(this.center.lat,w,T);return .5/Math.tan(.5*this._fov)*this.height*P}getWorldToCameraMatrix(){const d=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(d,d,this.globeMatrix),d}}function yu(v,d){let m=!1,w=null;const T=()=>{w=null,m&&(v(),w=setTimeout(T,d),m=!1)};return()=>(m=!0,w||T(),w)}class gy{constructor(d){this._hashName=d&&encodeURIComponent(d),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=yu(this._updateHashUnthrottled.bind(this),300)}addTo(d){return this._map=d,s.window.addEventListener("hashchange",this._onHashChange,!1),d.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const d=this._map;if(!d)return"";const m=rh(d);if(this._hashName){const w=this._hashName;let T=!1;const P=s.window.location.hash.slice(1).split("&").map(D=>{const z=D.split("=")[0];return z===w?(T=!0,`${z}=${m}`):D}).filter(D=>D);return T||P.push(`${w}=${m}`),`#${P.join("&")}`}return`#${m}`}_getCurrentHash(){const d=s.window.location.hash.replace("#","");if(this._hashName){let m;return d.split("&").map(w=>w.split("=")).forEach(w=>{w[0]===this._hashName&&(m=w)}),(m&&m[1]||"").split("/")}return d.split("/")}_onHashChange(){const d=this._map;if(!d)return!1;const m=this._getCurrentHash();if(m.length>=3&&!m.some(w=>isNaN(w))){const w=d.dragRotate.isEnabled()&&d.touchZoomRotate.isEnabled()?+(m[3]||0):d.getBearing();return d.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:w,pitch:+(m[4]||0)}),!0}return!1}_updateHashUnthrottled(){const d=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,d)}}function rh(v,d){const m=v.getCenter(),w=Math.round(100*v.getZoom())/100,T=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,T),D=Math.round(m.lng*P)/P,z=Math.round(m.lat*P)/P,U=v.getBearing(),K=v.getPitch();let X=d?`/${D}/${z}/${w}`:`${w}/${z}/${D}`;return(U||K)&&(X+="/"+Math.round(10*U)/10),K&&(X+=`/${Math.round(K)}`),X}const nh={linearity:.3,easing:s.bezier(0,0,.3,1)},Jf=s.extend({deceleration:2500,maxSpeed:1400},nh),Qf=s.extend({deceleration:20,maxSpeed:1400},nh),Ft=s.extend({deceleration:1e3,maxSpeed:360},nh),_a=s.extend({deceleration:1e3,maxSpeed:90},nh);class Rb{constructor(d){this._map=d,this.clear()}clear(){this._inertiaBuffer=[]}record(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:d})}_drainInertiaBuffer(){const d=this._inertiaBuffer,m=s.exported.now();for(;d.length>0&&m-d[0].time>160;)d.shift()}_onMoveEnd(d){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const m={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)m.zoom+=P.zoomDelta||0,m.bearing+=P.bearingDelta||0,m.pitch+=P.pitchDelta||0,P.panDelta&&m.pan._add(P.panDelta),P.around&&(m.around=P.around),P.pinchAround&&(m.pinchAround=P.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(m.pan.mag()){const P=sh(m.pan.mag(),w,s.extend({},Jf,d||{}));T.offset=m.pan.mult(P.amount/m.pan.mag()),T.center=this._map.transform.center,ih(T,P)}if(m.zoom){const P=sh(m.zoom,w,Qf);T.zoom=this._map.transform.zoom+P.amount,ih(T,P)}if(m.bearing){const P=sh(m.bearing,w,Ft);T.bearing=this._map.transform.bearing+s.clamp(P.amount,-179,179),ih(T,P)}if(m.pitch){const P=sh(m.pitch,w,_a);T.pitch=this._map.transform.pitch+P.amount,ih(T,P)}if(T.zoom||T.bearing){const P=m.pinchAround===void 0?m.around:m.pinchAround;T.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),T.noMoveStart=!0,T}}function ih(v,d){(!v.duration||v.duration<d.duration)&&(v.duration=d.duration,v.easing=d.easing)}function sh(v,d,m){const{maxSpeed:w,linearity:T,deceleration:P}=m,D=s.clamp(v*T/(d/1e3),-w,w),z=Math.abs(D)/(P*T);return{easing:m.easing,duration:1e3*z,amount:D*(z/2)}}class _i extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,m,w,T={}){const P=F(m.getCanvasContainer(),w),D=m.unproject(P);super(d,s.extend({point:P,lngLat:D,originalEvent:w},T)),this._defaultPrevented=!1,this.target=m}}class ah extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,m,w){const T=d==="touchend"?w.changedTouches:w.touches,P=H(m.getCanvasContainer(),T),D=P.map(U=>m.unproject(U)),z=P.reduce((U,K,X,Q)=>U.add(K.div(Q.length)),new s.Point(0,0));super(d,{points:P,point:z,lngLats:D,lngLat:m.unproject(z),originalEvent:w}),this._defaultPrevented=!1}}class ep extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,m,w){super(d,{originalEvent:w}),this._defaultPrevented=!1}}class yy{constructor(d,m){this._map=d,this._clickTolerance=m.clickTolerance}reset(){this._mousedownPos=void 0}wheel(d){return this._firePreventable(new ep(d.type,this._map,d))}mousedown(d,m){return this._mousedownPos=m,this._firePreventable(new _i(d.type,this._map,d))}mouseup(d){this._map.fire(new _i(d.type,this._map,d))}preclick(d){const m=s.extend({},d);m.type="preclick",this._map.fire(new _i(m.type,this._map,m))}click(d,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||(this.preclick(d),this._map.fire(new _i(d.type,this._map,d)))}dblclick(d){return this._firePreventable(new _i(d.type,this._map,d))}mouseover(d){this._map.fire(new _i(d.type,this._map,d))}mouseout(d){this._map.fire(new _i(d.type,this._map,d))}touchstart(d){return this._firePreventable(new ah(d.type,this._map,d))}touchmove(d){this._map.fire(new ah(d.type,this._map,d))}touchend(d){this._map.fire(new ah(d.type,this._map,d))}touchcancel(d){this._map.fire(new ah(d.type,this._map,d))}_firePreventable(d){if(this._map.fire(d),d.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class tp{constructor(d){this._map=d}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(d){this._map.fire(new _i(d.type,this._map,d))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _i("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(d){this._delayContextMenu?this._contextMenuEvent=d:this._map.fire(new _i(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Db{constructor(d,m){this._map=d,this._el=d.getCanvasContainer(),this._container=d.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(d,m){this.isEnabled()&&d.shiftKey&&d.button===0&&(R(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(d,m){if(!this._active)return;const w=m,T=this._startPos,P=this._lastPos;if(!T||!P||P.equals(w)||!this._box&&w.dist(T)<this._clickTolerance)return;this._lastPos=w,this._box||(this._box=E("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",d));const D=Math.min(T.x,w.x),z=Math.max(T.x,w.x),U=Math.min(T.y,w.y),K=Math.max(T.y,w.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${D}px,${U}px)`,this._box.style.width=z-D+"px",this._box.style.height=K-U+"px")})}mouseupWindow(d,m){if(!this._active)return;const w=this._startPos,T=m;if(w&&d.button===0){if(this.reset(),q(),w.x!==T.x||w.y!==T.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:P=>P.fitScreenCoordinates(w,T,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",d)}}keydown(d){this._active&&d.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",d))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),L(),delete this._startPos,delete this._lastPos}_fireEvent(d,m){return this._map.fire(new s.Event(d,{originalEvent:m}))}}function rp(v,d){const m={};for(let w=0;w<v.length;w++)m[v[w].identifier]=d[w];return m}class vu{constructor(d){this.reset(),this.numTouches=d.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(d,m,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=d.timeStamp),w.length===this.numTouches&&(this.centroid=function(T){const P=new s.Point(0,0);for(const D of T)P._add(D);return P.div(T.length)}(m),this.touches=rp(w,m)))}touchmove(d,m,w){if(this.aborted||!this.centroid)return;const T=rp(w,m);for(const P in this.touches){const D=T[P];(!D||D.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(d,m,w){if((!this.centroid||d.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){const T=!this.aborted&&this.centroid;if(this.reset(),T)return T}}}class vy{constructor(d){this.singleTap=new vu(d),this.numTaps=d.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(d,m,w){this.singleTap.touchstart(d,m,w)}touchmove(d,m,w){this.singleTap.touchmove(d,m,w)}touchend(d,m,w){const T=this.singleTap.touchend(d,m,w);if(T){const P=d.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(T)<30;if(P&&D||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=T,this.count===this.numTaps)return this.reset(),T}}}class sT{constructor(){this._zoomIn=new vy({numTouches:1,numTaps:2}),this._zoomOut=new vy({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(d,m,w){this._zoomIn.touchstart(d,m,w),this._zoomOut.touchstart(d,m,w)}touchmove(d,m,w){this._zoomIn.touchmove(d,m,w),this._zoomOut.touchmove(d,m,w)}touchend(d,m,w){const T=this._zoomIn.touchend(d,m,w),P=this._zoomOut.touchend(d,m,w);return T?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()+1,around:D.unproject(T)},{originalEvent:d})}):P?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()-1,around:D.unproject(P)},{originalEvent:d})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Lb={0:1,2:2};class xu{constructor(d){this.reset(),this._clickTolerance=d.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(d,m){return!1}_move(d,m){return{}}mousedown(d,m){if(this._lastPoint)return;const w=Z(d);this._correctButton(d,w)&&(this._lastPoint=m,this._eventButton=w)}mousemoveWindow(d,m){const w=this._lastPoint;if(w){if(d.preventDefault(),this._eventButton!=null&&function(T,P){const D=Lb[P];return T.buttons===void 0||(T.buttons&D)!==D}(d,this._eventButton))this.reset();else if(this._moved||!(m.dist(w)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(w,m)}}mouseupWindow(d){this._lastPoint&&Z(d)===this._eventButton&&(this._moved&&q(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xy extends xu{mousedown(d,m){super.mousedown(d,m),this._lastPoint&&(this._active=!0)}_correctButton(d,m){return m===0&&!d.ctrlKey}_move(d,m){return{around:m,panDelta:m.sub(d)}}}class by extends xu{_correctButton(d,m){return m===0&&d.ctrlKey||m===2}_move(d,m){const w=.8*(m.x-d.x);if(w)return this._active=!0,{bearingDelta:w}}contextmenu(d){d.preventDefault()}}class _y extends xu{_correctButton(d,m){return m===0&&d.ctrlKey||m===2}_move(d,m){const w=-.5*(m.y-d.y);if(w)return this._active=!0,{pitchDelta:w}}contextmenu(d){d.preventDefault()}}class np{constructor(d,m){this._map=d,this._el=d.getCanvasContainer(),this._minTouches=1,this._clickTolerance=m.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)}touchstart(d,m,w){return this._calculateTransform(d,m,w)}touchmove(d,m,w){if(this._active&&!(w.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(w.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return d.cancelable&&d.preventDefault(),this._calculateTransform(d,m,w)}}touchend(d,m,w){this._calculateTransform(d,m,w),this._active&&w.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(d,m,w){w.length>0&&(this._active=!0);const T=rp(w,m),P=new s.Point(0,0),D=new s.Point(0,0);let z=0;for(const K in T){const X=T[K],Q=this._touches[K];Q&&(P._add(X),D._add(X.sub(Q)),z++,T[K]=X)}if(this._touches=T,z<this._minTouches||!D.mag())return;const U=D.div(z);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(z),panDelta:U}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class oh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(d){}_move(d,m,w){return{}}touchstart(d,m,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([m[0],m[1]]))}touchmove(d,m,w){const T=this._firstTwoTouches;if(!T)return;d.preventDefault();const[P,D]=T,z=lh(w,m,P),U=lh(w,m,D);if(!z||!U)return;const K=this._aroundCenter?null:z.add(U).div(2);return this._move([z,U],K,d)}touchend(d,m,w){if(!this._firstTwoTouches)return;const[T,P]=this._firstTwoTouches,D=lh(w,m,T),z=lh(w,m,P);D&&z||(this._active&&q(),this.reset())}touchcancel(){this.reset()}enable(d){this._enabled=!0,this._aroundCenter=!!d&&d.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function lh(v,d,m){for(let w=0;w<v.length;w++)if(v[w].identifier===m)return d[w]}function wy(v,d){return Math.log(v/d)/Math.LN2}class Bb extends oh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(d){this._startDistance=this._distance=d[0].dist(d[1])}_move(d,m){const w=this._distance;if(this._distance=d[0].dist(d[1]),this._active||!(Math.abs(wy(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:wy(this._distance,w),pinchAround:m}}}function Sy(v,d){return 180*v.angleWith(d)/Math.PI}class zb extends oh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(d){this._startVector=this._vector=d[0].sub(d[1]),this._minDiameter=d[0].dist(d[1])}_move(d,m){const w=this._vector;if(this._vector=d[0].sub(d[1]),w&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Sy(this._vector,w),pinchAround:m}}_isBelowThreshold(d){this._minDiameter=Math.min(this._minDiameter,d.mag());const m=25/(Math.PI*this._minDiameter)*360,w=this._startVector;if(!w)return!1;const T=Sy(d,w);return Math.abs(T)<m}}function xl(v){return Math.abs(v.y)>Math.abs(v.x)}class $b extends oh{constructor(d){super(),this._map=d}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(d){this._lastPoints=d,xl(d[0].sub(d[1]))&&(this._valid=!1)}_move(d,m,w){const T=this._lastPoints;if(!T)return;const P=d[0].sub(T[0]),D=d[1].sub(T[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&w.touches.length<3||(this._valid=this.gestureBeginsVertically(P,D,w.timeStamp),!this._valid)?void 0:(this._lastPoints=d,this._active=!0,{pitchDelta:(P.y+D.y)/2*-.5})}gestureBeginsVertically(d,m,w){if(this._valid!==void 0)return this._valid;const T=d.mag()>=2,P=m.mag()>=2;if(!T&&!P)return;if(!T||!P)return this._firstMove==null&&(this._firstMove=w),w-this._firstMove<100&&void 0;const D=d.y>0==m.y>0;return xl(d)&&xl(m)&&D}}const Fb={panStep:100,bearingStep:15,pitchStep:10};class aT{constructor(){const d=Fb;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(d){if(d.altKey||d.ctrlKey||d.metaKey)return;let m=0,w=0,T=0,P=0,D=0;switch(d.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:d.shiftKey?w=-1:(d.preventDefault(),P=-1);break;case 39:d.shiftKey?w=1:(d.preventDefault(),P=1);break;case 38:d.shiftKey?T=1:(d.preventDefault(),D=-1);break;case 40:d.shiftKey?T=-1:(d.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(w=0,T=0),{cameraAnimation:z=>{const U=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:Ub,zoom:m?Math.round(U)+m*(d.shiftKey?2:1):U,bearing:z.getBearing()+w*this._bearingStep,pitch:z.getPitch()+T*this._pitchStep,offset:[-P*this._panStep,-D*this._panStep],center:z.getCenter()},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ub(v){return v*(2-v)}const Ey=4.000244140625;class Vb{constructor(d,m){this._map=d,this._el=d.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(d){this._defaultZoomRate=d}setWheelZoomRate(d){this._wheelZoomRate=d}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!d&&d.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(d){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(d.ctrlKey||d.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let m=d.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY;const w=s.exported.now(),T=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,m!==0&&m%Ey==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":T>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(T*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),d.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=d,this._delta-=m,this._active||this._start(d)),d.preventDefault()}_onTimeout(d){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)}_start(d){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=F(this._el,d);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:m,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const d=this._map.transform;this._type==="wheel"&&d.projection.wrap&&(d._center.lng>=180||d._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const m=()=>d._terrainEnabled()&&this._aroundCoord?d.computeZoomRelativeTo(this._aroundCoord):d.zoom;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>Ey?this._wheelZoomRate:this._defaultZoomRate;let K=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&K!==0&&(K=1/K);const X=m(),Q=Math.pow(2,X),le=typeof this._targetZoom=="number"?d.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(d.maxZoom,Math.max(d.minZoom,d.scaleZoom(le*K))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._delta=0}const w=typeof this._targetZoom=="number"?this._targetZoom:m(),T=this._startZoom,P=this._easing;let D,z=!1;if(this._type==="wheel"&&T&&P){const U=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),K=P(U);D=s.number(T,w,K),U<1?this._frameId||(this._frameId=!0):z=!0}else D=w,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:D-m(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(d){let m=s.ease;if(this._prevEase){const w=this._prevEase,T=(s.exported.now()-w.start)/w.duration,P=w.easing(T+.01)-w.easing(T),D=.27/Math.sqrt(P*P+1e-4)*.01,z=Math.sqrt(.0729-D*D);m=s.bezier(D,z,.25,1)}return this._prevEase={start:s.exported.now(),duration:d,easing:m},m}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class qb{constructor(d,m){this._clickZoom=d,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Hi{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(d,m){return d.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:w.getZoom()+(d.shiftKey?-1:1),around:w.unproject(m)},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class oT{constructor(){this._tap=new vy({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(d,m,w){this._swipePoint||(this._tapTime&&d.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?w.length>0&&(this._swipePoint=m[0],this._swipeTouch=w[0].identifier):this._tap.touchstart(d,m,w))}touchmove(d,m,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const T=m[0],P=T.y-this._swipePoint.y;return this._swipePoint=T,d.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(d,m,w)}touchend(d,m,w){this._tapTime?this._swipePoint&&w.length===0&&this.reset():this._tap.touchend(d,m,w)&&(this._tapTime=d.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wb{constructor(d,m,w){this._el=d,this._mousePan=m,this._touchPan=w}enable(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class lT{constructor(d,m,w){this._pitchWithRotate=d.pitchWithRotate,this._mouseRotate=m,this._mousePitch=w}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class cT{constructor(d,m,w,T){this._el=d,this._touchZoom=m,this._touchRotate=w,this._tapDragZoom=T,this._rotationDisabled=!1,this._enabled=!0}enable(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ea=v=>v.zoom||v.drag||v.pitch||v.rotate;class Gb extends s.Event{}class uT{constructor(){this.constants=[1,1,.01],this.radius=0}setup(d,m){const w=s.sub([],m,d);this.radius=s.length(w[2]<0?s.div([],w,this.constants):[w[0],w[1],0])}projectRay(d){s.div(d,d,this.constants),s.normalize(d,d),s.mul$1(d,d,this.constants);const m=s.scale$2([],d,this.radius);if(m[2]>0){const w=s.scale$2([],[0,0,1],s.dot(m,[0,0,1])),T=s.scale$2([],s.normalize([],[m[0],m[1],0]),this.radius),P=s.add([],m,s.scale$2([],s.sub([],s.add([],T,w),m),2));m[0]=P[0],m[1]=P[1]}return m}}function wa(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class Xa{constructor(d,m){this._map=d,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Rb(d),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new uT,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(m),s.bindAll(["handleEvent","handleWindowEvent"],this);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[T,P,D]of this._listeners)T.addEventListener(P,T===s.window.document?this.handleWindowEvent:this.handleEvent,D)}destroy(){for(const[d,m,w]of this._listeners)d.removeEventListener(m,d===s.window.document?this.handleWindowEvent:this.handleEvent,w)}_addDefaultHandlers(d){const m=this._map,w=m.getCanvasContainer();this._add("mapEvent",new yy(m,d));const T=m.boxZoom=new Db(m,d);this._add("boxZoom",T);const P=new sT,D=new Hi;m.doubleClickZoom=new qb(D,P),this._add("tapZoom",P),this._add("clickZoom",D);const z=new oT;this._add("tapDragZoom",z);const U=m.touchPitch=new $b(m);this._add("touchPitch",U);const K=new by(d),X=new _y(d);m.dragRotate=new lT(d,K,X),this._add("mouseRotate",K,["mousePitch"]),this._add("mousePitch",X,["mouseRotate"]);const Q=new xy(d),le=new np(m,d);m.dragPan=new Wb(w,Q,le),this._add("mousePan",Q),this._add("touchPan",le,["touchZoom","touchRotate"]);const he=new zb,pe=new Bb;m.touchZoomRotate=new cT(w,pe,he,z),this._add("touchRotate",he,["touchPan","touchZoom"]),this._add("touchZoom",pe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new tp(m));const fe=m.scrollZoom=new Vb(m,this);this._add("scrollZoom",fe,["mousePan"]);const ge=m.keyboard=new aT;this._add("keyboard",ge);for(const ee of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])d.interactive&&d[ee]&&m[ee].enable(d[ee])}_add(d,m,w){this._handlers.push({handlerName:d,handler:m,allowed:w}),this._handlersById[d]=m}stop(d){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}}isActive(){for(const{handler:d}of this._handlers)if(d.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ea(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(d,m,w){for(const T in d)if(T!==w&&(!m||m.indexOf(T)<0))return!0;return!1}handleWindowEvent(d){this.handleEvent(d,`${d.type}Window`)}_getMapTouches(d){const m=[];for(const w of d)this._el.contains(w.target)&&m.push(w);return m}handleEvent(d,m){this._updatingCamera=!0;const w=d.type==="renderFrame",T=w?void 0:d,P={needsRenderFrame:!1},D={},z={},U=d.touches?this._getMapTouches(d.touches):void 0,K=U?H(this._el,U):w?void 0:F(this._el,d);for(const{handlerName:le,handler:he,allowed:pe}of this._handlers){if(!he.isEnabled())continue;let fe;this._blockedByActive(z,pe,le)?he.reset():he[m||d.type]&&(fe=he[m||d.type](d,K,U),this.mergeHandlerResult(P,D,fe,le,T),fe&&fe.needsRenderFrame&&this._triggerRenderFrame()),(fe||he.isActive())&&(z[le]=he)}const X={};for(const le in this._previousActiveHandlers)z[le]||(X[le]=T);this._previousActiveHandlers=z,(Object.keys(X).length||wa(P))&&(this._changes.push([P,D,X]),this._triggerRenderFrame()),(Object.keys(z).length||wa(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=P;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))}mergeHandlerResult(d,m,w,T,P){if(!w)return;s.extend(d,w);const D={handlerName:T,originalEvent:w.originalEvent||P};w.zoomDelta!==void 0&&(m.zoom=D),w.panDelta!==void 0&&(m.drag=D),w.pitchDelta!==void 0&&(m.pitch=D),w.bearingDelta!==void 0&&(m.rotate=D)}_applyChanges(){const d={},m={},w={};for(const[T,P,D]of this._changes)T.panDelta&&(d.panDelta=(d.panDelta||new s.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(d.zoomDelta=(d.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(d.bearingDelta=(d.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(d.pitchDelta=(d.pitchDelta||0)+T.pitchDelta),T.around!==void 0&&(d.around=T.around),T.aroundCoord!==void 0&&(d.aroundCoord=T.aroundCoord),T.pinchAround!==void 0&&(d.pinchAround=T.pinchAround),T.noInertia&&(d.noInertia=T.noInertia),s.extend(m,P),s.extend(w,D);this._updateMapTransform(d,m,w),this._changes=[]}_updateMapTransform(d,m,w){const T=this._map,P=T.transform,D=de=>[de.x,de.y,de.z];if((de=>{const we=this._eventsInProgress.drag;return we&&!this._handlersById[we.handlerName].isActive()})()&&!wa(d)){const de=P.zoom;P.cameraElevationReference="sea",P.recenterOnTerrain(),P.cameraElevationReference="ground",de!==P.zoom&&this._map._update(!0)}if(P._isCameraConstrained&&T._stop(!0),!wa(d))return void this._fireEvents(m,w,!0);let{panDelta:z,zoomDelta:U,bearingDelta:K,pitchDelta:X,around:Q,aroundCoord:le,pinchAround:he}=d;P._isCameraConstrained&&(U>0&&(U=0),P._isCameraConstrained=!1),he!==void 0&&(Q=he),(U||(de=>m[de]&&!this._eventsInProgress[de])("drag"))&&Q&&(this._dragOrigin=D(P.pointCoordinate3D(Q)),this._trackingEllipsoid.setup(P._camera.position,this._dragOrigin)),P.cameraElevationReference="sea",T._stop(!0),Q=Q||T.transform.centerPoint,K&&(P.bearing+=K),X&&(P.pitch+=X),P._updateCameraState();const pe=[0,0,0];if(z)if(P.projection.name==="mercator"){const de=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(Q).dir),we=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(Q.sub(z)).dir);pe[0]=we[0]-de[0],pe[1]=we[1]-de[1]}else{const de=P.pointCoordinate(Q);if(P.projection.name==="globe"){z=z.rotate(-P.angle);const we=P._pixelsPerMercatorPixel/P.worldSize;pe[0]=-z.x*s.mercatorScale(s.latFromMercatorY(de.y))*we,pe[1]=-z.y*s.mercatorScale(P.center.lat)*we}else{const we=P.pointCoordinate(Q.sub(z));de&&we&&(pe[0]=we.x-de.x,pe[1]=we.y-de.y)}}const fe=P.zoom,ge=[0,0,0];if(U){const de=D(le||P.pointCoordinate3D(Q)),we={dir:s.normalize([],s.sub([],de,P._camera.position))};if(we.dir[2]<0){const Se=P.zoomDeltaToMovement(de,U);s.scale$2(ge,we.dir,Se)}}const ee=s.add(pe,pe,ge);P._translateCameraConstrained(ee),U&&Math.abs(P.zoom-fe)>1e-4&&P.recenterOnTerrain(),P.cameraElevationReference="ground",this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(m,w,!0)}_fireEvents(d,m,w){const T=ea(this._eventsInProgress),P=ea(d),D={};for(const X in d){const{originalEvent:Q}=d[X];this._eventsInProgress[X]||(D[`${X}start`]=Q),this._eventsInProgress[X]=d[X]}!T&&P&&this._fireEvent("movestart",P.originalEvent);for(const X in D)this._fireEvent(X,D[X]);P&&this._fireEvent("move",P.originalEvent);for(const X in d){const{originalEvent:Q}=d[X];this._fireEvent(X,Q)}const z={};let U;for(const X in this._eventsInProgress){const{handlerName:Q,originalEvent:le}=this._eventsInProgress[X];this._handlersById[Q].isActive()||(delete this._eventsInProgress[X],U=m[Q]||le,z[`${X}end`]=U)}for(const X in z)this._fireEvent(X,z[X]);const K=ea(this._eventsInProgress);if(w&&(T||P)&&!K){this._updatingCamera=!0;const X=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Q=le=>le!==0&&-this._bearingSnap<le&&le<this._bearingSnap;X?(Q(X.bearing||this._map.getBearing())&&(X.bearing=0),this._map.easeTo(X,{originalEvent:U})):(this._map.fire(new s.Event("moveend",{originalEvent:U})),Q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(d,m){this._map.fire(new s.Event(d,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(d=>{this._frameId=void 0,this.handleEvent(new Gb("renderFrame",{timeStamp:d})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ic="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class ip extends s.Evented{constructor(d,m){super(),this._moving=!1,this._zooming=!1,this.transform=d,this._bearingSnap=m.bearingSnap,this._respectPrefersReducedMotion=m.respectPrefersReducedMotion!==!1,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(d,m){return this.jumpTo({center:d},m)}panBy(d,m,w){return d=s.Point.convert(d).mult(-1),this.panTo(this.transform.center,s.extend({offset:d},m),w)}panTo(d,m,w){return this.easeTo(s.extend({center:d},m),w)}getZoom(){return this.transform.zoom}setZoom(d,m){return this.jumpTo({zoom:d},m),this}zoomTo(d,m,w){return this.easeTo(s.extend({zoom:d},m),w)}zoomIn(d,m){return this.zoomTo(this.getZoom()+1,d,m),this}zoomOut(d,m){return this.zoomTo(this.getZoom()-1,d,m),this}getBearing(){return this.transform.bearing}setBearing(d,m){return this.jumpTo({bearing:d},m),this}getPadding(){return this.transform.padding}setPadding(d,m){return this.jumpTo({padding:d},m),this}rotateTo(d,m,w){return this.easeTo(s.extend({bearing:d},m),w)}resetNorth(d,m){return this.rotateTo(0,s.extend({duration:1e3},d),m),this}resetNorthPitch(d,m){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},d),m),this}snapToNorth(d,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(d,m):this}getPitch(){return this.transform.pitch}setPitch(d,m){return this.jumpTo({pitch:d},m),this}cameraForBounds(d,m){d=s.LngLatBounds.convert(d);const w=m&&m.bearing||0,T=m&&m.pitch||0,P=d.getNorthWest(),D=d.getSouthEast();return this._cameraForBounds(this.transform,P,D,w,T,m)}_extendCameraOptions(d){const m={top:0,bottom:0,right:0,left:0};if(typeof(d=s.extend({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const w=d.padding;d.padding={top:w,bottom:w,right:w,left:w}}return d.padding=s.extend(m,d.padding),d}_minimumAABBFrustumDistance(d,m){const w=m.max[0]-m.min[0],T=m.max[1]-m.min[1];return w/T>d.aspect?w/(2*Math.tan(.5*d.fovX)*d.aspect):T/(2*Math.tan(.5*d.fovY)*d.aspect)}_cameraForBoundsOnGlobe(d,m,w,T,P,D){const z=d.clone(),U=this._extendCameraOptions(D);z.bearing=T,z.pitch=P;const K=s.LngLat.convert(m),X=s.LngLat.convert(w),Q=.5*(K.lat+X.lat),le=.5*(K.lng+X.lng),he=s.latLngToECEF(Q,le),pe=s.normalize([],he),fe=s.normalize([],s.cross([],pe,[0,1,0])),ge=s.cross([],fe,pe),ee=[fe[0],fe[1],fe[2],0,ge[0],ge[1],ge[2],0,pe[0],pe[1],pe[2],0,0,0,0,1],de=[he,s.latLngToECEF(K.lat,K.lng),s.latLngToECEF(X.lat,K.lng),s.latLngToECEF(X.lat,X.lng),s.latLngToECEF(K.lat,X.lng),s.latLngToECEF(Q,K.lng),s.latLngToECEF(Q,X.lng),s.latLngToECEF(K.lat,le),s.latLngToECEF(X.lat,le)];let we=s.Aabb.fromPoints(de.map(yt=>[s.dot(fe,yt),s.dot(ge,yt),s.dot(pe,yt)]));const Se=s.transformMat4([],we.center,ee);s.squaredLength(Se)===0&&s.set(Se,0,0,1),s.normalize(Se,Se),s.scale$2(Se,Se,s.GLOBE_RADIUS),z.center=s.ecefToLatLng(Se);const Re=z.getWorldToCameraMatrix(),Le=s.invert(new Float64Array(16),Re);we=s.Aabb.applyTransform(we,s.multiply([],Re,ee)),s.transformMat4(Se,Se,Re);const De=.5*(we.max[2]-we.min[2]),Ue=this._minimumAABBFrustumDistance(z,we),Fe=s.scale$2([],[0,0,1],De),Ze=s.add(Fe,Se,Fe),wt=Ue+(z.pitch===0?0:s.distance(Se,Ze)),He=z.globeCenterInViewSpace,ht=s.sub([],Se,[He[0],He[1],He[2]]);s.normalize(ht,ht),s.scale$2(ht,ht,wt);const Je=s.add([],Se,ht);s.transformMat4(Je,Je,Le);const _t=s.earthRadius/s.GLOBE_RADIUS,Ke=s.length(Je),dt=s.mercatorZfromAltitude(Math.max(Ke*_t-s.earthRadius,Number.EPSILON),0),Et=Math.min(z.zoomFromMercatorZAdjusted(dt),U.maxZoom);return Et>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"mercator"}),z.zoom=Et,this._cameraForBounds(z,m,w,T,P,D)):{center:z.center,zoom:Et,bearing:T,pitch:P}}queryTerrainElevation(d,m){const w=this.transform.elevation;return w?(m=s.extend({},{exaggerated:!0},m),w.getAtPoint(s.MercatorCoordinate.fromLngLat(d),null,m.exaggerated)):null}_cameraForBounds(d,m,w,T,P,D){if(d.projection.name==="globe")return this._cameraForBoundsOnGlobe(d,m,w,T,P,D);const z=d.clone(),U=this._extendCameraOptions(D),K=z.padding;z.bearing=T,z.pitch=P;const X=s.LngLat.convert(m),Q=s.LngLat.convert(w),le=new s.LngLat(X.lng,Q.lat),he=new s.LngLat(Q.lng,X.lat),pe=z.project(X),fe=z.project(Q),ge=this.queryTerrainElevation(X),ee=this.queryTerrainElevation(Q),de=this.queryTerrainElevation(le),we=this.queryTerrainElevation(he),Se=[[pe.x,pe.y,Math.min(ge||0,ee||0,de||0,we||0)],[fe.x,fe.y,Math.max(ge||0,ee||0,de||0,we||0)]];let Re=s.Aabb.fromPoints(Se);const Le=z.getWorldToCameraMatrix(),De=s.invert(new Float64Array(16),Le);Re=s.Aabb.applyTransform(Re,Le);const Ue=s.sub([],Re.max,Re.min),Fe=K.left||0,Ze=K.right||0,wt=K.bottom||0,He=K.top||0,{left:ht,right:Je,top:_t,bottom:Ke}=U.padding,dt=.5*(Fe+Ze),Et=.5*(He+wt),yt=Math.min(z.scaleZoom(z.scale*Math.min((z.width-(Fe+Ze+ht+Je))/Ue[0],(z.height-(wt+He+Ke+_t))/Ue[1])),U.maxZoom),jt=z.scale/z.zoomScale(yt);Re=new s.Aabb([Re.min[0]-(ht+dt)*jt,Re.min[1]-(Ke+Et)*jt,Re.min[2]],[Re.max[0]+(Je+dt)*jt,Re.max[1]+(_t+Et)*jt,Re.max[2]]);const Jt=.5*Ue[2],lr=this._minimumAABBFrustumDistance(z,Re),Wt=[0,0,1,0];s.transformMat4$1(Wt,Wt,Le),s.normalize$2(Wt,Wt);const sr=s.scale$2([],Wt,lr+Jt),jr=s.add([],Re.center,sr),wr=(typeof U.offset.x=="number"&&typeof U.offset.y=="number"?new s.Point(U.offset.x,U.offset.y):s.Point.convert(U.offset)).rotate(-s.degToRad(T));Re.center[0]-=wr.x*jt,Re.center[1]+=wr.y*jt,s.transformMat4(Re.center,Re.center,De),s.transformMat4(jr,jr,De);const Yt=[Re.center[0],Re.center[1],jr[2]*z.pixelsPerMeter];s.scale$2(Yt,Yt,1/z.worldSize);const Xr=s.lngFromMercatorX(Yt[0]),rn=s.latFromMercatorY(Yt[1]),nn=Math.min(z._zoomFromMercatorZ(Yt[2]),U.maxZoom),sn=new s.LngLat(Xr,rn);return z.mercatorFromTransition&&nn<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"globe"}),z.zoom=nn,this._cameraForBounds(z,m,w,T,P,D)):{center:sn,zoom:nn,bearing:T,pitch:P}}fitBounds(d,m,w){const T=this.cameraForBounds(d,m);return this._fitInternal(T,m,w)}fitScreenCoordinates(d,m,w,T,P){const D=s.Point.convert(d),z=s.Point.convert(m),U=new s.Point(Math.min(D.x,z.x),Math.min(D.y,z.y)),K=new s.Point(Math.max(D.x,z.x),Math.max(D.y,z.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(D,z))return this;const X=this.transform.pointLocation3D(U),Q=this.transform.pointLocation3D(K),le=this.transform.pointLocation3D(new s.Point(U.x,K.y)),he=this.transform.pointLocation3D(new s.Point(K.x,U.y)),pe=[Math.min(X.lng,Q.lng,le.lng,he.lng),Math.min(X.lat,Q.lat,le.lat,he.lat)],fe=[Math.max(X.lng,Q.lng,le.lng,he.lng),Math.max(X.lat,Q.lat,le.lat,he.lat)],ge=T&&T.pitch?T.pitch:this.getPitch(),ee=this._cameraForBounds(this.transform,pe,fe,w,ge,T);return this._fitInternal(ee,T,P)}_fitInternal(d,m,w){return d?(delete(m=s.extend(d,m)).padding,m.linear?this.easeTo(m,w):this.flyTo(m,w)):this}jumpTo(d,m){this.stop();const w=d.preloadOnly?this.transform.clone():this.transform;let T=!1,P=!1,D=!1;return"zoom"in d&&w.zoom!==+d.zoom&&(T=!0,w.zoom=+d.zoom),d.center!==void 0&&(w.center=s.LngLat.convert(d.center)),"bearing"in d&&w.bearing!==+d.bearing&&(P=!0,w.bearing=+d.bearing),"pitch"in d&&w.pitch!==+d.pitch&&(D=!0,w.pitch=+d.pitch),d.padding==null||w.isPaddingEqual(d.padding)||(w.padding=d.padding),d.preloadOnly?(this._preloadTiles(w),this):(this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m)),T&&this.fire(new s.Event("zoomstart",m)).fire(new s.Event("zoom",m)).fire(new s.Event("zoomend",m)),P&&this.fire(new s.Event("rotatestart",m)).fire(new s.Event("rotate",m)).fire(new s.Event("rotateend",m)),D&&this.fire(new s.Event("pitchstart",m)).fire(new s.Event("pitch",m)).fire(new s.Event("pitchend",m)),this.fire(new s.Event("moveend",m)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(ic),this.transform.getFreeCameraOptions()}setFreeCameraOptions(d,m){const w=this.transform;if(!w.projection.supportsFreeCamera)return s.warnOnce(ic),this;this.stop();const T=w.zoom,P=w.pitch,D=w.bearing;w.setFreeCameraOptions(d);const z=T!==w.zoom,U=P!==w.pitch,K=D!==w.bearing;return this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m)),z&&this.fire(new s.Event("zoomstart",m)).fire(new s.Event("zoom",m)).fire(new s.Event("zoomend",m)),K&&this.fire(new s.Event("rotatestart",m)).fire(new s.Event("rotate",m)).fire(new s.Event("rotateend",m)),U&&this.fire(new s.Event("pitchstart",m)).fire(new s.Event("pitch",m)).fire(new s.Event("pitchend",m)),this.fire(new s.Event("moveend",m)),this}easeTo(d,m){this._stop(!1,d.easeId),((d=s.extend({offset:[0,0],duration:500,easing:s.ease},d)).animate===!1||this._prefersReducedMotion(d))&&(d.duration=0);const w=this.transform,T=this.getZoom(),P=this.getBearing(),D=this.getPitch(),z=this.getPadding(),U="zoom"in d?+d.zoom:T,K="bearing"in d?this._normalizeBearing(d.bearing,P):P,X="pitch"in d?+d.pitch:D,Q="padding"in d?d.padding:w.padding,le=s.Point.convert(d.offset);let he,pe,fe;if(w.projection.name==="globe"){const Fe=s.MercatorCoordinate.fromLngLat(w.center),Ze=le.rotate(-w.angle);Fe.x+=Ze.x/w.worldSize,Fe.y+=Ze.y/w.worldSize;const wt=Fe.toLngLat(),He=s.LngLat.convert(d.center||wt);this._normalizeCenter(He),he=w.centerPoint.add(Ze),pe=new s.Point(Fe.x,Fe.y).mult(w.worldSize),fe=new s.Point(s.mercatorXfromLng(He.lng),s.mercatorYfromLat(He.lat)).mult(w.worldSize).sub(pe)}else{he=w.centerPoint.add(le);const Fe=w.pointLocation(he),Ze=s.LngLat.convert(d.center||Fe);this._normalizeCenter(Ze),pe=w.project(Fe),fe=w.project(Ze).sub(pe)}const ge=w.zoomScale(U-T);let ee,de;d.around&&(ee=s.LngLat.convert(d.around),de=w.locationPoint(ee));const we=this._zooming||U!==T,Se=this._rotating||P!==K,Re=this._pitching||X!==D,Le=!w.isPaddingEqual(Q),De=Fe=>Ze=>{if(we&&(Fe.zoom=s.number(T,U,Ze)),Se&&(Fe.bearing=s.number(P,K,Ze)),Re&&(Fe.pitch=s.number(D,X,Ze)),Le&&(Fe.interpolatePadding(z,Q,Ze),he=Fe.centerPoint.add(le)),ee)Fe.setLocationAtPoint(ee,de);else{const wt=Fe.zoomScale(Fe.zoom-T),He=U>T?Math.min(2,ge):Math.max(.5,ge),ht=Math.pow(He,1-Ze),Je=Fe.unproject(pe.add(fe.mult(Ze*ht)).mult(wt));Fe.setLocationAtPoint(Fe.renderWorldCopies?Je.wrap():Je,he)}return d.preloadOnly||this._fireMoveEvents(m),Fe};if(d.preloadOnly){const Fe=this._emulate(De,d.duration,w);return this._preloadTiles(Fe),this}const Ue={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=we,this._rotating=Se,this._pitching=Re,this._padding=Le,this._easeId=d.easeId,this._prepareEase(m,d.noMoveStart,Ue),this._ease(De(w),Fe=>{w.recenterOnTerrain(),this._afterEase(m,Fe)},d),this}_prepareEase(d,m,w={}){this._moving=!0,this.transform.cameraElevationReference="sea",m||w.moving||this.fire(new s.Event("movestart",d)),this._zooming&&!w.zooming&&this.fire(new s.Event("zoomstart",d)),this._rotating&&!w.rotating&&this.fire(new s.Event("rotatestart",d)),this._pitching&&!w.pitching&&this.fire(new s.Event("pitchstart",d))}_fireMoveEvents(d){this.fire(new s.Event("move",d)),this._zooming&&this.fire(new s.Event("zoom",d)),this._rotating&&this.fire(new s.Event("rotate",d)),this._pitching&&this.fire(new s.Event("pitch",d))}_afterEase(d,m){if(this._easeId&&m&&this._easeId===m)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const w=this._zooming,T=this._rotating,P=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new s.Event("zoomend",d)),T&&this.fire(new s.Event("rotateend",d)),P&&this.fire(new s.Event("pitchend",d)),this.fire(new s.Event("moveend",d))}flyTo(d,m){if(this._prefersReducedMotion(d)){const yt=s.pick(d,["center","zoom","bearing","pitch","around"]);return this.jumpTo(yt,m)}this.stop(),d=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},d);const w=this.transform,T=this.getZoom(),P=this.getBearing(),D=this.getPitch(),z=this.getPadding(),U="zoom"in d?s.clamp(+d.zoom,w.minZoom,w.maxZoom):T,K="bearing"in d?this._normalizeBearing(d.bearing,P):P,X="pitch"in d?+d.pitch:D,Q="padding"in d?d.padding:w.padding,le=w.zoomScale(U-T),he=s.Point.convert(d.offset);let pe=w.centerPoint.add(he);const fe=w.pointLocation(pe),ge=s.LngLat.convert(d.center||fe);this._normalizeCenter(ge);const ee=w.project(fe),de=w.project(ge).sub(ee);let we=d.curve;const Se=Math.max(w.width,w.height),Re=Se/le,Le=de.mag();if("minZoom"in d){const yt=s.clamp(Math.min(d.minZoom,T,U),w.minZoom,w.maxZoom),jt=Se/w.zoomScale(yt-T);we=Math.sqrt(jt/Le*2)}const De=we*we;function Ue(yt){const jt=(Re*Re-Se*Se+(yt?-1:1)*De*De*Le*Le)/(2*(yt?Re:Se)*De*Le);return Math.log(Math.sqrt(jt*jt+1)-jt)}function Fe(yt){return(Math.exp(yt)-Math.exp(-yt))/2}function Ze(yt){return(Math.exp(yt)+Math.exp(-yt))/2}const wt=Ue(0);let He=function(yt){return Ze(wt)/Ze(wt+we*yt)},ht=function(yt){return Se*((Ze(wt)*(Fe(jt=wt+we*yt)/Ze(jt))-Fe(wt))/De)/Le;var jt},Je=(Ue(1)-wt)/we;if(Math.abs(Le)<1e-6||!isFinite(Je)){if(Math.abs(Se-Re)<1e-6)return this.easeTo(d,m);const yt=Re<Se?-1:1;Je=Math.abs(Math.log(Re/Se))/we,ht=function(){return 0},He=function(jt){return Math.exp(yt*we*jt)}}d.duration="duration"in d?+d.duration:1e3*Je/("screenSpeed"in d?+d.screenSpeed/we:+d.speed),d.maxDuration&&d.duration>d.maxDuration&&(d.duration=0);const _t=P!==K,Ke=X!==D,dt=!w.isPaddingEqual(Q),Et=yt=>jt=>{const Jt=jt*Je,lr=1/He(Jt);yt.zoom=jt===1?U:T+yt.scaleZoom(lr),_t&&(yt.bearing=s.number(P,K,jt)),Ke&&(yt.pitch=s.number(D,X,jt)),dt&&(yt.interpolatePadding(z,Q,jt),pe=yt.centerPoint.add(he));const Wt=jt===1?ge:yt.unproject(ee.add(de.mult(ht(Jt))).mult(lr));return yt.setLocationAtPoint(yt.renderWorldCopies?Wt.wrap():Wt,pe),yt._updateCameraOnTerrain(),d.preloadOnly||this._fireMoveEvents(m),yt};if(d.preloadOnly){const yt=this._emulate(Et,d.duration,w);return this._preloadTiles(yt),this}return this._zooming=!0,this._rotating=_t,this._pitching=Ke,this._padding=dt,this._prepareEase(m,!1),this._ease(Et(w),()=>this._afterEase(m),d),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(d,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const w=this._onEaseEnd;this._onEaseEnd=void 0,w.call(this,m)}if(!d){const w=this.handlers;w&&w.stop(!1)}return this}_ease(d,m,w){w.animate===!1||w.duration===0?(d(1),m()):(this._easeStart=s.exported.now(),this._easeOptions=w,this._onEaseFrame=d,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const d=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),m=this._onEaseFrame;m&&m(this._easeOptions.easing(d)),d<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(d,m){d=s.wrap(d,-180,180);const w=Math.abs(d-m);return Math.abs(d-360-m)<w&&(d-=360),Math.abs(d+360-m)<w&&(d+=360),d}_normalizeCenter(d){const m=this.transform;if(!m.renderWorldCopies||m.maxBounds)return;const w=d.lng-m.center.lng;d.lng+=w>180?-360:w<-180?360:0}_prefersReducedMotion(d){return this._respectPrefersReducedMotion&&s.exported.prefersReducedMotion&&!(d&&d.essential)}_emulate(d,m,w){const T=Math.ceil(15*m/1e3),P=[],D=d(w.clone());for(let z=0;z<=T;z++){const U=D(z/T);P.push(U.clone())}return P}}class Vt{constructor(d={}){this.options=d,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(d){const m=this.options&&this.options.compact;return this._map=d,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=E("button","mapboxgl-ctrl-attrib-button",this._container),E("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=E("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(d,m){const w=this._map._getUIString(`AttributionControl.${m}`);d.setAttribute("aria-label",w),d.removeAttribute("title"),d.firstElementChild&&d.firstElementChild.setAttribute("title",w)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let d=this._editLink;d||(d=this._editLink=this._container.querySelector(".mapbox-improve-map"));const m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(d){const w=m.reduce((T,P,D)=>(P.value&&(T+=`${P.key}=${P.value}${D<m.length-1?"&":""}`),T),"?");d.href=`${s.config.FEEDBACK_URL}/${w}#${rh(this._map,!0)}`,d.rel="noopener nofollow",this._setElementTitle(d,"MapFeedback")}}_updateData(d){!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let d=[];if(this._map.style.stylesheet){const T=this._map.style.stylesheet;this.styleOwner=T.owner,this.styleId=T.id}const m=this._map.style._sourceCaches;for(const T in m){const P=m[T];if(P.used){const D=P.getSource();D.attribution&&d.indexOf(D.attribution)<0&&d.push(D.attribution)}}d.sort((T,P)=>T.length-P.length),d=d.filter((T,P)=>{for(let D=P+1;D<d.length;D++)if(d[D].indexOf(T)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?d=[...this.options.customAttribution,...d]:d.unshift(this.options.customAttribution));const w=d.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,d.length?(this._innerContainer.innerHTML=w,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ty{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(d){this._map=d,this._container=E("div","mapboxgl-ctrl");const m=E("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(d){d&&d.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const d=this._map.style._sourceCaches;if(Object.entries(d).length===0)return!0;for(const m in d){const w=d[m].getSource();if(w.hasOwnProperty("mapbox_logo")&&!w.mapbox_logo)return!1}return!0}_updateCompact(){const d=this._container.children;if(d.length){const m=d[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}}}class jy{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(d){const m=++this._id;return this._queue.push({callback:d,id:m,cancelled:!1}),m}remove(d){const m=this._currentlyRunning,w=m?this._queue.concat(m):this._queue;for(const T of w)if(T.id===d)return void(T.cancelled=!0)}run(d=0){const m=this._currentlyRunning=this._queue;this._queue=[];for(const w of m)if(!w.cancelled&&(w.callback(d),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function bu(v,d,m){if(v=new s.LngLat(v.lng,v.lat),d){const w=new s.LngLat(v.lng-360,v.lat),T=new s.LngLat(v.lng+360,v.lat),P=360*Math.ceil(Math.abs(v.lng-m.center.lng)/360),D=m.locationPoint(v).distSqr(d),z=d.x<0||d.y<0||d.x>m.width||d.y>m.height;m.locationPoint(w).distSqr(d)<D&&(z||Math.abs(w.lng-m.center.lng)<P)?v=w:m.locationPoint(T).distSqr(d)<D&&(z||Math.abs(T.lng-m.center.lng)<P)&&(v=T)}for(;Math.abs(v.lng-m.center.lng)>180;){const w=m.locationPoint(v);if(w.x>=0&&w.y>=0&&w.x<=m.width&&w.y<=m.height)break;v.lng>m.center.lng?v.lng-=360:v.lng+=360}return v}const sc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class zt extends s.Evented{constructor(d,m){if(super(),(d instanceof s.window.HTMLElement||m)&&(d=s.extend({element:d},m)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=d&&d.anchor||"center",this._color=d&&d.color||"#3FB1CE",this._scale=d&&d.scale||1,this._draggable=d&&d.draggable||!1,this._clickTolerance=d&&d.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=d&&d.rotation||0,this._rotationAlignment=d&&d.rotationAlignment||"auto",this._pitchAlignment=d&&d.pitchAlignment&&d.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=d&&d.occludedOpacity||.2,d&&d.element)this._element=d.element,this._offset=s.Point.convert(d&&d.offset||[0,0]);else{this._defaultMarker=!0,this._element=E("div");const T=41,P=27,D=C("svg",{display:"block",height:T*this._scale+"px",width:P*this._scale+"px",viewBox:`0 0 ${P} ${T}`},this._element),z=C("radialGradient",{id:"shadowGradient"},C("defs",{},D));C("stop",{offset:"10%","stop-opacity":.4},z),C("stop",{offset:"100%","stop-opacity":.05},z),C("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},D),C("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},D),C("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},D),C("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},D),this._offset=s.Point.convert(d&&d.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",T=>{T.preventDefault()}),this._element.addEventListener("mousedown",T=>{T.preventDefault()});const w=this._element.classList;for(const T in sc)w.remove(`mapboxgl-marker-anchor-${T}`);w.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(d){return d===this._map||(this.remove(),this._map=d,d.getCanvasContainer().appendChild(this._element),d.on("move",this._updateMoving),d.on("moveend",this._update),d.on("remove",this._clearFadeTimer),d._addMarker(this),this.setDraggable(this._draggable),this._update(),d.on("click",this._onMapClick)),this}remove(){const d=this._map;return d&&(d.off("click",this._onMapClick),d.off("move",this._updateMoving),d.off("moveend",this._update),d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler),d.off("mouseup",this._onUp),d.off("touchend",this._onUp),d.off("mousemove",this._onMove),d.off("touchmove",this._onMove),d.off("remove",this._clearFadeTimer),d._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=s.LngLat.convert(d),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(d){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),d){if(!("offset"in d.options)){const T=Math.sqrt(Math.pow(13.5,2)/2);d.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[T,-1*(38.1-13.5+T)],"bottom-right":[-T,-1*(38.1-13.5+T)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=d,d._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(d){const m=d.code,w=d.charCode||d.keyCode;m!=="Space"&&m!=="Enter"&&w!==32&&w!==13||this.togglePopup()}_onMapClick(d){const m=d.originalEvent.target,w=this._element;this._popup&&(m===w||w.contains(m))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const d=this._popup;return d?(d.isOpen()?(d.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(d.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const d=this._map,m=this._pos;if(!d||!m)return!1;const w=d.unproject(m),T=d.getFreeCameraOptions();if(!T.position)return!1;const P=T.position.toLngLat();return P.distanceTo(w)<.9*P.distanceTo(this._lngLat)}_evaluateOpacity(){const d=this._map;if(!d)return;const m=this._pos;if(!m||m.x<0||m.x>d.transform.width||m.y<0||m.y>d.transform.height)return void this._clearFadeTimer();const w=d.unproject(m);let T;d._showingGlobe()&&s.isLngLatBehindGlobe(d.transform,this._lngLat)?T=0:(T=1-d._queryFogOpacity(w),d.transform._terrainEnabled()&&d.getTerrain()&&this._behindTerrain()&&(T*=this._occludedOpacity)),this._element.style.opacity=`${T}`,this._element.style.pointerEvents=T>0?"auto":"none",this._popup&&this._popup._setOpacity(T),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const d=this._pos;if(!d||!this._map)return;const m=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${d.x}px,${d.y}px)
            ${sc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${m.x}px,${m.y}px)
        `}_calculateXYTransform(){const d=this._pos,m=this._map,w=this.getPitchAlignment();if(!m||!d||w!=="map")return"";if(!m._showingGlobe()){const U=m.getPitch();return U?`rotateX(${U}deg)`:""}const T=s.radToDeg(s.globeTiltAtLngLat(m.transform,this._lngLat)),P=d.sub(s.globeCenterToScreenPoint(m.transform)),D=Math.abs(P.x)+Math.abs(P.y);if(D===0)return"";const z=T/D;return`rotateX(${-P.y*z}deg) rotateY(${P.x*z}deg)`}_calculateZTransform(){const d=this._pos,m=this._map;if(!m||!d)return"";let w=0;const T=this.getRotationAlignment();if(T==="map")if(m._showingGlobe()){const P=m.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),D=m.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(P);w=s.radToDeg(Math.atan2(D.y,D.x))-90}else w=-m.getBearing();else if(T==="horizon"){const P=s.smoothstep(4,6,m.getZoom()),D=s.globeCenterToScreenPoint(m.transform);D.y+=P*m.transform.height;const z=d.sub(D),U=s.radToDeg(Math.atan2(z.y,z.x));w=(U>90?U-270:U+90)*(1-P)}return w+=this._rotation,w?`rotateZ(${w}deg)`:""}_update(d){s.window.cancelAnimationFrame(this._updateFrameId);const m=this._map;m&&(m.transform.renderWorldCopies&&(this._lngLat=bu(this._lngLat,this._pos,m.transform)),this._pos=m.project(this._lngLat),d===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),m._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(m._showingGlobe()||m.getTerrain()||m.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(d){return this._offset=s.Point.convert(d),this._update(),this}_onMove(d){const m=this._map;if(!m)return;const w=this._pointerdownPos,T=this._positionDelta;if(w&&T){if(!this._isDragging){const P=this._clickTolerance||m._clickTolerance;if(d.point.dist(w)<P)return;this._isDragging=!0}this._pos=d.point.sub(T),this._lngLat=m.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const d=this._map;d&&(d.off("mousemove",this._onMove),d.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(d){const m=this._map,w=this._pos;m&&w&&this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(w),this._pointerdownPos=d.point,this._state="pending",m.on("mousemove",this._onMove),m.on("touchmove",this._onMove),m.once("mouseup",this._onUp),m.once("touchend",this._onUp))}setDraggable(d){this._draggable=!!d;const m=this._map;return m&&(d?(m.on("mousedown",this._addDragHandler),m.on("touchstart",this._addDragHandler)):(m.off("mousedown",this._addDragHandler),m.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(d){return this._rotation=d||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(d){return this._rotationAlignment=d||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(d){return this._pitchAlignment=d||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(d){return this._occludedOpacity=d||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Cy={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},dT=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Hb(v=new s.Point(0,0),d="bottom"){if(typeof v=="number"){const m=Math.round(Math.sqrt(.5*Math.pow(v,2)));switch(d){case"top":return new s.Point(0,v);case"top-left":return new s.Point(m,m);case"top-right":return new s.Point(-m,m);case"bottom":return new s.Point(0,-v);case"bottom-left":return new s.Point(m,-m);case"bottom-right":return new s.Point(-m,-m);case"left":return new s.Point(v,0);case"right":return new s.Point(-v,0)}return new s.Point(0,0)}return v instanceof s.Point||Array.isArray(v)?s.Point.convert(v):s.Point.convert(v[d]||[0,0])}class Py{constructor(d){this.jumpTo(d)}getValue(d){if(d<=this._startTime)return this._start;if(d>=this._endTime)return this._end;const m=s.easeCubicInOut((d-this._startTime)/(this._endTime-this._startTime));return this._start*(1-m)+this._end*m}isEasing(d){return d>=this._startTime&&d<=this._endTime}jumpTo(d){this._startTime=-1/0,this._endTime=-1/0,this._start=d,this._end=d}easeTo(d,m,w){this._start=this.getValue(m),this._end=d,this._startTime=m,this._endTime=m+w}}const Xb={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Kb={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},hT={showCompass:!0,showZoom:!0,visualizePitch:!1};class fT{constructor(d,m,w=!1){this._clickTolerance=10,this.element=m,this.mouseRotate=new by({clickTolerance:d.dragRotate._mouseRotate._clickTolerance}),this.map=d,w&&(this.mousePitch=new _y({clickTolerance:d.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),m.addEventListener("mousedown",this.mousedown),m.addEventListener("touchstart",this.touchstart,{passive:!1}),m.addEventListener("touchmove",this.touchmove),m.addEventListener("touchend",this.touchend),m.addEventListener("touchcancel",this.reset)}down(d,m){this.mouseRotate.mousedown(d,m),this.mousePitch&&this.mousePitch.mousedown(d,m),R()}move(d,m){const w=this.map,T=this.mouseRotate.mousemoveWindow(d,m),P=T&&T.bearingDelta;if(P&&w.setBearing(w.getBearing()+P),this.mousePitch){const D=this.mousePitch.mousemoveWindow(d,m),z=D&&D.pitchDelta;z&&w.setPitch(w.getPitch()+z)}}off(){const d=this.element;d.removeEventListener("mousedown",this.mousedown),d.removeEventListener("touchstart",this.touchstart,{passive:!1}),d.removeEventListener("touchmove",this.touchmove),d.removeEventListener("touchend",this.touchend),d.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){L(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(d){this.down(s.extend({},d,{ctrlKey:!0,preventDefault:()=>d.preventDefault()}),F(this.element,d)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(d){this.move(d,F(this.element,d))}mouseup(d){this.mouseRotate.mouseupWindow(d),this.mousePitch&&this.mousePitch.mouseupWindow(d),this.offTemp()}touchstart(d){d.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=H(this.element,d.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>d.preventDefault()},this._startPos))}touchmove(d){d.targetTouches.length!==1?this.reset():(this._lastPos=H(this.element,d.targetTouches)[0],this.move({preventDefault:()=>d.preventDefault()},this._lastPos))}touchend(d){d.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Ay={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ny={maxWidth:100,unit:"metric"},ky={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},_u={version:s.version,supported:y,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends ip{constructor(v){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(v=s.extend({},Kb,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(v.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(v.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new gu(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),v),this._interactive=v.interactive,this._minTileCacheSize=v.minTileCacheSize,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._useWebGL2=v.useWebGL2,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=v.crossSourceCollisions,this._collectResourceTiming=v.collectResourceTiming,this._optimizeForTerrain=v.optimizeForTerrain,this._language=this._parseLanguage(v.language),this._worldview=v.worldview,this._renderTaskQueue=new jy,this._domRenderTaskQueue=new jy,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},Xb,v.locale),this._clickTolerance=v.clickTolerance,this._cooperativeGestures=v.cooperativeGestures,this._performanceMetricsCollection=v.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Py(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(v.transformRequest,v.accessToken,v.testMode),this._silenceAuthErrors=!!v.testMode,typeof v.container=="string"){if(this._container=s.window.document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),v.maxBounds&&this.setMaxBounds(v.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Xa(this,v),this._localFontFamily=v.localFontFamily,this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),v.projection&&this.setProjection(v.projection),this._hash=v.hash&&new gy(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,s.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),v.attributionControl&&this.addControl(new Vt({customAttribution:v.customAttribution})),this._logoControl=new Ty,this.addControl(this._logoControl,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",d=>{this._update(d.dataType==="style"),this.fire(new s.Event(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new s.Event(`${d.dataType}dataloading`,d))})}_getMapId(){return this._mapId}addControl(v,d){if(d===void 0&&(d=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=v.onAdd(this);this._controls.push(v);const w=this._controlPositions[d];return d.indexOf("bottom")!==-1?w.insertBefore(m,w.firstChild):w.appendChild(m),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const d=this._controls.indexOf(v);return d>-1&&this._controls.splice(d,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(v){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const d=!this._moving;return d&&this.fire(new s.Event("movestart",v)).fire(new s.Event("move",v)),this.fire(new s.Event("resize",v)),d&&this.fire(new s.Event("moveend",v)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(v){return this.transform.setMaxBounds(s.LngLatBounds.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v?this.setZoom(v):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v?this.setZoom(v):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v?this.setPitch(v):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v?this.setPitch(v):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(v){return v==="auto"?s.window.navigator.language:Array.isArray(v)?v.length===0?void 0:v.map(d=>d==="auto"?s.window.navigator.language:d):v}setLanguage(v){const d=this._parseLanguage(v);if(!this.style||d===this._language)return this;this._language=d,this.style._reloadSources();for(const m of this._controls)m._setLanguage&&m._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(v){return this.style&&v!==this._worldview?(this._worldview=v,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(v){return this._lazyInitEmptyStyle(),v?typeof v=="string"&&(v={name:v}):v=null,this._useExplicitProjection=!!v,this._prioritizeAndUpdateProjection(v,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const v=this.transform,d=v.projection.name;let m;d==="globe"&&v.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(v.setMercatorFromTransition(),m=!0):d==="mercator"&&v.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(v.setProjection({name:"globe"}),m=!0),m&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(v,d){return this._updateProjection(v||d||{name:"mercator"})}_updateProjection(v){let d;if(d=v.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(v),this.style.applyProjectionUpdate(),d){this.painter.clearBackgroundTiles();for(const m in this.style._sourceCaches)this.style._sourceCaches[m].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(v){return this.transform.locationPoint3D(s.LngLat.convert(v))}unproject(v){return this.transform.pointLocation3D(s.Point.convert(v))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(v,d,m){if(v==="mouseenter"||v==="mouseover"){let w=!1;const T=D=>{const z=d.filter(K=>this.getLayer(K)),U=z.length?this.queryRenderedFeatures(D.point,{layers:z}):[];U.length?w||(w=!0,m.call(this,new _i(v,this,D.originalEvent,{features:U}))):w=!1},P=()=>{w=!1};return{layers:new Set(d),listener:m,delegates:{mousemove:T,mouseout:P}}}if(v==="mouseleave"||v==="mouseout"){let w=!1;const T=D=>{const z=d.filter(U=>this.getLayer(U));(z.length?this.queryRenderedFeatures(D.point,{layers:z}):[]).length?w=!0:w&&(w=!1,m.call(this,new _i(v,this,D.originalEvent)))},P=D=>{w&&(w=!1,m.call(this,new _i(v,this,D.originalEvent)))};return{layers:new Set(d),listener:m,delegates:{mousemove:T,mouseout:P}}}{const w=T=>{const P=d.filter(z=>this.getLayer(z)),D=P.length?this.queryRenderedFeatures(T.point,{layers:P}):[];D.length&&(T.features=D,m.call(this,T),delete T.features)};return{layers:new Set(d),listener:m,delegates:{[v]:w}}}}on(v,d,m){if(m===void 0)return super.on(v,d);Array.isArray(d)||(d=[d]);const w=this._createDelegatedListener(v,d,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(w);for(const T in w.delegates)this.on(T,w.delegates[T]);return this}once(v,d,m){if(m===void 0)return super.once(v,d);Array.isArray(d)||(d=[d]);const w=this._createDelegatedListener(v,d,m);for(const T in w.delegates)this.once(T,w.delegates[T]);return this}off(v,d,m){if(m===void 0)return super.off(v,d);d=new Set(Array.isArray(d)?d:[d]);const w=(P,D)=>{if(P.size!==D.size)return!1;for(const z of P)if(!D.has(z))return!1;return!0},T=this._delegatedListeners?this._delegatedListeners[v]:void 0;return T&&(P=>{for(let D=0;D<P.length;D++){const z=P[D];if(z.listener===m&&w(z.layers,d)){for(const U in z.delegates)this.off(U,z.delegates[U]);return P.splice(D,1),this}}})(T),this}queryRenderedFeatures(v,d){return this.style?(d!==void 0||v===void 0||v instanceof s.Point||Array.isArray(v)||(d=v,v=void 0),this.style.queryRenderedFeatures(v=v||[[0,0],[this.transform.width,this.transform.height]],d=d||{},this.transform)):[]}querySourceFeatures(v,d){return this.style.querySourceFeatures(v,d)}isPointOnSurface(v){const{name:d}=this.transform.projection;return d!=="globe"&&d!=="mercator"&&s.warnOnce(`${d} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.Point.convert(v))}setStyle(v,d){return(d=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},d)).diff!==!1&&d.localIdeographFontFamily===this._localIdeographFontFamily&&d.localFontFamily===this._localFontFamily&&this.style&&v?(this._diffStyle(v,d),this):(this._localIdeographFontFamily=d.localIdeographFontFamily,this._localFontFamily=d.localFontFamily,this._updateStyle(v,d))}_getUIString(v){const d=this._locale[v];if(d==null)throw new Error(`Missing UI string '${v}'`);return d}_updateStyle(v,d){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),v&&(this.style=new Ga(this,d||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v):this.style.loadJSON(v)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ga(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,d){if(typeof v=="string"){const m=this._requestManager.normalizeStyleURL(v),w=this._requestManager.transformRequest(m,s.ResourceType.Style);s.getJSON(w,(T,P)=>{T?this.fire(new s.ErrorEvent(T)):P&&this._updateDiff(P,d)})}else typeof v=="object"&&this._updateDiff(v,d)}_updateDiff(v,d){try{this.style.setState(v)&&this._update(!0)}catch(m){s.warnOnce(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(v,d)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(v,d){return this._lazyInitEmptyStyle(),this.style.addSource(v,d),this._update(!0)}isSourceLoaded(v){return!!this.style&&this.style._isSourceCacheLoaded(v)}areTilesLoaded(){const v=this.style&&this.style._sourceCaches;for(const d in v){const m=v[d]._tiles;for(const w in m){const T=m[w];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}addSourceType(v,d,m){this._lazyInitEmptyStyle(),this.style.addSourceType(v,d,m)}removeSource(v){return this.style.removeSource(v),this._updateTerrain(),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,d,{pixelRatio:m=1,sdf:w=!1,stretchX:T,stretchY:P,content:D}={}){if(this._lazyInitEmptyStyle(),d instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&d instanceof s.window.ImageBitmap){const{width:z,height:U,data:K}=s.exported.getImageData(d);this.style.addImage(v,{data:new s.RGBAImage({width:z,height:U},K),pixelRatio:m,stretchX:T,stretchY:P,content:D,sdf:w,version:0})}else if(d.width===void 0||d.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:z,height:U}=d,K=d;this.style.addImage(v,{data:new s.RGBAImage({width:z,height:U},new Uint8Array(K.data)),pixelRatio:m,stretchX:T,stretchY:P,content:D,sdf:w,version:0,userImage:K}),K.onAdd&&K.onAdd(this,v)}}updateImage(v,d){const m=this.style.getImage(v);if(!m)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=d instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&d instanceof s.window.ImageBitmap?s.exported.getImageData(d):d,{width:T,height:P}=w;T!==void 0&&P!==void 0?T===m.data.width&&P===m.data.height?(m.data.replace(w.data,!(d instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&d instanceof s.window.ImageBitmap)),this.style.updateImage(v,m)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${T}, ${P})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,d){s.getImage(this._requestManager.transformRequest(v,s.ResourceType.Image),(m,w)=>{d(m,w instanceof s.window.HTMLImageElement?s.exported.getImageData(w):w)})}listImages(){return this.style.listImages()}addLayer(v,d){return this._lazyInitEmptyStyle(),this.style.addLayer(v,d),this._update(!0)}moveLayer(v,d){return this.style.moveLayer(v,d),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,d,m){return this.style.setLayerZoomRange(v,d,m),this._update(!0)}setFilter(v,d,m={}){return this.style.setFilter(v,d,m),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,d,m,w={}){return this.style.setPaintProperty(v,d,m,w),this._update(!0)}getPaintProperty(v,d){return this.style.getPaintProperty(v,d)}setLayoutProperty(v,d,m,w={}){return this.style.setLayoutProperty(v,d,m,w),this._update(!0)}getLayoutProperty(v,d){return this.style.getLayoutProperty(v,d)}setLight(v,d={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,d),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(v){return this._lazyInitEmptyStyle(),!v&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(v),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(v){return this._lazyInitEmptyStyle(),this.style.setFog(v),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(v){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(v),this.transform):0}setFeatureState(v,d){return this.style.setFeatureState(v,d),this._update()}removeFeatureState(v,d){return this.style.removeFeatureState(v,d),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}_updateContainerDimensions(){if(!this._container)return;const v=this._container.getBoundingClientRect().width||400,d=this._container.getBoundingClientRect().height||300;let m,w,T,P=this._container;for(;P&&(!w||!T);){const D=s.window.getComputedStyle(P).transform;D&&D!=="none"&&(m=D.match(/matrix.*\((.+)\)/)[1].split(", "),m[0]&&m[0]!=="0"&&m[0]!=="1"&&(w=m[0]),m[3]&&m[3]!=="0"&&m[3]!=="1"&&(T=m[3])),P=P.parentElement}this._containerWidth=w?Math.abs(v/w):v,this._containerHeight=T?Math.abs(d/T):d}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=E("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();const d=this._canvasContainer=E("div","mapboxgl-canvas-container",v);this._interactive&&d.classList.add("mapboxgl-interactive"),this._canvas=E("canvas","mapboxgl-canvas",d),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const m=this._controlContainer=E("div","mapboxgl-control-container",v),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(T=>{w[T]=E("div",`mapboxgl-ctrl-${T}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,d){const m=s.exported.devicePixelRatio||1;this._canvas.width=m*Math.ceil(v),this._canvas.height=m*Math.ceil(d),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${d}px`}_addMarker(v){this._markers.push(v)}_removeMarker(v){const d=this._markers.indexOf(v);d!==-1&&this._markers.splice(d,1)}_addPopup(v){this._popups.push(v)}_removePopup(v){const d=this._popups.indexOf(v);d!==-1&&this._popups.splice(d,1)}_setupPainter(){const v=s.extend({},y.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),d=this._useWebGL2&&this._canvas.getContext("webgl2",v),m=d||this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);m?(this._useWebGL2&&!d&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(m,!0),this.painter=new pu(m,this.transform,!!d),this.on("data",w=>{w.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(m)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:v}))}_contextRestored(v){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:v}))}_onMapScroll(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_requestDomTask(v){!this.loaded()||this.loaded()&&!this.isMoving()?v():this._domRenderTaskQueue.add(v)}_render(v){let d;const m=this.painter.context.extTimerQuery,w=s.exported.now();if(this.listens("gpu-timing-frame")&&(d=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,d)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(v),this._domRenderTaskQueue.run(v),this._removed)return;this._updateProjectionTransition();const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,U=this.transform.pitch,K=s.exported.now(),X=new s.EvaluationParameters(z,{now:K,fadeDuration:T,pitch:U,transition:this.style.getTransition()});this.style.update(X)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let P=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),P=this._updateAverageElevation(w),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):P=this._updateAverageElevation(w),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),d){const z=s.exported.now()-w;m.endQueryEXT(m.TIME_ELAPSED_EXT,d),setTimeout(()=>{const U=m.getQueryObjectEXT(d,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(d),this.fire(new s.Event("gpu-timing-frame",{cpuTime:z,gpuTime:U})),s.window.performance.mark("frame-gpu",{startTime:w,detail:{gpuTime:U}})},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const U=this.painter.queryGpuTimers(z);this.fire(new s.Event("gpu-timing-layer",{layerTimes:U}))},50)}if(this.listens("gpu-timing-deferred-render")){const z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const U=this.painter.queryGpuTimeDeferredRender(z);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:U}))},50)}const D=this._sourcesDirty||this._styleDirty||this._placementDirty||P;if(D||this._repaint)this.triggerRepaint();else{const z=!this.isMoving()&&this.loaded();if(z&&(P=this._updateAverageElevation(w,!0)),P)this.triggerRepaint();else if(this._triggerFrame(!1),z&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const U=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:U})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(v){for(const d of this._markers)v&&!this.getRenderWorldCopies()&&(d._lngLat=d._lngLat.wrap()),d._update();for(const d of this._popups)!v||this.getRenderWorldCopies()||d._trackPointer||(d._lngLat=d._lngLat.wrap()),d._update()}_updateAverageElevation(v,d=!1){const m=w=>(this.transform.averageElevation=w,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&m(0);if((d||v-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(v)){const w=this.transform.averageElevation;let T=this.transform.sampleAverageElevation(),P=!1;this.transform.elevation&&(P=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(T)?T=0:this._averageElevationLastSampledAt=v;const D=Math.abs(w-T);if(D>1){if(this._isInitialLoad||P)return this._averageElevation.jumpTo(T),m(T);this._averageElevation.easeTo(T,v,300)}else if(D>1e-4)return this._averageElevation.jumpTo(T),m(T)}return!!this._averageElevation.isEasing(v)&&m(this._averageElevation.getValue(v))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,v=>{if(v&&(v.message===s.AUTH_ERR_MSG||v.status===401)){const d=this.painter.context.gl;s.storeAuthState(d,!1),this._logoControl instanceof Ty&&this._logoControl._updateLogo(),d&&d.clear(d.DEPTH_BUFFER_BIT|d.COLOR_BUFFER_BIT|d.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const v=this._isDragging();this.painter.updateTerrain(this.style,v)}_calculateSpeedIndex(){const v=this.painter.canvasCopy(),d=this.painter.getCanvasCopiesAndTimestamps();d.timeStamps.push(performance.now());const m=this.painter.context.gl,w=m.createFramebuffer();function T(P){m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,P,0);const D=new Uint8Array(m.drawingBufferWidth*m.drawingBufferHeight*4);return m.readPixels(0,0,m.drawingBufferWidth,m.drawingBufferHeight,m.RGBA,m.UNSIGNED_BYTE,D),D}return m.bindFramebuffer(m.FRAMEBUFFER,w),this._canvasPixelComparison(T(v),d.canvasCopies.map(T),d.timeStamps)}_canvasPixelComparison(v,d,m){let w=m[1]-m[0];const T=v.length/4;for(let P=0;P<d.length;P++){const D=d[P];let z=0;for(let U=0;U<D.length;U+=4)D[U]===v[U]&&D[U+1]===v[U+1]&&D[U+2]===v[U+2]&&D[U+3]===v[U+3]&&(z+=1);w+=(m[P+2]-m[P+1])*(1-z/T)}return w}remove(){this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const v=this.painter.context.gl.getExtension("WEBGL_lose_context");v&&v.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(v){this._renderNextFrame=this._renderNextFrame||v,this.style&&!this._frame&&(this._frame=s.exported.frame(d=>{const m=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,m&&this._render(d)}))}_preloadTiles(v){const d=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(d,(m,w)=>m._preloadTiles(v,w),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(v){this._trackResize&&this.resize({originalEvent:v})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(v){this._showTerrainWireframe!==v&&(this._showTerrainWireframe=v,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(v){this._speedIndexTiming!==v&&(this._speedIndexTiming=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(v){this._showTileAABBs!==v&&(this._showTileAABBs=v,v&&this._update())}_setCacheLimits(v,d){s.setCacheLimits(v,d)}get version(){return s.version}},NavigationControl:class{constructor(v){this.options=s.extend({},hT,v),this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",d=>d.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",d=>{this._map&&this._map.zoomIn({},{originalEvent:d})}),E("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",d=>{this._map&&this._map.zoomOut({},{originalEvent:d})}),E("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",d=>{const m=this._map;m&&(this.options.visualizePitch?m.resetNorthPitch({},{originalEvent:d}):m.resetNorth({},{originalEvent:d}))}),this._compassIcon=E("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const v=this._map;if(!v)return;const d=v.getZoom(),m=d===v.getMaxZoom(),w=d===v.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())}_rotateCompassArrow(){const v=this._map;if(!v)return;const d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(v.transform.pitch*(Math.PI/180)),.5)}) rotateX(${v.transform.pitch}deg) rotateZ(${v.transform.angle*(180/Math.PI)}deg)`:`rotate(${v.transform.angle*(180/Math.PI)}deg)`;v._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=d)})}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),v.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&v.on("pitch",this._rotateCompassArrow),v.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new fT(v,this._compass,this.options.visualizePitch)),this._container}onRemove(){const v=this._map;v&&(this._container.remove(),this.options.showZoom&&v.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&v.off("pitch",this._rotateCompassArrow),v.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(v,d){const m=E("button",v,this._container);return m.type="button",m.addEventListener("click",d),m}_setButtonTitle(v,d){if(!this._map)return;const m=this._map._getUIString(`NavigationControl.${d}`);v.setAttribute("aria-label",m),v.firstElementChild&&v.firstElementChild.setAttribute("title",m)}},GeolocateControl:class extends s.Evented{constructor(v){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},Ay,v),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=yu(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(v){return this._map=v,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(v){const d=(m=!!this.options.geolocation)=>{this._supportsGeolocation=m,v(m)};this._supportsGeolocation!==void 0?v(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(m=>d(m.state!=="denied")).catch(()=>d()):d()}_isOutOfMapMaxBounds(v){const d=this._map.getMaxBounds(),m=v.coords;return!!d&&(m.longitude<d.getWest()||m.longitude>d.getEast()||m.latitude<d.getSouth()||m.latitude>d.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(v){if(this._map){if(this._isOutOfMapMaxBounds(v))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",v)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=v,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(v),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(v),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",v)),this._finish()}}_updateCamera(v){const d=new s.LngLat(v.coords.longitude,v.coords.latitude),m=v.coords.accuracy,w=this._map.getBearing(),T=s.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(d.toBounds(m),T,{geolocateSource:!0})}_updateMarker(v){if(v){const d=new s.LngLat(v.coords.longitude,v.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=v.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const v=this._map.transform,d=s.mercatorZfromAltitude(1,v._center.lat)*v.worldSize,m=Math.ceil(2*this._accuracy*d);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(v){if(this._map){if(this.options.trackUserLocation)if(v.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(v.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",v)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(v){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=E("button","mapboxgl-ctrl-geolocate",this._container),E("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",v===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=E("div","mapboxgl-user-location"),this._dotElement.appendChild(E("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(E("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new zt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=E("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new zt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(v){this._userLocationDotMarker&&(v.webkitCompassHeading?this._heading=v.webkitCompassHeading:v.absolute===!0&&(this._heading=-1*v.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(v={maximumAge:6e5,timeout:0},this._noTimeout=!0):(v=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,v),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const v=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(d=>{d==="granted"&&v()}).catch(console.error):v()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Vt,ScaleControl:class{constructor(v){this.options=s.extend({},Ny,v),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const v=this.options.maxWidth||100,d=this._map,m=d._containerHeight/2,w=d._containerWidth/2-v/2,T=d.unproject([w,m]),P=d.unproject([w+v,m]),D=T.distanceTo(P);if(this.options.unit==="imperial"){const z=3.2808*D;z>5280?this._setScale(v,z/5280,"mile"):this._setScale(v,z,"foot")}else this.options.unit==="nautical"?this._setScale(v,D/1852,"nautical-mile"):D>=1e3?this._setScale(v,D/1e3,"kilometer"):this._setScale(v,D,"meter")}_setScale(v,d,m){this._map._requestDomTask(()=>{const w=function(P){const D=Math.pow(10,`${Math.floor(P)}`.length-1);let z=P/D;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(U){const K=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*K)/K}(z),D*z}(d),T=w/d;this._container.innerHTML=this._isNumberFormatSupported&&m!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:m}).format(w):`${w}&nbsp;${ky[m]}`,this._container.style.width=v*T+"px"})}onAdd(v){return this._map=v,this._language=v.getLanguage(),this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-scale",v.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(v){this._language=v,this._update()}setUnit(v){this.options.unit=v,this._update()}},FullscreenControl:class{constructor(v){this._fullscreen=!1,v&&v.container&&(v.container instanceof s.window.HTMLElement?this._container=v.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const v=this._fullscreenButton=E("button","mapboxgl-ctrl-fullscreen",this._controlContainer);E("span","mapboxgl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",v)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(v){super(),this.options=s.extend(Object.create(Cy),v),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(v&&v.className?v.className.trim().split(/\s+/):[])}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&v.on("preclick",this._onClose),this.options.closeOnMove&&v.on("move",this._onClose),v.on("remove",this.remove),this._update(),v._addPopup(this),this._focusFirstElement(),this._trackPointer?(v.on("mousemove",this._onMouseEvent),v.on("mouseup",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")):v.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const v=this._map;return v&&(v.off("move",this._update),v.off("move",this._onClose),v.off("preclick",this._onClose),v.off("click",this._onClose),v.off("remove",this.remove),v.off("mousemove",this._onMouseEvent),v.off("mouseup",this._onMouseEvent),v.off("drag",this._onMouseEvent),v._canvasContainer&&v._canvasContainer.classList.remove("mapboxgl-track-pointer"),v._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(v){this._lngLat=s.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update();const d=this._map;return d&&(d.on("move",this._update),d.off("mousemove",this._onMouseEvent),d._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const v=this._map;return v&&(v.off("move",this._update),v.on("mousemove",this._onMouseEvent),v.on("drag",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(s.window.document.createTextNode(v))}setHTML(v){const d=s.window.document.createDocumentFragment(),m=s.window.document.createElement("body");let w;for(m.innerHTML=v;w=m.firstChild,w;)d.appendChild(w);return this.setDOMContent(d)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){let d=this._content;if(d)for(;d.hasChildNodes();)d.firstChild&&d.removeChild(d.firstChild);else d=this._content=E("div","mapboxgl-popup-content",this._container||void 0);if(d.appendChild(v),this.options.closeButton){const m=this._closeButton=E("button","mapboxgl-popup-close-button",d);m.type="button",m.setAttribute("aria-label","Close popup"),m.setAttribute("aria-hidden","true"),m.innerHTML="&#215;",m.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(v){return this._classList.add(v),this._updateClassList(),this}removeClassName(v){return this._classList.delete(v),this._updateClassList(),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){let d;return this._classList.delete(v)?d=!1:(this._classList.add(v),d=!0),this._updateClassList(),d}_onMouseEvent(v){this._update(v.point)}_getAnchor(v){if(this.options.anchor)return this.options.anchor;const d=this._map,m=this._container,w=this._pos;if(!d||!m||!w)return"bottom";const T=m.offsetWidth,P=m.offsetHeight,D=w.x<T/2,z=w.x>d.transform.width-T/2;if(w.y+v<P)return D?"top-left":z?"top-right":"top";if(w.y>d.transform.height-P){if(D)return"bottom-left";if(z)return"bottom-right"}return D?"left":z?"right":"bottom"}_updateClassList(){const v=this._container;if(!v)return;const d=[...this._classList];d.push("mapboxgl-popup"),this._anchor&&d.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&d.push("mapboxgl-popup-track-pointer"),v.className=d.join(" ")}_update(v){const d=this._map,m=this._content;if(!d||!this._lngLat&&!this._trackPointer||!m)return;let w=this._container;if(w||(w=this._container=E("div","mapboxgl-popup",d.getContainer()),this._tip=E("div","mapboxgl-popup-tip",w),w.appendChild(m)),this.options.maxWidth&&w.style.maxWidth!==this.options.maxWidth&&(w.style.maxWidth=this.options.maxWidth),d.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=bu(this._lngLat,this._pos,d.transform)),!this._trackPointer||v){const T=this._pos=this._trackPointer&&v?v:d.project(this._lngLat),P=Hb(this.options.offset),D=this._anchor=this._getAnchor(P.y),z=Hb(this.options.offset,D),U=T.add(z).round();d._requestDomTask(()=>{this._container&&D&&(this._container.style.transform=`${sc[D]} translate(${U.x}px,${U.y}px)`)})}if(!this._marker&&d._showingGlobe()){const T=s.isLngLatBehindGlobe(d.transform,this._lngLat)?0:1;this._setOpacity(T)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(dT);v&&v.focus()}_onClose(){this.remove()}_setOpacity(v){this._container&&(this._container.style.opacity=`${v}`),this._content&&(this._content.style.pointerEvents=v?"auto":"none")}},Marker:zt,Style:Ga,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:Mb,Evented:s.Evented,config:s.config,prewarm:function(){nu().acquire(Va)},clearPrewarmedResources:function(){const v=is;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(Va),is=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(v){s.config.ACCESS_TOKEN=v},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(v){s.config.API_URL=v},get workerCount(){return xi.workerCount},set workerCount(v){xi.workerCount=v},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(v){s.config.MAX_PARALLEL_IMAGE_REQUESTS=v},clearStorage(v){s.clearTileCache(v)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return _u});var h=i;return h})})(GZ);var XZ=GZ.exports;const _Ue=Sn(XZ),wUe=AU({__proto__:null,default:_Ue},[XZ]);function SUe(){const e="pk.eyJ1IjoiemFrbWVhZG93czE2IiwiYSI6ImNtYzFtanRxajA1NnMyaXM5NGpicGFwdXIifQ.rE6eaOez5Q6U6t-y58gzpQ";return l.jsxs("div",{className:"p-4",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:"Mapbox Token Test"}),l.jsxs("div",{className:"bg-gray-100 p-4 rounded",children:[l.jsxs("p",{children:["Token exists: ","Yes"]}),l.jsxs("p",{children:["Token starts with 'pk.': ",e!=null&&e.startsWith("pk.")?"Yes":"No"]}),l.jsxs("p",{children:["Token length: ",(e==null?void 0:e.length)||0]}),l.jsxs("p",{children:["First 10 characters: ",e==null?void 0:e.substring(0,10),"..."]})]})]})}const EUe=()=>{var B,q;const{bookingId:e,requestId:t}=uE(),r=ts(),{toast:n}=Ui(),[i,o]=I.useState(null),[h,s]=I.useState(null),[p,y]=I.useState(null),[b,_]=I.useState(!0),[E,C]=I.useState(!1),[k,N]=I.useState({cardNumber:"",expiryDate:"",cvv:"",cardholderName:""});I.useEffect(()=>{O()},[e,t]);const O=async()=>{try{_(!0);const{data:F,error:H}=await Ve.from("split_payment_requests").select(`
          *,
          bookings (
            *,
            venues (
              name,
              address,
              city
            ),
            profiles!bookings_user_id_fkey (
              first_name,
              last_name
            )
          )
        `).eq("id",t).eq("booking_id",e).single();if(H)throw H;if(F.status==="paid"){n({title:"Already Paid",description:"This payment request has already been completed.",variant:"destructive"}),r("/");return}if(F.status==="expired"){n({title:"Payment Expired",description:"This payment request has expired.",variant:"destructive"}),r("/");return}o(F),s(F.bookings),y(F.bookings.venues)}catch(F){console.error("Error fetching payment request:",F),n({title:"Error",description:"Failed to load payment request. Please check the link.",variant:"destructive"}),r("/")}finally{_(!1)}},R=F=>{const{name:H,value:Z}=F.target;N(re=>({...re,[H]:Z}))},L=async F=>{if(F.preventDefault(),!k.cardNumber||!k.expiryDate||!k.cvv||!k.cardholderName){n({title:"Missing Information",description:"Please fill in all payment details.",variant:"destructive"});return}C(!0);try{const{error:H}=await Ve.from("split_payment_requests").update({status:"paid",paid_at:new Date().toISOString()}).eq("id",i.id);if(H)throw H;const{error:Z}=await Ve.from("payment_notifications").insert([{user_id:i.requester_id,split_payment_id:i.id,type:"payment_received",title:"Payment Received",message:`Your split payment request of ${i.amount.toLocaleString()} has been paid.`}]);Z&&console.error("Error creating notification:",Z),n({title:"Payment Successful!",description:"Your payment has been processed successfully.",className:"bg-green-500 text-white"}),setTimeout(()=>{r("/")},2e3)}catch(H){console.error("Error processing payment:",H),n({title:"Payment Failed",description:"There was an error processing your payment. Please try again.",variant:"destructive"})}finally{C(!1)}};return b?l.jsx("div",{className:"container py-20 text-center",children:l.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[l.jsx("div",{className:"h-8 w-64 bg-secondary rounded mb-4"}),l.jsx("div",{className:"h-4 w-48 bg-secondary rounded"})]})}):i?l.jsxs("div",{className:"container py-10 max-w-2xl mx-auto",children:[l.jsxs(xt,{variant:"ghost",onClick:()=>r("/"),className:"mb-6",children:[l.jsx(gE,{className:"h-4 w-4 mr-2"}),"Back to Home"]}),l.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[l.jsxs(Mt,{className:"mb-6",children:[l.jsx(Dr,{children:l.jsxs(Lr,{className:"flex items-center gap-2",children:[l.jsx(Fc,{className:"h-6 w-6"}),"Split Payment Request"]})}),l.jsx(Ht,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-brand-cream/30 border border-brand-gold/20 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-lg",children:p==null?void 0:p.name}),l.jsxs("p",{className:"text-sm text-muted-foreground",children:[p==null?void 0:p.address,", ",p==null?void 0:p.city]})]}),l.jsx(Yr,{variant:"outline",children:"Split Payment"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx(Tt,{className:"text-muted-foreground",children:"Requested by"}),l.jsxs("p",{className:"font-medium",children:[(B=h==null?void 0:h.profiles)==null?void 0:B.first_name," ",(q=h==null?void 0:h.profiles)==null?void 0:q.last_name]})]}),l.jsxs("div",{children:[l.jsx(Tt,{className:"text-muted-foreground",children:"Booking Date"}),l.jsx("p",{className:"font-medium",children:new Date(h==null?void 0:h.booking_date).toLocaleDateString()})]})]})]}),l.jsxs("div",{className:"text-center py-6",children:[l.jsxs("div",{className:"text-3xl font-bold text-brand-burgundy mb-2",children:["",i.amount.toLocaleString()]}),l.jsx("p",{className:"text-muted-foreground",children:"Your portion of the booking"})]})]})})]}),l.jsxs(Mt,{children:[l.jsx(Dr,{children:l.jsx(Lr,{children:"Payment Details"})}),l.jsx(Ht,{children:l.jsxs("form",{onSubmit:L,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"cardholderName",children:"Cardholder Name"}),l.jsx(Lt,{id:"cardholderName",name:"cardholderName",value:k.cardholderName,onChange:R,placeholder:"John Doe",required:!0})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"cardNumber",children:"Card Number"}),l.jsx(Lt,{id:"cardNumber",name:"cardNumber",value:k.cardNumber,onChange:R,placeholder:"1234 5678 9012 3456",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"expiryDate",children:"Expiry Date"}),l.jsx(Lt,{id:"expiryDate",name:"expiryDate",value:k.expiryDate,onChange:R,placeholder:"MM/YY",required:!0})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"cvv",children:"CVV"}),l.jsx(Lt,{id:"cvv",name:"cvv",value:k.cvv,onChange:R,placeholder:"123",required:!0})]})]}),l.jsx(xt,{type:"submit",className:"w-full bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90",disabled:E,children:E?l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-brand-cream mr-2"}),"Processing Payment..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Fc,{className:"h-4 w-4 mr-2"}),"Pay ",i.amount.toLocaleString()]})})]})})]})]})]}):l.jsxs("div",{className:"container py-20 text-center",children:[l.jsx($0,{className:"h-16 w-16 mx-auto text-destructive mb-4"}),l.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Payment Request Not Found"}),l.jsx("p",{className:"text-muted-foreground mb-6",children:"The payment link may be invalid or expired."}),l.jsx(xt,{onClick:()=>r("/"),children:"Go Home"})]})},TUe=()=>{const e=Array.from({length:30},(t,r)=>({id:r,x:Math.random()*100,y:Math.random()*100,delay:Math.random()*5,duration:4+Math.random()*3,size:2+Math.random()*4}));return l.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.map(t=>l.jsx(tt.div,{className:"absolute rounded-full bg-gradient-to-r from-brand-gold/20 to-brand-burgundy/10",style:{left:`${t.x}%`,top:`${t.y}%`,width:`${t.size}px`,height:`${t.size}px`},animate:{y:[0,-50,0],x:[0,20,0],opacity:[.3,.8,.3],scale:[.8,1.2,.8]},transition:{duration:t.duration,repeat:1/0,delay:t.delay,ease:"easeInOut"}},t.id))})},jUe=({children:e})=>{const{scrollY:t}=Ime(),r=GB(t,[0,500],[0,-150]),n=GB(t,[0,300],[1,.3]);return l.jsx(tt.div,{style:{y:r,opacity:n},className:"relative",children:e})},CUe=({end:e,duration:t=2,suffix:r=""})=>{const[n,i]=I.useState(0),o=I.useRef(),h=zme(o,{once:!0});return I.useEffect(()=>{if(h){let s;const p=y=>{s||(s=y);const b=Math.min((y-s)/(t*1e3),1);i(Math.floor(b*e)),b<1&&requestAnimationFrame(p)};requestAnimationFrame(p)}},[h,e,t]),l.jsxs("span",{ref:o,children:[n,r]})},PUe=()=>{const[e,t]=I.useState({location:"",date:"",guests:"2",venueType:"all"}),[r,n]=I.useState([]),[i,o]=I.useState(["all"]);I.useState(["all","Restaurant","Club","Lounge"]);const[h,s]=I.useState(!0),[p,y]=I.useState(!1),b=I.useRef(),_=I.useRef(),E=I.useRef(),C=I.useRef();I.useEffect(()=>{k()},[]);const k=async()=>{try{s(!0);const{data:F,error:H}=await Ve.from("venues").select(`
          *,
          venue_images (
            image_url,
            is_primary
          )
        `).eq("status","approved").eq("is_active",!0).limit(6);if(H){console.error("Error fetching venues:",H);return}const Z=(F==null?void 0:F.map(W=>{var ie,ue,_e,xe,be;const te=((ue=(ie=W.venue_images)==null?void 0:ie.find(Ae=>Ae.is_primary))==null?void 0:ue.image_url)||((xe=(_e=W.venue_images)==null?void 0:_e[0])==null?void 0:xe.image_url),oe=((be=W.venue_images)==null?void 0:be.map(Ae=>Ae.image_url))||[];return{id:W.id,name:W.name,description:W.description,rating:W.rating||4.5,location:W.city,venueType:W.type,type:W.type,images:te?[te,...oe.filter(Ae=>Ae!==te)]:oe,address:W.address,city:W.city,price_range:W.price_range,vibe:W.vibe,isFeatured:!0}}))||[];n(Z);const re=["all",...new Set((F==null?void 0:F.map(W=>W.city))||[])];o(re)}catch(F){console.error("Error in fetchVenuesData:",F)}finally{s(!1)}},N=[{id:1,venueName:"Club DNA",location:"Victoria Island",deal:"50% off bottle service",validUntil:"2024-03-24",image:"https://images.unsplash.com/photo-1575429198097-0414ec08e8cd",originalPrice:"150,000",dealPrice:"75,000",remainingSpots:3,badge:"Hot Deal",badgeColor:"bg-red-500"},{id:2,venueName:"RSVP Lagos",location:"Lekki",deal:"Free entry for ladies",validUntil:"2024-03-24",image:"https://images.unsplash.com/photo-1575429198097-0414ec08e8cd",originalPrice:"10,000",dealPrice:"0",remainingSpots:15,badge:"Limited",badgeColor:"bg-orange-500"},{id:3,venueName:"Quilox",location:"Victoria Island",deal:"2-for-1 cocktails",validUntil:"2024-03-24",image:"https://images.unsplash.com/photo-1575429198097-0414ec08e8cd",originalPrice:"8,000",dealPrice:"4,000",remainingSpots:8,badge:"Popular",badgeColor:"bg-green-500"}],O=[{number:100,suffix:"+",label:"Premium Venues",icon:Y3},{number:5e4,suffix:"+",label:"Happy Customers",icon:Is},{number:4.9,suffix:"/5",label:"Average Rating",icon:Gs},{number:24,suffix:"/7",label:"Support Available",icon:gA}],R=[{icon:R8,title:"Instant Booking",description:"Book your table in seconds with our lightning-fast booking system",color:"from-brand-burgundy to-brand-burgundy/90"},{icon:gA,title:"Secure Payments",description:"Your payments are protected with bank-level security encryption",color:"from-brand-burgundy/90 to-brand-burgundy/80"},{icon:Y3,title:"VIP Treatment",description:"Enjoy exclusive perks and priority service at all partner venues",color:"from-brand-burgundy/80 to-brand-burgundy/70"},{icon:vE,title:"Best Prices",description:"Get the best deals and exclusive discounts on premium venues",color:"from-brand-burgundy/70 to-brand-burgundy/60"}],L=()=>{const F=Object.entries(e).filter(([Z,re])=>re&&re!=="all"&&re!=="").reduce((Z,[re,W])=>({...Z,[re]:W}),{}),H=new URLSearchParams(F).toString();window.location.href=`/venues${H?`?${H}`:""}`},B={hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.3,staggerChildren:.1}}},q={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}};return l.jsxs("div",{className:"bg-brand-cream text-brand-burgundy",children:[l.jsxs("section",{ref:b,className:"relative overflow-hidden py-20 md:py-32 min-h-screen flex items-center",children:[l.jsxs("div",{className:"absolute inset-0 z-0",children:[l.jsx(jUe,{children:l.jsx("img",{className:"w-full h-full object-cover",alt:"Elegant Lagos nightlife scene with city lights",src:"https://images.unsplash.com/photo-1504487857078-a29d3990e6aa"})}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-brand-cream/20 via-brand-cream/60 to-brand-cream/90"}),l.jsx(TUe,{})]}),l.jsx("div",{className:"container relative z-10",children:l.jsxs("div",{className:"max-w-6xl mx-auto",children:[l.jsxs(tt.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:1,ease:"easeOut"},className:"text-center mb-12",children:[l.jsxs(tt.h1,{className:"text-5xl md:text-7xl lg:text-8xl font-heading mb-8 text-brand-burgundy",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:1.2,ease:"easeOut"},children:["Find Your Perfect"," ",l.jsx(tt.span,{className:"bg-gradient-to-r from-brand-gold via-yellow-400 to-brand-gold bg-clip-text text-transparent",animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},style:{backgroundSize:"200% 200%"},children:"VIP"})," ","Experience"]}),l.jsx(tt.p,{className:"text-xl md:text-2xl text-brand-burgundy/80 font-medium max-w-3xl mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.3},children:"Book exclusive tables at Lagos' most prestigious venues with instant confirmation"})]}),l.jsx(tt.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.5},className:`bg-white p-8 rounded-3xl shadow-2xl border-2 transition-all duration-300 ${p?"border-brand-gold shadow-3xl scale-105":"border-brand-burgundy/10"}`,onFocus:()=>y(!0),onBlur:()=>y(!1),children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsxs(tt.div,{className:"relative",whileHover:{scale:1.02},transition:{type:"spring",stiffness:400,damping:10},children:[l.jsx(qs,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-brand-burgundy/50"}),l.jsxs(rl,{value:e.location,onValueChange:F=>t(H=>({...H,location:F})),children:[l.jsx(oo,{className:"pl-12 h-14 bg-white border-2 border-brand-burgundy/20 hover:border-brand-gold focus:border-brand-gold rounded-xl text-base",children:l.jsx(nl,{placeholder:"Where in Lagos?"})}),l.jsx(lo,{children:i.map(F=>l.jsx(Dn,{value:F,children:F},F))})]})]}),l.jsxs(tt.div,{className:"relative",whileHover:{scale:1.02},transition:{type:"spring",stiffness:400,damping:10},children:[l.jsx(ma,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-brand-burgundy/50"}),l.jsx(Lt,{type:"date",className:"pl-12 h-14 bg-white border-2 border-brand-burgundy/20 hover:border-brand-gold focus:border-brand-gold rounded-xl text-base",value:e.date,onChange:F=>t(H=>({...H,date:F.target.value})),min:new Date().toISOString().split("T")[0]})]}),l.jsxs(tt.div,{className:"relative",whileHover:{scale:1.02},transition:{type:"spring",stiffness:400,damping:10},children:[l.jsx(Is,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-brand-burgundy/50"}),l.jsxs(rl,{value:e.guests,onValueChange:F=>t(H=>({...H,guests:F})),children:[l.jsx(oo,{className:"pl-12 h-14 bg-white border-2 border-brand-burgundy/20 hover:border-brand-gold focus:border-brand-gold rounded-xl text-base",children:l.jsx(nl,{placeholder:"Guests"})}),l.jsx(lo,{children:[1,2,3,4,5,6,7,8,9,10].map(F=>l.jsxs(Dn,{value:F.toString(),children:[F," Guest",F>1?"s":""]},F))})]})]}),l.jsx(tt.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:l.jsxs(xt,{onClick:L,className:"w-full h-14 bg-gradient-to-r from-brand-burgundy to-brand-burgundy-light hover:from-brand-gold hover:to-yellow-500 text-white font-semibold text-base rounded-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[l.jsx(gd,{className:"mr-2 h-5 w-5"}),"Find Venues"]})})]})})]})})]}),l.jsx("section",{ref:C,className:"py-20 bg-gradient-to-r from-brand-burgundy via-brand-burgundy-light to-brand-burgundy",children:l.jsx("div",{className:"container",children:l.jsx(tt.div,{variants:B,initial:"hidden",whileInView:"visible",viewport:{once:!0},className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:O.map((F,H)=>l.jsxs(tt.div,{variants:q,className:"text-center text-white",whileHover:{scale:1.05,y:-5},children:[l.jsx(tt.div,{className:"inline-flex items-center justify-center w-16 h-16 bg-brand-gold rounded-full mb-4",animate:{rotate:[0,360]},transition:{duration:20,repeat:1/0,ease:"linear"},children:l.jsx(F.icon,{className:"w-8 h-8 text-brand-burgundy"})}),l.jsx("div",{className:"text-4xl md:text-5xl font-bold mb-2",children:l.jsx(CUe,{end:F.number,suffix:F.suffix})}),l.jsx("p",{className:"text-white/80 font-medium",children:F.label})]},H))})})}),l.jsx("section",{ref:_,className:"py-20 bg-white",children:l.jsxs("div",{className:"container",children:[l.jsxs(tt.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"text-center mb-16",children:[l.jsx("h2",{className:"text-3xl font-heading font-bold mb-12 text-center text-brand-burgundy",children:"Why Choose Eddys Members?"}),l.jsx("p",{className:"text-xl text-brand-burgundy/70 max-w-3xl mx-auto",children:"Experience the difference with our premium booking platform designed for discerning customers"})]}),l.jsx(tt.div,{variants:B,initial:"hidden",whileInView:"visible",viewport:{once:!0},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:R.map((F,H)=>l.jsxs(tt.div,{variants:q,whileHover:{y:-10,scale:1.02},className:"group relative overflow-hidden bg-white rounded-2xl p-8 shadow-lg hover:shadow-2xl transition-all duration-300 border border-brand-burgundy/10",children:[l.jsx(tt.div,{className:`absolute inset-0 bg-gradient-to-br ${F.color} opacity-0 group-hover:opacity-10 transition-opacity duration-300`}),l.jsx(tt.div,{className:`inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br ${F.color} rounded-xl mb-6`,whileHover:{rotate:5,scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:l.jsx(F.icon,{className:"w-8 h-8 text-white"})}),l.jsx("h3",{className:"text-xl font-bold text-brand-burgundy mb-4 group-hover:text-brand-gold transition-colors duration-300",children:F.title}),l.jsx("p",{className:"text-brand-burgundy/70 leading-relaxed",children:F.description})]},H))})]})}),l.jsx("section",{className:"py-20 bg-gradient-to-br from-brand-cream to-brand-cream/50",children:l.jsxs("div",{className:"container",children:[l.jsxs(tt.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"text-center mb-16",children:[l.jsxs("h2",{className:"text-4xl md:text-6xl font-heading text-brand-burgundy mb-6 font-bold",children:["This Weekend's ",l.jsx("span",{className:"text-brand-gold",children:"Hot Deals"})]}),l.jsx("p",{className:"text-xl text-brand-burgundy/70 max-w-3xl mx-auto",children:"Limited time offers on the hottest venues in Lagos. Book now before they're gone!"})]}),l.jsx(tt.div,{variants:B,initial:"hidden",whileInView:"visible",viewport:{once:!0},className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:N.map((F,H)=>l.jsxs(tt.div,{variants:q,whileHover:{y:-8,scale:1.02},className:"group relative overflow-hidden bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300",children:[l.jsxs("div",{className:"relative h-48 overflow-hidden",children:[l.jsx("img",{src:F.image,alt:F.venueName,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"}),l.jsx(tt.div,{className:`absolute top-4 left-4 ${F.badgeColor} text-white px-3 py-1 rounded-full text-sm font-semibold`,animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:F.badge}),l.jsxs("div",{className:"absolute bottom-4 left-4 text-white",children:[l.jsx("h3",{className:"text-xl font-bold",children:F.venueName}),l.jsxs("p",{className:"text-white/80 flex items-center",children:[l.jsx(qs,{className:"w-4 h-4 mr-1"}),F.location]})]})]}),l.jsxs("div",{className:"p-6",children:[l.jsx("p",{className:"text-lg font-semibold text-brand-burgundy mb-4",children:F.deal}),l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm text-brand-burgundy/60 line-through",children:F.originalPrice}),l.jsx("span",{className:"text-2xl font-bold text-brand-gold ml-2",children:F.dealPrice})]}),l.jsxs("span",{className:"text-sm text-brand-burgundy/60",children:[F.remainingSpots," spots left"]})]}),l.jsx(tt.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-gradient-to-r from-brand-burgundy to-brand-burgundy-light text-white py-3 rounded-xl font-semibold hover:from-brand-gold hover:to-yellow-500 transition-all duration-300",children:"Book This Deal"})]})]},F.id))})]})}),l.jsx("section",{ref:E,className:"py-20 bg-white",children:l.jsxs("div",{className:"container",children:[l.jsxs(tt.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"text-center mb-16",children:[l.jsx("h2",{className:"text-4xl md:text-6xl font-heading text-brand-burgundy mb-6 font-bold",children:"Featured Venues"}),l.jsx("p",{className:"text-xl text-brand-burgundy/70 max-w-3xl mx-auto",children:"Handpicked premium venues offering the finest experiences in Lagos"})]}),h?l.jsx(tt.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",variants:B,initial:"hidden",animate:"visible",children:[...Array(6)].map((F,H)=>l.jsx(tt.div,{variants:q,className:"bg-gray-200 rounded-2xl h-96 animate-pulse"},H))}):l.jsx(tt.div,{variants:B,initial:"hidden",whileInView:"visible",viewport:{once:!0},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:r.map((F,H)=>l.jsx(tt.div,{variants:q,custom:H,children:l.jsx(a9,{venue:F})},F.id))}),l.jsx(tt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6,delay:.8},className:"text-center mt-12",children:l.jsx(tt.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},onClick:()=>window.location.href="/venues",className:"bg-gradient-to-r from-brand-burgundy to-brand-burgundy-light hover:from-brand-gold hover:to-yellow-500 text-white px-8 py-4 rounded-xl font-semibold text-lg shadow-lg hover:shadow-xl transition-all duration-300",children:"View All Venues"})})]})})]})},AUe=()=>{const[e,t]=I.useState(""),[r,n]=I.useState(""),[i,o]=I.useState(""),[h,s]=I.useState(""),[p,y]=I.useState(""),[b,_]=I.useState(""),[E,C]=I.useState(""),[k,N]=I.useState(!1),[O,R]=I.useState(""),[L,B]=I.useState(""),[q,F]=I.useState(""),H=async Z=>{Z.preventDefault(),N(!0),R(""),B(""),F("");try{const re={email:e,password:r,options:{data:{full_name:i,age:h,country:p,city:b,phone:E}}};console.log(" DEBUG: Registration payload:",{email:e,name:i,age:h,country:p,city:b,phone:E,signUpPayload:re}),console.log(" DEBUG: Calling supabase.auth.signUp...");const{data:W,error:te}=await Ve.auth.signUp(re);if(console.log(" DEBUG: Auth response:",{data:W,error:te}),te){console.error(" DEBUG: Auth signup error:",{message:te.message,status:te.status,details:te}),R(`Auth Error: ${te.message}`);return}if(console.log(" DEBUG: Auth signup successful, user created:",W.user),B("Registration successful! Please check your email to confirm your account."),W.user){console.log(" DEBUG: Creating profile record...");const ie={id:W.user.id,full_name:i,age:h?parseInt(h):null,country:p,city:b,email:e,phone:E};console.log(" DEBUG: Profile data:",ie);const{data:ue,error:_e}=await Ve.from("profiles").upsert(ie);if(console.log(" DEBUG: Profile upsert result:",{profileResult:ue,profileError:_e}),_e){console.error(" DEBUG: Profile creation error:",_e),R(`Profile Error: ${_e.message}`);return}console.log(" DEBUG: Profile created successfully")}const oe=`${"https://agydpkzfucicraedllgl.supabase.co".replace(".supabase.co",".functions.supabase.co")}/send-email`;fetch(oe,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,subject:"Welcome to VIPClub!",template:"welcome",data:{email:e}})}).then(ie=>ie.json()).then(ie=>{ie.success?F("Welcome email sent!"):F("Registered, but failed to send welcome email.")}).catch(()=>{F("Registered, but failed to send welcome email.")})}catch(re){console.error(" DEBUG: Unexpected error during registration:",re),R(`Unexpected Error: ${re.message}`)}finally{N(!1)}};return l.jsxs("form",{onSubmit:H,className:"max-w-md mx-auto p-6 bg-white rounded shadow",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:"Register"}),l.jsx("input",{type:"text",placeholder:"Full Name",className:"w-full mb-2 p-2 border rounded",value:i,onChange:Z=>o(Z.target.value),required:!0}),l.jsx("input",{type:"number",placeholder:"Age",className:"w-full mb-2 p-2 border rounded",value:h,onChange:Z=>s(Z.target.value),min:1,required:!0}),l.jsx("input",{type:"text",placeholder:"Country",className:"w-full mb-2 p-2 border rounded",value:p,onChange:Z=>y(Z.target.value),required:!0}),l.jsx("input",{type:"text",placeholder:"City",className:"w-full mb-2 p-2 border rounded",value:b,onChange:Z=>_(Z.target.value),required:!0}),l.jsx("input",{type:"tel",placeholder:"Phone",className:"w-full mb-2 p-2 border rounded",value:E,onChange:Z=>C(Z.target.value),required:!0}),l.jsx("input",{type:"email",placeholder:"Email",className:"w-full mb-2 p-2 border rounded",value:e,onChange:Z=>t(Z.target.value),required:!0}),l.jsx("input",{type:"password",placeholder:"Password",className:"w-full mb-2 p-2 border rounded",value:r,onChange:Z=>n(Z.target.value),required:!0}),l.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700",disabled:k,children:k?"Registering...":"Register"}),O&&l.jsx("div",{className:"text-red-500 mt-2",children:O}),L&&l.jsx("div",{className:"text-green-600 mt-2",children:L}),q&&l.jsx("div",{className:"text-yellow-600 mt-2",children:q})]})},NUe=()=>l.jsx("div",{className:"bg-brand-cream/50 min-h-screen py-12",children:l.jsxs("div",{className:"container mx-auto px-4",children:[l.jsxs("div",{className:"text-center mb-12",children:[l.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"About Eddys Members"}),l.jsx("p",{className:"text-brand-burgundy/70 text-lg max-w-3xl mx-auto",children:"Built in honor of our friend Eddy - your gateway to Nigeria's most exclusive venue experiences. We connect you with premium venues and unforgettable moments across Lagos and beyond."})]}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center mb-16",children:[l.jsxs("div",{children:[l.jsx("img",{src:"/logos/callum.jpg",alt:"Eddy - Our beloved friend who inspired Eddys Members",className:"rounded-lg shadow-xl object-cover w-full h-auto aspect-[4/3] border-4 border-brand-gold",onError:e=>{console.log(" Failed to load Eddy image from:",e.target.src),e.target.src.includes("/logos/")?e.target.src="/images/logos/callum.jpg":(e.target.style.display="none",e.target.nextSibling.style.display="block")}}),l.jsx("div",{className:"rounded-lg shadow-xl w-full aspect-[4/3] border-4 border-brand-gold bg-brand-burgundy/10 flex items-center justify-center",style:{display:"none"},children:l.jsxs("div",{className:"text-center text-brand-burgundy/70",children:[l.jsx(Kn,{className:"w-16 h-16 mx-auto mb-2"}),l.jsx("p",{className:"text-sm",children:"Photo of Eddy"})]})}),l.jsx("p",{className:"text-center text-brand-burgundy/60 text-sm mt-2 italic",children:"Eddy - The inspiration behind Eddys Members"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("h2",{className:"text-3xl font-heading font-bold text-brand-burgundy",children:"Our Story"}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"Eddys Members was born from a deeply personal place - a promise to honor the memory of our dear friend Eddy, who believed that life's most precious moments happen when people come together. Eddy always said that everyone deserves to feel like a VIP, to experience the joy of being celebrated and surrounded by good company."}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:`After we lost Eddy, we realized how important it is to create spaces and opportunities for people to connect, celebrate, and make lasting memories. We named it "Eddys Members" in his honor - because to Eddy, VIP wasn't just about exclusive venues, it was about making every person feel valued, important, and part of something special.`}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"This platform is our way of ensuring that Eddy's vision lives on - connecting people with amazing venues where they can create the kind of memories he would have loved to be part of."}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsx(Yr,{className:"bg-brand-gold text-brand-burgundy",children:"Founded 2024"}),l.jsx(Yr,{className:"bg-brand-burgundy text-white",children:"Lagos Based"}),l.jsx(Yr,{className:"bg-brand-cream text-brand-burgundy border border-brand-burgundy",children:"Built with "})]})]})]}),l.jsx("div",{className:"mb-16",children:l.jsx(Mt,{className:"bg-gradient-to-r from-brand-burgundy/5 to-brand-gold/5 border-brand-gold/30",children:l.jsxs(Ht,{className:"p-8 text-center",children:[l.jsx("div",{className:"flex justify-center mb-6",children:l.jsxs("div",{className:"relative",children:[l.jsx("img",{src:"/logos/callum.jpg",alt:"Eddy - Forever in our hearts",className:"w-24 h-24 rounded-full object-cover border-4 border-brand-gold shadow-lg",onError:e=>{console.log(" Failed to load memorial image from:",e.target.src),e.target.src.includes("/logos/")?e.target.src="/images/logos/callum.jpg":(e.target.style.display="none",e.target.nextSibling.style.display="flex")}}),l.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-brand-gold shadow-lg bg-brand-burgundy/10 items-center justify-center",style:{display:"none"},children:l.jsx(Kn,{className:"w-12 h-12 text-brand-burgundy/70"})}),l.jsx("div",{className:"absolute -bottom-2 -right-2 bg-brand-burgundy rounded-full p-2",children:l.jsx(Fx,{className:"h-4 w-4 text-white fill-current"})})]})}),l.jsx("h3",{className:"text-2xl font-heading font-bold text-brand-burgundy mb-4",children:"In Loving Memory of Eddy"}),l.jsx("p",{className:"text-brand-burgundy/80 max-w-2xl mx-auto leading-relaxed",children:`"Everyone deserves their VIP moment" - these words from our beloved friend Eddy inspire everything we do. Though he's no longer with us, his spirit of bringing people together and making everyone feel special lives on through every booking, every celebration, and every connection made on our platform.`}),l.jsx("p",{className:"text-brand-burgundy/70 mt-4 italic",children:"This one's for you, Eddy. Thank you for showing us that the real VIP experience is about the people we share it with."})]})})}),l.jsxs("div",{className:"mb-16",children:[l.jsx("h2",{className:"text-3xl font-heading font-bold text-center mb-12 text-brand-burgundy",children:"What We Offer"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[{icon:l.jsx(Pie,{className:"h-10 w-10 text-brand-burgundy"}),title:"Exclusive Access",description:"Unlock doors to premium venues, VIP sections, and exclusive events across Lagos and Nigeria."},{icon:l.jsx(Lie,{className:"h-10 w-10 text-brand-burgundy"}),title:"Curated Venues",description:"Handpicked selection of top-tier restaurants, lounges, and clubs known for exceptional service and ambiance."},{icon:l.jsx(R8,{className:"h-10 w-10 text-brand-burgundy"}),title:"Seamless Booking",description:"Effortless table reservations and event bookings through our intuitive platform with instant confirmation."}].map((e,t)=>l.jsx(Mt,{className:"bg-white border-brand-burgundy/10 hover:shadow-lg transition-shadow",children:l.jsxs(Ht,{className:"p-6 text-center",children:[l.jsx("div",{className:"flex justify-center mb-4 p-3 bg-brand-gold/20 rounded-full w-fit mx-auto",children:e.icon}),l.jsx("h3",{className:"text-xl font-heading font-semibold mb-3 text-brand-burgundy",children:e.title}),l.jsx("p",{className:"text-brand-burgundy/70",children:e.description})]})},t))})]}),l.jsxs("div",{className:"mb-16",children:[l.jsx("h2",{className:"text-3xl font-heading font-bold text-center mb-12 text-brand-burgundy",children:"Our Values"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{icon:l.jsx(Fx,{className:"h-8 w-8"}),title:"Honor & Memory",description:"Every experience honors Eddy's belief that everyone deserves their VIP moment."},{icon:l.jsx(Gs,{className:"h-8 w-8"}),title:"Excellence",description:"We strive for perfection in every booking and experience, just as Eddy would have wanted."},{icon:l.jsx(gA,{className:"h-8 w-8"}),title:"Trust",description:"Secure payments and reliable service you can count on, built on a foundation of integrity."},{icon:l.jsx(Is,{className:"h-8 w-8"}),title:"Community",description:"Building connections and bringing people together, celebrating life and friendship."}].map((e,t)=>l.jsx(Mt,{className:"bg-white border-brand-burgundy/10 text-center",children:l.jsxs(Ht,{className:"p-6",children:[l.jsx("div",{className:"text-brand-burgundy mb-3 flex justify-center",children:e.icon}),l.jsx("h4",{className:"font-semibold text-brand-burgundy mb-2",children:e.title}),l.jsx("p",{className:"text-brand-burgundy/70 text-sm",children:e.description})]})},t))})]}),l.jsx("div",{className:"mb-16",children:l.jsx(Mt,{className:"bg-brand-burgundy text-white",children:l.jsx(Ht,{className:"p-8",children:l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 text-center",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-3xl font-bold text-brand-gold mb-2",children:"50+"}),l.jsx("div",{className:"text-brand-cream/80",children:"Partner Venues"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-3xl font-bold text-brand-gold mb-2",children:"1000+"}),l.jsxs("div",{className:"text-brand-cream/80",children:["VIP Moments Created",l.jsx("br",{}),l.jsx("span",{className:"text-xs",children:"In Eddy's Honor"})]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-3xl font-bold text-brand-gold mb-2",children:"24/7"}),l.jsx("div",{className:"text-brand-cream/80",children:"Customer Support"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-3xl font-bold text-brand-gold mb-2",children:"5"}),l.jsx("div",{className:"text-brand-cream/80",children:"Average Rating"})]})]})})})}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-6",children:[l.jsxs("h3",{className:"text-xl font-semibold text-brand-burgundy mb-4 flex items-center",children:[l.jsx(qs,{className:"h-5 w-5 mr-2"}),"Our Location & Contact"]}),l.jsxs("div",{className:"space-y-2 text-brand-burgundy/80",children:[l.jsx("p",{children:"Eddys Members - Built in Memory of Eddy"}),l.jsx("p",{children:"Based in Lagos, Nigeria"}),l.jsx("p",{children:"Serving venues nationwide"}),l.jsxs("p",{className:"pt-2",children:[l.jsx("strong",{children:"Email:"})," info@oneeddy.com",l.jsx("br",{}),l.jsx("strong",{children:"Instagram:"})," @eddy.members",l.jsx("br",{}),l.jsx("em",{className:"text-sm",children:"Continuing Eddy's legacy of bringing people together"})]})]})]})}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-6",children:[l.jsxs("h3",{className:"text-xl font-semibold text-brand-burgundy mb-4 flex items-center",children:[l.jsx(ml,{className:"h-5 w-5 mr-2"}),"Platform Availability"]}),l.jsxs("div",{className:"space-y-2 text-brand-burgundy/80",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Booking Platform"}),l.jsx("span",{children:"24/7 Available"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Email Support"}),l.jsx("span",{children:"Within 24 hours"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Venue Partners"}),l.jsx("span",{children:"Real-time updates"})]}),l.jsx("p",{className:"text-sm pt-2 border-t border-brand-burgundy/10",children:"Our platform honors Eddy's vision of making premium experiences accessible to everyone."})]})]})})]}),l.jsx("div",{className:"text-center mt-16",children:l.jsx(Mt,{className:"bg-brand-gold/20 border-brand-gold/30",children:l.jsxs(Ht,{className:"p-8",children:[l.jsx("h3",{className:"text-2xl font-heading font-bold text-brand-burgundy mb-4",children:"Ready to Create Your VIP Moment?"}),l.jsx("p",{className:"text-brand-burgundy/80 mb-6 max-w-2xl mx-auto",children:"Join thousands of people who have discovered their perfect venue through Eddys Members - Eddy's legacy of bringing people together. Every booking helps us carry forward Eddy's mission of making everyone feel special and creating unforgettable memories."}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[l.jsx("a",{href:"/venues",className:"inline-flex items-center justify-center px-8 py-3 bg-brand-burgundy text-white rounded-lg hover:bg-brand-burgundy/90 transition-colors font-semibold",children:"Explore Venues"}),l.jsx("a",{href:"/contact",className:"inline-flex items-center justify-center px-8 py-3 border border-brand-burgundy text-brand-burgundy rounded-lg hover:bg-brand-burgundy/10 transition-colors font-semibold",children:"Share Your Story"})]})]})})})]})}),kUe=()=>{const{toast:e}=Ui(),[t,r]=I.useState({name:"",email:"",subject:"",message:""}),[n,i]=I.useState(!1),o=s=>{const{name:p,value:y}=s.target;r(b=>({...b,[p]:y}))},h=async s=>{s.preventDefault(),i(!0),setTimeout(()=>{e({title:"Message Sent!",description:"Thank you for contacting us. We'll get back to you within 24 hours.",className:"bg-green-500 text-white"}),r({name:"",email:"",subject:"",message:""}),i(!1)},1e3)};return l.jsx("div",{className:"bg-brand-cream/50 min-h-screen py-12",children:l.jsxs("div",{className:"container mx-auto px-4",children:[l.jsxs("div",{className:"text-center mb-12",children:[l.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"Contact Us"}),l.jsx("p",{className:"text-brand-burgundy/70 text-lg max-w-2xl mx-auto",children:"Get in touch with our team. We're here to help with bookings, partnerships, or any questions you may have."})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[l.jsxs("div",{className:"lg:col-span-1",children:[l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10 h-fit",children:[l.jsx(Dr,{children:l.jsx(Lr,{className:"text-brand-burgundy",children:"Get in Touch"})}),l.jsxs(Ht,{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:"p-2 bg-brand-gold/20 rounded-full",children:l.jsx(Vx,{className:"h-5 w-5 text-brand-burgundy"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-brand-burgundy",children:"Email"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"info@oneeddy.com"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"General inquiries & support"})]})]}),l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:"p-2 bg-brand-gold/20 rounded-full",children:l.jsx(Am,{className:"h-5 w-5 text-brand-burgundy"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-brand-burgundy",children:"Phone"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Available via email"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Response within 24 hours"})]})]}),l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:"p-2 bg-brand-gold/20 rounded-full",children:l.jsx(qs,{className:"h-5 w-5 text-brand-burgundy"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-brand-burgundy",children:"Location"}),l.jsxs("p",{className:"text-brand-burgundy/70",children:["Based in Lagos, Nigeria",l.jsx("br",{}),"Serving venues nationwide",l.jsx("br",{}),"Built in memory of Eddy"]})]})]}),l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:"p-2 bg-brand-gold/20 rounded-full",children:l.jsx(ml,{className:"h-5 w-5 text-brand-burgundy"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-brand-burgundy",children:"Response Times"}),l.jsxs("p",{className:"text-brand-burgundy/70",children:["Email: Within 24 hours",l.jsx("br",{}),"Booking platform: 24/7 available",l.jsx("br",{}),"Urgent matters: Same day response"]})]})]})]})]}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10 mt-6",children:[l.jsx(Dr,{children:l.jsx(Lr,{className:"text-brand-burgundy",children:"Quick Links"})}),l.jsxs(Ht,{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-brand-burgundy mb-2",children:"For Customers"}),l.jsxs("ul",{className:"space-y-1 text-brand-burgundy/70",children:[l.jsx("li",{children:" Booking Help & Support"}),l.jsx("li",{children:" Payment Issues"}),l.jsx("li",{children:" Account Management"})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-brand-burgundy mb-2",children:"For Venue Owners"}),l.jsxs("ul",{className:"space-y-1 text-brand-burgundy/70",children:[l.jsx("li",{children:" Partnership Inquiries"}),l.jsx("li",{children:" Technical Support"}),l.jsx("li",{children:" Account Setup"})]})]})]})]})]}),l.jsxs("div",{className:"lg:col-span-2",children:[l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10",children:[l.jsxs(Dr,{children:[l.jsx(Lr,{className:"text-brand-burgundy",children:"Send us a Message"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Fill out the form below and we'll get back to you as soon as possible."})]}),l.jsx(Ht,{children:l.jsxs("form",{onSubmit:h,className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"name",className:"text-brand-burgundy",children:"Full Name"}),l.jsx(Lt,{id:"name",name:"name",type:"text",required:!0,value:t.name,onChange:o,className:"mt-1 border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your full name"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"email",className:"text-brand-burgundy",children:"Email Address"}),l.jsx(Lt,{id:"email",name:"email",type:"email",required:!0,value:t.email,onChange:o,className:"mt-1 border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your email"})]})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"subject",className:"text-brand-burgundy",children:"Subject"}),l.jsx(Lt,{id:"subject",name:"subject",type:"text",required:!0,value:t.subject,onChange:o,className:"mt-1 border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"What is this regarding?"})]}),l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"message",className:"text-brand-burgundy",children:"Message"}),l.jsx(ag,{id:"message",name:"message",required:!0,value:t.message,onChange:o,className:"mt-1 border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Tell us more about your inquiry...",rows:6})]}),l.jsx(xt,{type:"submit",disabled:n,className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:n?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):l.jsxs(l.Fragment,{children:[l.jsx(ax,{className:"h-4 w-4 mr-2"}),"Send Message"]})})]})})]}),l.jsxs(Mt,{className:"bg-white border-brand-burgundy/10 mt-6",children:[l.jsx(Dr,{children:l.jsx(Lr,{className:"text-brand-burgundy",children:"Frequently Asked Questions"})}),l.jsxs(Ht,{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-brand-burgundy mb-2",children:"How do I make a booking?"}),l.jsx("p",{className:"text-brand-burgundy/70 text-sm",children:"Simply browse our venues, select your preferred date and time, choose your table or ticket, and complete the payment process."})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-brand-burgundy mb-2",children:"Can I cancel my booking?"}),l.jsx("p",{className:"text-brand-burgundy/70 text-sm",children:"Yes, cancellations are allowed based on each venue's policy. Check your booking confirmation for specific cancellation terms."})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-brand-burgundy mb-2",children:"How do I become a venue partner?"}),l.jsx("p",{className:"text-brand-burgundy/70 text-sm",children:"Visit our venue owner registration page or contact us directly to discuss partnership opportunities."})]})]})]})]})]})]})})},MUe=()=>l.jsx("div",{className:"bg-brand-cream/50 min-h-screen py-12",children:l.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[l.jsxs("div",{className:"text-center mb-12",children:[l.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"Terms of Service"}),l.jsx("p",{className:"text-brand-burgundy/70 text-lg max-w-2xl mx-auto",children:"By using Eddys Members services, you agree to these terms. Please read them carefully."})]}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-8 space-y-8",children:[l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"1. Acceptance of Terms"}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"By accessing and using Eddys Members's services, you accept and agree to be bound by the terms and provision of this agreement. If you do not agree to abide by the above, please do not use this service."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"2. Use License"}),l.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[l.jsx("p",{children:"Permission is granted to temporarily download one copy of Eddys Members's materials for personal, non-commercial transitory viewing only. This is the grant of a license, not a transfer of title, and under this license you may not:"}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[l.jsx("li",{children:"modify or copy the materials"}),l.jsx("li",{children:"use the materials for any commercial purpose or for any public display"}),l.jsx("li",{children:"attempt to decompile or reverse engineer any software contained on the website"}),l.jsx("li",{children:"remove any copyright or other proprietary notations from the materials"})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"3. Booking and Payments"}),l.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[l.jsx("p",{children:l.jsx("strong",{children:"Booking Policy:"})}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[l.jsx("li",{children:"All bookings are subject to venue availability and confirmation"}),l.jsx("li",{children:"Bookings must be made by individuals 18 years or older"}),l.jsx("li",{children:"False information provided during booking may result in cancellation"}),l.jsx("li",{children:"Eddys Members reserves the right to refuse service to anyone"})]}),l.jsx("p",{children:l.jsx("strong",{children:"Payment Terms:"})}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[l.jsx("li",{children:"Payment is required at the time of booking unless otherwise specified"}),l.jsx("li",{children:"All prices are in Nigerian Naira () and include applicable taxes"}),l.jsx("li",{children:"Service fees and processing charges may apply"}),l.jsx("li",{children:"Refunds are subject to the cancellation policy of each venue"})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"4. Cancellation and Refund Policy"}),l.jsx("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:l.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[l.jsx("li",{children:"Cancellations made 24+ hours before the booking date are eligible for a full refund"}),l.jsx("li",{children:"Cancellations made 12-24 hours before the booking date are eligible for a 50% refund"}),l.jsx("li",{children:"Cancellations made less than 12 hours before the booking date are non-refundable"}),l.jsx("li",{children:"Venue-initiated cancellations will result in a full refund"}),l.jsx("li",{children:"Refund processing may take 5-10 business days"})]})})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"5. User Conduct"}),l.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[l.jsx("p",{children:"Users agree to:"}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[l.jsx("li",{children:"Provide accurate and truthful information"}),l.jsx("li",{children:"Respect venue rules and regulations"}),l.jsx("li",{children:"Behave appropriately and not disturb other guests"}),l.jsx("li",{children:"Not engage in illegal activities on the premises"}),l.jsx("li",{children:"Follow dress codes and entry requirements as specified by venues"})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"6. Venue Owner Responsibilities"}),l.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[l.jsx("p",{children:"Venue owners using our platform agree to:"}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[l.jsx("li",{children:"Provide accurate venue information and availability"}),l.jsx("li",{children:"Honor confirmed bookings unless extraordinary circumstances arise"}),l.jsx("li",{children:"Maintain venue standards as advertised"}),l.jsx("li",{children:"Process refunds according to stated policies"}),l.jsx("li",{children:"Comply with all local laws and regulations"})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"7. Disclaimer"}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"The materials on Eddys Members's website are provided on an 'as is' basis. Eddys Members makes no warranties, expressed or implied, and hereby disclaims and negates all other warranties including without limitation, implied warranties or conditions of merchantability, fitness for a particular purpose, or non-infringement of intellectual property or other violation of rights."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"8. Limitations"}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"In no event shall Eddys Members or its suppliers be liable for any damages (including, without limitation, damages for loss of data or profit, or due to business interruption) arising out of the use or inability to use the materials on Eddys Members's website, even if Eddys Members or a Eddys Members authorized representative has been notified orally or in writing of the possibility of such damage."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"9. Privacy Policy"}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"Your privacy is important to us. Please review our Privacy Policy, which also governs your use of the Service, to understand our practices."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"10. Modifications"}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"Eddys Members may revise these terms of service at any time without notice. By using this website, you are agreeing to be bound by the then current version of these terms of service."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-heading font-bold text-brand-burgundy mb-6",children:"Contact Information"}),l.jsxs("div",{children:[l.jsx("p",{children:"If you have any questions about these Terms of Service, please contact us at:"}),l.jsxs("div",{className:"mt-3 p-4 bg-brand-cream/30 rounded-lg",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Email:"})," info@oneeddy.com"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Response Time:"})," Within 24 hours"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Based in:"})," Lagos, Nigeria"]})]})]})]})]})})]})}),IUe=()=>l.jsx("div",{className:"bg-brand-cream/50 min-h-screen py-12",children:l.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"Privacy Policy"}),l.jsxs("p",{className:"text-brand-burgundy/70",children:["Last updated: ",new Date().toLocaleDateString()]})]}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-8 space-y-8",children:[l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"1. Information We Collect"}),l.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[l.jsx("p",{children:l.jsx("strong",{children:"Personal Information:"})}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[l.jsx("li",{children:"Name, email address, and phone number"}),l.jsx("li",{children:"Payment information (processed securely by third-party providers)"}),l.jsx("li",{children:"Booking preferences and history"}),l.jsx("li",{children:"Location data (when you allow it)"})]}),l.jsx("p",{children:l.jsx("strong",{children:"Automatically Collected Information:"})}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[l.jsx("li",{children:"IP address and device information"}),l.jsx("li",{children:"Browser type and version"}),l.jsx("li",{children:"Usage patterns and preferences"}),l.jsx("li",{children:"Cookies and similar tracking technologies"})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"2. How We Use Your Information"}),l.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed",children:[l.jsx("p",{children:"We use your information to:"}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2 mt-3",children:[l.jsx("li",{children:"Process and manage your bookings"}),l.jsx("li",{children:"Send booking confirmations and updates"}),l.jsx("li",{children:"Provide customer support"}),l.jsx("li",{children:"Improve our services and user experience"}),l.jsx("li",{children:"Send promotional offers (with your consent)"}),l.jsx("li",{children:"Prevent fraud and ensure platform security"}),l.jsx("li",{children:"Comply with legal obligations"})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"3. Information Sharing"}),l.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[l.jsx("p",{children:"We may share your information with:"}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Venues:"})," Name, contact details, and booking information"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Payment Processors:"})," Necessary payment information"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Service Providers:"})," Trusted partners who help operate our platform"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Legal Authorities:"})," When required by law or to protect our rights"]})]}),l.jsx("p",{className:"mt-3",children:l.jsx("strong",{children:"We never sell your personal information to third parties."})})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"4. Data Security"}),l.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[l.jsx("p",{children:"We protect your information through:"}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[l.jsx("li",{children:"SSL encryption for all data transmission"}),l.jsx("li",{children:"Secure servers with regular security updates"}),l.jsx("li",{children:"Limited access to personal information by employees"}),l.jsx("li",{children:"Regular security audits and monitoring"}),l.jsx("li",{children:"Compliance with industry security standards"})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"5. Your Rights and Choices"}),l.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[l.jsx("p",{children:"You have the right to:"}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[l.jsx("li",{children:"Access and review your personal information"}),l.jsx("li",{children:"Update or correct your information"}),l.jsx("li",{children:"Delete your account and associated data"}),l.jsx("li",{children:"Opt-out of marketing communications"}),l.jsx("li",{children:"Request data portability"}),l.jsx("li",{children:"Object to certain types of processing"})]}),l.jsx("p",{className:"mt-3",children:"To exercise these rights, contact us at privacy@vipclub.ng"})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"6. Cookies and Tracking"}),l.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[l.jsx("p",{children:"We use cookies to:"}),l.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[l.jsx("li",{children:"Remember your preferences and settings"}),l.jsx("li",{children:"Analyze site usage and performance"}),l.jsx("li",{children:"Provide personalized content"}),l.jsx("li",{children:"Enable social media features"})]}),l.jsx("p",{className:"mt-3",children:"You can control cookies through your browser settings, but some features may not work properly if disabled."})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"7. Data Retention"}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"We retain your personal information for as long as necessary to provide our services, comply with legal obligations, resolve disputes, and enforce our agreements. Booking history may be retained for up to 7 years for business and legal purposes."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"8. International Data Transfers"}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"Your information may be transferred to and processed in countries other than Nigeria. We ensure appropriate safeguards are in place to protect your information in accordance with this privacy policy."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"9. Children's Privacy"}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"Our services are not intended for children under 18. We do not knowingly collect personal information from children. If you believe we have collected information from a child, please contact us immediately."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"10. Changes to This Policy"}),l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:'We may update this privacy policy from time to time. We will notify you of any material changes by posting the new policy on this page and updating the "Last updated" date. Your continued use of our services constitutes acceptance of the updated policy.'})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"11. Contact Us"}),l.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed",children:[l.jsx("p",{children:"If you have questions about this privacy policy or your personal information, contact us:"}),l.jsxs("div",{className:"mt-3 p-4 bg-brand-cream/30 rounded-lg",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Email:"})," info@oneeddy.com"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Response Time:"})," Within 24 hours"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Based in:"})," Lagos, Nigeria"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Privacy Inquiries:"})," All privacy matters handled at info@oneeddy.com"]})]})]})]})]})})]})}),OUe=()=>{const[e,t]=I.useState(""),[r,n]=I.useState("all"),[i,o]=I.useState(null),h=[{id:"all",name:"All Questions",icon:Q3},{id:"booking",name:"Booking",icon:Is},{id:"payment",name:"Payment",icon:Fc},{id:"venues",name:"Venues",icon:bie}],p=[{id:1,category:"booking",question:"How do I make a reservation?",answer:"To make a reservation, browse our available venues, select your preferred date and time, choose the number of guests, select a table or ticket type, and complete the payment process. You'll receive a confirmation email with all the details."},{id:2,category:"booking",question:"Can I modify or cancel my booking?",answer:`Yes, you can modify or cancel your booking through your account dashboard. Cancellation policies vary by venue:
 24+ hours before: Full refund
 12-24 hours before: 50% refund
 Less than 12 hours: No refund

Modifications are subject to availability.`},{id:3,category:"booking",question:"What happens if the venue cancels my booking?",answer:"If a venue cancels your booking, you will receive a full refund automatically. We will also help you find alternative venues with similar offerings and may provide additional compensation for the inconvenience."},{id:4,category:"booking",question:"Can I book for someone else?",answer:"Yes, you can make a booking for someone else. However, the person attending must have valid identification that matches the booking details. You can add guest information during the booking process."},{id:5,category:"payment",question:"What payment methods do you accept?",answer:`We accept various payment methods including:
 Credit/Debit cards (Visa, Mastercard)
 Bank transfers
 Mobile money (depending on location)
 Cryptocurrency (Bitcoin, Ethereum)

All payments are processed securely through our encrypted payment system.`},{id:6,category:"payment",question:"When will I be charged?",answer:"Payment is typically processed immediately upon booking confirmation. For some premium venues, a deposit may be required at booking with the remaining balance due closer to your visit date."},{id:7,category:"payment",question:"How long do refunds take?",answer:"Refunds are processed within 5-10 business days to your original payment method. The exact timing depends on your bank or payment provider. You'll receive an email confirmation when the refund is initiated."},{id:8,category:"payment",question:"Are there any additional fees?",answer:"A small service fee may apply to cover payment processing and platform maintenance. This fee is clearly displayed before you complete your booking. There are no hidden charges."},{id:9,category:"venues",question:"How do I find venues near me?",answer:"Use our location-based search feature on the venues page. You can filter by distance, type of venue, price range, and amenities. Enable location services for the most accurate results."},{id:10,category:"venues",question:"What information is provided about each venue?",answer:`Each venue listing includes:
 Photos and virtual tours
 Location and contact details
 Capacity and table layouts
 Menu and pricing information
 Dress code and entry requirements
 Customer reviews and ratings
 Available dates and times`},{id:11,category:"venues",question:"Can I visit a venue before booking?",answer:"Many venues welcome visits during their operating hours. Contact the venue directly through our platform to arrange a viewing. Some venues also offer virtual tours on their listing page."},{id:12,category:"venues",question:"How do I list my venue on Eddys Members?",answer:`Venue owners can register through our venue owner portal. The process includes:
 Account creation and verification
 Venue information submission
 Photo uploads and virtual tour setup
 Pricing and availability configuration
 Approval process (typically 2-3 business days)`},{id:13,category:"booking",question:"What should I bring to my reservation?",answer:`Please bring:
 Valid photo ID matching the booking name
 Booking confirmation (digital or printed)
 Payment method for any additional purchases
 Any special requirements documentation if applicable`},{id:14,category:"booking",question:"What if I arrive late?",answer:"Please contact the venue directly if you're running late. Most venues hold reservations for 15-30 minutes past the booking time. After this period, your table may be released to other guests."},{id:15,category:"payment",question:"Can I split the payment with friends?",answer:`Yes! Our split payment feature allows you to divide the cost among multiple people. During checkout, select "Split Payment" and enter your friends' details. They'll receive payment links via email or SMS.`}].filter(b=>{const _=b.question.toLowerCase().includes(e.toLowerCase())||b.answer.toLowerCase().includes(e.toLowerCase()),E=r==="all"||b.category===r;return _&&E}),y=b=>{o(i===b?null:b)};return l.jsx("div",{className:"bg-brand-cream/50 min-h-screen py-12",children:l.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[l.jsxs("div",{className:"text-center mb-12",children:[l.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"Frequently Asked Questions"}),l.jsx("p",{className:"text-brand-burgundy/70 text-lg max-w-2xl mx-auto",children:"Find answers to common questions about Eddys Members bookings, payments, and venues."})]}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10 mb-8",children:l.jsx(Ht,{className:"p-6",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(gd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-brand-burgundy/50 h-4 w-4"}),l.jsx(Lt,{type:"text",placeholder:"Search questions...",value:e,onChange:b=>t(b.target.value),className:"pl-10 border-brand-burgundy/20 focus:border-brand-burgundy"})]}),l.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(b=>{const _=b.icon;return l.jsxs("button",{onClick:()=>n(b.id),className:`flex items-center space-x-2 px-4 py-2 rounded-full transition-colors ${r===b.id?"bg-brand-burgundy text-white":"bg-brand-cream/50 text-brand-burgundy hover:bg-brand-burgundy/10"}`,children:[l.jsx(_,{className:"h-4 w-4"}),l.jsx("span",{children:b.name})]},b.id)})})]})})}),l.jsx("div",{className:"space-y-4",children:p.length===0?l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-8 text-center",children:[l.jsx(Q3,{className:"h-12 w-12 text-brand-burgundy/30 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"No questions found"}),l.jsx("p",{className:"text-brand-burgundy/70",children:"Try adjusting your search terms or selecting a different category."})]})}):p.map(b=>l.jsx(Mt,{className:"bg-white border-brand-burgundy/10",children:l.jsxs(Ht,{className:"p-0",children:[l.jsxs("button",{onClick:()=>y(b.id),className:"w-full px-6 py-4 text-left flex items-center justify-between hover:bg-brand-cream/30 transition-colors",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Yr,{variant:"outline",className:"border-brand-gold text-brand-burgundy bg-brand-gold/10",children:b.category}),l.jsx("h3",{className:"font-semibold text-brand-burgundy",children:b.question})]}),i===b.id?l.jsx(wie,{className:"h-5 w-5 text-brand-burgundy/50"}):l.jsx(C8,{className:"h-5 w-5 text-brand-burgundy/50"})]}),i===b.id&&l.jsx("div",{className:"px-6 pb-4",children:l.jsx("div",{className:"pt-2 border-t border-brand-burgundy/10",children:l.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed whitespace-pre-line",children:b.answer})})})]})},b.id))}),l.jsx(Mt,{className:"bg-white border-brand-burgundy/10 mt-8",children:l.jsxs(Ht,{className:"p-6 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"Still have questions?"}),l.jsx("p",{className:"text-brand-burgundy/70 mb-4",children:"Can't find what you're looking for? Our support team is here to help."}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[l.jsx("a",{href:"/contact",className:"inline-flex items-center justify-center px-6 py-2 bg-brand-burgundy text-white rounded-lg hover:bg-brand-burgundy/90 transition-colors",children:"Contact Support"}),l.jsx("a",{href:"mailto:info@oneeddy.com",className:"inline-flex items-center justify-center px-6 py-2 border border-brand-burgundy text-brand-burgundy rounded-lg hover:bg-brand-burgundy/10 transition-colors",children:"Email Us"})]})]})})]})})},RUe=()=>{const[e,t]=I.useState("test@example.com"),[r,n]=I.useState(null),[i,o]=I.useState("booking"),[h,s]=I.useState(!1),{toast:p}=Ui(),y={id:"BOOK123456",booking_date:new Date().toISOString(),booking_time:"20:00:00",guest_count:4,table_number:"VIP-001",total_amount:"25000",status:"confirmed"},b={name:"The Golden Lounge",address:"123 Victoria Island, Lagos, Nigeria",contact_phone:"+234 801 234 5678",contact_email:"info@goldenlounge.com",images:["/images/sample-venue.jpg"],dress_code:"Smart casual"},_={full_name:"John Doe",email:e,phone:"+234 803 456 7890"},E={full_name:"Venue Manager",email:"owner@goldenlounge.com"},C=async R=>{try{s(!0);const{bookingConfirmationTemplate:L,venueOwnerNotificationTemplate:B,cancellationTemplate:q,generateEmailData:F}=await Os(()=>Promise.resolve().then(()=>uve),void 0),H=F(y,b,_);let Z="";switch(R){case"booking":Z=L(H);break;case"owner":Z=B(H,E);break;case"cancellation":H.refundAmount="20000",Z=q(H);break;default:Z="<p>No template selected</p>"}n(Z)}catch(L){console.error("Error generating preview:",L),p({title:"Preview Error",description:`Failed to generate preview: ${L.message}`,variant:"destructive"})}finally{s(!1)}},k=async()=>{try{s(!0),console.log(" [V2] Testing admin notification system...",Date.now());const{notifyAdminOfVenueSubmission:R}=await Os(()=>Promise.resolve().then(()=>pye),void 0),L={id:"test-venue-123",name:"V2 TEST - Admin Notification Venue",type:"restaurant",address:"123 V2 Test Street, Lagos, Nigeria",city:"Lagos",description:"Version 2 cache test venue for admin notifications"},B={id:"test-user-123",first_name:"Version",last_name:"Two",phone:"+234 803 456 7890",email:e},q={id:"test-user-123",email:e};console.log(" [V2] Sending admin notification - should show NEW template..."),await R(L,B,q),console.log(" [V2] Admin notification test successful"),p({title:"Admin Notification Test Successful!",description:"V2 notification sent to sales@oneeddy.com"})}catch(R){console.error(" Admin notification test failed:",R),p({title:"Admin Notification Test Failed",description:R.message||"Failed to send admin notification",variant:"destructive"})}finally{s(!1)}},N=async()=>{try{s(!0),console.log(" Testing basic email service..."),p({title:"Basic Email Test",description:"Email service test completed. Check console for details."})}catch(R){console.error("Email test error:",R),p({title:"Email Test Error",description:`Error: ${R.message}`,variant:"destructive"})}finally{s(!1)}},O=async()=>{try{s(!0),console.log(" Testing EmailJS connectivity...");const R=await s9();R.success?(p({title:"EmailJS Connection Test Successful!",description:`EmailJS is working with: ${R.workingFields}`}),console.log(" Working field configuration:",R.workingData),console.log(" Use these fields in your admin notification function")):p({title:"EmailJS Connection Test Failed",description:R.error||"All field variations failed",variant:"destructive"})}catch(R){console.error(" EmailJS connection test failed:",R),p({title:"EmailJS Connection Test Failed",description:R.message||"Failed to test EmailJS connection",variant:"destructive"})}finally{s(!1)}};return l.jsxs("div",{className:"container py-8",children:[l.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-6",children:"Email Template Testing"}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsxs(Mt,{children:[l.jsx(Dr,{children:l.jsx(Lr,{children:"Template Controls"})}),l.jsxs(Ht,{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Tt,{htmlFor:"test-email",children:"Test Email Address"}),l.jsx(Lt,{id:"test-email",type:"email",value:e,onChange:R=>t(R.target.value),placeholder:"Enter your email to test"})]}),l.jsxs(wg,{value:i,onValueChange:o,children:[l.jsxs(Sf,{className:"grid w-full grid-cols-3",children:[l.jsx(Ci,{value:"booking",children:"Customer"}),l.jsx(Ci,{value:"owner",children:"Venue Owner"}),l.jsx(Ci,{value:"cancellation",children:"Cancellation"})]}),l.jsx(Pi,{value:"booking",className:"mt-4",children:l.jsx("p",{className:"text-sm text-muted-foreground",children:"Preview the booking confirmation email sent to customers."})}),l.jsx(Pi,{value:"owner",className:"mt-4",children:l.jsx("p",{className:"text-sm text-muted-foreground",children:"Preview the new booking notification sent to venue owners."})}),l.jsx(Pi,{value:"cancellation",className:"mt-4",children:l.jsx("p",{className:"text-sm text-muted-foreground",children:"Preview the cancellation email with refund information."})})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(xt,{onClick:()=>C(i),className:"w-full",disabled:h,children:h?"Loading...":"Generate Preview"}),l.jsx(xt,{onClick:O,variant:"outline",className:"w-full bg-blue-50 hover:bg-blue-100 text-blue-800",disabled:h,children:h?"Testing...":"Test EmailJS Connection"}),l.jsx(xt,{onClick:N,variant:"outline",className:"w-full",disabled:h,children:h?"Testing...":"Test Basic Email"}),l.jsx(xt,{onClick:k,variant:"outline",className:"w-full bg-orange-50 hover:bg-orange-100 text-orange-800",disabled:h,children:h?"Testing...":"Test Admin Notification"})]}),l.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[l.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Template Testing:"}),l.jsx("p",{className:"text-sm text-blue-700",children:'Use the "Generate Preview" button to see how the email templates look. The preview uses sample data from a test venue booking.'})]}),l.jsxs("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[l.jsx("h4",{className:"font-semibold text-orange-800 mb-2",children:"Admin Notification Test:"}),l.jsxs("p",{className:"text-sm text-orange-700",children:["This tests the admin notification system that sends emails to ",l.jsx("strong",{children:"sales@oneeddy.com"})," when venue owners register. Now using the proper Supabase function invocation method."]})]}),l.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[l.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:" Fixed Connection Issue:"}),l.jsxs("p",{className:"text-sm text-green-700",children:["Updated to use ",l.jsx("code",{children:"supabase.functions.invoke()"})," instead of direct fetch calls for better reliability."]})]})]})]}),l.jsxs(Mt,{children:[l.jsx(Dr,{children:l.jsx(Lr,{children:"Email Preview"})}),l.jsx(Ht,{children:h?l.jsx("div",{className:"text-center py-8 text-muted-foreground",children:l.jsx("p",{children:"Loading preview..."})}):r?l.jsx("div",{className:"border rounded-lg p-4 bg-white max-h-96 overflow-y-auto",children:l.jsx("div",{dangerouslySetInnerHTML:{__html:r},className:"email-preview"})}):l.jsx("div",{className:"text-center py-8 text-muted-foreground",children:l.jsx("p",{children:'Click "Generate Preview" to see the email template'})})})]})]}),l.jsx("style",{jsx:!0,children:`
        .email-preview img {
          max-width: 100%;
          height: auto;
        }
        
        .email-preview table {
          max-width: 100%;
        }
        
        .email-preview {
          font-size: 12px;
        }
      `})]})},DUe=()=>l.jsx(Fue,{children:l.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[l.jsx(Wue,{}),l.jsx(Uue,{}),l.jsx("main",{className:"flex-grow",children:l.jsxs($re,{children:[l.jsx(Ir,{path:"/",element:l.jsx(Vme,{})}),l.jsx(Ir,{path:"/home",element:l.jsx(PUe,{})}),l.jsx(Ir,{path:"/venues",element:l.jsx(wye,{})}),l.jsx(Ir,{path:"/venues/:id",element:l.jsx(o9,{})}),l.jsx(Ir,{path:"/checkout",element:l.jsx(NC,{})}),l.jsx(Ir,{path:"/checkout/:id",element:l.jsx(NC,{})}),l.jsx(Ir,{path:"/checkout/deposit",element:l.jsx(NC,{})}),l.jsx(Ir,{path:"/split-payment/:bookingId/:requestId",element:l.jsx(EUe,{})}),l.jsx(Ir,{path:"/explore",element:l.jsx(fUe,{})}),l.jsx(Ir,{path:"/profile",element:l.jsx(LFe,{})}),l.jsx(Ir,{path:"/bookings",element:l.jsx(BFe,{})}),l.jsx(Ir,{path:"/settings",element:l.jsx(zFe,{})}),l.jsx(Ir,{path:"/reset-password",element:l.jsx(gU,{})}),l.jsx(Ir,{path:"/venue-credit-purchase",element:l.jsx(jU,{})}),l.jsx(Ir,{path:"/about",element:l.jsx(NUe,{})}),l.jsx(Ir,{path:"/contact",element:l.jsx(kUe,{})}),l.jsx(Ir,{path:"/terms",element:l.jsx(MUe,{})}),l.jsx(Ir,{path:"/privacy",element:l.jsx(IUe,{})}),l.jsx(Ir,{path:"/faq",element:l.jsx(OUe,{})}),l.jsx(Ir,{path:"/venue-owner/login",element:l.jsx(gFe,{})}),l.jsx(Ir,{path:"/venue-owner/register",element:l.jsx(yFe,{})}),l.jsx(Ir,{path:"/venue-owner/reset-password",element:l.jsx(gU,{})}),l.jsx(Ir,{path:"/venue-owner/pending",element:l.jsx(vFe,{})}),l.jsx(Ir,{path:"/venue-owner/dashboard",element:l.jsx(hFe,{})}),l.jsx(Ir,{path:"/venue-owner/bookings",element:l.jsx(xFe,{})}),l.jsx(Ir,{path:"/venue-owner/tables",element:l.jsx(_Fe,{})}),l.jsx(Ir,{path:"/venue-owner/analytics",element:l.jsx(wFe,{})}),l.jsx(Ir,{path:"/venue-owner/settings",element:l.jsx(PFe,{})}),l.jsx(Ir,{path:"/venue-owner/credits",element:l.jsx(AFe,{})}),l.jsx(Ir,{path:"/venue-owner/receipts",element:l.jsx(NFe,{})}),l.jsx(Ir,{path:"/venue-owner/credits/purchase",element:l.jsx(jU,{})}),l.jsx(Ir,{path:"/admin/venue-approvals",element:l.jsx(kFe,{})}),l.jsx(Ir,{path:"/auth-test",element:l.jsx(mUe,{})}),l.jsx(Ir,{path:"/email-test",element:l.jsx(xUe,{})}),l.jsx(Ir,{path:"/email-debug",element:l.jsx(bUe,{})}),l.jsx(Ir,{path:"/email-templates",element:l.jsx(RUe,{})}),l.jsx(Ir,{path:"/map-test",element:l.jsx(SUe,{})}),l.jsx(Ir,{path:"/register",element:l.jsx(AUe,{})}),l.jsx(Ir,{path:"*",element:l.jsx(Bre,{to:"/",replace:!0})})]})}),l.jsx(que,{}),l.jsx(Gie,{})]})});uP.createRoot(document.getElementById("root")).render(l.jsx(je.StrictMode,{children:l.jsx(Xre,{children:l.jsx(DUe,{})})}));
//# sourceMappingURL=index-8766cb30.js.map
