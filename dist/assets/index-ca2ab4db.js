function AU(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const o in n)if(o!=="default"&&!(o in e)){const s=Object.getOwnPropertyDescriptor(n,o);s&&Object.defineProperty(e,o,s.get?s:{enumerable:!0,get:()=>n[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const h of s.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();var no=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function _Q(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),r}var kU={exports:{}},WS={},NU={exports:{}},Fr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jb=Symbol.for("react.element"),wQ=Symbol.for("react.portal"),SQ=Symbol.for("react.fragment"),EQ=Symbol.for("react.strict_mode"),TQ=Symbol.for("react.profiler"),jQ=Symbol.for("react.provider"),CQ=Symbol.for("react.context"),PQ=Symbol.for("react.forward_ref"),AQ=Symbol.for("react.suspense"),kQ=Symbol.for("react.memo"),NQ=Symbol.for("react.lazy"),wL=Symbol.iterator;function MQ(e){return e===null||typeof e!="object"?null:(e=wL&&e[wL]||e["@@iterator"],typeof e=="function"?e:null)}var MU={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},IU=Object.assign,OU={};function rg(e,t,r){this.props=e,this.context=t,this.refs=OU,this.updater=r||MU}rg.prototype.isReactComponent={};rg.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};rg.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function DU(){}DU.prototype=rg.prototype;function xN(e,t,r){this.props=e,this.context=t,this.refs=OU,this.updater=r||MU}var bN=xN.prototype=new DU;bN.constructor=xN;IU(bN,rg.prototype);bN.isPureReactComponent=!0;var SL=Array.isArray,RU=Object.prototype.hasOwnProperty,_N={current:null},LU={key:!0,ref:!0,__self:!0,__source:!0};function BU(e,t,r){var n,o={},s=null,h=null;if(t!=null)for(n in t.ref!==void 0&&(h=t.ref),t.key!==void 0&&(s=""+t.key),t)RU.call(t,n)&&!LU.hasOwnProperty(n)&&(o[n]=t[n]);var i=arguments.length-2;if(i===1)o.children=r;else if(1<i){for(var p=Array(i),y=0;y<i;y++)p[y]=arguments[y+2];o.children=p}if(e&&e.defaultProps)for(n in i=e.defaultProps,i)o[n]===void 0&&(o[n]=i[n]);return{$$typeof:jb,type:e,key:s,ref:h,props:o,_owner:_N.current}}function IQ(e,t){return{$$typeof:jb,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function wN(e){return typeof e=="object"&&e!==null&&e.$$typeof===jb}function OQ(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var EL=/\/+/g;function vj(e,t){return typeof e=="object"&&e!==null&&e.key!=null?OQ(""+e.key):t.toString(36)}function jw(e,t,r,n,o){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var h=!1;if(e===null)h=!0;else switch(s){case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case jb:case wQ:h=!0}}if(h)return h=e,o=o(h),e=n===""?"."+vj(h,0):n,SL(o)?(r="",e!=null&&(r=e.replace(EL,"$&/")+"/"),jw(o,t,r,"",function(y){return y})):o!=null&&(wN(o)&&(o=IQ(o,r+(!o.key||h&&h.key===o.key?"":(""+o.key).replace(EL,"$&/")+"/")+e)),t.push(o)),1;if(h=0,n=n===""?".":n+":",SL(e))for(var i=0;i<e.length;i++){s=e[i];var p=n+vj(s,i);h+=jw(s,t,r,p,o)}else if(p=MQ(e),typeof p=="function")for(e=p.call(e),i=0;!(s=e.next()).done;)s=s.value,p=n+vj(s,i++),h+=jw(s,t,r,p,o);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return h}function P_(e,t,r){if(e==null)return e;var n=[],o=0;return jw(e,n,"","",function(s){return t.call(r,s,o++)}),n}function DQ(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Bo={current:null},Cw={transition:null},RQ={ReactCurrentDispatcher:Bo,ReactCurrentBatchConfig:Cw,ReactCurrentOwner:_N};function zU(){throw Error("act(...) is not supported in production builds of React.")}Fr.Children={map:P_,forEach:function(e,t,r){P_(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return P_(e,function(){t++}),t},toArray:function(e){return P_(e,function(t){return t})||[]},only:function(e){if(!wN(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Fr.Component=rg;Fr.Fragment=SQ;Fr.Profiler=TQ;Fr.PureComponent=xN;Fr.StrictMode=EQ;Fr.Suspense=AQ;Fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RQ;Fr.act=zU;Fr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=IU({},e.props),o=e.key,s=e.ref,h=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,h=_N.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(p in t)RU.call(t,p)&&!LU.hasOwnProperty(p)&&(n[p]=t[p]===void 0&&i!==void 0?i[p]:t[p])}var p=arguments.length-2;if(p===1)n.children=r;else if(1<p){i=Array(p);for(var y=0;y<p;y++)i[y]=arguments[y+2];n.children=i}return{$$typeof:jb,type:e.type,key:o,ref:s,props:n,_owner:h}};Fr.createContext=function(e){return e={$$typeof:CQ,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:jQ,_context:e},e.Consumer=e};Fr.createElement=BU;Fr.createFactory=function(e){var t=BU.bind(null,e);return t.type=e,t};Fr.createRef=function(){return{current:null}};Fr.forwardRef=function(e){return{$$typeof:PQ,render:e}};Fr.isValidElement=wN;Fr.lazy=function(e){return{$$typeof:NQ,_payload:{_status:-1,_result:e},_init:DQ}};Fr.memo=function(e,t){return{$$typeof:kQ,type:e,compare:t===void 0?null:t}};Fr.startTransition=function(e){var t=Cw.transition;Cw.transition={};try{e()}finally{Cw.transition=t}};Fr.unstable_act=zU;Fr.useCallback=function(e,t){return Bo.current.useCallback(e,t)};Fr.useContext=function(e){return Bo.current.useContext(e)};Fr.useDebugValue=function(){};Fr.useDeferredValue=function(e){return Bo.current.useDeferredValue(e)};Fr.useEffect=function(e,t){return Bo.current.useEffect(e,t)};Fr.useId=function(){return Bo.current.useId()};Fr.useImperativeHandle=function(e,t,r){return Bo.current.useImperativeHandle(e,t,r)};Fr.useInsertionEffect=function(e,t){return Bo.current.useInsertionEffect(e,t)};Fr.useLayoutEffect=function(e,t){return Bo.current.useLayoutEffect(e,t)};Fr.useMemo=function(e,t){return Bo.current.useMemo(e,t)};Fr.useReducer=function(e,t,r){return Bo.current.useReducer(e,t,r)};Fr.useRef=function(e){return Bo.current.useRef(e)};Fr.useState=function(e){return Bo.current.useState(e)};Fr.useSyncExternalStore=function(e,t,r){return Bo.current.useSyncExternalStore(e,t,r)};Fr.useTransition=function(){return Bo.current.useTransition()};Fr.version="18.3.1";NU.exports=Fr;var D=NU.exports;const je=wn(D),SN=AU({__proto__:null,default:je},[D]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LQ=D,BQ=Symbol.for("react.element"),zQ=Symbol.for("react.fragment"),$Q=Object.prototype.hasOwnProperty,FQ=LQ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,UQ={key:!0,ref:!0,__self:!0,__source:!0};function $U(e,t,r){var n,o={},s=null,h=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(h=t.ref);for(n in t)$Q.call(t,n)&&!UQ.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)o[n]===void 0&&(o[n]=t[n]);return{$$typeof:BQ,type:e,key:s,ref:h,props:o,_owner:FQ.current}}WS.Fragment=zQ;WS.jsx=$U;WS.jsxs=$U;kU.exports=WS;var c=kU.exports,iP={},FU={exports:{}},Na={},UU={exports:{}},VU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ve,Pe){var Re=ve.length;ve.push(Pe);e:for(;0<Re;){var Be=Re-1>>>1,Fe=ve[Be];if(0<o(Fe,Pe))ve[Be]=Pe,ve[Re]=Fe,Re=Be;else break e}}function r(ve){return ve.length===0?null:ve[0]}function n(ve){if(ve.length===0)return null;var Pe=ve[0],Re=ve.pop();if(Re!==Pe){ve[0]=Re;e:for(var Be=0,Fe=ve.length,Ge=Fe>>>1;Be<Ge;){var Pt=2*(Be+1)-1,$t=ve[Pt],nr=Pt+1,Nt=ve[nr];if(0>o($t,Re))nr<Fe&&0>o(Nt,$t)?(ve[Be]=Nt,ve[nr]=Re,Be=nr):(ve[Be]=$t,ve[Pt]=Re,Be=Pt);else if(nr<Fe&&0>o(Nt,Re))ve[Be]=Nt,ve[nr]=Re,Be=nr;else break e}}return Pe}function o(ve,Pe){var Re=ve.sortIndex-Pe.sortIndex;return Re!==0?Re:ve.id-Pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var h=Date,i=h.now();e.unstable_now=function(){return h.now()-i}}var p=[],y=[],b=1,_=null,E=3,C=!1,k=!1,N=!1,I=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(ve){for(var Pe=r(y);Pe!==null;){if(Pe.callback===null)n(y);else if(Pe.startTime<=ve)n(y),Pe.sortIndex=Pe.expirationTime,t(p,Pe);else break;Pe=r(y)}}function q(ve){if(N=!1,R(ve),!k)if(r(p)!==null)k=!0,ce(F);else{var Pe=r(y);Pe!==null&&ke(q,Pe.startTime-ve)}}function F(ve,Pe){k=!1,N&&(N=!1,B(ee),ee=-1),C=!0;var Re=E;try{for(R(Pe),_=r(p);_!==null&&(!(_.expirationTime>Pe)||ve&&!pe());){var Be=_.callback;if(typeof Be=="function"){_.callback=null,E=_.priorityLevel;var Fe=Be(_.expirationTime<=Pe);Pe=e.unstable_now(),typeof Fe=="function"?_.callback=Fe:_===r(p)&&n(p),R(Pe)}else n(p);_=r(p)}if(_!==null)var Ge=!0;else{var Pt=r(y);Pt!==null&&ke(q,Pt.startTime-Pe),Ge=!1}return Ge}finally{_=null,E=Re,C=!1}}var X=!1,G=null,ee=-1,K=5,ie=-1;function pe(){return!(e.unstable_now()-ie<K)}function ae(){if(G!==null){var ve=e.unstable_now();ie=ve;var Pe=!0;try{Pe=G(!0,ve)}finally{Pe?_e():(X=!1,G=null)}}else X=!1}var _e;if(typeof O=="function")_e=function(){O(ae)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,xe=Ee.port2;Ee.port1.onmessage=ae,_e=function(){xe.postMessage(null)}}else _e=function(){I(ae,0)};function ce(ve){G=ve,X||(X=!0,_e())}function ke(ve,Pe){ee=I(function(){ve(e.unstable_now())},Pe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ve){ve.callback=null},e.unstable_continueExecution=function(){k||C||(k=!0,ce(F))},e.unstable_forceFrameRate=function(ve){0>ve||125<ve?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<ve?Math.floor(1e3/ve):5},e.unstable_getCurrentPriorityLevel=function(){return E},e.unstable_getFirstCallbackNode=function(){return r(p)},e.unstable_next=function(ve){switch(E){case 1:case 2:case 3:var Pe=3;break;default:Pe=E}var Re=E;E=Pe;try{return ve()}finally{E=Re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ve,Pe){switch(ve){case 1:case 2:case 3:case 4:case 5:break;default:ve=3}var Re=E;E=ve;try{return Pe()}finally{E=Re}},e.unstable_scheduleCallback=function(ve,Pe,Re){var Be=e.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?Be+Re:Be):Re=Be,ve){case 1:var Fe=-1;break;case 2:Fe=250;break;case 5:Fe=1073741823;break;case 4:Fe=1e4;break;default:Fe=5e3}return Fe=Re+Fe,ve={id:b++,callback:Pe,priorityLevel:ve,startTime:Re,expirationTime:Fe,sortIndex:-1},Re>Be?(ve.sortIndex=Re,t(y,ve),r(p)===null&&ve===r(y)&&(N?(B(ee),ee=-1):N=!0,ke(q,Re-Be))):(ve.sortIndex=Fe,t(p,ve),k||C||(k=!0,ce(F))),ve},e.unstable_shouldYield=pe,e.unstable_wrapCallback=function(ve){var Pe=E;return function(){var Re=E;E=Pe;try{return ve.apply(this,arguments)}finally{E=Re}}}})(VU);UU.exports=VU;var VQ=UU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qQ=D,Pa=VQ;function It(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qU=new Set,gx={};function gf(e,t){vm(e,t),vm(e+"Capture",t)}function vm(e,t){for(gx[e]=t,e=0;e<t.length;e++)qU.add(t[e])}var Cc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),oP=Object.prototype.hasOwnProperty,WQ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,TL={},jL={};function GQ(e){return oP.call(jL,e)?!0:oP.call(TL,e)?!1:WQ.test(e)?jL[e]=!0:(TL[e]=!0,!1)}function HQ(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function XQ(e,t,r,n){if(t===null||typeof t>"u"||HQ(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function zo(e,t,r,n,o,s,h){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=h}var ao={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ao[e]=new zo(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ao[t]=new zo(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ao[e]=new zo(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ao[e]=new zo(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ao[e]=new zo(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ao[e]=new zo(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ao[e]=new zo(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ao[e]=new zo(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ao[e]=new zo(e,5,!1,e.toLowerCase(),null,!1,!1)});var EN=/[\-:]([a-z])/g;function TN(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(EN,TN);ao[t]=new zo(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(EN,TN);ao[t]=new zo(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(EN,TN);ao[t]=new zo(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ao[e]=new zo(e,1,!1,e.toLowerCase(),null,!1,!1)});ao.xlinkHref=new zo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ao[e]=new zo(e,1,!1,e.toLowerCase(),null,!0,!0)});function jN(e,t,r,n){var o=ao.hasOwnProperty(t)?ao[t]:null;(o!==null?o.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(XQ(t,r,o,n)&&(r=null),n||o===null?GQ(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=r===null?o.type===3?!1:"":r:(t=o.attributeName,n=o.attributeNamespace,r===null?e.removeAttribute(t):(o=o.type,r=o===3||o===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Fc=qQ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A_=Symbol.for("react.element"),Fp=Symbol.for("react.portal"),Up=Symbol.for("react.fragment"),CN=Symbol.for("react.strict_mode"),aP=Symbol.for("react.profiler"),WU=Symbol.for("react.provider"),GU=Symbol.for("react.context"),PN=Symbol.for("react.forward_ref"),sP=Symbol.for("react.suspense"),lP=Symbol.for("react.suspense_list"),AN=Symbol.for("react.memo"),Lu=Symbol.for("react.lazy"),HU=Symbol.for("react.offscreen"),CL=Symbol.iterator;function lv(e){return e===null||typeof e!="object"?null:(e=CL&&e[CL]||e["@@iterator"],typeof e=="function"?e:null)}var ai=Object.assign,xj;function Rv(e){if(xj===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);xj=t&&t[1]||""}return`
`+xj+e}var bj=!1;function _j(e,t){if(!e||bj)return"";bj=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(y){var n=y}Reflect.construct(e,[],t)}else{try{t.call()}catch(y){n=y}e.call(t.prototype)}else{try{throw Error()}catch(y){n=y}e()}}catch(y){if(y&&n&&typeof y.stack=="string"){for(var o=y.stack.split(`
`),s=n.stack.split(`
`),h=o.length-1,i=s.length-1;1<=h&&0<=i&&o[h]!==s[i];)i--;for(;1<=h&&0<=i;h--,i--)if(o[h]!==s[i]){if(h!==1||i!==1)do if(h--,i--,0>i||o[h]!==s[i]){var p=`
`+o[h].replace(" at new "," at ");return e.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",e.displayName)),p}while(1<=h&&0<=i);break}}}finally{bj=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Rv(e):""}function ZQ(e){switch(e.tag){case 5:return Rv(e.type);case 16:return Rv("Lazy");case 13:return Rv("Suspense");case 19:return Rv("SuspenseList");case 0:case 2:case 15:return e=_j(e.type,!1),e;case 11:return e=_j(e.type.render,!1),e;case 1:return e=_j(e.type,!0),e;default:return""}}function cP(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Up:return"Fragment";case Fp:return"Portal";case aP:return"Profiler";case CN:return"StrictMode";case sP:return"Suspense";case lP:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case GU:return(e.displayName||"Context")+".Consumer";case WU:return(e._context.displayName||"Context")+".Provider";case PN:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case AN:return t=e.displayName||null,t!==null?t:cP(e.type)||"Memo";case Lu:t=e._payload,e=e._init;try{return cP(e(t))}catch{}}return null}function KQ(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cP(t);case 8:return t===CN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function cd(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function XU(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function YQ(e){var t=XU(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(h){n=""+h,s.call(this,h)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(h){n=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function k_(e){e._valueTracker||(e._valueTracker=YQ(e))}function ZU(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=XU(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Gw(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function uP(e,t){var r=t.checked;return ai({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function PL(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=cd(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function KU(e,t){t=t.checked,t!=null&&jN(e,"checked",t,!1)}function dP(e,t){KU(e,t);var r=cd(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?hP(e,t.type,r):t.hasOwnProperty("defaultValue")&&hP(e,t.type,cd(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function AL(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function hP(e,t,r){(t!=="number"||Gw(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Lv=Array.isArray;function am(e,t,r,n){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&n&&(e[r].defaultSelected=!0)}else{for(r=""+cd(r),t=null,o=0;o<e.length;o++){if(e[o].value===r){e[o].selected=!0,n&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function fP(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(It(91));return ai({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function kL(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(It(92));if(Lv(r)){if(1<r.length)throw Error(It(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:cd(r)}}function YU(e,t){var r=cd(t.value),n=cd(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function NL(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function JU(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pP(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?JU(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var N_,QU=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,o){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(N_=N_||document.createElement("div"),N_.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=N_.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function yx(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Wv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},JQ=["Webkit","ms","Moz","O"];Object.keys(Wv).forEach(function(e){JQ.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Wv[t]=Wv[e]})});function eV(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Wv.hasOwnProperty(e)&&Wv[e]?(""+t).trim():t+"px"}function tV(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,o=eV(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,o):e[r]=o}}var QQ=ai({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mP(e,t){if(t){if(QQ[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(It(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(It(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(It(61))}if(t.style!=null&&typeof t.style!="object")throw Error(It(62))}}function gP(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yP=null;function kN(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vP=null,sm=null,lm=null;function ML(e){if(e=Ab(e)){if(typeof vP!="function")throw Error(It(280));var t=e.stateNode;t&&(t=KS(t),vP(e.stateNode,e.type,t))}}function rV(e){sm?lm?lm.push(e):lm=[e]:sm=e}function nV(){if(sm){var e=sm,t=lm;if(lm=sm=null,ML(e),t)for(e=0;e<t.length;e++)ML(t[e])}}function iV(e,t){return e(t)}function oV(){}var wj=!1;function aV(e,t,r){if(wj)return e(t,r);wj=!0;try{return iV(e,t,r)}finally{wj=!1,(sm!==null||lm!==null)&&(oV(),nV())}}function vx(e,t){var r=e.stateNode;if(r===null)return null;var n=KS(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(It(231,t,typeof r));return r}var xP=!1;if(Cc)try{var cv={};Object.defineProperty(cv,"passive",{get:function(){xP=!0}}),window.addEventListener("test",cv,cv),window.removeEventListener("test",cv,cv)}catch{xP=!1}function eee(e,t,r,n,o,s,h,i,p){var y=Array.prototype.slice.call(arguments,3);try{t.apply(r,y)}catch(b){this.onError(b)}}var Gv=!1,Hw=null,Xw=!1,bP=null,tee={onError:function(e){Gv=!0,Hw=e}};function ree(e,t,r,n,o,s,h,i,p){Gv=!1,Hw=null,eee.apply(tee,arguments)}function nee(e,t,r,n,o,s,h,i,p){if(ree.apply(this,arguments),Gv){if(Gv){var y=Hw;Gv=!1,Hw=null}else throw Error(It(198));Xw||(Xw=!0,bP=y)}}function yf(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function sV(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function IL(e){if(yf(e)!==e)throw Error(It(188))}function iee(e){var t=e.alternate;if(!t){if(t=yf(e),t===null)throw Error(It(188));return t!==e?null:e}for(var r=e,n=t;;){var o=r.return;if(o===null)break;var s=o.alternate;if(s===null){if(n=o.return,n!==null){r=n;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===r)return IL(o),e;if(s===n)return IL(o),t;s=s.sibling}throw Error(It(188))}if(r.return!==n.return)r=o,n=s;else{for(var h=!1,i=o.child;i;){if(i===r){h=!0,r=o,n=s;break}if(i===n){h=!0,n=o,r=s;break}i=i.sibling}if(!h){for(i=s.child;i;){if(i===r){h=!0,r=s,n=o;break}if(i===n){h=!0,n=s,r=o;break}i=i.sibling}if(!h)throw Error(It(189))}}if(r.alternate!==n)throw Error(It(190))}if(r.tag!==3)throw Error(It(188));return r.stateNode.current===r?e:t}function lV(e){return e=iee(e),e!==null?cV(e):null}function cV(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=cV(e);if(t!==null)return t;e=e.sibling}return null}var uV=Pa.unstable_scheduleCallback,OL=Pa.unstable_cancelCallback,oee=Pa.unstable_shouldYield,aee=Pa.unstable_requestPaint,fi=Pa.unstable_now,see=Pa.unstable_getCurrentPriorityLevel,NN=Pa.unstable_ImmediatePriority,dV=Pa.unstable_UserBlockingPriority,Zw=Pa.unstable_NormalPriority,lee=Pa.unstable_LowPriority,hV=Pa.unstable_IdlePriority,GS=null,El=null;function cee(e){if(El&&typeof El.onCommitFiberRoot=="function")try{El.onCommitFiberRoot(GS,e,void 0,(e.current.flags&128)===128)}catch{}}var Gs=Math.clz32?Math.clz32:hee,uee=Math.log,dee=Math.LN2;function hee(e){return e>>>=0,e===0?32:31-(uee(e)/dee|0)|0}var M_=64,I_=4194304;function Bv(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Kw(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,o=e.suspendedLanes,s=e.pingedLanes,h=r&268435455;if(h!==0){var i=h&~o;i!==0?n=Bv(i):(s&=h,s!==0&&(n=Bv(s)))}else h=r&~o,h!==0?n=Bv(h):s!==0&&(n=Bv(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&o)&&(o=n&-n,s=t&-t,o>=s||o===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Gs(t),o=1<<r,n|=e[r],t&=~o;return n}function fee(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pee(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,o=e.expirationTimes,s=e.pendingLanes;0<s;){var h=31-Gs(s),i=1<<h,p=o[h];p===-1?(!(i&r)||i&n)&&(o[h]=fee(i,t)):p<=t&&(e.expiredLanes|=i),s&=~i}}function _P(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function fV(){var e=M_;return M_<<=1,!(M_&4194240)&&(M_=64),e}function Sj(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Cb(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Gs(t),e[t]=r}function mee(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-Gs(r),s=1<<o;t[o]=0,n[o]=-1,e[o]=-1,r&=~s}}function MN(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Gs(r),o=1<<n;o&t|e[n]&t&&(e[n]|=t),r&=~o}}var _n=0;function pV(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var mV,IN,gV,yV,vV,wP=!1,O_=[],Ku=null,Yu=null,Ju=null,xx=new Map,bx=new Map,Uu=[],gee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function DL(e,t){switch(e){case"focusin":case"focusout":Ku=null;break;case"dragenter":case"dragleave":Yu=null;break;case"mouseover":case"mouseout":Ju=null;break;case"pointerover":case"pointerout":xx.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":bx.delete(t.pointerId)}}function uv(e,t,r,n,o,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[o]},t!==null&&(t=Ab(t),t!==null&&IN(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function yee(e,t,r,n,o){switch(t){case"focusin":return Ku=uv(Ku,e,t,r,n,o),!0;case"dragenter":return Yu=uv(Yu,e,t,r,n,o),!0;case"mouseover":return Ju=uv(Ju,e,t,r,n,o),!0;case"pointerover":var s=o.pointerId;return xx.set(s,uv(xx.get(s)||null,e,t,r,n,o)),!0;case"gotpointercapture":return s=o.pointerId,bx.set(s,uv(bx.get(s)||null,e,t,r,n,o)),!0}return!1}function xV(e){var t=Lh(e.target);if(t!==null){var r=yf(t);if(r!==null){if(t=r.tag,t===13){if(t=sV(r),t!==null){e.blockedOn=t,vV(e.priority,function(){gV(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Pw(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=SP(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);yP=n,r.target.dispatchEvent(n),yP=null}else return t=Ab(r),t!==null&&IN(t),e.blockedOn=r,!1;t.shift()}return!0}function RL(e,t,r){Pw(e)&&r.delete(t)}function vee(){wP=!1,Ku!==null&&Pw(Ku)&&(Ku=null),Yu!==null&&Pw(Yu)&&(Yu=null),Ju!==null&&Pw(Ju)&&(Ju=null),xx.forEach(RL),bx.forEach(RL)}function dv(e,t){e.blockedOn===t&&(e.blockedOn=null,wP||(wP=!0,Pa.unstable_scheduleCallback(Pa.unstable_NormalPriority,vee)))}function _x(e){function t(o){return dv(o,e)}if(0<O_.length){dv(O_[0],e);for(var r=1;r<O_.length;r++){var n=O_[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ku!==null&&dv(Ku,e),Yu!==null&&dv(Yu,e),Ju!==null&&dv(Ju,e),xx.forEach(t),bx.forEach(t),r=0;r<Uu.length;r++)n=Uu[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Uu.length&&(r=Uu[0],r.blockedOn===null);)xV(r),r.blockedOn===null&&Uu.shift()}var cm=Fc.ReactCurrentBatchConfig,Yw=!0;function xee(e,t,r,n){var o=_n,s=cm.transition;cm.transition=null;try{_n=1,ON(e,t,r,n)}finally{_n=o,cm.transition=s}}function bee(e,t,r,n){var o=_n,s=cm.transition;cm.transition=null;try{_n=4,ON(e,t,r,n)}finally{_n=o,cm.transition=s}}function ON(e,t,r,n){if(Yw){var o=SP(e,t,r,n);if(o===null)Ij(e,t,n,Jw,r),DL(e,n);else if(yee(o,e,t,r,n))n.stopPropagation();else if(DL(e,n),t&4&&-1<gee.indexOf(e)){for(;o!==null;){var s=Ab(o);if(s!==null&&mV(s),s=SP(e,t,r,n),s===null&&Ij(e,t,n,Jw,r),s===o)break;o=s}o!==null&&n.stopPropagation()}else Ij(e,t,n,null,r)}}var Jw=null;function SP(e,t,r,n){if(Jw=null,e=kN(n),e=Lh(e),e!==null)if(t=yf(e),t===null)e=null;else if(r=t.tag,r===13){if(e=sV(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jw=e,null}function bV(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(see()){case NN:return 1;case dV:return 4;case Zw:case lee:return 16;case hV:return 536870912;default:return 16}default:return 16}}var Gu=null,DN=null,Aw=null;function _V(){if(Aw)return Aw;var e,t=DN,r=t.length,n,o="value"in Gu?Gu.value:Gu.textContent,s=o.length;for(e=0;e<r&&t[e]===o[e];e++);var h=r-e;for(n=1;n<=h&&t[r-n]===o[s-n];n++);return Aw=o.slice(e,1<n?1-n:void 0)}function kw(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function D_(){return!0}function LL(){return!1}function Ma(e){function t(r,n,o,s,h){this._reactName=r,this._targetInst=o,this.type=n,this.nativeEvent=s,this.target=h,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(r=e[i],this[i]=r?r(s):s[i]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?D_:LL,this.isPropagationStopped=LL,this}return ai(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=D_)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=D_)},persist:function(){},isPersistent:D_}),t}var ng={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},RN=Ma(ng),Pb=ai({},ng,{view:0,detail:0}),_ee=Ma(Pb),Ej,Tj,hv,HS=ai({},Pb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:LN,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==hv&&(hv&&e.type==="mousemove"?(Ej=e.screenX-hv.screenX,Tj=e.screenY-hv.screenY):Tj=Ej=0,hv=e),Ej)},movementY:function(e){return"movementY"in e?e.movementY:Tj}}),BL=Ma(HS),wee=ai({},HS,{dataTransfer:0}),See=Ma(wee),Eee=ai({},Pb,{relatedTarget:0}),jj=Ma(Eee),Tee=ai({},ng,{animationName:0,elapsedTime:0,pseudoElement:0}),jee=Ma(Tee),Cee=ai({},ng,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Pee=Ma(Cee),Aee=ai({},ng,{data:0}),zL=Ma(Aee),kee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Iee(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Mee[e])?!!t[e]:!1}function LN(){return Iee}var Oee=ai({},Pb,{key:function(e){if(e.key){var t=kee[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=kw(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nee[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:LN,charCode:function(e){return e.type==="keypress"?kw(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?kw(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Dee=Ma(Oee),Ree=ai({},HS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$L=Ma(Ree),Lee=ai({},Pb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:LN}),Bee=Ma(Lee),zee=ai({},ng,{propertyName:0,elapsedTime:0,pseudoElement:0}),$ee=Ma(zee),Fee=ai({},HS,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Uee=Ma(Fee),Vee=[9,13,27,32],BN=Cc&&"CompositionEvent"in window,Hv=null;Cc&&"documentMode"in document&&(Hv=document.documentMode);var qee=Cc&&"TextEvent"in window&&!Hv,wV=Cc&&(!BN||Hv&&8<Hv&&11>=Hv),FL=String.fromCharCode(32),UL=!1;function SV(e,t){switch(e){case"keyup":return Vee.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function EV(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vp=!1;function Wee(e,t){switch(e){case"compositionend":return EV(t);case"keypress":return t.which!==32?null:(UL=!0,FL);case"textInput":return e=t.data,e===FL&&UL?null:e;default:return null}}function Gee(e,t){if(Vp)return e==="compositionend"||!BN&&SV(e,t)?(e=_V(),Aw=DN=Gu=null,Vp=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return wV&&t.locale!=="ko"?null:t.data;default:return null}}var Hee={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function VL(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Hee[e.type]:t==="textarea"}function TV(e,t,r,n){rV(n),t=Qw(t,"onChange"),0<t.length&&(r=new RN("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Xv=null,wx=null;function Xee(e){RV(e,0)}function XS(e){var t=Gp(e);if(ZU(t))return e}function Zee(e,t){if(e==="change")return t}var jV=!1;if(Cc){var Cj;if(Cc){var Pj="oninput"in document;if(!Pj){var qL=document.createElement("div");qL.setAttribute("oninput","return;"),Pj=typeof qL.oninput=="function"}Cj=Pj}else Cj=!1;jV=Cj&&(!document.documentMode||9<document.documentMode)}function WL(){Xv&&(Xv.detachEvent("onpropertychange",CV),wx=Xv=null)}function CV(e){if(e.propertyName==="value"&&XS(wx)){var t=[];TV(t,wx,e,kN(e)),aV(Xee,t)}}function Kee(e,t,r){e==="focusin"?(WL(),Xv=t,wx=r,Xv.attachEvent("onpropertychange",CV)):e==="focusout"&&WL()}function Yee(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return XS(wx)}function Jee(e,t){if(e==="click")return XS(t)}function Qee(e,t){if(e==="input"||e==="change")return XS(t)}function ete(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zs=typeof Object.is=="function"?Object.is:ete;function Sx(e,t){if(Zs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var o=r[n];if(!oP.call(t,o)||!Zs(e[o],t[o]))return!1}return!0}function GL(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function HL(e,t){var r=GL(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=GL(r)}}function PV(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?PV(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function AV(){for(var e=window,t=Gw();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Gw(e.document)}return t}function zN(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function tte(e){var t=AV(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&PV(r.ownerDocument.documentElement,r)){if(n!==null&&zN(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=r.textContent.length,s=Math.min(n.start,o);n=n.end===void 0?s:Math.min(n.end,o),!e.extend&&s>n&&(o=n,n=s,s=o),o=HL(r,s);var h=HL(r,n);o&&h&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==h.node||e.focusOffset!==h.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(h.node,h.offset)):(t.setEnd(h.node,h.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var rte=Cc&&"documentMode"in document&&11>=document.documentMode,qp=null,EP=null,Zv=null,TP=!1;function XL(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;TP||qp==null||qp!==Gw(n)||(n=qp,"selectionStart"in n&&zN(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Zv&&Sx(Zv,n)||(Zv=n,n=Qw(EP,"onSelect"),0<n.length&&(t=new RN("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=qp)))}function R_(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Wp={animationend:R_("Animation","AnimationEnd"),animationiteration:R_("Animation","AnimationIteration"),animationstart:R_("Animation","AnimationStart"),transitionend:R_("Transition","TransitionEnd")},Aj={},kV={};Cc&&(kV=document.createElement("div").style,"AnimationEvent"in window||(delete Wp.animationend.animation,delete Wp.animationiteration.animation,delete Wp.animationstart.animation),"TransitionEvent"in window||delete Wp.transitionend.transition);function ZS(e){if(Aj[e])return Aj[e];if(!Wp[e])return e;var t=Wp[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in kV)return Aj[e]=t[r];return e}var NV=ZS("animationend"),MV=ZS("animationiteration"),IV=ZS("animationstart"),OV=ZS("transitionend"),DV=new Map,ZL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vd(e,t){DV.set(e,t),gf(t,[e])}for(var kj=0;kj<ZL.length;kj++){var Nj=ZL[kj],nte=Nj.toLowerCase(),ite=Nj[0].toUpperCase()+Nj.slice(1);vd(nte,"on"+ite)}vd(NV,"onAnimationEnd");vd(MV,"onAnimationIteration");vd(IV,"onAnimationStart");vd("dblclick","onDoubleClick");vd("focusin","onFocus");vd("focusout","onBlur");vd(OV,"onTransitionEnd");vm("onMouseEnter",["mouseout","mouseover"]);vm("onMouseLeave",["mouseout","mouseover"]);vm("onPointerEnter",["pointerout","pointerover"]);vm("onPointerLeave",["pointerout","pointerover"]);gf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gf("onBeforeInput",["compositionend","keypress","textInput","paste"]);gf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ote=new Set("cancel close invalid load scroll toggle".split(" ").concat(zv));function KL(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,nee(n,t,void 0,e),e.currentTarget=null}function RV(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],o=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var h=n.length-1;0<=h;h--){var i=n[h],p=i.instance,y=i.currentTarget;if(i=i.listener,p!==s&&o.isPropagationStopped())break e;KL(o,i,y),s=p}else for(h=0;h<n.length;h++){if(i=n[h],p=i.instance,y=i.currentTarget,i=i.listener,p!==s&&o.isPropagationStopped())break e;KL(o,i,y),s=p}}}if(Xw)throw e=bP,Xw=!1,bP=null,e}function Bn(e,t){var r=t[kP];r===void 0&&(r=t[kP]=new Set);var n=e+"__bubble";r.has(n)||(LV(t,e,2,!1),r.add(n))}function Mj(e,t,r){var n=0;t&&(n|=4),LV(r,e,n,t)}var L_="_reactListening"+Math.random().toString(36).slice(2);function Ex(e){if(!e[L_]){e[L_]=!0,qU.forEach(function(r){r!=="selectionchange"&&(ote.has(r)||Mj(r,!1,e),Mj(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[L_]||(t[L_]=!0,Mj("selectionchange",!1,t))}}function LV(e,t,r,n){switch(bV(t)){case 1:var o=xee;break;case 4:o=bee;break;default:o=ON}r=o.bind(null,t,r,e),o=void 0,!xP||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),n?o!==void 0?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):o!==void 0?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function Ij(e,t,r,n,o){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var h=n.tag;if(h===3||h===4){var i=n.stateNode.containerInfo;if(i===o||i.nodeType===8&&i.parentNode===o)break;if(h===4)for(h=n.return;h!==null;){var p=h.tag;if((p===3||p===4)&&(p=h.stateNode.containerInfo,p===o||p.nodeType===8&&p.parentNode===o))return;h=h.return}for(;i!==null;){if(h=Lh(i),h===null)return;if(p=h.tag,p===5||p===6){n=s=h;continue e}i=i.parentNode}}n=n.return}aV(function(){var y=s,b=kN(r),_=[];e:{var E=DV.get(e);if(E!==void 0){var C=RN,k=e;switch(e){case"keypress":if(kw(r)===0)break e;case"keydown":case"keyup":C=Dee;break;case"focusin":k="focus",C=jj;break;case"focusout":k="blur",C=jj;break;case"beforeblur":case"afterblur":C=jj;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=BL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=See;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=Bee;break;case NV:case MV:case IV:C=jee;break;case OV:C=$ee;break;case"scroll":C=_ee;break;case"wheel":C=Uee;break;case"copy":case"cut":case"paste":C=Pee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=$L}var N=(t&4)!==0,I=!N&&e==="scroll",B=N?E!==null?E+"Capture":null:E;N=[];for(var O=y,R;O!==null;){R=O;var q=R.stateNode;if(R.tag===5&&q!==null&&(R=q,B!==null&&(q=vx(O,B),q!=null&&N.push(Tx(O,q,R)))),I)break;O=O.return}0<N.length&&(E=new C(E,k,null,r,b),_.push({event:E,listeners:N}))}}if(!(t&7)){e:{if(E=e==="mouseover"||e==="pointerover",C=e==="mouseout"||e==="pointerout",E&&r!==yP&&(k=r.relatedTarget||r.fromElement)&&(Lh(k)||k[Pc]))break e;if((C||E)&&(E=b.window===b?b:(E=b.ownerDocument)?E.defaultView||E.parentWindow:window,C?(k=r.relatedTarget||r.toElement,C=y,k=k?Lh(k):null,k!==null&&(I=yf(k),k!==I||k.tag!==5&&k.tag!==6)&&(k=null)):(C=null,k=y),C!==k)){if(N=BL,q="onMouseLeave",B="onMouseEnter",O="mouse",(e==="pointerout"||e==="pointerover")&&(N=$L,q="onPointerLeave",B="onPointerEnter",O="pointer"),I=C==null?E:Gp(C),R=k==null?E:Gp(k),E=new N(q,O+"leave",C,r,b),E.target=I,E.relatedTarget=R,q=null,Lh(b)===y&&(N=new N(B,O+"enter",k,r,b),N.target=R,N.relatedTarget=I,q=N),I=q,C&&k)t:{for(N=C,B=k,O=0,R=N;R;R=Cp(R))O++;for(R=0,q=B;q;q=Cp(q))R++;for(;0<O-R;)N=Cp(N),O--;for(;0<R-O;)B=Cp(B),R--;for(;O--;){if(N===B||B!==null&&N===B.alternate)break t;N=Cp(N),B=Cp(B)}N=null}else N=null;C!==null&&YL(_,E,C,N,!1),k!==null&&I!==null&&YL(_,I,k,N,!0)}}e:{if(E=y?Gp(y):window,C=E.nodeName&&E.nodeName.toLowerCase(),C==="select"||C==="input"&&E.type==="file")var F=Zee;else if(VL(E))if(jV)F=Qee;else{F=Yee;var X=Kee}else(C=E.nodeName)&&C.toLowerCase()==="input"&&(E.type==="checkbox"||E.type==="radio")&&(F=Jee);if(F&&(F=F(e,y))){TV(_,F,r,b);break e}X&&X(e,E,y),e==="focusout"&&(X=E._wrapperState)&&X.controlled&&E.type==="number"&&hP(E,"number",E.value)}switch(X=y?Gp(y):window,e){case"focusin":(VL(X)||X.contentEditable==="true")&&(qp=X,EP=y,Zv=null);break;case"focusout":Zv=EP=qp=null;break;case"mousedown":TP=!0;break;case"contextmenu":case"mouseup":case"dragend":TP=!1,XL(_,r,b);break;case"selectionchange":if(rte)break;case"keydown":case"keyup":XL(_,r,b)}var G;if(BN)e:{switch(e){case"compositionstart":var ee="onCompositionStart";break e;case"compositionend":ee="onCompositionEnd";break e;case"compositionupdate":ee="onCompositionUpdate";break e}ee=void 0}else Vp?SV(e,r)&&(ee="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(ee="onCompositionStart");ee&&(wV&&r.locale!=="ko"&&(Vp||ee!=="onCompositionStart"?ee==="onCompositionEnd"&&Vp&&(G=_V()):(Gu=b,DN="value"in Gu?Gu.value:Gu.textContent,Vp=!0)),X=Qw(y,ee),0<X.length&&(ee=new zL(ee,e,null,r,b),_.push({event:ee,listeners:X}),G?ee.data=G:(G=EV(r),G!==null&&(ee.data=G)))),(G=qee?Wee(e,r):Gee(e,r))&&(y=Qw(y,"onBeforeInput"),0<y.length&&(b=new zL("onBeforeInput","beforeinput",null,r,b),_.push({event:b,listeners:y}),b.data=G))}RV(_,t)})}function Tx(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Qw(e,t){for(var r=t+"Capture",n=[];e!==null;){var o=e,s=o.stateNode;o.tag===5&&s!==null&&(o=s,s=vx(e,r),s!=null&&n.unshift(Tx(e,s,o)),s=vx(e,t),s!=null&&n.push(Tx(e,s,o))),e=e.return}return n}function Cp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function YL(e,t,r,n,o){for(var s=t._reactName,h=[];r!==null&&r!==n;){var i=r,p=i.alternate,y=i.stateNode;if(p!==null&&p===n)break;i.tag===5&&y!==null&&(i=y,o?(p=vx(r,s),p!=null&&h.unshift(Tx(r,p,i))):o||(p=vx(r,s),p!=null&&h.push(Tx(r,p,i)))),r=r.return}h.length!==0&&e.push({event:t,listeners:h})}var ate=/\r\n?/g,ste=/\u0000|\uFFFD/g;function JL(e){return(typeof e=="string"?e:""+e).replace(ate,`
`).replace(ste,"")}function B_(e,t,r){if(t=JL(t),JL(e)!==t&&r)throw Error(It(425))}function e1(){}var jP=null,CP=null;function PP(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var AP=typeof setTimeout=="function"?setTimeout:void 0,lte=typeof clearTimeout=="function"?clearTimeout:void 0,QL=typeof Promise=="function"?Promise:void 0,cte=typeof queueMicrotask=="function"?queueMicrotask:typeof QL<"u"?function(e){return QL.resolve(null).then(e).catch(ute)}:AP;function ute(e){setTimeout(function(){throw e})}function Oj(e,t){var r=t,n=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(n===0){e.removeChild(o),_x(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=o}while(r);_x(t)}function Qu(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function e3(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ig=Math.random().toString(36).slice(2),vl="__reactFiber$"+ig,jx="__reactProps$"+ig,Pc="__reactContainer$"+ig,kP="__reactEvents$"+ig,dte="__reactListeners$"+ig,hte="__reactHandles$"+ig;function Lh(e){var t=e[vl];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Pc]||r[vl]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=e3(e);e!==null;){if(r=e[vl])return r;e=e3(e)}return t}e=r,r=e.parentNode}return null}function Ab(e){return e=e[vl]||e[Pc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Gp(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(It(33))}function KS(e){return e[jx]||null}var NP=[],Hp=-1;function xd(e){return{current:e}}function Fn(e){0>Hp||(e.current=NP[Hp],NP[Hp]=null,Hp--)}function On(e,t){Hp++,NP[Hp]=e.current,e.current=t}var ud={},jo=xd(ud),ra=xd(!1),Kh=ud;function xm(e,t){var r=e.type.contextTypes;if(!r)return ud;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o={},s;for(s in r)o[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function na(e){return e=e.childContextTypes,e!=null}function t1(){Fn(ra),Fn(jo)}function t3(e,t,r){if(jo.current!==ud)throw Error(It(168));On(jo,t),On(ra,r)}function BV(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var o in n)if(!(o in t))throw Error(It(108,KQ(e)||"Unknown",o));return ai({},r,n)}function r1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ud,Kh=jo.current,On(jo,e),On(ra,ra.current),!0}function r3(e,t,r){var n=e.stateNode;if(!n)throw Error(It(169));r?(e=BV(e,t,Kh),n.__reactInternalMemoizedMergedChildContext=e,Fn(ra),Fn(jo),On(jo,e)):Fn(ra),On(ra,r)}var uc=null,YS=!1,Dj=!1;function zV(e){uc===null?uc=[e]:uc.push(e)}function fte(e){YS=!0,zV(e)}function bd(){if(!Dj&&uc!==null){Dj=!0;var e=0,t=_n;try{var r=uc;for(_n=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}uc=null,YS=!1}catch(o){throw uc!==null&&(uc=uc.slice(e+1)),uV(NN,bd),o}finally{_n=t,Dj=!1}}return null}var Xp=[],Zp=0,n1=null,i1=0,Za=[],Ka=0,Yh=null,pc=1,mc="";function jh(e,t){Xp[Zp++]=i1,Xp[Zp++]=n1,n1=e,i1=t}function $V(e,t,r){Za[Ka++]=pc,Za[Ka++]=mc,Za[Ka++]=Yh,Yh=e;var n=pc;e=mc;var o=32-Gs(n)-1;n&=~(1<<o),r+=1;var s=32-Gs(t)+o;if(30<s){var h=o-o%5;s=(n&(1<<h)-1).toString(32),n>>=h,o-=h,pc=1<<32-Gs(t)+o|r<<o|n,mc=s+e}else pc=1<<s|r<<o|n,mc=e}function $N(e){e.return!==null&&(jh(e,1),$V(e,1,0))}function FN(e){for(;e===n1;)n1=Xp[--Zp],Xp[Zp]=null,i1=Xp[--Zp],Xp[Zp]=null;for(;e===Yh;)Yh=Za[--Ka],Za[Ka]=null,mc=Za[--Ka],Za[Ka]=null,pc=Za[--Ka],Za[Ka]=null}var Ta=null,Ea=null,Wn=!1,Fs=null;function FV(e,t){var r=Ya(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function n3(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ta=e,Ea=Qu(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ta=e,Ea=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Yh!==null?{id:pc,overflow:mc}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ya(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ta=e,Ea=null,!0):!1;default:return!1}}function MP(e){return(e.mode&1)!==0&&(e.flags&128)===0}function IP(e){if(Wn){var t=Ea;if(t){var r=t;if(!n3(e,t)){if(MP(e))throw Error(It(418));t=Qu(r.nextSibling);var n=Ta;t&&n3(e,t)?FV(n,r):(e.flags=e.flags&-4097|2,Wn=!1,Ta=e)}}else{if(MP(e))throw Error(It(418));e.flags=e.flags&-4097|2,Wn=!1,Ta=e}}}function i3(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ta=e}function z_(e){if(e!==Ta)return!1;if(!Wn)return i3(e),Wn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!PP(e.type,e.memoizedProps)),t&&(t=Ea)){if(MP(e))throw UV(),Error(It(418));for(;t;)FV(e,t),t=Qu(t.nextSibling)}if(i3(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(It(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ea=Qu(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ea=null}}else Ea=Ta?Qu(e.stateNode.nextSibling):null;return!0}function UV(){for(var e=Ea;e;)e=Qu(e.nextSibling)}function bm(){Ea=Ta=null,Wn=!1}function UN(e){Fs===null?Fs=[e]:Fs.push(e)}var pte=Fc.ReactCurrentBatchConfig;function fv(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(It(309));var n=r.stateNode}if(!n)throw Error(It(147,e));var o=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(h){var i=o.refs;h===null?delete i[s]:i[s]=h},t._stringRef=s,t)}if(typeof e!="string")throw Error(It(284));if(!r._owner)throw Error(It(290,e))}return e}function $_(e,t){throw e=Object.prototype.toString.call(t),Error(It(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function o3(e){var t=e._init;return t(e._payload)}function VV(e){function t(B,O){if(e){var R=B.deletions;R===null?(B.deletions=[O],B.flags|=16):R.push(O)}}function r(B,O){if(!e)return null;for(;O!==null;)t(B,O),O=O.sibling;return null}function n(B,O){for(B=new Map;O!==null;)O.key!==null?B.set(O.key,O):B.set(O.index,O),O=O.sibling;return B}function o(B,O){return B=nd(B,O),B.index=0,B.sibling=null,B}function s(B,O,R){return B.index=R,e?(R=B.alternate,R!==null?(R=R.index,R<O?(B.flags|=2,O):R):(B.flags|=2,O)):(B.flags|=1048576,O)}function h(B){return e&&B.alternate===null&&(B.flags|=2),B}function i(B,O,R,q){return O===null||O.tag!==6?(O=Uj(R,B.mode,q),O.return=B,O):(O=o(O,R),O.return=B,O)}function p(B,O,R,q){var F=R.type;return F===Up?b(B,O,R.props.children,q,R.key):O!==null&&(O.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Lu&&o3(F)===O.type)?(q=o(O,R.props),q.ref=fv(B,O,R),q.return=B,q):(q=Lw(R.type,R.key,R.props,null,B.mode,q),q.ref=fv(B,O,R),q.return=B,q)}function y(B,O,R,q){return O===null||O.tag!==4||O.stateNode.containerInfo!==R.containerInfo||O.stateNode.implementation!==R.implementation?(O=Vj(R,B.mode,q),O.return=B,O):(O=o(O,R.children||[]),O.return=B,O)}function b(B,O,R,q,F){return O===null||O.tag!==7?(O=Hh(R,B.mode,q,F),O.return=B,O):(O=o(O,R),O.return=B,O)}function _(B,O,R){if(typeof O=="string"&&O!==""||typeof O=="number")return O=Uj(""+O,B.mode,R),O.return=B,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case A_:return R=Lw(O.type,O.key,O.props,null,B.mode,R),R.ref=fv(B,null,O),R.return=B,R;case Fp:return O=Vj(O,B.mode,R),O.return=B,O;case Lu:var q=O._init;return _(B,q(O._payload),R)}if(Lv(O)||lv(O))return O=Hh(O,B.mode,R,null),O.return=B,O;$_(B,O)}return null}function E(B,O,R,q){var F=O!==null?O.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return F!==null?null:i(B,O,""+R,q);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case A_:return R.key===F?p(B,O,R,q):null;case Fp:return R.key===F?y(B,O,R,q):null;case Lu:return F=R._init,E(B,O,F(R._payload),q)}if(Lv(R)||lv(R))return F!==null?null:b(B,O,R,q,null);$_(B,R)}return null}function C(B,O,R,q,F){if(typeof q=="string"&&q!==""||typeof q=="number")return B=B.get(R)||null,i(O,B,""+q,F);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case A_:return B=B.get(q.key===null?R:q.key)||null,p(O,B,q,F);case Fp:return B=B.get(q.key===null?R:q.key)||null,y(O,B,q,F);case Lu:var X=q._init;return C(B,O,R,X(q._payload),F)}if(Lv(q)||lv(q))return B=B.get(R)||null,b(O,B,q,F,null);$_(O,q)}return null}function k(B,O,R,q){for(var F=null,X=null,G=O,ee=O=0,K=null;G!==null&&ee<R.length;ee++){G.index>ee?(K=G,G=null):K=G.sibling;var ie=E(B,G,R[ee],q);if(ie===null){G===null&&(G=K);break}e&&G&&ie.alternate===null&&t(B,G),O=s(ie,O,ee),X===null?F=ie:X.sibling=ie,X=ie,G=K}if(ee===R.length)return r(B,G),Wn&&jh(B,ee),F;if(G===null){for(;ee<R.length;ee++)G=_(B,R[ee],q),G!==null&&(O=s(G,O,ee),X===null?F=G:X.sibling=G,X=G);return Wn&&jh(B,ee),F}for(G=n(B,G);ee<R.length;ee++)K=C(G,B,ee,R[ee],q),K!==null&&(e&&K.alternate!==null&&G.delete(K.key===null?ee:K.key),O=s(K,O,ee),X===null?F=K:X.sibling=K,X=K);return e&&G.forEach(function(pe){return t(B,pe)}),Wn&&jh(B,ee),F}function N(B,O,R,q){var F=lv(R);if(typeof F!="function")throw Error(It(150));if(R=F.call(R),R==null)throw Error(It(151));for(var X=F=null,G=O,ee=O=0,K=null,ie=R.next();G!==null&&!ie.done;ee++,ie=R.next()){G.index>ee?(K=G,G=null):K=G.sibling;var pe=E(B,G,ie.value,q);if(pe===null){G===null&&(G=K);break}e&&G&&pe.alternate===null&&t(B,G),O=s(pe,O,ee),X===null?F=pe:X.sibling=pe,X=pe,G=K}if(ie.done)return r(B,G),Wn&&jh(B,ee),F;if(G===null){for(;!ie.done;ee++,ie=R.next())ie=_(B,ie.value,q),ie!==null&&(O=s(ie,O,ee),X===null?F=ie:X.sibling=ie,X=ie);return Wn&&jh(B,ee),F}for(G=n(B,G);!ie.done;ee++,ie=R.next())ie=C(G,B,ee,ie.value,q),ie!==null&&(e&&ie.alternate!==null&&G.delete(ie.key===null?ee:ie.key),O=s(ie,O,ee),X===null?F=ie:X.sibling=ie,X=ie);return e&&G.forEach(function(ae){return t(B,ae)}),Wn&&jh(B,ee),F}function I(B,O,R,q){if(typeof R=="object"&&R!==null&&R.type===Up&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case A_:e:{for(var F=R.key,X=O;X!==null;){if(X.key===F){if(F=R.type,F===Up){if(X.tag===7){r(B,X.sibling),O=o(X,R.props.children),O.return=B,B=O;break e}}else if(X.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Lu&&o3(F)===X.type){r(B,X.sibling),O=o(X,R.props),O.ref=fv(B,X,R),O.return=B,B=O;break e}r(B,X);break}else t(B,X);X=X.sibling}R.type===Up?(O=Hh(R.props.children,B.mode,q,R.key),O.return=B,B=O):(q=Lw(R.type,R.key,R.props,null,B.mode,q),q.ref=fv(B,O,R),q.return=B,B=q)}return h(B);case Fp:e:{for(X=R.key;O!==null;){if(O.key===X)if(O.tag===4&&O.stateNode.containerInfo===R.containerInfo&&O.stateNode.implementation===R.implementation){r(B,O.sibling),O=o(O,R.children||[]),O.return=B,B=O;break e}else{r(B,O);break}else t(B,O);O=O.sibling}O=Vj(R,B.mode,q),O.return=B,B=O}return h(B);case Lu:return X=R._init,I(B,O,X(R._payload),q)}if(Lv(R))return k(B,O,R,q);if(lv(R))return N(B,O,R,q);$_(B,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,O!==null&&O.tag===6?(r(B,O.sibling),O=o(O,R),O.return=B,B=O):(r(B,O),O=Uj(R,B.mode,q),O.return=B,B=O),h(B)):r(B,O)}return I}var _m=VV(!0),qV=VV(!1),o1=xd(null),a1=null,Kp=null,VN=null;function qN(){VN=Kp=a1=null}function WN(e){var t=o1.current;Fn(o1),e._currentValue=t}function OP(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function um(e,t){a1=e,VN=Kp=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ea=!0),e.firstContext=null)}function ns(e){var t=e._currentValue;if(VN!==e)if(e={context:e,memoizedValue:t,next:null},Kp===null){if(a1===null)throw Error(It(308));Kp=e,a1.dependencies={lanes:0,firstContext:e}}else Kp=Kp.next=e;return t}var Bh=null;function GN(e){Bh===null?Bh=[e]:Bh.push(e)}function WV(e,t,r,n){var o=t.interleaved;return o===null?(r.next=r,GN(t)):(r.next=o.next,o.next=r),t.interleaved=r,Ac(e,n)}function Ac(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Bu=!1;function HN(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function GV(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function bc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ed(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Yr&2){var o=n.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),n.pending=t,Ac(e,r)}return o=n.interleaved,o===null?(t.next=t,GN(n)):(t.next=o.next,o.next=t),n.interleaved=t,Ac(e,r)}function Nw(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,MN(e,r)}}function a3(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var o=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var h={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?o=s=h:s=s.next=h,r=r.next}while(r!==null);s===null?o=s=t:s=s.next=t}else o=s=t;r={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function s1(e,t,r,n){var o=e.updateQueue;Bu=!1;var s=o.firstBaseUpdate,h=o.lastBaseUpdate,i=o.shared.pending;if(i!==null){o.shared.pending=null;var p=i,y=p.next;p.next=null,h===null?s=y:h.next=y,h=p;var b=e.alternate;b!==null&&(b=b.updateQueue,i=b.lastBaseUpdate,i!==h&&(i===null?b.firstBaseUpdate=y:i.next=y,b.lastBaseUpdate=p))}if(s!==null){var _=o.baseState;h=0,b=y=p=null,i=s;do{var E=i.lane,C=i.eventTime;if((n&E)===E){b!==null&&(b=b.next={eventTime:C,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var k=e,N=i;switch(E=t,C=r,N.tag){case 1:if(k=N.payload,typeof k=="function"){_=k.call(C,_,E);break e}_=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=N.payload,E=typeof k=="function"?k.call(C,_,E):k,E==null)break e;_=ai({},_,E);break e;case 2:Bu=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,E=o.effects,E===null?o.effects=[i]:E.push(i))}else C={eventTime:C,lane:E,tag:i.tag,payload:i.payload,callback:i.callback,next:null},b===null?(y=b=C,p=_):b=b.next=C,h|=E;if(i=i.next,i===null){if(i=o.shared.pending,i===null)break;E=i,i=E.next,E.next=null,o.lastBaseUpdate=E,o.shared.pending=null}}while(1);if(b===null&&(p=_),o.baseState=p,o.firstBaseUpdate=y,o.lastBaseUpdate=b,t=o.shared.interleaved,t!==null){o=t;do h|=o.lane,o=o.next;while(o!==t)}else s===null&&(o.shared.lanes=0);Qh|=h,e.lanes=h,e.memoizedState=_}}function s3(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(o!==null){if(n.callback=null,n=r,typeof o!="function")throw Error(It(191,o));o.call(n)}}}var kb={},Tl=xd(kb),Cx=xd(kb),Px=xd(kb);function zh(e){if(e===kb)throw Error(It(174));return e}function XN(e,t){switch(On(Px,t),On(Cx,e),On(Tl,kb),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pP(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=pP(t,e)}Fn(Tl),On(Tl,t)}function wm(){Fn(Tl),Fn(Cx),Fn(Px)}function HV(e){zh(Px.current);var t=zh(Tl.current),r=pP(t,e.type);t!==r&&(On(Cx,e),On(Tl,r))}function ZN(e){Cx.current===e&&(Fn(Tl),Fn(Cx))}var ni=xd(0);function l1(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Rj=[];function KN(){for(var e=0;e<Rj.length;e++)Rj[e]._workInProgressVersionPrimary=null;Rj.length=0}var Mw=Fc.ReactCurrentDispatcher,Lj=Fc.ReactCurrentBatchConfig,Jh=0,oi=null,Di=null,Xi=null,c1=!1,Kv=!1,Ax=0,mte=0;function vo(){throw Error(It(321))}function YN(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Zs(e[r],t[r]))return!1;return!0}function JN(e,t,r,n,o,s){if(Jh=s,oi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Mw.current=e===null||e.memoizedState===null?xte:bte,e=r(n,o),Kv){s=0;do{if(Kv=!1,Ax=0,25<=s)throw Error(It(301));s+=1,Xi=Di=null,t.updateQueue=null,Mw.current=_te,e=r(n,o)}while(Kv)}if(Mw.current=u1,t=Di!==null&&Di.next!==null,Jh=0,Xi=Di=oi=null,c1=!1,t)throw Error(It(300));return e}function QN(){var e=Ax!==0;return Ax=0,e}function yl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xi===null?oi.memoizedState=Xi=e:Xi=Xi.next=e,Xi}function is(){if(Di===null){var e=oi.alternate;e=e!==null?e.memoizedState:null}else e=Di.next;var t=Xi===null?oi.memoizedState:Xi.next;if(t!==null)Xi=t,Di=e;else{if(e===null)throw Error(It(310));Di=e,e={memoizedState:Di.memoizedState,baseState:Di.baseState,baseQueue:Di.baseQueue,queue:Di.queue,next:null},Xi===null?oi.memoizedState=Xi=e:Xi=Xi.next=e}return Xi}function kx(e,t){return typeof t=="function"?t(e):t}function Bj(e){var t=is(),r=t.queue;if(r===null)throw Error(It(311));r.lastRenderedReducer=e;var n=Di,o=n.baseQueue,s=r.pending;if(s!==null){if(o!==null){var h=o.next;o.next=s.next,s.next=h}n.baseQueue=o=s,r.pending=null}if(o!==null){s=o.next,n=n.baseState;var i=h=null,p=null,y=s;do{var b=y.lane;if((Jh&b)===b)p!==null&&(p=p.next={lane:0,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null}),n=y.hasEagerState?y.eagerState:e(n,y.action);else{var _={lane:b,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null};p===null?(i=p=_,h=n):p=p.next=_,oi.lanes|=b,Qh|=b}y=y.next}while(y!==null&&y!==s);p===null?h=n:p.next=i,Zs(n,t.memoizedState)||(ea=!0),t.memoizedState=n,t.baseState=h,t.baseQueue=p,r.lastRenderedState=n}if(e=r.interleaved,e!==null){o=e;do s=o.lane,oi.lanes|=s,Qh|=s,o=o.next;while(o!==e)}else o===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function zj(e){var t=is(),r=t.queue;if(r===null)throw Error(It(311));r.lastRenderedReducer=e;var n=r.dispatch,o=r.pending,s=t.memoizedState;if(o!==null){r.pending=null;var h=o=o.next;do s=e(s,h.action),h=h.next;while(h!==o);Zs(s,t.memoizedState)||(ea=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function XV(){}function ZV(e,t){var r=oi,n=is(),o=t(),s=!Zs(n.memoizedState,o);if(s&&(n.memoizedState=o,ea=!0),n=n.queue,eM(JV.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Xi!==null&&Xi.memoizedState.tag&1){if(r.flags|=2048,Nx(9,YV.bind(null,r,n,o,t),void 0,null),Zi===null)throw Error(It(349));Jh&30||KV(r,t,o)}return o}function KV(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=oi.updateQueue,t===null?(t={lastEffect:null,stores:null},oi.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function YV(e,t,r,n){t.value=r,t.getSnapshot=n,QV(t)&&e6(e)}function JV(e,t,r){return r(function(){QV(t)&&e6(e)})}function QV(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Zs(e,r)}catch{return!0}}function e6(e){var t=Ac(e,1);t!==null&&Hs(t,e,1,-1)}function l3(e){var t=yl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kx,lastRenderedState:e},t.queue=e,e=e.dispatch=vte.bind(null,oi,e),[t.memoizedState,e]}function Nx(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=oi.updateQueue,t===null?(t={lastEffect:null,stores:null},oi.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function t6(){return is().memoizedState}function Iw(e,t,r,n){var o=yl();oi.flags|=e,o.memoizedState=Nx(1|t,r,void 0,n===void 0?null:n)}function JS(e,t,r,n){var o=is();n=n===void 0?null:n;var s=void 0;if(Di!==null){var h=Di.memoizedState;if(s=h.destroy,n!==null&&YN(n,h.deps)){o.memoizedState=Nx(t,r,s,n);return}}oi.flags|=e,o.memoizedState=Nx(1|t,r,s,n)}function c3(e,t){return Iw(8390656,8,e,t)}function eM(e,t){return JS(2048,8,e,t)}function r6(e,t){return JS(4,2,e,t)}function n6(e,t){return JS(4,4,e,t)}function i6(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function o6(e,t,r){return r=r!=null?r.concat([e]):null,JS(4,4,i6.bind(null,t,e),r)}function tM(){}function a6(e,t){var r=is();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&YN(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function s6(e,t){var r=is();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&YN(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function l6(e,t,r){return Jh&21?(Zs(r,t)||(r=fV(),oi.lanes|=r,Qh|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ea=!0),e.memoizedState=r)}function gte(e,t){var r=_n;_n=r!==0&&4>r?r:4,e(!0);var n=Lj.transition;Lj.transition={};try{e(!1),t()}finally{_n=r,Lj.transition=n}}function c6(){return is().memoizedState}function yte(e,t,r){var n=rd(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},u6(e))d6(t,r);else if(r=WV(e,t,r,n),r!==null){var o=Ro();Hs(r,e,n,o),h6(r,t,n)}}function vte(e,t,r){var n=rd(e),o={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(u6(e))d6(t,o);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var h=t.lastRenderedState,i=s(h,r);if(o.hasEagerState=!0,o.eagerState=i,Zs(i,h)){var p=t.interleaved;p===null?(o.next=o,GN(t)):(o.next=p.next,p.next=o),t.interleaved=o;return}}catch{}finally{}r=WV(e,t,o,n),r!==null&&(o=Ro(),Hs(r,e,n,o),h6(r,t,n))}}function u6(e){var t=e.alternate;return e===oi||t!==null&&t===oi}function d6(e,t){Kv=c1=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function h6(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,MN(e,r)}}var u1={readContext:ns,useCallback:vo,useContext:vo,useEffect:vo,useImperativeHandle:vo,useInsertionEffect:vo,useLayoutEffect:vo,useMemo:vo,useReducer:vo,useRef:vo,useState:vo,useDebugValue:vo,useDeferredValue:vo,useTransition:vo,useMutableSource:vo,useSyncExternalStore:vo,useId:vo,unstable_isNewReconciler:!1},xte={readContext:ns,useCallback:function(e,t){return yl().memoizedState=[e,t===void 0?null:t],e},useContext:ns,useEffect:c3,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Iw(4194308,4,i6.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Iw(4194308,4,e,t)},useInsertionEffect:function(e,t){return Iw(4,2,e,t)},useMemo:function(e,t){var r=yl();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=yl();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=yte.bind(null,oi,e),[n.memoizedState,e]},useRef:function(e){var t=yl();return e={current:e},t.memoizedState=e},useState:l3,useDebugValue:tM,useDeferredValue:function(e){return yl().memoizedState=e},useTransition:function(){var e=l3(!1),t=e[0];return e=gte.bind(null,e[1]),yl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=oi,o=yl();if(Wn){if(r===void 0)throw Error(It(407));r=r()}else{if(r=t(),Zi===null)throw Error(It(349));Jh&30||KV(n,t,r)}o.memoizedState=r;var s={value:r,getSnapshot:t};return o.queue=s,c3(JV.bind(null,n,s,e),[e]),n.flags|=2048,Nx(9,YV.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=yl(),t=Zi.identifierPrefix;if(Wn){var r=mc,n=pc;r=(n&~(1<<32-Gs(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ax++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=mte++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},bte={readContext:ns,useCallback:a6,useContext:ns,useEffect:eM,useImperativeHandle:o6,useInsertionEffect:r6,useLayoutEffect:n6,useMemo:s6,useReducer:Bj,useRef:t6,useState:function(){return Bj(kx)},useDebugValue:tM,useDeferredValue:function(e){var t=is();return l6(t,Di.memoizedState,e)},useTransition:function(){var e=Bj(kx)[0],t=is().memoizedState;return[e,t]},useMutableSource:XV,useSyncExternalStore:ZV,useId:c6,unstable_isNewReconciler:!1},_te={readContext:ns,useCallback:a6,useContext:ns,useEffect:eM,useImperativeHandle:o6,useInsertionEffect:r6,useLayoutEffect:n6,useMemo:s6,useReducer:zj,useRef:t6,useState:function(){return zj(kx)},useDebugValue:tM,useDeferredValue:function(e){var t=is();return Di===null?t.memoizedState=e:l6(t,Di.memoizedState,e)},useTransition:function(){var e=zj(kx)[0],t=is().memoizedState;return[e,t]},useMutableSource:XV,useSyncExternalStore:ZV,useId:c6,unstable_isNewReconciler:!1};function Ds(e,t){if(e&&e.defaultProps){t=ai({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function DP(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ai({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var QS={isMounted:function(e){return(e=e._reactInternals)?yf(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ro(),o=rd(e),s=bc(n,o);s.payload=t,r!=null&&(s.callback=r),t=ed(e,s,o),t!==null&&(Hs(t,e,o,n),Nw(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ro(),o=rd(e),s=bc(n,o);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=ed(e,s,o),t!==null&&(Hs(t,e,o,n),Nw(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ro(),n=rd(e),o=bc(r,n);o.tag=2,t!=null&&(o.callback=t),t=ed(e,o,n),t!==null&&(Hs(t,e,n,r),Nw(t,e,n))}};function u3(e,t,r,n,o,s,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,h):t.prototype&&t.prototype.isPureReactComponent?!Sx(r,n)||!Sx(o,s):!0}function f6(e,t,r){var n=!1,o=ud,s=t.contextType;return typeof s=="object"&&s!==null?s=ns(s):(o=na(t)?Kh:jo.current,n=t.contextTypes,s=(n=n!=null)?xm(e,o):ud),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=QS,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=s),t}function d3(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&QS.enqueueReplaceState(t,t.state,null)}function RP(e,t,r,n){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs={},HN(e);var s=t.contextType;typeof s=="object"&&s!==null?o.context=ns(s):(s=na(t)?Kh:jo.current,o.context=xm(e,s)),o.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(DP(e,t,s,r),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&QS.enqueueReplaceState(o,o.state,null),s1(e,r,o,n),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Sm(e,t){try{var r="",n=t;do r+=ZQ(n),n=n.return;while(n);var o=r}catch(s){o=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:o,digest:null}}function $j(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function LP(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var wte=typeof WeakMap=="function"?WeakMap:Map;function p6(e,t,r){r=bc(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){h1||(h1=!0,HP=n),LP(e,t)},r}function m6(e,t,r){r=bc(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var o=t.value;r.payload=function(){return n(o)},r.callback=function(){LP(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){LP(e,t),typeof n!="function"&&(td===null?td=new Set([this]):td.add(this));var h=t.stack;this.componentDidCatch(t.value,{componentStack:h!==null?h:""})}),r}function h3(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new wte;var o=new Set;n.set(t,o)}else o=n.get(t),o===void 0&&(o=new Set,n.set(t,o));o.has(r)||(o.add(r),e=Rte.bind(null,e,t,r),t.then(e,e))}function f3(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function p3(e,t,r,n,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=bc(-1,1),t.tag=2,ed(r,t,1))),r.lanes|=1),e)}var Ste=Fc.ReactCurrentOwner,ea=!1;function Oo(e,t,r,n){t.child=e===null?qV(t,null,r,n):_m(t,e.child,r,n)}function m3(e,t,r,n,o){r=r.render;var s=t.ref;return um(t,o),n=JN(e,t,r,n,s,o),r=QN(),e!==null&&!ea?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,kc(e,t,o)):(Wn&&r&&$N(t),t.flags|=1,Oo(e,t,n,o),t.child)}function g3(e,t,r,n,o){if(e===null){var s=r.type;return typeof s=="function"&&!cM(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,g6(e,t,s,n,o)):(e=Lw(r.type,null,n,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&o)){var h=s.memoizedProps;if(r=r.compare,r=r!==null?r:Sx,r(h,n)&&e.ref===t.ref)return kc(e,t,o)}return t.flags|=1,e=nd(s,n),e.ref=t.ref,e.return=t,t.child=e}function g6(e,t,r,n,o){if(e!==null){var s=e.memoizedProps;if(Sx(s,n)&&e.ref===t.ref)if(ea=!1,t.pendingProps=n=s,(e.lanes&o)!==0)e.flags&131072&&(ea=!0);else return t.lanes=e.lanes,kc(e,t,o)}return BP(e,t,r,n,o)}function y6(e,t,r){var n=t.pendingProps,o=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},On(Jp,ba),ba|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,On(Jp,ba),ba|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,On(Jp,ba),ba|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,On(Jp,ba),ba|=n;return Oo(e,t,o,r),t.child}function v6(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function BP(e,t,r,n,o){var s=na(r)?Kh:jo.current;return s=xm(t,s),um(t,o),r=JN(e,t,r,n,s,o),n=QN(),e!==null&&!ea?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,kc(e,t,o)):(Wn&&n&&$N(t),t.flags|=1,Oo(e,t,r,o),t.child)}function y3(e,t,r,n,o){if(na(r)){var s=!0;r1(t)}else s=!1;if(um(t,o),t.stateNode===null)Ow(e,t),f6(t,r,n),RP(t,r,n,o),n=!0;else if(e===null){var h=t.stateNode,i=t.memoizedProps;h.props=i;var p=h.context,y=r.contextType;typeof y=="object"&&y!==null?y=ns(y):(y=na(r)?Kh:jo.current,y=xm(t,y));var b=r.getDerivedStateFromProps,_=typeof b=="function"||typeof h.getSnapshotBeforeUpdate=="function";_||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(i!==n||p!==y)&&d3(t,h,n,y),Bu=!1;var E=t.memoizedState;h.state=E,s1(t,n,h,o),p=t.memoizedState,i!==n||E!==p||ra.current||Bu?(typeof b=="function"&&(DP(t,r,b,n),p=t.memoizedState),(i=Bu||u3(t,r,i,n,E,p,y))?(_||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=p),h.props=n,h.state=p,h.context=y,n=i):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{h=t.stateNode,GV(e,t),i=t.memoizedProps,y=t.type===t.elementType?i:Ds(t.type,i),h.props=y,_=t.pendingProps,E=h.context,p=r.contextType,typeof p=="object"&&p!==null?p=ns(p):(p=na(r)?Kh:jo.current,p=xm(t,p));var C=r.getDerivedStateFromProps;(b=typeof C=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(i!==_||E!==p)&&d3(t,h,n,p),Bu=!1,E=t.memoizedState,h.state=E,s1(t,n,h,o);var k=t.memoizedState;i!==_||E!==k||ra.current||Bu?(typeof C=="function"&&(DP(t,r,C,n),k=t.memoizedState),(y=Bu||u3(t,r,y,n,E,k,p)||!1)?(b||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(n,k,p),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(n,k,p)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||i===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=k),h.props=n,h.state=k,h.context=p,n=y):(typeof h.componentDidUpdate!="function"||i===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),n=!1)}return zP(e,t,r,n,s,o)}function zP(e,t,r,n,o,s){v6(e,t);var h=(t.flags&128)!==0;if(!n&&!h)return o&&r3(t,r,!1),kc(e,t,s);n=t.stateNode,Ste.current=t;var i=h&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&h?(t.child=_m(t,e.child,null,s),t.child=_m(t,null,i,s)):Oo(e,t,i,s),t.memoizedState=n.state,o&&r3(t,r,!0),t.child}function x6(e){var t=e.stateNode;t.pendingContext?t3(e,t.pendingContext,t.pendingContext!==t.context):t.context&&t3(e,t.context,!1),XN(e,t.containerInfo)}function v3(e,t,r,n,o){return bm(),UN(o),t.flags|=256,Oo(e,t,r,n),t.child}var $P={dehydrated:null,treeContext:null,retryLane:0};function FP(e){return{baseLanes:e,cachePool:null,transitions:null}}function b6(e,t,r){var n=t.pendingProps,o=ni.current,s=!1,h=(t.flags&128)!==0,i;if((i=h)||(i=e!==null&&e.memoizedState===null?!1:(o&2)!==0),i?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),On(ni,o&1),e===null)return IP(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(h=n.children,e=n.fallback,s?(n=t.mode,s=t.child,h={mode:"hidden",children:h},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=h):s=r2(h,n,0,null),e=Hh(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=FP(r),t.memoizedState=$P,e):rM(t,h));if(o=e.memoizedState,o!==null&&(i=o.dehydrated,i!==null))return Ete(e,t,h,n,i,o,r);if(s){s=n.fallback,h=t.mode,o=e.child,i=o.sibling;var p={mode:"hidden",children:n.children};return!(h&1)&&t.child!==o?(n=t.child,n.childLanes=0,n.pendingProps=p,t.deletions=null):(n=nd(o,p),n.subtreeFlags=o.subtreeFlags&14680064),i!==null?s=nd(i,s):(s=Hh(s,h,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,h=e.child.memoizedState,h=h===null?FP(r):{baseLanes:h.baseLanes|r,cachePool:null,transitions:h.transitions},s.memoizedState=h,s.childLanes=e.childLanes&~r,t.memoizedState=$P,n}return s=e.child,e=s.sibling,n=nd(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function rM(e,t){return t=r2({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function F_(e,t,r,n){return n!==null&&UN(n),_m(t,e.child,null,r),e=rM(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ete(e,t,r,n,o,s,h){if(r)return t.flags&256?(t.flags&=-257,n=$j(Error(It(422))),F_(e,t,h,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,o=t.mode,n=r2({mode:"visible",children:n.children},o,0,null),s=Hh(s,o,h,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&_m(t,e.child,null,h),t.child.memoizedState=FP(h),t.memoizedState=$P,s);if(!(t.mode&1))return F_(e,t,h,null);if(o.data==="$!"){if(n=o.nextSibling&&o.nextSibling.dataset,n)var i=n.dgst;return n=i,s=Error(It(419)),n=$j(s,n,void 0),F_(e,t,h,n)}if(i=(h&e.childLanes)!==0,ea||i){if(n=Zi,n!==null){switch(h&-h){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(n.suspendedLanes|h)?0:o,o!==0&&o!==s.retryLane&&(s.retryLane=o,Ac(e,o),Hs(n,e,o,-1))}return lM(),n=$j(Error(It(421))),F_(e,t,h,n)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=Lte.bind(null,e),o._reactRetry=t,null):(e=s.treeContext,Ea=Qu(o.nextSibling),Ta=t,Wn=!0,Fs=null,e!==null&&(Za[Ka++]=pc,Za[Ka++]=mc,Za[Ka++]=Yh,pc=e.id,mc=e.overflow,Yh=t),t=rM(t,n.children),t.flags|=4096,t)}function x3(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),OP(e.return,t,r)}function Fj(e,t,r,n,o){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=o)}function _6(e,t,r){var n=t.pendingProps,o=n.revealOrder,s=n.tail;if(Oo(e,t,n.children,r),n=ni.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&x3(e,r,t);else if(e.tag===19)x3(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(On(ni,n),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(r=t.child,o=null;r!==null;)e=r.alternate,e!==null&&l1(e)===null&&(o=r),r=r.sibling;r=o,r===null?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),Fj(t,!1,o,r,s);break;case"backwards":for(r=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&l1(e)===null){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}Fj(t,!0,r,null,s);break;case"together":Fj(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ow(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function kc(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Qh|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(It(153));if(t.child!==null){for(e=t.child,r=nd(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=nd(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Tte(e,t,r){switch(t.tag){case 3:x6(t),bm();break;case 5:HV(t);break;case 1:na(t.type)&&r1(t);break;case 4:XN(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,o=t.memoizedProps.value;On(o1,n._currentValue),n._currentValue=o;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(On(ni,ni.current&1),t.flags|=128,null):r&t.child.childLanes?b6(e,t,r):(On(ni,ni.current&1),e=kc(e,t,r),e!==null?e.sibling:null);On(ni,ni.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return _6(e,t,r);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),On(ni,ni.current),n)break;return null;case 22:case 23:return t.lanes=0,y6(e,t,r)}return kc(e,t,r)}var w6,UP,S6,E6;w6=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};UP=function(){};S6=function(e,t,r,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,zh(Tl.current);var s=null;switch(r){case"input":o=uP(e,o),n=uP(e,n),s=[];break;case"select":o=ai({},o,{value:void 0}),n=ai({},n,{value:void 0}),s=[];break;case"textarea":o=fP(e,o),n=fP(e,n),s=[];break;default:typeof o.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=e1)}mP(r,n);var h;r=null;for(y in o)if(!n.hasOwnProperty(y)&&o.hasOwnProperty(y)&&o[y]!=null)if(y==="style"){var i=o[y];for(h in i)i.hasOwnProperty(h)&&(r||(r={}),r[h]="")}else y!=="dangerouslySetInnerHTML"&&y!=="children"&&y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(gx.hasOwnProperty(y)?s||(s=[]):(s=s||[]).push(y,null));for(y in n){var p=n[y];if(i=o!=null?o[y]:void 0,n.hasOwnProperty(y)&&p!==i&&(p!=null||i!=null))if(y==="style")if(i){for(h in i)!i.hasOwnProperty(h)||p&&p.hasOwnProperty(h)||(r||(r={}),r[h]="");for(h in p)p.hasOwnProperty(h)&&i[h]!==p[h]&&(r||(r={}),r[h]=p[h])}else r||(s||(s=[]),s.push(y,r)),r=p;else y==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,i=i?i.__html:void 0,p!=null&&i!==p&&(s=s||[]).push(y,p)):y==="children"?typeof p!="string"&&typeof p!="number"||(s=s||[]).push(y,""+p):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&(gx.hasOwnProperty(y)?(p!=null&&y==="onScroll"&&Bn("scroll",e),s||i===p||(s=[])):(s=s||[]).push(y,p))}r&&(s=s||[]).push("style",r);var y=s;(t.updateQueue=y)&&(t.flags|=4)}};E6=function(e,t,r,n){r!==n&&(t.flags|=4)};function pv(e,t){if(!Wn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function xo(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags&14680064,n|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags,n|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function jte(e,t,r){var n=t.pendingProps;switch(FN(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xo(t),null;case 1:return na(t.type)&&t1(),xo(t),null;case 3:return n=t.stateNode,wm(),Fn(ra),Fn(jo),KN(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(z_(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Fs!==null&&(KP(Fs),Fs=null))),UP(e,t),xo(t),null;case 5:ZN(t);var o=zh(Px.current);if(r=t.type,e!==null&&t.stateNode!=null)S6(e,t,r,n,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(It(166));return xo(t),null}if(e=zh(Tl.current),z_(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[vl]=t,n[jx]=s,e=(t.mode&1)!==0,r){case"dialog":Bn("cancel",n),Bn("close",n);break;case"iframe":case"object":case"embed":Bn("load",n);break;case"video":case"audio":for(o=0;o<zv.length;o++)Bn(zv[o],n);break;case"source":Bn("error",n);break;case"img":case"image":case"link":Bn("error",n),Bn("load",n);break;case"details":Bn("toggle",n);break;case"input":PL(n,s),Bn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Bn("invalid",n);break;case"textarea":kL(n,s),Bn("invalid",n)}mP(r,s),o=null;for(var h in s)if(s.hasOwnProperty(h)){var i=s[h];h==="children"?typeof i=="string"?n.textContent!==i&&(s.suppressHydrationWarning!==!0&&B_(n.textContent,i,e),o=["children",i]):typeof i=="number"&&n.textContent!==""+i&&(s.suppressHydrationWarning!==!0&&B_(n.textContent,i,e),o=["children",""+i]):gx.hasOwnProperty(h)&&i!=null&&h==="onScroll"&&Bn("scroll",n)}switch(r){case"input":k_(n),AL(n,s,!0);break;case"textarea":k_(n),NL(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=e1)}n=o,t.updateQueue=n,n!==null&&(t.flags|=4)}else{h=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=JU(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=h.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=h.createElement(r,{is:n.is}):(e=h.createElement(r),r==="select"&&(h=e,n.multiple?h.multiple=!0:n.size&&(h.size=n.size))):e=h.createElementNS(e,r),e[vl]=t,e[jx]=n,w6(e,t,!1,!1),t.stateNode=e;e:{switch(h=gP(r,n),r){case"dialog":Bn("cancel",e),Bn("close",e),o=n;break;case"iframe":case"object":case"embed":Bn("load",e),o=n;break;case"video":case"audio":for(o=0;o<zv.length;o++)Bn(zv[o],e);o=n;break;case"source":Bn("error",e),o=n;break;case"img":case"image":case"link":Bn("error",e),Bn("load",e),o=n;break;case"details":Bn("toggle",e),o=n;break;case"input":PL(e,n),o=uP(e,n),Bn("invalid",e);break;case"option":o=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=ai({},n,{value:void 0}),Bn("invalid",e);break;case"textarea":kL(e,n),o=fP(e,n),Bn("invalid",e);break;default:o=n}mP(r,o),i=o;for(s in i)if(i.hasOwnProperty(s)){var p=i[s];s==="style"?tV(e,p):s==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&QU(e,p)):s==="children"?typeof p=="string"?(r!=="textarea"||p!=="")&&yx(e,p):typeof p=="number"&&yx(e,""+p):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(gx.hasOwnProperty(s)?p!=null&&s==="onScroll"&&Bn("scroll",e):p!=null&&jN(e,s,p,h))}switch(r){case"input":k_(e),AL(e,n,!1);break;case"textarea":k_(e),NL(e);break;case"option":n.value!=null&&e.setAttribute("value",""+cd(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?am(e,!!n.multiple,s,!1):n.defaultValue!=null&&am(e,!!n.multiple,n.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=e1)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xo(t),null;case 6:if(e&&t.stateNode!=null)E6(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(It(166));if(r=zh(Px.current),zh(Tl.current),z_(t)){if(n=t.stateNode,r=t.memoizedProps,n[vl]=t,(s=n.nodeValue!==r)&&(e=Ta,e!==null))switch(e.tag){case 3:B_(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&B_(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[vl]=t,t.stateNode=n}return xo(t),null;case 13:if(Fn(ni),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Wn&&Ea!==null&&t.mode&1&&!(t.flags&128))UV(),bm(),t.flags|=98560,s=!1;else if(s=z_(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(It(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(It(317));s[vl]=t}else bm(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xo(t),s=!1}else Fs!==null&&(KP(Fs),Fs=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ni.current&1?Ri===0&&(Ri=3):lM())),t.updateQueue!==null&&(t.flags|=4),xo(t),null);case 4:return wm(),UP(e,t),e===null&&Ex(t.stateNode.containerInfo),xo(t),null;case 10:return WN(t.type._context),xo(t),null;case 17:return na(t.type)&&t1(),xo(t),null;case 19:if(Fn(ni),s=t.memoizedState,s===null)return xo(t),null;if(n=(t.flags&128)!==0,h=s.rendering,h===null)if(n)pv(s,!1);else{if(Ri!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(h=l1(e),h!==null){for(t.flags|=128,pv(s,!1),n=h.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,h=s.alternate,h===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=h.childLanes,s.lanes=h.lanes,s.child=h.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=h.memoizedProps,s.memoizedState=h.memoizedState,s.updateQueue=h.updateQueue,s.type=h.type,e=h.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return On(ni,ni.current&1|2),t.child}e=e.sibling}s.tail!==null&&fi()>Em&&(t.flags|=128,n=!0,pv(s,!1),t.lanes=4194304)}else{if(!n)if(e=l1(h),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),pv(s,!0),s.tail===null&&s.tailMode==="hidden"&&!h.alternate&&!Wn)return xo(t),null}else 2*fi()-s.renderingStartTime>Em&&r!==1073741824&&(t.flags|=128,n=!0,pv(s,!1),t.lanes=4194304);s.isBackwards?(h.sibling=t.child,t.child=h):(r=s.last,r!==null?r.sibling=h:t.child=h,s.last=h)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=fi(),t.sibling=null,r=ni.current,On(ni,n?r&1|2:r&1),t):(xo(t),null);case 22:case 23:return sM(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ba&1073741824&&(xo(t),t.subtreeFlags&6&&(t.flags|=8192)):xo(t),null;case 24:return null;case 25:return null}throw Error(It(156,t.tag))}function Cte(e,t){switch(FN(t),t.tag){case 1:return na(t.type)&&t1(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return wm(),Fn(ra),Fn(jo),KN(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ZN(t),null;case 13:if(Fn(ni),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(It(340));bm()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Fn(ni),null;case 4:return wm(),null;case 10:return WN(t.type._context),null;case 22:case 23:return sM(),null;case 24:return null;default:return null}}var U_=!1,wo=!1,Pte=typeof WeakSet=="function"?WeakSet:Set,Qt=null;function Yp(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ui(e,t,n)}else r.current=null}function VP(e,t,r){try{r()}catch(n){ui(e,t,n)}}var b3=!1;function Ate(e,t){if(jP=Yw,e=AV(),zN(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var o=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var h=0,i=-1,p=-1,y=0,b=0,_=e,E=null;t:for(;;){for(var C;_!==r||o!==0&&_.nodeType!==3||(i=h+o),_!==s||n!==0&&_.nodeType!==3||(p=h+n),_.nodeType===3&&(h+=_.nodeValue.length),(C=_.firstChild)!==null;)E=_,_=C;for(;;){if(_===e)break t;if(E===r&&++y===o&&(i=h),E===s&&++b===n&&(p=h),(C=_.nextSibling)!==null)break;_=E,E=_.parentNode}_=C}r=i===-1||p===-1?null:{start:i,end:p}}else r=null}r=r||{start:0,end:0}}else r=null;for(CP={focusedElem:e,selectionRange:r},Yw=!1,Qt=t;Qt!==null;)if(t=Qt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Qt=e;else for(;Qt!==null;){t=Qt;try{var k=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var N=k.memoizedProps,I=k.memoizedState,B=t.stateNode,O=B.getSnapshotBeforeUpdate(t.elementType===t.type?N:Ds(t.type,N),I);B.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var R=t.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(It(163))}}catch(q){ui(t,t.return,q)}if(e=t.sibling,e!==null){e.return=t.return,Qt=e;break}Qt=t.return}return k=b3,b3=!1,k}function Yv(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&e)===e){var s=o.destroy;o.destroy=void 0,s!==void 0&&VP(t,r,s)}o=o.next}while(o!==n)}}function e2(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function qP(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function T6(e){var t=e.alternate;t!==null&&(e.alternate=null,T6(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[vl],delete t[jx],delete t[kP],delete t[dte],delete t[hte])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function j6(e){return e.tag===5||e.tag===3||e.tag===4}function _3(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||j6(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function WP(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=e1));else if(n!==4&&(e=e.child,e!==null))for(WP(e,t,r),e=e.sibling;e!==null;)WP(e,t,r),e=e.sibling}function GP(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(GP(e,t,r),e=e.sibling;e!==null;)GP(e,t,r),e=e.sibling}var eo=null,Rs=!1;function Cu(e,t,r){for(r=r.child;r!==null;)C6(e,t,r),r=r.sibling}function C6(e,t,r){if(El&&typeof El.onCommitFiberUnmount=="function")try{El.onCommitFiberUnmount(GS,r)}catch{}switch(r.tag){case 5:wo||Yp(r,t);case 6:var n=eo,o=Rs;eo=null,Cu(e,t,r),eo=n,Rs=o,eo!==null&&(Rs?(e=eo,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):eo.removeChild(r.stateNode));break;case 18:eo!==null&&(Rs?(e=eo,r=r.stateNode,e.nodeType===8?Oj(e.parentNode,r):e.nodeType===1&&Oj(e,r),_x(e)):Oj(eo,r.stateNode));break;case 4:n=eo,o=Rs,eo=r.stateNode.containerInfo,Rs=!0,Cu(e,t,r),eo=n,Rs=o;break;case 0:case 11:case 14:case 15:if(!wo&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){o=n=n.next;do{var s=o,h=s.destroy;s=s.tag,h!==void 0&&(s&2||s&4)&&VP(r,t,h),o=o.next}while(o!==n)}Cu(e,t,r);break;case 1:if(!wo&&(Yp(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(i){ui(r,t,i)}Cu(e,t,r);break;case 21:Cu(e,t,r);break;case 22:r.mode&1?(wo=(n=wo)||r.memoizedState!==null,Cu(e,t,r),wo=n):Cu(e,t,r);break;default:Cu(e,t,r)}}function w3(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Pte),t.forEach(function(n){var o=Bte.bind(null,e,n);r.has(n)||(r.add(n),n.then(o,o))})}}function ks(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var o=r[n];try{var s=e,h=t,i=h;e:for(;i!==null;){switch(i.tag){case 5:eo=i.stateNode,Rs=!1;break e;case 3:eo=i.stateNode.containerInfo,Rs=!0;break e;case 4:eo=i.stateNode.containerInfo,Rs=!0;break e}i=i.return}if(eo===null)throw Error(It(160));C6(s,h,o),eo=null,Rs=!1;var p=o.alternate;p!==null&&(p.return=null),o.return=null}catch(y){ui(o,t,y)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)P6(t,e),t=t.sibling}function P6(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ks(t,e),gl(e),n&4){try{Yv(3,e,e.return),e2(3,e)}catch(N){ui(e,e.return,N)}try{Yv(5,e,e.return)}catch(N){ui(e,e.return,N)}}break;case 1:ks(t,e),gl(e),n&512&&r!==null&&Yp(r,r.return);break;case 5:if(ks(t,e),gl(e),n&512&&r!==null&&Yp(r,r.return),e.flags&32){var o=e.stateNode;try{yx(o,"")}catch(N){ui(e,e.return,N)}}if(n&4&&(o=e.stateNode,o!=null)){var s=e.memoizedProps,h=r!==null?r.memoizedProps:s,i=e.type,p=e.updateQueue;if(e.updateQueue=null,p!==null)try{i==="input"&&s.type==="radio"&&s.name!=null&&KU(o,s),gP(i,h);var y=gP(i,s);for(h=0;h<p.length;h+=2){var b=p[h],_=p[h+1];b==="style"?tV(o,_):b==="dangerouslySetInnerHTML"?QU(o,_):b==="children"?yx(o,_):jN(o,b,_,y)}switch(i){case"input":dP(o,s);break;case"textarea":YU(o,s);break;case"select":var E=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!s.multiple;var C=s.value;C!=null?am(o,!!s.multiple,C,!1):E!==!!s.multiple&&(s.defaultValue!=null?am(o,!!s.multiple,s.defaultValue,!0):am(o,!!s.multiple,s.multiple?[]:"",!1))}o[jx]=s}catch(N){ui(e,e.return,N)}}break;case 6:if(ks(t,e),gl(e),n&4){if(e.stateNode===null)throw Error(It(162));o=e.stateNode,s=e.memoizedProps;try{o.nodeValue=s}catch(N){ui(e,e.return,N)}}break;case 3:if(ks(t,e),gl(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{_x(t.containerInfo)}catch(N){ui(e,e.return,N)}break;case 4:ks(t,e),gl(e);break;case 13:ks(t,e),gl(e),o=e.child,o.flags&8192&&(s=o.memoizedState!==null,o.stateNode.isHidden=s,!s||o.alternate!==null&&o.alternate.memoizedState!==null||(oM=fi())),n&4&&w3(e);break;case 22:if(b=r!==null&&r.memoizedState!==null,e.mode&1?(wo=(y=wo)||b,ks(t,e),wo=y):ks(t,e),gl(e),n&8192){if(y=e.memoizedState!==null,(e.stateNode.isHidden=y)&&!b&&e.mode&1)for(Qt=e,b=e.child;b!==null;){for(_=Qt=b;Qt!==null;){switch(E=Qt,C=E.child,E.tag){case 0:case 11:case 14:case 15:Yv(4,E,E.return);break;case 1:Yp(E,E.return);var k=E.stateNode;if(typeof k.componentWillUnmount=="function"){n=E,r=E.return;try{t=n,k.props=t.memoizedProps,k.state=t.memoizedState,k.componentWillUnmount()}catch(N){ui(n,r,N)}}break;case 5:Yp(E,E.return);break;case 22:if(E.memoizedState!==null){E3(_);continue}}C!==null?(C.return=E,Qt=C):E3(_)}b=b.sibling}e:for(b=null,_=e;;){if(_.tag===5){if(b===null){b=_;try{o=_.stateNode,y?(s=o.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(i=_.stateNode,p=_.memoizedProps.style,h=p!=null&&p.hasOwnProperty("display")?p.display:null,i.style.display=eV("display",h))}catch(N){ui(e,e.return,N)}}}else if(_.tag===6){if(b===null)try{_.stateNode.nodeValue=y?"":_.memoizedProps}catch(N){ui(e,e.return,N)}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===e)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===e)break e;for(;_.sibling===null;){if(_.return===null||_.return===e)break e;b===_&&(b=null),_=_.return}b===_&&(b=null),_.sibling.return=_.return,_=_.sibling}}break;case 19:ks(t,e),gl(e),n&4&&w3(e);break;case 21:break;default:ks(t,e),gl(e)}}function gl(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(j6(r)){var n=r;break e}r=r.return}throw Error(It(160))}switch(n.tag){case 5:var o=n.stateNode;n.flags&32&&(yx(o,""),n.flags&=-33);var s=_3(e);GP(e,s,o);break;case 3:case 4:var h=n.stateNode.containerInfo,i=_3(e);WP(e,i,h);break;default:throw Error(It(161))}}catch(p){ui(e,e.return,p)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function kte(e,t,r){Qt=e,A6(e)}function A6(e,t,r){for(var n=(e.mode&1)!==0;Qt!==null;){var o=Qt,s=o.child;if(o.tag===22&&n){var h=o.memoizedState!==null||U_;if(!h){var i=o.alternate,p=i!==null&&i.memoizedState!==null||wo;i=U_;var y=wo;if(U_=h,(wo=p)&&!y)for(Qt=o;Qt!==null;)h=Qt,p=h.child,h.tag===22&&h.memoizedState!==null?T3(o):p!==null?(p.return=h,Qt=p):T3(o);for(;s!==null;)Qt=s,A6(s),s=s.sibling;Qt=o,U_=i,wo=y}S3(e)}else o.subtreeFlags&8772&&s!==null?(s.return=o,Qt=s):S3(e)}}function S3(e){for(;Qt!==null;){var t=Qt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:wo||e2(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!wo)if(r===null)n.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:Ds(t.type,r.memoizedProps);n.componentDidUpdate(o,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&s3(t,s,n);break;case 3:var h=t.updateQueue;if(h!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}s3(t,h,r)}break;case 5:var i=t.stateNode;if(r===null&&t.flags&4){r=i;var p=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&r.focus();break;case"img":p.src&&(r.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var y=t.alternate;if(y!==null){var b=y.memoizedState;if(b!==null){var _=b.dehydrated;_!==null&&_x(_)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(It(163))}wo||t.flags&512&&qP(t)}catch(E){ui(t,t.return,E)}}if(t===e){Qt=null;break}if(r=t.sibling,r!==null){r.return=t.return,Qt=r;break}Qt=t.return}}function E3(e){for(;Qt!==null;){var t=Qt;if(t===e){Qt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Qt=r;break}Qt=t.return}}function T3(e){for(;Qt!==null;){var t=Qt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{e2(4,t)}catch(p){ui(t,r,p)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var o=t.return;try{n.componentDidMount()}catch(p){ui(t,o,p)}}var s=t.return;try{qP(t)}catch(p){ui(t,s,p)}break;case 5:var h=t.return;try{qP(t)}catch(p){ui(t,h,p)}}}catch(p){ui(t,t.return,p)}if(t===e){Qt=null;break}var i=t.sibling;if(i!==null){i.return=t.return,Qt=i;break}Qt=t.return}}var Nte=Math.ceil,d1=Fc.ReactCurrentDispatcher,nM=Fc.ReactCurrentOwner,Qa=Fc.ReactCurrentBatchConfig,Yr=0,Zi=null,Ti=null,oo=0,ba=0,Jp=xd(0),Ri=0,Mx=null,Qh=0,t2=0,iM=0,Jv=null,Jo=null,oM=0,Em=1/0,lc=null,h1=!1,HP=null,td=null,V_=!1,Hu=null,f1=0,Qv=0,XP=null,Dw=-1,Rw=0;function Ro(){return Yr&6?fi():Dw!==-1?Dw:Dw=fi()}function rd(e){return e.mode&1?Yr&2&&oo!==0?oo&-oo:pte.transition!==null?(Rw===0&&(Rw=fV()),Rw):(e=_n,e!==0||(e=window.event,e=e===void 0?16:bV(e.type)),e):1}function Hs(e,t,r,n){if(50<Qv)throw Qv=0,XP=null,Error(It(185));Cb(e,r,n),(!(Yr&2)||e!==Zi)&&(e===Zi&&(!(Yr&2)&&(t2|=r),Ri===4&&Vu(e,oo)),ia(e,n),r===1&&Yr===0&&!(t.mode&1)&&(Em=fi()+500,YS&&bd()))}function ia(e,t){var r=e.callbackNode;pee(e,t);var n=Kw(e,e===Zi?oo:0);if(n===0)r!==null&&OL(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&OL(r),t===1)e.tag===0?fte(j3.bind(null,e)):zV(j3.bind(null,e)),cte(function(){!(Yr&6)&&bd()}),r=null;else{switch(pV(n)){case 1:r=NN;break;case 4:r=dV;break;case 16:r=Zw;break;case 536870912:r=hV;break;default:r=Zw}r=L6(r,k6.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function k6(e,t){if(Dw=-1,Rw=0,Yr&6)throw Error(It(327));var r=e.callbackNode;if(dm()&&e.callbackNode!==r)return null;var n=Kw(e,e===Zi?oo:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=p1(e,n);else{t=n;var o=Yr;Yr|=2;var s=M6();(Zi!==e||oo!==t)&&(lc=null,Em=fi()+500,Gh(e,t));do try{Ote();break}catch(i){N6(e,i)}while(1);qN(),d1.current=s,Yr=o,Ti!==null?t=0:(Zi=null,oo=0,t=Ri)}if(t!==0){if(t===2&&(o=_P(e),o!==0&&(n=o,t=ZP(e,o))),t===1)throw r=Mx,Gh(e,0),Vu(e,n),ia(e,fi()),r;if(t===6)Vu(e,n);else{if(o=e.current.alternate,!(n&30)&&!Mte(o)&&(t=p1(e,n),t===2&&(s=_P(e),s!==0&&(n=s,t=ZP(e,s))),t===1))throw r=Mx,Gh(e,0),Vu(e,n),ia(e,fi()),r;switch(e.finishedWork=o,e.finishedLanes=n,t){case 0:case 1:throw Error(It(345));case 2:Ch(e,Jo,lc);break;case 3:if(Vu(e,n),(n&130023424)===n&&(t=oM+500-fi(),10<t)){if(Kw(e,0)!==0)break;if(o=e.suspendedLanes,(o&n)!==n){Ro(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=AP(Ch.bind(null,e,Jo,lc),t);break}Ch(e,Jo,lc);break;case 4:if(Vu(e,n),(n&4194240)===n)break;for(t=e.eventTimes,o=-1;0<n;){var h=31-Gs(n);s=1<<h,h=t[h],h>o&&(o=h),n&=~s}if(n=o,n=fi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Nte(n/1960))-n,10<n){e.timeoutHandle=AP(Ch.bind(null,e,Jo,lc),n);break}Ch(e,Jo,lc);break;case 5:Ch(e,Jo,lc);break;default:throw Error(It(329))}}}return ia(e,fi()),e.callbackNode===r?k6.bind(null,e):null}function ZP(e,t){var r=Jv;return e.current.memoizedState.isDehydrated&&(Gh(e,t).flags|=256),e=p1(e,t),e!==2&&(t=Jo,Jo=r,t!==null&&KP(t)),e}function KP(e){Jo===null?Jo=e:Jo.push.apply(Jo,e)}function Mte(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var o=r[n],s=o.getSnapshot;o=o.value;try{if(!Zs(s(),o))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Vu(e,t){for(t&=~iM,t&=~t2,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Gs(t),n=1<<r;e[r]=-1,t&=~n}}function j3(e){if(Yr&6)throw Error(It(327));dm();var t=Kw(e,0);if(!(t&1))return ia(e,fi()),null;var r=p1(e,t);if(e.tag!==0&&r===2){var n=_P(e);n!==0&&(t=n,r=ZP(e,n))}if(r===1)throw r=Mx,Gh(e,0),Vu(e,t),ia(e,fi()),r;if(r===6)throw Error(It(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ch(e,Jo,lc),ia(e,fi()),null}function aM(e,t){var r=Yr;Yr|=1;try{return e(t)}finally{Yr=r,Yr===0&&(Em=fi()+500,YS&&bd())}}function ef(e){Hu!==null&&Hu.tag===0&&!(Yr&6)&&dm();var t=Yr;Yr|=1;var r=Qa.transition,n=_n;try{if(Qa.transition=null,_n=1,e)return e()}finally{_n=n,Qa.transition=r,Yr=t,!(Yr&6)&&bd()}}function sM(){ba=Jp.current,Fn(Jp)}function Gh(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,lte(r)),Ti!==null)for(r=Ti.return;r!==null;){var n=r;switch(FN(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&t1();break;case 3:wm(),Fn(ra),Fn(jo),KN();break;case 5:ZN(n);break;case 4:wm();break;case 13:Fn(ni);break;case 19:Fn(ni);break;case 10:WN(n.type._context);break;case 22:case 23:sM()}r=r.return}if(Zi=e,Ti=e=nd(e.current,null),oo=ba=t,Ri=0,Mx=null,iM=t2=Qh=0,Jo=Jv=null,Bh!==null){for(t=0;t<Bh.length;t++)if(r=Bh[t],n=r.interleaved,n!==null){r.interleaved=null;var o=n.next,s=r.pending;if(s!==null){var h=s.next;s.next=o,n.next=h}r.pending=n}Bh=null}return e}function N6(e,t){do{var r=Ti;try{if(qN(),Mw.current=u1,c1){for(var n=oi.memoizedState;n!==null;){var o=n.queue;o!==null&&(o.pending=null),n=n.next}c1=!1}if(Jh=0,Xi=Di=oi=null,Kv=!1,Ax=0,nM.current=null,r===null||r.return===null){Ri=1,Mx=t,Ti=null;break}e:{var s=e,h=r.return,i=r,p=t;if(t=oo,i.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var y=p,b=i,_=b.tag;if(!(b.mode&1)&&(_===0||_===11||_===15)){var E=b.alternate;E?(b.updateQueue=E.updateQueue,b.memoizedState=E.memoizedState,b.lanes=E.lanes):(b.updateQueue=null,b.memoizedState=null)}var C=f3(h);if(C!==null){C.flags&=-257,p3(C,h,i,s,t),C.mode&1&&h3(s,y,t),t=C,p=y;var k=t.updateQueue;if(k===null){var N=new Set;N.add(p),t.updateQueue=N}else k.add(p);break e}else{if(!(t&1)){h3(s,y,t),lM();break e}p=Error(It(426))}}else if(Wn&&i.mode&1){var I=f3(h);if(I!==null){!(I.flags&65536)&&(I.flags|=256),p3(I,h,i,s,t),UN(Sm(p,i));break e}}s=p=Sm(p,i),Ri!==4&&(Ri=2),Jv===null?Jv=[s]:Jv.push(s),s=h;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var B=p6(s,p,t);a3(s,B);break e;case 1:i=p;var O=s.type,R=s.stateNode;if(!(s.flags&128)&&(typeof O.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(td===null||!td.has(R)))){s.flags|=65536,t&=-t,s.lanes|=t;var q=m6(s,i,t);a3(s,q);break e}}s=s.return}while(s!==null)}O6(r)}catch(F){t=F,Ti===r&&r!==null&&(Ti=r=r.return);continue}break}while(1)}function M6(){var e=d1.current;return d1.current=u1,e===null?u1:e}function lM(){(Ri===0||Ri===3||Ri===2)&&(Ri=4),Zi===null||!(Qh&268435455)&&!(t2&268435455)||Vu(Zi,oo)}function p1(e,t){var r=Yr;Yr|=2;var n=M6();(Zi!==e||oo!==t)&&(lc=null,Gh(e,t));do try{Ite();break}catch(o){N6(e,o)}while(1);if(qN(),Yr=r,d1.current=n,Ti!==null)throw Error(It(261));return Zi=null,oo=0,Ri}function Ite(){for(;Ti!==null;)I6(Ti)}function Ote(){for(;Ti!==null&&!oee();)I6(Ti)}function I6(e){var t=R6(e.alternate,e,ba);e.memoizedProps=e.pendingProps,t===null?O6(e):Ti=t,nM.current=null}function O6(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Cte(r,t),r!==null){r.flags&=32767,Ti=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ri=6,Ti=null;return}}else if(r=jte(r,t,ba),r!==null){Ti=r;return}if(t=t.sibling,t!==null){Ti=t;return}Ti=t=e}while(t!==null);Ri===0&&(Ri=5)}function Ch(e,t,r){var n=_n,o=Qa.transition;try{Qa.transition=null,_n=1,Dte(e,t,r,n)}finally{Qa.transition=o,_n=n}return null}function Dte(e,t,r,n){do dm();while(Hu!==null);if(Yr&6)throw Error(It(327));r=e.finishedWork;var o=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(It(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(mee(e,s),e===Zi&&(Ti=Zi=null,oo=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||V_||(V_=!0,L6(Zw,function(){return dm(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Qa.transition,Qa.transition=null;var h=_n;_n=1;var i=Yr;Yr|=4,nM.current=null,Ate(e,r),P6(r,e),tte(CP),Yw=!!jP,CP=jP=null,e.current=r,kte(r),aee(),Yr=i,_n=h,Qa.transition=s}else e.current=r;if(V_&&(V_=!1,Hu=e,f1=o),s=e.pendingLanes,s===0&&(td=null),cee(r.stateNode),ia(e,fi()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)o=t[r],n(o.value,{componentStack:o.stack,digest:o.digest});if(h1)throw h1=!1,e=HP,HP=null,e;return f1&1&&e.tag!==0&&dm(),s=e.pendingLanes,s&1?e===XP?Qv++:(Qv=0,XP=e):Qv=0,bd(),null}function dm(){if(Hu!==null){var e=pV(f1),t=Qa.transition,r=_n;try{if(Qa.transition=null,_n=16>e?16:e,Hu===null)var n=!1;else{if(e=Hu,Hu=null,f1=0,Yr&6)throw Error(It(331));var o=Yr;for(Yr|=4,Qt=e.current;Qt!==null;){var s=Qt,h=s.child;if(Qt.flags&16){var i=s.deletions;if(i!==null){for(var p=0;p<i.length;p++){var y=i[p];for(Qt=y;Qt!==null;){var b=Qt;switch(b.tag){case 0:case 11:case 15:Yv(8,b,s)}var _=b.child;if(_!==null)_.return=b,Qt=_;else for(;Qt!==null;){b=Qt;var E=b.sibling,C=b.return;if(T6(b),b===y){Qt=null;break}if(E!==null){E.return=C,Qt=E;break}Qt=C}}}var k=s.alternate;if(k!==null){var N=k.child;if(N!==null){k.child=null;do{var I=N.sibling;N.sibling=null,N=I}while(N!==null)}}Qt=s}}if(s.subtreeFlags&2064&&h!==null)h.return=s,Qt=h;else e:for(;Qt!==null;){if(s=Qt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Yv(9,s,s.return)}var B=s.sibling;if(B!==null){B.return=s.return,Qt=B;break e}Qt=s.return}}var O=e.current;for(Qt=O;Qt!==null;){h=Qt;var R=h.child;if(h.subtreeFlags&2064&&R!==null)R.return=h,Qt=R;else e:for(h=O;Qt!==null;){if(i=Qt,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:e2(9,i)}}catch(F){ui(i,i.return,F)}if(i===h){Qt=null;break e}var q=i.sibling;if(q!==null){q.return=i.return,Qt=q;break e}Qt=i.return}}if(Yr=o,bd(),El&&typeof El.onPostCommitFiberRoot=="function")try{El.onPostCommitFiberRoot(GS,e)}catch{}n=!0}return n}finally{_n=r,Qa.transition=t}}return!1}function C3(e,t,r){t=Sm(r,t),t=p6(e,t,1),e=ed(e,t,1),t=Ro(),e!==null&&(Cb(e,1,t),ia(e,t))}function ui(e,t,r){if(e.tag===3)C3(e,e,r);else for(;t!==null;){if(t.tag===3){C3(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(td===null||!td.has(n))){e=Sm(r,e),e=m6(t,e,1),t=ed(t,e,1),e=Ro(),t!==null&&(Cb(t,1,e),ia(t,e));break}}t=t.return}}function Rte(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ro(),e.pingedLanes|=e.suspendedLanes&r,Zi===e&&(oo&r)===r&&(Ri===4||Ri===3&&(oo&130023424)===oo&&500>fi()-oM?Gh(e,0):iM|=r),ia(e,t)}function D6(e,t){t===0&&(e.mode&1?(t=I_,I_<<=1,!(I_&130023424)&&(I_=4194304)):t=1);var r=Ro();e=Ac(e,t),e!==null&&(Cb(e,t,r),ia(e,r))}function Lte(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),D6(e,r)}function Bte(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,o=e.memoizedState;o!==null&&(r=o.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(It(314))}n!==null&&n.delete(t),D6(e,r)}var R6;R6=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ra.current)ea=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ea=!1,Tte(e,t,r);ea=!!(e.flags&131072)}else ea=!1,Wn&&t.flags&1048576&&$V(t,i1,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ow(e,t),e=t.pendingProps;var o=xm(t,jo.current);um(t,r),o=JN(null,t,n,e,o,r);var s=QN();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,na(n)?(s=!0,r1(t)):s=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,HN(t),o.updater=QS,t.stateNode=o,o._reactInternals=t,RP(t,n,e,r),t=zP(null,t,n,!0,s,r)):(t.tag=0,Wn&&s&&$N(t),Oo(null,t,o,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ow(e,t),e=t.pendingProps,o=n._init,n=o(n._payload),t.type=n,o=t.tag=$te(n),e=Ds(n,e),o){case 0:t=BP(null,t,n,e,r);break e;case 1:t=y3(null,t,n,e,r);break e;case 11:t=m3(null,t,n,e,r);break e;case 14:t=g3(null,t,n,Ds(n.type,e),r);break e}throw Error(It(306,n,""))}return t;case 0:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Ds(n,o),BP(e,t,n,o,r);case 1:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Ds(n,o),y3(e,t,n,o,r);case 3:e:{if(x6(t),e===null)throw Error(It(387));n=t.pendingProps,s=t.memoizedState,o=s.element,GV(e,t),s1(t,n,null,r);var h=t.memoizedState;if(n=h.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){o=Sm(Error(It(423)),t),t=v3(e,t,n,r,o);break e}else if(n!==o){o=Sm(Error(It(424)),t),t=v3(e,t,n,r,o);break e}else for(Ea=Qu(t.stateNode.containerInfo.firstChild),Ta=t,Wn=!0,Fs=null,r=qV(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(bm(),n===o){t=kc(e,t,r);break e}Oo(e,t,n,r)}t=t.child}return t;case 5:return HV(t),e===null&&IP(t),n=t.type,o=t.pendingProps,s=e!==null?e.memoizedProps:null,h=o.children,PP(n,o)?h=null:s!==null&&PP(n,s)&&(t.flags|=32),v6(e,t),Oo(e,t,h,r),t.child;case 6:return e===null&&IP(t),null;case 13:return b6(e,t,r);case 4:return XN(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=_m(t,null,n,r):Oo(e,t,n,r),t.child;case 11:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Ds(n,o),m3(e,t,n,o,r);case 7:return Oo(e,t,t.pendingProps,r),t.child;case 8:return Oo(e,t,t.pendingProps.children,r),t.child;case 12:return Oo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,o=t.pendingProps,s=t.memoizedProps,h=o.value,On(o1,n._currentValue),n._currentValue=h,s!==null)if(Zs(s.value,h)){if(s.children===o.children&&!ra.current){t=kc(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var i=s.dependencies;if(i!==null){h=s.child;for(var p=i.firstContext;p!==null;){if(p.context===n){if(s.tag===1){p=bc(-1,r&-r),p.tag=2;var y=s.updateQueue;if(y!==null){y=y.shared;var b=y.pending;b===null?p.next=p:(p.next=b.next,b.next=p),y.pending=p}}s.lanes|=r,p=s.alternate,p!==null&&(p.lanes|=r),OP(s.return,r,t),i.lanes|=r;break}p=p.next}}else if(s.tag===10)h=s.type===t.type?null:s.child;else if(s.tag===18){if(h=s.return,h===null)throw Error(It(341));h.lanes|=r,i=h.alternate,i!==null&&(i.lanes|=r),OP(h,r,t),h=s.sibling}else h=s.child;if(h!==null)h.return=s;else for(h=s;h!==null;){if(h===t){h=null;break}if(s=h.sibling,s!==null){s.return=h.return,h=s;break}h=h.return}s=h}Oo(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,n=t.pendingProps.children,um(t,r),o=ns(o),n=n(o),t.flags|=1,Oo(e,t,n,r),t.child;case 14:return n=t.type,o=Ds(n,t.pendingProps),o=Ds(n.type,o),g3(e,t,n,o,r);case 15:return g6(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Ds(n,o),Ow(e,t),t.tag=1,na(n)?(e=!0,r1(t)):e=!1,um(t,r),f6(t,n,o),RP(t,n,o,r),zP(null,t,n,!0,e,r);case 19:return _6(e,t,r);case 22:return y6(e,t,r)}throw Error(It(156,t.tag))};function L6(e,t){return uV(e,t)}function zte(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ya(e,t,r,n){return new zte(e,t,r,n)}function cM(e){return e=e.prototype,!(!e||!e.isReactComponent)}function $te(e){if(typeof e=="function")return cM(e)?1:0;if(e!=null){if(e=e.$$typeof,e===PN)return 11;if(e===AN)return 14}return 2}function nd(e,t){var r=e.alternate;return r===null?(r=Ya(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Lw(e,t,r,n,o,s){var h=2;if(n=e,typeof e=="function")cM(e)&&(h=1);else if(typeof e=="string")h=5;else e:switch(e){case Up:return Hh(r.children,o,s,t);case CN:h=8,o|=8;break;case aP:return e=Ya(12,r,t,o|2),e.elementType=aP,e.lanes=s,e;case sP:return e=Ya(13,r,t,o),e.elementType=sP,e.lanes=s,e;case lP:return e=Ya(19,r,t,o),e.elementType=lP,e.lanes=s,e;case HU:return r2(r,o,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case WU:h=10;break e;case GU:h=9;break e;case PN:h=11;break e;case AN:h=14;break e;case Lu:h=16,n=null;break e}throw Error(It(130,e==null?e:typeof e,""))}return t=Ya(h,r,t,o),t.elementType=e,t.type=n,t.lanes=s,t}function Hh(e,t,r,n){return e=Ya(7,e,n,t),e.lanes=r,e}function r2(e,t,r,n){return e=Ya(22,e,n,t),e.elementType=HU,e.lanes=r,e.stateNode={isHidden:!1},e}function Uj(e,t,r){return e=Ya(6,e,null,t),e.lanes=r,e}function Vj(e,t,r){return t=Ya(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fte(e,t,r,n,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sj(0),this.expirationTimes=Sj(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sj(0),this.identifierPrefix=n,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function uM(e,t,r,n,o,s,h,i,p){return e=new Fte(e,t,r,i,p),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Ya(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},HN(s),e}function Ute(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fp,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function B6(e){if(!e)return ud;e=e._reactInternals;e:{if(yf(e)!==e||e.tag!==1)throw Error(It(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(na(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(It(171))}if(e.tag===1){var r=e.type;if(na(r))return BV(e,r,t)}return t}function z6(e,t,r,n,o,s,h,i,p){return e=uM(r,n,!0,e,o,s,h,i,p),e.context=B6(null),r=e.current,n=Ro(),o=rd(r),s=bc(n,o),s.callback=t??null,ed(r,s,o),e.current.lanes=o,Cb(e,o,n),ia(e,n),e}function n2(e,t,r,n){var o=t.current,s=Ro(),h=rd(o);return r=B6(r),t.context===null?t.context=r:t.pendingContext=r,t=bc(s,h),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ed(o,t,h),e!==null&&(Hs(e,o,h,s),Nw(e,o,h)),h}function m1(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function P3(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function dM(e,t){P3(e,t),(e=e.alternate)&&P3(e,t)}function Vte(){return null}var $6=typeof reportError=="function"?reportError:function(e){console.error(e)};function hM(e){this._internalRoot=e}i2.prototype.render=hM.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(It(409));n2(e,t,null,null)};i2.prototype.unmount=hM.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ef(function(){n2(null,e,null,null)}),t[Pc]=null}};function i2(e){this._internalRoot=e}i2.prototype.unstable_scheduleHydration=function(e){if(e){var t=yV();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Uu.length&&t!==0&&t<Uu[r].priority;r++);Uu.splice(r,0,e),r===0&&xV(e)}};function fM(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function o2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function A3(){}function qte(e,t,r,n,o){if(o){if(typeof n=="function"){var s=n;n=function(){var y=m1(h);s.call(y)}}var h=z6(t,n,e,0,null,!1,!1,"",A3);return e._reactRootContainer=h,e[Pc]=h.current,Ex(e.nodeType===8?e.parentNode:e),ef(),h}for(;o=e.lastChild;)e.removeChild(o);if(typeof n=="function"){var i=n;n=function(){var y=m1(p);i.call(y)}}var p=uM(e,0,!1,null,null,!1,!1,"",A3);return e._reactRootContainer=p,e[Pc]=p.current,Ex(e.nodeType===8?e.parentNode:e),ef(function(){n2(t,p,r,n)}),p}function a2(e,t,r,n,o){var s=r._reactRootContainer;if(s){var h=s;if(typeof o=="function"){var i=o;o=function(){var p=m1(h);i.call(p)}}n2(t,h,e,o)}else h=qte(r,t,e,o,n);return m1(h)}mV=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Bv(t.pendingLanes);r!==0&&(MN(t,r|1),ia(t,fi()),!(Yr&6)&&(Em=fi()+500,bd()))}break;case 13:ef(function(){var n=Ac(e,1);if(n!==null){var o=Ro();Hs(n,e,1,o)}}),dM(e,1)}};IN=function(e){if(e.tag===13){var t=Ac(e,134217728);if(t!==null){var r=Ro();Hs(t,e,134217728,r)}dM(e,134217728)}};gV=function(e){if(e.tag===13){var t=rd(e),r=Ac(e,t);if(r!==null){var n=Ro();Hs(r,e,t,n)}dM(e,t)}};yV=function(){return _n};vV=function(e,t){var r=_n;try{return _n=e,t()}finally{_n=r}};vP=function(e,t,r){switch(t){case"input":if(dP(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var o=KS(n);if(!o)throw Error(It(90));ZU(n),dP(n,o)}}}break;case"textarea":YU(e,r);break;case"select":t=r.value,t!=null&&am(e,!!r.multiple,t,!1)}};iV=aM;oV=ef;var Wte={usingClientEntryPoint:!1,Events:[Ab,Gp,KS,rV,nV,aM]},mv={findFiberByHostInstance:Lh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Gte={bundleType:mv.bundleType,version:mv.version,rendererPackageName:mv.rendererPackageName,rendererConfig:mv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fc.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=lV(e),e===null?null:e.stateNode},findFiberByHostInstance:mv.findFiberByHostInstance||Vte,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var q_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!q_.isDisabled&&q_.supportsFiber)try{GS=q_.inject(Gte),El=q_}catch{}}Na.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wte;Na.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fM(t))throw Error(It(200));return Ute(e,t,null,r)};Na.createRoot=function(e,t){if(!fM(e))throw Error(It(299));var r=!1,n="",o=$6;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=uM(e,1,!1,null,null,r,!1,n,o),e[Pc]=t.current,Ex(e.nodeType===8?e.parentNode:e),new hM(t)};Na.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(It(188)):(e=Object.keys(e).join(","),Error(It(268,e)));return e=lV(t),e=e===null?null:e.stateNode,e};Na.flushSync=function(e){return ef(e)};Na.hydrate=function(e,t,r){if(!o2(t))throw Error(It(200));return a2(null,e,t,!0,r)};Na.hydrateRoot=function(e,t,r){if(!fM(e))throw Error(It(405));var n=r!=null&&r.hydratedSources||null,o=!1,s="",h=$6;if(r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),t=z6(t,null,e,1,r??null,o,!1,s,h),e[Pc]=t.current,Ex(e),n)for(e=0;e<n.length;e++)r=n[e],o=r._getVersion,o=o(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new i2(t)};Na.render=function(e,t,r){if(!o2(t))throw Error(It(200));return a2(null,e,t,!1,r)};Na.unmountComponentAtNode=function(e){if(!o2(e))throw Error(It(40));return e._reactRootContainer?(ef(function(){a2(null,null,e,!1,function(){e._reactRootContainer=null,e[Pc]=null})}),!0):!1};Na.unstable_batchedUpdates=aM;Na.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!o2(r))throw Error(It(200));if(e==null||e._reactInternals===void 0)throw Error(It(38));return a2(e,t,r,!1,n)};Na.version="18.3.1-next-f1338f8080-20240426";function F6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(F6)}catch(e){console.error(e)}}F6(),FU.exports=Na;var Uc=FU.exports;const Hte=wn(Uc);var k3=Uc;iP.createRoot=k3.createRoot,iP.hydrateRoot=k3.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ix(){return Ix=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ix.apply(this,arguments)}var Xu;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Xu||(Xu={}));const N3="popstate";function Xte(e){e===void 0&&(e={});function t(n,o){let{pathname:s,search:h,hash:i}=n.location;return YP("",{pathname:s,search:h,hash:i},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(n,o){return typeof o=="string"?o:g1(o)}return Kte(t,r,null,e)}function mi(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function U6(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Zte(){return Math.random().toString(36).substr(2,8)}function M3(e,t){return{usr:e.state,key:e.key,idx:t}}function YP(e,t,r,n){return r===void 0&&(r=null),Ix({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?og(t):t,{state:r,key:t&&t.key||n||Zte()})}function g1(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function og(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Kte(e,t,r,n){n===void 0&&(n={});let{window:o=document.defaultView,v5Compat:s=!1}=n,h=o.history,i=Xu.Pop,p=null,y=b();y==null&&(y=0,h.replaceState(Ix({},h.state,{idx:y}),""));function b(){return(h.state||{idx:null}).idx}function _(){i=Xu.Pop;let I=b(),B=I==null?null:I-y;y=I,p&&p({action:i,location:N.location,delta:B})}function E(I,B){i=Xu.Push;let O=YP(N.location,I,B);r&&r(O,I),y=b()+1;let R=M3(O,y),q=N.createHref(O);try{h.pushState(R,"",q)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;o.location.assign(q)}s&&p&&p({action:i,location:N.location,delta:1})}function C(I,B){i=Xu.Replace;let O=YP(N.location,I,B);r&&r(O,I),y=b();let R=M3(O,y),q=N.createHref(O);h.replaceState(R,"",q),s&&p&&p({action:i,location:N.location,delta:0})}function k(I){let B=o.location.origin!=="null"?o.location.origin:o.location.href,O=typeof I=="string"?I:g1(I);return O=O.replace(/ $/,"%20"),mi(B,"No window.location.(origin|href) available to create URL for href: "+O),new URL(O,B)}let N={get action(){return i},get location(){return e(o,h)},listen(I){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(N3,_),p=I,()=>{o.removeEventListener(N3,_),p=null}},createHref(I){return t(o,I)},createURL:k,encodeLocation(I){let B=k(I);return{pathname:B.pathname,search:B.search,hash:B.hash}},push:E,replace:C,go(I){return h.go(I)}};return N}var I3;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(I3||(I3={}));function Yte(e,t,r){return r===void 0&&(r="/"),Jte(e,t,r,!1)}function Jte(e,t,r,n){let o=typeof t=="string"?og(t):t,s=pM(o.pathname||"/",r);if(s==null)return null;let h=V6(e);Qte(h);let i=null;for(let p=0;i==null&&p<h.length;++p){let y=ure(s);i=lre(h[p],y,n)}return i}function V6(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let o=(s,h,i)=>{let p={relativePath:i===void 0?s.path||"":i,caseSensitive:s.caseSensitive===!0,childrenIndex:h,route:s};p.relativePath.startsWith("/")&&(mi(p.relativePath.startsWith(n),'Absolute route path "'+p.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),p.relativePath=p.relativePath.slice(n.length));let y=id([n,p.relativePath]),b=r.concat(p);s.children&&s.children.length>0&&(mi(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),V6(s.children,t,b,y)),!(s.path==null&&!s.index)&&t.push({path:y,score:are(y,s.index),routesMeta:b})};return e.forEach((s,h)=>{var i;if(s.path===""||!((i=s.path)!=null&&i.includes("?")))o(s,h);else for(let p of q6(s.path))o(s,h,p)}),t}function q6(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,o=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return o?[s,""]:[s];let h=q6(n.join("/")),i=[];return i.push(...h.map(p=>p===""?s:[s,p].join("/"))),o&&i.push(...h),i.map(p=>e.startsWith("/")&&p===""?"/":p)}function Qte(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:sre(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const ere=/^:[\w-]+$/,tre=3,rre=2,nre=1,ire=10,ore=-2,O3=e=>e==="*";function are(e,t){let r=e.split("/"),n=r.length;return r.some(O3)&&(n+=ore),t&&(n+=rre),r.filter(o=>!O3(o)).reduce((o,s)=>o+(ere.test(s)?tre:s===""?nre:ire),n)}function sre(e,t){return e.length===t.length&&e.slice(0,-1).every((n,o)=>n===t[o])?e[e.length-1]-t[t.length-1]:0}function lre(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,o={},s="/",h=[];for(let i=0;i<n.length;++i){let p=n[i],y=i===n.length-1,b=s==="/"?t:t.slice(s.length)||"/",_=D3({path:p.relativePath,caseSensitive:p.caseSensitive,end:y},b),E=p.route;if(!_&&y&&r&&!n[n.length-1].route.index&&(_=D3({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},b)),!_)return null;Object.assign(o,_.params),h.push({params:o,pathname:id([s,_.pathname]),pathnameBase:pre(id([s,_.pathnameBase])),route:E}),_.pathnameBase!=="/"&&(s=id([s,_.pathnameBase]))}return h}function D3(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=cre(e.path,e.caseSensitive,e.end),o=t.match(r);if(!o)return null;let s=o[0],h=s.replace(/(.)\/+$/,"$1"),i=o.slice(1);return{params:n.reduce((y,b,_)=>{let{paramName:E,isOptional:C}=b;if(E==="*"){let N=i[_]||"";h=s.slice(0,s.length-N.length).replace(/(.)\/+$/,"$1")}const k=i[_];return C&&!k?y[E]=void 0:y[E]=(k||"").replace(/%2F/g,"/"),y},{}),pathname:s,pathnameBase:h,pattern:e}}function cre(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),U6(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,i,p)=>(n.push({paramName:i,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),n]}function ure(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return U6(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function pM(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function dre(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:o=""}=typeof e=="string"?og(e):e;return{pathname:r?r.startsWith("/")?r:hre(r,t):t,search:mre(n),hash:gre(o)}}function hre(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?r.length>1&&r.pop():o!=="."&&r.push(o)}),r.length>1?r.join("/"):"/"}function qj(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function fre(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function mM(e,t){let r=fre(e);return t?r.map((n,o)=>o===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function gM(e,t,r,n){n===void 0&&(n=!1);let o;typeof e=="string"?o=og(e):(o=Ix({},e),mi(!o.pathname||!o.pathname.includes("?"),qj("?","pathname","search",o)),mi(!o.pathname||!o.pathname.includes("#"),qj("#","pathname","hash",o)),mi(!o.search||!o.search.includes("#"),qj("#","search","hash",o)));let s=e===""||o.pathname==="",h=s?"/":o.pathname,i;if(h==null)i=r;else{let _=t.length-1;if(!n&&h.startsWith("..")){let E=h.split("/");for(;E[0]==="..";)E.shift(),_-=1;o.pathname=E.join("/")}i=_>=0?t[_]:"/"}let p=dre(o,i),y=h&&h!=="/"&&h.endsWith("/"),b=(s||h===".")&&r.endsWith("/");return!p.pathname.endsWith("/")&&(y||b)&&(p.pathname+="/"),p}const id=e=>e.join("/").replace(/\/\/+/g,"/"),pre=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),mre=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,gre=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function yre(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const W6=["post","put","patch","delete"];new Set(W6);const vre=["get",...W6];new Set(vre);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ox(){return Ox=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ox.apply(this,arguments)}const yM=D.createContext(null),xre=D.createContext(null),_d=D.createContext(null),s2=D.createContext(null),Vc=D.createContext({outlet:null,matches:[],isDataRoute:!1}),G6=D.createContext(null);function bre(e,t){let{relative:r}=t===void 0?{}:t;ag()||mi(!1);let{basename:n,navigator:o}=D.useContext(_d),{hash:s,pathname:h,search:i}=X6(e,{relative:r}),p=h;return n!=="/"&&(p=h==="/"?n:id([n,h])),o.createHref({pathname:p,search:i,hash:s})}function ag(){return D.useContext(s2)!=null}function qc(){return ag()||mi(!1),D.useContext(s2).location}function H6(e){D.useContext(_d).static||D.useLayoutEffect(e)}function zi(){let{isDataRoute:e}=D.useContext(Vc);return e?Ire():_re()}function _re(){ag()||mi(!1);let e=D.useContext(yM),{basename:t,future:r,navigator:n}=D.useContext(_d),{matches:o}=D.useContext(Vc),{pathname:s}=qc(),h=JSON.stringify(mM(o,r.v7_relativeSplatPath)),i=D.useRef(!1);return H6(()=>{i.current=!0}),D.useCallback(function(y,b){if(b===void 0&&(b={}),!i.current)return;if(typeof y=="number"){n.go(y);return}let _=gM(y,JSON.parse(h),s,b.relative==="path");e==null&&t!=="/"&&(_.pathname=_.pathname==="/"?t:id([t,_.pathname])),(b.replace?n.replace:n.push)(_,b.state,b)},[t,n,h,s,e])}function l2(){let{matches:e}=D.useContext(Vc),t=e[e.length-1];return t?t.params:{}}function X6(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=D.useContext(_d),{matches:o}=D.useContext(Vc),{pathname:s}=qc(),h=JSON.stringify(mM(o,n.v7_relativeSplatPath));return D.useMemo(()=>gM(e,JSON.parse(h),s,r==="path"),[e,h,s,r])}function wre(e,t){return Sre(e,t)}function Sre(e,t,r,n){ag()||mi(!1);let{navigator:o}=D.useContext(_d),{matches:s}=D.useContext(Vc),h=s[s.length-1],i=h?h.params:{};h&&h.pathname;let p=h?h.pathnameBase:"/";h&&h.route;let y=qc(),b;if(t){var _;let I=typeof t=="string"?og(t):t;p==="/"||(_=I.pathname)!=null&&_.startsWith(p)||mi(!1),b=I}else b=y;let E=b.pathname||"/",C=E;if(p!=="/"){let I=p.replace(/^\//,"").split("/");C="/"+E.replace(/^\//,"").split("/").slice(I.length).join("/")}let k=Yte(e,{pathname:C}),N=Pre(k&&k.map(I=>Object.assign({},I,{params:Object.assign({},i,I.params),pathname:id([p,o.encodeLocation?o.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?p:id([p,o.encodeLocation?o.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),s,r,n);return t&&N?D.createElement(s2.Provider,{value:{location:Ox({pathname:"/",search:"",hash:"",state:null,key:"default"},b),navigationType:Xu.Pop}},N):N}function Ere(){let e=Mre(),t=yre(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},t),r?D.createElement("pre",{style:o},r):null,s)}const Tre=D.createElement(Ere,null);class jre extends D.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?D.createElement(Vc.Provider,{value:this.props.routeContext},D.createElement(G6.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Cre(e){let{routeContext:t,match:r,children:n}=e,o=D.useContext(yM);return o&&o.static&&o.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=r.route.id),D.createElement(Vc.Provider,{value:t},n)}function Pre(e,t,r,n){var o;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let h=e,i=(o=r)==null?void 0:o.errors;if(i!=null){let b=h.findIndex(_=>_.route.id&&(i==null?void 0:i[_.route.id])!==void 0);b>=0||mi(!1),h=h.slice(0,Math.min(h.length,b+1))}let p=!1,y=-1;if(r&&n&&n.v7_partialHydration)for(let b=0;b<h.length;b++){let _=h[b];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(y=b),_.route.id){let{loaderData:E,errors:C}=r,k=_.route.loader&&E[_.route.id]===void 0&&(!C||C[_.route.id]===void 0);if(_.route.lazy||k){p=!0,y>=0?h=h.slice(0,y+1):h=[h[0]];break}}}return h.reduceRight((b,_,E)=>{let C,k=!1,N=null,I=null;r&&(C=i&&_.route.id?i[_.route.id]:void 0,N=_.route.errorElement||Tre,p&&(y<0&&E===0?(Ore("route-fallback",!1),k=!0,I=null):y===E&&(k=!0,I=_.route.hydrateFallbackElement||null)));let B=t.concat(h.slice(0,E+1)),O=()=>{let R;return C?R=N:k?R=I:_.route.Component?R=D.createElement(_.route.Component,null):_.route.element?R=_.route.element:R=b,D.createElement(Cre,{match:_,routeContext:{outlet:b,matches:B,isDataRoute:r!=null},children:R})};return r&&(_.route.ErrorBoundary||_.route.errorElement||E===0)?D.createElement(jre,{location:r.location,revalidation:r.revalidation,component:N,error:C,children:O(),routeContext:{outlet:null,matches:B,isDataRoute:!0}}):O()},null)}var Z6=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Z6||{}),y1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(y1||{});function Are(e){let t=D.useContext(yM);return t||mi(!1),t}function kre(e){let t=D.useContext(xre);return t||mi(!1),t}function Nre(e){let t=D.useContext(Vc);return t||mi(!1),t}function K6(e){let t=Nre(),r=t.matches[t.matches.length-1];return r.route.id||mi(!1),r.route.id}function Mre(){var e;let t=D.useContext(G6),r=kre(y1.UseRouteError),n=K6(y1.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Ire(){let{router:e}=Are(Z6.UseNavigateStable),t=K6(y1.UseNavigateStable),r=D.useRef(!1);return H6(()=>{r.current=!0}),D.useCallback(function(o,s){s===void 0&&(s={}),r.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,Ox({fromRouteId:t},s)))},[e,t])}const R3={};function Ore(e,t,r){!t&&!R3[e]&&(R3[e]=!0)}function Dre(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function Rre(e){let{to:t,replace:r,state:n,relative:o}=e;ag()||mi(!1);let{future:s,static:h}=D.useContext(_d),{matches:i}=D.useContext(Vc),{pathname:p}=qc(),y=zi(),b=gM(t,mM(i,s.v7_relativeSplatPath),p,o==="path"),_=JSON.stringify(b);return D.useEffect(()=>y(JSON.parse(_),{replace:r,state:n,relative:o}),[y,_,o,r,n]),null}function Lr(e){mi(!1)}function Lre(e){let{basename:t="/",children:r=null,location:n,navigationType:o=Xu.Pop,navigator:s,static:h=!1,future:i}=e;ag()&&mi(!1);let p=t.replace(/^\/*/,"/"),y=D.useMemo(()=>({basename:p,navigator:s,static:h,future:Ox({v7_relativeSplatPath:!1},i)}),[p,i,s,h]);typeof n=="string"&&(n=og(n));let{pathname:b="/",search:_="",hash:E="",state:C=null,key:k="default"}=n,N=D.useMemo(()=>{let I=pM(b,p);return I==null?null:{location:{pathname:I,search:_,hash:E,state:C,key:k},navigationType:o}},[p,b,_,E,C,k,o]);return N==null?null:D.createElement(_d.Provider,{value:y},D.createElement(s2.Provider,{children:r,value:N}))}function Bre(e){let{children:t,location:r}=e;return wre(JP(t),r)}new Promise(()=>{});function JP(e,t){t===void 0&&(t=[]);let r=[];return D.Children.forEach(e,(n,o)=>{if(!D.isValidElement(n))return;let s=[...t,o];if(n.type===D.Fragment){r.push.apply(r,JP(n.props.children,s));return}n.type!==Lr&&mi(!1),!n.props.index||!n.props.children||mi(!1);let h={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(h.children=JP(n.props.children,s)),r.push(h)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function QP(){return QP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},QP.apply(this,arguments)}function zre(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,s;for(s=0;s<n.length;s++)o=n[s],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function $re(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Fre(e,t){return e.button===0&&(!t||t==="_self")&&!$re(e)}function eA(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(o=>[r,o]):[[r,n]])},[]))}function Ure(e,t){let r=eA(e);return t&&t.forEach((n,o)=>{r.has(o)||t.getAll(o).forEach(s=>{r.append(o,s)})}),r}const Vre=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],qre="6";try{window.__reactRouterVersion=qre}catch{}const Wre="startTransition",L3=SN[Wre];function Gre(e){let{basename:t,children:r,future:n,window:o}=e,s=D.useRef();s.current==null&&(s.current=Xte({window:o,v5Compat:!0}));let h=s.current,[i,p]=D.useState({action:h.action,location:h.location}),{v7_startTransition:y}=n||{},b=D.useCallback(_=>{y&&L3?L3(()=>p(_)):p(_)},[p,y]);return D.useLayoutEffect(()=>h.listen(b),[h,b]),D.useEffect(()=>Dre(n),[n]),D.createElement(Lre,{basename:t,children:r,location:i.location,navigationType:i.action,navigator:h,future:n})}const Hre=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Xre=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,In=D.forwardRef(function(t,r){let{onClick:n,relative:o,reloadDocument:s,replace:h,state:i,target:p,to:y,preventScrollReset:b,viewTransition:_}=t,E=zre(t,Vre),{basename:C}=D.useContext(_d),k,N=!1;if(typeof y=="string"&&Xre.test(y)&&(k=y,Hre))try{let R=new URL(window.location.href),q=y.startsWith("//")?new URL(R.protocol+y):new URL(y),F=pM(q.pathname,C);q.origin===R.origin&&F!=null?y=F+q.search+q.hash:N=!0}catch{}let I=bre(y,{relative:o}),B=Zre(y,{replace:h,state:i,target:p,preventScrollReset:b,relative:o,viewTransition:_});function O(R){n&&n(R),R.defaultPrevented||B(R)}return D.createElement("a",QP({},E,{href:k||I,onClick:N||s?n:O,ref:r,target:p}))});var B3;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(B3||(B3={}));var z3;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(z3||(z3={}));function Zre(e,t){let{target:r,replace:n,state:o,preventScrollReset:s,relative:h,viewTransition:i}=t===void 0?{}:t,p=zi(),y=qc(),b=X6(e,{relative:h});return D.useCallback(_=>{if(Fre(_,r)){_.preventDefault();let E=n!==void 0?n:g1(y)===g1(b);p(e,{replace:E,state:o,preventScrollReset:s,relative:h,viewTransition:i})}},[y,p,b,n,o,r,e,s,h,i])}function Y6(e){let t=D.useRef(eA(e)),r=D.useRef(!1),n=qc(),o=D.useMemo(()=>Ure(n.search,r.current?null:t.current),[n.search]),s=zi(),h=D.useCallback((i,p)=>{const y=eA(typeof i=="function"?i(o):i);r.current=!0,s("?"+y,p)},[s,o]);return[o,h]}function J6(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=J6(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Zr(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=J6(e))&&(n&&(n+=" "),n+=t);return n}function Kre(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=Q6(t))&&(n&&(n+=" "),n+=r);return n}function Q6(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=Q6(e[n]))&&(r&&(r+=" "),r+=t);return r}var vM="-";function Yre(e){var t=Qre(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,o=n===void 0?{}:n;function s(i){var p=i.split(vM);return p[0]===""&&p.length!==1&&p.shift(),e8(p,t)||Jre(i)}function h(i,p){var y=r[i]||[];return p&&o[i]?[].concat(y,o[i]):y}return{getClassGroupId:s,getConflictingClassGroupIds:h}}function e8(e,t){var h;if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),o=n?e8(e.slice(1),n):void 0;if(o)return o;if(t.validators.length!==0){var s=e.join(vM);return(h=t.validators.find(function(i){var p=i.validator;return p(s)}))==null?void 0:h.classGroupId}}var $3=/^\[(.+)\]$/;function Jre(e){if($3.test(e)){var t=$3.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function Qre(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},o=tne(Object.entries(e.classGroups),r);return o.forEach(function(s){var h=s[0],i=s[1];tA(i,n,h,t)}),n}function tA(e,t,r,n){e.forEach(function(o){if(typeof o=="string"){var s=o===""?t:F3(t,o);s.classGroupId=r;return}if(typeof o=="function"){if(ene(o)){tA(o(n),t,r,n);return}t.validators.push({validator:o,classGroupId:r});return}Object.entries(o).forEach(function(h){var i=h[0],p=h[1];tA(p,F3(t,i),r,n)})})}function F3(e,t){var r=e;return t.split(vM).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function ene(e){return e.isThemeGetter}function tne(e,t){return t?e.map(function(r){var n=r[0],o=r[1],s=o.map(function(h){return typeof h=="string"?t+h:typeof h=="object"?Object.fromEntries(Object.entries(h).map(function(i){var p=i[0],y=i[1];return[t+p,y]})):h});return[n,s]}):e}function rne(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function o(s,h){r.set(s,h),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(h){var i=r.get(h);if(i!==void 0)return i;if((i=n.get(h))!==void 0)return o(h,i),i},set:function(h,i){r.has(h)?r.set(h,i):o(h,i)}}}var t8="!";function nne(e){var t=e.separator||":",r=t.length===1,n=t[0],o=t.length;return function(h){for(var i=[],p=0,y=0,b,_=0;_<h.length;_++){var E=h[_];if(p===0){if(E===n&&(r||h.slice(_,_+o)===t)){i.push(h.slice(y,_)),y=_+o;continue}if(E==="/"){b=_;continue}}E==="["?p++:E==="]"&&p--}var C=i.length===0?h:h.substring(y),k=C.startsWith(t8),N=k?C.substring(1):C,I=b&&b>y?b-y:void 0;return{modifiers:i,hasImportantModifier:k,baseClassName:N,maybePostfixModifierPosition:I}}}function ine(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var o=n[0]==="[";o?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function one(e){return{cache:rne(e.cacheSize),splitModifiers:nne(e),...Yre(e)}}var ane=/\s+/;function sne(e,t){var r=t.splitModifiers,n=t.getClassGroupId,o=t.getConflictingClassGroupIds,s=new Set;return e.trim().split(ane).map(function(h){var i=r(h),p=i.modifiers,y=i.hasImportantModifier,b=i.baseClassName,_=i.maybePostfixModifierPosition,E=n(_?b.substring(0,_):b),C=!!_;if(!E){if(!_)return{isTailwindClass:!1,originalClassName:h};if(E=n(b),!E)return{isTailwindClass:!1,originalClassName:h};C=!1}var k=ine(p).join(":"),N=y?k+t8:k;return{isTailwindClass:!0,modifierId:N,classGroupId:E,originalClassName:h,hasPostfixModifier:C}}).reverse().filter(function(h){if(!h.isTailwindClass)return!0;var i=h.modifierId,p=h.classGroupId,y=h.hasPostfixModifier,b=i+p;return s.has(b)?!1:(s.add(b),o(p,y).forEach(function(_){return s.add(i+_)}),!0)}).reverse().map(function(h){return h.originalClassName}).join(" ")}function lne(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,o,s,h=i;function i(y){var b=t[0],_=t.slice(1),E=_.reduce(function(C,k){return k(C)},b());return n=one(E),o=n.cache.get,s=n.cache.set,h=p,p(y)}function p(y){var b=o(y);if(b)return b;var _=sne(y,n);return s(y,_),_}return function(){return h(Kre.apply(null,arguments))}}function Ln(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var r8=/^\[(?:([a-z-]+):)?(.+)\]$/i,cne=/^\d+\/\d+$/,une=new Set(["px","full","screen"]),dne=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,hne=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,fne=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Ns(e){return $h(e)||une.has(e)||cne.test(e)||rA(e)}function rA(e){return vf(e,"length",xne)}function pne(e){return vf(e,"size",n8)}function mne(e){return vf(e,"position",n8)}function gne(e){return vf(e,"url",bne)}function W_(e){return vf(e,"number",$h)}function $h(e){return!Number.isNaN(Number(e))}function yne(e){return e.endsWith("%")&&$h(e.slice(0,-1))}function gv(e){return U3(e)||vf(e,"number",U3)}function qr(e){return r8.test(e)}function yv(){return!0}function Pu(e){return dne.test(e)}function vne(e){return vf(e,"",_ne)}function vf(e,t,r){var n=r8.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function xne(e){return hne.test(e)}function n8(){return!1}function bne(e){return e.startsWith("url(")}function U3(e){return Number.isInteger(Number(e))}function _ne(e){return fne.test(e)}function wne(){var e=Ln("colors"),t=Ln("spacing"),r=Ln("blur"),n=Ln("brightness"),o=Ln("borderColor"),s=Ln("borderRadius"),h=Ln("borderSpacing"),i=Ln("borderWidth"),p=Ln("contrast"),y=Ln("grayscale"),b=Ln("hueRotate"),_=Ln("invert"),E=Ln("gap"),C=Ln("gradientColorStops"),k=Ln("gradientColorStopPositions"),N=Ln("inset"),I=Ln("margin"),B=Ln("opacity"),O=Ln("padding"),R=Ln("saturate"),q=Ln("scale"),F=Ln("sepia"),X=Ln("skew"),G=Ln("space"),ee=Ln("translate"),K=function(){return["auto","contain","none"]},ie=function(){return["auto","hidden","clip","visible","scroll"]},pe=function(){return["auto",qr,t]},ae=function(){return[qr,t]},_e=function(){return["",Ns]},Ee=function(){return["auto",$h,qr]},xe=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},ce=function(){return["solid","dashed","dotted","double","none"]},ke=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},ve=function(){return["start","end","center","between","around","evenly","stretch"]},Pe=function(){return["","0",qr]},Re=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},Be=function(){return[$h,W_]},Fe=function(){return[$h,qr]};return{cacheSize:500,theme:{colors:[yv],spacing:[Ns],blur:["none","",Pu,qr],brightness:Be(),borderColor:[e],borderRadius:["none","","full",Pu,qr],borderSpacing:ae(),borderWidth:_e(),contrast:Be(),grayscale:Pe(),hueRotate:Fe(),invert:Pe(),gap:ae(),gradientColorStops:[e],gradientColorStopPositions:[yne,rA],inset:pe(),margin:pe(),opacity:Be(),padding:ae(),saturate:Be(),scale:Be(),sepia:Pe(),skew:Fe(),space:ae(),translate:ae()},classGroups:{aspect:[{aspect:["auto","square","video",qr]}],container:["container"],columns:[{columns:[Pu]}],"break-after":[{"break-after":Re()}],"break-before":[{"break-before":Re()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(xe(),[qr])}],overflow:[{overflow:ie()}],"overflow-x":[{"overflow-x":ie()}],"overflow-y":[{"overflow-y":ie()}],overscroll:[{overscroll:K()}],"overscroll-x":[{"overscroll-x":K()}],"overscroll-y":[{"overscroll-y":K()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[N]}],"inset-x":[{"inset-x":[N]}],"inset-y":[{"inset-y":[N]}],start:[{start:[N]}],end:[{end:[N]}],top:[{top:[N]}],right:[{right:[N]}],bottom:[{bottom:[N]}],left:[{left:[N]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",gv]}],basis:[{basis:pe()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",qr]}],grow:[{grow:Pe()}],shrink:[{shrink:Pe()}],order:[{order:["first","last","none",gv]}],"grid-cols":[{"grid-cols":[yv]}],"col-start-end":[{col:["auto",{span:["full",gv]},qr]}],"col-start":[{"col-start":Ee()}],"col-end":[{"col-end":Ee()}],"grid-rows":[{"grid-rows":[yv]}],"row-start-end":[{row:["auto",{span:[gv]},qr]}],"row-start":[{"row-start":Ee()}],"row-end":[{"row-end":Ee()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",qr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",qr]}],gap:[{gap:[E]}],"gap-x":[{"gap-x":[E]}],"gap-y":[{"gap-y":[E]}],"justify-content":[{justify:["normal"].concat(ve())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(ve(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(ve(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[O]}],px:[{px:[O]}],py:[{py:[O]}],ps:[{ps:[O]}],pe:[{pe:[O]}],pt:[{pt:[O]}],pr:[{pr:[O]}],pb:[{pb:[O]}],pl:[{pl:[O]}],m:[{m:[I]}],mx:[{mx:[I]}],my:[{my:[I]}],ms:[{ms:[I]}],me:[{me:[I]}],mt:[{mt:[I]}],mr:[{mr:[I]}],mb:[{mb:[I]}],ml:[{ml:[I]}],"space-x":[{"space-x":[G]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[G]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",qr,t]}],"min-w":[{"min-w":["min","max","fit",qr,Ns]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Pu]},Pu,qr]}],h:[{h:[qr,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",qr,Ns]}],"max-h":[{"max-h":[qr,t,"min","max","fit"]}],"font-size":[{text:["base",Pu,rA]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",W_]}],"font-family":[{font:[yv]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",qr]}],"line-clamp":[{"line-clamp":["none",$h,W_]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",qr,Ns]}],"list-image":[{"list-image":["none",qr]}],"list-style-type":[{list:["none","disc","decimal",qr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[B]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[B]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(ce(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Ns]}],"underline-offset":[{"underline-offset":["auto",qr,Ns]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:ae()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",qr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",qr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[B]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(xe(),[mne])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",pne]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},gne]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[k]}],"gradient-via-pos":[{via:[k]}],"gradient-to-pos":[{to:[k]}],"gradient-from":[{from:[C]}],"gradient-via":[{via:[C]}],"gradient-to":[{to:[C]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[i]}],"border-w-x":[{"border-x":[i]}],"border-w-y":[{"border-y":[i]}],"border-w-s":[{"border-s":[i]}],"border-w-e":[{"border-e":[i]}],"border-w-t":[{"border-t":[i]}],"border-w-r":[{"border-r":[i]}],"border-w-b":[{"border-b":[i]}],"border-w-l":[{"border-l":[i]}],"border-opacity":[{"border-opacity":[B]}],"border-style":[{border:[].concat(ce(),["hidden"])}],"divide-x":[{"divide-x":[i]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[i]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[B]}],"divide-style":[{divide:ce()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:[""].concat(ce())}],"outline-offset":[{"outline-offset":[qr,Ns]}],"outline-w":[{outline:[Ns]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:_e()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[B]}],"ring-offset-w":[{"ring-offset":[Ns]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Pu,vne]}],"shadow-color":[{shadow:[yv]}],opacity:[{opacity:[B]}],"mix-blend":[{"mix-blend":ke()}],"bg-blend":[{"bg-blend":ke()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[p]}],"drop-shadow":[{"drop-shadow":["","none",Pu,qr]}],grayscale:[{grayscale:[y]}],"hue-rotate":[{"hue-rotate":[b]}],invert:[{invert:[_]}],saturate:[{saturate:[R]}],sepia:[{sepia:[F]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[p]}],"backdrop-grayscale":[{"backdrop-grayscale":[y]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[b]}],"backdrop-invert":[{"backdrop-invert":[_]}],"backdrop-opacity":[{"backdrop-opacity":[B]}],"backdrop-saturate":[{"backdrop-saturate":[R]}],"backdrop-sepia":[{"backdrop-sepia":[F]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",qr]}],duration:[{duration:Fe()}],ease:[{ease:["linear","in","out","in-out",qr]}],delay:[{delay:Fe()}],animate:[{animate:["none","spin","ping","pulse","bounce",qr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[q]}],"scale-x":[{"scale-x":[q]}],"scale-y":[{"scale-y":[q]}],rotate:[{rotate:[gv,qr]}],"translate-x":[{"translate-x":[ee]}],"translate-y":[{"translate-y":[ee]}],"skew-x":[{"skew-x":[X]}],"skew-y":[{"skew-y":[X]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",qr]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",qr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ae()}],"scroll-mx":[{"scroll-mx":ae()}],"scroll-my":[{"scroll-my":ae()}],"scroll-ms":[{"scroll-ms":ae()}],"scroll-me":[{"scroll-me":ae()}],"scroll-mt":[{"scroll-mt":ae()}],"scroll-mr":[{"scroll-mr":ae()}],"scroll-mb":[{"scroll-mb":ae()}],"scroll-ml":[{"scroll-ml":ae()}],"scroll-p":[{"scroll-p":ae()}],"scroll-px":[{"scroll-px":ae()}],"scroll-py":[{"scroll-py":ae()}],"scroll-ps":[{"scroll-ps":ae()}],"scroll-pe":[{"scroll-pe":ae()}],"scroll-pt":[{"scroll-pt":ae()}],"scroll-pr":[{"scroll-pr":ae()}],"scroll-pb":[{"scroll-pb":ae()}],"scroll-pl":[{"scroll-pl":ae()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",qr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Ns,W_]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var Sne=lne(wne);function Cr(...e){return Sne(Zr(e))}function Ht(e,t,{checkForDefaultPrevented:r=!0}={}){return function(o){if(e==null||e(o),r===!1||!o.defaultPrevented)return t==null?void 0:t(o)}}function V3(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function c2(...e){return t=>{let r=!1;const n=e.map(o=>{const s=V3(o,t);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let o=0;o<n.length;o++){const s=n[o];typeof s=="function"?s():V3(e[o],null)}}}}function Kr(...e){return D.useCallback(c2(...e),e)}function Ene(e,t){const r=D.createContext(t),n=s=>{const{children:h,...i}=s,p=D.useMemo(()=>i,Object.values(i));return c.jsx(r.Provider,{value:p,children:h})};n.displayName=e+"Provider";function o(s){const h=D.useContext(r);if(h)return h;if(t!==void 0)return t;throw new Error(`\`${s}\` must be used within \`${e}\``)}return[n,o]}function as(e,t=[]){let r=[];function n(s,h){const i=D.createContext(h),p=r.length;r=[...r,h];const y=_=>{var B;const{scope:E,children:C,...k}=_,N=((B=E==null?void 0:E[e])==null?void 0:B[p])||i,I=D.useMemo(()=>k,Object.values(k));return c.jsx(N.Provider,{value:I,children:C})};y.displayName=s+"Provider";function b(_,E){var N;const C=((N=E==null?void 0:E[e])==null?void 0:N[p])||i,k=D.useContext(C);if(k)return k;if(h!==void 0)return h;throw new Error(`\`${_}\` must be used within \`${s}\``)}return[y,b]}const o=()=>{const s=r.map(h=>D.createContext(h));return function(i){const p=(i==null?void 0:i[e])||s;return D.useMemo(()=>({[`__scope${e}`]:{...i,[e]:p}}),[i,p])}};return o.scopeName=e,[n,Tne(o,...t)]}function Tne(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const h=n.reduce((i,{useScope:p,scopeName:y})=>{const _=p(s)[`__scope${y}`];return{...i,..._}},{});return D.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}function tf(e){const t=Cne(e),r=D.forwardRef((n,o)=>{const{children:s,...h}=n,i=D.Children.toArray(s),p=i.find(Ane);if(p){const y=p.props.children,b=i.map(_=>_===p?D.Children.count(y)>1?D.Children.only(null):D.isValidElement(y)?y.props.children:null:_);return c.jsx(t,{...h,ref:o,children:D.isValidElement(y)?D.cloneElement(y,void 0,b):null})}return c.jsx(t,{...h,ref:o,children:s})});return r.displayName=`${e}.Slot`,r}var jne=tf("Slot");function Cne(e){const t=D.forwardRef((r,n)=>{const{children:o,...s}=r;if(D.isValidElement(o)){const h=Nne(o),i=kne(s,o.props);return o.type!==D.Fragment&&(i.ref=n?c2(n,h):h),D.cloneElement(o,i)}return D.Children.count(o)>1?D.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Pne=Symbol("radix.slottable");function Ane(e){return D.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Pne}function kne(e,t){const r={...t};for(const n in t){const o=e[n],s=t[n];/^on[A-Z]/.test(n)?o&&s?r[n]=(...i)=>{const p=s(...i);return o(...i),p}:o&&(r[n]=o):n==="style"?r[n]={...o,...s}:n==="className"&&(r[n]=[o,s].filter(Boolean).join(" "))}return{...e,...r}}function Nne(e){var n,o;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function u2(e){const t=e+"CollectionProvider",[r,n]=as(t),[o,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),h=N=>{const{scope:I,children:B}=N,O=je.useRef(null),R=je.useRef(new Map).current;return c.jsx(o,{scope:I,itemMap:R,collectionRef:O,children:B})};h.displayName=t;const i=e+"CollectionSlot",p=tf(i),y=je.forwardRef((N,I)=>{const{scope:B,children:O}=N,R=s(i,B),q=Kr(I,R.collectionRef);return c.jsx(p,{ref:q,children:O})});y.displayName=i;const b=e+"CollectionItemSlot",_="data-radix-collection-item",E=tf(b),C=je.forwardRef((N,I)=>{const{scope:B,children:O,...R}=N,q=je.useRef(null),F=Kr(I,q),X=s(b,B);return je.useEffect(()=>(X.itemMap.set(q,{ref:q,...R}),()=>void X.itemMap.delete(q))),c.jsx(E,{[_]:"",ref:F,children:O})});C.displayName=b;function k(N){const I=s(e+"CollectionConsumer",N);return je.useCallback(()=>{const O=I.collectionRef.current;if(!O)return[];const R=Array.from(O.querySelectorAll(`[${_}]`));return Array.from(I.itemMap.values()).sort((X,G)=>R.indexOf(X.ref.current)-R.indexOf(G.ref.current))},[I.collectionRef,I.itemMap])}return[{Provider:h,Slot:y,ItemSlot:C},k,n]}var Mne=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],fr=Mne.reduce((e,t)=>{const r=tf(`Primitive.${t}`),n=D.forwardRef((o,s)=>{const{asChild:h,...i}=o,p=h?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(p,{...i,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function xM(e,t){e&&Uc.flushSync(()=>e.dispatchEvent(t))}function aa(e){const t=D.useRef(e);return D.useEffect(()=>{t.current=e}),D.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Ine(e,t=globalThis==null?void 0:globalThis.document){const r=aa(e);D.useEffect(()=>{const n=o=>{o.key==="Escape"&&r(o)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var One="DismissableLayer",nA="dismissableLayer.update",Dne="dismissableLayer.pointerDownOutside",Rne="dismissableLayer.focusOutside",q3,i8=D.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Nb=D.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:o,onFocusOutside:s,onInteractOutside:h,onDismiss:i,...p}=e,y=D.useContext(i8),[b,_]=D.useState(null),E=(b==null?void 0:b.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,C]=D.useState({}),k=Kr(t,G=>_(G)),N=Array.from(y.layers),[I]=[...y.layersWithOutsidePointerEventsDisabled].slice(-1),B=N.indexOf(I),O=b?N.indexOf(b):-1,R=y.layersWithOutsidePointerEventsDisabled.size>0,q=O>=B,F=Bne(G=>{const ee=G.target,K=[...y.branches].some(ie=>ie.contains(ee));!q||K||(o==null||o(G),h==null||h(G),G.defaultPrevented||i==null||i())},E),X=zne(G=>{const ee=G.target;[...y.branches].some(ie=>ie.contains(ee))||(s==null||s(G),h==null||h(G),G.defaultPrevented||i==null||i())},E);return Ine(G=>{O===y.layers.size-1&&(n==null||n(G),!G.defaultPrevented&&i&&(G.preventDefault(),i()))},E),D.useEffect(()=>{if(b)return r&&(y.layersWithOutsidePointerEventsDisabled.size===0&&(q3=E.body.style.pointerEvents,E.body.style.pointerEvents="none"),y.layersWithOutsidePointerEventsDisabled.add(b)),y.layers.add(b),W3(),()=>{r&&y.layersWithOutsidePointerEventsDisabled.size===1&&(E.body.style.pointerEvents=q3)}},[b,E,r,y]),D.useEffect(()=>()=>{b&&(y.layers.delete(b),y.layersWithOutsidePointerEventsDisabled.delete(b),W3())},[b,y]),D.useEffect(()=>{const G=()=>C({});return document.addEventListener(nA,G),()=>document.removeEventListener(nA,G)},[]),c.jsx(fr.div,{...p,ref:k,style:{pointerEvents:R?q?"auto":"none":void 0,...e.style},onFocusCapture:Ht(e.onFocusCapture,X.onFocusCapture),onBlurCapture:Ht(e.onBlurCapture,X.onBlurCapture),onPointerDownCapture:Ht(e.onPointerDownCapture,F.onPointerDownCapture)})});Nb.displayName=One;var Lne="DismissableLayerBranch",o8=D.forwardRef((e,t)=>{const r=D.useContext(i8),n=D.useRef(null),o=Kr(t,n);return D.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),c.jsx(fr.div,{...e,ref:o})});o8.displayName=Lne;function Bne(e,t=globalThis==null?void 0:globalThis.document){const r=aa(e),n=D.useRef(!1),o=D.useRef(()=>{});return D.useEffect(()=>{const s=i=>{if(i.target&&!n.current){let p=function(){a8(Dne,r,y,{discrete:!0})};const y={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=p,t.addEventListener("click",o.current,{once:!0})):p()}else t.removeEventListener("click",o.current);n.current=!1},h=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(h),t.removeEventListener("pointerdown",s),t.removeEventListener("click",o.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function zne(e,t=globalThis==null?void 0:globalThis.document){const r=aa(e),n=D.useRef(!1);return D.useEffect(()=>{const o=s=>{s.target&&!n.current&&a8(Rne,r,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function W3(){const e=new CustomEvent(nA);document.dispatchEvent(e)}function a8(e,t,r,{discrete:n}){const o=r.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&o.addEventListener(e,t,{once:!0}),n?xM(o,s):o.dispatchEvent(s)}var $ne=Nb,Fne=o8,so=globalThis!=null&&globalThis.document?D.useLayoutEffect:()=>{},Une="Portal",d2=D.forwardRef((e,t)=>{var i;const{container:r,...n}=e,[o,s]=D.useState(!1);so(()=>s(!0),[]);const h=r||o&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return h?Hte.createPortal(c.jsx(fr.div,{...n,ref:t}),h):null});d2.displayName=Une;function Vne(e,t){return D.useReducer((r,n)=>t[r][n]??r,e)}var Ol=e=>{const{present:t,children:r}=e,n=qne(t),o=typeof r=="function"?r({present:n.isPresent}):D.Children.only(r),s=Kr(n.ref,Wne(o));return typeof r=="function"||n.isPresent?D.cloneElement(o,{ref:s}):null};Ol.displayName="Presence";function qne(e){const[t,r]=D.useState(),n=D.useRef(null),o=D.useRef(e),s=D.useRef("none"),h=e?"mounted":"unmounted",[i,p]=Vne(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return D.useEffect(()=>{const y=G_(n.current);s.current=i==="mounted"?y:"none"},[i]),so(()=>{const y=n.current,b=o.current;if(b!==e){const E=s.current,C=G_(y);e?p("MOUNT"):C==="none"||(y==null?void 0:y.display)==="none"?p("UNMOUNT"):p(b&&E!==C?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,p]),so(()=>{if(t){let y;const b=t.ownerDocument.defaultView??window,_=C=>{const N=G_(n.current).includes(C.animationName);if(C.target===t&&N&&(p("ANIMATION_END"),!o.current)){const I=t.style.animationFillMode;t.style.animationFillMode="forwards",y=b.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=I)})}},E=C=>{C.target===t&&(s.current=G_(n.current))};return t.addEventListener("animationstart",E),t.addEventListener("animationcancel",_),t.addEventListener("animationend",_),()=>{b.clearTimeout(y),t.removeEventListener("animationstart",E),t.removeEventListener("animationcancel",_),t.removeEventListener("animationend",_)}}else p("ANIMATION_END")},[t,p]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:D.useCallback(y=>{n.current=y?getComputedStyle(y):null,r(y)},[])}}function G_(e){return(e==null?void 0:e.animationName)||"none"}function Wne(e){var n,o;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Gne=SN[" useInsertionEffect ".trim().toString()]||so;function Nc({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[o,s,h]=Hne({defaultProp:t,onChange:r}),i=e!==void 0,p=i?e:o;{const b=D.useRef(e!==void 0);D.useEffect(()=>{const _=b.current;_!==i&&console.warn(`${n} is changing from ${_?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),b.current=i},[i,n])}const y=D.useCallback(b=>{var _;if(i){const E=Xne(b)?b(e):b;E!==e&&((_=h.current)==null||_.call(h,E))}else s(b)},[i,e,s,h]);return[p,y]}function Hne({defaultProp:e,onChange:t}){const[r,n]=D.useState(e),o=D.useRef(r),s=D.useRef(t);return Gne(()=>{s.current=t},[t]),D.useEffect(()=>{var h;o.current!==r&&((h=s.current)==null||h.call(s,r),o.current=r)},[r,o]),[r,n,s]}function Xne(e){return typeof e=="function"}var s8=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Zne="VisuallyHidden",bM=D.forwardRef((e,t)=>c.jsx(fr.span,{...e,ref:t,style:{...s8,...e.style}}));bM.displayName=Zne;var _M="ToastProvider",[wM,Kne,Yne]=u2("Toast"),[l8,OUe]=as("Toast",[Yne]),[Jne,h2]=l8(_M),c8=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:o="right",swipeThreshold:s=50,children:h}=e,[i,p]=D.useState(null),[y,b]=D.useState(0),_=D.useRef(!1),E=D.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${_M}\`. Expected non-empty \`string\`.`),c.jsx(wM.Provider,{scope:t,children:c.jsx(Jne,{scope:t,label:r,duration:n,swipeDirection:o,swipeThreshold:s,toastCount:y,viewport:i,onViewportChange:p,onToastAdd:D.useCallback(()=>b(C=>C+1),[]),onToastRemove:D.useCallback(()=>b(C=>C-1),[]),isFocusedToastEscapeKeyDownRef:_,isClosePausedRef:E,children:h})})};c8.displayName=_M;var u8="ToastViewport",Qne=["F8"],iA="toast.viewportPause",oA="toast.viewportResume",d8=D.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=Qne,label:o="Notifications ({hotkey})",...s}=e,h=h2(u8,r),i=Kne(r),p=D.useRef(null),y=D.useRef(null),b=D.useRef(null),_=D.useRef(null),E=Kr(t,_,h.onViewportChange),C=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),k=h.toastCount>0;D.useEffect(()=>{const I=B=>{var R;n.length!==0&&n.every(q=>B[q]||B.code===q)&&((R=_.current)==null||R.focus())};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[n]),D.useEffect(()=>{const I=p.current,B=_.current;if(k&&I&&B){const O=()=>{if(!h.isClosePausedRef.current){const X=new CustomEvent(iA);B.dispatchEvent(X),h.isClosePausedRef.current=!0}},R=()=>{if(h.isClosePausedRef.current){const X=new CustomEvent(oA);B.dispatchEvent(X),h.isClosePausedRef.current=!1}},q=X=>{!I.contains(X.relatedTarget)&&R()},F=()=>{I.contains(document.activeElement)||R()};return I.addEventListener("focusin",O),I.addEventListener("focusout",q),I.addEventListener("pointermove",O),I.addEventListener("pointerleave",F),window.addEventListener("blur",O),window.addEventListener("focus",R),()=>{I.removeEventListener("focusin",O),I.removeEventListener("focusout",q),I.removeEventListener("pointermove",O),I.removeEventListener("pointerleave",F),window.removeEventListener("blur",O),window.removeEventListener("focus",R)}}},[k,h.isClosePausedRef]);const N=D.useCallback(({tabbingDirection:I})=>{const O=i().map(R=>{const q=R.ref.current,F=[q,...hie(q)];return I==="forwards"?F:F.reverse()});return(I==="forwards"?O.reverse():O).flat()},[i]);return D.useEffect(()=>{const I=_.current;if(I){const B=O=>{var F,X,G;const R=O.altKey||O.ctrlKey||O.metaKey;if(O.key==="Tab"&&!R){const ee=document.activeElement,K=O.shiftKey;if(O.target===I&&K){(F=y.current)==null||F.focus();return}const ae=N({tabbingDirection:K?"backwards":"forwards"}),_e=ae.findIndex(Ee=>Ee===ee);Wj(ae.slice(_e+1))?O.preventDefault():K?(X=y.current)==null||X.focus():(G=b.current)==null||G.focus()}};return I.addEventListener("keydown",B),()=>I.removeEventListener("keydown",B)}},[i,N]),c.jsxs(Fne,{ref:p,role:"region","aria-label":o.replace("{hotkey}",C),tabIndex:-1,style:{pointerEvents:k?void 0:"none"},children:[k&&c.jsx(aA,{ref:y,onFocusFromOutsideViewport:()=>{const I=N({tabbingDirection:"forwards"});Wj(I)}}),c.jsx(wM.Slot,{scope:r,children:c.jsx(fr.ol,{tabIndex:-1,...s,ref:E})}),k&&c.jsx(aA,{ref:b,onFocusFromOutsideViewport:()=>{const I=N({tabbingDirection:"backwards"});Wj(I)}})]})});d8.displayName=u8;var h8="ToastFocusProxy",aA=D.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...o}=e,s=h2(h8,r);return c.jsx(bM,{"aria-hidden":!0,tabIndex:0,...o,ref:t,style:{position:"fixed"},onFocus:h=>{var y;const i=h.relatedTarget;!((y=s.viewport)!=null&&y.contains(i))&&n()}})});aA.displayName=h8;var Mb="Toast",eie="toast.swipeStart",tie="toast.swipeMove",rie="toast.swipeCancel",nie="toast.swipeEnd",f8=D.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:o,onOpenChange:s,...h}=e,[i,p]=Nc({prop:n,defaultProp:o??!0,onChange:s,caller:Mb});return c.jsx(Ol,{present:r||i,children:c.jsx(aie,{open:i,...h,ref:t,onClose:()=>p(!1),onPause:aa(e.onPause),onResume:aa(e.onResume),onSwipeStart:Ht(e.onSwipeStart,y=>{y.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Ht(e.onSwipeMove,y=>{const{x:b,y:_}=y.detail.delta;y.currentTarget.setAttribute("data-swipe","move"),y.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${b}px`),y.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${_}px`)}),onSwipeCancel:Ht(e.onSwipeCancel,y=>{y.currentTarget.setAttribute("data-swipe","cancel"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),y.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),y.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Ht(e.onSwipeEnd,y=>{const{x:b,y:_}=y.detail.delta;y.currentTarget.setAttribute("data-swipe","end"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),y.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${b}px`),y.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${_}px`),p(!1)})})})});f8.displayName=Mb;var[iie,oie]=l8(Mb,{onClose(){}}),aie=D.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:o,open:s,onClose:h,onEscapeKeyDown:i,onPause:p,onResume:y,onSwipeStart:b,onSwipeMove:_,onSwipeCancel:E,onSwipeEnd:C,...k}=e,N=h2(Mb,r),[I,B]=D.useState(null),O=Kr(t,Ee=>B(Ee)),R=D.useRef(null),q=D.useRef(null),F=o||N.duration,X=D.useRef(0),G=D.useRef(F),ee=D.useRef(0),{onToastAdd:K,onToastRemove:ie}=N,pe=aa(()=>{var xe;(I==null?void 0:I.contains(document.activeElement))&&((xe=N.viewport)==null||xe.focus()),h()}),ae=D.useCallback(Ee=>{!Ee||Ee===1/0||(window.clearTimeout(ee.current),X.current=new Date().getTime(),ee.current=window.setTimeout(pe,Ee))},[pe]);D.useEffect(()=>{const Ee=N.viewport;if(Ee){const xe=()=>{ae(G.current),y==null||y()},ce=()=>{const ke=new Date().getTime()-X.current;G.current=G.current-ke,window.clearTimeout(ee.current),p==null||p()};return Ee.addEventListener(iA,ce),Ee.addEventListener(oA,xe),()=>{Ee.removeEventListener(iA,ce),Ee.removeEventListener(oA,xe)}}},[N.viewport,F,p,y,ae]),D.useEffect(()=>{s&&!N.isClosePausedRef.current&&ae(F)},[s,F,N.isClosePausedRef,ae]),D.useEffect(()=>(K(),()=>ie()),[K,ie]);const _e=D.useMemo(()=>I?b8(I):null,[I]);return N.viewport?c.jsxs(c.Fragment,{children:[_e&&c.jsx(sie,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:_e}),c.jsx(iie,{scope:r,onClose:pe,children:Uc.createPortal(c.jsx(wM.ItemSlot,{scope:r,children:c.jsx($ne,{asChild:!0,onEscapeKeyDown:Ht(i,()=>{N.isFocusedToastEscapeKeyDownRef.current||pe(),N.isFocusedToastEscapeKeyDownRef.current=!1}),children:c.jsx(fr.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":N.swipeDirection,...k,ref:O,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Ht(e.onKeyDown,Ee=>{Ee.key==="Escape"&&(i==null||i(Ee.nativeEvent),Ee.nativeEvent.defaultPrevented||(N.isFocusedToastEscapeKeyDownRef.current=!0,pe()))}),onPointerDown:Ht(e.onPointerDown,Ee=>{Ee.button===0&&(R.current={x:Ee.clientX,y:Ee.clientY})}),onPointerMove:Ht(e.onPointerMove,Ee=>{if(!R.current)return;const xe=Ee.clientX-R.current.x,ce=Ee.clientY-R.current.y,ke=!!q.current,ve=["left","right"].includes(N.swipeDirection),Pe=["left","up"].includes(N.swipeDirection)?Math.min:Math.max,Re=ve?Pe(0,xe):0,Be=ve?0:Pe(0,ce),Fe=Ee.pointerType==="touch"?10:2,Ge={x:Re,y:Be},Pt={originalEvent:Ee,delta:Ge};ke?(q.current=Ge,H_(tie,_,Pt,{discrete:!1})):G3(Ge,N.swipeDirection,Fe)?(q.current=Ge,H_(eie,b,Pt,{discrete:!1}),Ee.target.setPointerCapture(Ee.pointerId)):(Math.abs(xe)>Fe||Math.abs(ce)>Fe)&&(R.current=null)}),onPointerUp:Ht(e.onPointerUp,Ee=>{const xe=q.current,ce=Ee.target;if(ce.hasPointerCapture(Ee.pointerId)&&ce.releasePointerCapture(Ee.pointerId),q.current=null,R.current=null,xe){const ke=Ee.currentTarget,ve={originalEvent:Ee,delta:xe};G3(xe,N.swipeDirection,N.swipeThreshold)?H_(nie,C,ve,{discrete:!0}):H_(rie,E,ve,{discrete:!0}),ke.addEventListener("click",Pe=>Pe.preventDefault(),{once:!0})}})})})}),N.viewport)})]}):null}),sie=e=>{const{__scopeToast:t,children:r,...n}=e,o=h2(Mb,t),[s,h]=D.useState(!1),[i,p]=D.useState(!1);return uie(()=>h(!0)),D.useEffect(()=>{const y=window.setTimeout(()=>p(!0),1e3);return()=>window.clearTimeout(y)},[]),i?null:c.jsx(d2,{asChild:!0,children:c.jsx(bM,{...n,children:s&&c.jsxs(c.Fragment,{children:[o.label," ",r]})})})},lie="ToastTitle",p8=D.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return c.jsx(fr.div,{...n,ref:t})});p8.displayName=lie;var cie="ToastDescription",m8=D.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return c.jsx(fr.div,{...n,ref:t})});m8.displayName=cie;var g8="ToastAction",y8=D.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?c.jsx(x8,{altText:r,asChild:!0,children:c.jsx(SM,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${g8}\`. Expected non-empty \`string\`.`),null)});y8.displayName=g8;var v8="ToastClose",SM=D.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,o=oie(v8,r);return c.jsx(x8,{asChild:!0,children:c.jsx(fr.button,{type:"button",...n,ref:t,onClick:Ht(e.onClick,o.onClose)})})});SM.displayName=v8;var x8=D.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...o}=e;return c.jsx(fr.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...o,ref:t})});function b8(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),die(n)){const o=n.ariaHidden||n.hidden||n.style.display==="none",s=n.dataset.radixToastAnnounceExclude==="";if(!o)if(s){const h=n.dataset.radixToastAnnounceAlt;h&&t.push(h)}else t.push(...b8(n))}}),t}function H_(e,t,r,{discrete:n}){const o=r.originalEvent.currentTarget,s=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&o.addEventListener(e,t,{once:!0}),n?xM(o,s):o.dispatchEvent(s)}var G3=(e,t,r=0)=>{const n=Math.abs(e.x),o=Math.abs(e.y),s=n>o;return t==="left"||t==="right"?s&&n>r:!s&&o>r};function uie(e=()=>{}){const t=aa(e);so(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function die(e){return e.nodeType===e.ELEMENT_NODE}function hie(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Wj(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var fie=c8,_8=d8,w8=f8,S8=p8,E8=m8,T8=y8,j8=SM;const H3=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,X3=Zr,f2=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return X3(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:o,defaultVariants:s}=t,h=Object.keys(o).map(y=>{const b=r==null?void 0:r[y],_=s==null?void 0:s[y];if(b===null)return null;const E=H3(b)||H3(_);return o[y][E]}),i=r&&Object.entries(r).reduce((y,b)=>{let[_,E]=b;return E===void 0||(y[_]=E),y},{}),p=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((y,b)=>{let{class:_,className:E,...C}=b;return Object.entries(C).every(k=>{let[N,I]=k;return Array.isArray(I)?I.includes({...s,...i}[N]):{...s,...i}[N]===I})?[...y,_,E]:y},[]);return X3(e,h,p,r==null?void 0:r.class,r==null?void 0:r.className)};var pie={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const mie=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Gt=(e,t)=>{const r=D.forwardRef(({color:n="currentColor",size:o=24,strokeWidth:s=2,absoluteStrokeWidth:h,children:i,...p},y)=>D.createElement("svg",{ref:y,...pie,width:o,height:o,stroke:n,strokeWidth:h?Number(s)*24/Number(o):s,className:`lucide lucide-${mie(e)}`,...p},[...t.map(([b,_])=>D.createElement(b,_)),...(Array.isArray(i)?i:[i])||[]]));return r.displayName=`${e}`,r},Z3=Gt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),EM=Gt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),gie=Gt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),TM=Gt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),jl=Gt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),yie=Gt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),K3=Gt("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),jM=Gt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Y3=Gt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Mc=Gt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),vie=Gt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),xie=Gt("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),Lo=Gt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Dx=Gt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),v1=Gt("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),C8=Gt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),bie=Gt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),_ie=Gt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),wie=Gt("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]),wd=Gt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Sie=Gt("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]),Eie=Gt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),rf=Gt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Tie=Gt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),J3=Gt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),x1=Gt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Q3=Gt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),jie=Gt("FilterX",[["path",{d:"M13.013 3H2l8 9.46V19l4 2v-8.54l.9-1.055",key:"1fi1da"}],["path",{d:"m22 3-5 5",key:"12jva0"}],["path",{d:"m17 3 5 5",key:"k36vhe"}]]),Cie=Gt("Gem",[["path",{d:"M6 3h12l4 6-10 13L2 9Z",key:"1pcd5k"}],["path",{d:"M11 3 8 9l4 13 4-13-3-6",key:"1fcu3u"}],["path",{d:"M2 9h20",key:"16fsjt"}]]),Pie=Gt("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),Aie=Gt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),Rx=Gt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),e4=Gt("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),t4=Gt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),sA=Gt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),kie=Gt("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Nie=Gt("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),b1=Gt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),lA=Gt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),nf=Gt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),oa=Gt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Mie=Gt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Iie=Gt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),P8=Gt("Music2",[["circle",{cx:"8",cy:"18",r:"4",key:"1fc0mg"}],["path",{d:"M12 18V2l7 4",key:"g04rme"}]]),A8=Gt("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),r4=Gt("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),Oie=Gt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),of=Gt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),CM=Gt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),k8=Gt("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),Die=Gt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),n4=Gt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Tm=Gt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ex=Gt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Xs=Gt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Rie=Gt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),cA=Gt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),_1=Gt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Lie=Gt("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),sa=Gt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),dd=Gt("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),uA=Gt("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]),N8=Gt("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Bie=Gt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),zie=Gt("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]),PM=Gt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),p2=Gt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),$ie=Gt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Fie=Gt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),ji=Gt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Bi=Gt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),m2=Gt("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]),w1=Gt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ib=Gt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),M8=Gt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Uie=fie,I8=je.forwardRef(({className:e,...t},r)=>c.jsx(_8,{ref:r,className:Cr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));I8.displayName=_8.displayName;const Vie=f2("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),O8=je.forwardRef(({className:e,variant:t,...r},n)=>c.jsx(w8,{ref:n,className:Cr(Vie({variant:t}),e),...r}));O8.displayName=w8.displayName;const qie=je.forwardRef(({className:e,...t},r)=>c.jsx(T8,{ref:r,className:Cr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));qie.displayName=T8.displayName;const D8=je.forwardRef(({className:e,...t},r)=>c.jsx(j8,{ref:r,className:Cr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:c.jsx(Ib,{className:"h-4 w-4"})}));D8.displayName=j8.displayName;const R8=je.forwardRef(({className:e,...t},r)=>c.jsx(S8,{ref:r,className:Cr("text-sm font-semibold",e),...t}));R8.displayName=S8.displayName;const L8=je.forwardRef(({className:e,...t},r)=>c.jsx(E8,{ref:r,className:Cr("text-sm opacity-90",e),...t}));L8.displayName=E8.displayName;const Wie=1;let Gj=0;function Gie(){return Gj=(Gj+1)%Number.MAX_VALUE,Gj.toString()}const Mo={state:{toasts:[]},listeners:[],getState:()=>Mo.state,setState:e=>{typeof e=="function"?Mo.state=e(Mo.state):Mo.state={...Mo.state,...e},Mo.listeners.forEach(t=>t(Mo.state))},subscribe:e=>(Mo.listeners.push(e),()=>{Mo.listeners=Mo.listeners.filter(t=>t!==e)})},Mr=({...e})=>{const t=Gie(),r=o=>Mo.setState(s=>({...s,toasts:s.toasts.map(h=>h.id===t?{...h,...o}:h)})),n=()=>Mo.setState(o=>({...o,toasts:o.toasts.filter(s=>s.id!==t)}));return Mo.setState(o=>({...o,toasts:[{...e,id:t,dismiss:n},...o.toasts].slice(0,Wie)})),{id:t,dismiss:n,update:r}};function Co(){const[e,t]=D.useState(Mo.getState());return D.useEffect(()=>Mo.subscribe(n=>{t(n)}),[]),D.useEffect(()=>{const r=[];return e.toasts.forEach(n=>{if(n.duration===1/0)return;const o=setTimeout(()=>{n.dismiss()},n.duration||5e3);r.push(o)}),()=>{r.forEach(n=>clearTimeout(n))}},[e.toasts]),{toast:Mr,toasts:e.toasts}}function Hie(){const{toasts:e}=Co();return c.jsxs(Uie,{children:[e.map(({id:t,title:r,description:n,action:o,...s})=>c.jsxs(O8,{...s,children:[c.jsxs("div",{className:"grid gap-1",children:[r&&c.jsx(R8,{children:r}),n&&c.jsx(L8,{children:n})]}),o,c.jsx(D8,{})]},t)),c.jsx(I8,{})]})}const Xie=f2("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Et=je.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...o},s)=>{const h=n?jne:"button";return c.jsx(h,{className:Cr(Xie({variant:t,size:r,className:e})),ref:s,...o})});Et.displayName="Button";var Zie=D.createContext(void 0);function Ob(e){const t=D.useContext(Zie);return e||t||"ltr"}var Hj=0;function AM(){D.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??i4()),document.body.insertAdjacentElement("beforeend",e[1]??i4()),Hj++,()=>{Hj===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Hj--}},[])}function i4(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Xj="focusScope.autoFocusOnMount",Zj="focusScope.autoFocusOnUnmount",o4={bubbles:!1,cancelable:!0},Kie="FocusScope",g2=D.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:o,onUnmountAutoFocus:s,...h}=e,[i,p]=D.useState(null),y=aa(o),b=aa(s),_=D.useRef(null),E=Kr(t,N=>p(N)),C=D.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;D.useEffect(()=>{if(n){let N=function(R){if(C.paused||!i)return;const q=R.target;i.contains(q)?_.current=q:ku(_.current,{select:!0})},I=function(R){if(C.paused||!i)return;const q=R.relatedTarget;q!==null&&(i.contains(q)||ku(_.current,{select:!0}))},B=function(R){if(document.activeElement===document.body)for(const F of R)F.removedNodes.length>0&&ku(i)};document.addEventListener("focusin",N),document.addEventListener("focusout",I);const O=new MutationObserver(B);return i&&O.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",N),document.removeEventListener("focusout",I),O.disconnect()}}},[n,i,C.paused]),D.useEffect(()=>{if(i){s4.add(C);const N=document.activeElement;if(!i.contains(N)){const B=new CustomEvent(Xj,o4);i.addEventListener(Xj,y),i.dispatchEvent(B),B.defaultPrevented||(Yie(roe(B8(i)),{select:!0}),document.activeElement===N&&ku(i))}return()=>{i.removeEventListener(Xj,y),setTimeout(()=>{const B=new CustomEvent(Zj,o4);i.addEventListener(Zj,b),i.dispatchEvent(B),B.defaultPrevented||ku(N??document.body,{select:!0}),i.removeEventListener(Zj,b),s4.remove(C)},0)}}},[i,y,b,C]);const k=D.useCallback(N=>{if(!r&&!n||C.paused)return;const I=N.key==="Tab"&&!N.altKey&&!N.ctrlKey&&!N.metaKey,B=document.activeElement;if(I&&B){const O=N.currentTarget,[R,q]=Jie(O);R&&q?!N.shiftKey&&B===q?(N.preventDefault(),r&&ku(R,{select:!0})):N.shiftKey&&B===R&&(N.preventDefault(),r&&ku(q,{select:!0})):B===O&&N.preventDefault()}},[r,n,C.paused]);return c.jsx(fr.div,{tabIndex:-1,...h,ref:E,onKeyDown:k})});g2.displayName=Kie;function Yie(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(ku(n,{select:t}),document.activeElement!==r)return}function Jie(e){const t=B8(e),r=a4(t,e),n=a4(t.reverse(),e);return[r,n]}function B8(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function a4(e,t){for(const r of e)if(!Qie(r,{upTo:t}))return r}function Qie(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function eoe(e){return e instanceof HTMLInputElement&&"select"in e}function ku(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&eoe(e)&&t&&e.select()}}var s4=toe();function toe(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=l4(e,t),e.unshift(t)},remove(t){var r;e=l4(e,t),(r=e[0])==null||r.resume()}}}function l4(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function roe(e){return e.filter(t=>t.tagName!=="A")}var noe=SN[" useId ".trim().toString()]||(()=>{}),ioe=0;function Cl(e){const[t,r]=D.useState(noe());return so(()=>{e||r(n=>n??String(ioe++))},[e]),e||(t?`radix-${t}`:"")}const ooe=["top","right","bottom","left"],hd=Math.min,wa=Math.max,S1=Math.round,X_=Math.floor,Pl=e=>({x:e,y:e}),aoe={left:"right",right:"left",bottom:"top",top:"bottom"},soe={start:"end",end:"start"};function dA(e,t,r){return wa(e,hd(t,r))}function Ic(e,t){return typeof e=="function"?e(t):e}function Oc(e){return e.split("-")[0]}function sg(e){return e.split("-")[1]}function kM(e){return e==="x"?"y":"x"}function NM(e){return e==="y"?"height":"width"}function wl(e){return["top","bottom"].includes(Oc(e))?"y":"x"}function MM(e){return kM(wl(e))}function loe(e,t,r){r===void 0&&(r=!1);const n=sg(e),o=MM(e),s=NM(o);let h=o==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(h=E1(h)),[h,E1(h)]}function coe(e){const t=E1(e);return[hA(e),t,hA(t)]}function hA(e){return e.replace(/start|end/g,t=>soe[t])}function uoe(e,t,r){const n=["left","right"],o=["right","left"],s=["top","bottom"],h=["bottom","top"];switch(e){case"top":case"bottom":return r?t?o:n:t?n:o;case"left":case"right":return t?s:h;default:return[]}}function doe(e,t,r,n){const o=sg(e);let s=uoe(Oc(e),r==="start",n);return o&&(s=s.map(h=>h+"-"+o),t&&(s=s.concat(s.map(hA)))),s}function E1(e){return e.replace(/left|right|bottom|top/g,t=>aoe[t])}function hoe(e){return{top:0,right:0,bottom:0,left:0,...e}}function z8(e){return typeof e!="number"?hoe(e):{top:e,right:e,bottom:e,left:e}}function T1(e){const{x:t,y:r,width:n,height:o}=e;return{width:n,height:o,top:r,left:t,right:t+n,bottom:r+o,x:t,y:r}}function c4(e,t,r){let{reference:n,floating:o}=e;const s=wl(t),h=MM(t),i=NM(h),p=Oc(t),y=s==="y",b=n.x+n.width/2-o.width/2,_=n.y+n.height/2-o.height/2,E=n[i]/2-o[i]/2;let C;switch(p){case"top":C={x:b,y:n.y-o.height};break;case"bottom":C={x:b,y:n.y+n.height};break;case"right":C={x:n.x+n.width,y:_};break;case"left":C={x:n.x-o.width,y:_};break;default:C={x:n.x,y:n.y}}switch(sg(t)){case"start":C[h]-=E*(r&&y?-1:1);break;case"end":C[h]+=E*(r&&y?-1:1);break}return C}const foe=async(e,t,r)=>{const{placement:n="bottom",strategy:o="absolute",middleware:s=[],platform:h}=r,i=s.filter(Boolean),p=await(h.isRTL==null?void 0:h.isRTL(t));let y=await h.getElementRects({reference:e,floating:t,strategy:o}),{x:b,y:_}=c4(y,n,p),E=n,C={},k=0;for(let N=0;N<i.length;N++){const{name:I,fn:B}=i[N],{x:O,y:R,data:q,reset:F}=await B({x:b,y:_,initialPlacement:n,placement:E,strategy:o,middlewareData:C,rects:y,platform:h,elements:{reference:e,floating:t}});b=O??b,_=R??_,C={...C,[I]:{...C[I],...q}},F&&k<=50&&(k++,typeof F=="object"&&(F.placement&&(E=F.placement),F.rects&&(y=F.rects===!0?await h.getElementRects({reference:e,floating:t,strategy:o}):F.rects),{x:b,y:_}=c4(y,E,p)),N=-1)}return{x:b,y:_,placement:E,strategy:o,middlewareData:C}};async function Lx(e,t){var r;t===void 0&&(t={});const{x:n,y:o,platform:s,rects:h,elements:i,strategy:p}=e,{boundary:y="clippingAncestors",rootBoundary:b="viewport",elementContext:_="floating",altBoundary:E=!1,padding:C=0}=Ic(t,e),k=z8(C),I=i[E?_==="floating"?"reference":"floating":_],B=T1(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(I)))==null||r?I:I.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(i.floating)),boundary:y,rootBoundary:b,strategy:p})),O=_==="floating"?{x:n,y:o,width:h.floating.width,height:h.floating.height}:h.reference,R=await(s.getOffsetParent==null?void 0:s.getOffsetParent(i.floating)),q=await(s.isElement==null?void 0:s.isElement(R))?await(s.getScale==null?void 0:s.getScale(R))||{x:1,y:1}:{x:1,y:1},F=T1(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:O,offsetParent:R,strategy:p}):O);return{top:(B.top-F.top+k.top)/q.y,bottom:(F.bottom-B.bottom+k.bottom)/q.y,left:(B.left-F.left+k.left)/q.x,right:(F.right-B.right+k.right)/q.x}}const poe=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:o,rects:s,platform:h,elements:i,middlewareData:p}=t,{element:y,padding:b=0}=Ic(e,t)||{};if(y==null)return{};const _=z8(b),E={x:r,y:n},C=MM(o),k=NM(C),N=await h.getDimensions(y),I=C==="y",B=I?"top":"left",O=I?"bottom":"right",R=I?"clientHeight":"clientWidth",q=s.reference[k]+s.reference[C]-E[C]-s.floating[k],F=E[C]-s.reference[C],X=await(h.getOffsetParent==null?void 0:h.getOffsetParent(y));let G=X?X[R]:0;(!G||!await(h.isElement==null?void 0:h.isElement(X)))&&(G=i.floating[R]||s.floating[k]);const ee=q/2-F/2,K=G/2-N[k]/2-1,ie=hd(_[B],K),pe=hd(_[O],K),ae=ie,_e=G-N[k]-pe,Ee=G/2-N[k]/2+ee,xe=dA(ae,Ee,_e),ce=!p.arrow&&sg(o)!=null&&Ee!==xe&&s.reference[k]/2-(Ee<ae?ie:pe)-N[k]/2<0,ke=ce?Ee<ae?Ee-ae:Ee-_e:0;return{[C]:E[C]+ke,data:{[C]:xe,centerOffset:Ee-xe-ke,...ce&&{alignmentOffset:ke}},reset:ce}}}),moe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:o,middlewareData:s,rects:h,initialPlacement:i,platform:p,elements:y}=t,{mainAxis:b=!0,crossAxis:_=!0,fallbackPlacements:E,fallbackStrategy:C="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:N=!0,...I}=Ic(e,t);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const B=Oc(o),O=wl(i),R=Oc(i)===i,q=await(p.isRTL==null?void 0:p.isRTL(y.floating)),F=E||(R||!N?[E1(i)]:coe(i)),X=k!=="none";!E&&X&&F.push(...doe(i,N,k,q));const G=[i,...F],ee=await Lx(t,I),K=[];let ie=((n=s.flip)==null?void 0:n.overflows)||[];if(b&&K.push(ee[B]),_){const Ee=loe(o,h,q);K.push(ee[Ee[0]],ee[Ee[1]])}if(ie=[...ie,{placement:o,overflows:K}],!K.every(Ee=>Ee<=0)){var pe,ae;const Ee=(((pe=s.flip)==null?void 0:pe.index)||0)+1,xe=G[Ee];if(xe&&(!(_==="alignment"?O!==wl(xe):!1)||ie.every(ve=>ve.overflows[0]>0&&wl(ve.placement)===O)))return{data:{index:Ee,overflows:ie},reset:{placement:xe}};let ce=(ae=ie.filter(ke=>ke.overflows[0]<=0).sort((ke,ve)=>ke.overflows[1]-ve.overflows[1])[0])==null?void 0:ae.placement;if(!ce)switch(C){case"bestFit":{var _e;const ke=(_e=ie.filter(ve=>{if(X){const Pe=wl(ve.placement);return Pe===O||Pe==="y"}return!0}).map(ve=>[ve.placement,ve.overflows.filter(Pe=>Pe>0).reduce((Pe,Re)=>Pe+Re,0)]).sort((ve,Pe)=>ve[1]-Pe[1])[0])==null?void 0:_e[0];ke&&(ce=ke);break}case"initialPlacement":ce=i;break}if(o!==ce)return{reset:{placement:ce}}}return{}}}};function u4(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function d4(e){return ooe.some(t=>e[t]>=0)}const goe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...o}=Ic(e,t);switch(n){case"referenceHidden":{const s=await Lx(t,{...o,elementContext:"reference"}),h=u4(s,r.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:d4(h)}}}case"escaped":{const s=await Lx(t,{...o,altBoundary:!0}),h=u4(s,r.floating);return{data:{escapedOffsets:h,escaped:d4(h)}}}default:return{}}}}};async function yoe(e,t){const{placement:r,platform:n,elements:o}=e,s=await(n.isRTL==null?void 0:n.isRTL(o.floating)),h=Oc(r),i=sg(r),p=wl(r)==="y",y=["left","top"].includes(h)?-1:1,b=s&&p?-1:1,_=Ic(t,e);let{mainAxis:E,crossAxis:C,alignmentAxis:k}=typeof _=="number"?{mainAxis:_,crossAxis:0,alignmentAxis:null}:{mainAxis:_.mainAxis||0,crossAxis:_.crossAxis||0,alignmentAxis:_.alignmentAxis};return i&&typeof k=="number"&&(C=i==="end"?k*-1:k),p?{x:C*b,y:E*y}:{x:E*y,y:C*b}}const voe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:o,y:s,placement:h,middlewareData:i}=t,p=await yoe(t,e);return h===((r=i.offset)==null?void 0:r.placement)&&(n=i.arrow)!=null&&n.alignmentOffset?{}:{x:o+p.x,y:s+p.y,data:{...p,placement:h}}}}},xoe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:o}=t,{mainAxis:s=!0,crossAxis:h=!1,limiter:i={fn:I=>{let{x:B,y:O}=I;return{x:B,y:O}}},...p}=Ic(e,t),y={x:r,y:n},b=await Lx(t,p),_=wl(Oc(o)),E=kM(_);let C=y[E],k=y[_];if(s){const I=E==="y"?"top":"left",B=E==="y"?"bottom":"right",O=C+b[I],R=C-b[B];C=dA(O,C,R)}if(h){const I=_==="y"?"top":"left",B=_==="y"?"bottom":"right",O=k+b[I],R=k-b[B];k=dA(O,k,R)}const N=i.fn({...t,[E]:C,[_]:k});return{...N,data:{x:N.x-r,y:N.y-n,enabled:{[E]:s,[_]:h}}}}}},boe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:o,rects:s,middlewareData:h}=t,{offset:i=0,mainAxis:p=!0,crossAxis:y=!0}=Ic(e,t),b={x:r,y:n},_=wl(o),E=kM(_);let C=b[E],k=b[_];const N=Ic(i,t),I=typeof N=="number"?{mainAxis:N,crossAxis:0}:{mainAxis:0,crossAxis:0,...N};if(p){const R=E==="y"?"height":"width",q=s.reference[E]-s.floating[R]+I.mainAxis,F=s.reference[E]+s.reference[R]-I.mainAxis;C<q?C=q:C>F&&(C=F)}if(y){var B,O;const R=E==="y"?"width":"height",q=["top","left"].includes(Oc(o)),F=s.reference[_]-s.floating[R]+(q&&((B=h.offset)==null?void 0:B[_])||0)+(q?0:I.crossAxis),X=s.reference[_]+s.reference[R]+(q?0:((O=h.offset)==null?void 0:O[_])||0)-(q?I.crossAxis:0);k<F?k=F:k>X&&(k=X)}return{[E]:C,[_]:k}}}},_oe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:o,rects:s,platform:h,elements:i}=t,{apply:p=()=>{},...y}=Ic(e,t),b=await Lx(t,y),_=Oc(o),E=sg(o),C=wl(o)==="y",{width:k,height:N}=s.floating;let I,B;_==="top"||_==="bottom"?(I=_,B=E===(await(h.isRTL==null?void 0:h.isRTL(i.floating))?"start":"end")?"left":"right"):(B=_,I=E==="end"?"top":"bottom");const O=N-b.top-b.bottom,R=k-b.left-b.right,q=hd(N-b[I],O),F=hd(k-b[B],R),X=!t.middlewareData.shift;let G=q,ee=F;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(ee=R),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(G=O),X&&!E){const ie=wa(b.left,0),pe=wa(b.right,0),ae=wa(b.top,0),_e=wa(b.bottom,0);C?ee=k-2*(ie!==0||pe!==0?ie+pe:wa(b.left,b.right)):G=N-2*(ae!==0||_e!==0?ae+_e:wa(b.top,b.bottom))}await p({...t,availableWidth:ee,availableHeight:G});const K=await h.getDimensions(i.floating);return k!==K.width||N!==K.height?{reset:{rects:!0}}:{}}}};function y2(){return typeof window<"u"}function lg(e){return $8(e)?(e.nodeName||"").toLowerCase():"#document"}function ja(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Dl(e){var t;return(t=($8(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function $8(e){return y2()?e instanceof Node||e instanceof ja(e).Node:!1}function Ks(e){return y2()?e instanceof Element||e instanceof ja(e).Element:!1}function Ml(e){return y2()?e instanceof HTMLElement||e instanceof ja(e).HTMLElement:!1}function h4(e){return!y2()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ja(e).ShadowRoot}function Db(e){const{overflow:t,overflowX:r,overflowY:n,display:o}=Ys(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(o)}function woe(e){return["table","td","th"].includes(lg(e))}function v2(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function IM(e){const t=OM(),r=Ks(e)?Ys(e):e;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function Soe(e){let t=fd(e);for(;Ml(t)&&!jm(t);){if(IM(t))return t;if(v2(t))return null;t=fd(t)}return null}function OM(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function jm(e){return["html","body","#document"].includes(lg(e))}function Ys(e){return ja(e).getComputedStyle(e)}function x2(e){return Ks(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function fd(e){if(lg(e)==="html")return e;const t=e.assignedSlot||e.parentNode||h4(e)&&e.host||Dl(e);return h4(t)?t.host:t}function F8(e){const t=fd(e);return jm(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ml(t)&&Db(t)?t:F8(t)}function Bx(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const o=F8(e),s=o===((n=e.ownerDocument)==null?void 0:n.body),h=ja(o);if(s){const i=fA(h);return t.concat(h,h.visualViewport||[],Db(o)?o:[],i&&r?Bx(i):[])}return t.concat(o,Bx(o,[],r))}function fA(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function U8(e){const t=Ys(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const o=Ml(e),s=o?e.offsetWidth:r,h=o?e.offsetHeight:n,i=S1(r)!==s||S1(n)!==h;return i&&(r=s,n=h),{width:r,height:n,$:i}}function DM(e){return Ks(e)?e:e.contextElement}function hm(e){const t=DM(e);if(!Ml(t))return Pl(1);const r=t.getBoundingClientRect(),{width:n,height:o,$:s}=U8(t);let h=(s?S1(r.width):r.width)/n,i=(s?S1(r.height):r.height)/o;return(!h||!Number.isFinite(h))&&(h=1),(!i||!Number.isFinite(i))&&(i=1),{x:h,y:i}}const Eoe=Pl(0);function V8(e){const t=ja(e);return!OM()||!t.visualViewport?Eoe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Toe(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==ja(e)?!1:t}function af(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const o=e.getBoundingClientRect(),s=DM(e);let h=Pl(1);t&&(n?Ks(n)&&(h=hm(n)):h=hm(e));const i=Toe(s,r,n)?V8(s):Pl(0);let p=(o.left+i.x)/h.x,y=(o.top+i.y)/h.y,b=o.width/h.x,_=o.height/h.y;if(s){const E=ja(s),C=n&&Ks(n)?ja(n):n;let k=E,N=fA(k);for(;N&&n&&C!==k;){const I=hm(N),B=N.getBoundingClientRect(),O=Ys(N),R=B.left+(N.clientLeft+parseFloat(O.paddingLeft))*I.x,q=B.top+(N.clientTop+parseFloat(O.paddingTop))*I.y;p*=I.x,y*=I.y,b*=I.x,_*=I.y,p+=R,y+=q,k=ja(N),N=fA(k)}}return T1({width:b,height:_,x:p,y})}function RM(e,t){const r=x2(e).scrollLeft;return t?t.left+r:af(Dl(e)).left+r}function q8(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),o=n.left+t.scrollLeft-(r?0:RM(e,n)),s=n.top+t.scrollTop;return{x:o,y:s}}function joe(e){let{elements:t,rect:r,offsetParent:n,strategy:o}=e;const s=o==="fixed",h=Dl(n),i=t?v2(t.floating):!1;if(n===h||i&&s)return r;let p={scrollLeft:0,scrollTop:0},y=Pl(1);const b=Pl(0),_=Ml(n);if((_||!_&&!s)&&((lg(n)!=="body"||Db(h))&&(p=x2(n)),Ml(n))){const C=af(n);y=hm(n),b.x=C.x+n.clientLeft,b.y=C.y+n.clientTop}const E=h&&!_&&!s?q8(h,p,!0):Pl(0);return{width:r.width*y.x,height:r.height*y.y,x:r.x*y.x-p.scrollLeft*y.x+b.x+E.x,y:r.y*y.y-p.scrollTop*y.y+b.y+E.y}}function Coe(e){return Array.from(e.getClientRects())}function Poe(e){const t=Dl(e),r=x2(e),n=e.ownerDocument.body,o=wa(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=wa(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let h=-r.scrollLeft+RM(e);const i=-r.scrollTop;return Ys(n).direction==="rtl"&&(h+=wa(t.clientWidth,n.clientWidth)-o),{width:o,height:s,x:h,y:i}}function Aoe(e,t){const r=ja(e),n=Dl(e),o=r.visualViewport;let s=n.clientWidth,h=n.clientHeight,i=0,p=0;if(o){s=o.width,h=o.height;const y=OM();(!y||y&&t==="fixed")&&(i=o.offsetLeft,p=o.offsetTop)}return{width:s,height:h,x:i,y:p}}function koe(e,t){const r=af(e,!0,t==="fixed"),n=r.top+e.clientTop,o=r.left+e.clientLeft,s=Ml(e)?hm(e):Pl(1),h=e.clientWidth*s.x,i=e.clientHeight*s.y,p=o*s.x,y=n*s.y;return{width:h,height:i,x:p,y}}function f4(e,t,r){let n;if(t==="viewport")n=Aoe(e,r);else if(t==="document")n=Poe(Dl(e));else if(Ks(t))n=koe(t,r);else{const o=V8(e);n={x:t.x-o.x,y:t.y-o.y,width:t.width,height:t.height}}return T1(n)}function W8(e,t){const r=fd(e);return r===t||!Ks(r)||jm(r)?!1:Ys(r).position==="fixed"||W8(r,t)}function Noe(e,t){const r=t.get(e);if(r)return r;let n=Bx(e,[],!1).filter(i=>Ks(i)&&lg(i)!=="body"),o=null;const s=Ys(e).position==="fixed";let h=s?fd(e):e;for(;Ks(h)&&!jm(h);){const i=Ys(h),p=IM(h);!p&&i.position==="fixed"&&(o=null),(s?!p&&!o:!p&&i.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||Db(h)&&!p&&W8(e,h))?n=n.filter(b=>b!==h):o=i,h=fd(h)}return t.set(e,n),n}function Moe(e){let{element:t,boundary:r,rootBoundary:n,strategy:o}=e;const h=[...r==="clippingAncestors"?v2(t)?[]:Noe(t,this._c):[].concat(r),n],i=h[0],p=h.reduce((y,b)=>{const _=f4(t,b,o);return y.top=wa(_.top,y.top),y.right=hd(_.right,y.right),y.bottom=hd(_.bottom,y.bottom),y.left=wa(_.left,y.left),y},f4(t,i,o));return{width:p.right-p.left,height:p.bottom-p.top,x:p.left,y:p.top}}function Ioe(e){const{width:t,height:r}=U8(e);return{width:t,height:r}}function Ooe(e,t,r){const n=Ml(t),o=Dl(t),s=r==="fixed",h=af(e,!0,s,t);let i={scrollLeft:0,scrollTop:0};const p=Pl(0);function y(){p.x=RM(o)}if(n||!n&&!s)if((lg(t)!=="body"||Db(o))&&(i=x2(t)),n){const C=af(t,!0,s,t);p.x=C.x+t.clientLeft,p.y=C.y+t.clientTop}else o&&y();s&&!n&&o&&y();const b=o&&!n&&!s?q8(o,i):Pl(0),_=h.left+i.scrollLeft-p.x-b.x,E=h.top+i.scrollTop-p.y-b.y;return{x:_,y:E,width:h.width,height:h.height}}function Kj(e){return Ys(e).position==="static"}function p4(e,t){if(!Ml(e)||Ys(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Dl(e)===r&&(r=r.ownerDocument.body),r}function G8(e,t){const r=ja(e);if(v2(e))return r;if(!Ml(e)){let o=fd(e);for(;o&&!jm(o);){if(Ks(o)&&!Kj(o))return o;o=fd(o)}return r}let n=p4(e,t);for(;n&&woe(n)&&Kj(n);)n=p4(n,t);return n&&jm(n)&&Kj(n)&&!IM(n)?r:n||Soe(e)||r}const Doe=async function(e){const t=this.getOffsetParent||G8,r=this.getDimensions,n=await r(e.floating);return{reference:Ooe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Roe(e){return Ys(e).direction==="rtl"}const Loe={convertOffsetParentRelativeRectToViewportRelativeRect:joe,getDocumentElement:Dl,getClippingRect:Moe,getOffsetParent:G8,getElementRects:Doe,getClientRects:Coe,getDimensions:Ioe,getScale:hm,isElement:Ks,isRTL:Roe};function H8(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Boe(e,t){let r=null,n;const o=Dl(e);function s(){var i;clearTimeout(n),(i=r)==null||i.disconnect(),r=null}function h(i,p){i===void 0&&(i=!1),p===void 0&&(p=1),s();const y=e.getBoundingClientRect(),{left:b,top:_,width:E,height:C}=y;if(i||t(),!E||!C)return;const k=X_(_),N=X_(o.clientWidth-(b+E)),I=X_(o.clientHeight-(_+C)),B=X_(b),R={rootMargin:-k+"px "+-N+"px "+-I+"px "+-B+"px",threshold:wa(0,hd(1,p))||1};let q=!0;function F(X){const G=X[0].intersectionRatio;if(G!==p){if(!q)return h();G?h(!1,G):n=setTimeout(()=>{h(!1,1e-7)},1e3)}G===1&&!H8(y,e.getBoundingClientRect())&&h(),q=!1}try{r=new IntersectionObserver(F,{...R,root:o.ownerDocument})}catch{r=new IntersectionObserver(F,R)}r.observe(e)}return h(!0),s}function zoe(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:o=!0,ancestorResize:s=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:p=!1}=n,y=DM(e),b=o||s?[...y?Bx(y):[],...Bx(t)]:[];b.forEach(B=>{o&&B.addEventListener("scroll",r,{passive:!0}),s&&B.addEventListener("resize",r)});const _=y&&i?Boe(y,r):null;let E=-1,C=null;h&&(C=new ResizeObserver(B=>{let[O]=B;O&&O.target===y&&C&&(C.unobserve(t),cancelAnimationFrame(E),E=requestAnimationFrame(()=>{var R;(R=C)==null||R.observe(t)})),r()}),y&&!p&&C.observe(y),C.observe(t));let k,N=p?af(e):null;p&&I();function I(){const B=af(e);N&&!H8(N,B)&&r(),N=B,k=requestAnimationFrame(I)}return r(),()=>{var B;b.forEach(O=>{o&&O.removeEventListener("scroll",r),s&&O.removeEventListener("resize",r)}),_==null||_(),(B=C)==null||B.disconnect(),C=null,p&&cancelAnimationFrame(k)}}const $oe=voe,Foe=xoe,Uoe=moe,Voe=_oe,qoe=goe,m4=poe,Woe=boe,Goe=(e,t,r)=>{const n=new Map,o={platform:Loe,...r},s={...o.platform,_c:n};return foe(e,t,{...o,platform:s})};var Hoe=typeof document<"u",Xoe=function(){},Bw=Hoe?D.useLayoutEffect:Xoe;function j1(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!j1(e[n],t[n]))return!1;return!0}if(o=Object.keys(e),r=o.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,o[n]))return!1;for(n=r;n--!==0;){const s=o[n];if(!(s==="_owner"&&e.$$typeof)&&!j1(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function X8(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function g4(e,t){const r=X8(e);return Math.round(t*r)/r}function Yj(e){const t=D.useRef(e);return Bw(()=>{t.current=e}),t}function Zoe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:o,elements:{reference:s,floating:h}={},transform:i=!0,whileElementsMounted:p,open:y}=e,[b,_]=D.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[E,C]=D.useState(n);j1(E,n)||C(n);const[k,N]=D.useState(null),[I,B]=D.useState(null),O=D.useCallback(ve=>{ve!==X.current&&(X.current=ve,N(ve))},[]),R=D.useCallback(ve=>{ve!==G.current&&(G.current=ve,B(ve))},[]),q=s||k,F=h||I,X=D.useRef(null),G=D.useRef(null),ee=D.useRef(b),K=p!=null,ie=Yj(p),pe=Yj(o),ae=Yj(y),_e=D.useCallback(()=>{if(!X.current||!G.current)return;const ve={placement:t,strategy:r,middleware:E};pe.current&&(ve.platform=pe.current),Goe(X.current,G.current,ve).then(Pe=>{const Re={...Pe,isPositioned:ae.current!==!1};Ee.current&&!j1(ee.current,Re)&&(ee.current=Re,Uc.flushSync(()=>{_(Re)}))})},[E,t,r,pe,ae]);Bw(()=>{y===!1&&ee.current.isPositioned&&(ee.current.isPositioned=!1,_(ve=>({...ve,isPositioned:!1})))},[y]);const Ee=D.useRef(!1);Bw(()=>(Ee.current=!0,()=>{Ee.current=!1}),[]),Bw(()=>{if(q&&(X.current=q),F&&(G.current=F),q&&F){if(ie.current)return ie.current(q,F,_e);_e()}},[q,F,_e,ie,K]);const xe=D.useMemo(()=>({reference:X,floating:G,setReference:O,setFloating:R}),[O,R]),ce=D.useMemo(()=>({reference:q,floating:F}),[q,F]),ke=D.useMemo(()=>{const ve={position:r,left:0,top:0};if(!ce.floating)return ve;const Pe=g4(ce.floating,b.x),Re=g4(ce.floating,b.y);return i?{...ve,transform:"translate("+Pe+"px, "+Re+"px)",...X8(ce.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Pe,top:Re}},[r,i,ce.floating,b.x,b.y]);return D.useMemo(()=>({...b,update:_e,refs:xe,elements:ce,floatingStyles:ke}),[b,_e,xe,ce,ke])}const Koe=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:o}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?m4({element:n.current,padding:o}).fn(r):{}:n?m4({element:n,padding:o}).fn(r):{}}}},Yoe=(e,t)=>({...$oe(e),options:[e,t]}),Joe=(e,t)=>({...Foe(e),options:[e,t]}),Qoe=(e,t)=>({...Woe(e),options:[e,t]}),eae=(e,t)=>({...Uoe(e),options:[e,t]}),tae=(e,t)=>({...Voe(e),options:[e,t]}),rae=(e,t)=>({...qoe(e),options:[e,t]}),nae=(e,t)=>({...Koe(e),options:[e,t]});var iae="Arrow",Z8=D.forwardRef((e,t)=>{const{children:r,width:n=10,height:o=5,...s}=e;return c.jsx(fr.svg,{...s,ref:t,width:n,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:c.jsx("polygon",{points:"0,0 30,0 15,10"})})});Z8.displayName=iae;var oae=Z8;function LM(e){const[t,r]=D.useState(void 0);return so(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const s=o[0];let h,i;if("borderBoxSize"in s){const p=s.borderBoxSize,y=Array.isArray(p)?p[0]:p;h=y.inlineSize,i=y.blockSize}else h=e.offsetWidth,i=e.offsetHeight;r({width:h,height:i})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var BM="Popper",[K8,b2]=as(BM),[aae,Y8]=K8(BM),J8=e=>{const{__scopePopper:t,children:r}=e,[n,o]=D.useState(null);return c.jsx(aae,{scope:t,anchor:n,onAnchorChange:o,children:r})};J8.displayName=BM;var Q8="PopperAnchor",eq=D.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...o}=e,s=Y8(Q8,r),h=D.useRef(null),i=Kr(t,h);return D.useEffect(()=>{s.onAnchorChange((n==null?void 0:n.current)||h.current)}),n?null:c.jsx(fr.div,{...o,ref:i})});eq.displayName=Q8;var zM="PopperContent",[sae,lae]=K8(zM),tq=D.forwardRef((e,t)=>{var Nt,Jt,ft,vt,lt,it;const{__scopePopper:r,side:n="bottom",sideOffset:o=0,align:s="center",alignOffset:h=0,arrowPadding:i=0,avoidCollisions:p=!0,collisionBoundary:y=[],collisionPadding:b=0,sticky:_="partial",hideWhenDetached:E=!1,updatePositionStrategy:C="optimized",onPlaced:k,...N}=e,I=Y8(zM,r),[B,O]=D.useState(null),R=Kr(t,ar=>O(ar)),[q,F]=D.useState(null),X=LM(q),G=(X==null?void 0:X.width)??0,ee=(X==null?void 0:X.height)??0,K=n+(s!=="center"?"-"+s:""),ie=typeof b=="number"?b:{top:0,right:0,bottom:0,left:0,...b},pe=Array.isArray(y)?y:[y],ae=pe.length>0,_e={padding:ie,boundary:pe.filter(uae),altBoundary:ae},{refs:Ee,floatingStyles:xe,placement:ce,isPositioned:ke,middlewareData:ve}=Zoe({strategy:"fixed",placement:K,whileElementsMounted:(...ar)=>zoe(...ar,{animationFrame:C==="always"}),elements:{reference:I.anchor},middleware:[Yoe({mainAxis:o+ee,alignmentAxis:h}),p&&Joe({mainAxis:!0,crossAxis:!1,limiter:_==="partial"?Qoe():void 0,..._e}),p&&eae({..._e}),tae({..._e,apply:({elements:ar,rects:We,availableWidth:pt,availableHeight:Wt})=>{const{width:cr,height:Gr}=We.reference,ln=ar.floating.style;ln.setProperty("--radix-popper-available-width",`${pt}px`),ln.setProperty("--radix-popper-available-height",`${Wt}px`),ln.setProperty("--radix-popper-anchor-width",`${cr}px`),ln.setProperty("--radix-popper-anchor-height",`${Gr}px`)}}),q&&nae({element:q,padding:i}),dae({arrowWidth:G,arrowHeight:ee}),E&&rae({strategy:"referenceHidden",..._e})]}),[Pe,Re]=iq(ce),Be=aa(k);so(()=>{ke&&(Be==null||Be())},[ke,Be]);const Fe=(Nt=ve.arrow)==null?void 0:Nt.x,Ge=(Jt=ve.arrow)==null?void 0:Jt.y,Pt=((ft=ve.arrow)==null?void 0:ft.centerOffset)!==0,[$t,nr]=D.useState();return so(()=>{B&&nr(window.getComputedStyle(B).zIndex)},[B]),c.jsx("div",{ref:Ee.setFloating,"data-radix-popper-content-wrapper":"",style:{...xe,transform:ke?xe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:$t,"--radix-popper-transform-origin":[(vt=ve.transformOrigin)==null?void 0:vt.x,(lt=ve.transformOrigin)==null?void 0:lt.y].join(" "),...((it=ve.hide)==null?void 0:it.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:c.jsx(sae,{scope:r,placedSide:Pe,onArrowChange:F,arrowX:Fe,arrowY:Ge,shouldHideArrow:Pt,children:c.jsx(fr.div,{"data-side":Pe,"data-align":Re,...N,ref:R,style:{...N.style,animation:ke?void 0:"none"}})})})});tq.displayName=zM;var rq="PopperArrow",cae={top:"bottom",right:"left",bottom:"top",left:"right"},nq=D.forwardRef(function(t,r){const{__scopePopper:n,...o}=t,s=lae(rq,n),h=cae[s.placedSide];return c.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:c.jsx(oae,{...o,ref:r,style:{...o.style,display:"block"}})})});nq.displayName=rq;function uae(e){return e!==null}var dae=e=>({name:"transformOrigin",options:e,fn(t){var I,B,O;const{placement:r,rects:n,middlewareData:o}=t,h=((I=o.arrow)==null?void 0:I.centerOffset)!==0,i=h?0:e.arrowWidth,p=h?0:e.arrowHeight,[y,b]=iq(r),_={start:"0%",center:"50%",end:"100%"}[b],E=(((B=o.arrow)==null?void 0:B.x)??0)+i/2,C=(((O=o.arrow)==null?void 0:O.y)??0)+p/2;let k="",N="";return y==="bottom"?(k=h?_:`${E}px`,N=`${-p}px`):y==="top"?(k=h?_:`${E}px`,N=`${n.floating.height+p}px`):y==="right"?(k=`${-p}px`,N=h?_:`${C}px`):y==="left"&&(k=`${n.floating.width+p}px`,N=h?_:`${C}px`),{data:{x:k,y:N}}}});function iq(e){const[t,r="center"]=e.split("-");return[t,r]}var oq=J8,aq=eq,sq=tq,lq=nq,Jj="rovingFocusGroup.onEntryFocus",hae={bubbles:!1,cancelable:!0},Rb="RovingFocusGroup",[pA,cq,fae]=u2(Rb),[pae,cg]=as(Rb,[fae]),[mae,gae]=pae(Rb),uq=D.forwardRef((e,t)=>c.jsx(pA.Provider,{scope:e.__scopeRovingFocusGroup,children:c.jsx(pA.Slot,{scope:e.__scopeRovingFocusGroup,children:c.jsx(yae,{...e,ref:t})})}));uq.displayName=Rb;var yae=D.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:o=!1,dir:s,currentTabStopId:h,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:p,onEntryFocus:y,preventScrollOnEntryFocus:b=!1,..._}=e,E=D.useRef(null),C=Kr(t,E),k=Ob(s),[N,I]=Nc({prop:h,defaultProp:i??null,onChange:p,caller:Rb}),[B,O]=D.useState(!1),R=aa(y),q=cq(r),F=D.useRef(!1),[X,G]=D.useState(0);return D.useEffect(()=>{const ee=E.current;if(ee)return ee.addEventListener(Jj,R),()=>ee.removeEventListener(Jj,R)},[R]),c.jsx(mae,{scope:r,orientation:n,dir:k,loop:o,currentTabStopId:N,onItemFocus:D.useCallback(ee=>I(ee),[I]),onItemShiftTab:D.useCallback(()=>O(!0),[]),onFocusableItemAdd:D.useCallback(()=>G(ee=>ee+1),[]),onFocusableItemRemove:D.useCallback(()=>G(ee=>ee-1),[]),children:c.jsx(fr.div,{tabIndex:B||X===0?-1:0,"data-orientation":n,..._,ref:C,style:{outline:"none",...e.style},onMouseDown:Ht(e.onMouseDown,()=>{F.current=!0}),onFocus:Ht(e.onFocus,ee=>{const K=!F.current;if(ee.target===ee.currentTarget&&K&&!B){const ie=new CustomEvent(Jj,hae);if(ee.currentTarget.dispatchEvent(ie),!ie.defaultPrevented){const pe=q().filter(ce=>ce.focusable),ae=pe.find(ce=>ce.active),_e=pe.find(ce=>ce.id===N),xe=[ae,_e,...pe].filter(Boolean).map(ce=>ce.ref.current);fq(xe,b)}}F.current=!1}),onBlur:Ht(e.onBlur,()=>O(!1))})})}),dq="RovingFocusGroupItem",hq=D.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:o=!1,tabStopId:s,children:h,...i}=e,p=Cl(),y=s||p,b=gae(dq,r),_=b.currentTabStopId===y,E=cq(r),{onFocusableItemAdd:C,onFocusableItemRemove:k,currentTabStopId:N}=b;return D.useEffect(()=>{if(n)return C(),()=>k()},[n,C,k]),c.jsx(pA.ItemSlot,{scope:r,id:y,focusable:n,active:o,children:c.jsx(fr.span,{tabIndex:_?0:-1,"data-orientation":b.orientation,...i,ref:t,onMouseDown:Ht(e.onMouseDown,I=>{n?b.onItemFocus(y):I.preventDefault()}),onFocus:Ht(e.onFocus,()=>b.onItemFocus(y)),onKeyDown:Ht(e.onKeyDown,I=>{if(I.key==="Tab"&&I.shiftKey){b.onItemShiftTab();return}if(I.target!==I.currentTarget)return;const B=bae(I,b.orientation,b.dir);if(B!==void 0){if(I.metaKey||I.ctrlKey||I.altKey||I.shiftKey)return;I.preventDefault();let R=E().filter(q=>q.focusable).map(q=>q.ref.current);if(B==="last")R.reverse();else if(B==="prev"||B==="next"){B==="prev"&&R.reverse();const q=R.indexOf(I.currentTarget);R=b.loop?_ae(R,q+1):R.slice(q+1)}setTimeout(()=>fq(R))}}),children:typeof h=="function"?h({isCurrentTabStop:_,hasTabStop:N!=null}):h})})});hq.displayName=dq;var vae={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function xae(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function bae(e,t,r){const n=xae(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return vae[n]}function fq(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function _ae(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var $M=uq,FM=hq,wae=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Pp=new WeakMap,Z_=new WeakMap,K_={},Qj=0,pq=function(e){return e&&(e.host||pq(e.parentNode))},Sae=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=pq(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Eae=function(e,t,r,n){var o=Sae(t,Array.isArray(e)?e:[e]);K_[r]||(K_[r]=new WeakMap);var s=K_[r],h=[],i=new Set,p=new Set(o),y=function(_){!_||i.has(_)||(i.add(_),y(_.parentNode))};o.forEach(y);var b=function(_){!_||p.has(_)||Array.prototype.forEach.call(_.children,function(E){if(i.has(E))b(E);else try{var C=E.getAttribute(n),k=C!==null&&C!=="false",N=(Pp.get(E)||0)+1,I=(s.get(E)||0)+1;Pp.set(E,N),s.set(E,I),h.push(E),N===1&&k&&Z_.set(E,!0),I===1&&E.setAttribute(r,"true"),k||E.setAttribute(n,"true")}catch(B){console.error("aria-hidden: cannot operate on ",E,B)}})};return b(t),i.clear(),Qj++,function(){h.forEach(function(_){var E=Pp.get(_)-1,C=s.get(_)-1;Pp.set(_,E),s.set(_,C),E||(Z_.has(_)||_.removeAttribute(n),Z_.delete(_)),C||_.removeAttribute(r)}),Qj--,Qj||(Pp=new WeakMap,Pp=new WeakMap,Z_=new WeakMap,K_={})}},UM=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),o=t||wae(e);return o?(n.push.apply(n,Array.from(o.querySelectorAll("[aria-live], script"))),Eae(n,o,r,"aria-hidden")):function(){return null}},xl=function(){return xl=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},xl.apply(this,arguments)};function mq(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function Tae(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}var zw="right-scroll-bar-position",$w="width-before-scroll-bar",jae="with-scroll-bars-hidden",Cae="--removed-body-scroll-bar-size";function eC(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Pae(e,t){var r=D.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var o=r.value;o!==n&&(r.value=n,r.callback(n,o))}}}})[0];return r.callback=t,r.facade}var Aae=typeof window<"u"?D.useLayoutEffect:D.useEffect,y4=new WeakMap;function kae(e,t){var r=Pae(t||null,function(n){return e.forEach(function(o){return eC(o,n)})});return Aae(function(){var n=y4.get(r);if(n){var o=new Set(n),s=new Set(e),h=r.current;o.forEach(function(i){s.has(i)||eC(i,null)}),s.forEach(function(i){o.has(i)||eC(i,h)})}y4.set(r,e)},[e]),r}function Nae(e){return e}function Mae(e,t){t===void 0&&(t=Nae);var r=[],n=!1,o={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(s){var h=t(s,n);return r.push(h),function(){r=r.filter(function(i){return i!==h})}},assignSyncMedium:function(s){for(n=!0;r.length;){var h=r;r=[],h.forEach(s)}r={push:function(i){return s(i)},filter:function(){return r}}},assignMedium:function(s){n=!0;var h=[];if(r.length){var i=r;r=[],i.forEach(s),h=r}var p=function(){var b=h;h=[],b.forEach(s)},y=function(){return Promise.resolve().then(p)};y(),r={push:function(b){h.push(b),y()},filter:function(b){return h=h.filter(b),r}}}};return o}function Iae(e){e===void 0&&(e={});var t=Mae(null);return t.options=xl({async:!0,ssr:!1},e),t}var gq=function(e){var t=e.sideCar,r=mq(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return D.createElement(n,xl({},r))};gq.isSideCarExport=!0;function Oae(e,t){return e.useMedium(t),gq}var yq=Iae(),tC=function(){},_2=D.forwardRef(function(e,t){var r=D.useRef(null),n=D.useState({onScrollCapture:tC,onWheelCapture:tC,onTouchMoveCapture:tC}),o=n[0],s=n[1],h=e.forwardProps,i=e.children,p=e.className,y=e.removeScrollBar,b=e.enabled,_=e.shards,E=e.sideCar,C=e.noRelative,k=e.noIsolation,N=e.inert,I=e.allowPinchZoom,B=e.as,O=B===void 0?"div":B,R=e.gapMode,q=mq(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),F=E,X=kae([r,t]),G=xl(xl({},q),o);return D.createElement(D.Fragment,null,b&&D.createElement(F,{sideCar:yq,removeScrollBar:y,shards:_,noRelative:C,noIsolation:k,inert:N,setCallbacks:s,allowPinchZoom:!!I,lockRef:r,gapMode:R}),h?D.cloneElement(D.Children.only(i),xl(xl({},G),{ref:X})):D.createElement(O,xl({},G,{className:p,ref:X}),i))});_2.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};_2.classNames={fullWidth:$w,zeroRight:zw};var v4,Dae=function(){if(v4)return v4;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Rae(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Dae();return t&&e.setAttribute("nonce",t),e}function Lae(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Bae(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var zae=function(){var e=0,t=null;return{add:function(r){e==0&&(t=Rae())&&(Lae(t,r),Bae(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},$ae=function(){var e=zae();return function(t,r){D.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},vq=function(){var e=$ae(),t=function(r){var n=r.styles,o=r.dynamic;return e(n,o),null};return t},Fae={left:0,top:0,right:0,gap:0},rC=function(e){return parseInt(e||"",10)||0},Uae=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[rC(r),rC(n),rC(o)]},Vae=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Fae;var t=Uae(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},qae=vq(),fm="data-scroll-locked",Wae=function(e,t,r,n){var o=e.left,s=e.top,h=e.right,i=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(jae,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(i,"px ").concat(n,`;
  }
  body[`).concat(fm,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(h,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(i,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zw,` {
    right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat($w,` {
    margin-right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(zw," .").concat(zw,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat($w," .").concat($w,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(fm,`] {
    `).concat(Cae,": ").concat(i,`px;
  }
`)},x4=function(){var e=parseInt(document.body.getAttribute(fm)||"0",10);return isFinite(e)?e:0},Gae=function(){D.useEffect(function(){return document.body.setAttribute(fm,(x4()+1).toString()),function(){var e=x4()-1;e<=0?document.body.removeAttribute(fm):document.body.setAttribute(fm,e.toString())}},[])},Hae=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,o=n===void 0?"margin":n;Gae();var s=D.useMemo(function(){return Vae(o)},[o]);return D.createElement(qae,{styles:Wae(s,!t,o,r?"":"!important")})},mA=!1;if(typeof window<"u")try{var Y_=Object.defineProperty({},"passive",{get:function(){return mA=!0,!0}});window.addEventListener("test",Y_,Y_),window.removeEventListener("test",Y_,Y_)}catch{mA=!1}var Ap=mA?{passive:!1}:!1,Xae=function(e){return e.tagName==="TEXTAREA"},xq=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Xae(e)&&r[t]==="visible")},Zae=function(e){return xq(e,"overflowY")},Kae=function(e){return xq(e,"overflowX")},b4=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var o=bq(e,n);if(o){var s=_q(e,n),h=s[1],i=s[2];if(h>i)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Yae=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Jae=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},bq=function(e,t){return e==="v"?Zae(t):Kae(t)},_q=function(e,t){return e==="v"?Yae(t):Jae(t)},Qae=function(e,t){return e==="h"&&t==="rtl"?-1:1},ese=function(e,t,r,n,o){var s=Qae(e,window.getComputedStyle(t).direction),h=s*n,i=r.target,p=t.contains(i),y=!1,b=h>0,_=0,E=0;do{if(!i)break;var C=_q(e,i),k=C[0],N=C[1],I=C[2],B=N-I-s*k;(k||B)&&bq(e,i)&&(_+=B,E+=k);var O=i.parentNode;i=O&&O.nodeType===Node.DOCUMENT_FRAGMENT_NODE?O.host:O}while(!p&&i!==document.body||p&&(t.contains(i)||t===i));return(b&&(o&&Math.abs(_)<1||!o&&h>_)||!b&&(o&&Math.abs(E)<1||!o&&-h>E))&&(y=!0),y},J_=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},_4=function(e){return[e.deltaX,e.deltaY]},w4=function(e){return e&&"current"in e?e.current:e},tse=function(e,t){return e[0]===t[0]&&e[1]===t[1]},rse=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},nse=0,kp=[];function ise(e){var t=D.useRef([]),r=D.useRef([0,0]),n=D.useRef(),o=D.useState(nse++)[0],s=D.useState(vq)[0],h=D.useRef(e);D.useEffect(function(){h.current=e},[e]),D.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var N=Tae([e.lockRef.current],(e.shards||[]).map(w4),!0).filter(Boolean);return N.forEach(function(I){return I.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),N.forEach(function(I){return I.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var i=D.useCallback(function(N,I){if("touches"in N&&N.touches.length===2||N.type==="wheel"&&N.ctrlKey)return!h.current.allowPinchZoom;var B=J_(N),O=r.current,R="deltaX"in N?N.deltaX:O[0]-B[0],q="deltaY"in N?N.deltaY:O[1]-B[1],F,X=N.target,G=Math.abs(R)>Math.abs(q)?"h":"v";if("touches"in N&&G==="h"&&X.type==="range")return!1;var ee=b4(G,X);if(!ee)return!0;if(ee?F=G:(F=G==="v"?"h":"v",ee=b4(G,X)),!ee)return!1;if(!n.current&&"changedTouches"in N&&(R||q)&&(n.current=F),!F)return!0;var K=n.current||F;return ese(K,I,N,K==="h"?R:q,!0)},[]),p=D.useCallback(function(N){var I=N;if(!(!kp.length||kp[kp.length-1]!==s)){var B="deltaY"in I?_4(I):J_(I),O=t.current.filter(function(F){return F.name===I.type&&(F.target===I.target||I.target===F.shadowParent)&&tse(F.delta,B)})[0];if(O&&O.should){I.cancelable&&I.preventDefault();return}if(!O){var R=(h.current.shards||[]).map(w4).filter(Boolean).filter(function(F){return F.contains(I.target)}),q=R.length>0?i(I,R[0]):!h.current.noIsolation;q&&I.cancelable&&I.preventDefault()}}},[]),y=D.useCallback(function(N,I,B,O){var R={name:N,delta:I,target:B,should:O,shadowParent:ose(B)};t.current.push(R),setTimeout(function(){t.current=t.current.filter(function(q){return q!==R})},1)},[]),b=D.useCallback(function(N){r.current=J_(N),n.current=void 0},[]),_=D.useCallback(function(N){y(N.type,_4(N),N.target,i(N,e.lockRef.current))},[]),E=D.useCallback(function(N){y(N.type,J_(N),N.target,i(N,e.lockRef.current))},[]);D.useEffect(function(){return kp.push(s),e.setCallbacks({onScrollCapture:_,onWheelCapture:_,onTouchMoveCapture:E}),document.addEventListener("wheel",p,Ap),document.addEventListener("touchmove",p,Ap),document.addEventListener("touchstart",b,Ap),function(){kp=kp.filter(function(N){return N!==s}),document.removeEventListener("wheel",p,Ap),document.removeEventListener("touchmove",p,Ap),document.removeEventListener("touchstart",b,Ap)}},[]);var C=e.removeScrollBar,k=e.inert;return D.createElement(D.Fragment,null,k?D.createElement(s,{styles:rse(o)}):null,C?D.createElement(Hae,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function ose(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const ase=Oae(yq,ise);var wq=D.forwardRef(function(e,t){return D.createElement(_2,xl({},e,{ref:t,sideCar:ase}))});wq.classNames=_2.classNames;const VM=wq;var gA=["Enter"," "],sse=["ArrowDown","PageUp","Home"],Sq=["ArrowUp","PageDown","End"],lse=[...sse,...Sq],cse={ltr:[...gA,"ArrowRight"],rtl:[...gA,"ArrowLeft"]},use={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Lb="Menu",[zx,dse,hse]=u2(Lb),[xf,Eq]=as(Lb,[hse,b2,cg]),w2=b2(),Tq=cg(),[fse,ug]=xf(Lb),[pse,Bb]=xf(Lb),jq=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:o,onOpenChange:s,modal:h=!0}=e,i=w2(t),[p,y]=D.useState(null),b=D.useRef(!1),_=aa(s),E=Ob(o);return D.useEffect(()=>{const C=()=>{b.current=!0,document.addEventListener("pointerdown",k,{capture:!0,once:!0}),document.addEventListener("pointermove",k,{capture:!0,once:!0})},k=()=>b.current=!1;return document.addEventListener("keydown",C,{capture:!0}),()=>{document.removeEventListener("keydown",C,{capture:!0}),document.removeEventListener("pointerdown",k,{capture:!0}),document.removeEventListener("pointermove",k,{capture:!0})}},[]),c.jsx(oq,{...i,children:c.jsx(fse,{scope:t,open:r,onOpenChange:_,content:p,onContentChange:y,children:c.jsx(pse,{scope:t,onClose:D.useCallback(()=>_(!1),[_]),isUsingKeyboardRef:b,dir:E,modal:h,children:n})})})};jq.displayName=Lb;var mse="MenuAnchor",qM=D.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,o=w2(r);return c.jsx(aq,{...o,...n,ref:t})});qM.displayName=mse;var gse="MenuPortal",[DUe,Cq]=xf(gse,{forceMount:void 0}),es="MenuContent",[yse,WM]=xf(es),Pq=D.forwardRef((e,t)=>{const r=Cq(es,e.__scopeMenu),{forceMount:n=r.forceMount,...o}=e,s=ug(es,e.__scopeMenu),h=Bb(es,e.__scopeMenu);return c.jsx(zx.Provider,{scope:e.__scopeMenu,children:c.jsx(Ol,{present:n||s.open,children:c.jsx(zx.Slot,{scope:e.__scopeMenu,children:h.modal?c.jsx(vse,{...o,ref:t}):c.jsx(xse,{...o,ref:t})})})})}),vse=D.forwardRef((e,t)=>{const r=ug(es,e.__scopeMenu),n=D.useRef(null),o=Kr(t,n);return D.useEffect(()=>{const s=n.current;if(s)return UM(s)},[]),c.jsx(GM,{...e,ref:o,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Ht(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),xse=D.forwardRef((e,t)=>{const r=ug(es,e.__scopeMenu);return c.jsx(GM,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),bse=tf("MenuContent.ScrollLock"),GM=D.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:o,onOpenAutoFocus:s,onCloseAutoFocus:h,disableOutsidePointerEvents:i,onEntryFocus:p,onEscapeKeyDown:y,onPointerDownOutside:b,onFocusOutside:_,onInteractOutside:E,onDismiss:C,disableOutsideScroll:k,...N}=e,I=ug(es,r),B=Bb(es,r),O=w2(r),R=Tq(r),q=dse(r),[F,X]=D.useState(null),G=D.useRef(null),ee=Kr(t,G,I.onContentChange),K=D.useRef(0),ie=D.useRef(""),pe=D.useRef(0),ae=D.useRef(null),_e=D.useRef("right"),Ee=D.useRef(0),xe=k?VM:D.Fragment,ce=k?{as:bse,allowPinchZoom:!0}:void 0,ke=Pe=>{var Nt,Jt;const Re=ie.current+Pe,Be=q().filter(ft=>!ft.disabled),Fe=document.activeElement,Ge=(Nt=Be.find(ft=>ft.ref.current===Fe))==null?void 0:Nt.textValue,Pt=Be.map(ft=>ft.textValue),$t=Mse(Pt,Re,Ge),nr=(Jt=Be.find(ft=>ft.textValue===$t))==null?void 0:Jt.ref.current;(function ft(vt){ie.current=vt,window.clearTimeout(K.current),vt!==""&&(K.current=window.setTimeout(()=>ft(""),1e3))})(Re),nr&&setTimeout(()=>nr.focus())};D.useEffect(()=>()=>window.clearTimeout(K.current),[]),AM();const ve=D.useCallback(Pe=>{var Be,Fe;return _e.current===((Be=ae.current)==null?void 0:Be.side)&&Ose(Pe,(Fe=ae.current)==null?void 0:Fe.area)},[]);return c.jsx(yse,{scope:r,searchRef:ie,onItemEnter:D.useCallback(Pe=>{ve(Pe)&&Pe.preventDefault()},[ve]),onItemLeave:D.useCallback(Pe=>{var Re;ve(Pe)||((Re=G.current)==null||Re.focus(),X(null))},[ve]),onTriggerLeave:D.useCallback(Pe=>{ve(Pe)&&Pe.preventDefault()},[ve]),pointerGraceTimerRef:pe,onPointerGraceIntentChange:D.useCallback(Pe=>{ae.current=Pe},[]),children:c.jsx(xe,{...ce,children:c.jsx(g2,{asChild:!0,trapped:o,onMountAutoFocus:Ht(s,Pe=>{var Re;Pe.preventDefault(),(Re=G.current)==null||Re.focus({preventScroll:!0})}),onUnmountAutoFocus:h,children:c.jsx(Nb,{asChild:!0,disableOutsidePointerEvents:i,onEscapeKeyDown:y,onPointerDownOutside:b,onFocusOutside:_,onInteractOutside:E,onDismiss:C,children:c.jsx($M,{asChild:!0,...R,dir:B.dir,orientation:"vertical",loop:n,currentTabStopId:F,onCurrentTabStopIdChange:X,onEntryFocus:Ht(p,Pe=>{B.isUsingKeyboardRef.current||Pe.preventDefault()}),preventScrollOnEntryFocus:!0,children:c.jsx(sq,{role:"menu","aria-orientation":"vertical","data-state":qq(I.open),"data-radix-menu-content":"",dir:B.dir,...O,...N,ref:ee,style:{outline:"none",...N.style},onKeyDown:Ht(N.onKeyDown,Pe=>{const Be=Pe.target.closest("[data-radix-menu-content]")===Pe.currentTarget,Fe=Pe.ctrlKey||Pe.altKey||Pe.metaKey,Ge=Pe.key.length===1;Be&&(Pe.key==="Tab"&&Pe.preventDefault(),!Fe&&Ge&&ke(Pe.key));const Pt=G.current;if(Pe.target!==Pt||!lse.includes(Pe.key))return;Pe.preventDefault();const nr=q().filter(Nt=>!Nt.disabled).map(Nt=>Nt.ref.current);Sq.includes(Pe.key)&&nr.reverse(),kse(nr)}),onBlur:Ht(e.onBlur,Pe=>{Pe.currentTarget.contains(Pe.target)||(window.clearTimeout(K.current),ie.current="")}),onPointerMove:Ht(e.onPointerMove,$x(Pe=>{const Re=Pe.target,Be=Ee.current!==Pe.clientX;if(Pe.currentTarget.contains(Re)&&Be){const Fe=Pe.clientX>Ee.current?"right":"left";_e.current=Fe,Ee.current=Pe.clientX}}))})})})})})})});Pq.displayName=es;var _se="MenuGroup",HM=D.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return c.jsx(fr.div,{role:"group",...n,ref:t})});HM.displayName=_se;var wse="MenuLabel",Aq=D.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return c.jsx(fr.div,{...n,ref:t})});Aq.displayName=wse;var C1="MenuItem",S4="menu.itemSelect",S2=D.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...o}=e,s=D.useRef(null),h=Bb(C1,e.__scopeMenu),i=WM(C1,e.__scopeMenu),p=Kr(t,s),y=D.useRef(!1),b=()=>{const _=s.current;if(!r&&_){const E=new CustomEvent(S4,{bubbles:!0,cancelable:!0});_.addEventListener(S4,C=>n==null?void 0:n(C),{once:!0}),xM(_,E),E.defaultPrevented?y.current=!1:h.onClose()}};return c.jsx(kq,{...o,ref:p,disabled:r,onClick:Ht(e.onClick,b),onPointerDown:_=>{var E;(E=e.onPointerDown)==null||E.call(e,_),y.current=!0},onPointerUp:Ht(e.onPointerUp,_=>{var E;y.current||(E=_.currentTarget)==null||E.click()}),onKeyDown:Ht(e.onKeyDown,_=>{const E=i.searchRef.current!=="";r||E&&_.key===" "||gA.includes(_.key)&&(_.currentTarget.click(),_.preventDefault())})})});S2.displayName=C1;var kq=D.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:o,...s}=e,h=WM(C1,r),i=Tq(r),p=D.useRef(null),y=Kr(t,p),[b,_]=D.useState(!1),[E,C]=D.useState("");return D.useEffect(()=>{const k=p.current;k&&C((k.textContent??"").trim())},[s.children]),c.jsx(zx.ItemSlot,{scope:r,disabled:n,textValue:o??E,children:c.jsx(FM,{asChild:!0,...i,focusable:!n,children:c.jsx(fr.div,{role:"menuitem","data-highlighted":b?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...s,ref:y,onPointerMove:Ht(e.onPointerMove,$x(k=>{n?h.onItemLeave(k):(h.onItemEnter(k),k.defaultPrevented||k.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Ht(e.onPointerLeave,$x(k=>h.onItemLeave(k))),onFocus:Ht(e.onFocus,()=>_(!0)),onBlur:Ht(e.onBlur,()=>_(!1))})})})}),Sse="MenuCheckboxItem",Nq=D.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...o}=e;return c.jsx(Rq,{scope:e.__scopeMenu,checked:r,children:c.jsx(S2,{role:"menuitemcheckbox","aria-checked":P1(r)?"mixed":r,...o,ref:t,"data-state":ZM(r),onSelect:Ht(o.onSelect,()=>n==null?void 0:n(P1(r)?!0:!r),{checkForDefaultPrevented:!1})})})});Nq.displayName=Sse;var Mq="MenuRadioGroup",[Ese,Tse]=xf(Mq,{value:void 0,onValueChange:()=>{}}),Iq=D.forwardRef((e,t)=>{const{value:r,onValueChange:n,...o}=e,s=aa(n);return c.jsx(Ese,{scope:e.__scopeMenu,value:r,onValueChange:s,children:c.jsx(HM,{...o,ref:t})})});Iq.displayName=Mq;var Oq="MenuRadioItem",Dq=D.forwardRef((e,t)=>{const{value:r,...n}=e,o=Tse(Oq,e.__scopeMenu),s=r===o.value;return c.jsx(Rq,{scope:e.__scopeMenu,checked:s,children:c.jsx(S2,{role:"menuitemradio","aria-checked":s,...n,ref:t,"data-state":ZM(s),onSelect:Ht(n.onSelect,()=>{var h;return(h=o.onValueChange)==null?void 0:h.call(o,r)},{checkForDefaultPrevented:!1})})})});Dq.displayName=Oq;var XM="MenuItemIndicator",[Rq,jse]=xf(XM,{checked:!1}),Lq=D.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...o}=e,s=jse(XM,r);return c.jsx(Ol,{present:n||P1(s.checked)||s.checked===!0,children:c.jsx(fr.span,{...o,ref:t,"data-state":ZM(s.checked)})})});Lq.displayName=XM;var Cse="MenuSeparator",Bq=D.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return c.jsx(fr.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});Bq.displayName=Cse;var Pse="MenuArrow",zq=D.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,o=w2(r);return c.jsx(lq,{...o,...n,ref:t})});zq.displayName=Pse;var Ase="MenuSub",[RUe,$q]=xf(Ase),$v="MenuSubTrigger",Fq=D.forwardRef((e,t)=>{const r=ug($v,e.__scopeMenu),n=Bb($v,e.__scopeMenu),o=$q($v,e.__scopeMenu),s=WM($v,e.__scopeMenu),h=D.useRef(null),{pointerGraceTimerRef:i,onPointerGraceIntentChange:p}=s,y={__scopeMenu:e.__scopeMenu},b=D.useCallback(()=>{h.current&&window.clearTimeout(h.current),h.current=null},[]);return D.useEffect(()=>b,[b]),D.useEffect(()=>{const _=i.current;return()=>{window.clearTimeout(_),p(null)}},[i,p]),c.jsx(qM,{asChild:!0,...y,children:c.jsx(kq,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":o.contentId,"data-state":qq(r.open),...e,ref:c2(t,o.onTriggerChange),onClick:_=>{var E;(E=e.onClick)==null||E.call(e,_),!(e.disabled||_.defaultPrevented)&&(_.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Ht(e.onPointerMove,$x(_=>{s.onItemEnter(_),!_.defaultPrevented&&!e.disabled&&!r.open&&!h.current&&(s.onPointerGraceIntentChange(null),h.current=window.setTimeout(()=>{r.onOpenChange(!0),b()},100))})),onPointerLeave:Ht(e.onPointerLeave,$x(_=>{var C,k;b();const E=(C=r.content)==null?void 0:C.getBoundingClientRect();if(E){const N=(k=r.content)==null?void 0:k.dataset.side,I=N==="right",B=I?-5:5,O=E[I?"left":"right"],R=E[I?"right":"left"];s.onPointerGraceIntentChange({area:[{x:_.clientX+B,y:_.clientY},{x:O,y:E.top},{x:R,y:E.top},{x:R,y:E.bottom},{x:O,y:E.bottom}],side:N}),window.clearTimeout(i.current),i.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(_),_.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:Ht(e.onKeyDown,_=>{var C;const E=s.searchRef.current!=="";e.disabled||E&&_.key===" "||cse[n.dir].includes(_.key)&&(r.onOpenChange(!0),(C=r.content)==null||C.focus(),_.preventDefault())})})})});Fq.displayName=$v;var Uq="MenuSubContent",Vq=D.forwardRef((e,t)=>{const r=Cq(es,e.__scopeMenu),{forceMount:n=r.forceMount,...o}=e,s=ug(es,e.__scopeMenu),h=Bb(es,e.__scopeMenu),i=$q(Uq,e.__scopeMenu),p=D.useRef(null),y=Kr(t,p);return c.jsx(zx.Provider,{scope:e.__scopeMenu,children:c.jsx(Ol,{present:n||s.open,children:c.jsx(zx.Slot,{scope:e.__scopeMenu,children:c.jsx(GM,{id:i.contentId,"aria-labelledby":i.triggerId,...o,ref:y,align:"start",side:h.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:b=>{var _;h.isUsingKeyboardRef.current&&((_=p.current)==null||_.focus()),b.preventDefault()},onCloseAutoFocus:b=>b.preventDefault(),onFocusOutside:Ht(e.onFocusOutside,b=>{b.target!==i.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:Ht(e.onEscapeKeyDown,b=>{h.onClose(),b.preventDefault()}),onKeyDown:Ht(e.onKeyDown,b=>{var C;const _=b.currentTarget.contains(b.target),E=use[h.dir].includes(b.key);_&&E&&(s.onOpenChange(!1),(C=i.trigger)==null||C.focus(),b.preventDefault())})})})})})});Vq.displayName=Uq;function qq(e){return e?"open":"closed"}function P1(e){return e==="indeterminate"}function ZM(e){return P1(e)?"indeterminate":e?"checked":"unchecked"}function kse(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function Nse(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function Mse(e,t,r){const o=t.length>1&&Array.from(t).every(y=>y===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let h=Nse(e,Math.max(s,0));o.length===1&&(h=h.filter(y=>y!==r));const p=h.find(y=>y.toLowerCase().startsWith(o.toLowerCase()));return p!==r?p:void 0}function Ise(e,t){const{x:r,y:n}=e;let o=!1;for(let s=0,h=t.length-1;s<t.length;h=s++){const i=t[s],p=t[h],y=i.x,b=i.y,_=p.x,E=p.y;b>n!=E>n&&r<(_-y)*(n-b)/(E-b)+y&&(o=!o)}return o}function Ose(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return Ise(r,t)}function $x(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Dse=jq,Rse=qM,Lse=Pq,Bse=HM,zse=Aq,$se=S2,Fse=Nq,Use=Iq,Vse=Dq,qse=Lq,Wse=Bq,Gse=zq,Hse=Fq,Xse=Vq,E2="DropdownMenu",[Zse,LUe]=as(E2,[Eq]),ca=Eq(),[Kse,Wq]=Zse(E2),Gq=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:o,defaultOpen:s,onOpenChange:h,modal:i=!0}=e,p=ca(t),y=D.useRef(null),[b,_]=Nc({prop:o,defaultProp:s??!1,onChange:h,caller:E2});return c.jsx(Kse,{scope:t,triggerId:Cl(),triggerRef:y,contentId:Cl(),open:b,onOpenChange:_,onOpenToggle:D.useCallback(()=>_(E=>!E),[_]),modal:i,children:c.jsx(Dse,{...p,open:b,onOpenChange:_,dir:n,modal:i,children:r})})};Gq.displayName=E2;var Hq="DropdownMenuTrigger",Xq=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...o}=e,s=Wq(Hq,r),h=ca(r);return c.jsx(Rse,{asChild:!0,...h,children:c.jsx(fr.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...o,ref:c2(t,s.triggerRef),onPointerDown:Ht(e.onPointerDown,i=>{!n&&i.button===0&&i.ctrlKey===!1&&(s.onOpenToggle(),s.open||i.preventDefault())}),onKeyDown:Ht(e.onKeyDown,i=>{n||(["Enter"," "].includes(i.key)&&s.onOpenToggle(),i.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(i.key)&&i.preventDefault())})})})});Xq.displayName=Hq;var Zq="DropdownMenuContent",Kq=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=Wq(Zq,r),s=ca(r),h=D.useRef(!1);return c.jsx(Lse,{id:o.contentId,"aria-labelledby":o.triggerId,...s,...n,ref:t,onCloseAutoFocus:Ht(e.onCloseAutoFocus,i=>{var p;h.current||(p=o.triggerRef.current)==null||p.focus(),h.current=!1,i.preventDefault()}),onInteractOutside:Ht(e.onInteractOutside,i=>{const p=i.detail.originalEvent,y=p.button===0&&p.ctrlKey===!0,b=p.button===2||y;(!o.modal||b)&&(h.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Kq.displayName=Zq;var Yse="DropdownMenuGroup",Jse=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=ca(r);return c.jsx(Bse,{...o,...n,ref:t})});Jse.displayName=Yse;var Qse="DropdownMenuLabel",Yq=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=ca(r);return c.jsx(zse,{...o,...n,ref:t})});Yq.displayName=Qse;var ele="DropdownMenuItem",Jq=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=ca(r);return c.jsx($se,{...o,...n,ref:t})});Jq.displayName=ele;var tle="DropdownMenuCheckboxItem",rle=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=ca(r);return c.jsx(Fse,{...o,...n,ref:t})});rle.displayName=tle;var nle="DropdownMenuRadioGroup",ile=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=ca(r);return c.jsx(Use,{...o,...n,ref:t})});ile.displayName=nle;var ole="DropdownMenuRadioItem",ale=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=ca(r);return c.jsx(Vse,{...o,...n,ref:t})});ale.displayName=ole;var sle="DropdownMenuItemIndicator",lle=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=ca(r);return c.jsx(qse,{...o,...n,ref:t})});lle.displayName=sle;var cle="DropdownMenuSeparator",Qq=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=ca(r);return c.jsx(Wse,{...o,...n,ref:t})});Qq.displayName=cle;var ule="DropdownMenuArrow",dle=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=ca(r);return c.jsx(Gse,{...o,...n,ref:t})});dle.displayName=ule;var hle="DropdownMenuSubTrigger",fle=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=ca(r);return c.jsx(Hse,{...o,...n,ref:t})});fle.displayName=hle;var ple="DropdownMenuSubContent",mle=D.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=ca(r);return c.jsx(Xse,{...o,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mle.displayName=ple;var gle=Gq,yle=Xq,vle=Kq,xle=Yq,ble=Jq,_le=Qq;const wle=gle,Sle=yle,Ele=vle,nC=ble,Tle=xle,E4=_le,jle="modulepreload",Cle=function(e){return"/"+e},T4={},Js=function(t,r,n){if(!r||r.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(r.map(s=>{if(s=Cle(s),s in T4)return;T4[s]=!0;const h=s.endsWith(".css"),i=h?'[rel="stylesheet"]':"";if(!!n)for(let b=o.length-1;b>=0;b--){const _=o[b];if(_.href===s&&(!h||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${i}`))return;const y=document.createElement("link");if(y.rel=h?"stylesheet":jle,h||(y.as="script",y.crossOrigin=""),y.href=s,document.head.appendChild(y),h)return new Promise((b,_)=>{y.addEventListener("load",b),y.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t()).catch(s=>{const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=s,window.dispatchEvent(h),!h.defaultPrevented)throw s})},Ple=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Js(()=>Promise.resolve().then(()=>dg),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class KM extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Ale extends KM{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class j4 extends KM{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class C4 extends KM{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var yA;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(yA||(yA={}));var kle=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(h){h(s)})}return new(r||(r=Promise))(function(s,h){function i(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?s(b.value):o(b.value).then(i,p)}y((n=n.apply(e,t||[])).next())})};class Nle{constructor(t,{headers:r={},customFetch:n,region:o=yA.Any}={}){this.url=t,this.headers=r,this.region=o,this.fetch=Ple(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return kle(this,void 0,void 0,function*(){try{const{headers:o,method:s,body:h}=r;let i={},{region:p}=r;p||(p=this.region);const y=new URL(`${this.url}/${t}`);p&&p!=="any"&&(i["x-region"]=p,y.searchParams.set("forceFunctionRegion",p));let b;h&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(i["Content-Type"]="application/octet-stream",b=h):typeof h=="string"?(i["Content-Type"]="text/plain",b=h):typeof FormData<"u"&&h instanceof FormData?b=h:(i["Content-Type"]="application/json",b=JSON.stringify(h)));const _=yield this.fetch(y.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},i),this.headers),o),body:b}).catch(N=>{throw new Ale(N)}),E=_.headers.get("x-relay-error");if(E&&E==="true")throw new j4(_);if(!_.ok)throw new C4(_);let C=((n=_.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),k;return C==="application/json"?k=yield _.json():C==="application/octet-stream"?k=yield _.blob():C==="text/event-stream"?k=_:C==="multipart/form-data"?k=yield _.formData():k=yield _.text(),{data:k,error:null,response:_}}catch(o){return{data:null,error:o,response:o instanceof C4||o instanceof j4?o.context:void 0}}})}}var Qo={},YM={},T2={},zb={},j2={},C2={},Mle=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Cm=Mle();const Ile=Cm.fetch,eW=Cm.fetch.bind(Cm),tW=Cm.Headers,Ole=Cm.Request,Dle=Cm.Response,dg=Object.freeze(Object.defineProperty({__proto__:null,Headers:tW,Request:Ole,Response:Dle,default:eW,fetch:Ile},Symbol.toStringTag,{value:"Module"})),Rle=_Q(dg);var P2={};Object.defineProperty(P2,"__esModule",{value:!0});let Lle=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};P2.default=Lle;var rW=no&&no.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(C2,"__esModule",{value:!0});const Ble=rW(Rle),zle=rW(P2);let $le=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Ble.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let o=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var h,i,p;let y=null,b=null,_=null,E=s.status,C=s.statusText;if(s.ok){if(this.method!=="HEAD"){const B=await s.text();B===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?b=B:b=JSON.parse(B))}const N=(h=this.headers.Prefer)===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),I=(i=s.headers.get("content-range"))===null||i===void 0?void 0:i.split("/");N&&I&&I.length>1&&(_=parseInt(I[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(y={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,_=null,E=406,C="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const N=await s.text();try{y=JSON.parse(N),Array.isArray(y)&&s.status===404&&(b=[],y=null,E=200,C="OK")}catch{s.status===404&&N===""?(E=204,C="No Content"):y={message:N}}if(y&&this.isMaybeSingle&&(!((p=y==null?void 0:y.details)===null||p===void 0)&&p.includes("0 rows"))&&(y=null,E=200,C="OK"),y&&this.shouldThrowOnError)throw new zle.default(y)}return{error:y,data:b,count:_,status:E,statusText:C}});return this.shouldThrowOnError||(o=o.catch(s=>{var h,i,p;return{error:{message:`${(h=s==null?void 0:s.name)!==null&&h!==void 0?h:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(i=s==null?void 0:s.stack)!==null&&i!==void 0?i:""}`,hint:"",code:`${(p=s==null?void 0:s.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),o.then(t,r)}returns(){return this}overrideTypes(){return this}};C2.default=$le;var Fle=no&&no.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(j2,"__esModule",{value:!0});const Ule=Fle(C2);let Vle=class extends Ule.default{select(t){let r=!1;const n=(t??"*").split("").map(o=>/\s/.test(o)&&!r?"":(o==='"'&&(r=!r),o)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:o,referencedTable:s=o}={}){const h=s?`${s}.order`:"order",i=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${i?`${i},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(o,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:o=n}={}){const s=typeof o>"u"?"offset":`${o}.offset`,h=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(h,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:o=!1,wal:s=!1,format:h="text"}={}){var i;const p=[t?"analyze":null,r?"verbose":null,n?"settings":null,o?"buffers":null,s?"wal":null].filter(Boolean).join("|"),y=(i=this.headers.Accept)!==null&&i!==void 0?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${h}; for="${y}"; options=${p};`,h==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};j2.default=Vle;var qle=no&&no.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zb,"__esModule",{value:!0});const Wle=qle(j2);let Gle=class extends Wle.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:o}={}){let s="";o==="plain"?s="pl":o==="phrase"?s="ph":o==="websearch"&&(s="w");const h=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${h}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const o=n?`${n}.or`:"or";return this.url.searchParams.append(o,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};zb.default=Gle;var Hle=no&&no.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(T2,"__esModule",{value:!0});const vv=Hle(zb);let Xle=class{constructor(t,{headers:r={},schema:n,fetch:o}){this.url=t,this.headers=r,this.schema=n,this.fetch=o}select(t,{head:r=!1,count:n}={}){const o=r?"HEAD":"GET";let s=!1;const h=(t??"*").split("").map(i=>/\s/.test(i)&&!s?"":(i==='"'&&(s=!s),i)).join("");return this.url.searchParams.set("select",h),n&&(this.headers.Prefer=`count=${n}`),new vv.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const o="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const h=t.reduce((i,p)=>i.concat(Object.keys(p)),[]);if(h.length>0){const i=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",i.join(","))}}return new vv.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:o,defaultToNull:s=!0}={}){const h="POST",i=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&i.push(this.headers.Prefer),o&&i.push(`count=${o}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const p=t.reduce((y,b)=>y.concat(Object.keys(b)),[]);if(p.length>0){const y=[...new Set(p)].map(b=>`"${b}"`);this.url.searchParams.set("columns",y.join(","))}}return new vv.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),r&&o.push(`count=${r}`),this.headers.Prefer=o.join(","),new vv.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new vv.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};T2.default=Xle;var A2={},k2={};Object.defineProperty(k2,"__esModule",{value:!0});k2.version=void 0;k2.version="0.0.0-automated";Object.defineProperty(A2,"__esModule",{value:!0});A2.DEFAULT_HEADERS=void 0;const Zle=k2;A2.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Zle.version}`};var nW=no&&no.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(YM,"__esModule",{value:!0});const Kle=nW(T2),Yle=nW(zb),Jle=A2;let Qle=class iW{constructor(t,{headers:r={},schema:n,fetch:o}={}){this.url=t,this.headers=Object.assign(Object.assign({},Jle.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=o}from(t){const r=new URL(`${this.url}/${t}`);return new Kle.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new iW(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:o=!1,count:s}={}){let h;const i=new URL(`${this.url}/rpc/${t}`);let p;n||o?(h=n?"HEAD":"GET",Object.entries(r).filter(([b,_])=>_!==void 0).map(([b,_])=>[b,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([b,_])=>{i.searchParams.append(b,_)})):(h="POST",p=r);const y=Object.assign({},this.headers);return s&&(y.Prefer=`count=${s}`),new Yle.default({method:h,url:i,headers:y,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}};YM.default=Qle;var hg=no&&no.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Qo,"__esModule",{value:!0});Qo.PostgrestError=Qo.PostgrestBuilder=Qo.PostgrestTransformBuilder=Qo.PostgrestFilterBuilder=Qo.PostgrestQueryBuilder=Qo.PostgrestClient=void 0;const oW=hg(YM);Qo.PostgrestClient=oW.default;const aW=hg(T2);Qo.PostgrestQueryBuilder=aW.default;const sW=hg(zb);Qo.PostgrestFilterBuilder=sW.default;const lW=hg(j2);Qo.PostgrestTransformBuilder=lW.default;const cW=hg(C2);Qo.PostgrestBuilder=cW.default;const uW=hg(P2);Qo.PostgrestError=uW.default;var ece=Qo.default={PostgrestClient:oW.default,PostgrestQueryBuilder:aW.default,PostgrestFilterBuilder:sW.default,PostgrestTransformBuilder:lW.default,PostgrestBuilder:cW.default,PostgrestError:uW.default};const{PostgrestClient:tce,PostgrestQueryBuilder:VUe,PostgrestFilterBuilder:qUe,PostgrestTransformBuilder:WUe,PostgrestBuilder:GUe,PostgrestError:HUe}=ece;function rce(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const nce=rce(),ice="2.11.15",oce=`realtime-js/${ice}`,ace="1.0.0",dW=1e4,sce=1e3;var tx;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(tx||(tx={}));var bo;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(bo||(bo={}));var Ls;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ls||(Ls={}));var vA;(function(e){e.websocket="websocket"})(vA||(vA={}));var Rh;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Rh||(Rh={}));class lce{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const o=r.getUint8(1),s=r.getUint8(2);let h=this.HEADER_LENGTH+2;const i=n.decode(t.slice(h,h+o));h=h+o;const p=n.decode(t.slice(h,h+s));h=h+s;const y=JSON.parse(n.decode(t.slice(h,t.byteLength)));return{ref:null,topic:i,event:p,payload:y}}}class hW{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Nn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Nn||(Nn={}));const P4=(e,t,r={})=>{var n;const o=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,h)=>(s[h]=cce(h,e,t,o),s),{})},cce=(e,t,r,n)=>{const o=t.find(i=>i.name===e),s=o==null?void 0:o.type,h=r[e];return s&&!n.includes(s)?fW(s,h):xA(h)},fW=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return fce(t,r)}switch(e){case Nn.bool:return uce(t);case Nn.float4:case Nn.float8:case Nn.int2:case Nn.int4:case Nn.int8:case Nn.numeric:case Nn.oid:return dce(t);case Nn.json:case Nn.jsonb:return hce(t);case Nn.timestamp:return pce(t);case Nn.abstime:case Nn.date:case Nn.daterange:case Nn.int4range:case Nn.int8range:case Nn.money:case Nn.reltime:case Nn.text:case Nn.time:case Nn.timestamptz:case Nn.timetz:case Nn.tsrange:case Nn.tstzrange:return xA(t);default:return xA(t)}},xA=e=>e,uce=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},dce=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},hce=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},fce=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const h=e.slice(1,r);try{s=JSON.parse("["+h+"]")}catch{s=h?h.split(","):[]}return s.map(i=>fW(t,i))}return e},pce=e=>typeof e=="string"?e.replace(" ","T"):e,pW=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class iC{constructor(t,r,n={},o=dW){this.channel=t,this.event=r,this.payload=n,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var A4;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(A4||(A4={}));class rx{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},o=>{const{onJoin:s,onLeave:h,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=rx.syncState(this.state,o,s,h),this.pendingDiffs.forEach(p=>{this.state=rx.syncDiff(this.state,p,s,h)}),this.pendingDiffs=[],i()}),this.channel._on(n.diff,{},o=>{const{onJoin:s,onLeave:h,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=rx.syncDiff(this.state,o,s,h),i())}),this.onJoin((o,s,h)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:s,newPresences:h})}),this.onLeave((o,s,h)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:s,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,o){const s=this.cloneDeep(t),h=this.transformState(r),i={},p={};return this.map(s,(y,b)=>{h[y]||(p[y]=b)}),this.map(h,(y,b)=>{const _=s[y];if(_){const E=b.map(I=>I.presence_ref),C=_.map(I=>I.presence_ref),k=b.filter(I=>C.indexOf(I.presence_ref)<0),N=_.filter(I=>E.indexOf(I.presence_ref)<0);k.length>0&&(i[y]=k),N.length>0&&(p[y]=N)}else i[y]=b}),this.syncDiff(s,{joins:i,leaves:p},n,o)}static syncDiff(t,r,n,o){const{joins:s,leaves:h}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),o||(o=()=>{}),this.map(s,(i,p)=>{var y;const b=(y=t[i])!==null&&y!==void 0?y:[];if(t[i]=this.cloneDeep(p),b.length>0){const _=t[i].map(C=>C.presence_ref),E=b.filter(C=>_.indexOf(C.presence_ref)<0);t[i].unshift(...E)}n(i,b,p)}),this.map(h,(i,p)=>{let y=t[i];if(!y)return;const b=p.map(_=>_.presence_ref);y=y.filter(_=>b.indexOf(_.presence_ref)<0),t[i]=y,o(i,y,p),y.length===0&&delete t[i]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const o=t[n];return"metas"in o?r[n]=o.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=o,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var k4;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(k4||(k4={}));var N4;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(N4||(N4={}));var cc;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(cc||(cc={}));class JM{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=bo.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new iC(this,Ls.join,this.params,this.timeout),this.rejoinTimer=new hW(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=bo.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=bo.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=bo.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=bo.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ls.reply,{},(o,s)=>{this._trigger(this._replyEventName(s),o)}),this.presence=new rx(this),this.broadcastEndpointURL=pW(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,o;if(this.socket.isConnected()||this.socket.connect(),this.state==bo.closed){const{config:{broadcast:s,presence:h,private:i}}=this.params;this._onError(b=>t==null?void 0:t(cc.CHANNEL_ERROR,b)),this._onClose(()=>t==null?void 0:t(cc.CLOSED));const p={},y={broadcast:s,presence:h,postgres_changes:(o=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(b=>b.filter))!==null&&o!==void 0?o:[],private:i};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:y},p)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:b})=>{var _;if(this.socket.setAuth(),b===void 0){t==null||t(cc.SUBSCRIBED);return}else{const E=this.bindings.postgres_changes,C=(_=E==null?void 0:E.length)!==null&&_!==void 0?_:0,k=[];for(let N=0;N<C;N++){const I=E[N],{filter:{event:B,schema:O,table:R,filter:q}}=I,F=b&&b[N];if(F&&F.event===B&&F.schema===O&&F.table===R&&F.filter===q)k.push(Object.assign(Object.assign({},I),{id:F.id}));else{this.unsubscribe(),this.state=bo.errored,t==null||t(cc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,t&&t(cc.SUBSCRIBED);return}}).receive("error",b=>{this.state=bo.errored,t==null||t(cc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(cc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,o;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:h}=t,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:h,private:this.private}]})};try{const y=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((o=y.body)===null||o===void 0?void 0:o.cancel()),y.ok?"ok":"error"}catch(y){return y.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var h,i,p;const y=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((p=(i=(h=this.params)===null||h===void 0?void 0:h.config)===null||i===void 0?void 0:i.broadcast)===null||p===void 0)&&p.ack)&&s("ok"),y.receive("ok",()=>s("ok")),y.receive("error",()=>s("error")),y.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=bo.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ls.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(o=>{n=new iC(this,Ls.leave,{},t),n.receive("ok",()=>{r(),o("ok")}).receive("timeout",()=>{r(),o("timed out")}).receive("error",()=>{o("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const o=new AbortController,s=setTimeout(()=>o.abort(),n),h=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(s),h}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new iC(this,t,r,n);return this._canPush()?o.send():(o.startTimeout(),this.pushBuffer.push(o)),o}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var o,s;const h=t.toLocaleLowerCase(),{close:i,error:p,leave:y,join:b}=Ls;if(n&&[i,p,y,b].indexOf(h)>=0&&n!==this._joinRef())return;let E=this._onMessage(h,r,n);if(r&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(C=>{var k,N,I;return((k=C.filter)===null||k===void 0?void 0:k.event)==="*"||((I=(N=C.filter)===null||N===void 0?void 0:N.event)===null||I===void 0?void 0:I.toLocaleLowerCase())===h}).map(C=>C.callback(E,n)):(s=this.bindings[h])===null||s===void 0||s.filter(C=>{var k,N,I,B,O,R;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in C){const q=C.id,F=(k=C.filter)===null||k===void 0?void 0:k.event;return q&&((N=r.ids)===null||N===void 0?void 0:N.includes(q))&&(F==="*"||(F==null?void 0:F.toLocaleLowerCase())===((I=r.data)===null||I===void 0?void 0:I.type.toLocaleLowerCase()))}else{const q=(O=(B=C==null?void 0:C.filter)===null||B===void 0?void 0:B.event)===null||O===void 0?void 0:O.toLocaleLowerCase();return q==="*"||q===((R=r==null?void 0:r.event)===null||R===void 0?void 0:R.toLocaleLowerCase())}else return C.type.toLocaleLowerCase()===h}).map(C=>{if(typeof E=="object"&&"ids"in E){const k=E.data,{schema:N,table:I,commit_timestamp:B,type:O,errors:R}=k;E=Object.assign(Object.assign({},{schema:N,table:I,commit_timestamp:B,eventType:O,new:{},old:{},errors:R}),this._getPayloadRecords(k))}C.callback(E,n)})}_isClosed(){return this.state===bo.closed}_isJoined(){return this.state===bo.joined}_isJoining(){return this.state===bo.joining}_isLeaving(){return this.state===bo.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const o=t.toLocaleLowerCase(),s={type:o,filter:r,callback:n};return this.bindings[o]?this.bindings[o].push(s):this.bindings[o]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(o=>{var s;return!(((s=o.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&JM.isEqual(o.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ls.close,{},t)}_onError(t){this._on(Ls.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=bo.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=P4(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=P4(t.columns,t.old_record)),r}}const M4=()=>{},mce=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class gce{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=dW,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=M4,this.ref=0,this.logger=M4,this.conn=null,this.sendBuffer=[],this.serializer=new lce,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let h;return s?h=s:typeof fetch>"u"?h=(...i)=>Js(()=>Promise.resolve().then(()=>dg),void 0).then(({default:p})=>p(...i)):h=fetch,(...i)=>h(...i)},this.endPoint=`${t}/${vA.websocket}`,this.httpEndpoint=pW(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const o=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(o&&(this.accessTokenValue=o,this.apiKey=o),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,h)=>h(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new hW(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=nce),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ace}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case tx.connecting:return Rh.Connecting;case tx.open:return Rh.Open;case tx.closing:return Rh.Closing;default:return Rh.Closed}}isConnected(){return this.connectionState()===Rh.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,o=this.getChannels().find(s=>s.topic===n);if(o)return o;{const s=new JM(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:o,ref:s}=t,h=()=>{this.encode(t,i=>{var p;(p=this.conn)===null||p===void 0||p.send(i)})};this.log("push",`${r} ${n} (${s})`,o),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const o={access_token:r,version:oce};r&&n.updateJoinPayload(o),n.joinedOnce&&n._isJoined()&&n._push(Ls.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(sce,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:o,payload:s,ref:h}=r;n==="phoenix"&&o==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),h&&h===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${o} ${h&&"("+h+")"||""}`,s),Array.from(this.channels).filter(i=>i._isMember(n)).forEach(i=>i._trigger(o,s,h)),this.stateChangeCallbacks.message.forEach(i=>i(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ls.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${t}${n}${o}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([mce],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class QM extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Gi(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class yce extends QM{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class bA extends QM{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var vce=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(h){h(s)})}return new(r||(r=Promise))(function(s,h){function i(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?s(b.value):o(b.value).then(i,p)}y((n=n.apply(e,t||[])).next())})};const mW=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Js(()=>Promise.resolve().then(()=>dg),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},xce=()=>vce(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Js(()=>Promise.resolve().then(()=>dg),void 0)).Response:Response}),_A=e=>{if(Array.isArray(e))return e.map(r=>_A(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const o=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[o]=_A(n)}),t};var bf=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(h){h(s)})}return new(r||(r=Promise))(function(s,h){function i(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?s(b.value):o(b.value).then(i,p)}y((n=n.apply(e,t||[])).next())})};const oC=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),bce=(e,t,r)=>bf(void 0,void 0,void 0,function*(){const n=yield xce();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(o=>{t(new yce(oC(o),e.status||500))}).catch(o=>{t(new bA(oC(o),o))}):t(new bA(oC(e),e))}),_ce=(e,t,r,n)=>{const o={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(o.body=JSON.stringify(n)),Object.assign(Object.assign({},o),r))};function $b(e,t,r,n,o,s){return bf(this,void 0,void 0,function*(){return new Promise((h,i)=>{e(r,_ce(t,n,o,s)).then(p=>{if(!p.ok)throw p;return n!=null&&n.noResolveJson?p:p.json()}).then(p=>h(p)).catch(p=>bce(p,i,n))})})}function A1(e,t,r,n){return bf(this,void 0,void 0,function*(){return $b(e,"GET",t,r,n)})}function zu(e,t,r,n,o){return bf(this,void 0,void 0,function*(){return $b(e,"POST",t,n,o,r)})}function wce(e,t,r,n,o){return bf(this,void 0,void 0,function*(){return $b(e,"PUT",t,n,o,r)})}function Sce(e,t,r,n){return bf(this,void 0,void 0,function*(){return $b(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function gW(e,t,r,n,o){return bf(this,void 0,void 0,function*(){return $b(e,"DELETE",t,n,o,r)})}var Yo=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(h){h(s)})}return new(r||(r=Promise))(function(s,h){function i(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?s(b.value):o(b.value).then(i,p)}y((n=n.apply(e,t||[])).next())})};const Ece={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},I4={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Tce{constructor(t,r={},n,o){this.url=t,this.headers=r,this.bucketId=n,this.fetch=mW(o)}uploadOrUpdate(t,r,n,o){return Yo(this,void 0,void 0,function*(){try{let s;const h=Object.assign(Object.assign({},I4),o);let i=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(h.upsert)});const p=h.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",h.cacheControl),p&&s.append("metadata",this.encodeMetadata(p)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",h.cacheControl),p&&s.append("metadata",this.encodeMetadata(p))):(s=n,i["cache-control"]=`max-age=${h.cacheControl}`,i["content-type"]=h.contentType,p&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(p)))),o!=null&&o.headers&&(i=Object.assign(Object.assign({},i),o.headers));const y=this._removeEmptyFolders(r),b=this._getFinalPath(y),_=yield this.fetch(`${this.url}/object/${b}`,Object.assign({method:t,body:s,headers:i},h!=null&&h.duplex?{duplex:h.duplex}:{})),E=yield _.json();return _.ok?{data:{path:y,id:E.Id,fullPath:E.Key},error:null}:{data:null,error:E}}catch(s){if(Gi(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Yo(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,o){return Yo(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),h=this._getFinalPath(s),i=new URL(this.url+`/object/upload/sign/${h}`);i.searchParams.set("token",r);try{let p;const y=Object.assign({upsert:I4.upsert},o),b=Object.assign(Object.assign({},this.headers),{"x-upsert":String(y.upsert)});typeof Blob<"u"&&n instanceof Blob?(p=new FormData,p.append("cacheControl",y.cacheControl),p.append("",n)):typeof FormData<"u"&&n instanceof FormData?(p=n,p.append("cacheControl",y.cacheControl)):(p=n,b["cache-control"]=`max-age=${y.cacheControl}`,b["content-type"]=y.contentType);const _=yield this.fetch(i.toString(),{method:"PUT",body:p,headers:b}),E=yield _.json();return _.ok?{data:{path:s,fullPath:E.Key},error:null}:{data:null,error:E}}catch(p){if(Gi(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(t,r){return Yo(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const o=Object.assign({},this.headers);r!=null&&r.upsert&&(o["x-upsert"]="true");const s=yield zu(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:o}),h=new URL(this.url+s.url),i=h.searchParams.get("token");if(!i)throw new QM("No token returned by API");return{data:{signedUrl:h.toString(),path:t,token:i},error:null}}catch(n){if(Gi(n))return{data:null,error:n};throw n}})}update(t,r,n){return Yo(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Yo(this,void 0,void 0,function*(){try{return{data:yield zu(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(Gi(o))return{data:null,error:o};throw o}})}copy(t,r,n){return Yo(this,void 0,void 0,function*(){try{return{data:{path:(yield zu(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(Gi(o))return{data:null,error:o};throw o}})}createSignedUrl(t,r,n){return Yo(this,void 0,void 0,function*(){try{let o=this._getFinalPath(t),s=yield zu(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const h=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${h}`)},{data:s,error:null}}catch(o){if(Gi(o))return{data:null,error:o};throw o}})}createSignedUrls(t,r,n){return Yo(this,void 0,void 0,function*(){try{const o=yield zu(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:o.map(h=>Object.assign(Object.assign({},h),{signedUrl:h.signedURL?encodeURI(`${this.url}${h.signedURL}${s}`):null})),error:null}}catch(o){if(Gi(o))return{data:null,error:o};throw o}})}download(t,r){return Yo(this,void 0,void 0,function*(){const o=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),h=s?`?${s}`:"";try{const i=this._getFinalPath(t);return{data:yield(yield A1(this.fetch,`${this.url}/${o}/${i}${h}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(i){if(Gi(i))return{data:null,error:i};throw i}})}info(t){return Yo(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield A1(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:_A(n),error:null}}catch(n){if(Gi(n))return{data:null,error:n};throw n}})}exists(t){return Yo(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Sce(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Gi(n)&&n instanceof bA){const o=n.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),o=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&o.push(s);const i=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",p=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});p!==""&&o.push(p);let y=o.join("&");return y!==""&&(y=`?${y}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${y}`)}}}remove(t){return Yo(this,void 0,void 0,function*(){try{return{data:yield gW(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Gi(r))return{data:null,error:r};throw r}})}list(t,r,n){return Yo(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},Ece),r),{prefix:t||""});return{data:yield zu(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},n),error:null}}catch(o){if(Gi(o))return{data:null,error:o};throw o}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const jce="2.7.1",Cce={"X-Client-Info":`storage-js/${jce}`};var Np=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(h){h(s)})}return new(r||(r=Promise))(function(s,h){function i(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?s(b.value):o(b.value).then(i,p)}y((n=n.apply(e,t||[])).next())})};class Pce{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},Cce),r),this.fetch=mW(n)}listBuckets(){return Np(this,void 0,void 0,function*(){try{return{data:yield A1(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Gi(t))return{data:null,error:t};throw t}})}getBucket(t){return Np(this,void 0,void 0,function*(){try{return{data:yield A1(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Gi(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Np(this,void 0,void 0,function*(){try{return{data:yield zu(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Gi(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Np(this,void 0,void 0,function*(){try{return{data:yield wce(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Gi(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Np(this,void 0,void 0,function*(){try{return{data:yield zu(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Gi(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Np(this,void 0,void 0,function*(){try{return{data:yield gW(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Gi(r))return{data:null,error:r};throw r}})}}class Ace extends Pce{constructor(t,r={},n){super(t,r,n)}from(t){return new Tce(this.url,this.headers,t,this.fetch)}}const kce="2.50.3";let Fv="";typeof Deno<"u"?Fv="deno":typeof document<"u"?Fv="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Fv="react-native":Fv="node";const Nce={"X-Client-Info":`supabase-js-${Fv}/${kce}`},Mce={headers:Nce},Ice={schema:"public"},Oce={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Dce={};var Rce=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(h){h(s)})}return new(r||(r=Promise))(function(s,h){function i(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?s(b.value):o(b.value).then(i,p)}y((n=n.apply(e,t||[])).next())})};const Lce=e=>{let t;return e?t=e:typeof fetch>"u"?t=eW:t=fetch,(...r)=>t(...r)},Bce=()=>typeof Headers>"u"?tW:Headers,zce=(e,t,r)=>{const n=Lce(r),o=Bce();return(s,h)=>Rce(void 0,void 0,void 0,function*(){var i;const p=(i=yield t())!==null&&i!==void 0?i:e;let y=new o(h==null?void 0:h.headers);return y.has("apikey")||y.set("apikey",e),y.has("Authorization")||y.set("Authorization",`Bearer ${p}`),n(s,Object.assign(Object.assign({},h),{headers:y}))})};var $ce=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(h){h(s)})}return new(r||(r=Promise))(function(s,h){function i(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?s(b.value):o(b.value).then(i,p)}y((n=n.apply(e,t||[])).next())})};function Fce(e){return e.endsWith("/")?e:e+"/"}function Uce(e,t){var r,n;const{db:o,auth:s,realtime:h,global:i}=e,{db:p,auth:y,realtime:b,global:_}=t,E={db:Object.assign(Object.assign({},p),o),auth:Object.assign(Object.assign({},y),s),realtime:Object.assign(Object.assign({},b),h),global:Object.assign(Object.assign(Object.assign({},_),i),{headers:Object.assign(Object.assign({},(r=_==null?void 0:_.headers)!==null&&r!==void 0?r:{}),(n=i==null?void 0:i.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>$ce(this,void 0,void 0,function*(){return""})};return e.accessToken?E.accessToken=e.accessToken:delete E.accessToken,E}const yW="2.70.0",$p=30*1e3,wA=3,aC=wA*$p,Vce="http://localhost:9999",qce="supabase.auth.token",Wce={"X-Client-Info":`gotrue-js/${yW}`},SA="X-Supabase-Api-Version",vW={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Gce=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Hce=6e5;class eI extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ar(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Xce extends eI{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Zce(e){return Ar(e)&&e.name==="AuthApiError"}class xW extends eI{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Sd extends eI{constructor(t,r,n,o){super(t,n,o),this.name=r,this.status=n}}class Nu extends Sd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Kce(e){return Ar(e)&&e.name==="AuthSessionMissingError"}class Q_ extends Sd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ew extends Sd{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class tw extends Sd{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Yce(e){return Ar(e)&&e.name==="AuthImplicitGrantRedirectError"}class O4 extends Sd{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class EA extends Sd{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function sC(e){return Ar(e)&&e.name==="AuthRetryableFetchError"}class D4 extends Sd{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class nx extends Sd{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const k1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),R4=` 	
\r=`.split(""),Jce=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<R4.length;t+=1)e[R4[t].charCodeAt(0)]=-2;for(let t=0;t<k1.length;t+=1)e[k1[t].charCodeAt(0)]=t;return e})();function L4(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(k1[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(k1[n]),t.queuedBits-=6}}function bW(e,t,r){const n=Jce[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function B4(e){const t=[],r=h=>{t.push(String.fromCodePoint(h))},n={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},s=h=>{tue(h,n,r)};for(let h=0;h<e.length;h+=1)bW(e.charCodeAt(h),o,s);return t.join("")}function Qce(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function eue(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const o=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}Qce(n,t)}}function tue(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function rue(e){const t=[],r={queue:0,queuedBits:0},n=o=>{t.push(o)};for(let o=0;o<e.length;o+=1)bW(e.charCodeAt(o),r,n);return new Uint8Array(t)}function nue(e){const t=[];return eue(e,r=>t.push(r)),new Uint8Array(t)}function iue(e){const t=[],r={queue:0,queuedBits:0},n=o=>{t.push(o)};return e.forEach(o=>L4(o,r,n)),L4(null,r,n),t.join("")}function oue(e){return Math.round(Date.now()/1e3)+e}function aue(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Is=()=>typeof window<"u"&&typeof document<"u",wh={tested:!1,writable:!1},ix=()=>{if(!Is())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(wh.tested)return wh.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),wh.tested=!0,wh.writable=!0}catch{wh.tested=!0,wh.writable=!1}return wh.writable};function sue(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,s)=>{t[s]=o})}catch{}return r.searchParams.forEach((n,o)=>{t[o]=n}),t}const _W=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Js(()=>Promise.resolve().then(()=>dg),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},lue=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",wW=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},rw=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},nw=async(e,t)=>{await e.removeItem(t)};class N2{constructor(){this.promise=new N2.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}N2.promiseConstructor=Promise;function lC(e){const t=e.split(".");if(t.length!==3)throw new nx("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Gce.test(t[n]))throw new nx("JWT not in base64url format");return{header:JSON.parse(B4(t[0])),payload:JSON.parse(B4(t[1])),signature:rue(t[2]),raw:{header:t[0],payload:t[1]}}}async function cue(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function uue(e,t){return new Promise((n,o)=>{(async()=>{for(let s=0;s<1/0;s++)try{const h=await e(s);if(!t(s,null,h)){n(h);return}}catch(h){if(!t(s,h)){o(h);return}}})()})}function due(e){return("0"+e.toString(16)).substr(-2)}function hue(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let o="";for(let s=0;s<56;s++)o+=r.charAt(Math.floor(Math.random()*n));return o}return crypto.getRandomValues(t),Array.from(t,due).join("")}async function fue(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(n);return Array.from(o).map(s=>String.fromCharCode(s)).join("")}async function pue(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await fue(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Mp(e,t,r=!1){const n=hue();let o=n;r&&(o+="/PASSWORD_RECOVERY"),await wW(e,`${t}-code-verifier`,o);const s=await pue(n);return[s,n===s?"plain":"s256"]}const mue=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function gue(e){const t=e.headers.get(SA);if(!t||!t.match(mue))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function yue(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function vue(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const xue=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ip(e){if(!xue.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var bue=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};const Ph=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),_ue=[502,503,504];async function z4(e){var t;if(!lue(e))throw new EA(Ph(e),0);if(_ue.includes(e.status))throw new EA(Ph(e),e.status);let r;try{r=await e.json()}catch(s){throw new xW(Ph(s),s)}let n;const o=gue(e);if(o&&o.getTime()>=vW["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new D4(Ph(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Nu}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,h)=>s&&typeof h=="string",!0))throw new D4(Ph(r),e.status,r.weak_password.reasons);throw new Xce(Ph(r),e.status||500,n)}const wue=(e,t,r,n)=>{const o={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),o.body=JSON.stringify(n),Object.assign(Object.assign({},o),r))};async function Br(e,t,r,n){var o;const s=Object.assign({},n==null?void 0:n.headers);s[SA]||(s[SA]=vW["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const h=(o=n==null?void 0:n.query)!==null&&o!==void 0?o:{};n!=null&&n.redirectTo&&(h.redirect_to=n.redirectTo);const i=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",p=await Sue(e,t,r+i,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(p):{data:Object.assign({},p),error:null}}async function Sue(e,t,r,n,o,s){const h=wue(t,n,o,s);let i;try{i=await e(r,Object.assign({},h))}catch(p){throw console.error(p),new EA(Ph(p),0)}if(i.ok||await z4(i),n!=null&&n.noResolveJson)return i;try{return await i.json()}catch(p){await z4(p)}}function sc(e){var t;let r=null;Cue(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=oue(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function $4(e){const t=sc(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function qu(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Eue(e){return{data:e,error:null}}function Tue(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:o,verification_type:s}=e,h=bue(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),i={action_link:t,email_otp:r,hashed_token:n,redirect_to:o,verification_type:s},p=Object.assign({},h);return{data:{properties:i,user:p},error:null}}function jue(e){return e}function Cue(e){return e.access_token&&e.refresh_token&&e.expires_in}const cC=["global","local","others"];var Pue=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};class Aue{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=_W(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=cC[0]){if(cC.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${cC.join(", ")}`);try{return await Br(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ar(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Br(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:qu})}catch(n){if(Ar(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Pue(t,["options"]),o=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(o.new_email=n==null?void 0:n.newEmail,delete o.newEmail),await Br(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:Tue,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ar(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Br(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:qu})}catch(r){if(Ar(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,o,s,h,i,p;try{const y={nextPage:null,lastPage:0,total:0},b=await Br(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(o=t==null?void 0:t.perPage)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""},xform:jue});if(b.error)throw b.error;const _=await b.json(),E=(h=b.headers.get("x-total-count"))!==null&&h!==void 0?h:0,C=(p=(i=b.headers.get("link"))===null||i===void 0?void 0:i.split(","))!==null&&p!==void 0?p:[];return C.length>0&&(C.forEach(k=>{const N=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),I=JSON.parse(k.split(";")[1].split("=")[1]);y[`${I}Page`]=N}),y.total=parseInt(E)),{data:Object.assign(Object.assign({},_),y),error:null}}catch(y){if(Ar(y))return{data:{users:[]},error:y};throw y}}async getUserById(t){Ip(t);try{return await Br(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:qu})}catch(r){if(Ar(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Ip(t);try{return await Br(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:qu})}catch(n){if(Ar(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Ip(t);try{return await Br(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:qu})}catch(n){if(Ar(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Ip(t.userId);try{const{data:r,error:n}=await Br(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:n}}catch(r){if(Ar(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Ip(t.userId),Ip(t.id);try{return{data:await Br(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ar(r))return{data:null,error:r};throw r}}}const kue={getItem:e=>ix()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{ix()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{ix()&&globalThis.localStorage.removeItem(e)}};function F4(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function Nue(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Op={debug:!!(globalThis&&ix()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class SW extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Mue extends SW{}async function Iue(e,t,r){Op.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Op.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async o=>{if(o){Op.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,o.name);try{return await r()}finally{Op.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,o.name)}}else{if(t===0)throw Op.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Mue(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Op.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Nue();const Oue={url:Vce,storageKey:qce,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Wce,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function U4(e,t,r){return await r()}class Fx{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Fx.nextInstanceID,Fx.nextInstanceID+=1,this.instanceID>0&&Is()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},Oue),t);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Aue({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=_W(o.fetch),this.lock=o.lock||U4,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Is()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Iue:this.lock=U4,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?o.storage?this.storage=o.storage:ix()?this.storage=kue:(this.memoryStorage={},this.storage=F4(this.memoryStorage)):(this.memoryStorage={},this.storage=F4(this.memoryStorage)),Is()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${yW}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=sue(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Is()&&this.detectSessionInUrl&&n!=="none"){const{data:o,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),Yce(s)){const p=(t=s.details)===null||t===void 0?void 0:t.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:h,redirectType:i}=o;return this._debug("#_initialize()","detected session in URL",h,"redirect type",i),await this._saveSession(h),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ar(r)?{error:r}:{error:new xW("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,o;try{const s=await Br(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(o=t==null?void 0:t.options)===null||o===void 0?void 0:o.captchaToken}},xform:sc}),{data:h,error:i}=s;if(i||!h)return{data:{user:null,session:null},error:i};const p=h.session,y=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:y,session:p},error:null}}catch(s){if(Ar(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,o;try{let s;if("email"in t){const{email:b,password:_,options:E}=t;let C=null,k=null;this.flowType==="pkce"&&([C,k]=await Mp(this.storage,this.storageKey)),s=await Br(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:b,password:_,data:(r=E==null?void 0:E.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:C,code_challenge_method:k},xform:sc})}else if("phone"in t){const{phone:b,password:_,options:E}=t;s=await Br(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:_,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},channel:(o=E==null?void 0:E.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:sc})}else throw new ew("You must provide either an email or phone number and a password");const{data:h,error:i}=s;if(i||!h)return{data:{user:null,session:null},error:i};const p=h.session,y=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:y,session:p},error:null}}catch(s){if(Ar(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:h,options:i}=t;r=await Br(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:h,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:$4})}else if("phone"in t){const{phone:s,password:h,options:i}=t;r=await Br(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:h,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:$4})}else throw new ew("You must provide either an email or phone number and a password");const{data:n,error:o}=r;return o?{data:{user:null,session:null},error:o}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Q_}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:o})}catch(r){if(Ar(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,o,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(o=t.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,o,s,h,i,p,y,b,_,E,C;let k,N;if("message"in t)k=t.message,N=t.signature;else{const{chain:I,wallet:B,statement:O,options:R}=t;let q;if(Is())if(typeof B=="object")q=B;else{const X=window;if("solana"in X&&typeof X.solana=="object"&&("signIn"in X.solana&&typeof X.solana.signIn=="function"||"signMessage"in X.solana&&typeof X.solana.signMessage=="function"))q=X.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof B!="object"||!(R!=null&&R.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");q=B}const F=new URL((r=R==null?void 0:R.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in q&&q.signIn){const X=await q.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},R==null?void 0:R.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),O?{statement:O}:null));let G;if(Array.isArray(X)&&X[0]&&typeof X[0]=="object")G=X[0];else if(X&&typeof X=="object"&&"signedMessage"in X&&"signature"in X)G=X;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in G&&"signature"in G&&(typeof G.signedMessage=="string"||G.signedMessage instanceof Uint8Array)&&G.signature instanceof Uint8Array)k=typeof G.signedMessage=="string"?G.signedMessage:new TextDecoder().decode(G.signedMessage),N=G.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in q)||typeof q.signMessage!="function"||!("publicKey"in q)||typeof q!="object"||!q.publicKey||!("toBase58"in q.publicKey)||typeof q.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");k=[`${F.host} wants you to sign in with your Solana account:`,q.publicKey.toBase58(),...O?["",O,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(o=(n=R==null?void 0:R.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((s=R==null?void 0:R.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${R.signInWithSolana.notBefore}`]:[],...!((h=R==null?void 0:R.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${R.signInWithSolana.expirationTime}`]:[],...!((i=R==null?void 0:R.signInWithSolana)===null||i===void 0)&&i.chainId?[`Chain ID: ${R.signInWithSolana.chainId}`]:[],...!((p=R==null?void 0:R.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${R.signInWithSolana.nonce}`]:[],...!((y=R==null?void 0:R.signInWithSolana)===null||y===void 0)&&y.requestId?[`Request ID: ${R.signInWithSolana.requestId}`]:[],...!((_=(b=R==null?void 0:R.signInWithSolana)===null||b===void 0?void 0:b.resources)===null||_===void 0)&&_.length?["Resources",...R.signInWithSolana.resources.map(G=>`- ${G}`)]:[]].join(`
`);const X=await q.signMessage(new TextEncoder().encode(k),"utf8");if(!X||!(X instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");N=X}}try{const{data:I,error:B}=await Br(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:k,signature:iue(N)},!((E=t.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(C=t.options)===null||C===void 0?void 0:C.captchaToken}}:null),xform:sc});if(B)throw B;return!I||!I.session||!I.user?{data:{user:null,session:null},error:new Q_}:(I.session&&(await this._saveSession(I.session),await this._notifyAllSubscribers("SIGNED_IN",I.session)),{data:Object.assign({},I),error:B})}catch(I){if(Ar(I))return{data:{user:null,session:null},error:I};throw I}}async _exchangeCodeForSession(t){const r=await rw(this.storage,`${this.storageKey}-code-verifier`),[n,o]=(r??"").split("/");try{const{data:s,error:h}=await Br(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:sc});if(await nw(this.storage,`${this.storageKey}-code-verifier`),h)throw h;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Q_}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:o??null}),error:h})}catch(s){if(Ar(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:o,access_token:s,nonce:h}=t,i=await Br(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:o,access_token:s,nonce:h,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:sc}),{data:p,error:y}=i;return y?{data:{user:null,session:null},error:y}:!p||!p.session||!p.user?{data:{user:null,session:null},error:new Q_}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),{data:p,error:y})}catch(r){if(Ar(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,o,s,h;try{if("email"in t){const{email:i,options:p}=t;let y=null,b=null;this.flowType==="pkce"&&([y,b]=await Mp(this.storage,this.storageKey));const{error:_}=await Br(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},create_user:(n=p==null?void 0:p.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:y,code_challenge_method:b},redirectTo:p==null?void 0:p.emailRedirectTo});return{data:{user:null,session:null},error:_}}if("phone"in t){const{phone:i,options:p}=t,{data:y,error:b}=await Br(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:i,data:(o=p==null?void 0:p.data)!==null&&o!==void 0?o:{},create_user:(s=p==null?void 0:p.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},channel:(h=p==null?void 0:p.channel)!==null&&h!==void 0?h:"sms"}});return{data:{user:null,session:null,messageId:y==null?void 0:y.message_id},error:b}}throw new ew("You must provide either an email or phone number.")}catch(i){if(Ar(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(t){var r,n;try{let o,s;"options"in t&&(o=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:h,error:i}=await Br(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:o,xform:sc});if(i)throw i;if(!h)throw new Error("An error occurred on token verification.");const p=h.session,y=h.user;return p!=null&&p.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),{data:{user:y,session:p},error:null}}catch(o){if(Ar(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(t){var r,n,o;try{let s=null,h=null;return this.flowType==="pkce"&&([s,h]=await Mp(this.storage,this.storageKey)),await Br(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((o=t==null?void 0:t.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:h}),headers:this.headers,xform:Eue})}catch(s){if(Ar(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Nu;const{error:o}=await Br(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:o}})}catch(t){if(Ar(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:o,options:s}=t,{error:h}=await Br(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:h}}else if("phone"in t){const{phone:n,type:o,options:s}=t,{data:h,error:i}=await Br(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:i}}throw new ew("You must provide either an email or phone number and a type")}catch(r){if(Ar(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await rw(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<aC:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let h=this.suppressGetSessionWarning;t=new Proxy(t,{get:(p,y,b)=>(!h&&y==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),h=!0,this.suppressGetSessionWarning=!0),Reflect.get(p,y,b))})}return{data:{session:t},error:null}}const{session:o,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Br(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:qu}):await this._useSession(async r=>{var n,o,s;const{data:h,error:i}=r;if(i)throw i;return!(!((n=h.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Nu}:await Br(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(o=h.session)===null||o===void 0?void 0:o.access_token)!==null&&s!==void 0?s:void 0,xform:qu})})}catch(r){if(Ar(r))return Kce(r)&&(await this._removeSession(),await nw(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:o,error:s}=n;if(s)throw s;if(!o.session)throw new Nu;const h=o.session;let i=null,p=null;this.flowType==="pkce"&&t.email!=null&&([i,p]=await Mp(this.storage,this.storageKey));const{data:y,error:b}=await Br(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:i,code_challenge_method:p}),jwt:h.access_token,xform:qu});if(b)throw b;return h.user=y.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),{data:{user:h.user},error:null}})}catch(n){if(Ar(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Nu;const r=Date.now()/1e3;let n=r,o=!0,s=null;const{payload:h}=lC(t.access_token);if(h.exp&&(n=h.exp,o=n<=r),o){const{session:i,error:p}=await this._callRefreshToken(t.refresh_token);if(p)return{data:{user:null,session:null},error:p};if(!i)return{data:{user:null,session:null},error:null};s=i}else{const{data:i,error:p}=await this._getUser(t.access_token);if(p)throw p;s={access_token:t.access_token,refresh_token:t.refresh_token,user:i.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Ar(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:h,error:i}=r;if(i)throw i;t=(n=h.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Nu;const{session:o,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Ar(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Is())throw new tw("No browser detected.");if(t.error||t.error_description||t.error_code)throw new tw(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new O4("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new tw("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new O4("No code detected.");const{data:O,error:R}=await this._exchangeCodeForSession(t.code);if(R)throw R;const q=new URL(window.location.href);return q.searchParams.delete("code"),window.history.replaceState(window.history.state,"",q.toString()),{data:{session:O.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:o,access_token:s,refresh_token:h,expires_in:i,expires_at:p,token_type:y}=t;if(!s||!i||!h||!y)throw new tw("No session defined in URL");const b=Math.round(Date.now()/1e3),_=parseInt(i);let E=b+_;p&&(E=parseInt(p));const C=E-b;C*1e3<=$p&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${C}s, should have been closer to ${_}s`);const k=E-_;b-k>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",k,E,b):b-k<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",k,E,b);const{data:N,error:I}=await this._getUser(s);if(I)throw I;const B={provider_token:n,provider_refresh_token:o,access_token:s,expires_in:_,expires_at:E,refresh_token:h,token_type:y,user:N.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:B,redirectType:t.type},error:null}}catch(n){if(Ar(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await rw(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:o,error:s}=r;if(s)return{error:s};const h=(n=o.session)===null||n===void 0?void 0:n.access_token;if(h){const{error:i}=await this.admin.signOut(h,t);if(i&&!(Zce(i)&&(i.status===404||i.status===401||i.status===403)))return{error:i}}return t!=="others"&&(await this._removeSession(),await nw(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=aue(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,o;try{const{data:{session:s},error:h}=r;if(h)throw h;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((o=this.stateChangeEmitters.get(t))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,o=null;this.flowType==="pkce"&&([n,o]=await Mp(this.storage,this.storageKey,!0));try{return await Br(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Ar(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Ar(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:o}=await this._useSession(async s=>{var h,i,p,y,b;const{data:_,error:E}=s;if(E)throw E;const C=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(h=t.options)===null||h===void 0?void 0:h.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(p=t.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Br(this.fetch,"GET",C,{headers:this.headers,jwt:(b=(y=_.session)===null||y===void 0?void 0:y.access_token)!==null&&b!==void 0?b:void 0})});if(o)throw o;return Is()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ar(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,o;const{data:s,error:h}=r;if(h)throw h;return await Br(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(o=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(Ar(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await uue(async o=>(o>0&&await cue(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await Br(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:sc})),(o,s)=>{const h=200*Math.pow(2,o);return s&&sC(s)&&Date.now()+h-n<$p})}catch(n){if(this._debug(r,"error",n),Ar(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Is()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await rw(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const o=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<aC;if(this._debug(r,`session has${o?"":" not"} expired with margin of ${aC}s`),o){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),sC(s)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Nu;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new N2;const{data:s,error:h}=await this._refreshAccessToken(t);if(h)throw h;if(!s.session)throw new Nu;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const i={session:s.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(s){if(this._debug(o,"error",s),Ar(s)){const h={session:null,error:s};return sC(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(h),h}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(t,r,n=!0){const o=`#_notifyAllSubscribers(${t})`;this._debug(o,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],h=Array.from(this.stateChangeEmitters.values()).map(async i=>{try{await i.callback(t,r)}catch(p){s.push(p)}});if(await Promise.all(h),s.length>0){for(let i=0;i<s.length;i+=1)console.error(s[i]);throw s[0]}}finally{this._debug(o,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await wW(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await nw(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Is()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),$p);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((n.expires_at*1e3-t)/$p);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${$p}ms, refresh threshold is ${wA} ticks`),o<=wA&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof SW)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Is()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const o=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&o.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&o.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,h]=await Mp(this.storage,this.storageKey),i=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(h)}`});o.push(i.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);o.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&o.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${o.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;return s?{data:null,error:s}:await Br(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ar(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,o;const{data:s,error:h}=r;if(h)return{data:null,error:h};const i=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:p,error:y}=await Br(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return y?{data:null,error:y}:(t.factorType==="totp"&&(!((o=p==null?void 0:p.totp)===null||o===void 0)&&o.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),{data:p,error:null})})}catch(r){if(Ar(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;if(s)return{data:null,error:s};const{data:h,error:i}=await Br(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+h.expires_in},h)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",h),{data:h,error:i})})}catch(r){if(Ar(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;return s?{data:null,error:s}:await Br(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ar(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],o=n.filter(h=>h.factor_type==="totp"&&h.status==="verified"),s=n.filter(h=>h.factor_type==="phone"&&h.status==="verified");return{data:{all:n,totp:o,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:o},error:s}=t;if(s)return{data:null,error:s};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=lC(o.access_token);let i=null;h.aal&&(i=h.aal);let p=i;((n=(r=o.user.factors)===null||r===void 0?void 0:r.filter(_=>_.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(p="aal2");const b=h.amr||[];return{data:{currentLevel:i,nextLevel:p,currentAuthenticationMethods:b},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(h=>h.kid===t);if(n||(n=this.jwks.keys.find(h=>h.kid===t),n&&this.jwks_cached_at+Hce>Date.now()))return n;const{data:o,error:s}=await Br(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!o.keys||o.keys.length===0)throw new nx("JWKS is empty");if(this.jwks=o,this.jwks_cached_at=Date.now(),n=o.keys.find(h=>h.kid===t),!n)throw new nx("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:C,error:k}=await this.getSession();if(k||!C.session)return{data:null,error:k};n=C.session.access_token}const{header:o,payload:s,signature:h,raw:{header:i,payload:p}}=lC(n);if(yue(s.exp),!o.kid||o.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:C}=await this.getUser(n);if(C)throw C;return{data:{claims:s,header:o,signature:h},error:null}}const y=vue(o.alg),b=await this.fetchJwk(o.kid,r),_=await crypto.subtle.importKey("jwk",b,y,!0,["verify"]);if(!await crypto.subtle.verify(y,_,h,nue(`${i}.${p}`)))throw new nx("Invalid JWT signature");return{data:{claims:s,header:o,signature:h},error:null}}catch(n){if(Ar(n))return{data:null,error:n};throw n}}}Fx.nextInstanceID=0;const Due=Fx;class Rue extends Due{constructor(t){super(t)}}var Lue=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(h){h(s)})}return new(r||(r=Promise))(function(s,h){function i(b){try{y(n.next(b))}catch(_){h(_)}}function p(b){try{y(n.throw(b))}catch(_){h(_)}}function y(b){b.done?s(b.value):o(b.value).then(i,p)}y((n=n.apply(e,t||[])).next())})};class Bue{constructor(t,r,n){var o,s,h;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const i=Fce(t),p=new URL(i);this.realtimeUrl=new URL("realtime/v1",p),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",p),this.storageUrl=new URL("storage/v1",p),this.functionsUrl=new URL("functions/v1",p);const y=`sb-${p.hostname.split(".")[0]}-auth-token`,b={db:Ice,realtime:Dce,auth:Object.assign(Object.assign({},Oce),{storageKey:y}),global:Mce},_=Uce(n??{},b);this.storageKey=(o=_.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(s=_.global.headers)!==null&&s!==void 0?s:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(E,C)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(C)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((h=_.auth)!==null&&h!==void 0?h:{},this.headers,_.global.fetch),this.fetch=zce(r,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new tce(new URL("rest/v1",p).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),_.accessToken||this._listenForAuthEvents()}get functions(){return new Nle(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Ace(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Lue(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:o,storageKey:s,flowType:h,lock:i,debug:p},y,b){const _={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Rue({url:this.authUrl.href,headers:Object.assign(Object.assign({},_),y),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:o,flowType:h,lock:i,debug:p,fetch:b,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new gce(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const zue=(e,t,r)=>new Bue(e,t,r),$ue="https://agydpkzfucicraedllgl.supabase.co",Fue="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFneWRwa3pmdWNpY3JhZWRsbGdsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAwOTc2MTQsImV4cCI6MjA2NTY3MzYxNH0.17dtpVvgbEHwneo05as2Sp_pBAxTThdlwxTucV_j02U",Ve=zue($ue,Fue);Ve.auth.getSession().then(({data:e,error:t})=>{t?console.error("Supabase connection error:",t.message):console.log("Supabase connected successfully")});const EW=D.createContext({}),Uue=({children:e})=>{const[t,r]=D.useState(null),[n,o]=D.useState(!0);D.useEffect(()=>{Ve.auth.getSession().then(({data:{session:i}})=>{r((i==null?void 0:i.user)??null),o(!1)});const{data:{subscription:h}}=Ve.auth.onAuthStateChange((i,p)=>{r((p==null?void 0:p.user)??null),o(!1)});return()=>h.unsubscribe()},[]);const s={signUp:h=>Ve.auth.signUp(h),signIn:h=>Ve.auth.signInWithPassword(h),signOut:()=>Ve.auth.signOut(),user:t};return c.jsx(EW.Provider,{value:s,children:!n&&e})},fg=()=>D.useContext(EW),Vue=()=>{const[e,t]=D.useState(!1),[r,n]=D.useState(!1),o=qc(),s=zi(),{signOut:h,user:i}=fg(),p=o.pathname.includes("/venue-owner");D.useEffect(()=>{console.log(" Navigation Debug Info:"),console.log(" Current path:",o.pathname),console.log(" User:",i),console.log(" Is Owner:",p),console.log(" Logo loaded:",r)},[o.pathname,i,p,r]);const y=async()=>{try{await h(),t(!1),s("/")}catch(C){console.error("Error logging out:",C)}},b=[{name:"Home",path:"/home",icon:t4},{name:"Explore",path:"/explore",icon:Sie},{name:"Venues",path:"/venues",icon:Mc},...i?[{name:"My Bookings",path:"/bookings",icon:Lo}]:[],{name:"Profile",path:"/profile",icon:ji}],E=p?[{name:"Dashboard",path:"/venue-owner/dashboard",icon:t4},{name:"Bookings",path:"/venue-owner/bookings",icon:Lo},{name:"Tables",path:"/venue-owner/tables",icon:Mc},{name:"Analytics",path:"/venue-owner/analytics",icon:Xs}]:b;return c.jsx("nav",{className:"bg-white border-b border-brand-burgundy/10",children:c.jsxs("div",{className:"container mx-auto px-4",children:[c.jsxs("div",{className:"flex justify-between items-center h-16",children:[c.jsxs(In,{to:"/",className:"flex items-center space-x-2",children:[c.jsx("img",{src:window.location.origin+"/images/logos/Logo1-Trans.png",alt:"VIP Club",className:"h-10 w-auto object-contain",onError:C=>{console.log(" Logo failed to load from:",C.target.src),C.target.src.includes("Logo1-Trans.png")?C.target.src=window.location.origin+"/images/logos/Logo-Trans.png":C.target.src.includes("Logo-Trans.png")?C.target.src=window.location.origin+"/images/logos/Logo1-Trans-new.png":(C.target.style.display="none",C.target.nextSibling.style.display="flex")},onLoad:C=>{console.log(" Logo loaded successfully from:",C.target.src),n(!0)}}),c.jsxs("div",{className:"flex items-center space-x-2",style:{display:"none"},children:[c.jsx("div",{className:"h-8 w-8 bg-gradient-to-br from-brand-burgundy to-brand-gold rounded-lg flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold text-sm",children:"V"})}),c.jsx("span",{className:"text-xl font-heading text-brand-burgundy font-bold",children:"VIP Club"})]})]}),c.jsx("div",{className:"hidden md:flex items-center space-x-8",children:E.map(C=>c.jsxs(In,{to:C.path,className:`flex items-center space-x-2 text-sm font-medium transition-colors
                  ${o.pathname===C.path?"text-brand-gold":"text-brand-burgundy/70 hover:text-brand-gold"}`,children:[c.jsx(C.icon,{className:"h-4 w-4"}),c.jsx("span",{children:C.name})]},C.path))}),c.jsx("div",{className:"hidden md:flex items-center space-x-4",children:i?c.jsxs(wle,{children:[c.jsx(Sle,{asChild:!0,children:c.jsx(Et,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:c.jsx(ji,{className:"h-4 w-4"})})}),c.jsxs(Ele,{className:"w-56",align:"end",children:[c.jsx(Tle,{children:"My Account"}),c.jsx(E4,{}),c.jsx(nC,{children:c.jsxs(In,{to:"/profile",className:"flex items-center w-full",children:[c.jsx(ji,{className:"mr-2 h-4 w-4"}),"Profile"]})}),c.jsx(nC,{children:c.jsxs(In,{to:"/settings",className:"flex items-center w-full",children:[c.jsx(Xs,{className:"mr-2 h-4 w-4"}),"Settings"]})}),c.jsx(E4,{}),c.jsx(nC,{children:c.jsxs("button",{onClick:y,className:"flex items-center w-full text-red-600",children:[c.jsx(lA,{className:"mr-2 h-4 w-4"}),"Log out"]})})]})]}):c.jsx("div",{className:"flex items-center space-x-2",children:c.jsx(In,{to:"/profile",children:c.jsx(Et,{variant:"outline",size:"sm",className:"border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10",children:"Sign In"})})})}),c.jsx("button",{className:"md:hidden p-2 text-brand-burgundy",onClick:()=>t(!e),children:e?c.jsx(Ib,{className:"h-6 w-6"}):c.jsx(Mie,{className:"h-6 w-6"})})]}),e&&c.jsx("div",{className:"md:hidden py-4 border-t border-brand-burgundy/10",children:c.jsxs("div",{className:"flex flex-col space-y-4",children:[E.map(C=>c.jsxs(In,{to:C.path,className:`flex items-center space-x-2 text-sm font-medium transition-colors
                    ${o.pathname===C.path?"text-brand-gold":"text-brand-burgundy/70 hover:text-brand-gold"}`,onClick:()=>t(!1),children:[c.jsx(C.icon,{className:"h-4 w-4"}),c.jsx("span",{children:C.name})]},C.path)),i?c.jsxs("div",{className:"pt-4 border-t border-brand-burgundy/10",children:[c.jsxs(In,{to:"/profile",className:"flex items-center space-x-2 text-sm font-medium text-brand-burgundy/70 hover:text-brand-gold",onClick:()=>t(!1),children:[c.jsx(ji,{className:"h-4 w-4"}),c.jsx("span",{children:"Profile"})]}),c.jsxs(In,{to:"/settings",className:"flex items-center space-x-2 text-sm font-medium text-brand-burgundy/70 hover:text-brand-gold mt-4",onClick:()=>t(!1),children:[c.jsx(Xs,{className:"h-4 w-4"}),c.jsx("span",{children:"Settings"})]}),c.jsxs("button",{onClick:y,className:"flex items-center space-x-2 text-sm font-medium text-red-600 mt-4",children:[c.jsx(lA,{className:"h-4 w-4"}),c.jsx("span",{children:"Log out"})]})]}):c.jsx("div",{className:"pt-4 border-t border-brand-burgundy/10",children:c.jsxs(In,{to:"/profile",className:"flex items-center space-x-2 text-sm font-medium text-brand-burgundy/70 hover:text-brand-gold",onClick:()=>t(!1),children:[c.jsx(ji,{className:"h-4 w-4"}),c.jsx("span",{children:"Sign In"})]})})]})})]})})},que=()=>D.useCallback(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})},[]),Wue=()=>{const e=new Date().getFullYear(),t=que(),r=()=>{t()};return c.jsx("footer",{className:"bg-brand-burgundy text-brand-cream py-12",children:c.jsxs("div",{className:"container mx-auto px-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("img",{src:"/images/logos/Logo1-Trans.png",alt:"VIP Club",className:"h-8 w-auto"}),c.jsx("h3",{className:"text-xl font-heading font-bold text-white",style:{display:"none"},children:"VIP Club"})]}),c.jsx("p",{className:"text-brand-cream/80 mb-4",children:"Your premier destination for exclusive venue bookings in Lagos."}),c.jsxs("div",{className:"flex gap-4",children:[c.jsx("a",{href:"https://www.instagram.com/eddy.members?igsh=aXZmNXBocTE2Mmxx",target:"_blank",rel:"noopener noreferrer",className:"text-brand-cream/80 hover:text-white transition-colors",children:c.jsx(kie,{className:"w-5 h-5"})}),c.jsx("a",{href:"https://tiktok.com",target:"_blank",rel:"noopener noreferrer",className:"text-brand-cream/80 hover:text-white transition-colors",children:c.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.10z"})})})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-lg font-semibold mb-4 text-white",children:"Quick Links"}),c.jsxs("ul",{className:"space-y-2",children:[c.jsx("li",{children:c.jsx(In,{to:"/venues",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Venues"})}),c.jsx("li",{children:c.jsx(In,{to:"/about",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"About Us"})}),c.jsx("li",{children:c.jsx(In,{to:"/contact",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Contact"})})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-lg font-semibold mb-4 text-white",children:"For Venues"}),c.jsxs("ul",{className:"space-y-2",children:[c.jsx("li",{children:c.jsx(In,{to:"/venue-owner/login",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Login"})}),c.jsx("li",{children:c.jsx(In,{to:"/venue-owner/register",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Register"})})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-lg font-semibold mb-4 text-white",children:"Legal"}),c.jsxs("ul",{className:"space-y-2",children:[c.jsx("li",{children:c.jsx(In,{to:"/privacy",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Privacy Policy"})}),c.jsx("li",{children:c.jsx(In,{to:"/terms",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"Terms of Service"})}),c.jsx("li",{children:c.jsx(In,{to:"/faq",onClick:r,className:"text-brand-cream/80 hover:text-white transition-colors",children:"FAQ"})})]})]})]}),c.jsx("div",{className:"border-t border-brand-cream/10 mt-8 pt-8 text-center text-brand-cream/60",children:c.jsxs("p",{children:[" ",e," VIP Club. All rights reserved."]})})]})})},Gue=()=>{const{pathname:e}=qc();return D.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})},[e]),null},tI=D.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),M2=D.createContext({}),I2=D.createContext(null),O2=typeof document<"u",pg=O2?D.useLayoutEffect:D.useEffect,TW=D.createContext({strict:!1}),rI=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Hue="framerAppearId",jW="data-"+rI(Hue);function Xue(e,t,r,n){const{visualElement:o}=D.useContext(M2),s=D.useContext(TW),h=D.useContext(I2),i=D.useContext(tI).reducedMotion,p=D.useRef();n=n||s.renderer,!p.current&&n&&(p.current=n(e,{visualState:t,parent:o,props:r,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:i}));const y=p.current;D.useInsertionEffect(()=>{y&&y.update(r,h)});const b=D.useRef(!!(r[jW]&&!window.HandoffComplete));return pg(()=>{y&&(y.render(),b.current&&y.animationState&&y.animationState.animateChanges())}),D.useEffect(()=>{y&&(y.updateFeatures(),!b.current&&y.animationState&&y.animationState.animateChanges(),b.current&&(b.current=!1,window.HandoffComplete=!0))}),y}function Qp(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Zue(e,t,r){return D.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Qp(r)&&(r.current=n))},[t])}function Ux(e){return typeof e=="string"||Array.isArray(e)}function D2(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const nI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],iI=["initial",...nI];function R2(e){return D2(e.animate)||iI.some(t=>Ux(e[t]))}function CW(e){return!!(R2(e)||e.variants)}function Kue(e,t){if(R2(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Ux(r)?r:void 0,animate:Ux(n)?n:void 0}}return e.inherit!==!1?t:{}}function Yue(e){const{initial:t,animate:r}=Kue(e,D.useContext(M2));return D.useMemo(()=>({initial:t,animate:r}),[V4(t),V4(r)])}function V4(e){return Array.isArray(e)?e.join(" "):e}const q4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Vx={};for(const e in q4)Vx[e]={isEnabled:t=>q4[e].some(r=>!!t[r])};function Jue(e){for(const t in e)Vx[t]={...Vx[t],...e[t]}}const oI=D.createContext({}),PW=D.createContext({}),Que=Symbol.for("motionComponentSymbol");function ede({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:o}){e&&Jue(e);function s(i,p){let y;const b={...D.useContext(tI),...i,layoutId:tde(i)},{isStatic:_}=b,E=Yue(i),C=n(i,_);if(!_&&O2){E.visualElement=Xue(o,C,b,t);const k=D.useContext(PW),N=D.useContext(TW).strict;E.visualElement&&(y=E.visualElement.loadFeatures(b,N,e,k))}return D.createElement(M2.Provider,{value:E},y&&E.visualElement?D.createElement(y,{visualElement:E.visualElement,...b}):null,r(o,i,Zue(C,E.visualElement,p),C,_,E.visualElement))}const h=D.forwardRef(s);return h[Que]=o,h}function tde({layoutId:e}){const t=D.useContext(oI).id;return t&&e!==void 0?t+"-"+e:e}function rde(e){function t(n,o={}){return ede(e(n,o))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,o)=>(r.has(o)||r.set(o,t(o)),r.get(o))})}const nde=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function aI(e){return typeof e!="string"||e.includes("-")?!1:!!(nde.indexOf(e)>-1||/[A-Z]/.test(e))}const N1={};function ide(e){Object.assign(N1,e)}const Fb=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_f=new Set(Fb);function AW(e,{layout:t,layoutId:r}){return _f.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!N1[e]||e==="opacity")}const la=e=>!!(e&&e.getVelocity),ode={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ade=Fb.length;function sde(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,o){let s="";for(let h=0;h<ade;h++){const i=Fb[h];if(e[i]!==void 0){const p=ode[i]||i;s+=`${p}(${e[i]}) `}}return t&&!e.z&&(s+="translateZ(0)"),s=s.trim(),o?s=o(e,n?"":s):r&&n&&(s="none"),s}const kW=e=>t=>typeof t=="string"&&t.startsWith(e),NW=kW("--"),TA=kW("var(--"),lde=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,cde=(e,t)=>t&&typeof e=="number"?t.transform(e):e,pd=(e,t,r)=>Math.min(Math.max(r,e),t),wf={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},ox={...wf,transform:e=>pd(0,1,e)},iw={...wf,default:1},ax=e=>Math.round(e*1e5)/1e5,L2=/(-)?([\d]*\.?[\d])+/g,MW=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,ude=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Ub(e){return typeof e=="string"}const Vb=e=>({test:t=>Ub(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Mu=Vb("deg"),Al=Vb("%"),xr=Vb("px"),dde=Vb("vh"),hde=Vb("vw"),W4={...Al,parse:e=>Al.parse(e)/100,transform:e=>Al.transform(e*100)},G4={...wf,transform:Math.round},IW={borderWidth:xr,borderTopWidth:xr,borderRightWidth:xr,borderBottomWidth:xr,borderLeftWidth:xr,borderRadius:xr,radius:xr,borderTopLeftRadius:xr,borderTopRightRadius:xr,borderBottomRightRadius:xr,borderBottomLeftRadius:xr,width:xr,maxWidth:xr,height:xr,maxHeight:xr,size:xr,top:xr,right:xr,bottom:xr,left:xr,padding:xr,paddingTop:xr,paddingRight:xr,paddingBottom:xr,paddingLeft:xr,margin:xr,marginTop:xr,marginRight:xr,marginBottom:xr,marginLeft:xr,rotate:Mu,rotateX:Mu,rotateY:Mu,rotateZ:Mu,scale:iw,scaleX:iw,scaleY:iw,scaleZ:iw,skew:Mu,skewX:Mu,skewY:Mu,distance:xr,translateX:xr,translateY:xr,translateZ:xr,x:xr,y:xr,z:xr,perspective:xr,transformPerspective:xr,opacity:ox,originX:W4,originY:W4,originZ:xr,zIndex:G4,fillOpacity:ox,strokeOpacity:ox,numOctaves:G4};function sI(e,t,r,n){const{style:o,vars:s,transform:h,transformOrigin:i}=e;let p=!1,y=!1,b=!0;for(const _ in t){const E=t[_];if(NW(_)){s[_]=E;continue}const C=IW[_],k=cde(E,C);if(_f.has(_)){if(p=!0,h[_]=k,!b)continue;E!==(C.default||0)&&(b=!1)}else _.startsWith("origin")?(y=!0,i[_]=k):o[_]=k}if(t.transform||(p||n?o.transform=sde(e.transform,r,b,n):o.transform&&(o.transform="none")),y){const{originX:_="50%",originY:E="50%",originZ:C=0}=i;o.transformOrigin=`${_} ${E} ${C}`}}const lI=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function OW(e,t,r){for(const n in t)!la(t[n])&&!AW(n,r)&&(e[n]=t[n])}function fde({transformTemplate:e},t,r){return D.useMemo(()=>{const n=lI();return sI(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function pde(e,t,r){const n=e.style||{},o={};return OW(o,n,e),Object.assign(o,fde(e,t,r)),e.transformValues?e.transformValues(o):o}function mde(e,t,r){const n={},o=pde(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=o,n}const gde=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function M1(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||gde.has(e)}let DW=e=>!M1(e);function yde(e){e&&(DW=t=>t.startsWith("on")?!M1(t):e(t))}try{yde(require("@emotion/is-prop-valid").default)}catch{}function vde(e,t,r){const n={};for(const o in e)o==="values"&&typeof e.values=="object"||(DW(o)||r===!0&&M1(o)||!t&&!M1(o)||e.draggable&&o.startsWith("onDrag"))&&(n[o]=e[o]);return n}function H4(e,t,r){return typeof e=="string"?e:xr.transform(t+r*e)}function xde(e,t,r){const n=H4(t,e.x,e.width),o=H4(r,e.y,e.height);return`${n} ${o}`}const bde={offset:"stroke-dashoffset",array:"stroke-dasharray"},_de={offset:"strokeDashoffset",array:"strokeDasharray"};function wde(e,t,r=1,n=0,o=!0){e.pathLength=1;const s=o?bde:_de;e[s.offset]=xr.transform(-n);const h=xr.transform(t),i=xr.transform(r);e[s.array]=`${h} ${i}`}function cI(e,{attrX:t,attrY:r,attrScale:n,originX:o,originY:s,pathLength:h,pathSpacing:i=1,pathOffset:p=0,...y},b,_,E){if(sI(e,y,b,E),_){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:C,style:k,dimensions:N}=e;C.transform&&(N&&(k.transform=C.transform),delete C.transform),N&&(o!==void 0||s!==void 0||k.transform)&&(k.transformOrigin=xde(N,o!==void 0?o:.5,s!==void 0?s:.5)),t!==void 0&&(C.x=t),r!==void 0&&(C.y=r),n!==void 0&&(C.scale=n),h!==void 0&&wde(C,h,i,p,!1)}const RW=()=>({...lI(),attrs:{}}),uI=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Sde(e,t,r,n){const o=D.useMemo(()=>{const s=RW();return cI(s,t,{enableHardwareAcceleration:!1},uI(n),e.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};OW(s,e.style,e),o.style={...s,...o.style}}return o}function Ede(e=!1){return(r,n,o,{latestValues:s},h)=>{const p=(aI(r)?Sde:mde)(n,s,h,r),b={...vde(n,typeof r=="string",e),...p,ref:o},{children:_}=n,E=D.useMemo(()=>la(_)?_.get():_,[_]);return D.createElement(r,{...b,children:E})}}function LW(e,{style:t,vars:r},n,o){Object.assign(e.style,t,o&&o.getProjectionStyles(n));for(const s in r)e.style.setProperty(s,r[s])}const BW=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function zW(e,t,r,n){LW(e,t,void 0,n);for(const o in t.attrs)e.setAttribute(BW.has(o)?o:rI(o),t.attrs[o])}function dI(e,t){const{style:r}=e,n={};for(const o in r)(la(r[o])||t.style&&la(t.style[o])||AW(o,e))&&(n[o]=r[o]);return n}function $W(e,t){const r=dI(e,t);for(const n in e)if(la(e[n])||la(t[n])){const o=Fb.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[o]=e[n]}return r}function hI(e,t,r,n={},o={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,o)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,o)),t}function mg(e){const t=D.useRef(null);return t.current===null&&(t.current=e()),t.current}const I1=e=>Array.isArray(e),Tde=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),jde=e=>I1(e)?e[e.length-1]||0:e;function Fw(e){const t=la(e)?e.get():e;return Tde(t)?t.toValue():t}function Cde({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,o,s){const h={latestValues:Pde(n,o,s,e),renderState:t()};return r&&(h.mount=i=>r(n,i,h)),h}const FW=e=>(t,r)=>{const n=D.useContext(M2),o=D.useContext(I2),s=()=>Cde(e,t,n,o);return r?s():mg(s)};function Pde(e,t,r,n){const o={},s=n(e,{});for(const E in s)o[E]=Fw(s[E]);let{initial:h,animate:i}=e;const p=R2(e),y=CW(e);t&&y&&!p&&e.inherit!==!1&&(h===void 0&&(h=t.initial),i===void 0&&(i=t.animate));let b=r?r.initial===!1:!1;b=b||h===!1;const _=b?i:h;return _&&typeof _!="boolean"&&!D2(_)&&(Array.isArray(_)?_:[_]).forEach(C=>{const k=hI(e,C);if(!k)return;const{transitionEnd:N,transition:I,...B}=k;for(const O in B){let R=B[O];if(Array.isArray(R)){const q=b?R.length-1:0;R=R[q]}R!==null&&(o[O]=R)}for(const O in N)o[O]=N[O]}),o}const hi=e=>e;class X4{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function Ade(e){let t=new X4,r=new X4,n=0,o=!1,s=!1;const h=new WeakSet,i={schedule:(p,y=!1,b=!1)=>{const _=b&&o,E=_?t:r;return y&&h.add(p),E.add(p)&&_&&o&&(n=t.order.length),p},cancel:p=>{r.remove(p),h.delete(p)},process:p=>{if(o){s=!0;return}if(o=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let y=0;y<n;y++){const b=t.order[y];b(p),h.has(b)&&(i.schedule(b),e())}o=!1,s&&(s=!1,i.process(p))}};return i}const ow=["prepare","read","update","preRender","render","postRender"],kde=40;function Nde(e,t){let r=!1,n=!0;const o={delta:0,timestamp:0,isProcessing:!1},s=ow.reduce((_,E)=>(_[E]=Ade(()=>r=!0),_),{}),h=_=>s[_].process(o),i=()=>{const _=performance.now();r=!1,o.delta=n?1e3/60:Math.max(Math.min(_-o.timestamp,kde),1),o.timestamp=_,o.isProcessing=!0,ow.forEach(h),o.isProcessing=!1,r&&t&&(n=!1,e(i))},p=()=>{r=!0,n=!0,o.isProcessing||e(i)};return{schedule:ow.reduce((_,E)=>{const C=s[E];return _[E]=(k,N=!1,I=!1)=>(r||p(),C.schedule(k,N,I)),_},{}),cancel:_=>ow.forEach(E=>s[E].cancel(_)),state:o,steps:s}}const{schedule:fn,cancel:Qs,state:to,steps:uC}=Nde(typeof requestAnimationFrame<"u"?requestAnimationFrame:hi,!0),Mde={useVisualState:FW({scrapeMotionValuesFromProps:$W,createRenderState:RW,onMount:(e,t,{renderState:r,latestValues:n})=>{fn.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),fn.render(()=>{cI(r,n,{enableHardwareAcceleration:!1},uI(t.tagName),e.transformTemplate),zW(t,r)})}})},Ide={useVisualState:FW({scrapeMotionValuesFromProps:dI,createRenderState:lI})};function Ode(e,{forwardMotionProps:t=!1},r,n){return{...aI(e)?Mde:Ide,preloadedFeatures:r,useRender:Ede(t),createVisualElement:n,Component:e}}function gc(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const UW=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function B2(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const Dde=e=>t=>UW(t)&&e(t,B2(t));function _c(e,t,r,n){return gc(e,t,Dde(r),n)}const Rde=(e,t)=>r=>t(e(r)),od=(...e)=>e.reduce(Rde);function VW(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const Z4=VW("dragHorizontal"),K4=VW("dragVertical");function qW(e){let t=!1;if(e==="y")t=K4();else if(e==="x")t=Z4();else{const r=Z4(),n=K4();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function WW(){const e=qW(!0);return e?(e(),!1):!0}class Ed{constructor(t){this.isMounted=!1,this.node=t}update(){}}function Y4(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),o=(s,h)=>{if(s.pointerType==="touch"||WW())return;const i=e.getProps();e.animationState&&i.whileHover&&e.animationState.setActive("whileHover",t),i[n]&&fn.update(()=>i[n](s,h))};return _c(e.current,r,o,{passive:!e.getProps()[n]})}class Lde extends Ed{mount(){this.unmount=od(Y4(this.node,!0),Y4(this.node,!1))}unmount(){}}class Bde extends Ed{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=od(gc(this.node.current,"focus",()=>this.onFocus()),gc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const GW=(e,t)=>t?e===t?!0:GW(e,t.parentElement):!1;function dC(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,B2(r))}class zde extends Ed{constructor(){super(...arguments),this.removeStartListeners=hi,this.removeEndListeners=hi,this.removeAccessibleListeners=hi,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),s=_c(window,"pointerup",(i,p)=>{if(!this.checkPressEnd())return;const{onTap:y,onTapCancel:b,globalTapTarget:_}=this.node.getProps();fn.update(()=>{!_&&!GW(this.node.current,i.target)?b&&b(i,p):y&&y(i,p)})},{passive:!(n.onTap||n.onPointerUp)}),h=_c(window,"pointercancel",(i,p)=>this.cancelPress(i,p),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=od(s,h),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=s=>{if(s.key!=="Enter"||this.isPressing)return;const h=i=>{i.key!=="Enter"||!this.checkPressEnd()||dC("up",(p,y)=>{const{onTap:b}=this.node.getProps();b&&fn.update(()=>b(p,y))})};this.removeEndListeners(),this.removeEndListeners=gc(this.node.current,"keyup",h),dC("down",(i,p)=>{this.startPress(i,p)})},r=gc(this.node.current,"keydown",t),n=()=>{this.isPressing&&dC("cancel",(s,h)=>this.cancelPress(s,h))},o=gc(this.node.current,"blur",n);this.removeAccessibleListeners=od(r,o)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:o}=this.node.getProps();o&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&fn.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!WW()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&fn.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=_c(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=gc(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=od(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const jA=new WeakMap,hC=new WeakMap,$de=e=>{const t=jA.get(e.target);t&&t(e)},Fde=e=>{e.forEach($de)};function Ude({root:e,...t}){const r=e||document;hC.has(r)||hC.set(r,{});const n=hC.get(r),o=JSON.stringify(t);return n[o]||(n[o]=new IntersectionObserver(Fde,{root:e,...t})),n[o]}function Vde(e,t,r){const n=Ude(t);return jA.set(e,r),n.observe(e),()=>{jA.delete(e),n.unobserve(e)}}const qde={some:0,all:1};class Wde extends Ed{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:o="some",once:s}=t,h={root:r?r.current:void 0,rootMargin:n,threshold:typeof o=="number"?o:qde[o]},i=p=>{const{isIntersecting:y}=p;if(this.isInView===y||(this.isInView=y,s&&!y&&this.hasEnteredView))return;y&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",y);const{onViewportEnter:b,onViewportLeave:_}=this.node.getProps(),E=y?b:_;E&&E(p)};return Vde(this.node.current,h,i)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(Gde(t,r))&&this.startObserver()}unmount(){}}function Gde({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const Hde={inView:{Feature:Wde},tap:{Feature:zde},focus:{Feature:Bde},hover:{Feature:Lde}};function HW(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Xde(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function Zde(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function z2(e,t,r){const n=e.getProps();return hI(n,t,r!==void 0?r:n.custom,Xde(e),Zde(e))}let XW=hi,$2=hi;const ad=e=>e*1e3,wc=e=>e/1e3,Kde={current:!1},ZW=e=>Array.isArray(e)&&typeof e[0]=="number";function KW(e){return!!(!e||typeof e=="string"&&YW[e]||ZW(e)||Array.isArray(e)&&e.every(KW))}const Uv=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,YW={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Uv([0,.65,.55,1]),circOut:Uv([.55,0,1,.45]),backIn:Uv([.31,.01,.66,-.59]),backOut:Uv([.33,1.53,.69,.99])};function JW(e){if(e)return ZW(e)?Uv(e):Array.isArray(e)?e.map(JW):YW[e]}function Yde(e,t,r,{delay:n=0,duration:o,repeat:s=0,repeatType:h="loop",ease:i,times:p}={}){const y={[t]:r};p&&(y.offset=p);const b=JW(i);return Array.isArray(b)&&(y.easing=b),e.animate(y,{delay:n,duration:o,easing:Array.isArray(b)?"linear":b,fill:"both",iterations:s+1,direction:h==="reverse"?"alternate":"normal"})}function Jde(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const QW=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,Qde=1e-7,ehe=12;function the(e,t,r,n,o){let s,h,i=0;do h=t+(r-t)/2,s=QW(h,n,o)-e,s>0?r=h:t=h;while(Math.abs(s)>Qde&&++i<ehe);return h}function qb(e,t,r,n){if(e===t&&r===n)return hi;const o=s=>the(s,0,1,e,r);return s=>s===0||s===1?s:QW(o(s),t,n)}const rhe=qb(.42,0,1,1),nhe=qb(0,0,.58,1),eG=qb(.42,0,.58,1),ihe=e=>Array.isArray(e)&&typeof e[0]!="number",tG=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,rG=e=>t=>1-e(1-t),fI=e=>1-Math.sin(Math.acos(e)),nG=rG(fI),ohe=tG(fI),iG=qb(.33,1.53,.69,.99),pI=rG(iG),ahe=tG(pI),she=e=>(e*=2)<1?.5*pI(e):.5*(2-Math.pow(2,-10*(e-1))),lhe={linear:hi,easeIn:rhe,easeInOut:eG,easeOut:nhe,circIn:fI,circInOut:ohe,circOut:nG,backIn:pI,backInOut:ahe,backOut:iG,anticipate:she},J4=e=>{if(Array.isArray(e)){$2(e.length===4);const[t,r,n,o]=e;return qb(t,r,n,o)}else if(typeof e=="string")return lhe[e];return e},mI=(e,t)=>r=>!!(Ub(r)&&ude.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),oG=(e,t,r)=>n=>{if(!Ub(n))return n;const[o,s,h,i]=n.match(L2);return{[e]:parseFloat(o),[t]:parseFloat(s),[r]:parseFloat(h),alpha:i!==void 0?parseFloat(i):1}},che=e=>pd(0,255,e),fC={...wf,transform:e=>Math.round(che(e))},Fh={test:mI("rgb","red"),parse:oG("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+fC.transform(e)+", "+fC.transform(t)+", "+fC.transform(r)+", "+ax(ox.transform(n))+")"};function uhe(e){let t="",r="",n="",o="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),o=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),o=e.substring(4,5),t+=t,r+=r,n+=n,o+=o),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:o?parseInt(o,16)/255:1}}const CA={test:mI("#"),parse:uhe,transform:Fh.transform},em={test:mI("hsl","hue"),parse:oG("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Al.transform(ax(t))+", "+Al.transform(ax(r))+", "+ax(ox.transform(n))+")"},Io={test:e=>Fh.test(e)||CA.test(e)||em.test(e),parse:e=>Fh.test(e)?Fh.parse(e):em.test(e)?em.parse(e):CA.parse(e),transform:e=>Ub(e)?e:e.hasOwnProperty("red")?Fh.transform(e):em.transform(e)},ii=(e,t,r)=>-r*e+r*t+e;function pC(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function dhe({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let o=0,s=0,h=0;if(!t)o=s=h=r;else{const i=r<.5?r*(1+t):r+t-r*t,p=2*r-i;o=pC(p,i,e+1/3),s=pC(p,i,e),h=pC(p,i,e-1/3)}return{red:Math.round(o*255),green:Math.round(s*255),blue:Math.round(h*255),alpha:n}}const mC=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},hhe=[CA,Fh,em],fhe=e=>hhe.find(t=>t.test(e));function Q4(e){const t=fhe(e);let r=t.parse(e);return t===em&&(r=dhe(r)),r}const aG=(e,t)=>{const r=Q4(e),n=Q4(t),o={...r};return s=>(o.red=mC(r.red,n.red,s),o.green=mC(r.green,n.green,s),o.blue=mC(r.blue,n.blue,s),o.alpha=ii(r.alpha,n.alpha,s),Fh.transform(o))};function phe(e){var t,r;return isNaN(e)&&Ub(e)&&(((t=e.match(L2))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(MW))===null||r===void 0?void 0:r.length)||0)>0}const sG={regex:lde,countKey:"Vars",token:"${v}",parse:hi},lG={regex:MW,countKey:"Colors",token:"${c}",parse:Io.parse},cG={regex:L2,countKey:"Numbers",token:"${n}",parse:wf.parse};function gC(e,{regex:t,countKey:r,token:n,parse:o}){const s=e.tokenised.match(t);s&&(e["num"+r]=s.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...s.map(o)))}function O1(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&gC(r,sG),gC(r,lG),gC(r,cG),r}function uG(e){return O1(e).values}function dG(e){const{values:t,numColors:r,numVars:n,tokenised:o}=O1(e),s=t.length;return h=>{let i=o;for(let p=0;p<s;p++)p<n?i=i.replace(sG.token,h[p]):p<n+r?i=i.replace(lG.token,Io.transform(h[p])):i=i.replace(cG.token,ax(h[p]));return i}}const mhe=e=>typeof e=="number"?0:e;function ghe(e){const t=uG(e);return dG(e)(t.map(mhe))}const md={test:phe,parse:uG,createTransformer:dG,getAnimatableNone:ghe},hG=(e,t)=>r=>`${r>0?t:e}`;function fG(e,t){return typeof e=="number"?r=>ii(e,t,r):Io.test(e)?aG(e,t):e.startsWith("var(")?hG(e,t):mG(e,t)}const pG=(e,t)=>{const r=[...e],n=r.length,o=e.map((s,h)=>fG(s,t[h]));return s=>{for(let h=0;h<n;h++)r[h]=o[h](s);return r}},yhe=(e,t)=>{const r={...e,...t},n={};for(const o in r)e[o]!==void 0&&t[o]!==void 0&&(n[o]=fG(e[o],t[o]));return o=>{for(const s in n)r[s]=n[s](o);return r}},mG=(e,t)=>{const r=md.createTransformer(t),n=O1(e),o=O1(t);return n.numVars===o.numVars&&n.numColors===o.numColors&&n.numNumbers>=o.numNumbers?od(pG(n.values,o.values),r):hG(e,t)},Pm=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},eB=(e,t)=>r=>ii(e,t,r);function vhe(e){return typeof e=="number"?eB:typeof e=="string"?Io.test(e)?aG:mG:Array.isArray(e)?pG:typeof e=="object"?yhe:eB}function xhe(e,t,r){const n=[],o=r||vhe(e[0]),s=e.length-1;for(let h=0;h<s;h++){let i=o(e[h],e[h+1]);if(t){const p=Array.isArray(t)?t[h]||hi:t;i=od(p,i)}n.push(i)}return n}function F2(e,t,{clamp:r=!0,ease:n,mixer:o}={}){const s=e.length;if($2(s===t.length),s===1)return()=>t[0];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const h=xhe(t,n,o),i=h.length,p=y=>{let b=0;if(i>1)for(;b<e.length-2&&!(y<e[b+1]);b++);const _=Pm(e[b],e[b+1],y);return h[b](_)};return r?y=>p(pd(e[0],e[s-1],y)):p}function bhe(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const o=Pm(0,t,n);e.push(ii(r,1,o))}}function gG(e){const t=[0];return bhe(t,e.length-1),t}function _he(e,t){return e.map(r=>r*t)}function whe(e,t){return e.map(()=>t||eG).splice(0,e.length-1)}function D1({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const o=ihe(n)?n.map(J4):J4(n),s={done:!1,value:t[0]},h=_he(r&&r.length===t.length?r:gG(t),e),i=F2(h,t,{ease:Array.isArray(o)?o:whe(t,o)});return{calculatedDuration:e,next:p=>(s.value=i(p),s.done=p>=e,s)}}function gI(e,t){return t?e*(1e3/t):0}const She=5;function yG(e,t,r){const n=Math.max(t-She,0);return gI(r-e(n),t-n)}const yC=.001,Ehe=.01,tB=10,The=.05,jhe=1;function Che({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let o,s;XW(e<=ad(tB));let h=1-t;h=pd(The,jhe,h),e=pd(Ehe,tB,wc(e)),h<1?(o=y=>{const b=y*h,_=b*e,E=b-r,C=PA(y,h),k=Math.exp(-_);return yC-E/C*k},s=y=>{const _=y*h*e,E=_*r+r,C=Math.pow(h,2)*Math.pow(y,2)*e,k=Math.exp(-_),N=PA(Math.pow(y,2),h);return(-o(y)+yC>0?-1:1)*((E-C)*k)/N}):(o=y=>{const b=Math.exp(-y*e),_=(y-r)*e+1;return-yC+b*_},s=y=>{const b=Math.exp(-y*e),_=(r-y)*(e*e);return b*_});const i=5/e,p=Ahe(o,s,i);if(e=ad(e),isNaN(p))return{stiffness:100,damping:10,duration:e};{const y=Math.pow(p,2)*n;return{stiffness:y,damping:h*2*Math.sqrt(n*y),duration:e}}}const Phe=12;function Ahe(e,t,r){let n=r;for(let o=1;o<Phe;o++)n=n-e(n)/t(n);return n}function PA(e,t){return e*Math.sqrt(1-t*t)}const khe=["duration","bounce"],Nhe=["stiffness","damping","mass"];function rB(e,t){return t.some(r=>e[r]!==void 0)}function Mhe(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!rB(e,Nhe)&&rB(e,khe)){const r=Che(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function vG({keyframes:e,restDelta:t,restSpeed:r,...n}){const o=e[0],s=e[e.length-1],h={done:!1,value:o},{stiffness:i,damping:p,mass:y,duration:b,velocity:_,isResolvedFromDuration:E}=Mhe({...n,velocity:-wc(n.velocity||0)}),C=_||0,k=p/(2*Math.sqrt(i*y)),N=s-o,I=wc(Math.sqrt(i/y)),B=Math.abs(N)<5;r||(r=B?.01:2),t||(t=B?.005:.5);let O;if(k<1){const R=PA(I,k);O=q=>{const F=Math.exp(-k*I*q);return s-F*((C+k*I*N)/R*Math.sin(R*q)+N*Math.cos(R*q))}}else if(k===1)O=R=>s-Math.exp(-I*R)*(N+(C+I*N)*R);else{const R=I*Math.sqrt(k*k-1);O=q=>{const F=Math.exp(-k*I*q),X=Math.min(R*q,300);return s-F*((C+k*I*N)*Math.sinh(X)+R*N*Math.cosh(X))/R}}return{calculatedDuration:E&&b||null,next:R=>{const q=O(R);if(E)h.done=R>=b;else{let F=C;R!==0&&(k<1?F=yG(O,R,q):F=0);const X=Math.abs(F)<=r,G=Math.abs(s-q)<=t;h.done=X&&G}return h.value=h.done?s:q,h}}}function nB({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:o=10,bounceStiffness:s=500,modifyTarget:h,min:i,max:p,restDelta:y=.5,restSpeed:b}){const _=e[0],E={done:!1,value:_},C=ee=>i!==void 0&&ee<i||p!==void 0&&ee>p,k=ee=>i===void 0?p:p===void 0||Math.abs(i-ee)<Math.abs(p-ee)?i:p;let N=r*t;const I=_+N,B=h===void 0?I:h(I);B!==I&&(N=B-_);const O=ee=>-N*Math.exp(-ee/n),R=ee=>B+O(ee),q=ee=>{const K=O(ee),ie=R(ee);E.done=Math.abs(K)<=y,E.value=E.done?B:ie};let F,X;const G=ee=>{C(E.value)&&(F=ee,X=vG({keyframes:[E.value,k(E.value)],velocity:yG(R,ee,E.value),damping:o,stiffness:s,restDelta:y,restSpeed:b}))};return G(0),{calculatedDuration:null,next:ee=>{let K=!1;return!X&&F===void 0&&(K=!0,q(ee),G(ee)),F!==void 0&&ee>F?X.next(ee-F):(!K&&q(ee),E)}}}const Ihe=e=>{const t=({timestamp:r})=>e(r);return{start:()=>fn.update(t,!0),stop:()=>Qs(t),now:()=>to.isProcessing?to.timestamp:performance.now()}},iB=2e4;function oB(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<iB;)t+=r,n=e.next(t);return t>=iB?1/0:t}const Ohe={decay:nB,inertia:nB,tween:D1,keyframes:D1,spring:vG};function R1({autoplay:e=!0,delay:t=0,driver:r=Ihe,keyframes:n,type:o="keyframes",repeat:s=0,repeatDelay:h=0,repeatType:i="loop",onPlay:p,onStop:y,onComplete:b,onUpdate:_,...E}){let C=1,k=!1,N,I;const B=()=>{I=new Promise(Be=>{N=Be})};B();let O;const R=Ohe[o]||D1;let q;R!==D1&&typeof n[0]!="number"&&(q=F2([0,100],n,{clamp:!1}),n=[0,100]);const F=R({...E,keyframes:n});let X;i==="mirror"&&(X=R({...E,keyframes:[...n].reverse(),velocity:-(E.velocity||0)}));let G="idle",ee=null,K=null,ie=null;F.calculatedDuration===null&&s&&(F.calculatedDuration=oB(F));const{calculatedDuration:pe}=F;let ae=1/0,_e=1/0;pe!==null&&(ae=pe+h,_e=ae*(s+1)-h);let Ee=0;const xe=Be=>{if(K===null)return;C>0&&(K=Math.min(K,Be)),C<0&&(K=Math.min(Be-_e/C,K)),ee!==null?Ee=ee:Ee=Math.round(Be-K)*C;const Fe=Ee-t*(C>=0?1:-1),Ge=C>=0?Fe<0:Fe>_e;Ee=Math.max(Fe,0),G==="finished"&&ee===null&&(Ee=_e);let Pt=Ee,$t=F;if(s){const ft=Math.min(Ee,_e)/ae;let vt=Math.floor(ft),lt=ft%1;!lt&&ft>=1&&(lt=1),lt===1&&vt--,vt=Math.min(vt,s+1),!!(vt%2)&&(i==="reverse"?(lt=1-lt,h&&(lt-=h/ae)):i==="mirror"&&($t=X)),Pt=pd(0,1,lt)*ae}const nr=Ge?{done:!1,value:n[0]}:$t.next(Pt);q&&(nr.value=q(nr.value));let{done:Nt}=nr;!Ge&&pe!==null&&(Nt=C>=0?Ee>=_e:Ee<=0);const Jt=ee===null&&(G==="finished"||G==="running"&&Nt);return _&&_(nr.value),Jt&&ve(),nr},ce=()=>{O&&O.stop(),O=void 0},ke=()=>{G="idle",ce(),N(),B(),K=ie=null},ve=()=>{G="finished",b&&b(),ce(),N()},Pe=()=>{if(k)return;O||(O=r(xe));const Be=O.now();p&&p(),ee!==null?K=Be-ee:(!K||G==="finished")&&(K=Be),G==="finished"&&B(),ie=K,ee=null,G="running",O.start()};e&&Pe();const Re={then(Be,Fe){return I.then(Be,Fe)},get time(){return wc(Ee)},set time(Be){Be=ad(Be),Ee=Be,ee!==null||!O||C===0?ee=Be:K=O.now()-Be/C},get duration(){const Be=F.calculatedDuration===null?oB(F):F.calculatedDuration;return wc(Be)},get speed(){return C},set speed(Be){Be===C||!O||(C=Be,Re.time=wc(Ee))},get state(){return G},play:Pe,pause:()=>{G="paused",ee=Ee},stop:()=>{k=!0,G!=="idle"&&(G="idle",y&&y(),ke())},cancel:()=>{ie!==null&&xe(ie),ke()},complete:()=>{G="finished"},sample:Be=>(K=0,xe(Be))};return Re}function Dhe(e){let t;return()=>(t===void 0&&(t=e()),t)}const Rhe=Dhe(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Lhe=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),aw=10,Bhe=2e4,zhe=(e,t)=>t.type==="spring"||e==="backgroundColor"||!KW(t.ease);function $he(e,t,{onUpdate:r,onComplete:n,...o}){if(!(Rhe()&&Lhe.has(t)&&!o.repeatDelay&&o.repeatType!=="mirror"&&o.damping!==0&&o.type!=="inertia"))return!1;let h=!1,i,p,y=!1;const b=()=>{p=new Promise(R=>{i=R})};b();let{keyframes:_,duration:E=300,ease:C,times:k}=o;if(zhe(t,o)){const R=R1({...o,repeat:0,delay:0});let q={done:!1,value:_[0]};const F=[];let X=0;for(;!q.done&&X<Bhe;)q=R.sample(X),F.push(q.value),X+=aw;k=void 0,_=F,E=X-aw,C="linear"}const N=Yde(e.owner.current,t,_,{...o,duration:E,ease:C,times:k}),I=()=>{y=!1,N.cancel()},B=()=>{y=!0,fn.update(I),i(),b()};return N.onfinish=()=>{y||(e.set(Jde(_,o)),n&&n(),B())},{then(R,q){return p.then(R,q)},attachTimeline(R){return N.timeline=R,N.onfinish=null,hi},get time(){return wc(N.currentTime||0)},set time(R){N.currentTime=ad(R)},get speed(){return N.playbackRate},set speed(R){N.playbackRate=R},get duration(){return wc(E)},play:()=>{h||(N.play(),Qs(I))},pause:()=>N.pause(),stop:()=>{if(h=!0,N.playState==="idle")return;const{currentTime:R}=N;if(R){const q=R1({...o,autoplay:!1});e.setWithVelocity(q.sample(R-aw).value,q.sample(R).value,aw)}B()},complete:()=>{y||N.finish()},cancel:B}}function Fhe({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const o=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:hi,pause:hi,stop:hi,then:s=>(s(),Promise.resolve()),cancel:hi,complete:hi});return t?R1({keyframes:[0,1],duration:0,delay:t,onComplete:o}):o()}const Uhe={type:"spring",stiffness:500,damping:25,restSpeed:10},Vhe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),qhe={type:"keyframes",duration:.8},Whe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Ghe=(e,{keyframes:t})=>t.length>2?qhe:_f.has(e)?e.startsWith("scale")?Vhe(t[1]):Uhe:Whe,AA=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(md.test(t)||t==="0")&&!t.startsWith("url(")),Hhe=new Set(["brightness","contrast","saturate","opacity"]);function Xhe(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(L2)||[];if(!n)return e;const o=r.replace(n,"");let s=Hhe.has(t)?1:0;return n!==r&&(s*=100),t+"("+s+o+")"}const Zhe=/([a-z-]*)\(.*?\)/g,kA={...md,getAnimatableNone:e=>{const t=e.match(Zhe);return t?t.map(Xhe).join(" "):e}},Khe={...IW,color:Io,backgroundColor:Io,outlineColor:Io,fill:Io,stroke:Io,borderColor:Io,borderTopColor:Io,borderRightColor:Io,borderBottomColor:Io,borderLeftColor:Io,filter:kA,WebkitFilter:kA},yI=e=>Khe[e];function xG(e,t){let r=yI(e);return r!==kA&&(r=md),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const bG=e=>/^0[^.\s]+$/.test(e);function Yhe(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||bG(e)}function Jhe(e,t,r,n){const o=AA(t,r);let s;Array.isArray(r)?s=[...r]:s=[null,r];const h=n.from!==void 0?n.from:e.get();let i;const p=[];for(let y=0;y<s.length;y++)s[y]===null&&(s[y]=y===0?h:s[y-1]),Yhe(s[y])&&p.push(y),typeof s[y]=="string"&&s[y]!=="none"&&s[y]!=="0"&&(i=s[y]);if(o&&p.length&&i)for(let y=0;y<p.length;y++){const b=p[y];s[b]=xG(t,i)}return s}function Qhe({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:o,repeat:s,repeatType:h,repeatDelay:i,from:p,elapsed:y,...b}){return!!Object.keys(b).length}function vI(e,t){return e[t]||e.default||e}const efe={skipAnimations:!1},xI=(e,t,r,n={})=>o=>{const s=vI(n,e)||{},h=s.delay||n.delay||0;let{elapsed:i=0}=n;i=i-ad(h);const p=Jhe(t,e,r,s),y=p[0],b=p[p.length-1],_=AA(e,y),E=AA(e,b);let C={keyframes:p,velocity:t.getVelocity(),ease:"easeOut",...s,delay:-i,onUpdate:k=>{t.set(k),s.onUpdate&&s.onUpdate(k)},onComplete:()=>{o(),s.onComplete&&s.onComplete()}};if(Qhe(s)||(C={...C,...Ghe(e,C)}),C.duration&&(C.duration=ad(C.duration)),C.repeatDelay&&(C.repeatDelay=ad(C.repeatDelay)),!_||!E||Kde.current||s.type===!1||efe.skipAnimations)return Fhe(C);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const k=$he(t,e,C);if(k)return k}return R1(C)};function L1(e){return!!(la(e)&&e.add)}const _G=e=>/^\-?\d*\.?\d+$/.test(e);function bI(e,t){e.indexOf(t)===-1&&e.push(t)}function _I(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class wI{constructor(){this.subscriptions=[]}add(t){return bI(this.subscriptions,t),()=>_I(this.subscriptions,t)}notify(t,r,n){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](t,r,n);else for(let s=0;s<o;s++){const h=this.subscriptions[s];h&&h(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const tfe=e=>!isNaN(parseFloat(e)),sx={current:void 0};class rfe{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,o=!0)=>{this.prev=this.current,this.current=n;const{delta:s,timestamp:h}=to;this.lastUpdated!==h&&(this.timeDelta=s,this.lastUpdated=h,fn.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),o&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>fn.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=tfe(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new wI);const n=this.events[t].add(r);return t==="change"?()=>{n(),fn.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return sx.current&&sx.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?gI(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function qs(e,t){return new rfe(e,t)}const wG=e=>t=>t.test(e),nfe={test:e=>e==="auto",parse:e=>e},SG=[wf,xr,Al,Mu,hde,dde,nfe],xv=e=>SG.find(wG(e)),ife=[...SG,Io,md],ofe=e=>ife.find(wG(e));function afe(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,qs(r))}function SI(e,t){const r=z2(e,t);let{transitionEnd:n={},transition:o={},...s}=r?e.makeTargetAnimatable(r,!1):{};s={...s,...n};for(const h in s){const i=jde(s[h]);afe(e,h,i)}}function NA(e,t){[...t].reverse().forEach(n=>{const o=e.getVariant(n);o&&SI(e,o),e.variantChildren&&e.variantChildren.forEach(s=>{NA(s,t)})})}function sfe(e,t){if(Array.isArray(t))return NA(e,t);if(typeof t=="string")return NA(e,[t]);SI(e,t)}function lfe(e,t,r){var n,o;const s=Object.keys(t).filter(i=>!e.hasValue(i)),h=s.length;if(h)for(let i=0;i<h;i++){const p=s[i],y=t[p];let b=null;Array.isArray(y)&&(b=y[0]),b===null&&(b=(o=(n=r[p])!==null&&n!==void 0?n:e.readValue(p))!==null&&o!==void 0?o:t[p]),b!=null&&(typeof b=="string"&&(_G(b)||bG(b))?b=parseFloat(b):!ofe(b)&&md.test(y)&&(b=xG(p,y)),e.addValue(p,qs(b,{owner:e})),r[p]===void 0&&(r[p]=b),b!==null&&e.setBaseTarget(p,b))}}function cfe(e,t){return t?(t[e]||t.default||t).from:void 0}function ufe(e,t,r){const n={};for(const o in e){const s=cfe(o,t);if(s!==void 0)n[o]=s;else{const h=r.getValue(o);h&&(n[o]=h.get())}}return n}function dfe({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function hfe(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function EG(e,t,{delay:r=0,transitionOverride:n,type:o}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:h,...i}=e.makeTargetAnimatable(t);const p=e.getValue("willChange");n&&(s=n);const y=[],b=o&&e.animationState&&e.animationState.getState()[o];for(const _ in i){const E=e.getValue(_),C=i[_];if(!E||C===void 0||b&&dfe(b,_))continue;const k={delay:r,elapsed:0,...vI(s||{},_)};if(window.HandoffAppearAnimations){const B=e.getProps()[jW];if(B){const O=window.HandoffAppearAnimations(B,_,E,fn);O!==null&&(k.elapsed=O,k.isHandoff=!0)}}let N=!k.isHandoff&&!hfe(E,C);if(k.type==="spring"&&(E.getVelocity()||k.velocity)&&(N=!1),E.animation&&(N=!1),N)continue;E.start(xI(_,E,C,e.shouldReduceMotion&&_f.has(_)?{type:!1}:k));const I=E.animation;L1(p)&&(p.add(_),I.then(()=>p.remove(_))),y.push(I)}return h&&Promise.all(y).then(()=>{h&&SI(e,h)}),y}function MA(e,t,r={}){const n=z2(e,t,r.custom);let{transition:o=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(o=r.transitionOverride);const s=n?()=>Promise.all(EG(e,n,r)):()=>Promise.resolve(),h=e.variantChildren&&e.variantChildren.size?(p=0)=>{const{delayChildren:y=0,staggerChildren:b,staggerDirection:_}=o;return ffe(e,t,y+p,b,_,r)}:()=>Promise.resolve(),{when:i}=o;if(i){const[p,y]=i==="beforeChildren"?[s,h]:[h,s];return p().then(()=>y())}else return Promise.all([s(),h(r.delay)])}function ffe(e,t,r=0,n=0,o=1,s){const h=[],i=(e.variantChildren.size-1)*n,p=o===1?(y=0)=>y*n:(y=0)=>i-y*n;return Array.from(e.variantChildren).sort(pfe).forEach((y,b)=>{y.notify("AnimationStart",t),h.push(MA(y,t,{...s,delay:r+p(b)}).then(()=>y.notify("AnimationComplete",t)))}),Promise.all(h)}function pfe(e,t){return e.sortNodePosition(t)}function TG(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const o=t.map(s=>MA(e,s,r));n=Promise.all(o)}else if(typeof t=="string")n=MA(e,t,r);else{const o=typeof t=="function"?z2(e,t,r.custom):t;n=Promise.all(EG(e,o,r))}return n.then(()=>e.notify("AnimationComplete",t))}const mfe=[...nI].reverse(),gfe=nI.length;function yfe(e){return t=>Promise.all(t.map(({animation:r,options:n})=>TG(e,r,n)))}function vfe(e){let t=yfe(e);const r=bfe();let n=!0;const o=(p,y)=>{const b=z2(e,y);if(b){const{transition:_,transitionEnd:E,...C}=b;p={...p,...C,...E}}return p};function s(p){t=p(e)}function h(p,y){const b=e.getProps(),_=e.getVariantContext(!0)||{},E=[],C=new Set;let k={},N=1/0;for(let B=0;B<gfe;B++){const O=mfe[B],R=r[O],q=b[O]!==void 0?b[O]:_[O],F=Ux(q),X=O===y?R.isActive:null;X===!1&&(N=B);let G=q===_[O]&&q!==b[O]&&F;if(G&&n&&e.manuallyAnimateOnMount&&(G=!1),R.protectedKeys={...k},!R.isActive&&X===null||!q&&!R.prevProp||D2(q)||typeof q=="boolean")continue;let K=xfe(R.prevProp,q)||O===y&&R.isActive&&!G&&F||B>N&&F,ie=!1;const pe=Array.isArray(q)?q:[q];let ae=pe.reduce(o,{});X===!1&&(ae={});const{prevResolvedValues:_e={}}=R,Ee={..._e,...ae},xe=ce=>{K=!0,C.has(ce)&&(ie=!0,C.delete(ce)),R.needsAnimating[ce]=!0};for(const ce in Ee){const ke=ae[ce],ve=_e[ce];if(k.hasOwnProperty(ce))continue;let Pe=!1;I1(ke)&&I1(ve)?Pe=!HW(ke,ve):Pe=ke!==ve,Pe?ke!==void 0?xe(ce):C.add(ce):ke!==void 0&&C.has(ce)?xe(ce):R.protectedKeys[ce]=!0}R.prevProp=q,R.prevResolvedValues=ae,R.isActive&&(k={...k,...ae}),n&&e.blockInitialAnimation&&(K=!1),K&&(!G||ie)&&E.push(...pe.map(ce=>({animation:ce,options:{type:O,...p}})))}if(C.size){const B={};C.forEach(O=>{const R=e.getBaseTarget(O);R!==void 0&&(B[O]=R)}),E.push({animation:B})}let I=!!E.length;return n&&(b.initial===!1||b.initial===b.animate)&&!e.manuallyAnimateOnMount&&(I=!1),n=!1,I?t(E):Promise.resolve()}function i(p,y,b){var _;if(r[p].isActive===y)return Promise.resolve();(_=e.variantChildren)===null||_===void 0||_.forEach(C=>{var k;return(k=C.animationState)===null||k===void 0?void 0:k.setActive(p,y)}),r[p].isActive=y;const E=h(b,p);for(const C in r)r[C].protectedKeys={};return E}return{animateChanges:h,setActive:i,setAnimateFunction:s,getState:()=>r}}function xfe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!HW(t,e):!1}function Sh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function bfe(){return{animate:Sh(!0),whileInView:Sh(),whileHover:Sh(),whileTap:Sh(),whileDrag:Sh(),whileFocus:Sh(),exit:Sh()}}class _fe extends Ed{constructor(t){super(t),t.animationState||(t.animationState=vfe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),D2(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let wfe=0;class Sfe extends Ed{constructor(){super(...arguments),this.id=wfe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:o}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===o)return;const s=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&s.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const Efe={animation:{Feature:_fe},exit:{Feature:Sfe}},aB=(e,t)=>Math.abs(e-t);function Tfe(e,t){const r=aB(e.x,t.x),n=aB(e.y,t.y);return Math.sqrt(r**2+n**2)}class jG{constructor(t,r,{transformPagePoint:n,contextWindow:o,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _=xC(this.lastMoveEventInfo,this.history),E=this.startEvent!==null,C=Tfe(_.offset,{x:0,y:0})>=3;if(!E&&!C)return;const{point:k}=_,{timestamp:N}=to;this.history.push({...k,timestamp:N});const{onStart:I,onMove:B}=this.handlers;E||(I&&I(this.lastMoveEvent,_),this.startEvent=this.lastMoveEvent),B&&B(this.lastMoveEvent,_)},this.handlePointerMove=(_,E)=>{this.lastMoveEvent=_,this.lastMoveEventInfo=vC(E,this.transformPagePoint),fn.update(this.updatePoint,!0)},this.handlePointerUp=(_,E)=>{this.end();const{onEnd:C,onSessionEnd:k,resumeAnimation:N}=this.handlers;if(this.dragSnapToOrigin&&N&&N(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const I=xC(_.type==="pointercancel"?this.lastMoveEventInfo:vC(E,this.transformPagePoint),this.history);this.startEvent&&C&&C(_,I),k&&k(_,I)},!UW(t))return;this.dragSnapToOrigin=s,this.handlers=r,this.transformPagePoint=n,this.contextWindow=o||window;const h=B2(t),i=vC(h,this.transformPagePoint),{point:p}=i,{timestamp:y}=to;this.history=[{...p,timestamp:y}];const{onSessionStart:b}=r;b&&b(t,xC(i,this.history)),this.removeListeners=od(_c(this.contextWindow,"pointermove",this.handlePointerMove),_c(this.contextWindow,"pointerup",this.handlePointerUp),_c(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Qs(this.updatePoint)}}function vC(e,t){return t?{point:t(e.point)}:e}function sB(e,t){return{x:e.x-t.x,y:e.y-t.y}}function xC({point:e},t){return{point:e,delta:sB(e,CG(t)),offset:sB(e,jfe(t)),velocity:Cfe(t,.1)}}function jfe(e){return e[0]}function CG(e){return e[e.length-1]}function Cfe(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const o=CG(e);for(;r>=0&&(n=e[r],!(o.timestamp-n.timestamp>ad(t)));)r--;if(!n)return{x:0,y:0};const s=wc(o.timestamp-n.timestamp);if(s===0)return{x:0,y:0};const h={x:(o.x-n.x)/s,y:(o.y-n.y)/s};return h.x===1/0&&(h.x=0),h.y===1/0&&(h.y=0),h}function Aa(e){return e.max-e.min}function IA(e,t=0,r=.01){return Math.abs(e-t)<=r}function lB(e,t,r,n=.5){e.origin=n,e.originPoint=ii(t.min,t.max,e.origin),e.scale=Aa(r)/Aa(t),(IA(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=ii(r.min,r.max,e.origin)-e.originPoint,(IA(e.translate)||isNaN(e.translate))&&(e.translate=0)}function lx(e,t,r,n){lB(e.x,t.x,r.x,n?n.originX:void 0),lB(e.y,t.y,r.y,n?n.originY:void 0)}function cB(e,t,r){e.min=r.min+t.min,e.max=e.min+Aa(t)}function Pfe(e,t,r){cB(e.x,t.x,r.x),cB(e.y,t.y,r.y)}function uB(e,t,r){e.min=t.min-r.min,e.max=e.min+Aa(t)}function cx(e,t,r){uB(e.x,t.x,r.x),uB(e.y,t.y,r.y)}function Afe(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?ii(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?ii(r,e,n.max):Math.min(e,r)),e}function dB(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function kfe(e,{top:t,left:r,bottom:n,right:o}){return{x:dB(e.x,r,o),y:dB(e.y,t,n)}}function hB(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function Nfe(e,t){return{x:hB(e.x,t.x),y:hB(e.y,t.y)}}function Mfe(e,t){let r=.5;const n=Aa(e),o=Aa(t);return o>n?r=Pm(t.min,t.max-n,e.min):n>o&&(r=Pm(e.min,e.max-o,t.min)),pd(0,1,r)}function Ife(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const OA=.35;function Ofe(e=OA){return e===!1?e=0:e===!0&&(e=OA),{x:fB(e,"left","right"),y:fB(e,"top","bottom")}}function fB(e,t,r){return{min:pB(e,t),max:pB(e,r)}}function pB(e,t){return typeof e=="number"?e:e[t]||0}const mB=()=>({translate:0,scale:1,origin:0,originPoint:0}),tm=()=>({x:mB(),y:mB()}),gB=()=>({min:0,max:0}),Si=()=>({x:gB(),y:gB()});function Xa(e){return[e("x"),e("y")]}function PG({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function Dfe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Rfe(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function bC(e){return e===void 0||e===1}function DA({scale:e,scaleX:t,scaleY:r}){return!bC(e)||!bC(t)||!bC(r)}function Ah(e){return DA(e)||AG(e)||e.z||e.rotate||e.rotateX||e.rotateY}function AG(e){return yB(e.x)||yB(e.y)}function yB(e){return e&&e!=="0%"}function B1(e,t,r){const n=e-r,o=t*n;return r+o}function vB(e,t,r,n,o){return o!==void 0&&(e=B1(e,o,n)),B1(e,r,n)+t}function RA(e,t=0,r=1,n,o){e.min=vB(e.min,t,r,n,o),e.max=vB(e.max,t,r,n,o)}function kG(e,{x:t,y:r}){RA(e.x,t.translate,t.scale,t.originPoint),RA(e.y,r.translate,r.scale,r.originPoint)}function Lfe(e,t,r,n=!1){const o=r.length;if(!o)return;t.x=t.y=1;let s,h;for(let i=0;i<o;i++){s=r[i],h=s.projectionDelta;const p=s.instance;p&&p.style&&p.style.display==="contents"||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&rm(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),h&&(t.x*=h.x.scale,t.y*=h.y.scale,kG(e,h)),n&&Ah(s.latestValues)&&rm(e,s.latestValues))}t.x=xB(t.x),t.y=xB(t.y)}function xB(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function $u(e,t){e.min=e.min+t,e.max=e.max+t}function bB(e,t,[r,n,o]){const s=t[o]!==void 0?t[o]:.5,h=ii(e.min,e.max,s);RA(e,t[r],t[n],h,t.scale)}const Bfe=["x","scaleX","originX"],zfe=["y","scaleY","originY"];function rm(e,t){bB(e.x,t,Bfe),bB(e.y,t,zfe)}function NG(e,t){return PG(Rfe(e.getBoundingClientRect(),t))}function $fe(e,t,r){const n=NG(e,r),{scroll:o}=t;return o&&($u(n.x,o.offset.x),$u(n.y,o.offset.y)),n}const MG=({current:e})=>e?e.ownerDocument.defaultView:null,Ffe=new WeakMap;class Ufe{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Si(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const o=b=>{const{dragSnapToOrigin:_}=this.getProps();_?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(B2(b,"page").point)},s=(b,_)=>{const{drag:E,dragPropagation:C,onDragStart:k}=this.getProps();if(E&&!C&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=qW(E),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Xa(I=>{let B=this.getAxisMotionValue(I).get()||0;if(Al.test(B)){const{projection:O}=this.visualElement;if(O&&O.layout){const R=O.layout.layoutBox[I];R&&(B=Aa(R)*(parseFloat(B)/100))}}this.originPoint[I]=B}),k&&fn.update(()=>k(b,_),!1,!0);const{animationState:N}=this.visualElement;N&&N.setActive("whileDrag",!0)},h=(b,_)=>{const{dragPropagation:E,dragDirectionLock:C,onDirectionLock:k,onDrag:N}=this.getProps();if(!E&&!this.openGlobalLock)return;const{offset:I}=_;if(C&&this.currentDirection===null){this.currentDirection=Vfe(I),this.currentDirection!==null&&k&&k(this.currentDirection);return}this.updateAxis("x",_.point,I),this.updateAxis("y",_.point,I),this.visualElement.render(),N&&N(b,_)},i=(b,_)=>this.stop(b,_),p=()=>Xa(b=>{var _;return this.getAnimationState(b)==="paused"&&((_=this.getAxisMotionValue(b).animation)===null||_===void 0?void 0:_.play())}),{dragSnapToOrigin:y}=this.getProps();this.panSession=new jG(t,{onSessionStart:o,onStart:s,onMove:h,onSessionEnd:i,resumeAnimation:p},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:y,contextWindow:MG(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:s}=this.getProps();s&&fn.update(()=>s(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:o}=this.getProps();if(!n||!sw(t,o,this.currentDirection))return;const s=this.getAxisMotionValue(t);let h=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(h=Afe(h,this.constraints[t],this.elastic[t])),s.set(h)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,s=this.constraints;r&&Qp(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&o?this.constraints=kfe(o.layoutBox,r):this.constraints=!1,this.elastic=Ofe(n),s!==this.constraints&&o&&this.constraints&&!this.hasMutatedConstraints&&Xa(h=>{this.getAxisMotionValue(h)&&(this.constraints[h]=Ife(o.layoutBox[h],this.constraints[h]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Qp(t))return!1;const n=t.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const s=$fe(n,o.root,this.visualElement.getTransformPagePoint());let h=Nfe(o.layout.layoutBox,s);if(r){const i=r(Dfe(h));this.hasMutatedConstraints=!!i,i&&(h=PG(i))}return h}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:o,dragTransition:s,dragSnapToOrigin:h,onDragTransitionEnd:i}=this.getProps(),p=this.constraints||{},y=Xa(b=>{if(!sw(b,r,this.currentDirection))return;let _=p&&p[b]||{};h&&(_={min:0,max:0});const E=o?200:1e6,C=o?40:1e7,k={type:"inertia",velocity:n?t[b]:0,bounceStiffness:E,bounceDamping:C,timeConstant:750,restDelta:1,restSpeed:10,...s,..._};return this.startAxisValueAnimation(b,k)});return Promise.all(y).then(i)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(xI(t,n,0,r))}stopAnimation(){Xa(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Xa(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),o=n[r];return o||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Xa(r=>{const{drag:n}=this.getProps();if(!sw(r,n,this.currentDirection))return;const{projection:o}=this.visualElement,s=this.getAxisMotionValue(r);if(o&&o.layout){const{min:h,max:i}=o.layout.layoutBox[r];s.set(t[r]-ii(h,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Qp(r)||!n||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Xa(h=>{const i=this.getAxisMotionValue(h);if(i){const p=i.get();o[h]=Mfe({min:p,max:p},this.constraints[h])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Xa(h=>{if(!sw(h,t,null))return;const i=this.getAxisMotionValue(h),{min:p,max:y}=this.constraints[h];i.set(ii(p,y,o[h]))})}addListeners(){if(!this.visualElement.current)return;Ffe.set(this.visualElement,this);const t=this.visualElement.current,r=_c(t,"pointerdown",p=>{const{drag:y,dragListener:b=!0}=this.getProps();y&&b&&this.start(p)}),n=()=>{const{dragConstraints:p}=this.getProps();Qp(p)&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,s=o.addEventListener("measure",n);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),n();const h=gc(window,"resize",()=>this.scalePositionWithinConstraints()),i=o.addEventListener("didUpdate",({delta:p,hasLayoutChanged:y})=>{this.isDragging&&y&&(Xa(b=>{const _=this.getAxisMotionValue(b);_&&(this.originPoint[b]+=p[b].translate,_.set(_.get()+p[b].translate))}),this.visualElement.render())});return()=>{h(),r(),s(),i&&i()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:o=!1,dragConstraints:s=!1,dragElastic:h=OA,dragMomentum:i=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:o,dragConstraints:s,dragElastic:h,dragMomentum:i}}}function sw(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function Vfe(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class qfe extends Ed{constructor(t){super(t),this.removeGroupControls=hi,this.removeListeners=hi,this.controls=new Ufe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||hi}unmount(){this.removeGroupControls(),this.removeListeners()}}const _B=e=>(t,r)=>{e&&fn.update(()=>e(t,r))};class Wfe extends Ed{constructor(){super(...arguments),this.removePointerDownListener=hi}onPointerDown(t){this.session=new jG(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:MG(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:o}=this.node.getProps();return{onSessionStart:_B(t),onStart:_B(r),onMove:n,onEnd:(s,h)=>{delete this.session,o&&fn.update(()=>o(s,h))}}}mount(){this.removePointerDownListener=_c(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Gfe(){const e=D.useContext(I2);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,o=D.useId();return D.useEffect(()=>n(o),[]),!t&&r?[!1,()=>r&&r(o)]:[!0]}const Uw={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function wB(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const bv={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(xr.test(e))e=parseFloat(e);else return e;const r=wB(e,t.target.x),n=wB(e,t.target.y);return`${r}% ${n}%`}},Hfe={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,o=md.parse(e);if(o.length>5)return n;const s=md.createTransformer(e),h=typeof o[0]!="number"?1:0,i=r.x.scale*t.x,p=r.y.scale*t.y;o[0+h]/=i,o[1+h]/=p;const y=ii(i,p,.5);return typeof o[2+h]=="number"&&(o[2+h]/=y),typeof o[3+h]=="number"&&(o[3+h]/=y),s(o)}};class Xfe extends je.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:o}=this.props,{projection:s}=t;ide(Zfe),s&&(r.group&&r.group.add(s),n&&n.register&&o&&n.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Uw.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:o,isPresent:s}=this.props,h=n.projection;return h&&(h.isPresent=s,o||t.layoutDependency!==r||r===void 0?h.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?h.promote():h.relegate()||fn.postRender(()=>{const i=h.getStack();(!i||!i.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:o}=t;o&&(o.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(o),n&&n.deregister&&n.deregister(o))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function IG(e){const[t,r]=Gfe(),n=D.useContext(oI);return je.createElement(Xfe,{...e,layoutGroup:n,switchLayoutGroup:D.useContext(PW),isPresent:t,safeToRemove:r})}const Zfe={borderRadius:{...bv,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:bv,borderTopRightRadius:bv,borderBottomLeftRadius:bv,borderBottomRightRadius:bv,boxShadow:Hfe},OG=["TopLeft","TopRight","BottomLeft","BottomRight"],Kfe=OG.length,SB=e=>typeof e=="string"?parseFloat(e):e,EB=e=>typeof e=="number"||xr.test(e);function Yfe(e,t,r,n,o,s){o?(e.opacity=ii(0,r.opacity!==void 0?r.opacity:1,Jfe(n)),e.opacityExit=ii(t.opacity!==void 0?t.opacity:1,0,Qfe(n))):s&&(e.opacity=ii(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let h=0;h<Kfe;h++){const i=`border${OG[h]}Radius`;let p=TB(t,i),y=TB(r,i);if(p===void 0&&y===void 0)continue;p||(p=0),y||(y=0),p===0||y===0||EB(p)===EB(y)?(e[i]=Math.max(ii(SB(p),SB(y),n),0),(Al.test(y)||Al.test(p))&&(e[i]+="%")):e[i]=y}(t.rotate||r.rotate)&&(e.rotate=ii(t.rotate||0,r.rotate||0,n))}function TB(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Jfe=DG(0,.5,nG),Qfe=DG(.5,.95,hi);function DG(e,t,r){return n=>n<e?0:n>t?1:r(Pm(e,t,n))}function jB(e,t){e.min=t.min,e.max=t.max}function qa(e,t){jB(e.x,t.x),jB(e.y,t.y)}function CB(e,t,r,n,o){return e-=t,e=B1(e,1/r,n),o!==void 0&&(e=B1(e,1/o,n)),e}function epe(e,t=0,r=1,n=.5,o,s=e,h=e){if(Al.test(t)&&(t=parseFloat(t),t=ii(h.min,h.max,t/100)-h.min),typeof t!="number")return;let i=ii(s.min,s.max,n);e===s&&(i-=t),e.min=CB(e.min,t,r,i,o),e.max=CB(e.max,t,r,i,o)}function PB(e,t,[r,n,o],s,h){epe(e,t[r],t[n],t[o],t.scale,s,h)}const tpe=["x","scaleX","originX"],rpe=["y","scaleY","originY"];function AB(e,t,r,n){PB(e.x,t,tpe,r?r.x:void 0,n?n.x:void 0),PB(e.y,t,rpe,r?r.y:void 0,n?n.y:void 0)}function kB(e){return e.translate===0&&e.scale===1}function RG(e){return kB(e.x)&&kB(e.y)}function npe(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function LG(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function NB(e){return Aa(e.x)/Aa(e.y)}class ipe{constructor(){this.members=[]}add(t){bI(this.members,t),t.scheduleRender()}remove(t){if(_I(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(o=>t===o);if(r===0)return!1;let n;for(let o=r;o>=0;o--){const s=this.members[o];if(s.isPresent!==!1){n=s;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:o}=t.options;o===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function MB(e,t,r){let n="";const o=e.x.translate/t.x,s=e.y.translate/t.y;if((o||s)&&(n=`translate3d(${o}px, ${s}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:p,rotateX:y,rotateY:b}=r;p&&(n+=`rotate(${p}deg) `),y&&(n+=`rotateX(${y}deg) `),b&&(n+=`rotateY(${b}deg) `)}const h=e.x.scale*t.x,i=e.y.scale*t.y;return(h!==1||i!==1)&&(n+=`scale(${h}, ${i})`),n||"none"}const ope=(e,t)=>e.depth-t.depth;class ape{constructor(){this.children=[],this.isDirty=!1}add(t){bI(this.children,t),this.isDirty=!0}remove(t){_I(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(ope),this.isDirty=!1,this.children.forEach(t)}}function spe(e,t){const r=performance.now(),n=({timestamp:o})=>{const s=o-r;s>=t&&(Qs(n),e(s-t))};return fn.read(n,!0),()=>Qs(n)}function lpe(e){window.MotionDebug&&window.MotionDebug.record(e)}function cpe(e){return e instanceof SVGElement&&e.tagName!=="svg"}function upe(e,t,r){const n=la(e)?e:qs(e);return n.start(xI("",n,t,r)),n.animation}const IB=["","X","Y","Z"],dpe={visibility:"hidden"},OB=1e3;let hpe=0;const kh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function BG({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:o}){return class{constructor(h={},i=t==null?void 0:t()){this.id=hpe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,kh.totalNodes=kh.resolvedTargetDeltas=kh.recalculatedProjection=0,this.nodes.forEach(mpe),this.nodes.forEach(bpe),this.nodes.forEach(_pe),this.nodes.forEach(gpe),lpe(kh)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=h,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let p=0;p<this.path.length;p++)this.path[p].shouldResetTransform=!0;this.root===this&&(this.nodes=new ape)}addEventListener(h,i){return this.eventHandlers.has(h)||this.eventHandlers.set(h,new wI),this.eventHandlers.get(h).add(i)}notifyListeners(h,...i){const p=this.eventHandlers.get(h);p&&p.notify(...i)}hasListeners(h){return this.eventHandlers.has(h)}mount(h,i=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=cpe(h),this.instance=h;const{layoutId:p,layout:y,visualElement:b}=this.options;if(b&&!b.current&&b.mount(h),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),i&&(y||p)&&(this.isLayoutDirty=!0),e){let _;const E=()=>this.root.updateBlockedByResize=!1;e(h,()=>{this.root.updateBlockedByResize=!0,_&&_(),_=spe(E,250),Uw.hasAnimatedSinceResize&&(Uw.hasAnimatedSinceResize=!1,this.nodes.forEach(RB))})}p&&this.root.registerSharedNode(p,this),this.options.animate!==!1&&b&&(p||y)&&this.addEventListener("didUpdate",({delta:_,hasLayoutChanged:E,hasRelativeTargetChanged:C,layout:k})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const N=this.options.transition||b.getDefaultTransition()||jpe,{onLayoutAnimationStart:I,onLayoutAnimationComplete:B}=b.getProps(),O=!this.targetLayout||!LG(this.targetLayout,k)||C,R=!E&&C;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||R||E&&(O||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(_,R);const q={...vI(N,"layout"),onPlay:I,onComplete:B};(b.shouldReduceMotion||this.options.layoutRoot)&&(q.delay=0,q.type=!1),this.startAnimation(q)}else E||RB(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=k})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const h=this.getStack();h&&h.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Qs(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(wpe),this.animationId++)}getTransformTemplate(){const{visualElement:h}=this.options;return h&&h.getProps().transformTemplate}willUpdate(h=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let b=0;b<this.path.length;b++){const _=this.path[b];_.shouldResetTransform=!0,_.updateScroll("snapshot"),_.options.layoutRoot&&_.willUpdate(!1)}const{layoutId:i,layout:p}=this.options;if(i===void 0&&!p)return;const y=this.getTransformTemplate();this.prevTransformTemplateValue=y?y(this.latestValues,""):void 0,this.updateSnapshot(),h&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(DB);return}this.isUpdating||this.nodes.forEach(vpe),this.isUpdating=!1,this.nodes.forEach(xpe),this.nodes.forEach(fpe),this.nodes.forEach(ppe),this.clearAllSnapshots();const i=performance.now();to.delta=pd(0,1e3/60,i-to.timestamp),to.timestamp=i,to.isProcessing=!0,uC.update.process(to),uC.preRender.process(to),uC.render.process(to),to.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(ype),this.sharedNodes.forEach(Spe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,fn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){fn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let p=0;p<this.path.length;p++)this.path[p].updateScroll();const h=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Si(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:i}=this.options;i&&i.notify("LayoutMeasure",this.layout.layoutBox,h?h.layoutBox:void 0)}updateScroll(h="measure"){let i=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===h&&(i=!1),i&&(this.scroll={animationId:this.root.animationId,phase:h,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!o)return;const h=this.isLayoutDirty||this.shouldResetTransform,i=this.projectionDelta&&!RG(this.projectionDelta),p=this.getTransformTemplate(),y=p?p(this.latestValues,""):void 0,b=y!==this.prevTransformTemplateValue;h&&(i||Ah(this.latestValues)||b)&&(o(this.instance,y),this.shouldResetTransform=!1,this.scheduleRender())}measure(h=!0){const i=this.measurePageBox();let p=this.removeElementScroll(i);return h&&(p=this.removeTransform(p)),Cpe(p),{animationId:this.root.animationId,measuredBox:i,layoutBox:p,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:h}=this.options;if(!h)return Si();const i=h.measureViewportBox(),{scroll:p}=this.root;return p&&($u(i.x,p.offset.x),$u(i.y,p.offset.y)),i}removeElementScroll(h){const i=Si();qa(i,h);for(let p=0;p<this.path.length;p++){const y=this.path[p],{scroll:b,options:_}=y;if(y!==this.root&&b&&_.layoutScroll){if(b.isRoot){qa(i,h);const{scroll:E}=this.root;E&&($u(i.x,-E.offset.x),$u(i.y,-E.offset.y))}$u(i.x,b.offset.x),$u(i.y,b.offset.y)}}return i}applyTransform(h,i=!1){const p=Si();qa(p,h);for(let y=0;y<this.path.length;y++){const b=this.path[y];!i&&b.options.layoutScroll&&b.scroll&&b!==b.root&&rm(p,{x:-b.scroll.offset.x,y:-b.scroll.offset.y}),Ah(b.latestValues)&&rm(p,b.latestValues)}return Ah(this.latestValues)&&rm(p,this.latestValues),p}removeTransform(h){const i=Si();qa(i,h);for(let p=0;p<this.path.length;p++){const y=this.path[p];if(!y.instance||!Ah(y.latestValues))continue;DA(y.latestValues)&&y.updateSnapshot();const b=Si(),_=y.measurePageBox();qa(b,_),AB(i,y.latestValues,y.snapshot?y.snapshot.layoutBox:void 0,b)}return Ah(this.latestValues)&&AB(i,this.latestValues),i}setTargetDelta(h){this.targetDelta=h,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(h){this.options={...this.options,...h,crossfade:h.crossfade!==void 0?h.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==to.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(h=!1){var i;const p=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=p.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=p.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=p.isSharedProjectionDirty);const y=!!this.resumingFrom||this!==p;if(!(h||y&&this.isSharedProjectionDirty||this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:_,layoutId:E}=this.options;if(!(!this.layout||!(_||E))){if(this.resolvedRelativeTargetAt=to.timestamp,!this.targetDelta&&!this.relativeTarget){const C=this.getClosestProjectingParent();C&&C.layout&&this.animationProgress!==1?(this.relativeParent=C,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Si(),this.relativeTargetOrigin=Si(),cx(this.relativeTargetOrigin,this.layout.layoutBox,C.layout.layoutBox),qa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Si(),this.targetWithTransforms=Si()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Pfe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):qa(this.target,this.layout.layoutBox),kG(this.target,this.targetDelta)):qa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const C=this.getClosestProjectingParent();C&&!!C.resumingFrom==!!this.resumingFrom&&!C.options.layoutScroll&&C.target&&this.animationProgress!==1?(this.relativeParent=C,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Si(),this.relativeTargetOrigin=Si(),cx(this.relativeTargetOrigin,this.target,C.target),qa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}kh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||DA(this.parent.latestValues)||AG(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var h;const i=this.getLead(),p=!!this.resumingFrom||this!==i;let y=!0;if((this.isProjectionDirty||!((h=this.parent)===null||h===void 0)&&h.isProjectionDirty)&&(y=!1),p&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(y=!1),this.resolvedRelativeTargetAt===to.timestamp&&(y=!1),y)return;const{layout:b,layoutId:_}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(b||_))return;qa(this.layoutCorrected,this.layout.layoutBox);const E=this.treeScale.x,C=this.treeScale.y;Lfe(this.layoutCorrected,this.treeScale,this.path,p),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox);const{target:k}=i;if(!k){this.projectionTransform&&(this.projectionDelta=tm(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=tm(),this.projectionDeltaWithTransform=tm());const N=this.projectionTransform;lx(this.projectionDelta,this.layoutCorrected,k,this.latestValues),this.projectionTransform=MB(this.projectionDelta,this.treeScale),(this.projectionTransform!==N||this.treeScale.x!==E||this.treeScale.y!==C)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",k)),kh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(h=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),h){const i=this.getStack();i&&i.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(h,i=!1){const p=this.snapshot,y=p?p.latestValues:{},b={...this.latestValues},_=tm();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!i;const E=Si(),C=p?p.source:void 0,k=this.layout?this.layout.source:void 0,N=C!==k,I=this.getStack(),B=!I||I.members.length<=1,O=!!(N&&!B&&this.options.crossfade===!0&&!this.path.some(Tpe));this.animationProgress=0;let R;this.mixTargetDelta=q=>{const F=q/1e3;LB(_.x,h.x,F),LB(_.y,h.y,F),this.setTargetDelta(_),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(cx(E,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Epe(this.relativeTarget,this.relativeTargetOrigin,E,F),R&&npe(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=Si()),qa(R,this.relativeTarget)),N&&(this.animationValues=b,Yfe(b,y,this.latestValues,F,O,B)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(h){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Qs(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=fn.update(()=>{Uw.hasAnimatedSinceResize=!0,this.currentAnimation=upe(0,OB,{...h,onUpdate:i=>{this.mixTargetDelta(i),h.onUpdate&&h.onUpdate(i)},onComplete:()=>{h.onComplete&&h.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const h=this.getStack();h&&h.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(OB),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const h=this.getLead();let{targetWithTransforms:i,target:p,layout:y,latestValues:b}=h;if(!(!i||!p||!y)){if(this!==h&&this.layout&&y&&zG(this.options.animationType,this.layout.layoutBox,y.layoutBox)){p=this.target||Si();const _=Aa(this.layout.layoutBox.x);p.x.min=h.target.x.min,p.x.max=p.x.min+_;const E=Aa(this.layout.layoutBox.y);p.y.min=h.target.y.min,p.y.max=p.y.min+E}qa(i,p),rm(i,b),lx(this.projectionDeltaWithTransform,this.layoutCorrected,i,b)}}registerSharedNode(h,i){this.sharedNodes.has(h)||this.sharedNodes.set(h,new ipe),this.sharedNodes.get(h).add(i);const y=i.options.initialPromotionConfig;i.promote({transition:y?y.transition:void 0,preserveFollowOpacity:y&&y.shouldPreserveFollowOpacity?y.shouldPreserveFollowOpacity(i):void 0})}isLead(){const h=this.getStack();return h?h.lead===this:!0}getLead(){var h;const{layoutId:i}=this.options;return i?((h=this.getStack())===null||h===void 0?void 0:h.lead)||this:this}getPrevLead(){var h;const{layoutId:i}=this.options;return i?(h=this.getStack())===null||h===void 0?void 0:h.prevLead:void 0}getStack(){const{layoutId:h}=this.options;if(h)return this.root.sharedNodes.get(h)}promote({needsReset:h,transition:i,preserveFollowOpacity:p}={}){const y=this.getStack();y&&y.promote(this,p),h&&(this.projectionDelta=void 0,this.needsReset=!0),i&&this.setOptions({transition:i})}relegate(){const h=this.getStack();return h?h.relegate(this):!1}resetRotation(){const{visualElement:h}=this.options;if(!h)return;let i=!1;const{latestValues:p}=h;if((p.rotate||p.rotateX||p.rotateY||p.rotateZ)&&(i=!0),!i)return;const y={};for(let b=0;b<IB.length;b++){const _="rotate"+IB[b];p[_]&&(y[_]=p[_],h.setStaticValue(_,0))}h.render();for(const b in y)h.setStaticValue(b,y[b]);h.scheduleRender()}getProjectionStyles(h){var i,p;if(!this.instance||this.isSVG)return;if(!this.isVisible)return dpe;const y={visibility:""},b=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,y.opacity="",y.pointerEvents=Fw(h==null?void 0:h.pointerEvents)||"",y.transform=b?b(this.latestValues,""):"none",y;const _=this.getLead();if(!this.projectionDelta||!this.layout||!_.target){const N={};return this.options.layoutId&&(N.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,N.pointerEvents=Fw(h==null?void 0:h.pointerEvents)||""),this.hasProjected&&!Ah(this.latestValues)&&(N.transform=b?b({},""):"none",this.hasProjected=!1),N}const E=_.animationValues||_.latestValues;this.applyTransformsToTarget(),y.transform=MB(this.projectionDeltaWithTransform,this.treeScale,E),b&&(y.transform=b(E,y.transform));const{x:C,y:k}=this.projectionDelta;y.transformOrigin=`${C.origin*100}% ${k.origin*100}% 0`,_.animationValues?y.opacity=_===this?(p=(i=E.opacity)!==null&&i!==void 0?i:this.latestValues.opacity)!==null&&p!==void 0?p:1:this.preserveOpacity?this.latestValues.opacity:E.opacityExit:y.opacity=_===this?E.opacity!==void 0?E.opacity:"":E.opacityExit!==void 0?E.opacityExit:0;for(const N in N1){if(E[N]===void 0)continue;const{correct:I,applyTo:B}=N1[N],O=y.transform==="none"?E[N]:I(E[N],_);if(B){const R=B.length;for(let q=0;q<R;q++)y[B[q]]=O}else y[N]=O}return this.options.layoutId&&(y.pointerEvents=_===this?Fw(h==null?void 0:h.pointerEvents)||"":"none"),y}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(h=>{var i;return(i=h.currentAnimation)===null||i===void 0?void 0:i.stop()}),this.root.nodes.forEach(DB),this.root.sharedNodes.clear()}}}function fpe(e){e.updateLayout()}function ppe(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:o}=e.layout,{animationType:s}=e.options,h=r.source!==e.layout.source;s==="size"?Xa(_=>{const E=h?r.measuredBox[_]:r.layoutBox[_],C=Aa(E);E.min=n[_].min,E.max=E.min+C}):zG(s,r.layoutBox,n)&&Xa(_=>{const E=h?r.measuredBox[_]:r.layoutBox[_],C=Aa(n[_]);E.max=E.min+C,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[_].max=e.relativeTarget[_].min+C)});const i=tm();lx(i,n,r.layoutBox);const p=tm();h?lx(p,e.applyTransform(o,!0),r.measuredBox):lx(p,n,r.layoutBox);const y=!RG(i);let b=!1;if(!e.resumeFrom){const _=e.getClosestProjectingParent();if(_&&!_.resumeFrom){const{snapshot:E,layout:C}=_;if(E&&C){const k=Si();cx(k,r.layoutBox,E.layoutBox);const N=Si();cx(N,n,C.layoutBox),LG(k,N)||(b=!0),_.options.layoutRoot&&(e.relativeTarget=N,e.relativeTargetOrigin=k,e.relativeParent=_)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:p,layoutDelta:i,hasLayoutChanged:y,hasRelativeTargetChanged:b})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function mpe(e){kh.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function gpe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function ype(e){e.clearSnapshot()}function DB(e){e.clearMeasurements()}function vpe(e){e.isLayoutDirty=!1}function xpe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function RB(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function bpe(e){e.resolveTargetDelta()}function _pe(e){e.calcProjection()}function wpe(e){e.resetRotation()}function Spe(e){e.removeLeadSnapshot()}function LB(e,t,r){e.translate=ii(t.translate,0,r),e.scale=ii(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function BB(e,t,r,n){e.min=ii(t.min,r.min,n),e.max=ii(t.max,r.max,n)}function Epe(e,t,r,n){BB(e.x,t.x,r.x,n),BB(e.y,t.y,r.y,n)}function Tpe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const jpe={duration:.45,ease:[.4,0,.1,1]},zB=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),$B=zB("applewebkit/")&&!zB("chrome/")?Math.round:hi;function FB(e){e.min=$B(e.min),e.max=$B(e.max)}function Cpe(e){FB(e.x),FB(e.y)}function zG(e,t,r){return e==="position"||e==="preserve-aspect"&&!IA(NB(t),NB(r),.2)}const Ppe=BG({attachResizeListener:(e,t)=>gc(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),_C={current:void 0},$G=BG({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!_C.current){const e=new Ppe({});e.mount(window),e.setOptions({layoutScroll:!0}),_C.current=e}return _C.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Ape={pan:{Feature:Wfe},drag:{Feature:qfe,ProjectionNode:$G,MeasureLayout:IG}},kpe=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Npe(e){const t=kpe.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function LA(e,t,r=1){const[n,o]=Npe(e);if(!n)return;const s=window.getComputedStyle(t).getPropertyValue(n);if(s){const h=s.trim();return _G(h)?parseFloat(h):h}else return TA(o)?LA(o,t,r+1):o}function Mpe(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(o=>{const s=o.get();if(!TA(s))return;const h=LA(s,n);h&&o.set(h)});for(const o in t){const s=t[o];if(!TA(s))continue;const h=LA(s,n);h&&(t[o]=h,r||(r={}),r[o]===void 0&&(r[o]=s))}return{target:t,transitionEnd:r}}const Ipe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),FG=e=>Ipe.has(e),Ope=e=>Object.keys(e).some(FG),UB=e=>e===wf||e===xr,VB=(e,t)=>parseFloat(e.split(", ")[t]),qB=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const o=n.match(/^matrix3d\((.+)\)$/);if(o)return VB(o[1],t);{const s=n.match(/^matrix\((.+)\)$/);return s?VB(s[1],e):0}},Dpe=new Set(["x","y","z"]),Rpe=Fb.filter(e=>!Dpe.has(e));function Lpe(e){const t=[];return Rpe.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const Am={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:qB(4,13),y:qB(5,14)};Am.translateX=Am.x;Am.translateY=Am.y;const Bpe=(e,t,r)=>{const n=t.measureViewportBox(),o=t.current,s=getComputedStyle(o),{display:h}=s,i={};h==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(y=>{i[y]=Am[y](n,s)}),t.render();const p=t.measureViewportBox();return r.forEach(y=>{const b=t.getValue(y);b&&b.jump(i[y]),e[y]=Am[y](p,s)}),e},zpe=(e,t,r={},n={})=>{t={...t},n={...n};const o=Object.keys(t).filter(FG);let s=[],h=!1;const i=[];if(o.forEach(p=>{const y=e.getValue(p);if(!e.hasValue(p))return;let b=r[p],_=xv(b);const E=t[p];let C;if(I1(E)){const k=E.length,N=E[0]===null?1:0;b=E[N],_=xv(b);for(let I=N;I<k&&E[I]!==null;I++)C?$2(xv(E[I])===C):C=xv(E[I])}else C=xv(E);if(_!==C)if(UB(_)&&UB(C)){const k=y.get();typeof k=="string"&&y.set(parseFloat(k)),typeof E=="string"?t[p]=parseFloat(E):Array.isArray(E)&&C===xr&&(t[p]=E.map(parseFloat))}else _!=null&&_.transform&&(C!=null&&C.transform)&&(b===0||E===0)?b===0?y.set(C.transform(b)):t[p]=_.transform(E):(h||(s=Lpe(e),h=!0),i.push(p),n[p]=n[p]!==void 0?n[p]:t[p],y.jump(E))}),i.length){const p=i.indexOf("height")>=0?window.pageYOffset:null,y=Bpe(t,e,i);return s.length&&s.forEach(([b,_])=>{e.getValue(b).set(_)}),e.render(),O2&&p!==null&&window.scrollTo({top:p}),{target:y,transitionEnd:n}}else return{target:t,transitionEnd:n}};function $pe(e,t,r,n){return Ope(t)?zpe(e,t,r,n):{target:t,transitionEnd:n}}const Fpe=(e,t,r,n)=>{const o=Mpe(e,t,n);return t=o.target,n=o.transitionEnd,$pe(e,t,r,n)},BA={current:null},UG={current:!1};function Upe(){if(UG.current=!0,!!O2)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>BA.current=e.matches;e.addListener(t),t()}else BA.current=!1}function Vpe(e,t,r){const{willChange:n}=t;for(const o in t){const s=t[o],h=r[o];if(la(s))e.addValue(o,s),L1(n)&&n.add(o);else if(la(h))e.addValue(o,qs(s,{owner:e})),L1(n)&&n.remove(o);else if(h!==s)if(e.hasValue(o)){const i=e.getValue(o);!i.hasAnimated&&i.set(s)}else{const i=e.getStaticValue(o);e.addValue(o,qs(i!==void 0?i:s,{owner:e}))}}for(const o in r)t[o]===void 0&&e.removeValue(o);return t}const WB=new WeakMap,VG=Object.keys(Vx),qpe=VG.length,GB=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Wpe=iI.length;class Gpe{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:o,visualState:s},h={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>fn.render(this.render,!1,!0);const{latestValues:i,renderState:p}=s;this.latestValues=i,this.baseTarget={...i},this.initialValues=r.initial?{...i}:{},this.renderState=p,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=o,this.options=h,this.isControllingVariants=R2(r),this.isVariantNode=CW(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:y,...b}=this.scrapeMotionValuesFromProps(r,{});for(const _ in b){const E=b[_];i[_]!==void 0&&la(E)&&(E.set(i[_],!1),L1(y)&&y.add(_))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,WB.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),UG.current||Upe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:BA.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){WB.delete(this.current),this.projection&&this.projection.unmount(),Qs(this.notifyUpdate),Qs(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=_f.has(t),o=r.on("change",h=>{this.latestValues[t]=h,this.props.onUpdate&&fn.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),s=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{o(),s()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,o,s){let h,i;for(let p=0;p<qpe;p++){const y=VG[p],{isEnabled:b,Feature:_,ProjectionNode:E,MeasureLayout:C}=Vx[y];E&&(h=E),b(r)&&(!this.features[y]&&_&&(this.features[y]=new _(this)),C&&(i=C))}if((this.type==="html"||this.type==="svg")&&!this.projection&&h){this.projection=new h(this.latestValues,this.parent&&this.parent.projection);const{layoutId:p,layout:y,drag:b,dragConstraints:_,layoutScroll:E,layoutRoot:C}=r;this.projection.setOptions({layoutId:p,layout:y,alwaysMeasureLayout:!!b||_&&Qp(_),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof y=="string"?y:"both",initialPromotionConfig:s,layoutScroll:E,layoutRoot:C})}return i}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Si()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<GB.length;n++){const o=GB[n];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const s=t["on"+o];s&&(this.propEventSubscriptions[o]=this.on(o,s))}this.prevMotionValues=Vpe(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<Wpe;n++){const o=iI[n],s=this.props[o];(Ux(s)||s===!1)&&(r[o]=s)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=qs(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,o=typeof n=="string"||typeof n=="object"?(r=hI(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&o!==void 0)return o;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!la(s)?s:this.initialValues[t]!==void 0&&o===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new wI),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class qG extends Gpe{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:o},s){let h=ufe(n,t||{},this);if(o&&(r&&(r=o(r)),n&&(n=o(n)),h&&(h=o(h))),s){lfe(this,n,h);const i=Fpe(this,n,h,r);r=i.transitionEnd,n=i.target}return{transition:t,transitionEnd:r,...n}}}function Hpe(e){return window.getComputedStyle(e)}class Xpe extends qG{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(_f.has(r)){const n=yI(r);return n&&n.default||0}else{const n=Hpe(t),o=(NW(r)?n.getPropertyValue(r):n[r])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(t,{transformPagePoint:r}){return NG(t,r)}build(t,r,n,o){sI(t,r,n,o.transformTemplate)}scrapeMotionValuesFromProps(t,r){return dI(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;la(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,o){LW(t,r,n,o)}}class Zpe extends qG{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(_f.has(r)){const n=yI(r);return n&&n.default||0}return r=BW.has(r)?r:rI(r),t.getAttribute(r)}measureInstanceViewportBox(){return Si()}scrapeMotionValuesFromProps(t,r){return $W(t,r)}build(t,r,n,o){cI(t,r,n,this.isSVGTag,o.transformTemplate)}renderInstance(t,r,n,o){zW(t,r,n,o)}mount(t){this.isSVGTag=uI(t.tagName),super.mount(t)}}const Kpe=(e,t)=>aI(e)?new Zpe(t,{enableHardwareAcceleration:!1}):new Xpe(t,{enableHardwareAcceleration:!0}),Ype={layout:{ProjectionNode:$G,MeasureLayout:IG}},Jpe={...Efe,...Hde,...Ape,...Ype},nt=rde((e,t)=>Ode(e,t,Jpe,Kpe));function WG(){const e=D.useRef(!1);return pg(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function Qpe(){const e=WG(),[t,r]=D.useState(0),n=D.useCallback(()=>{e.current&&r(t+1)},[t]);return[D.useCallback(()=>fn.postRender(n),[n]),t]}class eme extends D.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function tme({children:e,isPresent:t}){const r=D.useId(),n=D.useRef(null),o=D.useRef({width:0,height:0,top:0,left:0});return D.useInsertionEffect(()=>{const{width:s,height:h,top:i,left:p}=o.current;if(t||!n.current||!s||!h)return;n.current.dataset.motionPopId=r;const y=document.createElement("style");return document.head.appendChild(y),y.sheet&&y.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${s}px !important;
            height: ${h}px !important;
            top: ${i}px !important;
            left: ${p}px !important;
          }
        `),()=>{document.head.removeChild(y)}},[t]),D.createElement(eme,{isPresent:t,childRef:n,sizeRef:o},D.cloneElement(e,{ref:n}))}const wC=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:o,presenceAffectsLayout:s,mode:h})=>{const i=mg(rme),p=D.useId(),y=D.useMemo(()=>({id:p,initial:t,isPresent:r,custom:o,onExitComplete:b=>{i.set(b,!0);for(const _ of i.values())if(!_)return;n&&n()},register:b=>(i.set(b,!1),()=>i.delete(b))}),s?void 0:[r]);return D.useMemo(()=>{i.forEach((b,_)=>i.set(_,!1))},[r]),D.useEffect(()=>{!r&&!i.size&&n&&n()},[r]),h==="popLayout"&&(e=D.createElement(tme,{isPresent:r},e)),D.createElement(I2.Provider,{value:y},e)};function rme(){return new Map}function nme(e){return D.useEffect(()=>()=>e(),[])}const Nh=e=>e.key||"";function ime(e,t){e.forEach(r=>{const n=Nh(r);t.set(n,r)})}function ome(e){const t=[];return D.Children.forEach(e,r=>{D.isValidElement(r)&&t.push(r)}),t}const GG=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:o,presenceAffectsLayout:s=!0,mode:h="sync"})=>{const i=D.useContext(oI).forceRender||Qpe()[0],p=WG(),y=ome(e);let b=y;const _=D.useRef(new Map).current,E=D.useRef(b),C=D.useRef(new Map).current,k=D.useRef(!0);if(pg(()=>{k.current=!1,ime(y,C),E.current=b}),nme(()=>{k.current=!0,C.clear(),_.clear()}),k.current)return D.createElement(D.Fragment,null,b.map(O=>D.createElement(wC,{key:Nh(O),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:s,mode:h},O)));b=[...b];const N=E.current.map(Nh),I=y.map(Nh),B=N.length;for(let O=0;O<B;O++){const R=N[O];I.indexOf(R)===-1&&!_.has(R)&&_.set(R,void 0)}return h==="wait"&&_.size&&(b=[]),_.forEach((O,R)=>{if(I.indexOf(R)!==-1)return;const q=C.get(R);if(!q)return;const F=N.indexOf(R);let X=O;if(!X){const G=()=>{_.delete(R);const ee=Array.from(C.keys()).filter(K=>!I.includes(K));if(ee.forEach(K=>C.delete(K)),E.current=y.filter(K=>{const ie=Nh(K);return ie===R||ee.includes(ie)}),!_.size){if(p.current===!1)return;i(),n&&n()}};X=D.createElement(wC,{key:Nh(q),isPresent:!1,onExitComplete:G,custom:t,presenceAffectsLayout:s,mode:h},q),_.set(R,X)}b.splice(F,0,X)}),b=b.map(O=>{const R=O.key;return _.has(R)?O:D.createElement(wC,{key:Nh(O),isPresent:!0,presenceAffectsLayout:s,mode:h},O)}),D.createElement(D.Fragment,null,_.size?b:b.map(O=>D.cloneElement(O)))};function ame(e){const t=mg(()=>qs(e)),{isStatic:r}=D.useContext(tI);if(r){const[,n]=D.useState(e);D.useEffect(()=>t.on("change",n),[])}return t}const sme=e=>e&&typeof e=="object"&&e.mix,lme=e=>sme(e)?e.mix:void 0;function cme(...e){const t=!Array.isArray(e[0]),r=t?0:-1,n=e[0+r],o=e[1+r],s=e[2+r],h=e[3+r],i=F2(o,s,{mixer:lme(s[0]),...h});return t?i(n):i}function HG(e,t){const r=ame(t()),n=()=>r.set(t());return n(),pg(()=>{const o=()=>fn.update(n,!1,!0),s=e.map(h=>h.on("change",o));return()=>{s.forEach(h=>h()),Qs(n)}}),r}function ume(e){sx.current=[],e();const t=HG(sx.current,e);return sx.current=void 0,t}function HB(e,t,r,n){if(typeof e=="function")return ume(e);const o=typeof t=="function"?t:cme(t,r,n);return Array.isArray(e)?XB(e,o):XB([e],([s])=>o(s))}function XB(e,t){const r=mg(()=>[]);return HG(e,()=>{r.length=0;const n=e.length;for(let o=0;o<n;o++)r[o]=e[o].get();return t(r)})}function XG(e,t,r){var n;if(typeof e=="string"){let o=document;t&&($2(!!t.current),o=t.current),r?((n=r[e])!==null&&n!==void 0||(r[e]=o.querySelectorAll(e)),e=r[e]):e=o.querySelectorAll(e)}else e instanceof Element&&(e=[e]);return Array.from(e||[])}const Vw=new WeakMap;let Iu;function dme(e,t){if(t){const{inlineSize:r,blockSize:n}=t[0];return{width:r,height:n}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function hme({target:e,contentRect:t,borderBoxSize:r}){var n;(n=Vw.get(e))===null||n===void 0||n.forEach(o=>{o({target:e,contentSize:t,get size(){return dme(e,r)}})})}function fme(e){e.forEach(hme)}function pme(){typeof ResizeObserver>"u"||(Iu=new ResizeObserver(fme))}function mme(e,t){Iu||pme();const r=XG(e);return r.forEach(n=>{let o=Vw.get(n);o||(o=new Set,Vw.set(n,o)),o.add(t),Iu==null||Iu.observe(n)}),()=>{r.forEach(n=>{const o=Vw.get(n);o==null||o.delete(t),o!=null&&o.size||Iu==null||Iu.unobserve(n)})}}const qw=new Set;let ux;function gme(){ux=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};qw.forEach(r=>r(t))},window.addEventListener("resize",ux)}function yme(e){return qw.add(e),ux||gme(),()=>{qw.delete(e),!qw.size&&ux&&(ux=void 0)}}function vme(e,t){return typeof e=="function"?yme(e):mme(e,t)}const xme=50,ZB=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),bme=()=>({time:0,x:ZB(),y:ZB()}),_me={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function KB(e,t,r,n){const o=r[t],{length:s,position:h}=_me[t],i=o.current,p=r.time;o.current=e["scroll"+h],o.scrollLength=e["scroll"+s]-e["client"+s],o.offset.length=0,o.offset[0]=0,o.offset[1]=o.scrollLength,o.progress=Pm(0,o.scrollLength,o.current);const y=n-p;o.velocity=y>xme?0:gI(o.current-i,y)}function wme(e,t,r){KB(e,"x",t,r),KB(e,"y",t,r),t.time=r}function Sme(e,t){const r={x:0,y:0};let n=e;for(;n&&n!==t;)if(n instanceof HTMLElement)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;else if(n.tagName==="svg"){const o=n.getBoundingClientRect();n=n.parentElement;const s=n.getBoundingClientRect();r.x+=o.left-s.left,r.y+=o.top-s.top}else if(n instanceof SVGGraphicsElement){const{x:o,y:s}=n.getBBox();r.x+=o,r.y+=s;let h=null,i=n.parentNode;for(;!h;)i.tagName==="svg"&&(h=i),i=n.parentNode;n=h}else break;return r}const Eme={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},zA={start:0,center:.5,end:1};function YB(e,t,r=0){let n=0;if(zA[e]!==void 0&&(e=zA[e]),typeof e=="string"){const o=parseFloat(e);e.endsWith("px")?n=o:e.endsWith("%")?e=o/100:e.endsWith("vw")?n=o/100*document.documentElement.clientWidth:e.endsWith("vh")?n=o/100*document.documentElement.clientHeight:e=o}return typeof e=="number"&&(n=t*e),r+n}const Tme=[0,0];function jme(e,t,r,n){let o=Array.isArray(e)?e:Tme,s=0,h=0;return typeof e=="number"?o=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?o=e.split(" "):o=[e,zA[e]?e:"0"]),s=YB(o[0],r,n),h=YB(o[1],t),s-h}const Cme={x:0,y:0};function Pme(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function Ame(e,t,r){let{offset:n=Eme.All}=r;const{target:o=e,axis:s="y"}=r,h=s==="y"?"height":"width",i=o!==e?Sme(o,e):Cme,p=o===e?{width:e.scrollWidth,height:e.scrollHeight}:Pme(o),y={width:e.clientWidth,height:e.clientHeight};t[s].offset.length=0;let b=!t[s].interpolate;const _=n.length;for(let E=0;E<_;E++){const C=jme(n[E],y[h],p[h],i[s]);!b&&C!==t[s].interpolatorOffsets[E]&&(b=!0),t[s].offset[E]=C}b&&(t[s].interpolate=F2(t[s].offset,gG(n)),t[s].interpolatorOffsets=[...t[s].offset]),t[s].progress=t[s].interpolate(t[s].current)}function kme(e,t=e,r){if(r.x.targetOffset=0,r.y.targetOffset=0,t!==e){let n=t;for(;n&&n!==e;)r.x.targetOffset+=n.offsetLeft,r.y.targetOffset+=n.offsetTop,n=n.offsetParent}r.x.targetLength=t===e?t.scrollWidth:t.clientWidth,r.y.targetLength=t===e?t.scrollHeight:t.clientHeight,r.x.containerLength=e.clientWidth,r.y.containerLength=e.clientHeight}function Nme(e,t,r,n={}){return{measure:()=>kme(e,n.target,r),update:o=>{wme(e,r,o),(n.offset||n.target)&&Ame(e,r,n)},notify:()=>t(r)}}const _v=new WeakMap,JB=new WeakMap,SC=new WeakMap,QB=e=>e===document.documentElement?window:e;function Mme(e,{container:t=document.documentElement,...r}={}){let n=SC.get(t);n||(n=new Set,SC.set(t,n));const o=bme(),s=Nme(t,e,o,r);if(n.add(s),!_v.has(t)){const i=()=>{for(const E of n)E.measure()},p=()=>{for(const E of n)E.update(to.timestamp)},y=()=>{for(const E of n)E.notify()},b=()=>{fn.read(i,!1,!0),fn.read(p,!1,!0),fn.update(y,!1,!0)};_v.set(t,b);const _=QB(t);window.addEventListener("resize",b,{passive:!0}),t!==document.documentElement&&JB.set(t,vme(t,b)),_.addEventListener("scroll",b,{passive:!0})}const h=_v.get(t);return fn.read(h,!1,!0),()=>{var i;Qs(h);const p=SC.get(t);if(!p||(p.delete(s),p.size))return;const y=_v.get(t);_v.delete(t),y&&(QB(t).removeEventListener("scroll",y),(i=JB.get(t))===null||i===void 0||i(),window.removeEventListener("resize",y))}}function ez(e,t){XW(!!(!t||t.current))}const Ime=()=>({scrollX:qs(0),scrollY:qs(0),scrollXProgress:qs(0),scrollYProgress:qs(0)});function Ome({container:e,target:t,layoutEffect:r=!0,...n}={}){const o=mg(Ime);return(r?pg:D.useEffect)(()=>(ez("target",t),ez("container",e),Mme(({x:h,y:i})=>{o.scrollX.set(h.current),o.scrollXProgress.set(h.progress),o.scrollY.set(i.current),o.scrollYProgress.set(i.progress)},{...n,container:(e==null?void 0:e.current)||void 0,target:(t==null?void 0:t.current)||void 0})),[e,t,JSON.stringify(n.offset)]),o}function Dme(e){e.values.forEach(t=>t.stop())}function Rme(){const e=new Set,t={subscribe(r){return e.add(r),()=>void e.delete(r)},start(r,n){const o=[];return e.forEach(s=>{o.push(TG(s,r,{transitionOverride:n}))}),Promise.all(o)},set(r){return e.forEach(n=>{sfe(n,r)})},stop(){e.forEach(r=>{Dme(r)})},mount(){return()=>{t.stop()}}};return t}function Lme(){const e=mg(Rme);return pg(e.mount,[]),e}const ZG=Lme,Bme={some:0,all:1};function zme(e,t,{root:r,margin:n,amount:o="some"}={}){const s=XG(e),h=new WeakMap,i=y=>{y.forEach(b=>{const _=h.get(b.target);if(b.isIntersecting!==!!_)if(b.isIntersecting){const E=t(b);typeof E=="function"?h.set(b.target,E):p.unobserve(b.target)}else _&&(_(b),h.delete(b.target))})},p=new IntersectionObserver(i,{root:r,rootMargin:n,threshold:typeof o=="number"?o:Bme[o]});return s.forEach(y=>p.observe(y)),()=>p.disconnect()}function $me(e,{root:t,margin:r,amount:n,once:o=!1}={}){const[s,h]=D.useState(!1);return D.useEffect(()=>{if(!e.current||o&&s)return;const i=()=>(h(!0),o?void 0:()=>h(!1)),p={root:t&&t.current||void 0,margin:r,amount:n};return zme(e.current,i,p)},[t,e,r,o,n]),s}const Fme=()=>{const e=Array.from({length:50},(t,r)=>({id:r,x:Math.random()*100,y:Math.random()*100,delay:Math.random()*2,duration:3+Math.random()*2}));return c.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.map(t=>c.jsx(nt.div,{className:"absolute w-1 h-1 bg-white/20 rounded-full",style:{left:`${t.x}%`,top:`${t.y}%`},animate:{y:[0,-30,0],opacity:[0,1,0],scale:[.5,1,.5]},transition:{duration:t.duration,repeat:1/0,delay:t.delay,ease:"easeInOut"}},t.id))})},Ume=()=>c.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[c.jsx(nt.div,{className:"absolute inset-0 opacity-50",animate:{background:["linear-gradient(45deg, #8B1538, #A0263A, #8B1538)","linear-gradient(135deg, #A0263A, #B8344F, #A0263A)","linear-gradient(225deg, #8B1538, #A0263A, #8B1538)"]},transition:{duration:8,repeat:1/0,ease:"easeInOut"}}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-brand-burgundy/90 via-brand-burgundy-light/80 to-brand-burgundy/90"})]}),Vme=({text:e,delay:t=0})=>{const[r,n]=D.useState(""),[o,s]=D.useState(!0);return D.useEffect(()=>{const h=setTimeout(()=>{let i=0;const p=setInterval(()=>{i<=e.length?(n(e.slice(0,i)),i++):(clearInterval(p),s(!1))},100);return()=>clearInterval(p)},t);return()=>clearTimeout(h)},[e,t]),c.jsxs("span",{children:[r,o&&c.jsx(nt.span,{animate:{opacity:[1,0]},transition:{duration:.5,repeat:1/0,ease:"easeInOut"},className:"inline-block w-0.5 h-8 md:h-12 bg-white/90 ml-1"})]})},qme=()=>{const[e,t]=D.useState(!1),[r,n]=D.useState(!1),o=zi(),s=ZG();D.useEffect(()=>{n(!0),s.start({opacity:1,y:0,transition:{duration:1,ease:"easeOut"}})},[s]);const h=[{id:"restaurant",name:"Restaurants",description:"Discover the finest dining experiences in Lagos",icon:m2,color:"from-brand-burgundy to-brand-burgundy/90",count:"50+ venues",features:["Fine Dining","Private Rooms","Chef's Table"]},{id:"club",name:"Clubs",description:"Experience the vibrant nightlife and premium entertainment",icon:A8,color:"from-brand-burgundy/90 to-brand-burgundy/80",count:"30+ venues",features:["VIP Tables","Premium Sound","Top DJs"]},{id:"lounge",name:"Lounges",description:"Relax in sophisticated lounges across the city",icon:Mc,color:"from-brand-burgundy/80 to-brand-burgundy/70",count:"25+ venues",features:["Cocktail Bar","Sky Views","Premium Service"]}],i=()=>{t(!0)},p=()=>{o("/venue-owner/login")},y=E=>{o(`/venues?type=${E}`)},b={hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.3,staggerChildren:.2}}},_={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100,damping:10}}};return c.jsx("div",{className:"min-h-screen bg-brand-cream overflow-hidden",children:c.jsx(GG,{mode:"wait",children:e?c.jsxs(nt.section,{className:"relative bg-brand-cream min-h-screen flex items-center overflow-hidden pt-16 pb-16 md:pt-32 md:pb-32",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[c.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[c.jsx(nt.div,{className:"absolute inset-0 opacity-5",animate:{backgroundImage:["radial-gradient(circle at 20% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 80% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 40% 60%, #8B1538 0%, transparent 50%)","radial-gradient(circle at 80% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 20% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 60% 40%, #8B1538 0%, transparent 50%)","radial-gradient(circle at 20% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 80% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 40% 60%, #8B1538 0%, transparent 50%)"]},transition:{duration:10,repeat:1/0,ease:"easeInOut"}}),Array.from({length:8}).map((E,C)=>c.jsx(nt.div,{className:"absolute w-20 h-20 border-2 border-brand-burgundy/10 rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-30,0],x:[0,15,0],rotate:[0,180,360],scale:[1,1.2,1]},transition:{duration:8+Math.random()*4,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},C))]}),c.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[c.jsxs(nt.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"text-center mb-20",children:[c.jsx(nt.div,{className:"inline-block mb-6",animate:{rotate:[0,2,-2,0],scale:[1,1.02,1]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:c.jsxs("span",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-brand-burgundy/10 to-brand-gold/10 backdrop-blur-sm border border-brand-burgundy/20 rounded-full px-6 py-2 text-brand-burgundy/70 font-medium",children:[c.jsx(_1,{className:"w-4 h-4 text-brand-gold"}),"Premium Venue Categories"]})}),c.jsxs(nt.h2,{className:"text-5xl md:text-6xl lg:text-7xl font-heading text-brand-burgundy mb-6 font-bold",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:1,delay:.3},children:["Browse by"," ",c.jsxs(nt.span,{className:"relative inline-block",whileHover:{scale:1.05},children:[c.jsx("span",{className:"text-brand-gold font-extrabold",children:"Category"}),c.jsx(nt.div,{className:"absolute -bottom-2 left-0 right-0 h-1 bg-gradient-to-r from-brand-gold to-brand-burgundy rounded-full",initial:{scaleX:0},animate:{scaleX:1},transition:{duration:1,delay:.8}})]})]}),c.jsx(nt.p,{className:"text-xl md:text-2xl text-brand-burgundy/70 max-w-3xl mx-auto leading-relaxed",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.5},children:"Choose your perfect venue type and discover the best experiences Lagos has to offer"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 lg:gap-12",children:h.map((E,C)=>c.jsx(nt.div,{initial:{opacity:0,y:60,rotateY:-15},animate:{opacity:1,y:0,rotateY:0},transition:{duration:.8,delay:.6+C*.15,ease:"easeOut"},whileHover:{y:-15,scale:1.03,rotateY:5,transition:{duration:.4,ease:"easeOut",type:"spring",stiffness:200}},className:"group cursor-pointer perspective-1000",onClick:()=>y(E.id),style:{perspective:"1000px"},children:c.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl overflow-hidden border-2 border-brand-burgundy/10 group-hover:border-brand-gold/50 group-hover:shadow-3xl transition-all duration-500 transform-gpu",children:[c.jsxs(nt.div,{className:"relative h-80 bg-gradient-to-br from-brand-burgundy/5 to-brand-burgundy/10 flex items-center justify-center overflow-hidden",whileHover:{scale:1.02},transition:{duration:.4},children:[c.jsx(nt.div,{className:"absolute inset-0 opacity-10",animate:{background:["radial-gradient(circle at 0% 0%, rgba(128, 0, 32, 0.1) 0%, transparent 50%)","radial-gradient(circle at 100% 100%, rgba(128, 0, 32, 0.1) 0%, transparent 50%)","radial-gradient(circle at 0% 0%, rgba(128, 0, 32, 0.1) 0%, transparent 50%)"]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}}),Array.from({length:6}).map((k,N)=>c.jsx(nt.div,{className:"absolute w-1 h-1 bg-brand-burgundy/20 rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-15,0],x:[0,5,0],opacity:[.2,.4,.2],scale:[.5,1,.5]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},N)),c.jsx(nt.div,{className:"relative z-10",whileHover:{scale:1.15,rotate:[0,-5,5,0],y:-5},transition:{duration:.4,rotate:{duration:.6}},children:c.jsx(nt.div,{className:"relative",animate:{filter:["drop-shadow(0 0 20px rgba(128, 0, 32, 0.3))","drop-shadow(0 0 30px rgba(128, 0, 32, 0.5))","drop-shadow(0 0 20px rgba(128, 0, 32, 0.3))"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:c.jsx(E.icon,{className:"w-28 h-28 text-brand-burgundy drop-shadow-2xl"})})}),c.jsx(nt.div,{className:"absolute top-6 right-6 bg-brand-burgundy/10 backdrop-blur-sm rounded-2xl px-4 py-2 border border-brand-burgundy/20",initial:{opacity:0,x:30,scale:.8},animate:{opacity:1,x:0,scale:1},transition:{delay:.8+C*.1,duration:.5},whileHover:{scale:1.05,y:-2},children:c.jsx("span",{className:"text-brand-burgundy text-sm font-bold",children:E.count})}),c.jsx(nt.div,{className:"absolute bottom-6 left-6 w-8 h-8 border-l-2 border-b-2 border-brand-burgundy/30",animate:{scale:[1,1.1,1],opacity:[.3,.6,.3]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})]}),c.jsxs(nt.div,{className:"p-8 relative",whileHover:{backgroundColor:"rgba(139, 21, 56, 0.02)"},transition:{duration:.3},children:[c.jsx(nt.h3,{className:"text-3xl md:text-4xl font-bold text-brand-burgundy mb-4 group-hover:text-brand-gold transition-colors duration-300",whileHover:{x:5},children:E.name}),c.jsx(nt.p,{className:"text-brand-burgundy/70 text-lg mb-8 leading-relaxed",initial:{opacity:.7},whileHover:{opacity:1},children:E.description}),c.jsx("div",{className:"space-y-3 mb-8",children:E.features.map((k,N)=>c.jsxs(nt.div,{className:"flex items-center text-brand-burgundy/60 group-hover:text-brand-burgundy/80",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1+C*.1+N*.1},whileHover:{x:5,scale:1.02},children:[c.jsx(nt.div,{className:"mr-3",animate:{rotate:[0,180,360]},transition:{duration:8,repeat:1/0,ease:"linear",delay:N*.2},children:c.jsx(sa,{className:"w-4 h-4 text-brand-gold fill-brand-gold"})}),c.jsx("span",{className:"font-medium",children:k})]},N))}),c.jsxs(nt.div,{className:"relative overflow-hidden bg-gradient-to-r from-brand-burgundy/5 to-brand-gold/5 rounded-2xl p-4 group-hover:from-brand-burgundy/10 group-hover:to-brand-gold/10 transition-all duration-300",whileHover:{scale:1.02},children:[c.jsx(nt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/20 to-brand-burgundy/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.8}}),c.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[c.jsxs("div",{children:[c.jsxs(nt.span,{className:"font-bold text-brand-burgundy group-hover:text-brand-gold transition-colors duration-300 text-lg",whileHover:{scale:1.05},children:["Explore ",E.name]}),c.jsx("p",{className:"text-sm text-brand-burgundy/60 mt-1",children:"Discover premium venues"})]}),c.jsx(nt.div,{className:"flex items-center justify-center w-12 h-12 bg-brand-burgundy group-hover:bg-brand-gold rounded-full transition-colors duration-300",whileHover:{scale:1.1,rotate:90,boxShadow:"0 8px 25px rgba(139, 21, 56, 0.3)"},whileTap:{scale:.9},children:c.jsx(jl,{className:"w-5 h-5 text-white group-hover:text-brand-burgundy transition-colors duration-300"})})]})]}),c.jsx(nt.div,{className:"absolute top-4 right-4 w-16 h-16 bg-gradient-to-br from-brand-gold/10 to-brand-burgundy/10 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500",animate:{scale:[1,1.2,1],rotate:[0,180,360]},transition:{duration:8,repeat:1/0,ease:"linear"}})]}),c.jsx(nt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/0 via-brand-gold/5 to-brand-burgundy/0 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-500",initial:{scale:.8,opacity:0},whileHover:{scale:1,opacity:1}})]})},E.id))}),c.jsxs(nt.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:1.2},className:"text-center mt-20",children:[c.jsx(nt.p,{className:"text-brand-burgundy/60 mb-6 text-lg",animate:{opacity:[.6,1,.6]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:"Can't find what you're looking for?"}),c.jsx(nt.button,{whileHover:{scale:1.05,y:-3,boxShadow:"0 15px 35px rgba(139, 21, 56, 0.2)"},whileTap:{scale:.95},onClick:()=>o("/venues"),className:"bg-gradient-to-r from-brand-burgundy to-brand-burgundy-light hover:from-brand-gold hover:to-yellow-500 text-white px-8 py-4 rounded-2xl font-semibold text-lg shadow-xl transition-all duration-300",children:"Browse All Venues"})]})]})]},"categories"):c.jsxs(nt.section,{className:"relative bg-brand-burgundy flex items-center justify-center overflow-hidden min-h-screen pt-16 pb-16 md:pt-32 md:pb-32",initial:{opacity:1},exit:{opacity:0,scale:.95,transition:{duration:.6,ease:"easeInOut"}},children:[c.jsx(Ume,{}),c.jsx(Fme,{}),c.jsx("div",{className:"container mx-auto px-4 flex flex-col items-center justify-center h-full relative z-10",children:c.jsxs(nt.div,{className:"max-w-5xl w-full text-white text-center",variants:b,initial:"hidden",animate:"visible",children:[c.jsx(nt.div,{variants:_,className:"mb-8 pt-8 pb-4 md:pt-0 md:pb-0",children:c.jsxs(nt.div,{className:"inline-flex items-center gap-3 mb-6",whileHover:{scale:1.05},transition:{type:"spring",stiffness:400,damping:10},children:[c.jsx(nt.div,{className:"p-3 bg-brand-gold rounded-2xl",animate:{rotate:[0,5,-5,0],scale:[1,1.1,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:c.jsx(_1,{className:"w-8 h-8 text-brand-burgundy"})}),c.jsx("span",{className:"text-2xl font-bold tracking-wider text-brand-gold",children:"Eddys members"})]})}),c.jsxs(nt.h1,{variants:_,className:"text-5xl md:text-7xl lg:text-8xl font-heading mb-8 font-bold tracking-tight leading-tight",children:[c.jsx(nt.span,{className:"block mb-4 text-white/90",initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.8,delay:.5},children:"Discover"}),c.jsx(nt.span,{className:"block text-6xl md:text-8xl lg:text-9xl mb-4",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:1,delay:.8},children:c.jsx("span",{className:"text-brand-gold font-extrabold drop-shadow-2xl",children:c.jsx(Vme,{text:"Eddys'",delay:1200})})}),c.jsx(nt.span,{className:"block text-4xl md:text-6xl lg:text-7xl text-white/95",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:1.5},children:"Finest Venues"})]}),c.jsx(nt.p,{variants:_,className:"text-xl md:text-2xl lg:text-3xl mb-12 text-white/80 font-medium max-w-3xl mx-auto leading-relaxed",children:"Book tables, enjoy exclusive experiences, and make unforgettable memories in Lagos' most prestigious venues"}),c.jsxs(nt.div,{variants:_,className:"flex flex-col md:flex-row gap-6 lg:gap-8 justify-center items-center mb-12",children:[c.jsxs(nt.button,{whileHover:{scale:1.05,boxShadow:"0 20px 40px rgba(0,0,0,0.3)",y:-2},whileTap:{scale:.98},onClick:i,className:"group relative overflow-hidden flex items-center gap-4 bg-brand-cream text-brand-burgundy text-xl lg:text-2xl px-10 py-5 rounded-2xl font-semibold shadow-2xl hover:shadow-3xl transition-all duration-300 min-w-[250px] justify-center",children:[c.jsx(nt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/20 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6}}),c.jsx(ji,{className:"w-6 h-6 group-hover:scale-110 transition-transform duration-200"}),c.jsx("span",{children:"I'm a Customer"}),c.jsx(jl,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-200"})]}),c.jsxs(nt.button,{whileHover:{scale:1.05,y:-2,boxShadow:"0 20px 40px rgba(255,255,255,0.1)"},whileTap:{scale:.98},onClick:p,className:"group relative overflow-hidden flex items-center gap-4 bg-transparent border-2 border-brand-cream text-brand-cream text-xl lg:text-2xl px-10 py-5 rounded-2xl font-semibold shadow-2xl hover:bg-brand-cream/10 backdrop-blur-sm transition-all duration-300 min-w-[250px] justify-center",children:[c.jsx(nt.div,{className:"absolute inset-0 bg-brand-cream/10",initial:{scale:0,opacity:0},whileHover:{scale:1,opacity:1},transition:{duration:.3}}),c.jsx(dd,{className:"w-6 h-6 group-hover:scale-110 transition-transform duration-200"}),c.jsx("span",{children:"I'm a Venue Owner"}),c.jsx(jl,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-200"})]})]}),c.jsxs(nt.div,{variants:_,className:"flex flex-wrap justify-center items-center gap-6 md:gap-8 text-white/60 text-sm pt-4 pb-8 md:pt-0 md:pb-0",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(sa,{className:"w-4 h-4 text-brand-gold fill-brand-gold"}),c.jsx("span",{children:"4.9/5 Customer Rating"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Mc,{className:"w-4 h-4 text-brand-gold"}),c.jsx("span",{children:"100+ Premium Venues"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Bi,{className:"w-4 h-4 text-brand-gold"}),c.jsx("span",{children:"50K+ Happy Customers"})]})]})]})})]},"hero")})})},Xt=je.forwardRef(({className:e,type:t,...r},n)=>c.jsx("input",{type:t,className:Cr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...r}));Xt.displayName="Input";var Wme="Label",KG=D.forwardRef((e,t)=>c.jsx(fr.label,{...e,ref:t,onMouseDown:r=>{var o;r.target.closest("button, input, select, textarea")||((o=e.onMouseDown)==null||o.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));KG.displayName=Wme;var YG=KG;const Gme=f2("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),qt=je.forwardRef(({className:e,...t},r)=>c.jsx(YG,{ref:r,className:Cr(Gme(),e),...t}));qt.displayName=YG.displayName;function tz(e,[t,r]){return Math.min(r,Math.max(t,e))}function EI(e){const t=D.useRef({value:e,previous:e});return D.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Hme=[" ","Enter","ArrowUp","ArrowDown"],Xme=[" ","Enter"],sf="Select",[U2,V2,Zme]=u2(sf),[gg,ZUe]=as(sf,[Zme,b2]),q2=b2(),[Kme,Td]=gg(sf),[Yme,Jme]=gg(sf),JG=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:o,onOpenChange:s,value:h,defaultValue:i,onValueChange:p,dir:y,name:b,autoComplete:_,disabled:E,required:C,form:k}=e,N=q2(t),[I,B]=D.useState(null),[O,R]=D.useState(null),[q,F]=D.useState(!1),X=Ob(y),[G,ee]=Nc({prop:n,defaultProp:o??!1,onChange:s,caller:sf}),[K,ie]=Nc({prop:h,defaultProp:i,onChange:p,caller:sf}),pe=D.useRef(null),ae=I?k||!!I.closest("form"):!0,[_e,Ee]=D.useState(new Set),xe=Array.from(_e).map(ce=>ce.props.value).join(";");return c.jsx(oq,{...N,children:c.jsxs(Kme,{required:C,scope:t,trigger:I,onTriggerChange:B,valueNode:O,onValueNodeChange:R,valueNodeHasChildren:q,onValueNodeHasChildrenChange:F,contentId:Cl(),value:K,onValueChange:ie,open:G,onOpenChange:ee,dir:X,triggerPointerDownPosRef:pe,disabled:E,children:[c.jsx(U2.Provider,{scope:t,children:c.jsx(Yme,{scope:e.__scopeSelect,onNativeOptionAdd:D.useCallback(ce=>{Ee(ke=>new Set(ke).add(ce))},[]),onNativeOptionRemove:D.useCallback(ce=>{Ee(ke=>{const ve=new Set(ke);return ve.delete(ce),ve})},[]),children:r})}),ae?c.jsxs(b7,{"aria-hidden":!0,required:C,tabIndex:-1,name:b,autoComplete:_,value:K,onChange:ce=>ie(ce.target.value),disabled:E,form:k,children:[K===void 0?c.jsx("option",{value:""}):null,Array.from(_e)]},xe):null]})})};JG.displayName=sf;var QG="SelectTrigger",e7=D.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...o}=e,s=q2(r),h=Td(QG,r),i=h.disabled||n,p=Kr(t,h.onTriggerChange),y=V2(r),b=D.useRef("touch"),[_,E,C]=w7(N=>{const I=y().filter(R=>!R.disabled),B=I.find(R=>R.value===h.value),O=S7(I,N,B);O!==void 0&&h.onValueChange(O.value)}),k=N=>{i||(h.onOpenChange(!0),C()),N&&(h.triggerPointerDownPosRef.current={x:Math.round(N.pageX),y:Math.round(N.pageY)})};return c.jsx(aq,{asChild:!0,...s,children:c.jsx(fr.button,{type:"button",role:"combobox","aria-controls":h.contentId,"aria-expanded":h.open,"aria-required":h.required,"aria-autocomplete":"none",dir:h.dir,"data-state":h.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":_7(h.value)?"":void 0,...o,ref:p,onClick:Ht(o.onClick,N=>{N.currentTarget.focus(),b.current!=="mouse"&&k(N)}),onPointerDown:Ht(o.onPointerDown,N=>{b.current=N.pointerType;const I=N.target;I.hasPointerCapture(N.pointerId)&&I.releasePointerCapture(N.pointerId),N.button===0&&N.ctrlKey===!1&&N.pointerType==="mouse"&&(k(N),N.preventDefault())}),onKeyDown:Ht(o.onKeyDown,N=>{const I=_.current!=="";!(N.ctrlKey||N.altKey||N.metaKey)&&N.key.length===1&&E(N.key),!(I&&N.key===" ")&&Hme.includes(N.key)&&(k(),N.preventDefault())})})})});e7.displayName=QG;var t7="SelectValue",r7=D.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:o,children:s,placeholder:h="",...i}=e,p=Td(t7,r),{onValueNodeHasChildrenChange:y}=p,b=s!==void 0,_=Kr(t,p.onValueNodeChange);return so(()=>{y(b)},[y,b]),c.jsx(fr.span,{...i,ref:_,style:{pointerEvents:"none"},children:_7(p.value)?c.jsx(c.Fragment,{children:h}):s})});r7.displayName=t7;var Qme="SelectIcon",n7=D.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...o}=e;return c.jsx(fr.span,{"aria-hidden":!0,...o,ref:t,children:n||""})});n7.displayName=Qme;var ege="SelectPortal",i7=e=>c.jsx(d2,{asChild:!0,...e});i7.displayName=ege;var lf="SelectContent",o7=D.forwardRef((e,t)=>{const r=Td(lf,e.__scopeSelect),[n,o]=D.useState();if(so(()=>{o(new DocumentFragment)},[]),!r.open){const s=n;return s?Uc.createPortal(c.jsx(a7,{scope:e.__scopeSelect,children:c.jsx(U2.Slot,{scope:e.__scopeSelect,children:c.jsx("div",{children:e.children})})}),s):null}return c.jsx(s7,{...e,ref:t})});o7.displayName=lf;var Os=10,[a7,jd]=gg(lf),tge="SelectContentImpl",rge=tf("SelectContent.RemoveScroll"),s7=D.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:s,onPointerDownOutside:h,side:i,sideOffset:p,align:y,alignOffset:b,arrowPadding:_,collisionBoundary:E,collisionPadding:C,sticky:k,hideWhenDetached:N,avoidCollisions:I,...B}=e,O=Td(lf,r),[R,q]=D.useState(null),[F,X]=D.useState(null),G=Kr(t,Nt=>q(Nt)),[ee,K]=D.useState(null),[ie,pe]=D.useState(null),ae=V2(r),[_e,Ee]=D.useState(!1),xe=D.useRef(!1);D.useEffect(()=>{if(R)return UM(R)},[R]),AM();const ce=D.useCallback(Nt=>{const[Jt,...ft]=ae().map(it=>it.ref.current),[vt]=ft.slice(-1),lt=document.activeElement;for(const it of Nt)if(it===lt||(it==null||it.scrollIntoView({block:"nearest"}),it===Jt&&F&&(F.scrollTop=0),it===vt&&F&&(F.scrollTop=F.scrollHeight),it==null||it.focus(),document.activeElement!==lt))return},[ae,F]),ke=D.useCallback(()=>ce([ee,R]),[ce,ee,R]);D.useEffect(()=>{_e&&ke()},[_e,ke]);const{onOpenChange:ve,triggerPointerDownPosRef:Pe}=O;D.useEffect(()=>{if(R){let Nt={x:0,y:0};const Jt=vt=>{var lt,it;Nt={x:Math.abs(Math.round(vt.pageX)-(((lt=Pe.current)==null?void 0:lt.x)??0)),y:Math.abs(Math.round(vt.pageY)-(((it=Pe.current)==null?void 0:it.y)??0))}},ft=vt=>{Nt.x<=10&&Nt.y<=10?vt.preventDefault():R.contains(vt.target)||ve(!1),document.removeEventListener("pointermove",Jt),Pe.current=null};return Pe.current!==null&&(document.addEventListener("pointermove",Jt),document.addEventListener("pointerup",ft,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Jt),document.removeEventListener("pointerup",ft,{capture:!0})}}},[R,ve,Pe]),D.useEffect(()=>{const Nt=()=>ve(!1);return window.addEventListener("blur",Nt),window.addEventListener("resize",Nt),()=>{window.removeEventListener("blur",Nt),window.removeEventListener("resize",Nt)}},[ve]);const[Re,Be]=w7(Nt=>{const Jt=ae().filter(lt=>!lt.disabled),ft=Jt.find(lt=>lt.ref.current===document.activeElement),vt=S7(Jt,Nt,ft);vt&&setTimeout(()=>vt.ref.current.focus())}),Fe=D.useCallback((Nt,Jt,ft)=>{const vt=!xe.current&&!ft;(O.value!==void 0&&O.value===Jt||vt)&&(K(Nt),vt&&(xe.current=!0))},[O.value]),Ge=D.useCallback(()=>R==null?void 0:R.focus(),[R]),Pt=D.useCallback((Nt,Jt,ft)=>{const vt=!xe.current&&!ft;(O.value!==void 0&&O.value===Jt||vt)&&pe(Nt)},[O.value]),$t=n==="popper"?$A:l7,nr=$t===$A?{side:i,sideOffset:p,align:y,alignOffset:b,arrowPadding:_,collisionBoundary:E,collisionPadding:C,sticky:k,hideWhenDetached:N,avoidCollisions:I}:{};return c.jsx(a7,{scope:r,content:R,viewport:F,onViewportChange:X,itemRefCallback:Fe,selectedItem:ee,onItemLeave:Ge,itemTextRefCallback:Pt,focusSelectedItem:ke,selectedItemText:ie,position:n,isPositioned:_e,searchRef:Re,children:c.jsx(VM,{as:rge,allowPinchZoom:!0,children:c.jsx(g2,{asChild:!0,trapped:O.open,onMountAutoFocus:Nt=>{Nt.preventDefault()},onUnmountAutoFocus:Ht(o,Nt=>{var Jt;(Jt=O.trigger)==null||Jt.focus({preventScroll:!0}),Nt.preventDefault()}),children:c.jsx(Nb,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:h,onFocusOutside:Nt=>Nt.preventDefault(),onDismiss:()=>O.onOpenChange(!1),children:c.jsx($t,{role:"listbox",id:O.contentId,"data-state":O.open?"open":"closed",dir:O.dir,onContextMenu:Nt=>Nt.preventDefault(),...B,...nr,onPlaced:()=>Ee(!0),ref:G,style:{display:"flex",flexDirection:"column",outline:"none",...B.style},onKeyDown:Ht(B.onKeyDown,Nt=>{const Jt=Nt.ctrlKey||Nt.altKey||Nt.metaKey;if(Nt.key==="Tab"&&Nt.preventDefault(),!Jt&&Nt.key.length===1&&Be(Nt.key),["ArrowUp","ArrowDown","Home","End"].includes(Nt.key)){let vt=ae().filter(lt=>!lt.disabled).map(lt=>lt.ref.current);if(["ArrowUp","End"].includes(Nt.key)&&(vt=vt.slice().reverse()),["ArrowUp","ArrowDown"].includes(Nt.key)){const lt=Nt.target,it=vt.indexOf(lt);vt=vt.slice(it+1)}setTimeout(()=>ce(vt)),Nt.preventDefault()}})})})})})})});s7.displayName=tge;var nge="SelectItemAlignedPosition",l7=D.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...o}=e,s=Td(lf,r),h=jd(lf,r),[i,p]=D.useState(null),[y,b]=D.useState(null),_=Kr(t,G=>b(G)),E=V2(r),C=D.useRef(!1),k=D.useRef(!0),{viewport:N,selectedItem:I,selectedItemText:B,focusSelectedItem:O}=h,R=D.useCallback(()=>{if(s.trigger&&s.valueNode&&i&&y&&N&&I&&B){const G=s.trigger.getBoundingClientRect(),ee=y.getBoundingClientRect(),K=s.valueNode.getBoundingClientRect(),ie=B.getBoundingClientRect();if(s.dir!=="rtl"){const lt=ie.left-ee.left,it=K.left-lt,ar=G.left-it,We=G.width+ar,pt=Math.max(We,ee.width),Wt=window.innerWidth-Os,cr=tz(it,[Os,Math.max(Os,Wt-pt)]);i.style.minWidth=We+"px",i.style.left=cr+"px"}else{const lt=ee.right-ie.right,it=window.innerWidth-K.right-lt,ar=window.innerWidth-G.right-it,We=G.width+ar,pt=Math.max(We,ee.width),Wt=window.innerWidth-Os,cr=tz(it,[Os,Math.max(Os,Wt-pt)]);i.style.minWidth=We+"px",i.style.right=cr+"px"}const pe=E(),ae=window.innerHeight-Os*2,_e=N.scrollHeight,Ee=window.getComputedStyle(y),xe=parseInt(Ee.borderTopWidth,10),ce=parseInt(Ee.paddingTop,10),ke=parseInt(Ee.borderBottomWidth,10),ve=parseInt(Ee.paddingBottom,10),Pe=xe+ce+_e+ve+ke,Re=Math.min(I.offsetHeight*5,Pe),Be=window.getComputedStyle(N),Fe=parseInt(Be.paddingTop,10),Ge=parseInt(Be.paddingBottom,10),Pt=G.top+G.height/2-Os,$t=ae-Pt,nr=I.offsetHeight/2,Nt=I.offsetTop+nr,Jt=xe+ce+Nt,ft=Pe-Jt;if(Jt<=Pt){const lt=pe.length>0&&I===pe[pe.length-1].ref.current;i.style.bottom="0px";const it=y.clientHeight-N.offsetTop-N.offsetHeight,ar=Math.max($t,nr+(lt?Ge:0)+it+ke),We=Jt+ar;i.style.height=We+"px"}else{const lt=pe.length>0&&I===pe[0].ref.current;i.style.top="0px";const ar=Math.max(Pt,xe+N.offsetTop+(lt?Fe:0)+nr)+ft;i.style.height=ar+"px",N.scrollTop=Jt-Pt+N.offsetTop}i.style.margin=`${Os}px 0`,i.style.minHeight=Re+"px",i.style.maxHeight=ae+"px",n==null||n(),requestAnimationFrame(()=>C.current=!0)}},[E,s.trigger,s.valueNode,i,y,N,I,B,s.dir,n]);so(()=>R(),[R]);const[q,F]=D.useState();so(()=>{y&&F(window.getComputedStyle(y).zIndex)},[y]);const X=D.useCallback(G=>{G&&k.current===!0&&(R(),O==null||O(),k.current=!1)},[R,O]);return c.jsx(oge,{scope:r,contentWrapper:i,shouldExpandOnScrollRef:C,onScrollButtonChange:X,children:c.jsx("div",{ref:p,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:q},children:c.jsx(fr.div,{...o,ref:_,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});l7.displayName=nge;var ige="SelectPopperPosition",$A=D.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:o=Os,...s}=e,h=q2(r);return c.jsx(sq,{...h,...s,ref:t,align:n,collisionPadding:o,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});$A.displayName=ige;var[oge,TI]=gg(lf,{}),FA="SelectViewport",c7=D.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...o}=e,s=jd(FA,r),h=TI(FA,r),i=Kr(t,s.onViewportChange),p=D.useRef(0);return c.jsxs(c.Fragment,{children:[c.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),c.jsx(U2.Slot,{scope:r,children:c.jsx(fr.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:Ht(o.onScroll,y=>{const b=y.currentTarget,{contentWrapper:_,shouldExpandOnScrollRef:E}=h;if(E!=null&&E.current&&_){const C=Math.abs(p.current-b.scrollTop);if(C>0){const k=window.innerHeight-Os*2,N=parseFloat(_.style.minHeight),I=parseFloat(_.style.height),B=Math.max(N,I);if(B<k){const O=B+C,R=Math.min(k,O),q=O-R;_.style.height=R+"px",_.style.bottom==="0px"&&(b.scrollTop=q>0?q:0,_.style.justifyContent="flex-end")}}}p.current=b.scrollTop})})})]})});c7.displayName=FA;var u7="SelectGroup",[age,sge]=gg(u7),lge=D.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,o=Cl();return c.jsx(age,{scope:r,id:o,children:c.jsx(fr.div,{role:"group","aria-labelledby":o,...n,ref:t})})});lge.displayName=u7;var d7="SelectLabel",h7=D.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,o=sge(d7,r);return c.jsx(fr.div,{id:o.id,...n,ref:t})});h7.displayName=d7;var z1="SelectItem",[cge,f7]=gg(z1),p7=D.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:o=!1,textValue:s,...h}=e,i=Td(z1,r),p=jd(z1,r),y=i.value===n,[b,_]=D.useState(s??""),[E,C]=D.useState(!1),k=Kr(t,O=>{var R;return(R=p.itemRefCallback)==null?void 0:R.call(p,O,n,o)}),N=Cl(),I=D.useRef("touch"),B=()=>{o||(i.onValueChange(n),i.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return c.jsx(cge,{scope:r,value:n,disabled:o,textId:N,isSelected:y,onItemTextChange:D.useCallback(O=>{_(R=>R||((O==null?void 0:O.textContent)??"").trim())},[]),children:c.jsx(U2.ItemSlot,{scope:r,value:n,disabled:o,textValue:b,children:c.jsx(fr.div,{role:"option","aria-labelledby":N,"data-highlighted":E?"":void 0,"aria-selected":y&&E,"data-state":y?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...h,ref:k,onFocus:Ht(h.onFocus,()=>C(!0)),onBlur:Ht(h.onBlur,()=>C(!1)),onClick:Ht(h.onClick,()=>{I.current!=="mouse"&&B()}),onPointerUp:Ht(h.onPointerUp,()=>{I.current==="mouse"&&B()}),onPointerDown:Ht(h.onPointerDown,O=>{I.current=O.pointerType}),onPointerMove:Ht(h.onPointerMove,O=>{var R;I.current=O.pointerType,o?(R=p.onItemLeave)==null||R.call(p):I.current==="mouse"&&O.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ht(h.onPointerLeave,O=>{var R;O.currentTarget===document.activeElement&&((R=p.onItemLeave)==null||R.call(p))}),onKeyDown:Ht(h.onKeyDown,O=>{var q;((q=p.searchRef)==null?void 0:q.current)!==""&&O.key===" "||(Xme.includes(O.key)&&B(),O.key===" "&&O.preventDefault())})})})})});p7.displayName=z1;var Vv="SelectItemText",m7=D.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:o,...s}=e,h=Td(Vv,r),i=jd(Vv,r),p=f7(Vv,r),y=Jme(Vv,r),[b,_]=D.useState(null),E=Kr(t,B=>_(B),p.onItemTextChange,B=>{var O;return(O=i.itemTextRefCallback)==null?void 0:O.call(i,B,p.value,p.disabled)}),C=b==null?void 0:b.textContent,k=D.useMemo(()=>c.jsx("option",{value:p.value,disabled:p.disabled,children:C},p.value),[p.disabled,p.value,C]),{onNativeOptionAdd:N,onNativeOptionRemove:I}=y;return so(()=>(N(k),()=>I(k)),[N,I,k]),c.jsxs(c.Fragment,{children:[c.jsx(fr.span,{id:p.textId,...s,ref:E}),p.isSelected&&h.valueNode&&!h.valueNodeHasChildren?Uc.createPortal(s.children,h.valueNode):null]})});m7.displayName=Vv;var g7="SelectItemIndicator",y7=D.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return f7(g7,r).isSelected?c.jsx(fr.span,{"aria-hidden":!0,...n,ref:t}):null});y7.displayName=g7;var UA="SelectScrollUpButton",uge=D.forwardRef((e,t)=>{const r=jd(UA,e.__scopeSelect),n=TI(UA,e.__scopeSelect),[o,s]=D.useState(!1),h=Kr(t,n.onScrollButtonChange);return so(()=>{if(r.viewport&&r.isPositioned){let i=function(){const y=p.scrollTop>0;s(y)};const p=r.viewport;return i(),p.addEventListener("scroll",i),()=>p.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),o?c.jsx(v7,{...e,ref:h,onAutoScroll:()=>{const{viewport:i,selectedItem:p}=r;i&&p&&(i.scrollTop=i.scrollTop-p.offsetHeight)}}):null});uge.displayName=UA;var VA="SelectScrollDownButton",dge=D.forwardRef((e,t)=>{const r=jd(VA,e.__scopeSelect),n=TI(VA,e.__scopeSelect),[o,s]=D.useState(!1),h=Kr(t,n.onScrollButtonChange);return so(()=>{if(r.viewport&&r.isPositioned){let i=function(){const y=p.scrollHeight-p.clientHeight,b=Math.ceil(p.scrollTop)<y;s(b)};const p=r.viewport;return i(),p.addEventListener("scroll",i),()=>p.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),o?c.jsx(v7,{...e,ref:h,onAutoScroll:()=>{const{viewport:i,selectedItem:p}=r;i&&p&&(i.scrollTop=i.scrollTop+p.offsetHeight)}}):null});dge.displayName=VA;var v7=D.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...o}=e,s=jd("SelectScrollButton",r),h=D.useRef(null),i=V2(r),p=D.useCallback(()=>{h.current!==null&&(window.clearInterval(h.current),h.current=null)},[]);return D.useEffect(()=>()=>p(),[p]),so(()=>{var b;const y=i().find(_=>_.ref.current===document.activeElement);(b=y==null?void 0:y.ref.current)==null||b.scrollIntoView({block:"nearest"})},[i]),c.jsx(fr.div,{"aria-hidden":!0,...o,ref:t,style:{flexShrink:0,...o.style},onPointerDown:Ht(o.onPointerDown,()=>{h.current===null&&(h.current=window.setInterval(n,50))}),onPointerMove:Ht(o.onPointerMove,()=>{var y;(y=s.onItemLeave)==null||y.call(s),h.current===null&&(h.current=window.setInterval(n,50))}),onPointerLeave:Ht(o.onPointerLeave,()=>{p()})})}),hge="SelectSeparator",x7=D.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return c.jsx(fr.div,{"aria-hidden":!0,...n,ref:t})});x7.displayName=hge;var qA="SelectArrow",fge=D.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,o=q2(r),s=Td(qA,r),h=jd(qA,r);return s.open&&h.position==="popper"?c.jsx(lq,{...o,...n,ref:t}):null});fge.displayName=qA;var pge="SelectBubbleInput",b7=D.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const o=D.useRef(null),s=Kr(n,o),h=EI(t);return D.useEffect(()=>{const i=o.current;if(!i)return;const p=window.HTMLSelectElement.prototype,b=Object.getOwnPropertyDescriptor(p,"value").set;if(h!==t&&b){const _=new Event("change",{bubbles:!0});b.call(i,t),i.dispatchEvent(_)}},[h,t]),c.jsx(fr.select,{...r,style:{...s8,...r.style},ref:s,defaultValue:t})});b7.displayName=pge;function _7(e){return e===""||e===void 0}function w7(e){const t=aa(e),r=D.useRef(""),n=D.useRef(0),o=D.useCallback(h=>{const i=r.current+h;t(i),function p(y){r.current=y,window.clearTimeout(n.current),y!==""&&(n.current=window.setTimeout(()=>p(""),1e3))}(i)},[t]),s=D.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return D.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,o,s]}function S7(e,t,r){const o=t.length>1&&Array.from(t).every(y=>y===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let h=mge(e,Math.max(s,0));o.length===1&&(h=h.filter(y=>y!==r));const p=h.find(y=>y.textValue.toLowerCase().startsWith(o.toLowerCase()));return p!==r?p:void 0}function mge(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var gge=JG,E7=e7,yge=r7,vge=n7,xge=i7,T7=o7,bge=c7,j7=h7,C7=p7,_ge=m7,wge=y7,P7=x7;const dc=gge,hc=yge,bl=je.forwardRef(({className:e,children:t,...r},n)=>c.jsxs(E7,{ref:n,className:Cr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:[t,c.jsx(vge,{asChild:!0,children:c.jsx(C8,{className:"h-4 w-4 opacity-50"})})]}));bl.displayName=E7.displayName;const _l=je.forwardRef(({className:e,children:t,position:r="popper",...n},o)=>c.jsx(xge,{children:c.jsx(T7,{ref:o,className:Cr("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:c.jsx(bge,{className:Cr("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));_l.displayName=T7.displayName;const Sge=je.forwardRef(({className:e,...t},r)=>c.jsx(j7,{ref:r,className:Cr("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Sge.displayName=j7.displayName;const qn=je.forwardRef(({className:e,children:t,...r},n)=>c.jsxs(C7,{ref:n,className:Cr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(wge,{children:c.jsx(v1,{className:"h-4 w-4"})})}),c.jsx(_ge,{children:t})]}));qn.displayName=C7.displayName;const Ege=je.forwardRef(({className:e,...t},r)=>c.jsx(P7,{ref:r,className:Cr("-mx-1 my-1 h-px bg-muted",e),...t}));Ege.displayName=P7.displayName;const Tge=f2("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function bn({className:e,variant:t,...r}){return c.jsx("div",{className:Cr(Tge({variant:t}),e),...r})}const kt=je.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Cr("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));kt.displayName="Card";const zr=je.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Cr("flex flex-col space-y-1.5 p-6",e),...t}));zr.displayName="CardHeader";const $r=je.forwardRef(({className:e,...t},r)=>c.jsx("h3",{ref:r,className:Cr("text-2xl font-semibold leading-none tracking-tight",e),...t}));$r.displayName="CardTitle";const jge=je.forwardRef(({className:e,...t},r)=>c.jsx("p",{ref:r,className:Cr("text-sm text-muted-foreground",e),...t}));jge.displayName="CardDescription";const rr=je.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Cr("p-6 pt-0",e),...t}));rr.displayName="CardContent";const jI=je.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Cr("flex items-center p-6 pt-0",e),...t}));jI.displayName="CardFooter";const A7=({venue:e})=>c.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},whileHover:{y:-5,boxShadow:"0 10px 20px hsla(var(--primary), 0.1), 0 6px 6px hsla(var(--secondary), 0.05)"},className:"venue-card h-full group",children:c.jsxs(kt,{className:"overflow-hidden h-full flex flex-col bg-white border-brand-burgundy/10 shadow-lg hover:shadow-xl transition-shadow duration-300 rounded-xl",children:[c.jsxs("div",{className:"relative h-56 overflow-hidden",children:[c.jsx("img",{className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",alt:`${e.name} - ${e.type} in ${e.city}`,src:e.images&&e.images.length>0?e.images[0]:"https://images.unsplash.com/photo-1699990320295-ecd2664079ab"}),c.jsxs("div",{className:"absolute top-3 right-3 flex gap-2",children:[e.tags&&e.tags.slice(0,1).map((t,r)=>c.jsx(bn,{variant:"secondary",className:"bg-brand-gold text-brand-burgundy backdrop-blur-sm border-brand-gold/50 shadow-md",children:t},r)),c.jsx(bn,{variant:"default",className:"bg-brand-burgundy text-brand-cream backdrop-blur-sm border-brand-burgundy/50 shadow-md",children:e.price_range||"N/A"})]}),e.isFeatured&&c.jsx("div",{className:"absolute top-3 left-3",children:c.jsx(bn,{className:"bg-brand-gold text-brand-burgundy font-semibold shadow-lg",children:"Featured"})})]}),c.jsxs(zr,{className:"pb-3 pt-4",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsx($r,{className:"text-2xl font-heading text-brand-burgundy group-hover:text-brand-gold transition-colors duration-300",children:e.name}),c.jsxs("div",{className:"flex items-center text-sm shrink-0 ml-2 mt-1",children:[c.jsx(sa,{className:"h-4 w-4 fill-brand-gold text-brand-gold mr-1"}),c.jsx("span",{className:"font-semibold text-brand-burgundy/80",children:e.rating})]})]}),c.jsxs("p",{className:"text-xs text-brand-burgundy/60 flex items-center",children:[c.jsx(oa,{className:"h-3.5 w-3.5 mr-1 text-brand-gold"})," ",e.address]})]}),c.jsxs(rr,{className:"flex-grow pt-0 pb-4",children:[c.jsx("p",{className:"text-sm text-brand-burgundy/70 mb-4 line-clamp-2 font-body",children:e.description}),c.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-2 text-xs text-brand-burgundy/70 font-body",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(N8,{className:"h-3.5 w-3.5 mr-1.5 text-brand-gold"}),c.jsx("span",{children:e.type})]}),e.capacity&&c.jsxs("div",{className:"flex items-center",children:[c.jsx(Bi,{className:"h-3.5 w-3.5 mr-1.5 text-brand-gold"}),c.jsxs("span",{children:["Up to ",e.capacity," guests"]})]})]})]}),c.jsx(jI,{className:"pt-2 pb-4 px-4",children:c.jsx(Et,{asChild:!0,className:"w-full bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90 transition-opacity rounded-md font-body py-3",children:c.jsx(In,{to:`/venues/${e.id}`,children:"View Details & Book"})})})]})});var W2="Tabs",[Cge,KUe]=as(W2,[cg]),k7=cg(),[Pge,CI]=Cge(W2),N7=D.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:o,defaultValue:s,orientation:h="horizontal",dir:i,activationMode:p="automatic",...y}=e,b=Ob(i),[_,E]=Nc({prop:n,onChange:o,defaultProp:s??"",caller:W2});return c.jsx(Pge,{scope:r,baseId:Cl(),value:_,onValueChange:E,orientation:h,dir:b,activationMode:p,children:c.jsx(fr.div,{dir:b,"data-orientation":h,...y,ref:t})})});N7.displayName=W2;var M7="TabsList",I7=D.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...o}=e,s=CI(M7,r),h=k7(r);return c.jsx($M,{asChild:!0,...h,orientation:s.orientation,dir:s.dir,loop:n,children:c.jsx(fr.div,{role:"tablist","aria-orientation":s.orientation,...o,ref:t})})});I7.displayName=M7;var O7="TabsTrigger",D7=D.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:o=!1,...s}=e,h=CI(O7,r),i=k7(r),p=B7(h.baseId,n),y=z7(h.baseId,n),b=n===h.value;return c.jsx(FM,{asChild:!0,...i,focusable:!o,active:b,children:c.jsx(fr.button,{type:"button",role:"tab","aria-selected":b,"aria-controls":y,"data-state":b?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:p,...s,ref:t,onMouseDown:Ht(e.onMouseDown,_=>{!o&&_.button===0&&_.ctrlKey===!1?h.onValueChange(n):_.preventDefault()}),onKeyDown:Ht(e.onKeyDown,_=>{[" ","Enter"].includes(_.key)&&h.onValueChange(n)}),onFocus:Ht(e.onFocus,()=>{const _=h.activationMode!=="manual";!b&&!o&&_&&h.onValueChange(n)})})})});D7.displayName=O7;var R7="TabsContent",L7=D.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:o,children:s,...h}=e,i=CI(R7,r),p=B7(i.baseId,n),y=z7(i.baseId,n),b=n===i.value,_=D.useRef(b);return D.useEffect(()=>{const E=requestAnimationFrame(()=>_.current=!1);return()=>cancelAnimationFrame(E)},[]),c.jsx(Ol,{present:o||b,children:({present:E})=>c.jsx(fr.div,{"data-state":b?"active":"inactive","data-orientation":i.orientation,role:"tabpanel","aria-labelledby":p,hidden:!E,id:y,tabIndex:0,...h,ref:t,style:{...e.style,animationDuration:_.current?"0s":void 0},children:E&&s})})});L7.displayName=R7;function B7(e,t){return`${e}-trigger-${t}`}function z7(e,t){return`${e}-content-${t}`}var Age=N7,$7=I7,F7=D7,U7=L7;const Cd=Age,Wc=je.forwardRef(({className:e,...t},r)=>c.jsx($7,{ref:r,className:Cr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Wc.displayName=$7.displayName;const vn=je.forwardRef(({className:e,...t},r)=>c.jsx(F7,{ref:r,className:Cr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));vn.displayName=F7.displayName;const xn=je.forwardRef(({className:e,...t},r)=>c.jsx(U7,{ref:r,className:Cr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));xn.displayName=U7.displayName;const kge=({clubId:e,tickets:t,onSelectTicket:r})=>{const{toast:n}=Co(),[o,s]=D.useState(null),h=i=>{s(i),r(i),n({title:"Ticket selected!",description:`${i.name} ticket has been added to your selection.`})};return c.jsxs("div",{className:"bg-secondary/20 border border-border/50 rounded-lg p-6",children:[c.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center",children:[c.jsx(zie,{className:"mr-2 h-5 w-5"}),"VIP Tickets"]}),c.jsx("div",{className:"space-y-4",children:t.map(i=>c.jsxs(nt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},whileHover:{y:-2},className:`p-4 rounded-lg border cursor-pointer transition-all ${(o==null?void 0:o.id)===i.id?"border-primary bg-primary/20 neon-border":"border-border/50 hover:border-primary/50"}`,onClick:()=>h(i),children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-bold text-lg",children:i.name}),c.jsx("p",{className:"text-sm text-muted-foreground",children:i.description})]}),c.jsxs("div",{className:"text-xl font-bold",children:["$",i.price]})]}),c.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:i.features.map((p,y)=>c.jsxs(bn,{variant:"secondary",className:"flex items-center gap-1",children:[c.jsx(sa,{className:"h-3 w-3"}),p]},y))}),c.jsxs("div",{className:"flex flex-wrap gap-4 mt-4 text-sm text-muted-foreground",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(wd,{className:"h-4 w-4 mr-1"}),i.entryTime]}),i.maxGuests&&c.jsxs("div",{className:"flex items-center",children:[c.jsx(Bi,{className:"h-4 w-4 mr-1"}),"Up to ",i.maxGuests," guests"]})]}),c.jsx(Et,{className:`mt-4 w-full ${(o==null?void 0:o.id)===i.id?"bg-gradient-to-r from-primary to-accent text-accent-foreground":"bg-secondary hover:bg-secondary/80 text-secondary-foreground"}`,variant:(o==null?void 0:o.id)===i.id?"default":"secondary",onClick:p=>{p.stopPropagation(),h(i)},children:(o==null?void 0:o.id)===i.id?"Selected":"Select Ticket"})]},i.id))})]})},Nge=({clubId:e,tables:t,onReserve:r,selectedTableId:n})=>{const{toast:o}=Co(),[s,h]=D.useState(null),[i,p]=D.useState(4),[y,b]=D.useState(""),[_,E]=D.useState(""),C=N=>{h(N)},k=()=>{if(!s||!y||!_||!i){o({title:"Missing information",description:"Please fill in all fields and select a table.",variant:"destructive"});return}r({id:s.id,name:s.table_number,table_number:s.table_number,table_type:s.table_type,price:s.price,date:y,time:_,guestCount:i}),o({title:"Table selected!",description:`Table ${s.table_number} has been added to your selection.`})};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"date",className:"text-brand-burgundy mb-2 block",children:"Date"}),c.jsxs("div",{className:"relative",children:[c.jsx(Xt,{id:"date",type:"date",value:y,onChange:N=>b(N.target.value),className:"pl-10 bg-brand-cream/50 border-brand-burgundy/30 focus:border-brand-burgundy",min:new Date().toISOString().split("T")[0]}),c.jsx(Lo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-brand-burgundy/50"})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"time",className:"text-brand-burgundy mb-2 block",children:"Time"}),c.jsxs("div",{className:"relative",children:[c.jsx(Xt,{id:"time",type:"time",value:_,onChange:N=>E(N.target.value),className:"pl-10 bg-brand-cream/50 border-brand-burgundy/30 focus:border-brand-burgundy"}),c.jsx(wd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-brand-burgundy/50"})]})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"guests",className:"text-brand-burgundy mb-2 block",children:"Number of Guests"}),c.jsxs("div",{className:"relative",children:[c.jsx(Xt,{id:"guests",type:"number",min:"1",max:"30",value:i,onChange:N=>p(parseInt(N.target.value)),className:"pl-10 bg-brand-cream/50 border-brand-burgundy/30 focus:border-brand-burgundy"}),c.jsx(Bi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-brand-burgundy/50"})]})]}),c.jsxs("div",{children:[c.jsx(qt,{className:"text-brand-burgundy mb-3 block",children:"Select a Table"}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:t.map(N=>c.jsxs(nt.div,{whileHover:{scale:1.03},whileTap:{scale:.98},onClick:()=>C(N),className:`table-item cursor-pointer p-4 rounded-lg border transition-colors ${(s==null?void 0:s.id)===N.id?"border-brand-burgundy bg-brand-cream text-brand-burgundy":"border-brand-burgundy/30 bg-brand-cream/50 text-brand-burgundy/70 hover:border-brand-burgundy/50"}`,children:[c.jsxs("h4",{className:"font-medium text-sm",children:["Table ",N.table_number]}),c.jsx("p",{className:"text-xs text-brand-burgundy/70 mb-1",children:N.table_type}),c.jsxs("p",{className:"text-xs text-brand-burgundy/70 mb-2",children:["Fits ",N.capacity," people"]}),c.jsxs("p",{className:"text-sm font-bold",children:["",N.price.toLocaleString()]})]},N.id))})]}),c.jsx(Et,{onClick:k,disabled:!s||!y||!_,className:`w-full ${s?"bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90":"bg-brand-cream/50 text-brand-burgundy/50 cursor-not-allowed"}`,children:s?`Reserve Table ${s.table_number} - ${s.price.toLocaleString()}`:"Select a Table"})]})},V7=()=>{const{id:e}=l2(),t=zi(),{toast:r}=Co(),[n,o]=D.useState(null),[s,h]=D.useState(!0),[i,p]=D.useState(null),[y,b]=D.useState(null),[_,E]=D.useState(!1);D.useEffect(()=>{(async()=>{h(!0);try{const{data:q,error:F}=await Ve.from("venues").select("*").eq("id",e).single();if(F)throw F;const{data:X,error:G}=await Ve.from("venue_tables").select("*").eq("venue_id",e);G&&console.error("Error fetching tables:",G);const{data:ee,error:K}=await Ve.from("venue_images").select("*").eq("venue_id",e).order("is_primary",{ascending:!1});K&&console.error("Error fetching images:",K);let ie=[];if(ee&&ee.length>0){const _e=ee.find(xe=>xe.is_primary),Ee=ee.filter(xe=>!xe.is_primary);_e?ie=[_e.image_url,...Ee.map(xe=>xe.image_url)]:ie=ee.map(xe=>xe.image_url)}const pe={...q,tables:X||[],images:ie,tickets:[]};o(pe);const ae=JSON.parse(localStorage.getItem("lagosvibe_favorites")||"[]");E(ae.includes(e))}catch(q){console.error("Error fetching venue:",q),r({title:"Error",description:"Failed to load venue details. Please try again.",variant:"destructive"})}finally{h(!1)}})()},[e,r]);const C=R=>{p(R),b(null)},k=R=>{b(R),p(null)},N=()=>{if(console.log("handleProceedToBooking called"),console.log("selectedTicket:",i),console.log("selectedTable:",y),!i&&!y){r({title:"Selection Required",description:"Please select a ticket or reserve a table to proceed.",variant:"destructive",className:"bg-red-500 text-white"});return}const R={venueId:n.id,venueName:n.name,venueImage:n.images&&n.images.length>0?n.images[0]:null,ticket:i,table:y,timestamp:new Date().toISOString()};console.log("Saving booking selection:",R),localStorage.setItem("lagosvibe_booking_selection",JSON.stringify(R));const q=`/checkout/${n.id}`;console.log("Navigating to:",q),t(q)},I=()=>{let R=JSON.parse(localStorage.getItem("lagosvibe_favorites")||"[]");_?(R=R.filter(q=>q!==e),r({title:`${n.name} removed from favorites.`,className:"bg-brand-burgundy text-brand-cream"})):(R.push(e),r({title:`${n.name} added to favorites!`,className:"bg-brand-gold text-brand-burgundy"})),localStorage.setItem("lagosvibe_favorites",JSON.stringify(R)),E(!_)},B=()=>{navigator.share?navigator.share({title:n.name,text:`Check out ${n.name} on LagosVibe!`,url:window.location.href}).then(()=>r({title:"Venue shared!",className:"bg-brand-gold text-brand-burgundy"})).catch(R=>console.log("Error sharing",R)):(navigator.clipboard.writeText(window.location.href),r({title:"Link copied to clipboard!",className:"bg-brand-gold text-brand-burgundy"}))};if(s)return c.jsxs("div",{className:"container py-20 text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold mx-auto"}),c.jsx("p",{className:"mt-4 text-brand-burgundy/70 font-body",children:"Loading Venue Details..."})]});if(!n)return c.jsxs("div",{className:"container py-20 text-center",children:[c.jsx("h2",{className:"text-4xl font-heading mb-4 text-brand-burgundy",children:"Venue Not Found"}),c.jsx("p",{className:"text-lg text-brand-burgundy/70 font-body mb-8",children:"The venue you're looking for doesn't exist or has been removed."}),c.jsx(In,{to:"/venues",children:c.jsx(Et,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Back to Venues"})})]});const O=((i==null?void 0:i.price)||0)+((y==null?void 0:y.price)||0);return c.jsxs("div",{className:"bg-brand-cream",children:[c.jsxs(nt.section,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.7},className:"relative h-[50vh] md:h-[60vh] overflow-hidden",children:[c.jsx("img",{className:"w-full h-full object-cover",alt:`Interior or exterior of ${n.name}`,src:n.images&&n.images.length>0?n.images[0]:"https://images.unsplash.com/photo-1632111162953-c58fa2fa1080",onError:R=>{R.target.src="https://images.unsplash.com/photo-1632111162953-c58fa2fa1080"}}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-brand-burgundy/70 via-brand-burgundy/30 to-transparent"}),c.jsxs("div",{className:"absolute bottom-0 left-0 p-6 md:p-12 container",children:[c.jsx(nt.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},className:"text-4xl md:text-6xl font-heading text-white mb-2",children:n.name}),c.jsxs(nt.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},className:"flex items-center space-x-4",children:[c.jsxs("div",{className:"flex items-center text-brand-gold",children:[c.jsx(sa,{className:"h-5 w-5 fill-current mr-1"}),c.jsx("span",{className:"text-white font-semibold text-lg",children:n.rating})]}),c.jsxs("span",{className:"text-white/80 text-sm font-body",children:[" ",n.type," in ",n.city]})]})]}),c.jsxs(In,{to:"/venues",className:"absolute top-6 left-6 md:top-8 md:left-8 inline-flex items-center text-sm text-white bg-black/30 hover:bg-black/50 px-3 py-2 rounded-full backdrop-blur-sm transition-colors",children:[c.jsx(TM,{className:"mr-2 h-4 w-4"}),"Back to Venues"]})]}),c.jsx("div",{className:"container py-10 md:py-16",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 lg:gap-12",children:[c.jsxs("div",{className:"lg:col-span-2",children:[c.jsxs(kt,{className:"bg-white p-6 md:p-8 rounded-xl shadow-lg border-brand-burgundy/10 mb-8",children:[c.jsxs("div",{className:"flex justify-between items-start mb-6",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-3xl font-heading text-brand-burgundy mb-1",children:["About ",n.name]}),c.jsx("p",{className:"text-brand-burgundy/70 font-body",children:n.description})]}),c.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[c.jsx(Et,{variant:"outline",size:"icon",onClick:I,className:`border-brand-gold hover:bg-brand-gold/10 ${_?"bg-brand-gold/20 text-brand-gold":"text-brand-gold"}`,children:c.jsx(Rx,{className:`h-5 w-5 ${_?"fill-current":""}`})}),c.jsx(Et,{variant:"outline",size:"icon",onClick:B,className:"text-brand-gold border-brand-gold hover:bg-brand-gold/10",children:c.jsx(Rie,{className:"h-5 w-5"})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm font-body text-brand-burgundy/80",children:[c.jsxs("div",{className:"flex items-start",children:[c.jsx(oa,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),c.jsx("span",{children:n.address})]}),c.jsx("div",{className:"flex items-start",children:c.jsxs("span",{children:["Price Range: ",n.price_range]})}),c.jsxs("div",{className:"flex items-start",children:[c.jsx(xie,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),c.jsx("span",{children:n.operatingDays||"Open Daily"})]}),c.jsxs("div",{className:"flex items-start",children:[c.jsx(wd,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),c.jsx("span",{children:n.openingHours})]}),n.phone&&c.jsxs("div",{className:"flex items-start",children:[c.jsx(of,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),c.jsx("a",{href:`tel:${n.phone}`,className:"hover:text-brand-gold",children:n.phone})]}),c.jsxs("div",{className:"flex items-start",children:[c.jsx(Bi,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),c.jsxs("span",{children:["Capacity: ",n.capacity," guests"]})]}),n.dressCode&&c.jsxs("div",{className:"flex items-start",children:[c.jsx(Dx,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"})," ",c.jsxs("span",{children:["Dress Code: ",n.dressCode]})]}),n.ambiance&&c.jsxs("div",{className:"md:col-span-2 flex items-start",children:[c.jsx(Dx,{className:"h-5 w-5 mr-3 mt-0.5 text-brand-gold shrink-0"}),c.jsxs("span",{children:["Ambiance: ",n.ambiance]})]})]}),n.cuisine&&n.cuisine.length>0&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("h3",{className:"font-heading text-xl text-brand-burgundy mb-2 flex items-center",children:[c.jsx(m2,{className:"h-5 w-5 mr-2 text-brand-gold"}),"Cuisine"]}),c.jsx("div",{className:"flex flex-wrap gap-2",children:n.cuisine.map(R=>c.jsx(bn,{variant:"secondary",className:"bg-brand-gold/20 text-brand-burgundy border-brand-gold/30",children:R},R))})]}),n.music&&n.music.length>0&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("h3",{className:"font-heading text-xl text-brand-burgundy mb-2 flex items-center",children:[c.jsx(P8,{className:"h-5 w-5 mr-2 text-brand-gold"}),"Music"]}),c.jsx("div",{className:"flex flex-wrap gap-2",children:n.music.map(R=>c.jsx(bn,{variant:"secondary",className:"bg-brand-gold/20 text-brand-burgundy border-brand-gold/30",children:R},R))})]})]}),n.images&&n.images.length>0&&c.jsxs(kt,{className:"bg-white p-6 md:p-8 rounded-xl shadow-lg border-brand-burgundy/10 mb-8",children:[c.jsx("h2",{className:"text-3xl font-heading text-brand-burgundy mb-6",children:"Gallery"}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:n.images.map((R,q)=>c.jsx(nt.div,{className:"aspect-square rounded-lg overflow-hidden shadow-md cursor-pointer hover:shadow-lg transition-shadow",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:c.jsx("img",{className:"w-full h-full object-cover",alt:`${n.name} gallery image ${q+1}`,src:R,onError:F=>{F.target.src="https://images.unsplash.com/photo-1688046671828-c26b7fd54596"}})},q))}),n.images.length>6&&c.jsxs("p",{className:"text-center text-brand-burgundy/60 text-sm mt-4",children:["+ ",n.images.length-6," more photos"]})]}),c.jsxs(kt,{className:"bg-white p-6 md:p-8 rounded-xl shadow-lg border-brand-burgundy/10",children:[c.jsx("h2",{className:"text-3xl font-heading text-brand-burgundy mb-6",children:"Make a Reservation"}),c.jsxs(Cd,{defaultValue:n.tickets&&n.tickets.length>0?"tickets":"tables",className:"font-body",children:[c.jsxs(Wc,{className:"mb-6 bg-brand-cream/60 p-1 rounded-lg",children:[n.tickets&&n.tickets.length>0&&c.jsx(vn,{value:"tickets",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy data-[state=active]:shadow-md px-6 py-2.5 rounded-md text-brand-burgundy/80",children:"VIP Tickets"}),n.tables&&n.tables.length>0&&c.jsx(vn,{value:"tables",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy data-[state=active]:shadow-md px-6 py-2.5 rounded-md text-brand-burgundy/80",children:"Table Reservations"})]}),n.tickets&&n.tickets.length>0&&c.jsx(xn,{value:"tickets",children:c.jsx(kge,{clubId:n.id,tickets:n.tickets,onSelectTicket:C,selectedTicketId:i==null?void 0:i.id})}),n.tables&&n.tables.length>0&&c.jsx(xn,{value:"tables",children:c.jsx(Nge,{clubId:n.id,tables:n.tables,onReserve:k,selectedTableId:y==null?void 0:y.id})})]})]})]}),c.jsx("div",{className:"lg:sticky lg:top-24 h-fit",children:c.jsxs(kt,{className:"bg-white p-6 rounded-xl shadow-xl border-brand-burgundy/10",children:[c.jsx(zr,{className:"p-0 mb-4",children:c.jsx($r,{className:"text-2xl font-heading text-brand-burgundy",children:"Your Selection"})}),c.jsxs(rr,{className:"p-0 font-body",children:[!i&&!y&&c.jsx("p",{className:"text-brand-burgundy/70 text-sm",children:"Select a ticket or table to get started."}),i&&c.jsxs("div",{className:"mb-4 pb-4 border-b border-brand-burgundy/10",children:[c.jsx("h4",{className:"font-semibold text-brand-burgundy",children:i.name}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Price: ",i.price.toLocaleString()]})]}),y&&c.jsxs("div",{className:"mb-4 pb-4 border-b border-brand-burgundy/10",children:[c.jsxs("h4",{className:"font-semibold text-brand-burgundy",children:["Table ",y.table_number]}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:y.table_type}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Date: ",y.date||"Not set"," | Time: ",y.time||"Not set"]}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Guests: ",y.guestCount||"Not set"]}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Price: ",y.price.toLocaleString()]})]}),O>0&&c.jsxs("div",{className:"text-xl font-heading text-brand-burgundy mb-6",children:["Total: ",c.jsxs("span",{className:"text-brand-gold",children:["",O.toLocaleString()]})]}),c.jsx(Et,{onClick:N,disabled:!i&&!y,className:"w-full bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90 py-3 text-base rounded-md",children:"Proceed to Booking"})]})]})})]})})]})},Mge=["all","Lagos Island","Victoria Island","Lekki","Ikeja","Surulere"],Ige=["all","Restaurant","Club","Lounge"],Oge=[{value:"4.5",label:"4.5+ Stars"},{value:"4.0",label:"4.0+ Stars"},{value:"3.5",label:"3.5+ Stars"},{value:"3.0",label:"3.0+ Stars"}],Dge=["all","Nigerian","International","Fusion","Mediterranean","Asian","European","African","American"],Rge=["all","Afrobeats","Hip Hop","R&B","House","Amapiano","Reggae","Pop","Jazz","Live Band","DJ Sets"],Lge=()=>{const{id:e}=l2(),[t]=Y6(),r=t.get("type"),n=B=>B&&{restaurant:"Restaurant",club:"Club",lounge:"Lounge"}[B]||"all";if(e)return c.jsx(V7,{});const[o,s]=D.useState(""),[h,i]=D.useState([]),[p,y]=D.useState([]),[b,_]=D.useState(!0),[E,C]=D.useState({location:"all",venueType:n(r),rating:"all",cuisineType:"all",musicGenre:"all"});D.useEffect(()=>{C(B=>({...B,venueType:n(r)}))},[r]),D.useEffect(()=>{let B=p;o&&(B=B.filter(O=>O.name&&O.name.toLowerCase().includes(o.toLowerCase())||O.description&&O.description.toLowerCase().includes(o.toLowerCase())||O.ambiance&&O.ambiance.toLowerCase().includes(o.toLowerCase())||O.cuisine&&Array.isArray(O.cuisine)&&O.cuisine.some(R=>R.toLowerCase().includes(o.toLowerCase()))||O.music&&Array.isArray(O.music)&&O.music.some(R=>R.toLowerCase().includes(o.toLowerCase())))),E.location!=="all"&&(B=B.filter(O=>O.location===E.location)),E.venueType!=="all"&&(B=B.filter(O=>O.type===E.venueType.toLowerCase())),E.rating!=="all"&&(B=B.filter(O=>O.rating>=parseFloat(E.rating))),E.cuisineType!=="all"&&(B=B.filter(O=>O.cuisine&&O.cuisine.includes(E.cuisineType))),E.musicGenre!=="all"&&(B=B.filter(O=>Array.isArray(O.musicGenres)&&O.musicGenres.includes(E.musicGenre))),i(B)},[p,o,E]),D.useEffect(()=>{(async()=>{try{const{data:O,error:R}=await Ve.from("venues").select("*").eq("status","approved").eq("is_active",!0).order("created_at",{ascending:!1});if(R)throw R;const{data:q,error:F}=await Ve.from("venue_images").select("*").order("is_primary",{ascending:!1});F&&console.error("Error fetching images:",F);const X=O.map(G=>{const ee=q?q.filter(K=>K.venue_id===G.id).map(K=>K.image_url):[];return{...G,images:ee}});y(X)}catch(O){console.error("Error fetching venues:",O),Mr({title:"Error",description:"Failed to load venues. Please try again.",variant:"destructive"})}finally{_(!1)}})()},[]);const k=(B,O)=>{C(R=>({...R,[B]:O}))},N=()=>{s(""),C({location:"all",venueType:"all",rating:"all",cuisineType:"all",musicGenre:"all"})},I=p.filter(B=>B.rating>=4.7).slice(0,3);return c.jsx("div",{className:"py-12 bg-brand-cream text-brand-burgundy",children:c.jsxs("div",{className:"container",children:[c.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-10 text-center",children:[c.jsx("h1",{className:"text-5xl font-heading mb-4 text-brand-burgundy",children:"Explore Lagos' Premier Venues"}),c.jsx("p",{className:"text-lg text-brand-burgundy/80 font-body max-w-3xl mx-auto",children:"Discover an curated collection of Lagos' most exclusive clubs, sophisticated restaurants, and chic lounges."})]}),I.length>0&&c.jsxs(nt.section,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:"mb-16",children:[c.jsx("h2",{className:"text-3xl font-heading mb-8 text-center text-brand-burgundy",children:"Top Picks for Tonight"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:I.map(B=>c.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},whileHover:{y:-5,boxShadow:"0 10px 20px rgba(0,0,0,0.05)"},children:c.jsxs(kt,{className:"overflow-hidden h-full flex flex-col bg-white border-brand-burgundy/10 shadow-lg hover:shadow-xl transition-shadow duration-300 rounded-lg",children:[c.jsxs("div",{className:"relative h-56 overflow-hidden",children:[c.jsx("img",{className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",alt:`${B.name} venue image`,src:B.images&&B.images.length>0?B.images[0]:"https://images.unsplash.com/photo-1699990320295-ecd2664079ab"}),c.jsx("div",{className:"absolute top-3 right-3",children:c.jsx("span",{className:"bg-brand-gold text-brand-burgundy px-3 py-1 text-xs font-semibold rounded-full shadow",children:"Top Pick"})})]}),c.jsx(zr,{className:"pb-3",children:c.jsx($r,{className:"text-2xl font-heading text-brand-burgundy",children:B.name})}),c.jsxs(rr,{className:"flex-grow pt-0",children:[c.jsx("p",{className:"text-sm text-brand-burgundy/70 mb-3 line-clamp-2",children:B.description}),c.jsxs("div",{className:"flex items-center text-sm text-brand-gold",children:[c.jsx(sa,{className:"h-4 w-4 fill-current mr-1"})," ",B.rating]})]}),c.jsx(jI,{className:"pt-2",children:c.jsx(Et,{asChild:!0,className:"w-full bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90 transition-opacity rounded-md",children:c.jsx(In,{to:`/venues/${B.id}`,children:"View Details & Book"})})})]})},B.id))})]}),c.jsxs("div",{className:"mb-10 p-6 md:p-8 bg-white border border-brand-burgundy/10 rounded-xl shadow-lg",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-x-6 gap-y-4 items-end",children:[c.jsxs("div",{className:"relative sm:col-span-2 lg:col-span-1 xl:col-span-2",children:[c.jsx(qt,{htmlFor:"search",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80",children:"Search Venues"}),c.jsxs("div",{className:"relative",children:[c.jsx(Xt,{id:"search",type:"text",placeholder:"Name, vibe, e.g., 'Rooftop Bar'",value:o,onChange:B=>s(B.target.value),className:"pl-10 h-12 bg-brand-cream/50 border-brand-burgundy/30 focus:border-brand-gold focus:ring-brand-gold text-brand-burgundy placeholder:text-brand-burgundy/60 rounded-md"}),c.jsx(Tm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-brand-burgundy/60"})]})]}),c.jsxs("div",{children:[c.jsxs(qt,{htmlFor:"location-filter",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80 flex items-center",children:[c.jsx(oa,{className:"h-4 w-4 mr-1 text-brand-gold"}),"Location"]}),c.jsxs(dc,{value:E.location,onValueChange:B=>k("location",B),children:[c.jsx(bl,{id:"location-filter",className:"h-12 bg-brand-cream/50 border-brand-burgundy/30 text-brand-burgundy rounded-md",children:c.jsx(hc,{placeholder:"All Lagos"})}),c.jsxs(_l,{children:[c.jsx(qn,{value:"all",children:"All Lagos"}),Mge.map(B=>c.jsx(qn,{value:B,children:B},B))]})]})]}),c.jsxs("div",{children:[c.jsxs(qt,{htmlFor:"type-filter",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80 flex items-center",children:[c.jsx(N8,{className:"h-4 w-4 mr-1 text-brand-gold"}),"Venue Type"]}),c.jsxs(dc,{value:E.venueType,onValueChange:B=>k("venueType",B),children:[c.jsx(bl,{id:"type-filter",className:"h-12 bg-brand-cream/50 border-brand-burgundy/30 text-brand-burgundy rounded-md",children:c.jsx(hc,{placeholder:"Any Type"})}),c.jsxs(_l,{children:[c.jsx(qn,{value:"all",children:"Any Type"}),Ige.map(B=>c.jsx(qn,{value:B,children:B},B))]})]})]}),c.jsxs("div",{children:[c.jsxs(qt,{htmlFor:"rating-filter",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80 flex items-center",children:[c.jsx(sa,{className:"h-4 w-4 mr-1 text-brand-gold"}),"Min. Rating"]}),c.jsxs(dc,{value:E.rating,onValueChange:B=>k("rating",B),children:[c.jsx(bl,{id:"rating-filter",className:"h-12 bg-brand-cream/50 border-brand-burgundy/30 text-brand-burgundy rounded-md",children:c.jsx(hc,{placeholder:"Any Rating"})}),c.jsxs(_l,{children:[c.jsx(qn,{value:"all",children:"Any Rating"}),Oge.map(B=>c.jsx(qn,{value:B.value,children:B.label},B.value))]})]})]}),E.venueType==="Restaurant"&&c.jsxs("div",{children:[c.jsxs(qt,{htmlFor:"cuisine-filter",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80 flex items-center",children:[c.jsx(m2,{className:"h-4 w-4 mr-1 text-brand-gold"}),"Cuisine Type"]}),c.jsxs(dc,{value:E.cuisineType,onValueChange:B=>k("cuisineType",B),children:[c.jsx(bl,{id:"cuisine-filter",className:"h-12 bg-brand-cream/50 border-brand-burgundy/30 text-brand-burgundy rounded-md",children:c.jsx(hc,{placeholder:"Any Cuisine"})}),c.jsxs(_l,{children:[c.jsx(qn,{value:"all",children:"Any Cuisine"}),Dge.map(B=>c.jsx(qn,{value:B,children:B},B))]})]})]}),(E.venueType==="Club"||E.venueType==="Lounge")&&c.jsxs("div",{children:[c.jsxs(qt,{htmlFor:"music-filter",className:"text-sm font-body font-medium mb-1 block text-brand-burgundy/80 flex items-center",children:[c.jsx(P8,{className:"h-4 w-4 mr-1 text-brand-gold"}),"Music Genre"]}),c.jsxs(dc,{value:E.musicGenre,onValueChange:B=>k("musicGenre",B),children:[c.jsx(bl,{id:"music-filter",className:"h-12 bg-brand-cream/50 border-brand-burgundy/30 text-brand-burgundy rounded-md",children:c.jsx(hc,{placeholder:"Any Genre"})}),c.jsxs(_l,{children:[c.jsx(qn,{value:"all",children:"Any Genre"}),Rge.map(B=>c.jsx(qn,{value:B,children:B},B))]})]})]})]}),c.jsxs(Et,{onClick:N,variant:"ghost",className:"mt-6 text-sm text-brand-burgundy/70 hover:text-brand-gold",children:[c.jsx(jie,{className:"h-4 w-4 mr-1"})," Reset All Filters"]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:h.length>0?h.map((B,O)=>c.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:O*.05,ease:"easeOut"},children:c.jsx(A7,{venue:B})},B.id)):c.jsxs("div",{className:"col-span-full text-center py-16",children:[c.jsx(Bi,{className:"h-16 w-16 mx-auto text-brand-burgundy/30 mb-6"}),c.jsx("h3",{className:"text-2xl font-heading mb-3 text-brand-burgundy",children:"No Venues Match Your Criteria"}),c.jsx("p",{className:"text-brand-burgundy/70 font-body mb-6 max-w-md mx-auto",children:"Please try adjusting your search terms or filters. Lagos has many hidden gems waiting to be discovered!"}),c.jsx(Et,{variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",onClick:N,children:"Clear Filters & Search Again"})]})})]})})};var G2="Dialog",[q7,YUe]=as(G2),[Bge,tl]=q7(G2),W7=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:o,onOpenChange:s,modal:h=!0}=e,i=D.useRef(null),p=D.useRef(null),[y,b]=Nc({prop:n,defaultProp:o??!1,onChange:s,caller:G2});return c.jsx(Bge,{scope:t,triggerRef:i,contentRef:p,contentId:Cl(),titleId:Cl(),descriptionId:Cl(),open:y,onOpenChange:b,onOpenToggle:D.useCallback(()=>b(_=>!_),[b]),modal:h,children:r})};W7.displayName=G2;var G7="DialogTrigger",H7=D.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=tl(G7,r),s=Kr(t,o.triggerRef);return c.jsx(fr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":kI(o.open),...n,ref:s,onClick:Ht(e.onClick,o.onOpenToggle)})});H7.displayName=G7;var PI="DialogPortal",[zge,X7]=q7(PI,{forceMount:void 0}),Z7=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:o}=e,s=tl(PI,t);return c.jsx(zge,{scope:t,forceMount:r,children:D.Children.map(n,h=>c.jsx(Ol,{present:r||s.open,children:c.jsx(d2,{asChild:!0,container:o,children:h})}))})};Z7.displayName=PI;var $1="DialogOverlay",K7=D.forwardRef((e,t)=>{const r=X7($1,e.__scopeDialog),{forceMount:n=r.forceMount,...o}=e,s=tl($1,e.__scopeDialog);return s.modal?c.jsx(Ol,{present:n||s.open,children:c.jsx(Fge,{...o,ref:t})}):null});K7.displayName=$1;var $ge=tf("DialogOverlay.RemoveScroll"),Fge=D.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=tl($1,r);return c.jsx(VM,{as:$ge,allowPinchZoom:!0,shards:[o.contentRef],children:c.jsx(fr.div,{"data-state":kI(o.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),cf="DialogContent",Y7=D.forwardRef((e,t)=>{const r=X7(cf,e.__scopeDialog),{forceMount:n=r.forceMount,...o}=e,s=tl(cf,e.__scopeDialog);return c.jsx(Ol,{present:n||s.open,children:s.modal?c.jsx(Uge,{...o,ref:t}):c.jsx(Vge,{...o,ref:t})})});Y7.displayName=cf;var Uge=D.forwardRef((e,t)=>{const r=tl(cf,e.__scopeDialog),n=D.useRef(null),o=Kr(t,r.contentRef,n);return D.useEffect(()=>{const s=n.current;if(s)return UM(s)},[]),c.jsx(J7,{...e,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ht(e.onCloseAutoFocus,s=>{var h;s.preventDefault(),(h=r.triggerRef.current)==null||h.focus()}),onPointerDownOutside:Ht(e.onPointerDownOutside,s=>{const h=s.detail.originalEvent,i=h.button===0&&h.ctrlKey===!0;(h.button===2||i)&&s.preventDefault()}),onFocusOutside:Ht(e.onFocusOutside,s=>s.preventDefault())})}),Vge=D.forwardRef((e,t)=>{const r=tl(cf,e.__scopeDialog),n=D.useRef(!1),o=D.useRef(!1);return c.jsx(J7,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var h,i;(h=e.onCloseAutoFocus)==null||h.call(e,s),s.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),s.preventDefault()),n.current=!1,o.current=!1},onInteractOutside:s=>{var p,y;(p=e.onInteractOutside)==null||p.call(e,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const h=s.target;((y=r.triggerRef.current)==null?void 0:y.contains(h))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&o.current&&s.preventDefault()}})}),J7=D.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:s,...h}=e,i=tl(cf,r),p=D.useRef(null),y=Kr(t,p);return AM(),c.jsxs(c.Fragment,{children:[c.jsx(g2,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:o,onUnmountAutoFocus:s,children:c.jsx(Nb,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":kI(i.open),...h,ref:y,onDismiss:()=>i.onOpenChange(!1)})}),c.jsxs(c.Fragment,{children:[c.jsx(qge,{titleId:i.titleId}),c.jsx(Gge,{contentRef:p,descriptionId:i.descriptionId})]})]})}),AI="DialogTitle",Q7=D.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=tl(AI,r);return c.jsx(fr.h2,{id:o.titleId,...n,ref:t})});Q7.displayName=AI;var e9="DialogDescription",t9=D.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=tl(e9,r);return c.jsx(fr.p,{id:o.descriptionId,...n,ref:t})});t9.displayName=e9;var r9="DialogClose",n9=D.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=tl(r9,r);return c.jsx(fr.button,{type:"button",...n,ref:t,onClick:Ht(e.onClick,()=>o.onOpenChange(!1))})});n9.displayName=r9;function kI(e){return e?"open":"closed"}var i9="DialogTitleWarning",[JUe,o9]=Ene(i9,{contentName:cf,titleName:AI,docsSlug:"dialog"}),qge=({titleId:e})=>{const t=o9(i9),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return D.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},Wge="DialogDescriptionWarning",Gge=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${o9(Wge).contentName}}.`;return D.useEffect(()=>{var s;const o=(s=e.current)==null?void 0:s.getAttribute("aria-describedby");t&&o&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},Hge=W7,Xge=H7,Zge=Z7,a9=K7,s9=Y7,l9=Q7,c9=t9,Kge=n9;const gd=Hge,u9=Xge,Yge=Zge,d9=je.forwardRef(({className:e,...t},r)=>c.jsx(a9,{ref:r,className:Cr("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));d9.displayName=a9.displayName;const Dc=je.forwardRef(({className:e,children:t,...r},n)=>c.jsxs(Yge,{children:[c.jsx(d9,{}),c.jsxs(s9,{ref:n,className:Cr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full",e),...r,children:[t,c.jsxs(Kge,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[c.jsx(Ib,{className:"h-4 w-4"}),c.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Dc.displayName=s9.displayName;const Rc=({className:e,...t})=>c.jsx("div",{className:Cr("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Rc.displayName="DialogHeader";const Lc=je.forwardRef(({className:e,...t},r)=>c.jsx(l9,{ref:r,className:Cr("text-lg font-semibold leading-none tracking-tight",e),...t}));Lc.displayName=l9.displayName;const h9=je.forwardRef(({className:e,...t},r)=>c.jsx(c9,{ref:r,className:Cr("text-sm text-muted-foreground",e),...t}));h9.displayName=c9.displayName;const Jge=({formData:e,errors:t,handleInputChange:r,handleSubmit:n,isSubmitting:o,totalAmount:s,isAuthenticated:h=!1})=>c.jsx("form",{onSubmit:n,children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-secondary/20 border border-border/50 rounded-lg p-6",children:[c.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[c.jsx(ji,{className:"mr-2 h-5 w-5"}),h?"Confirm Your Information":"Personal Information"]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"fullName",children:"Full Name"}),c.jsx(Xt,{id:"fullName",name:"fullName",value:e.fullName,onChange:r,className:t.fullName?"border-destructive":""}),t.fullName&&c.jsx("p",{className:"text-destructive text-sm mt-1",children:t.fullName})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"email",children:"Email"}),c.jsx(Xt,{id:"email",name:"email",type:"email",value:e.email,onChange:r,className:t.email?"border-destructive":"",readOnly:h,disabled:h}),t.email&&c.jsx("p",{className:"text-destructive text-sm mt-1",children:t.email}),h&&c.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Email cannot be changed during checkout"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"phone",children:"Phone Number"}),c.jsx(Xt,{id:"phone",name:"phone",value:e.phone,onChange:r,className:t.phone?"border-destructive":""}),t.phone&&c.jsx("p",{className:"text-destructive text-sm mt-1",children:t.phone})]}),!h&&c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"password",children:"Create Password"}),c.jsx(Xt,{id:"password",name:"password",type:"password",value:e.password,onChange:r,className:t.password?"border-destructive":"",placeholder:"Create a password for your account"}),t.password&&c.jsx("p",{className:"text-destructive text-sm mt-1",children:t.password}),c.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"This will create your VIPClub account for future bookings"})]}),h&&c.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-3",children:c.jsx(ji,{className:"h-3 w-3 text-white"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-green-800",children:"Signed in to your VIPClub account"}),c.jsx("p",{className:"text-xs text-green-600",children:"Your booking will be saved to your profile"})]})]})})]})]}),c.jsxs("div",{className:"bg-secondary/20 border border-border/50 rounded-lg p-6",children:[c.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[c.jsx(Pie,{className:"mr-2 h-5 w-5"}),"Referral Code (Optional)"]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"referralCode",children:"Referral Code"}),c.jsx(Xt,{id:"referralCode",name:"referralCode",value:e.referralCode,onChange:r,placeholder:"Enter code for perks"})]})]}),c.jsxs("div",{className:"bg-secondary/20 border border-border/50 rounded-lg p-6",children:[c.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[c.jsx(rf,{className:"mr-2 h-5 w-5"}),"Payment Information"]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"cardNumber",children:"Card Number"}),c.jsx(Xt,{id:"cardNumber",name:"cardNumber",placeholder:"1234 5678 9012 3456",value:e.cardNumber,onChange:r,className:t.cardNumber?"border-destructive":""}),t.cardNumber&&c.jsx("p",{className:"text-destructive text-sm mt-1",children:t.cardNumber})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"expiryDate",children:"Expiry Date"}),c.jsx(Xt,{id:"expiryDate",name:"expiryDate",placeholder:"MM/YY",value:e.expiryDate,onChange:r,className:t.expiryDate?"border-destructive":""}),t.expiryDate&&c.jsx("p",{className:"text-destructive text-sm mt-1",children:t.expiryDate})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"cvv",children:"CVV"}),c.jsx(Xt,{id:"cvv",name:"cvv",placeholder:"123",value:e.cvv,onChange:r,className:t.cvv?"border-destructive":""}),t.cvv&&c.jsx("p",{className:"text-destructive text-sm mt-1",children:t.cvv})]})]})]})]}),c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx("input",{type:"checkbox",id:"agreeToTerms",name:"agreeToTerms",checked:e.agreeToTerms,onChange:r,className:"mt-1"}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"agreeToTerms",className:"text-sm",children:"I agree to the Terms of Service and Privacy Policy"}),t.agreeToTerms&&c.jsx("p",{className:"text-destructive text-sm",children:t.agreeToTerms})]})]}),c.jsx(Et,{type:"submit",className:"w-full bg-gradient-to-r from-primary to-accent hover:opacity-90 transition-opacity text-accent-foreground",disabled:o,children:o?"Processing...":`Pay $${s}`})]})}),Qge=({selection:e,totalAmount:t,vipPerks:r})=>{var n,o;return c.jsxs("div",{className:"bg-secondary/20 border border-border/50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-xl font-bold mb-4",children:"Order Summary"}),c.jsx("div",{className:"mb-4",children:c.jsx("h4",{className:"font-medium text-lg",children:e.clubName})}),c.jsxs("div",{className:"space-y-4 mb-6",children:[e.ticket&&c.jsxs("div",{className:"p-3 bg-background/50 rounded-lg",children:[c.jsxs("div",{className:"flex justify-between items-start mb-1",children:[c.jsx("h4",{className:"font-medium",children:e.ticket.name}),c.jsxs("span",{className:"font-bold",children:["$",e.ticket.price]})]}),c.jsx("p",{className:"text-xs text-muted-foreground",children:e.ticket.description})]}),e.table&&c.jsxs("div",{className:"p-3 bg-background/50 rounded-lg",children:[c.jsxs("div",{className:"flex justify-between items-start mb-1",children:[c.jsxs("h4",{className:"font-medium",children:[e.table.tableName," Table"]}),c.jsxs("span",{className:"font-bold",children:["$",e.table.price]})]}),c.jsxs("div",{className:"flex items-center text-xs text-muted-foreground gap-2 flex-wrap",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Lo,{className:"h-3 w-3 mr-1"}),e.table.date]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(wd,{className:"h-3 w-3 mr-1"}),e.table.time]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(ji,{className:"h-3 w-3 mr-1"}),e.table.guestCount," guests"]})]})]})]}),c.jsxs("div",{className:"border-t border-border pt-4 mb-4",children:[c.jsxs("div",{className:"flex justify-between mb-2",children:[c.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),c.jsxs("span",{children:["$",(((n=e.ticket)==null?void 0:n.price)||0)+(((o=e.table)==null?void 0:o.price)||0)]})]}),c.jsxs("div",{className:"flex justify-between mb-2",children:[c.jsx("span",{className:"text-muted-foreground",children:"Service Fee"}),c.jsx("span",{children:"$25"})]}),r&&r.includes("10% Discount Applied")&&c.jsxs("div",{className:"flex justify-between mb-2 text-green-400",children:[c.jsx("span",{className:"text-muted-foreground",children:"Referral Discount"}),c.jsx("span",{children:"-10%"})]}),c.jsxs("div",{className:"flex justify-between font-bold text-lg mt-4",children:[c.jsx("span",{children:"Total"}),c.jsxs("span",{children:["$",t]})]})]})]})},eye=({totalAmount:e,onSplitCreated:t,user:r,bookingId:n,createBookingIfNeeded:o})=>{const{toast:s}=Co(),[h,i]=D.useState(2),[p,y]=D.useState([]),[b,_]=D.useState([]),[E,C]=D.useState(""),[k,N]=D.useState([]),[I,B]=D.useState(!1),[O,R]=D.useState(!1),[q,F]=D.useState(0),[X,G]=D.useState(!1);D.useEffect(()=>{const xe=Math.ceil(e/h),ce=Array(h-1).fill(xe);ce.reduce((ke,ve)=>ke+ve,0),y(ce),_(Array(h-1).fill(null))},[h,e]);const ee=xe=>{xe<2||i(xe)},K=async xe=>{if(!xe.trim()){N([]);return}B(!0);try{const{data:ce,error:ke}=await Ve.from("user_profiles").select("id, first_name, last_name, phone_number").or(`first_name.ilike.%${xe}%,last_name.ilike.%${xe}%,phone_number.ilike.%${xe}%`).neq("id",r==null?void 0:r.id).limit(10);if(ke)throw ke;const ve=(ce||[]).map(Pe=>({...Pe,displayName:`${Pe.first_name} ${Pe.last_name}`.trim(),type:"profile"}));N(ve)}catch(ce){console.error("Error searching users:",ce),s({title:"Search Error",description:"Failed to search users. Please try again.",variant:"destructive"})}finally{B(!1)}},ie=(xe,ce)=>{const ke=[...b];ke[ce]=xe,_(ke),R(!1),C(""),N([])},pe=xe=>{const ce=[...b];ce[xe]=null,_(ce)},ae=xe=>{F(xe),R(!0)},_e=async()=>{if(!r){s({title:"Authentication Required",description:"Please sign in to create split payment requests.",variant:"destructive"});return}if(b.some(ce=>!ce)){s({title:"Missing Recipients",description:"Please select recipients for all split payments.",variant:"destructive"});return}G(!0);try{let ce=n;if(!ce&&typeof o=="function"&&(ce=await o()),!ce)throw new Error("Booking could not be created.");const ke=b.map((Fe,Ge)=>({booking_id:ce,requester_id:r.id,recipient_id:Fe.id,recipient_phone:Fe.phone_number||null,amount:p[Ge],payment_link:`${window.location.origin}/split-payment/${ce}/${Ge}`,status:"pending"})),{data:ve,error:Pe}=await Ve.from("split_payment_requests").insert(ke).select();if(Pe)throw Pe;const Re=ve.map(Fe=>({user_id:Fe.recipient_id,split_payment_id:Fe.id,type:"payment_request",title:"Payment Request Received",message:`${r.first_name||"Someone"} has requested ${Fe.amount.toLocaleString()} for a shared booking.`})),{error:Be}=await Ve.from("payment_notifications").insert(Re);Be&&console.error("Error creating notifications:",Be),s({title:"Split Payment Requests Created!",description:`Successfully sent ${ve.length} payment requests.`,className:"bg-green-500 text-white"}),t(ve)}catch(ce){console.error("Error creating split payment requests:",ce),s({title:"Error",description:"Failed to create split payment requests. Please try again.",variant:"destructive"})}finally{G(!1)}},Ee=e-p.reduce((xe,ce)=>xe+ce,0);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs(kt,{children:[c.jsx(zr,{children:c.jsx($r,{className:"text-lg",children:"Split Payment Setup"})}),c.jsxs(rr,{children:[c.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[c.jsx(Et,{variant:"outline",size:"icon",onClick:()=>ee(h-1),disabled:h<=2,children:c.jsx(Iie,{className:"h-4 w-4"})}),c.jsxs("div",{className:"flex-1 text-center",children:[c.jsxs(qt,{className:"text-lg",children:["Split between ",h," people"]}),c.jsx("div",{className:"text-sm text-muted-foreground",children:"Including you"})]}),c.jsx(Et,{variant:"outline",size:"icon",onClick:()=>ee(h+1),children:c.jsx(CM,{className:"h-4 w-4"})})]}),c.jsx("div",{className:"bg-brand-cream/30 border border-brand-gold/20 rounded-lg p-4 mb-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-8 h-8 bg-brand-gold rounded-full flex items-center justify-center",children:c.jsx(ji,{className:"h-4 w-4 text-brand-burgundy"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"You"}),c.jsxs("div",{className:"text-sm text-muted-foreground",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"font-bold text-lg",children:["",Ee.toLocaleString()]}),c.jsx("div",{className:"text-sm text-muted-foreground",children:"Your portion"})]})]})})]})]}),c.jsxs(kt,{children:[c.jsx(zr,{children:c.jsx($r,{className:"text-lg",children:"Select Recipients"})}),c.jsx(rr,{children:c.jsx("div",{className:"space-y-4",children:p.map((xe,ce)=>c.jsxs("div",{className:"border rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs(qt,{children:["Person ",ce+2]}),c.jsxs("div",{className:"font-bold",children:["",xe.toLocaleString()]})]}),b[ce]?c.jsxs("div",{className:"flex items-center justify-between bg-green-50 border border-green-200 rounded-lg p-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:c.jsx(ji,{className:"h-4 w-4 text-white"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:b[ce].displayName}),c.jsx("div",{className:"text-sm text-muted-foreground",children:b[ce].phone_number})]})]}),c.jsx(Et,{variant:"ghost",size:"sm",onClick:()=>pe(ce),children:c.jsx(Ib,{className:"h-4 w-4"})})]}):c.jsxs(Et,{variant:"outline",className:"w-full",onClick:()=>ae(ce),children:[c.jsx(Tm,{className:"h-4 w-4 mr-2"}),"Search for recipient"]})]},ce))})})]}),c.jsx(Et,{className:"w-full bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",onClick:_e,disabled:X||b.some(xe=>!xe),children:X?c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-brand-burgundy mr-2"}),"Creating Requests..."]}):c.jsxs(c.Fragment,{children:[c.jsx(ex,{className:"h-4 w-4 mr-2"}),"Send Payment Requests"]})}),c.jsx(gd,{open:O,onOpenChange:R,children:c.jsxs(Dc,{children:[c.jsx(Rc,{children:c.jsx(Lc,{children:"Search for Recipient"})}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx(Tm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),c.jsx(Xt,{placeholder:"Search by name or phone...",value:E,onChange:xe=>{C(xe.target.value),K(xe.target.value)},className:"pl-10"})]}),I&&c.jsxs("div",{className:"text-center py-4",children:[c.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-brand-burgundy mx-auto"}),c.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Searching..."})]}),c.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2",children:k.map(xe=>c.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted cursor-pointer",onClick:()=>ie(xe,q),children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-8 h-8 bg-brand-burgundy/10 rounded-full flex items-center justify-center",children:c.jsx(ji,{className:"h-4 w-4 text-brand-burgundy"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:xe.displayName}),c.jsx("div",{className:"text-sm text-muted-foreground",children:xe.phone_number})]})]}),c.jsx(bn,{variant:"outline",children:"VIP Member"})]},xe.id))}),E&&!I&&k.length===0&&c.jsxs("div",{className:"text-center py-4 text-muted-foreground",children:[c.jsxs("p",{children:['No users found matching "',E,'"']}),c.jsx("p",{className:"text-sm mt-1",children:"Try searching by name or phone number"})]})]})]})})]})},tye=(e,t=!1)=>{const r={};return e.fullName.trim()||(r.fullName="Full name is required"),e.email.trim()?/\S+@\S+\.\S+/.test(e.email)||(r.email="Email is invalid"):r.email="Email is required",e.phone.trim()||(r.phone="Phone number is required"),t||(e.password.trim()?e.password.length<6&&(r.password="Password must be at least 6 characters"):r.password="Password is required"),e.cardNumber.trim()?/^\d{16}$/.test(e.cardNumber.replace(/\s/g,""))||(r.cardNumber="Card number must be 16 digits"):r.cardNumber="Card number is required",e.expiryDate.trim()?/^(0[1-9]|1[0-2])\/?([0-9]{2})$/.test(e.expiryDate)||(r.expiryDate="Format must be MM/YY"):r.expiryDate="Expiry date is required",e.cvv.trim()?/^\d{3,4}$/.test(e.cvv)||(r.cvv="CVV must be 3 or 4 digits"):r.cvv="CVV is required",e.agreeToTerms||(r.agreeToTerms="You must agree to the terms"),r};var NI="Radio",[rye,f9]=as(NI),[nye,iye]=rye(NI),p9=D.forwardRef((e,t)=>{const{__scopeRadio:r,name:n,checked:o=!1,required:s,disabled:h,value:i="on",onCheck:p,form:y,...b}=e,[_,E]=D.useState(null),C=Kr(t,I=>E(I)),k=D.useRef(!1),N=_?y||!!_.closest("form"):!0;return c.jsxs(nye,{scope:r,checked:o,disabled:h,children:[c.jsx(fr.button,{type:"button",role:"radio","aria-checked":o,"data-state":v9(o),"data-disabled":h?"":void 0,disabled:h,value:i,...b,ref:C,onClick:Ht(e.onClick,I=>{o||p==null||p(),N&&(k.current=I.isPropagationStopped(),k.current||I.stopPropagation())})}),N&&c.jsx(y9,{control:_,bubbles:!k.current,name:n,value:i,checked:o,required:s,disabled:h,form:y,style:{transform:"translateX(-100%)"}})]})});p9.displayName=NI;var m9="RadioIndicator",g9=D.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:n,...o}=e,s=iye(m9,r);return c.jsx(Ol,{present:n||s.checked,children:c.jsx(fr.span,{"data-state":v9(s.checked),"data-disabled":s.disabled?"":void 0,...o,ref:t})})});g9.displayName=m9;var oye="RadioBubbleInput",y9=D.forwardRef(({__scopeRadio:e,control:t,checked:r,bubbles:n=!0,...o},s)=>{const h=D.useRef(null),i=Kr(h,s),p=EI(r),y=LM(t);return D.useEffect(()=>{const b=h.current;if(!b)return;const _=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(_,"checked").set;if(p!==r&&C){const k=new Event("click",{bubbles:n});C.call(b,r),b.dispatchEvent(k)}},[p,r,n]),c.jsx(fr.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...o,tabIndex:-1,ref:i,style:{...o.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});y9.displayName=oye;function v9(e){return e?"checked":"unchecked"}var aye=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],H2="RadioGroup",[sye,QUe]=as(H2,[cg,f9]),x9=cg(),b9=f9(),[lye,cye]=sye(H2),_9=D.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:n,defaultValue:o,value:s,required:h=!1,disabled:i=!1,orientation:p,dir:y,loop:b=!0,onValueChange:_,...E}=e,C=x9(r),k=Ob(y),[N,I]=Nc({prop:s,defaultProp:o??null,onChange:_,caller:H2});return c.jsx(lye,{scope:r,name:n,required:h,disabled:i,value:N,onValueChange:I,children:c.jsx($M,{asChild:!0,...C,orientation:p,dir:k,loop:b,children:c.jsx(fr.div,{role:"radiogroup","aria-required":h,"aria-orientation":p,"data-disabled":i?"":void 0,dir:k,...E,ref:t})})})});_9.displayName=H2;var w9="RadioGroupItem",S9=D.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:n,...o}=e,s=cye(w9,r),h=s.disabled||n,i=x9(r),p=b9(r),y=D.useRef(null),b=Kr(t,y),_=s.value===o.value,E=D.useRef(!1);return D.useEffect(()=>{const C=N=>{aye.includes(N.key)&&(E.current=!0)},k=()=>E.current=!1;return document.addEventListener("keydown",C),document.addEventListener("keyup",k),()=>{document.removeEventListener("keydown",C),document.removeEventListener("keyup",k)}},[]),c.jsx(FM,{asChild:!0,...i,focusable:!h,active:_,children:c.jsx(p9,{disabled:h,required:s.required,checked:_,...p,...o,name:s.name,ref:b,onCheck:()=>s.onValueChange(o.value),onKeyDown:Ht(C=>{C.key==="Enter"&&C.preventDefault()}),onFocus:Ht(o.onFocus,()=>{var C;E.current&&((C=y.current)==null||C.click())})})})});S9.displayName=w9;var uye="RadioGroupIndicator",E9=D.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...n}=e,o=b9(r);return c.jsx(g9,{...o,...n,ref:t})});E9.displayName=uye;var T9=_9,j9=S9,dye=E9;const hye=D.forwardRef(({className:e,...t},r)=>c.jsx(T9,{className:Cr("grid gap-2",e),...t,ref:r}));hye.displayName=T9.displayName;const fye=D.forwardRef(({className:e,...t},r)=>c.jsx(j9,{ref:r,className:Cr("aspect-square h-4 w-4 rounded-full border border-brand-burgundy text-brand-burgundy ring-offset-white focus:outline-none focus-visible:ring-2 focus-visible:ring-brand-burgundy focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:c.jsx(dye,{className:"flex items-center justify-center",children:c.jsx(_ie,{className:"h-2.5 w-2.5 fill-brand-burgundy text-brand-burgundy"})})}));fye.displayName=j9.displayName;class yg{constructor(t=0,r="Network Error"){this.status=t,this.text=r}}const pye=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},ro={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:pye()},MI=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},C9=(e,t="https://api.emailjs.com")=>{if(!e)return;const r=MI(e);ro.publicKey=r.publicKey,ro.blockHeadless=r.blockHeadless,ro.storageProvider=r.storageProvider,ro.blockList=r.blockList,ro.limitRate=r.limitRate,ro.origin=r.origin||t},P9=async(e,t,r={})=>{const n=await fetch(ro.origin+e,{method:"POST",headers:r,body:t}),o=await n.text(),s=new yg(n.status,o);if(n.ok)return s;throw s},A9=(e,t,r)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!r||typeof r!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},mye=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},k9=e=>e.webdriver||!e.languages||e.languages.length===0,N9=()=>new yg(451,"Unavailable For Headless Browser"),gye=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"},yye=e=>{var t;return!((t=e.list)!=null&&t.length)||!e.watchVariable},vye=(e,t)=>e instanceof FormData?e.get(t):e[t],M9=(e,t)=>{if(yye(e))return!1;gye(e.list,e.watchVariable);const r=vye(t,e.watchVariable);return typeof r!="string"?!1:e.list.includes(r)},I9=()=>new yg(403,"Forbidden"),xye=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"},bye=async(e,t,r)=>{const n=Number(await r.get(e)||0);return t-Date.now()+n},O9=async(e,t,r)=>{if(!t.throttle||!r)return!1;xye(t.throttle,t.id);const n=t.id||e;return await bye(n,t.throttle,r)>0?!0:(await r.set(n,Date.now().toString()),!1)},D9=()=>new yg(429,"Too Many Requests"),R9=async(e,t,r,n)=>{const o=MI(n),s=o.publicKey||ro.publicKey,h=o.blockHeadless||ro.blockHeadless,i=o.storageProvider||ro.storageProvider,p={...ro.blockList,...o.blockList},y={...ro.limitRate,...o.limitRate};return h&&k9(navigator)?Promise.reject(N9()):(A9(s,e,t),mye(r),r&&M9(p,r)?Promise.reject(I9()):await O9(location.pathname,y,i)?Promise.reject(D9()):P9("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:s,service_id:e,template_id:t,template_params:r}),{"Content-type":"application/json"}))},_ye=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},wye=e=>typeof e=="string"?document.querySelector(e):e,L9=async(e,t,r,n)=>{const o=MI(n),s=o.publicKey||ro.publicKey,h=o.blockHeadless||ro.blockHeadless,i=ro.storageProvider||o.storageProvider,p={...ro.blockList,...o.blockList},y={...ro.limitRate,...o.limitRate};if(h&&k9(navigator))return Promise.reject(N9());const b=wye(r);A9(s,e,t),_ye(b);const _=new FormData(b);return M9(p,_)?Promise.reject(I9()):await O9(location.pathname,y,i)?Promise.reject(D9()):(_.append("lib_version","4.4.1"),_.append("service_id",e),_.append("template_id",t),_.append("user_id",s),P9("/api/v1.0/email/send-form",_))},Ca={init:C9,send:R9,sendForm:L9,EmailJSResponseStatus:yg},B9=Object.freeze(Object.defineProperty({__proto__:null,EmailJSResponseStatus:yg,default:Ca,init:C9,send:R9,sendForm:L9},Symbol.toStringTag,{value:"Module"})),Sye=e=>`
<div
  style="
    font-family: system-ui, sans-serif, Arial;
    font-size: 14px;
    color: #333;
    padding: 14px 8px;
    background-color: #f5f5f5;
  "
>
  <style>
    @media only screen and (max-width: 600px) {
      .mobile-padding { padding: 8px !important; }
      .mobile-text { font-size: 12px !important; }
      .mobile-title { font-size: 14px !important; }
      .mobile-stack { display: block !important; width: 100% !important; }
      .mobile-center { text-align: center !important; }
      .mobile-hide { display: none !important; }
      .mobile-full-width { width: 100% !important; }
    }
  </style>
  <div style="max-width: 600px; margin: auto; background-color: #fff">
    <div style="border-top: 6px solid #5B0202; padding: 16px;" class="mobile-padding">
      <a
        style="text-decoration: none; outline: none; margin-right: 8px; vertical-align: middle"
        href="https://vipclub.com"
        target="_blank"
      >
        <img
          style="height: 32px; vertical-align: middle"
          height="32px"
          src="cid:logo.png"
          alt="VIP Club"
        />
      </a>
      <span
        style="
          font-size: 16px;
          vertical-align: middle;
          border-left: 1px solid #333;
          padding-left: 8px;
        "
        class="mobile-title"
      >
        <strong>Booking Confirmation</strong>
      </span>
    </div>
    <div style="padding: 0 16px;" class="mobile-padding">
      <p class="mobile-text">Thank you for your reservation! We're excited to welcome you to ${e.venueName}.</p>
      <div
        style="
          text-align: left;
          font-size: 14px;
          padding-bottom: 4px;
          border-bottom: 2px solid #333;
          margin-bottom: 16px;
        "
        class="mobile-text"
      >
        <strong>Booking # ${e.bookingId}</strong>
      </div>
      
      <!-- Booking Details - Mobile Responsive -->
      <table style="width: 100%; border-collapse: collapse; margin-top: 24px;" class="mobile-stack">
        <tr style="vertical-align: top;" class="mobile-stack">
          <td style="padding: 12px 8px; width: 120px;" class="mobile-stack mobile-center">
            <img style="height: 80px; width: 120px; object-fit: cover; border-radius: 8px; max-width: 100%;" 
                 src="${e.venueImage}" alt="${e.venueName}" class="mobile-full-width" />
          </td>
          <td style="padding: 12px 8px; width: 100%;" class="mobile-stack">
            <div style="font-weight: bold; font-size: 16px; color: #5B0202;" class="mobile-title">${e.venueName}</div>
            <div style="color: #888; padding-top: 4px;" class="mobile-text">${e.venueAddress}</div>
            <div style="padding-top: 8px;" class="mobile-text">
              <div><strong>Date:</strong> ${e.date}</div>
              <div><strong>Time:</strong> ${e.time}</div>
              <div><strong>Guests:</strong> ${e.guests}</div>
              ${e.tableNumber?`<div><strong>Table:</strong> ${e.tableNumber}</div>`:""}
            </div>
          </td>
        </tr>
      </table>

      <!-- Pricing Breakdown -->
      <div style="padding: 24px 0;">
        <div style="border-top: 2px solid #333"></div>
      </div>
      <table style="border-collapse: collapse; width: 100%; text-align: right;" class="mobile-text">
        <tr>
          <td style="width: 60%;"></td>
          <td style="padding: 4px 8px;">Booking Fee</td>
          <td style="padding: 4px 8px; white-space: nowrap">${e.bookingFee}</td>
        </tr>
        ${e.serviceCharge?`
        <tr>
          <td style="width: 60%;"></td>
          <td style="padding: 4px 8px;">Service Charge</td>
          <td style="padding: 4px 8px; white-space: nowrap">${e.serviceCharge}</td>
        </tr>
        `:""}
        <tr>
          <td style="width: 60%;"></td>
          <td style="border-top: 2px solid #333; padding: 8px;">
            <strong style="white-space: nowrap">Total Amount</strong>
          </td>
          <td style="padding: 8px; border-top: 2px solid #333; white-space: nowrap">
            <strong>${e.totalAmount}</strong>
          </td>
        </tr>
      </table>

      <!-- Important Information -->
      <div style="margin-top: 24px; padding: 16px; background-color: #f8f8f8; border-radius: 8px;" class="mobile-padding">
        <h3 style="margin: 0 0 12px 0; color: #5B0202;" class="mobile-title">Important Information</h3>
        <ul style="margin: 0; padding-left: 20px;" class="mobile-text">
          <li style="margin-bottom: 8px;">Please arrive 15 minutes before your reservation time</li>
          <li style="margin-bottom: 8px;">Bring a valid ID for verification</li>
          <li style="margin-bottom: 8px;">Dress code: ${e.dressCode||"Smart casual"}</li>
          <li>For cancellations, contact us at least 24 hours in advance</li>
        </ul>
      </div>

      <!-- Contact Information -->
      <div style="margin-top: 24px; padding: 16px; border: 1px solid #ddd; border-radius: 8px;" class="mobile-padding">
        <h3 style="margin: 0 0 12px 0; color: #5B0202;" class="mobile-title">Venue Contact</h3>
        <p style="margin: 0;" class="mobile-text">
          <strong>${e.venueName}</strong><br>
           ${e.venueAddress}<br>
           ${e.venuePhone}<br>
           ${e.venueEmail}
        </p>
      </div>
    </div>
  </div>
  <div style="max-width: 600px; margin: auto;">
    <p style="color: #999; text-align: center; padding: 16px;" class="mobile-text mobile-padding">
      This email was sent to ${e.customerEmail}<br>
      You received this email because you made a reservation with VIP Club
    </p>
    <p style="color: #999; text-align: center; font-size: 12px;" class="mobile-text">
      VIP Club - Your Premier Destination for Exclusive Venue Bookings<br>
      Lagos, Nigeria | www.vipclub.com
    </p>
  </div>
</div>
  `,z9=(e,t)=>`
<div
  style="
    font-family: system-ui, sans-serif, Arial;
    font-size: 14px;
    color: #333;
    padding: 14px 8px;
    background-color: #f5f5f5;
  "
>
  <div style="max-width: 600px; margin: auto; background-color: #fff">
    <div style="border-top: 6px solid #D4AF37; padding: 16px">
      <a
        style="text-decoration: none; outline: none; margin-right: 8px; vertical-align: middle"
        href="https://vipclub.com/venue-owner/dashboard"
        target="_blank"
      >
        <img
          style="height: 32px; vertical-align: middle"
          height="32px"
          src="cid:logo.png"
          alt="VIP Club"
        />
      </a>
      <span
        style="
          font-size: 16px;
          vertical-align: middle;
          border-left: 1px solid #333;
          padding-left: 8px;
        "
      >
        <strong>New Booking Received</strong>
      </span>
    </div>
    <div style="padding: 0 16px">
      <p>Hello ${t.name},</p>
      <p>You have received a new booking for <strong>${e.venueName}</strong>.</p>
      
      <div
        style="
          text-align: left;
          font-size: 14px;
          padding-bottom: 4px;
          border-bottom: 2px solid #333;
        "
      >
        <strong>Booking # ${e.bookingId}</strong>
      </div>

      <!-- Customer Information -->
      <div style="margin-top: 24px; padding: 16px; background-color: #f8f8f8; border-radius: 8px;">
        <h3 style="margin: 0 0 12px 0; color: #5B0202;">Customer Details</h3>
        <p style="margin: 0;">
          <strong>Name:</strong> ${e.customerName}<br>
          <strong>Email:</strong> ${e.customerEmail}<br>
          <strong>Phone:</strong> ${e.customerPhone}
        </p>
      </div>

      <!-- Booking Details -->
      <div style="margin-top: 16px; padding: 16px; background-color: #f8f8f8; border-radius: 8px;">
        <h3 style="margin: 0 0 12px 0; color: #5B0202;">Booking Details</h3>
        <p style="margin: 0;">
          <strong>Date:</strong> ${e.date}<br>
          <strong>Time:</strong> ${e.time}<br>
          <strong>Guests:</strong> ${e.guests}<br>
          ${e.tableNumber?`<strong>Table:</strong> ${e.tableNumber}<br>`:""}
          <strong>Total Amount:</strong> ${e.totalAmount}
        </p>
      </div>

      <!-- Action Buttons -->
      <div style="text-align: center; margin: 24px 0;">
        <a href="https://vipclub.com/venue-owner/bookings" 
           style="
             display: inline-block;
             padding: 12px 24px;
             background-color: #5B0202;
             color: white;
             text-decoration: none;
             border-radius: 6px;
             font-weight: bold;
           ">
          View in Dashboard
        </a>
      </div>
    </div>
  </div>
  <div style="max-width: 600px; margin: auto">
    <p style="color: #999; text-align: center; padding: 16px;">
      VIP Club Venue Owner Portal<br>
      Manage your bookings at vipclub.com/venue-owner
    </p>
  </div>
</div>
  `,Eye=e=>`
<div
  style="
    font-family: system-ui, sans-serif, Arial;
    font-size: 14px;
    color: #333;
    padding: 14px 8px;
    background-color: #f5f5f5;
  "
>
  <div style="max-width: 600px; margin: auto; background-color: #fff">
    <div style="border-top: 6px solid #dc2626; padding: 16px">
      <a
        style="text-decoration: none; outline: none; margin-right: 8px; vertical-align: middle"
        href="https://vipclub.com"
        target="_blank"
      >
        <img
          style="height: 32px; vertical-align: middle"
          height="32px"
          src="cid:logo.png"
          alt="VIP Club"
        />
      </a>
      <span
        style="
          font-size: 16px;
          vertical-align: middle;
          border-left: 1px solid #333;
          padding-left: 8px;
        "
      >
        <strong>Booking Cancelled</strong>
      </span>
    </div>
    <div style="padding: 0 16px">
      <p>Your booking has been cancelled as requested.</p>
      
      <div
        style="
          text-align: left;
          font-size: 14px;
          padding-bottom: 4px;
          border-bottom: 2px solid #333;
        "
      >
        <strong>Booking # ${e.bookingId}</strong>
      </div>

      <!-- Cancelled Booking Details -->
      <div style="margin-top: 24px; padding: 16px; background-color: #fef2f2; border: 1px solid #fecaca; border-radius: 8px;">
        <h3 style="margin: 0 0 12px 0; color: #dc2626;">Cancelled Reservation</h3>
        <p style="margin: 0;">
          <strong>Venue:</strong> ${e.venueName}<br>
          <strong>Date:</strong> ${e.date}<br>
          <strong>Time:</strong> ${e.time}<br>
          <strong>Guests:</strong> ${e.guests}
        </p>
      </div>

      ${e.refundAmount?`
      <div style="margin-top: 16px; padding: 16px; background-color: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px;">
        <h3 style="margin: 0 0 12px 0; color: #16a34a;">Refund Information</h3>
        <p style="margin: 0;">
          A refund of <strong>${e.refundAmount}</strong> will be processed to your original payment method within 5-7 business days.
        </p>
      </div>
      `:""}

      <p style="margin-top: 24px;">
        We're sorry to see you cancel your reservation. We hope to welcome you to VIP Club in the future!
      </p>
    </div>
  </div>
  <div style="max-width: 600px; margin: auto">
    <p style="color: #999; text-align: center; padding: 16px;">
      VIP Club - Your Premier Destination for Exclusive Venue Bookings<br>
      Lagos, Nigeria | www.vipclub.com
    </p>
  </div>
</div>
  `,$9=(e,t,r)=>{var n;return{bookingId:e.id,venueName:t.name,venueAddress:t.address,venuePhone:t.contact_phone,venueEmail:t.contact_email,venueImage:((n=t.images)==null?void 0:n[0])||"/images/default-venue.jpg",customerName:r.full_name||r.name,customerEmail:r.email,customerPhone:r.phone,date:new Date(e.booking_date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),time:e.booking_time,guests:e.guest_count,tableNumber:e.table_number,bookingFee:e.booking_fee||"0",serviceCharge:e.service_charge||"0",totalAmount:e.total_amount||e.amount,dressCode:t.dress_code,status:e.status}},Tye=Object.freeze(Object.defineProperty({__proto__:null,bookingConfirmationTemplate:Sye,cancellationTemplate:Eye,generateEmailData:$9,venueOwnerNotificationTemplate:z9},Symbol.toStringTag,{value:"Module"})),yn={serviceId:"service_55v7svp",templateId:{}.VITE_EMAILJS_BOOKING_CONFIRMATION_TEMPLATE,publicKey:"_DltRvDA4UAiyUt1E"};Ca.init(yn.publicKey);const jye=e=>({...e,subject:e.subject||"VIP Club Booking Confirmation",from_name:"VIP Club",reply_to:"support@vipclub.com"}),Cye=async(e,t,r)=>{try{if(!yn.serviceId||!yn.templateId||!yn.publicKey)throw console.warn(" EmailJS not fully configured. Check your .env file for:"),console.warn("   - VITE_EMAILJS_SERVICE_ID"),console.warn("   - VITE_EMAILJS_TEMPLATE_ID"),console.warn("   - VITE_EMAILJS_PUBLIC_KEY"),new Error("EmailJS configuration incomplete");const n=r.email||r.customerEmail||r.full_name;if(!n||!n.includes("@"))throw console.error(" Invalid or missing customer email:",n),new Error("Invalid customer email address");const o={customerEmail:n,to_name:r.full_name||r.customerName||r.name||"Valued Customer",customerName:r.full_name||r.customerName||r.name||"Valued Customer",to_email:n,customerPhone:r.phone||r.customerPhone||r.phone_number||"N/A",bookingReference:e.booking_reference||`VIP-${e.id}`,partySize:e.guest_count||e.guests||e.number_of_guests||"2",bookingDate:new Date(e.booking_date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),bookingTime:e.booking_time||e.start_time||"7:00 PM",bookingDuration:e.duration||e.booking_duration||"4",tableNumber:e.table_number||e.table_id||"VIP-001",tableType:e.table_type||t.table_type||"VIP Table",tableCapacity:e.guest_count||e.guests||e.number_of_guests||"2",tableLocation:e.table_location||t.table_location||"Prime Location",tableFeatures:e.table_features||t.table_features||"Premium seating with excellent view",venueName:t.name||"Premium Venue",venueDescription:t.description||t.about||"Experience luxury dining and entertainment in Lagos' most exclusive venue.",venueAddress:t.address||t.location||"Lagos, Nigeria",venuePhone:t.contact_phone||t.phone||t.contact_number||"+234 XXX XXX XXXX",venueDressCode:t.dress_code||t.dresscode||"Smart Casual",venueParking:t.parking||t.parking_info||"Valet parking available",venueCuisine:t.cuisine||t.cuisine_type||"International cuisine",venueHours:t.hours||t.opening_hours||t.business_hours||"6:00 PM - 2:00 AM",specialRequests:e.special_requests||e.notes||e.additional_notes||"None specified",viewBookingUrl:`${window.location.origin}/profile`,modifyBookingUrl:`${window.location.origin}/profile`,cancelBookingUrl:`${window.location.origin}/profile`,websiteUrl:window.location.origin,supportUrl:"mailto:support@vipclub.com",unsubscribeUrl:`${window.location.origin}/settings`},s=jye(o);console.log(" Sending booking confirmation with optimized parameters:",{to_email:s.to_email,customerName:s.customerName,bookingReference:s.bookingReference,venueName:s.venueName,subject:s.subject});const h=await Ca.send(yn.serviceId,yn.templateId,s);return console.log(" Booking confirmation email sent successfully:",h),console.log(" Email Delivery Tips:"),console.log("   - Check spam/junk folder if email not received"),console.log('   - Mark as "Not Spam" to improve future delivery'),console.log("   - Add support@vipclub.com to contacts"),h}catch(n){throw console.error(" Failed to send booking confirmation:",n),console.error("Error details:",{message:n.message,status:n.status,text:n.text}),n.text==="The recipients address is empty"&&(console.error(' EmailJS template issue: The "To" field in your EmailJS template is missing or incorrectly configured.'),console.error('   Please ensure your EmailJS template has {{customerEmail}} in the "To" field.')),n}},Pye=async(e,t,r)=>{try{if(!yn.serviceId||!yn.templateId||!yn.publicKey)throw new Error("EmailJS configuration incomplete");const n=$9(e,t,r),o=z9(n),s=await Ca.send(yn.serviceId,yn.templateId,{to_email:t.contact_email,to_name:"Venue Manager",subject:`New Booking - ${t.name}`,html_content:o,from_name:"VIP Club",reply_to:"support@vipclub.com"});return console.log(" Venue owner notification sent successfully"),s}catch(n){throw console.error(" Failed to send venue owner notification:",n),n}},Aye=async()=>{if(!yn.templateId||!yn.publicKey)return console.error(" EmailJS configuration incomplete:"),console.error("   Service ID:"," Set"),console.error("   Template ID:",yn.templateId?" Set":" Missing"),console.error("   Public Key:"," Set"),{success:!1,error:"EmailJS configuration incomplete. Check your .env file."};const e={to_name:"Test User",to_email:"test@example.com",from_name:"VIP Club",message:"This is a test email to verify EmailJS configuration.",subject:"VIP Club Email Service Test"};try{console.log(" Testing EmailJS with config:",{serviceId:yn.serviceId,templateId:yn.templateId,publicKey:yn.publicKey?"***":"missing"});const t=await Ca.send(yn.serviceId,yn.templateId,e);return console.log(" Email service test successful:",t),{success:!0,result:t}}catch(t){console.error(" Email service test failed:",t),console.error("Error details:",{message:t.message,status:t.status,text:t.text});let r="Email service test failed";return t.status===422?r="Template parameters mismatch. Please check your EmailJS template configuration.":t.status===400?r="Invalid request. Check your Service ID and Template ID.":t.status===401&&(r="Unauthorized. Check your Public Key."),{success:!1,error:r}}},kye=async(e="test@example.com")=>{console.log(" Starting quick email test...");try{const t=await Ca.send(yn.serviceId,yn.templateId,{to_email:e,to_name:"Test User",from_name:"VIP Club",subject:"VIP Club Test Email",message:"This is a test email from VIP Club",venue_name:"Test Venue",booking_id:"12345",booking_date:new Date().toLocaleDateString(),booking_time:"19:00",guests:"2",total_amount:"5000"});return console.log(" Quick email test successful!",t),{success:!0,result:t}}catch(t){return console.error(" Quick email test failed:",t),{success:!1,error:t}}},Nye=async(e,t,r)=>{console.log(" Debugging booking email issue..."),console.log(" Customer data:",r),console.log(" Venue data:",t),console.log(" Booking data:",e),console.log(" EmailJS config:",{serviceId:" Set",templateId:yn.templateId?" Set":" Missing",publicKey:" Set"});const n=r.email||r.customerEmail||r.full_name;if(console.log(" Customer email found:",n),!n||!n.includes("@"))return console.error(" Invalid customer email:",n),{success:!1,error:"Invalid customer email"};const o={customerEmail:n,to_name:r.full_name||r.customerName||"Test User",customerName:r.full_name||r.customerName||"Test User",to_email:n,bookingReference:"TEST-123",venueName:t.name||"Test Venue"};console.log(" Testing with minimal params:",o);try{const s=await Ca.send(yn.serviceId,yn.templateId,o);return console.log(" Debug test successful:",s),{success:!0,result:s}}catch(s){return console.error(" Debug test failed:",s),s.text==="The recipients address is empty"&&(console.error(' SOLUTION: Your EmailJS template is missing the "To" field configuration.'),console.error("   Please go to your EmailJS dashboard and:"),console.error("   1. Open your email template"),console.error('   2. In the "To" field, add: {{customerEmail}}'),console.error("   3. Save the template"),console.error("   4. Try again")),{success:!1,error:s.text||s.message}}},Mye=async(e="test@example.com")=>{if(console.log(" Testing EmailJS configuration..."),console.log(" EmailJS Config:",{serviceId:" Set",templateId:yn.templateId?" Set":" Missing",publicKey:" Set"}),!yn.templateId||!yn.publicKey)return console.error(" EmailJS not fully configured. Check your .env file."),!1;const t={customerEmail:e,to_name:"Test User",customerName:"Test User",bookingReference:"TEST-123",venueName:"Test Venue",bookingDate:new Date().toLocaleDateString(),bookingTime:"19:00",partySize:"2",totalAmount:"5000"};console.log(" Sending test with params:",t);try{const r=await Ca.send(yn.serviceId,yn.templateId,t);return console.log(" Test email sent successfully!",r),!0}catch(r){return console.error(" Test email failed:",r),console.error("Error details:",{status:r.status,text:r.text,message:r.message}),r.text==="The recipients address is empty"&&(console.error(' SOLUTION: Your EmailJS template needs {{customerEmail}} in the "To" field'),console.error("   Go to EmailJS Dashboard  Templates  Edit your template"),console.error('   In the "To" field, make sure it says: {{customerEmail}}')),!1}};typeof window<"u"&&(window.quickEmailTest=kye,window.testEmailService=Aye,window.testEmailJSNow=Mye);const Iye=async(e="venue-owner-invitation",t={})=>{try{console.log(" Testing Edge Function email with template:",e),console.log(" Test data:",t);const{data:r,error:n}=await Ve.functions.invoke("send-email",{body:{template:e,data:{email:t.email||"test@example.com",venueName:t.venueName||"Test Venue",contactName:t.contactName||"Test Owner",venueType:t.venueType||"Restaurant",ownerName:t.ownerName||"Test Owner",venueAddress:t.venueAddress||"Test Address",venueCity:t.venueCity||"Lagos"}}});return n?(console.error(" Edge Function error:",n),console.error("Error details:",{message:n.message,status:n.status,name:n.name}),{success:!1,error:n.message}):(console.log(" Edge Function email test successful:",r),{success:!0,data:r})}catch(r){return console.error(" Error testing Edge Function email:",r),{success:!1,error:r.message}}};typeof window<"u"&&(window.testEdgeFunctionEmail=Iye);const EC=()=>{var Pe;const{id:e}=l2(),t=zi(),r=qc(),{toast:n}=Co(),{user:o}=fg(),s=r.pathname.includes("/deposit"),h=(Pe=r.state)==null?void 0:Pe.depositAmount,[i,p]=D.useState(null),[y,b]=D.useState(!0),[_,E]=D.useState({fullName:"",email:"",phone:"",password:"",cardNumber:"",expiryDate:"",cvv:"",agreeToTerms:!1,referralCode:""}),[C,k]=D.useState(null),[N,I]=D.useState({}),[B,O]=D.useState(!1),[R,q]=D.useState(!1),[F,X]=D.useState([]);D.useState(null),D.useState("card"),D.useState(1),D.useState([]),D.useState([]);const[G,ee]=D.useState(!1),[K,ie]=D.useState([]);D.useEffect(()=>{(async()=>{if(o)try{const{data:Be,error:Fe}=await Ve.from("user_profiles").select("*").eq("id",o.id).single();Fe&&Fe.code!=="PGRST116"?console.error("Error fetching user profile:",Fe):Be&&(k(Be),E(Ge=>{var Pt,$t;return{...Ge,fullName:`${Be.first_name||""} ${Be.last_name||""}`.trim()||((Pt=o.user_metadata)==null?void 0:Pt.full_name)||"",email:o.email||"",phone:Be.phone_number||(($t=o.user_metadata)==null?void 0:$t.phone)||""}}))}catch(Be){console.error("Error fetching user profile:",Be)}})()},[o]),D.useEffect(()=>{if(console.log("CheckoutPage useEffect triggered"),console.log("isDepositFlow:",s),console.log("id from params:",e),console.log("location.pathname:",r.pathname),s){if(!h){console.log("No deposit amount, redirecting to profile"),t("/profile");return}p({depositAmount:h,isDeposit:!0,venueName:"VIP Credit Deposit"})}else{const Re=localStorage.getItem("lagosvibe_booking_selection");if(console.log("savedSelection from localStorage:",Re),Re){const Be=JSON.parse(Re);console.log("parsedSelection:",Be),console.log("parsedSelection.venueId:",Be.venueId),console.log("id from params:",e),console.log("Comparison result:",Be.venueId===e),Be.venueId===e?(console.log("Venue ID matches, setting selection"),p(Be)):(console.log("Venue ID mismatch, redirecting to venue page"),t(`/venues/${e}`))}else console.log("No saved selection, redirecting to venue page"),t(`/venues/${e}`)}b(!1)},[e,t,s,h]);const pe=Re=>{const{name:Be,value:Fe,type:Ge,checked:Pt}=Re.target;E($t=>({...$t,[Be]:Ge==="checkbox"?Pt:Fe})),N[Be]&&I($t=>({...$t,[Be]:null}))},ae=Re=>Re==="VIP2025"?(n({title:"Referral code applied!",description:"You've unlocked 10% off!"}),X(Be=>[...Be,"10% Discount Applied"]),!0):(n({title:"Invalid referral code",variant:"destructive"}),!1),_e=async Re=>{var Pt,$t,nr;let Be,Fe,Ge;try{if(Re.dbRecord?Be=Re.dbRecord:Be={id:Re.bookingId||Re.id,booking_date:Re.bookingDate||new Date().toISOString(),booking_time:i.time||"19:00:00",guest_count:i.guests||i.guestCount||2,table_number:((Pt=i.table)==null?void 0:Pt.name)||(($t=i.table)==null?void 0:$t.table_number),total_amount:Re.totalAmount,status:"confirmed"},Be.venue_id){const{data:ft,error:vt}=await Ve.from("venues").select("*").eq("id",Be.venue_id).single();!vt&&ft?Fe=ft:(console.warn("Could not fetch venue data, using fallback:",vt),Fe={name:Re.venueName||i.venueName,address:i.venueAddress||"Lagos, Nigeria",contact_phone:i.venuePhone||"+234 XXX XXX XXXX",contact_email:i.venueEmail||"info@vipclub.com",images:i.venueImage?[i.venueImage]:[],dress_code:"Smart casual"})}else Fe={name:Re.venueName||i.venueName,address:i.venueAddress||"Lagos, Nigeria",contact_phone:i.venuePhone||"+234 XXX XXX XXXX",contact_email:i.venueEmail||"info@vipclub.com",images:i.venueImage?[i.venueImage]:[],dress_code:"Smart casual"};Ge={full_name:Re.customerName||_.fullName,email:Re.customerEmail||_.email,phone:Re.customerPhone||_.phone};const Nt=await Cye(Be,Fe,Ge),Jt=Fe.contact_email||i.ownerEmail||"owner@vipclub.com";return Jt&&Pye(Be,Fe,Ge,{full_name:"Venue Owner",email:Jt}).catch(vt=>console.log("Venue owner notification failed:",vt)),console.log(" Email service result:",Nt),!0}catch(Nt){if(console.error(" Failed to send booking emails:",Nt),(Nt.text==="The recipients address is empty"||(nr=Nt.message)!=null&&nr.includes("recipients address is empty"))&&Be&&Fe&&Ge){console.log(" Running email debug function...");try{await Nye(Be,Fe,Ge)}catch(Jt){console.error(" Debug function also failed:",Jt)}}return!1}},Ee=async Re=>{try{if(o){const{error:$t}=await Ve.from("user_profiles").upsert([{id:o.id,first_name:Re.fullName.split(" ")[0]||"",last_name:Re.fullName.split(" ").slice(1).join(" ")||"",phone_number:Re.phone}],{onConflict:"id"});return $t&&console.error("Error updating user profile:",$t),o}const{data:Be,error:Fe}=await Ve.auth.signInWithPassword({email:Re.email,password:Re.password});if(Be!=null&&Be.user)return Be.user;const{data:Ge,error:Pt}=await Ve.auth.signUp({email:Re.email,password:Re.password,options:{data:{full_name:Re.fullName,phone:Re.phone}}});if(Pt)throw Pt;if(Ge.user){const{error:$t}=await Ve.from("user_profiles").upsert([{id:Ge.user.id,first_name:Re.fullName.split(" ")[0]||"",last_name:Re.fullName.split(" ").slice(1).join(" ")||"",phone_number:Re.phone}],{onConflict:"id"});$t&&console.error("Error creating user profile:",$t)}return Ge.user}catch(Be){throw console.error("Error with user account:",Be),Be}},xe=async Re=>{var Fe;Re.preventDefault();const Be=tye(_,!!o);if(I(Be),Object.keys(Be).length===0){O(!0);try{_.referralCode&&ae(_.referralCode);const Ge=await Ee({fullName:_.fullName,email:_.email,phone:_.phone,password:_.password}),Pt={user_id:Ge==null?void 0:Ge.id,venue_id:i.venueId||i.id,table_id:((Fe=i.table)==null?void 0:Fe.id)||null,booking_date:i.date||new Date().toISOString().split("T")[0],start_time:i.time||"19:00:00",end_time:i.endTime||"23:00:00",number_of_guests:i.guests||i.guestCount||2,status:"confirmed",total_amount:parseFloat(ce())},{data:$t,error:nr}=await Ve.from("bookings").insert([Pt]).select().single();if(nr)throw new Error(`Failed to create booking: ${nr.message}`);const Nt={id:$t.id,...i,customerName:_.fullName,customerEmail:_.email,customerPhone:_.phone,userId:Ge==null?void 0:Ge.id,bookingDate:new Date().toISOString(),status:"confirmed",referralCode:_.referralCode,vipPerksApplied:F,totalAmount:ce(),dbRecord:$t},Jt=JSON.parse(localStorage.getItem("lagosvibe_bookings")||"[]");Jt.push(Nt),localStorage.setItem("lagosvibe_bookings",JSON.stringify(Jt)),localStorage.removeItem("lagosvibe_booking_selection");const ft=await _e({...Nt,bookingId:$t.id,venueName:i.venueName||i.name}),vt=["Free Welcome Drink","Priority Queue"];localStorage.setItem("lagosvibe_vip_perks",JSON.stringify(vt));const lt=!o;n({title:lt?"Account Created & Booking Confirmed!":"Booking Confirmed!",description:ft?lt?"Welcome to VIPClub! Check your email for confirmation.":"Your booking is confirmed! Check your email for confirmation.":lt?"Welcome to VIPClub! Your booking is confirmed. You can view details in your profile.":"Your booking is confirmed. You can view details in your profile.",className:"bg-green-500 text-white"}),ft||setTimeout(()=>{n({title:"Email Notification",description:"Confirmation email could not be sent, but your booking is saved. You can view it in your profile.",variant:"default"})},3e3),q(!0)}catch(Ge){console.error("Error processing booking:",Ge),n({title:"Booking Error",description:Ge.message||"There was an error processing your booking. Please try again.",variant:"destructive"})}finally{O(!1)}}else n({title:"Form validation failed",description:"Please check the form and fix the errors.",variant:"destructive"})},ce=()=>{var Be,Fe;if(s&&h)return h.toFixed(2);if(!i)return 0;let Re=(((Be=i.ticket)==null?void 0:Be.price)||0)+(((Fe=i.table)==null?void 0:Fe.price)||0)+25;return F.includes("10% Discount Applied")&&(Re*=.9),Re.toFixed(2)},ke=Re=>{navigator.clipboard.writeText(Re),n({title:"Link copied!",description:"Share this link with your friends to collect payment."})},ve=Re=>{ie(Re),ee(!0)};return y?c.jsx("div",{className:"container py-20 text-center",children:c.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[c.jsx("div",{className:"h-8 w-64 bg-secondary rounded mb-4"}),c.jsx("div",{className:"h-4 w-48 bg-secondary rounded"})]})}):i?c.jsxs("div",{className:"container py-10",children:[c.jsxs(In,{to:s?"/profile":`/venues/${e}`,className:"inline-flex items-center text-sm text-muted-foreground hover:text-primary mb-6",children:[c.jsx(TM,{className:"mr-2 h-4 w-4"}),s?"Back to Profile":"Back to Venue"]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[c.jsx("div",{className:"lg:col-span-2",children:c.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[c.jsxs("h1",{className:"text-3xl font-bold mb-6 flex items-center",children:[c.jsx(rf,{className:"h-8 w-8 mr-2"}),"Checkout"]}),c.jsxs(Cd,{defaultValue:"single",className:"w-full mb-6",children:[c.jsxs(Wc,{className:"grid w-full grid-cols-2 mb-6",children:[c.jsx(vn,{value:"single",children:"Single Payment"}),c.jsx(vn,{value:"split",children:"Split Payment"})]}),c.jsxs(xn,{value:"single",children:[c.jsx(Jge,{formData:_,errors:N,handleInputChange:pe,handleSubmit:xe,isSubmitting:B,totalAmount:ce(),isAuthenticated:!!o,icons:{user:c.jsx(ji,{className:"h-5 w-5 mr-2"})}}),c.jsx(Et,{type:"submit",disabled:B,className:"w-full bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90 py-3.5 text-lg rounded-md",children:B?c.jsxs("div",{className:"flex items-center justify-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-brand-cream mr-2"}),"Processing..."]}):`Pay ${ce().toLocaleString()}`})]}),c.jsx(xn,{value:"split",children:c.jsx(eye,{totalAmount:parseFloat(ce()),onSplitCreated:ve,user:C||o,bookingId:i==null?void 0:i.id,createBookingIfNeeded:async()=>{var Ge,Pt;if(i!=null&&i.id)return i.id;const Re={user_id:(Ge=C||o)==null?void 0:Ge.id,venue_id:i.venueId||i.id,table_id:((Pt=i.table)==null?void 0:Pt.id)||null,booking_date:i.date||new Date().toISOString().split("T")[0],start_time:i.time||"19:00:00",end_time:i.endTime||"23:00:00",number_of_guests:i.guests||i.guestCount||2,status:"pending",total_amount:parseFloat(ce())},{data:Be,error:Fe}=await Ve.from("bookings").insert([Re]).select().single();if(Fe)throw new Error(`Failed to create booking: ${Fe.message}`);return p($t=>({...$t,id:Be.id})),Be.id}})})]})]})}),c.jsx("div",{children:c.jsx("div",{className:"sticky top-20",children:c.jsx(Qge,{selection:i,totalAmount:ce(),vipPerks:F,icons:{calendar:c.jsx(Lo,{className:"h-5 w-5 mr-2"}),clock:c.jsx(wd,{className:"h-5 w-5 mr-2"})}})})})]}),c.jsx(gd,{open:R,onOpenChange:q,children:c.jsxs(Dc,{className:"sm:max-w-md","aria-describedby":"checkout-dialog-desc",children:[c.jsx("div",{id:"checkout-dialog-desc",className:"sr-only",children:"Enter your payment details to complete your booking."}),c.jsxs(Rc,{children:[c.jsx(Lc,{className:"text-center text-2xl",children:"Booking Confirmed!"}),c.jsxs(h9,{className:"text-center",children:[c.jsx("div",{className:"flex justify-center my-6",children:c.jsx("div",{className:"w-16 h-16 bg-primary/20 rounded-full flex items-center justify-center",children:c.jsx(v1,{className:"h-8 w-8 text-primary"})})}),c.jsxs("p",{className:"mb-2",children:["Your booking at ",c.jsx("span",{className:"font-bold",children:i.venueName})," has been confirmed."]}),F.length>0&&c.jsxs("div",{className:"my-2 text-sm text-green-400",children:[c.jsx("p",{className:"font-semibold",children:"VIP Perks Applied:"}),c.jsx("ul",{className:"list-disc list-inside",children:F.map(Re=>c.jsx("li",{children:Re},Re))})]}),c.jsxs("p",{className:"text-sm",children:["A confirmation email has been sent to ",_.email,". You can show this email or your ID at the entrance."]})]})]}),c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx(In,{to:"/",children:c.jsx(Et,{className:"bg-gradient-to-r from-primary to-accent hover:opacity-90 transition-opacity text-accent-foreground",children:"Back to Home"})})})]})}),c.jsx(gd,{open:G,onOpenChange:ee,children:c.jsxs(Dc,{"aria-describedby":"checkout-dialog-desc-2",children:[c.jsx("div",{id:"checkout-dialog-desc-2",className:"sr-only",children:"View and manage your split payment requests."}),c.jsx(Rc,{children:c.jsx(Lc,{children:"Split Payment Requests Sent"})}),c.jsxs("div",{className:"space-y-4",children:[K.length>0?K.map((Re,Be)=>c.jsxs("div",{className:"border rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-8 h-8 bg-brand-burgundy/10 rounded-full flex items-center justify-center",children:c.jsx(ji,{className:"h-4 w-4 text-brand-burgundy"})}),c.jsxs("div",{children:[c.jsxs("div",{className:"font-medium",children:["Recipient ",Be+1]}),c.jsx("div",{className:"text-sm text-muted-foreground",children:Re.recipient_phone})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"font-bold",children:["",Re.amount.toLocaleString()]}),c.jsx(bn,{variant:"outline",className:"text-xs",children:Re.status})]})]}),c.jsx("div",{className:"flex items-center gap-2 mt-3",children:c.jsxs(Et,{variant:"outline",size:"sm",onClick:()=>ke(Re.payment_link),className:"flex-1",children:[c.jsx(Eie,{className:"h-4 w-4 mr-2"}),"Copy Payment Link"]})})]},Re.id)):c.jsx("div",{className:"text-center py-8 text-muted-foreground",children:c.jsx("p",{children:"No split payment requests created yet."})}),c.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[c.jsx(Et,{variant:"outline",onClick:()=>ee(!1),children:"Close"}),c.jsx(Et,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",onClick:()=>{ee(!1),t("/bookings")},children:"View All Bookings"})]})]})]})})]}):c.jsxs("div",{className:"container py-20 text-center",children:[c.jsx("h2",{className:"text-2xl font-bold mb-4",children:"No Selection Found"}),c.jsx("p",{className:"text-muted-foreground mb-6",children:"Please go back and select a ticket or table first."}),c.jsx(In,{to:`/venues/${e}`,children:c.jsx(Et,{children:"Back to Venue"})})]})};function F1(e){"@babel/helpers - typeof";return F1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F1(e)}function el(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function gi(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function $o(e){gi(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||F1(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Oye(e,t){gi(2,arguments);var r=$o(e),n=el(t);if(isNaN(n))return new Date(NaN);if(!n)return r;var o=r.getDate(),s=new Date(r.getTime());s.setMonth(r.getMonth()+n+1,0);var h=s.getDate();return o>=h?s:(r.setFullYear(s.getFullYear(),s.getMonth(),o),r)}function Dye(e,t){gi(2,arguments);var r=$o(e).getTime(),n=el(t);return new Date(r+n)}var Rye={};function vg(){return Rye}function TC(e,t){var r,n,o,s,h,i,p,y;gi(1,arguments);var b=vg(),_=el((r=(n=(o=(s=t==null?void 0:t.weekStartsOn)!==null&&s!==void 0?s:t==null||(h=t.locale)===null||h===void 0||(i=h.options)===null||i===void 0?void 0:i.weekStartsOn)!==null&&o!==void 0?o:b.weekStartsOn)!==null&&n!==void 0?n:(p=b.locale)===null||p===void 0||(y=p.options)===null||y===void 0?void 0:y.weekStartsOn)!==null&&r!==void 0?r:0);if(!(_>=0&&_<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var E=$o(e),C=E.getDay(),k=(C<_?7:0)+C-_;return E.setDate(E.getDate()-k),E.setHours(0,0,0,0),E}function Lye(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function Bye(e){return gi(1,arguments),e instanceof Date||F1(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function zye(e){if(gi(1,arguments),!Bye(e)&&typeof e!="number")return!1;var t=$o(e);return!isNaN(Number(t))}function lw(e){gi(1,arguments);var t=$o(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function cw(e){gi(1,arguments);var t=$o(e);return t.setDate(1),t.setHours(0,0,0,0),t}function jC(e,t){var r,n,o,s,h,i,p,y;gi(1,arguments);var b=vg(),_=el((r=(n=(o=(s=t==null?void 0:t.weekStartsOn)!==null&&s!==void 0?s:t==null||(h=t.locale)===null||h===void 0||(i=h.options)===null||i===void 0?void 0:i.weekStartsOn)!==null&&o!==void 0?o:b.weekStartsOn)!==null&&n!==void 0?n:(p=b.locale)===null||p===void 0||(y=p.options)===null||y===void 0?void 0:y.weekStartsOn)!==null&&r!==void 0?r:0);if(!(_>=0&&_<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var E=$o(e),C=E.getDay(),k=(C<_?-7:0)+6-(C-_);return E.setDate(E.getDate()+k),E.setHours(23,59,59,999),E}function $ye(e,t){gi(2,arguments);var r=el(t);return Dye(e,-r)}var Fye=864e5;function Uye(e){gi(1,arguments);var t=$o(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var n=t.getTime(),o=r-n;return Math.floor(o/Fye)+1}function U1(e){gi(1,arguments);var t=1,r=$o(e),n=r.getUTCDay(),o=(n<t?7:0)+n-t;return r.setUTCDate(r.getUTCDate()-o),r.setUTCHours(0,0,0,0),r}function F9(e){gi(1,arguments);var t=$o(e),r=t.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var o=U1(n),s=new Date(0);s.setUTCFullYear(r,0,4),s.setUTCHours(0,0,0,0);var h=U1(s);return t.getTime()>=o.getTime()?r+1:t.getTime()>=h.getTime()?r:r-1}function Vye(e){gi(1,arguments);var t=F9(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var n=U1(r);return n}var qye=6048e5;function Wye(e){gi(1,arguments);var t=$o(e),r=U1(t).getTime()-Vye(t).getTime();return Math.round(r/qye)+1}function V1(e,t){var r,n,o,s,h,i,p,y;gi(1,arguments);var b=vg(),_=el((r=(n=(o=(s=t==null?void 0:t.weekStartsOn)!==null&&s!==void 0?s:t==null||(h=t.locale)===null||h===void 0||(i=h.options)===null||i===void 0?void 0:i.weekStartsOn)!==null&&o!==void 0?o:b.weekStartsOn)!==null&&n!==void 0?n:(p=b.locale)===null||p===void 0||(y=p.options)===null||y===void 0?void 0:y.weekStartsOn)!==null&&r!==void 0?r:0);if(!(_>=0&&_<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var E=$o(e),C=E.getUTCDay(),k=(C<_?7:0)+C-_;return E.setUTCDate(E.getUTCDate()-k),E.setUTCHours(0,0,0,0),E}function U9(e,t){var r,n,o,s,h,i,p,y;gi(1,arguments);var b=$o(e),_=b.getUTCFullYear(),E=vg(),C=el((r=(n=(o=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(h=t.locale)===null||h===void 0||(i=h.options)===null||i===void 0?void 0:i.firstWeekContainsDate)!==null&&o!==void 0?o:E.firstWeekContainsDate)!==null&&n!==void 0?n:(p=E.locale)===null||p===void 0||(y=p.options)===null||y===void 0?void 0:y.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(C>=1&&C<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var k=new Date(0);k.setUTCFullYear(_+1,0,C),k.setUTCHours(0,0,0,0);var N=V1(k,t),I=new Date(0);I.setUTCFullYear(_,0,C),I.setUTCHours(0,0,0,0);var B=V1(I,t);return b.getTime()>=N.getTime()?_+1:b.getTime()>=B.getTime()?_:_-1}function Gye(e,t){var r,n,o,s,h,i,p,y;gi(1,arguments);var b=vg(),_=el((r=(n=(o=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(h=t.locale)===null||h===void 0||(i=h.options)===null||i===void 0?void 0:i.firstWeekContainsDate)!==null&&o!==void 0?o:b.firstWeekContainsDate)!==null&&n!==void 0?n:(p=b.locale)===null||p===void 0||(y=p.options)===null||y===void 0?void 0:y.firstWeekContainsDate)!==null&&r!==void 0?r:1),E=U9(e,t),C=new Date(0);C.setUTCFullYear(E,0,_),C.setUTCHours(0,0,0,0);var k=V1(C,t);return k}var Hye=6048e5;function Xye(e,t){gi(1,arguments);var r=$o(e),n=V1(r,t).getTime()-Gye(r,t).getTime();return Math.round(n/Hye)+1}function gn(e,t){for(var r=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return r+n}var Zye={y:function(t,r){var n=t.getUTCFullYear(),o=n>0?n:1-n;return gn(r==="yy"?o%100:o,r.length)},M:function(t,r){var n=t.getUTCMonth();return r==="M"?String(n+1):gn(n+1,2)},d:function(t,r){return gn(t.getUTCDate(),r.length)},a:function(t,r){var n=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(t,r){return gn(t.getUTCHours()%12||12,r.length)},H:function(t,r){return gn(t.getUTCHours(),r.length)},m:function(t,r){return gn(t.getUTCMinutes(),r.length)},s:function(t,r){return gn(t.getUTCSeconds(),r.length)},S:function(t,r){var n=r.length,o=t.getUTCMilliseconds(),s=Math.floor(o*Math.pow(10,n-3));return gn(s,r.length)}};const Au=Zye;var Dp={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Kye={G:function(t,r,n){var o=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(o,{width:"abbreviated"});case"GGGGG":return n.era(o,{width:"narrow"});case"GGGG":default:return n.era(o,{width:"wide"})}},y:function(t,r,n){if(r==="yo"){var o=t.getUTCFullYear(),s=o>0?o:1-o;return n.ordinalNumber(s,{unit:"year"})}return Au.y(t,r)},Y:function(t,r,n,o){var s=U9(t,o),h=s>0?s:1-s;if(r==="YY"){var i=h%100;return gn(i,2)}return r==="Yo"?n.ordinalNumber(h,{unit:"year"}):gn(h,r.length)},R:function(t,r){var n=F9(t);return gn(n,r.length)},u:function(t,r){var n=t.getUTCFullYear();return gn(n,r.length)},Q:function(t,r,n){var o=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(o);case"QQ":return gn(o,2);case"Qo":return n.ordinalNumber(o,{unit:"quarter"});case"QQQ":return n.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(o,{width:"wide",context:"formatting"})}},q:function(t,r,n){var o=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(o);case"qq":return gn(o,2);case"qo":return n.ordinalNumber(o,{unit:"quarter"});case"qqq":return n.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(o,{width:"wide",context:"standalone"})}},M:function(t,r,n){var o=t.getUTCMonth();switch(r){case"M":case"MM":return Au.M(t,r);case"Mo":return n.ordinalNumber(o+1,{unit:"month"});case"MMM":return n.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(o,{width:"wide",context:"formatting"})}},L:function(t,r,n){var o=t.getUTCMonth();switch(r){case"L":return String(o+1);case"LL":return gn(o+1,2);case"Lo":return n.ordinalNumber(o+1,{unit:"month"});case"LLL":return n.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(o,{width:"wide",context:"standalone"})}},w:function(t,r,n,o){var s=Xye(t,o);return r==="wo"?n.ordinalNumber(s,{unit:"week"}):gn(s,r.length)},I:function(t,r,n){var o=Wye(t);return r==="Io"?n.ordinalNumber(o,{unit:"week"}):gn(o,r.length)},d:function(t,r,n){return r==="do"?n.ordinalNumber(t.getUTCDate(),{unit:"date"}):Au.d(t,r)},D:function(t,r,n){var o=Uye(t);return r==="Do"?n.ordinalNumber(o,{unit:"dayOfYear"}):gn(o,r.length)},E:function(t,r,n){var o=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return n.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(o,{width:"short",context:"formatting"});case"EEEE":default:return n.day(o,{width:"wide",context:"formatting"})}},e:function(t,r,n,o){var s=t.getUTCDay(),h=(s-o.weekStartsOn+8)%7||7;switch(r){case"e":return String(h);case"ee":return gn(h,2);case"eo":return n.ordinalNumber(h,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(t,r,n,o){var s=t.getUTCDay(),h=(s-o.weekStartsOn+8)%7||7;switch(r){case"c":return String(h);case"cc":return gn(h,r.length);case"co":return n.ordinalNumber(h,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(t,r,n){var o=t.getUTCDay(),s=o===0?7:o;switch(r){case"i":return String(s);case"ii":return gn(s,r.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(o,{width:"short",context:"formatting"});case"iiii":default:return n.day(o,{width:"wide",context:"formatting"})}},a:function(t,r,n){var o=t.getUTCHours(),s=o/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,r,n){var o=t.getUTCHours(),s;switch(o===12?s=Dp.noon:o===0?s=Dp.midnight:s=o/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,r,n){var o=t.getUTCHours(),s;switch(o>=17?s=Dp.evening:o>=12?s=Dp.afternoon:o>=4?s=Dp.morning:s=Dp.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,r,n){if(r==="ho"){var o=t.getUTCHours()%12;return o===0&&(o=12),n.ordinalNumber(o,{unit:"hour"})}return Au.h(t,r)},H:function(t,r,n){return r==="Ho"?n.ordinalNumber(t.getUTCHours(),{unit:"hour"}):Au.H(t,r)},K:function(t,r,n){var o=t.getUTCHours()%12;return r==="Ko"?n.ordinalNumber(o,{unit:"hour"}):gn(o,r.length)},k:function(t,r,n){var o=t.getUTCHours();return o===0&&(o=24),r==="ko"?n.ordinalNumber(o,{unit:"hour"}):gn(o,r.length)},m:function(t,r,n){return r==="mo"?n.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):Au.m(t,r)},s:function(t,r,n){return r==="so"?n.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):Au.s(t,r)},S:function(t,r){return Au.S(t,r)},X:function(t,r,n,o){var s=o._originalDate||t,h=s.getTimezoneOffset();if(h===0)return"Z";switch(r){case"X":return nz(h);case"XXXX":case"XX":return Mh(h);case"XXXXX":case"XXX":default:return Mh(h,":")}},x:function(t,r,n,o){var s=o._originalDate||t,h=s.getTimezoneOffset();switch(r){case"x":return nz(h);case"xxxx":case"xx":return Mh(h);case"xxxxx":case"xxx":default:return Mh(h,":")}},O:function(t,r,n,o){var s=o._originalDate||t,h=s.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+rz(h,":");case"OOOO":default:return"GMT"+Mh(h,":")}},z:function(t,r,n,o){var s=o._originalDate||t,h=s.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+rz(h,":");case"zzzz":default:return"GMT"+Mh(h,":")}},t:function(t,r,n,o){var s=o._originalDate||t,h=Math.floor(s.getTime()/1e3);return gn(h,r.length)},T:function(t,r,n,o){var s=o._originalDate||t,h=s.getTime();return gn(h,r.length)}};function rz(e,t){var r=e>0?"-":"+",n=Math.abs(e),o=Math.floor(n/60),s=n%60;if(s===0)return r+String(o);var h=t||"";return r+String(o)+h+gn(s,2)}function nz(e,t){if(e%60===0){var r=e>0?"-":"+";return r+gn(Math.abs(e)/60,2)}return Mh(e,t)}function Mh(e,t){var r=t||"",n=e>0?"-":"+",o=Math.abs(e),s=gn(Math.floor(o/60),2),h=gn(o%60,2);return n+s+r+h}const Yye=Kye;var iz=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},V9=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},Jye=function(t,r){var n=t.match(/(P+)(p+)?/)||[],o=n[1],s=n[2];if(!s)return iz(t,r);var h;switch(o){case"P":h=r.dateTime({width:"short"});break;case"PP":h=r.dateTime({width:"medium"});break;case"PPP":h=r.dateTime({width:"long"});break;case"PPPP":default:h=r.dateTime({width:"full"});break}return h.replace("{{date}}",iz(o,r)).replace("{{time}}",V9(s,r))},Qye={p:V9,P:Jye};const eve=Qye;var tve=["D","DD"],rve=["YY","YYYY"];function nve(e){return tve.indexOf(e)!==-1}function ive(e){return rve.indexOf(e)!==-1}function oz(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var ove={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ave=function(t,r,n){var o,s=ove[t];return typeof s=="string"?o=s:r===1?o=s.one:o=s.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+o:o+" ago":o};const sve=ave;function CC(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,n=e.formats[r]||e.formats[e.defaultWidth];return n}}var lve={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},cve={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},uve={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},dve={date:CC({formats:lve,defaultWidth:"full"}),time:CC({formats:cve,defaultWidth:"full"}),dateTime:CC({formats:uve,defaultWidth:"full"})};const hve=dve;var fve={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},pve=function(t,r,n,o){return fve[t]};const mve=pve;function wv(e){return function(t,r){var n=r!=null&&r.context?String(r.context):"standalone",o;if(n==="formatting"&&e.formattingValues){var s=e.defaultFormattingWidth||e.defaultWidth,h=r!=null&&r.width?String(r.width):s;o=e.formattingValues[h]||e.formattingValues[s]}else{var i=e.defaultWidth,p=r!=null&&r.width?String(r.width):e.defaultWidth;o=e.values[p]||e.values[i]}var y=e.argumentCallback?e.argumentCallback(t):t;return o[y]}}var gve={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},yve={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},vve={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},xve={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},bve={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},_ve={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},wve=function(t,r){var n=Number(t),o=n%100;if(o>20||o<10)switch(o%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Sve={ordinalNumber:wve,era:wv({values:gve,defaultWidth:"wide"}),quarter:wv({values:yve,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:wv({values:vve,defaultWidth:"wide"}),day:wv({values:xve,defaultWidth:"wide"}),dayPeriod:wv({values:bve,defaultWidth:"wide",formattingValues:_ve,defaultFormattingWidth:"wide"})};const Eve=Sve;function Sv(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,o=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(o);if(!s)return null;var h=s[0],i=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],p=Array.isArray(i)?jve(i,function(_){return _.test(h)}):Tve(i,function(_){return _.test(h)}),y;y=e.valueCallback?e.valueCallback(p):p,y=r.valueCallback?r.valueCallback(y):y;var b=t.slice(h.length);return{value:y,rest:b}}}function Tve(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function jve(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function Cve(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var o=n[0],s=t.match(e.parsePattern);if(!s)return null;var h=e.valueCallback?e.valueCallback(s[0]):s[0];h=r.valueCallback?r.valueCallback(h):h;var i=t.slice(o.length);return{value:h,rest:i}}}var Pve=/^(\d+)(th|st|nd|rd)?/i,Ave=/\d+/i,kve={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Nve={any:[/^b/i,/^(a|c)/i]},Mve={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ive={any:[/1/i,/2/i,/3/i,/4/i]},Ove={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Dve={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Rve={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Lve={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Bve={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},zve={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},$ve={ordinalNumber:Cve({matchPattern:Pve,parsePattern:Ave,valueCallback:function(t){return parseInt(t,10)}}),era:Sv({matchPatterns:kve,defaultMatchWidth:"wide",parsePatterns:Nve,defaultParseWidth:"any"}),quarter:Sv({matchPatterns:Mve,defaultMatchWidth:"wide",parsePatterns:Ive,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Sv({matchPatterns:Ove,defaultMatchWidth:"wide",parsePatterns:Dve,defaultParseWidth:"any"}),day:Sv({matchPatterns:Rve,defaultMatchWidth:"wide",parsePatterns:Lve,defaultParseWidth:"any"}),dayPeriod:Sv({matchPatterns:Bve,defaultMatchWidth:"any",parsePatterns:zve,defaultParseWidth:"any"})};const Fve=$ve;var Uve={code:"en-US",formatDistance:sve,formatLong:hve,formatRelative:mve,localize:Eve,match:Fve,options:{weekStartsOn:0,firstWeekContainsDate:1}};const Vve=Uve;var qve=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Wve=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Gve=/^'([^]*?)'?$/,Hve=/''/g,Xve=/[a-zA-Z]/;function q1(e,t,r){var n,o,s,h,i,p,y,b,_,E,C,k,N,I,B,O,R,q;gi(2,arguments);var F=String(t),X=vg(),G=(n=(o=r==null?void 0:r.locale)!==null&&o!==void 0?o:X.locale)!==null&&n!==void 0?n:Vve,ee=el((s=(h=(i=(p=r==null?void 0:r.firstWeekContainsDate)!==null&&p!==void 0?p:r==null||(y=r.locale)===null||y===void 0||(b=y.options)===null||b===void 0?void 0:b.firstWeekContainsDate)!==null&&i!==void 0?i:X.firstWeekContainsDate)!==null&&h!==void 0?h:(_=X.locale)===null||_===void 0||(E=_.options)===null||E===void 0?void 0:E.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(ee>=1&&ee<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var K=el((C=(k=(N=(I=r==null?void 0:r.weekStartsOn)!==null&&I!==void 0?I:r==null||(B=r.locale)===null||B===void 0||(O=B.options)===null||O===void 0?void 0:O.weekStartsOn)!==null&&N!==void 0?N:X.weekStartsOn)!==null&&k!==void 0?k:(R=X.locale)===null||R===void 0||(q=R.options)===null||q===void 0?void 0:q.weekStartsOn)!==null&&C!==void 0?C:0);if(!(K>=0&&K<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!G.localize)throw new RangeError("locale must contain localize property");if(!G.formatLong)throw new RangeError("locale must contain formatLong property");var ie=$o(e);if(!zye(ie))throw new RangeError("Invalid time value");var pe=Lye(ie),ae=$ye(ie,pe),_e={firstWeekContainsDate:ee,weekStartsOn:K,locale:G,_originalDate:ie},Ee=F.match(Wve).map(function(xe){var ce=xe[0];if(ce==="p"||ce==="P"){var ke=eve[ce];return ke(xe,G.formatLong)}return xe}).join("").match(qve).map(function(xe){if(xe==="''")return"'";var ce=xe[0];if(ce==="'")return Zve(xe);var ke=Yye[ce];if(ke)return!(r!=null&&r.useAdditionalWeekYearTokens)&&ive(xe)&&oz(xe,t,String(e)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&nve(xe)&&oz(xe,t,String(e)),ke(ae,xe,G.localize,_e);if(ce.match(Xve))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ce+"`");return xe}).join("");return Ee}function Zve(e){var t=e.match(Gve);return t?t[1].replace(Hve,"'"):e}function Eh(e,t){gi(2,arguments);var r=el(t);return Oye(e,-r)}const q9=je.forwardRef(({className:e,...t},r)=>c.jsx("div",{className:"relative w-full overflow-auto",children:c.jsx("table",{ref:r,className:Cr("w-full caption-bottom text-sm",e),...t})}));q9.displayName="Table";const W9=je.forwardRef(({className:e,...t},r)=>c.jsx("thead",{ref:r,className:Cr("[&_tr]:border-b",e),...t}));W9.displayName="TableHeader";const G9=je.forwardRef(({className:e,...t},r)=>c.jsx("tbody",{ref:r,className:Cr("[&_tr:last-child]:border-0",e),...t}));G9.displayName="TableBody";const Kve=je.forwardRef(({className:e,...t},r)=>c.jsx("tfoot",{ref:r,className:Cr("bg-primary font-medium text-primary-foreground",e),...t}));Kve.displayName="TableFooter";const WA=je.forwardRef(({className:e,...t},r)=>c.jsx("tr",{ref:r,className:Cr("border-b border-border/50 transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));WA.displayName="TableRow";const Ou=je.forwardRef(({className:e,...t},r)=>c.jsx("th",{ref:r,className:Cr("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Ou.displayName="TableHead";const Du=je.forwardRef(({className:e,...t},r)=>c.jsx("td",{ref:r,className:Cr("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Du.displayName="TableCell";const Yve=je.forwardRef(({className:e,...t},r)=>c.jsx("caption",{ref:r,className:Cr("mt-4 text-sm text-muted-foreground",e),...t}));Yve.displayName="TableCaption";const H9=({currentUser:e})=>{const[t,r]=D.useState([]),[n,o]=D.useState(!0),s=D.useRef(null);D.useEffect(()=>(e&&p(),()=>{h()}),[e]);const h=()=>{s.current&&(console.log("Cleaning up BookingList real-time subscription..."),s.current.unsubscribe(),s.current=null)},i=async E=>{if(h(),!E||E.length===0){console.log("No venue IDs provided for BookingList subscription");return}console.log("Setting up BookingList real-time subscription for venues:",E);try{s.current=Ve.channel("booking-list-changes").on("postgres_changes",{event:"*",schema:"public",table:"bookings",filter:`venue_id=in.(${E.join(",")})`},C=>{console.log("Real-time booking change detected in BookingList:",C),C.eventType==="INSERT"&&Mr({title:"New Booking Received!",description:"A new booking has been received",className:"bg-green-50 border-green-200"}),setTimeout(()=>{p(!0)},1e3)}).subscribe(C=>{console.log("BookingList subscription status:",C),C==="SUBSCRIBED"&&console.log("Successfully subscribed to BookingList real-time updates")})}catch(C){console.error("Error setting up BookingList real-time subscription:",C)}},p=async(E=!1)=>{try{E||o(!0);const{data:C,error:k}=await Ve.from("venues").select("id").eq("owner_id",e.id);if(k)throw k;if(!C||C.length===0){r([]),E||o(!1);return}const N=C.map(F=>F.id);s.current||await i(N);const{data:I,error:B}=await Ve.from("bookings").select(`
          *,
          venues (
            id,
            name
          ),
          venue_tables!table_id (
            id,
            table_number
          )
        `).in("venue_id",N).order("created_at",{ascending:!1});if(B)throw B;const O=(I==null?void 0:I.map(F=>F.user_id).filter(Boolean))||[];let R={};if(O.length>0){const{data:F}=await Ve.from("user_profiles").select("id, first_name, last_name").in("id",O);F==null||F.forEach(X=>{R[X.id]=X})}const q=(I==null?void 0:I.map(F=>({...F,user_profiles:R[F.user_id]||null})))||[];r(q)}catch(C){console.error("Error fetching bookings:",C),E||Mr({title:"Error",description:"Failed to load bookings",variant:"destructive"})}finally{E||o(!1)}},y=async(E,C)=>{try{const{error:k}=await Ve.from("bookings").update({status:C,updated_at:new Date().toISOString()}).eq("id",E);if(k)throw k;r(N=>N.map(I=>I.id===E?{...I,status:C}:I)),Mr({title:"Success",description:`Booking ${C} successfully`,className:"bg-green-500 text-white"})}catch(k){console.error("Error updating booking status:",k),Mr({title:"Error",description:"Failed to update booking status",variant:"destructive"})}},b=E=>{switch(E){case"confirmed":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"completed":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},_=E=>E.user_profiles?`${E.user_profiles.first_name||""} ${E.user_profiles.last_name||""}`.trim():E.customerName||"Unknown Customer";return n?c.jsx("div",{className:"flex items-center justify-center p-8",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-gold"})}):t.length?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy",children:"Recent Bookings"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Et,{variant:"outline",size:"sm",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",onClick:p,children:"Refresh"}),c.jsx(Et,{size:"sm",className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"New Booking"})]})]}),c.jsxs(q9,{children:[c.jsx(W9,{children:c.jsxs(WA,{children:[c.jsx(Ou,{children:"Customer"}),c.jsx(Ou,{children:"Date & Time"}),c.jsx(Ou,{children:"Table"}),c.jsx(Ou,{children:"Guests"}),c.jsx(Ou,{children:"Amount"}),c.jsx(Ou,{children:"Status"}),c.jsx(Ou,{children:"Actions"})]})}),c.jsx(G9,{children:t.map(E=>{var C;return c.jsxs(WA,{children:[c.jsx(Du,{className:"font-medium",children:_(E)}),c.jsx(Du,{children:c.jsxs("div",{children:[c.jsx("div",{children:q1(new Date(E.booking_date),"MMM d, yyyy")}),c.jsxs("div",{className:"text-sm text-brand-burgundy/60",children:[E.start_time," - ",E.end_time]})]})}),c.jsx(Du,{children:(C=E.venue_tables)!=null&&C.table_number?`Table ${E.venue_tables.table_number}`:"No table assigned"}),c.jsx(Du,{children:E.number_of_guests}),c.jsxs(Du,{children:["",(E.total_amount||0).toLocaleString()]}),c.jsx(Du,{children:c.jsx(bn,{className:b(E.status),children:E.status})}),c.jsx(Du,{children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Et,{variant:"ghost",size:"icon",className:"h-8 w-8",children:c.jsx(x1,{className:"h-4 w-4"})}),E.status==="pending"&&c.jsxs(c.Fragment,{children:[c.jsx(Et,{variant:"ghost",size:"icon",className:"h-8 w-8 text-green-600 hover:text-green-700",onClick:()=>y(E.id,"confirmed"),children:c.jsx(v1,{className:"h-4 w-4"})}),c.jsx(Et,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-600 hover:text-red-700",onClick:()=>y(E.id,"cancelled"),children:c.jsx(Ib,{className:"h-4 w-4"})})]}),E.status==="confirmed"&&c.jsx(Et,{variant:"ghost",size:"icon",className:"h-8 w-8 text-blue-600 hover:text-blue-700",onClick:()=>y(E.id,"completed"),title:"Mark as completed",children:c.jsx(v1,{className:"h-4 w-4"})})]})})]},E.id)})})]})]}):c.jsx("div",{className:"text-center p-8",children:c.jsx("p",{className:"text-brand-burgundy/70",children:"No bookings found."})})},Jve=({currentUser:e})=>{const[t,r]=D.useState(null),[n,o]=D.useState([]),[s,h]=D.useState(!1),[i,p]=D.useState(!0),[y,b]=D.useState(!1);D.useEffect(()=>{e&&_()},[e]);const _=async()=>{try{p(!0);const{data:O,error:R}=await Ve.from("venues").select("*").eq("owner_id",e.id).single();if(R){console.error("Error fetching venue:",R);return}r(O);const{data:q,error:F}=await Ve.from("venue_images").select("*").eq("venue_id",O.id).order("is_primary",{ascending:!1}).order("created_at",{ascending:!1});if(F){console.error("Error fetching images:",F);return}o(q||[])}catch(O){console.error("Error in fetchVenueAndImages:",O),Mr({title:"Error",description:"Failed to load venue images",variant:"destructive"})}finally{p(!1)}},E=async O=>{if(!(!t||!O))try{if(h(!0),!O.type.startsWith("image/"))throw new Error("Please select an image file");if(O.size>5*1024*1024)throw new Error("Image must be less than 5MB");const R=O.name.split(".").pop(),q=`${t.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${R}`,{data:F,error:X}=await Ve.storage.from("venue-images").upload(q,O,{cacheControl:"3600",upsert:!1});if(X)throw X;const{data:{publicUrl:G}}=Ve.storage.from("venue-images").getPublicUrl(q),{data:ee,error:K}=await Ve.from("venue_images").insert([{venue_id:t.id,image_url:G,is_primary:n.length===0}]).select().single();if(K)throw K;o(ie=>[ee,...ie]),Mr({title:"Success",description:"Image uploaded successfully!",className:"bg-green-500 text-white"})}catch(R){console.error("Error uploading image:",R),Mr({title:"Error",description:R.message||"Failed to upload image. Please try again.",variant:"destructive"})}finally{h(!1)}},C=async(O,R)=>{try{const q=R.split("/"),F=q[q.length-1],X=`${t.id}/${F}`,{error:G}=await Ve.storage.from("venue-images").remove([X]);G&&console.error("Storage deletion error:",G);const{error:ee}=await Ve.from("venue_images").delete().eq("id",O);if(ee)throw ee;o(K=>K.filter(ie=>ie.id!==O)),Mr({title:"Success",description:"Image deleted successfully!",className:"bg-green-500 text-white"})}catch(q){console.error("Error deleting image:",q),Mr({title:"Error",description:"Failed to delete image. Please try again.",variant:"destructive"})}},k=async O=>{try{const{error:R}=await Ve.from("venue_images").update({is_primary:!1}).eq("venue_id",t.id);if(R)throw R;const{error:q}=await Ve.from("venue_images").update({is_primary:!0}).eq("id",O);if(q)throw q;o(F=>F.map(X=>({...X,is_primary:X.id===O}))),Mr({title:"Success",description:"Primary image updated!",className:"bg-green-500 text-white"})}catch(R){console.error("Error setting primary image:",R),Mr({title:"Error",description:"Failed to update primary image. Please try again.",variant:"destructive"})}},N=O=>{O.preventDefault(),O.stopPropagation(),O.type==="dragenter"||O.type==="dragover"?b(!0):O.type==="dragleave"&&b(!1)},I=O=>{O.preventDefault(),O.stopPropagation(),b(!1),O.dataTransfer.files&&O.dataTransfer.files[0]&&E(O.dataTransfer.files[0])},B=O=>{O.target.files&&O.target.files[0]&&E(O.target.files[0])};return i?c.jsx("div",{className:"flex items-center justify-center p-8",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-gold"})}):t?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-heading text-brand-burgundy",children:"Venue Images"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Upload and manage photos of your venue"})]}),c.jsxs("div",{className:"text-sm text-brand-burgundy/60",children:[n.length," image",n.length!==1?"s":""," uploaded"]})]}),c.jsx(kt,{className:`border-2 border-dashed transition-colors ${y?"border-brand-gold bg-brand-gold/10":"border-brand-burgundy/20 hover:border-brand-gold/50"}`,children:c.jsx(rr,{className:"p-8",children:c.jsxs("div",{className:"text-center",onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:I,children:[c.jsx($ie,{className:"h-12 w-12 mx-auto mb-4 text-brand-burgundy/40"}),c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"Upload Venue Images"}),c.jsx("p",{className:"text-brand-burgundy/70 mb-4",children:"Drag and drop images here, or click to select files from your device"}),c.jsx("p",{className:"text-sm text-brand-burgundy/50 mb-4",children:"Supports JPG, PNG, WebP  Max 5MB per image"}),c.jsx(Xt,{type:"file",accept:"image/*",onChange:B,className:"hidden",id:"image-upload",disabled:s}),c.jsx(qt,{htmlFor:"image-upload",children:c.jsx(Et,{variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",disabled:s,asChild:!0,children:c.jsx("span",{children:s?"Uploading...":"Choose Images"})})})]})})}),n.length>0&&c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(O=>c.jsx(kt,{className:"overflow-hidden",children:c.jsxs("div",{className:"relative aspect-video",children:[c.jsx("img",{src:O.image_url,alt:"Venue",className:"w-full h-full object-cover",onError:R=>{R.target.style.display="none",R.target.nextSibling.style.display="flex"}}),c.jsx("div",{className:"absolute inset-0 bg-gray-200 flex items-center justify-center text-gray-500 hidden",children:c.jsxs("div",{className:"text-center",children:[c.jsx(sA,{className:"h-8 w-8 mx-auto mb-2"}),c.jsx("p",{className:"text-sm",children:"Image failed to load"})]})}),O.is_primary&&c.jsx("div",{className:"absolute top-2 left-2",children:c.jsx("span",{className:"bg-brand-gold text-brand-burgundy px-2 py-1 rounded text-xs font-semibold",children:"Primary"})}),c.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[c.jsx(Et,{size:"sm",variant:"secondary",className:"h-8 w-8 p-0 bg-white/80 hover:bg-white",onClick:()=>k(O.id),disabled:O.is_primary,children:O.is_primary?c.jsx(sa,{className:"h-4 w-4 text-brand-gold fill-current"}):c.jsx(Lie,{className:"h-4 w-4 text-brand-burgundy/60"})}),c.jsxs(gd,{children:[c.jsx(u9,{asChild:!0,children:c.jsx(Et,{size:"sm",variant:"destructive",className:"h-8 w-8 p-0 bg-red-500/80 hover:bg-red-500",children:c.jsx(PM,{className:"h-4 w-4"})})}),c.jsxs(Dc,{children:[c.jsx(Rc,{children:c.jsx(Lc,{children:"Delete Image"})}),c.jsx("p",{className:"text-brand-burgundy/70 mb-4",children:"Are you sure you want to delete this image? This action cannot be undone."}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(Et,{variant:"outline",children:"Cancel"}),c.jsx(Et,{variant:"destructive",onClick:()=>C(O.id,O.image_url),children:"Delete"})]})]})]})]})]})},O.id))}),n.length===0&&c.jsxs(kt,{className:"text-center p-8",children:[c.jsx(sA,{className:"h-16 w-16 mx-auto mb-4 text-brand-burgundy/30"}),c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"No Images Yet"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Upload your first venue image using the area above"})]})]}):c.jsx("div",{className:"text-center p-8",children:c.jsx("p",{className:"text-brand-burgundy/70",children:"No venue found for your account."})})};var Qve=Array.isArray,ua=Qve,exe=typeof no=="object"&&no&&no.Object===Object&&no,X9=exe,txe=X9,rxe=typeof self=="object"&&self&&self.Object===Object&&self,nxe=txe||rxe||Function("return this")(),Rl=nxe,ixe=Rl,oxe=ixe.Symbol,Wb=oxe,az=Wb,Z9=Object.prototype,axe=Z9.hasOwnProperty,sxe=Z9.toString,Ev=az?az.toStringTag:void 0;function lxe(e){var t=axe.call(e,Ev),r=e[Ev];try{e[Ev]=void 0;var n=!0}catch{}var o=sxe.call(e);return n&&(t?e[Ev]=r:delete e[Ev]),o}var cxe=lxe,uxe=Object.prototype,dxe=uxe.toString;function hxe(e){return dxe.call(e)}var fxe=hxe,sz=Wb,pxe=cxe,mxe=fxe,gxe="[object Null]",yxe="[object Undefined]",lz=sz?sz.toStringTag:void 0;function vxe(e){return e==null?e===void 0?yxe:gxe:lz&&lz in Object(e)?pxe(e):mxe(e)}var Gc=vxe;function xxe(e){return e!=null&&typeof e=="object"}var Hc=xxe,bxe=Gc,_xe=Hc,wxe="[object Symbol]";function Sxe(e){return typeof e=="symbol"||_xe(e)&&bxe(e)==wxe}var xg=Sxe,Exe=ua,Txe=xg,jxe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Cxe=/^\w*$/;function Pxe(e,t){if(Exe(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Txe(e)?!0:Cxe.test(e)||!jxe.test(e)||t!=null&&e in Object(t)}var II=Pxe;function Axe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Pd=Axe;const bg=wn(Pd);var kxe=Gc,Nxe=Pd,Mxe="[object AsyncFunction]",Ixe="[object Function]",Oxe="[object GeneratorFunction]",Dxe="[object Proxy]";function Rxe(e){if(!Nxe(e))return!1;var t=kxe(e);return t==Ixe||t==Oxe||t==Mxe||t==Dxe}var OI=Rxe;const Nr=wn(OI);var Lxe=Rl,Bxe=Lxe["__core-js_shared__"],zxe=Bxe,PC=zxe,cz=function(){var e=/[^.]+$/.exec(PC&&PC.keys&&PC.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function $xe(e){return!!cz&&cz in e}var Fxe=$xe,Uxe=Function.prototype,Vxe=Uxe.toString;function qxe(e){if(e!=null){try{return Vxe.call(e)}catch{}try{return e+""}catch{}}return""}var K9=qxe,Wxe=OI,Gxe=Fxe,Hxe=Pd,Xxe=K9,Zxe=/[\\^$.*+?()[\]{}|]/g,Kxe=/^\[object .+?Constructor\]$/,Yxe=Function.prototype,Jxe=Object.prototype,Qxe=Yxe.toString,ebe=Jxe.hasOwnProperty,tbe=RegExp("^"+Qxe.call(ebe).replace(Zxe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function rbe(e){if(!Hxe(e)||Gxe(e))return!1;var t=Wxe(e)?tbe:Kxe;return t.test(Xxe(e))}var nbe=rbe;function ibe(e,t){return e==null?void 0:e[t]}var obe=ibe,abe=nbe,sbe=obe;function lbe(e,t){var r=sbe(e,t);return abe(r)?r:void 0}var Sf=lbe,cbe=Sf,ube=cbe(Object,"create"),X2=ube,uz=X2;function dbe(){this.__data__=uz?uz(null):{},this.size=0}var hbe=dbe;function fbe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var pbe=fbe,mbe=X2,gbe="__lodash_hash_undefined__",ybe=Object.prototype,vbe=ybe.hasOwnProperty;function xbe(e){var t=this.__data__;if(mbe){var r=t[e];return r===gbe?void 0:r}return vbe.call(t,e)?t[e]:void 0}var bbe=xbe,_be=X2,wbe=Object.prototype,Sbe=wbe.hasOwnProperty;function Ebe(e){var t=this.__data__;return _be?t[e]!==void 0:Sbe.call(t,e)}var Tbe=Ebe,jbe=X2,Cbe="__lodash_hash_undefined__";function Pbe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=jbe&&t===void 0?Cbe:t,this}var Abe=Pbe,kbe=hbe,Nbe=pbe,Mbe=bbe,Ibe=Tbe,Obe=Abe;function _g(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}_g.prototype.clear=kbe;_g.prototype.delete=Nbe;_g.prototype.get=Mbe;_g.prototype.has=Ibe;_g.prototype.set=Obe;var Dbe=_g;function Rbe(){this.__data__=[],this.size=0}var Lbe=Rbe;function Bbe(e,t){return e===t||e!==e&&t!==t}var DI=Bbe,zbe=DI;function $be(e,t){for(var r=e.length;r--;)if(zbe(e[r][0],t))return r;return-1}var Z2=$be,Fbe=Z2,Ube=Array.prototype,Vbe=Ube.splice;function qbe(e){var t=this.__data__,r=Fbe(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Vbe.call(t,r,1),--this.size,!0}var Wbe=qbe,Gbe=Z2;function Hbe(e){var t=this.__data__,r=Gbe(t,e);return r<0?void 0:t[r][1]}var Xbe=Hbe,Zbe=Z2;function Kbe(e){return Zbe(this.__data__,e)>-1}var Ybe=Kbe,Jbe=Z2;function Qbe(e,t){var r=this.__data__,n=Jbe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var e0e=Qbe,t0e=Lbe,r0e=Wbe,n0e=Xbe,i0e=Ybe,o0e=e0e;function wg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}wg.prototype.clear=t0e;wg.prototype.delete=r0e;wg.prototype.get=n0e;wg.prototype.has=i0e;wg.prototype.set=o0e;var K2=wg,a0e=Sf,s0e=Rl,l0e=a0e(s0e,"Map"),RI=l0e,dz=Dbe,c0e=K2,u0e=RI;function d0e(){this.size=0,this.__data__={hash:new dz,map:new(u0e||c0e),string:new dz}}var h0e=d0e;function f0e(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var p0e=f0e,m0e=p0e;function g0e(e,t){var r=e.__data__;return m0e(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Y2=g0e,y0e=Y2;function v0e(e){var t=y0e(this,e).delete(e);return this.size-=t?1:0,t}var x0e=v0e,b0e=Y2;function _0e(e){return b0e(this,e).get(e)}var w0e=_0e,S0e=Y2;function E0e(e){return S0e(this,e).has(e)}var T0e=E0e,j0e=Y2;function C0e(e,t){var r=j0e(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var P0e=C0e,A0e=h0e,k0e=x0e,N0e=w0e,M0e=T0e,I0e=P0e;function Sg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Sg.prototype.clear=A0e;Sg.prototype.delete=k0e;Sg.prototype.get=N0e;Sg.prototype.has=M0e;Sg.prototype.set=I0e;var LI=Sg,Y9=LI,O0e="Expected a function";function BI(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(O0e);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],s=r.cache;if(s.has(o))return s.get(o);var h=e.apply(this,n);return r.cache=s.set(o,h)||s,h};return r.cache=new(BI.Cache||Y9),r}BI.Cache=Y9;var J9=BI;const D0e=wn(J9);var R0e=J9,L0e=500;function B0e(e){var t=R0e(e,function(n){return r.size===L0e&&r.clear(),n}),r=t.cache;return t}var z0e=B0e,$0e=z0e,F0e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,U0e=/\\(\\)?/g,V0e=$0e(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(F0e,function(r,n,o,s){t.push(o?s.replace(U0e,"$1"):n||r)}),t}),q0e=V0e;function W0e(e,t){for(var r=-1,n=e==null?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var zI=W0e,hz=Wb,G0e=zI,H0e=ua,X0e=xg,Z0e=1/0,fz=hz?hz.prototype:void 0,pz=fz?fz.toString:void 0;function Q9(e){if(typeof e=="string")return e;if(H0e(e))return G0e(e,Q9)+"";if(X0e(e))return pz?pz.call(e):"";var t=e+"";return t=="0"&&1/e==-Z0e?"-0":t}var K0e=Q9,Y0e=K0e;function J0e(e){return e==null?"":Y0e(e)}var eH=J0e,Q0e=ua,e_e=II,t_e=q0e,r_e=eH;function n_e(e,t){return Q0e(e)?e:e_e(e,t)?[e]:t_e(r_e(e))}var tH=n_e,i_e=xg,o_e=1/0;function a_e(e){if(typeof e=="string"||i_e(e))return e;var t=e+"";return t=="0"&&1/e==-o_e?"-0":t}var J2=a_e,s_e=tH,l_e=J2;function c_e(e,t){t=s_e(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[l_e(t[r++])];return r&&r==n?e:void 0}var $I=c_e,u_e=$I;function d_e(e,t,r){var n=e==null?void 0:u_e(e,t);return n===void 0?r:n}var rH=d_e;const ts=wn(rH);function h_e(e){return e==null}var f_e=h_e;const Wr=wn(f_e);var p_e=Gc,m_e=ua,g_e=Hc,y_e="[object String]";function v_e(e){return typeof e=="string"||!m_e(e)&&g_e(e)&&p_e(e)==y_e}var x_e=v_e;const uf=wn(x_e);var nH={exports:{}},Sn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FI=Symbol.for("react.element"),UI=Symbol.for("react.portal"),Q2=Symbol.for("react.fragment"),eE=Symbol.for("react.strict_mode"),tE=Symbol.for("react.profiler"),rE=Symbol.for("react.provider"),nE=Symbol.for("react.context"),b_e=Symbol.for("react.server_context"),iE=Symbol.for("react.forward_ref"),oE=Symbol.for("react.suspense"),aE=Symbol.for("react.suspense_list"),sE=Symbol.for("react.memo"),lE=Symbol.for("react.lazy"),__e=Symbol.for("react.offscreen"),iH;iH=Symbol.for("react.module.reference");function ss(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case FI:switch(e=e.type,e){case Q2:case tE:case eE:case oE:case aE:return e;default:switch(e=e&&e.$$typeof,e){case b_e:case nE:case iE:case lE:case sE:case rE:return e;default:return t}}case UI:return t}}}Sn.ContextConsumer=nE;Sn.ContextProvider=rE;Sn.Element=FI;Sn.ForwardRef=iE;Sn.Fragment=Q2;Sn.Lazy=lE;Sn.Memo=sE;Sn.Portal=UI;Sn.Profiler=tE;Sn.StrictMode=eE;Sn.Suspense=oE;Sn.SuspenseList=aE;Sn.isAsyncMode=function(){return!1};Sn.isConcurrentMode=function(){return!1};Sn.isContextConsumer=function(e){return ss(e)===nE};Sn.isContextProvider=function(e){return ss(e)===rE};Sn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===FI};Sn.isForwardRef=function(e){return ss(e)===iE};Sn.isFragment=function(e){return ss(e)===Q2};Sn.isLazy=function(e){return ss(e)===lE};Sn.isMemo=function(e){return ss(e)===sE};Sn.isPortal=function(e){return ss(e)===UI};Sn.isProfiler=function(e){return ss(e)===tE};Sn.isStrictMode=function(e){return ss(e)===eE};Sn.isSuspense=function(e){return ss(e)===oE};Sn.isSuspenseList=function(e){return ss(e)===aE};Sn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Q2||e===tE||e===eE||e===oE||e===aE||e===__e||typeof e=="object"&&e!==null&&(e.$$typeof===lE||e.$$typeof===sE||e.$$typeof===rE||e.$$typeof===nE||e.$$typeof===iE||e.$$typeof===iH||e.getModuleId!==void 0)};Sn.typeOf=ss;nH.exports=Sn;var w_e=nH.exports,S_e=Gc,E_e=Hc,T_e="[object Number]";function j_e(e){return typeof e=="number"||E_e(e)&&S_e(e)==T_e}var oH=j_e;const C_e=wn(oH);var P_e=oH;function A_e(e){return P_e(e)&&e!=+e}var k_e=A_e;const Gb=wn(k_e);var Ws=function(t){return t===0?0:t>0?1:-1},Uh=function(t){return uf(t)&&t.indexOf("%")===t.length-1},Ft=function(t){return C_e(t)&&!Gb(t)},Li=function(t){return Ft(t)||uf(t)},N_e=0,Hb=function(t){var r=++N_e;return"".concat(t||"").concat(r)},df=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ft(t)&&!uf(t))return n;var s;if(Uh(t)){var h=t.indexOf("%");s=r*parseFloat(t.slice(0,h))/100}else s=+t;return Gb(s)&&(s=n),o&&s>r&&(s=r),s},Wu=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},M_e=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},o=0;o<r;o++)if(!n[t[o]])n[t[o]]=!0;else return!0;return!1},Us=function(t,r){return Ft(t)&&Ft(r)?function(n){return t+n*(r-t)}:function(){return r}};function W1(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):ts(n,t))===r})}var I_e=function(t,r){return Ft(t)&&Ft(r)?t-r:uf(t)&&uf(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function pm(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function GA(e){"@babel/helpers - typeof";return GA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},GA(e)}var O_e=["viewBox","children"],D_e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],mz=["points","pathLength"],AC={svg:O_e,polygon:mz,polyline:mz},VI=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],G1=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(D.isValidElement(t)&&(n=t.props),!bg(n))return null;var o={};return Object.keys(n).forEach(function(s){VI.includes(s)&&(o[s]=r||function(h){return n[s](n,h)})}),o},R_e=function(t,r,n){return function(o){return t(r,n,o),null}},H1=function(t,r,n){if(!bg(t)||GA(t)!=="object")return null;var o=null;return Object.keys(t).forEach(function(s){var h=t[s];VI.includes(s)&&typeof h=="function"&&(o||(o={}),o[s]=R_e(h,r,n))}),o},L_e=["children"],B_e=["children"];function gz(e,t){if(e==null)return{};var r=z_e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function z_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function HA(e){"@babel/helpers - typeof";return HA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HA(e)}var yz={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Sc=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},vz=null,kC=null,qI=function e(t){if(t===vz&&Array.isArray(kC))return kC;var r=[];return D.Children.forEach(t,function(n){Wr(n)||(w_e.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),kC=r,vz=t,r};function rs(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(o){return Sc(o)}):n=[Sc(t)],qI(e).forEach(function(o){var s=ts(o,"type.displayName")||ts(o,"type.name");n.indexOf(s)!==-1&&r.push(o)}),r}function _a(e,t){var r=rs(e,t);return r&&r[0]}var xz=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,o=r.height;return!(!Ft(n)||n<=0||!Ft(o)||o<=0)},$_e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],F_e=function(t){return t&&t.type&&uf(t.type)&&$_e.indexOf(t.type)>=0},U_e=function(t){return t&&HA(t)==="object"&&"clipDot"in t},V_e=function(t,r,n,o){var s,h=(s=AC==null?void 0:AC[o])!==null&&s!==void 0?s:[];return r.startsWith("data-")||!Nr(t)&&(o&&h.includes(r)||D_e.includes(r))||n&&VI.includes(r)},Xr=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var o=t;if(D.isValidElement(t)&&(o=t.props),!bg(o))return null;var s={};return Object.keys(o).forEach(function(h){var i;V_e((i=o)===null||i===void 0?void 0:i[h],h,r,n)&&(s[h]=o[h])}),s},XA=function e(t,r){if(t===r)return!0;var n=D.Children.count(t);if(n!==D.Children.count(r))return!1;if(n===0)return!0;if(n===1)return bz(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var o=0;o<n;o++){var s=t[o],h=r[o];if(Array.isArray(s)||Array.isArray(h)){if(!e(s,h))return!1}else if(!bz(s,h))return!1}return!0},bz=function(t,r){if(Wr(t)&&Wr(r))return!0;if(!Wr(t)&&!Wr(r)){var n=t.props||{},o=n.children,s=gz(n,L_e),h=r.props||{},i=h.children,p=gz(h,B_e);return o&&i?pm(s,p)&&XA(o,i):!o&&!i?pm(s,p):!1}return!1},_z=function(t,r){var n=[],o={};return qI(t).forEach(function(s,h){if(F_e(s))n.push(s);else if(s){var i=Sc(s.type),p=r[i]||{},y=p.handler,b=p.once;if(y&&(!b||!o[i])){var _=y(s,i,h);n.push(_),o[i]=!0}}}),n},q_e=function(t){var r=t&&t.type;return r&&yz[r]?yz[r]:null},W_e=function(t,r){return qI(r).indexOf(t)},G_e=["children","width","height","viewBox","className","style","title","desc"];function ZA(){return ZA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ZA.apply(this,arguments)}function H_e(e,t){if(e==null)return{};var r=X_e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function X_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function KA(e){var t=e.children,r=e.width,n=e.height,o=e.viewBox,s=e.className,h=e.style,i=e.title,p=e.desc,y=H_e(e,G_e),b=o||{width:r,height:n,x:0,y:0},_=Zr("recharts-surface",s);return je.createElement("svg",ZA({},Xr(y,!0,"svg"),{className:_,width:r,height:n,style:h,viewBox:"".concat(b.x," ").concat(b.y," ").concat(b.width," ").concat(b.height)}),je.createElement("title",null,i),je.createElement("desc",null,p),t)}var Z_e=["children","className"];function YA(){return YA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YA.apply(this,arguments)}function K_e(e,t){if(e==null)return{};var r=Y_e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Y_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var pi=je.forwardRef(function(e,t){var r=e.children,n=e.className,o=K_e(e,Z_e),s=Zr("recharts-layer",n);return je.createElement("g",YA({className:s},Xr(o,!0),{ref:t}),r)}),Ec=function(t,r){for(var n=arguments.length,o=new Array(n>2?n-2:0),s=2;s<n;s++)o[s-2]=arguments[s]};function J_e(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),r=r>o?o:r,r<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(o);++n<o;)s[n]=e[n+t];return s}var Q_e=J_e,ewe=Q_e;function twe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:ewe(e,t,r)}var rwe=twe,nwe="\\ud800-\\udfff",iwe="\\u0300-\\u036f",owe="\\ufe20-\\ufe2f",awe="\\u20d0-\\u20ff",swe=iwe+owe+awe,lwe="\\ufe0e\\ufe0f",cwe="\\u200d",uwe=RegExp("["+cwe+nwe+swe+lwe+"]");function dwe(e){return uwe.test(e)}var aH=dwe;function hwe(e){return e.split("")}var fwe=hwe,sH="\\ud800-\\udfff",pwe="\\u0300-\\u036f",mwe="\\ufe20-\\ufe2f",gwe="\\u20d0-\\u20ff",ywe=pwe+mwe+gwe,vwe="\\ufe0e\\ufe0f",xwe="["+sH+"]",JA="["+ywe+"]",QA="\\ud83c[\\udffb-\\udfff]",bwe="(?:"+JA+"|"+QA+")",lH="[^"+sH+"]",cH="(?:\\ud83c[\\udde6-\\uddff]){2}",uH="[\\ud800-\\udbff][\\udc00-\\udfff]",_we="\\u200d",dH=bwe+"?",hH="["+vwe+"]?",wwe="(?:"+_we+"(?:"+[lH,cH,uH].join("|")+")"+hH+dH+")*",Swe=hH+dH+wwe,Ewe="(?:"+[lH+JA+"?",JA,cH,uH,xwe].join("|")+")",Twe=RegExp(QA+"(?="+QA+")|"+Ewe+Swe,"g");function jwe(e){return e.match(Twe)||[]}var Cwe=jwe,Pwe=fwe,Awe=aH,kwe=Cwe;function Nwe(e){return Awe(e)?kwe(e):Pwe(e)}var Mwe=Nwe,Iwe=rwe,Owe=aH,Dwe=Mwe,Rwe=eH;function Lwe(e){return function(t){t=Rwe(t);var r=Owe(t)?Dwe(t):void 0,n=r?r[0]:t.charAt(0),o=r?Iwe(r,1).join(""):t.slice(1);return n[e]()+o}}var Bwe=Lwe,zwe=Bwe,$we=zwe("toUpperCase"),Fwe=$we;const cE=wn(Fwe);function Mn(e){return function(){return e}}const fH=Math.cos,X1=Math.sin,rl=Math.sqrt,Z1=Math.PI,uE=2*Z1,ek=Math.PI,tk=2*ek,Ih=1e-6,Uwe=tk-Ih;function pH(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Vwe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return pH;const r=10**t;return function(n){this._+=n[0];for(let o=1,s=n.length;o<s;++o)this._+=Math.round(arguments[o]*r)/r+n[o]}}class qwe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?pH:Vwe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,o){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+o}`}bezierCurveTo(t,r,n,o,s,h){this._append`C${+t},${+r},${+n},${+o},${this._x1=+s},${this._y1=+h}`}arcTo(t,r,n,o,s){if(t=+t,r=+r,n=+n,o=+o,s=+s,s<0)throw new Error(`negative radius: ${s}`);let h=this._x1,i=this._y1,p=n-t,y=o-r,b=h-t,_=i-r,E=b*b+_*_;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(E>Ih)if(!(Math.abs(_*p-y*b)>Ih)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let C=n-h,k=o-i,N=p*p+y*y,I=C*C+k*k,B=Math.sqrt(N),O=Math.sqrt(E),R=s*Math.tan((ek-Math.acos((N+E-I)/(2*B*O)))/2),q=R/O,F=R/B;Math.abs(q-1)>Ih&&this._append`L${t+q*b},${r+q*_}`,this._append`A${s},${s},0,0,${+(_*C>b*k)},${this._x1=t+F*p},${this._y1=r+F*y}`}}arc(t,r,n,o,s,h){if(t=+t,r=+r,n=+n,h=!!h,n<0)throw new Error(`negative radius: ${n}`);let i=n*Math.cos(o),p=n*Math.sin(o),y=t+i,b=r+p,_=1^h,E=h?o-s:s-o;this._x1===null?this._append`M${y},${b}`:(Math.abs(this._x1-y)>Ih||Math.abs(this._y1-b)>Ih)&&this._append`L${y},${b}`,n&&(E<0&&(E=E%tk+tk),E>Uwe?this._append`A${n},${n},0,1,${_},${t-i},${r-p}A${n},${n},0,1,${_},${this._x1=y},${this._y1=b}`:E>Ih&&this._append`A${n},${n},0,${+(E>=ek)},${_},${this._x1=t+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(t,r,n,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+o}h${-n}Z`}toString(){return this._}}function WI(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new qwe(t)}function GI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function mH(e){this._context=e}mH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function dE(e){return new mH(e)}function gH(e){return e[0]}function yH(e){return e[1]}function vH(e,t){var r=Mn(!0),n=null,o=dE,s=null,h=WI(i);e=typeof e=="function"?e:e===void 0?gH:Mn(e),t=typeof t=="function"?t:t===void 0?yH:Mn(t);function i(p){var y,b=(p=GI(p)).length,_,E=!1,C;for(n==null&&(s=o(C=h())),y=0;y<=b;++y)!(y<b&&r(_=p[y],y,p))===E&&((E=!E)?s.lineStart():s.lineEnd()),E&&s.point(+e(_,y,p),+t(_,y,p));if(C)return s=null,C+""||null}return i.x=function(p){return arguments.length?(e=typeof p=="function"?p:Mn(+p),i):e},i.y=function(p){return arguments.length?(t=typeof p=="function"?p:Mn(+p),i):t},i.defined=function(p){return arguments.length?(r=typeof p=="function"?p:Mn(!!p),i):r},i.curve=function(p){return arguments.length?(o=p,n!=null&&(s=o(n)),i):o},i.context=function(p){return arguments.length?(p==null?n=s=null:s=o(n=p),i):n},i}function uw(e,t,r){var n=null,o=Mn(!0),s=null,h=dE,i=null,p=WI(y);e=typeof e=="function"?e:e===void 0?gH:Mn(+e),t=typeof t=="function"?t:Mn(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?yH:Mn(+r);function y(_){var E,C,k,N=(_=GI(_)).length,I,B=!1,O,R=new Array(N),q=new Array(N);for(s==null&&(i=h(O=p())),E=0;E<=N;++E){if(!(E<N&&o(I=_[E],E,_))===B)if(B=!B)C=E,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),k=E-1;k>=C;--k)i.point(R[k],q[k]);i.lineEnd(),i.areaEnd()}B&&(R[E]=+e(I,E,_),q[E]=+t(I,E,_),i.point(n?+n(I,E,_):R[E],r?+r(I,E,_):q[E]))}if(O)return i=null,O+""||null}function b(){return vH().defined(o).curve(h).context(s)}return y.x=function(_){return arguments.length?(e=typeof _=="function"?_:Mn(+_),n=null,y):e},y.x0=function(_){return arguments.length?(e=typeof _=="function"?_:Mn(+_),y):e},y.x1=function(_){return arguments.length?(n=_==null?null:typeof _=="function"?_:Mn(+_),y):n},y.y=function(_){return arguments.length?(t=typeof _=="function"?_:Mn(+_),r=null,y):t},y.y0=function(_){return arguments.length?(t=typeof _=="function"?_:Mn(+_),y):t},y.y1=function(_){return arguments.length?(r=_==null?null:typeof _=="function"?_:Mn(+_),y):r},y.lineX0=y.lineY0=function(){return b().x(e).y(t)},y.lineY1=function(){return b().x(e).y(r)},y.lineX1=function(){return b().x(n).y(t)},y.defined=function(_){return arguments.length?(o=typeof _=="function"?_:Mn(!!_),y):o},y.curve=function(_){return arguments.length?(h=_,s!=null&&(i=h(s)),y):h},y.context=function(_){return arguments.length?(_==null?s=i=null:i=h(s=_),y):s},y}class xH{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Wwe(e){return new xH(e,!0)}function Gwe(e){return new xH(e,!1)}const HI={draw(e,t){const r=rl(t/Z1);e.moveTo(r,0),e.arc(0,0,r,0,uE)}},Hwe={draw(e,t){const r=rl(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},bH=rl(1/3),Xwe=bH*2,Zwe={draw(e,t){const r=rl(t/Xwe),n=r*bH;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},Kwe={draw(e,t){const r=rl(t),n=-r/2;e.rect(n,n,r,r)}},Ywe=.8908130915292852,_H=X1(Z1/10)/X1(7*Z1/10),Jwe=X1(uE/10)*_H,Qwe=-fH(uE/10)*_H,e1e={draw(e,t){const r=rl(t*Ywe),n=Jwe*r,o=Qwe*r;e.moveTo(0,-r),e.lineTo(n,o);for(let s=1;s<5;++s){const h=uE*s/5,i=fH(h),p=X1(h);e.lineTo(p*r,-i*r),e.lineTo(i*n-p*o,p*n+i*o)}e.closePath()}},NC=rl(3),t1e={draw(e,t){const r=-rl(t/(NC*3));e.moveTo(0,r*2),e.lineTo(-NC*r,-r),e.lineTo(NC*r,-r),e.closePath()}},Wa=-.5,Ga=rl(3)/2,rk=1/rl(12),r1e=(rk/2+1)*3,n1e={draw(e,t){const r=rl(t/r1e),n=r/2,o=r*rk,s=n,h=r*rk+r,i=-s,p=h;e.moveTo(n,o),e.lineTo(s,h),e.lineTo(i,p),e.lineTo(Wa*n-Ga*o,Ga*n+Wa*o),e.lineTo(Wa*s-Ga*h,Ga*s+Wa*h),e.lineTo(Wa*i-Ga*p,Ga*i+Wa*p),e.lineTo(Wa*n+Ga*o,Wa*o-Ga*n),e.lineTo(Wa*s+Ga*h,Wa*h-Ga*s),e.lineTo(Wa*i+Ga*p,Wa*p-Ga*i),e.closePath()}};function i1e(e,t){let r=null,n=WI(o);e=typeof e=="function"?e:Mn(e||HI),t=typeof t=="function"?t:Mn(t===void 0?64:+t);function o(){let s;if(r||(r=s=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return o.type=function(s){return arguments.length?(e=typeof s=="function"?s:Mn(s),o):e},o.size=function(s){return arguments.length?(t=typeof s=="function"?s:Mn(+s),o):t},o.context=function(s){return arguments.length?(r=s??null,o):r},o}function K1(){}function Y1(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function wH(e){this._context=e}wH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Y1(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Y1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function o1e(e){return new wH(e)}function SH(e){this._context=e}SH.prototype={areaStart:K1,areaEnd:K1,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Y1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function a1e(e){return new SH(e)}function EH(e){this._context=e}EH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Y1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function s1e(e){return new EH(e)}function TH(e){this._context=e}TH.prototype={areaStart:K1,areaEnd:K1,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function l1e(e){return new TH(e)}function wz(e){return e<0?-1:1}function Sz(e,t,r){var n=e._x1-e._x0,o=t-e._x1,s=(e._y1-e._y0)/(n||o<0&&-0),h=(r-e._y1)/(o||n<0&&-0),i=(s*o+h*n)/(n+o);return(wz(s)+wz(h))*Math.min(Math.abs(s),Math.abs(h),.5*Math.abs(i))||0}function Ez(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function MC(e,t,r){var n=e._x0,o=e._y0,s=e._x1,h=e._y1,i=(s-n)/3;e._context.bezierCurveTo(n+i,o+i*t,s-i,h-i*r,s,h)}function J1(e){this._context=e}J1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:MC(this,this._t0,Ez(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,MC(this,Ez(this,r=Sz(this,e,t)),r);break;default:MC(this,this._t0,r=Sz(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function jH(e){this._context=new CH(e)}(jH.prototype=Object.create(J1.prototype)).point=function(e,t){J1.prototype.point.call(this,t,e)};function CH(e){this._context=e}CH.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,o,s){this._context.bezierCurveTo(t,e,n,r,s,o)}};function c1e(e){return new J1(e)}function u1e(e){return new jH(e)}function PH(e){this._context=e}PH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=Tz(e),o=Tz(t),s=0,h=1;h<r;++s,++h)this._context.bezierCurveTo(n[0][s],o[0][s],n[1][s],o[1][s],e[h],t[h]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Tz(e){var t,r=e.length-1,n,o=new Array(r),s=new Array(r),h=new Array(r);for(o[0]=0,s[0]=2,h[0]=e[0]+2*e[1],t=1;t<r-1;++t)o[t]=1,s[t]=4,h[t]=4*e[t]+2*e[t+1];for(o[r-1]=2,s[r-1]=7,h[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=o[t]/s[t-1],s[t]-=n,h[t]-=n*h[t-1];for(o[r-1]=h[r-1]/s[r-1],t=r-2;t>=0;--t)o[t]=(h[t]-o[t+1])/s[t];for(s[r-1]=(e[r]+o[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-o[t+1];return[o,s]}function d1e(e){return new PH(e)}function hE(e,t){this._context=e,this._t=t}hE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function h1e(e){return new hE(e,.5)}function f1e(e){return new hE(e,0)}function p1e(e){return new hE(e,1)}function km(e,t){if((h=e.length)>1)for(var r=1,n,o,s=e[t[0]],h,i=s.length;r<h;++r)for(o=s,s=e[t[r]],n=0;n<i;++n)s[n][1]+=s[n][0]=isNaN(o[n][1])?o[n][0]:o[n][1]}function nk(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function m1e(e,t){return e[t]}function g1e(e){const t=[];return t.key=e,t}function y1e(){var e=Mn([]),t=nk,r=km,n=m1e;function o(s){var h=Array.from(e.apply(this,arguments),g1e),i,p=h.length,y=-1,b;for(const _ of s)for(i=0,++y;i<p;++i)(h[i][y]=[0,+n(_,h[i].key,y,s)]).data=_;for(i=0,b=GI(t(h));i<p;++i)h[b[i]].index=i;return r(h,b),h}return o.keys=function(s){return arguments.length?(e=typeof s=="function"?s:Mn(Array.from(s)),o):e},o.value=function(s){return arguments.length?(n=typeof s=="function"?s:Mn(+s),o):n},o.order=function(s){return arguments.length?(t=s==null?nk:typeof s=="function"?s:Mn(Array.from(s)),o):t},o.offset=function(s){return arguments.length?(r=s??km,o):r},o}function v1e(e,t){if((n=e.length)>0){for(var r,n,o=0,s=e[0].length,h;o<s;++o){for(h=r=0;r<n;++r)h+=e[r][o][1]||0;if(h)for(r=0;r<n;++r)e[r][o][1]/=h}km(e,t)}}function x1e(e,t){if((o=e.length)>0){for(var r=0,n=e[t[0]],o,s=n.length;r<s;++r){for(var h=0,i=0;h<o;++h)i+=e[h][r][1]||0;n[r][1]+=n[r][0]=-i/2}km(e,t)}}function b1e(e,t){if(!(!((h=e.length)>0)||!((s=(o=e[t[0]]).length)>0))){for(var r=0,n=1,o,s,h;n<s;++n){for(var i=0,p=0,y=0;i<h;++i){for(var b=e[t[i]],_=b[n][1]||0,E=b[n-1][1]||0,C=(_-E)/2,k=0;k<i;++k){var N=e[t[k]],I=N[n][1]||0,B=N[n-1][1]||0;C+=I-B}p+=_,y+=C*_}o[n-1][1]+=o[n-1][0]=r,p&&(r-=y/p)}o[n-1][1]+=o[n-1][0]=r,km(e,t)}}function qx(e){"@babel/helpers - typeof";return qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qx(e)}var _1e=["type","size","sizeType"];function ik(){return ik=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ik.apply(this,arguments)}function jz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Cz(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jz(Object(r),!0).forEach(function(n){w1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function w1e(e,t,r){return t=S1e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S1e(e){var t=E1e(e,"string");return qx(t)=="symbol"?t:t+""}function E1e(e,t){if(qx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T1e(e,t){if(e==null)return{};var r=j1e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function j1e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var AH={symbolCircle:HI,symbolCross:Hwe,symbolDiamond:Zwe,symbolSquare:Kwe,symbolStar:e1e,symbolTriangle:t1e,symbolWye:n1e},C1e=Math.PI/180,P1e=function(t){var r="symbol".concat(cE(t));return AH[r]||HI},A1e=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var o=18*C1e;return 1.25*t*t*(Math.tan(o)-Math.tan(o*2)*Math.pow(Math.tan(o),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},k1e=function(t,r){AH["symbol".concat(cE(t))]=r},XI=function(t){var r=t.type,n=r===void 0?"circle":r,o=t.size,s=o===void 0?64:o,h=t.sizeType,i=h===void 0?"area":h,p=T1e(t,_1e),y=Cz(Cz({},p),{},{type:n,size:s,sizeType:i}),b=function(){var I=P1e(n),B=i1e().type(I).size(A1e(s,i,n));return B()},_=y.className,E=y.cx,C=y.cy,k=Xr(y,!0);return E===+E&&C===+C&&s===+s?je.createElement("path",ik({},k,{className:Zr("recharts-symbols",_),transform:"translate(".concat(E,", ").concat(C,")"),d:b()})):null};XI.registerSymbol=k1e;function Nm(e){"@babel/helpers - typeof";return Nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nm(e)}function ok(){return ok=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ok.apply(this,arguments)}function Pz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function N1e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pz(Object(r),!0).forEach(function(n){Wx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Az(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NH(n.key),n)}}function I1e(e,t,r){return t&&Az(e.prototype,t),r&&Az(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O1e(e,t,r){return t=Q1(t),D1e(e,kH()?Reflect.construct(t,r||[],Q1(e).constructor):t.apply(e,r))}function D1e(e,t){if(t&&(Nm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R1e(e)}function R1e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kH=function(){return!!e})()}function Q1(e){return Q1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Q1(e)}function L1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ak(e,t)}function ak(e,t){return ak=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ak(e,t)}function Wx(e,t,r){return t=NH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NH(e){var t=B1e(e,"string");return Nm(t)=="symbol"?t:t+""}function B1e(e,t){if(Nm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ha=32,ZI=function(e){function t(){return M1e(this,t),O1e(this,t,arguments)}return L1e(t,e),I1e(t,[{key:"renderIcon",value:function(n){var o=this.props.inactiveColor,s=Ha/2,h=Ha/6,i=Ha/3,p=n.inactive?o:n.color;if(n.type==="plainline")return je.createElement("line",{strokeWidth:4,fill:"none",stroke:p,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:s,x2:Ha,y2:s,className:"recharts-legend-icon"});if(n.type==="line")return je.createElement("path",{strokeWidth:4,fill:"none",stroke:p,d:"M0,".concat(s,"h").concat(i,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(2*i,",").concat(s,`
            H`).concat(Ha,"M").concat(2*i,",").concat(s,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(i,",").concat(s),className:"recharts-legend-icon"});if(n.type==="rect")return je.createElement("path",{stroke:"none",fill:p,d:"M0,".concat(Ha/8,"h").concat(Ha,"v").concat(Ha*3/4,"h").concat(-Ha,"z"),className:"recharts-legend-icon"});if(je.isValidElement(n.legendIcon)){var y=N1e({},n);return delete y.legendIcon,je.cloneElement(n.legendIcon,y)}return je.createElement(XI,{fill:p,cx:s,cy:s,size:Ha,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,o=this.props,s=o.payload,h=o.iconSize,i=o.layout,p=o.formatter,y=o.inactiveColor,b={x:0,y:0,width:Ha,height:Ha},_={display:i==="horizontal"?"inline-block":"block",marginRight:10},E={display:"inline-block",verticalAlign:"middle",marginRight:4};return s.map(function(C,k){var N=C.formatter||p,I=Zr(Wx(Wx({"recharts-legend-item":!0},"legend-item-".concat(k),!0),"inactive",C.inactive));if(C.type==="none")return null;var B=Nr(C.value)?null:C.value;Ec(!Nr(C.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var O=C.inactive?y:C.color;return je.createElement("li",ok({className:I,style:_,key:"legend-item-".concat(k)},H1(n.props,C,k)),je.createElement(KA,{width:h,height:h,viewBox:b,style:E},n.renderIcon(C)),je.createElement("span",{className:"recharts-legend-item-text",style:{color:O}},N?N(B,C,k):B))})}},{key:"render",value:function(){var n=this.props,o=n.payload,s=n.layout,h=n.align;if(!o||!o.length)return null;var i={padding:0,margin:0,textAlign:s==="horizontal"?h:"left"};return je.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(D.PureComponent);Wx(ZI,"displayName","Legend");Wx(ZI,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var z1e=K2;function $1e(){this.__data__=new z1e,this.size=0}var F1e=$1e;function U1e(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var V1e=U1e;function q1e(e){return this.__data__.get(e)}var W1e=q1e;function G1e(e){return this.__data__.has(e)}var H1e=G1e,X1e=K2,Z1e=RI,K1e=LI,Y1e=200;function J1e(e,t){var r=this.__data__;if(r instanceof X1e){var n=r.__data__;if(!Z1e||n.length<Y1e-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new K1e(n)}return r.set(e,t),this.size=r.size,this}var Q1e=J1e,eSe=K2,tSe=F1e,rSe=V1e,nSe=W1e,iSe=H1e,oSe=Q1e;function Eg(e){var t=this.__data__=new eSe(e);this.size=t.size}Eg.prototype.clear=tSe;Eg.prototype.delete=rSe;Eg.prototype.get=nSe;Eg.prototype.has=iSe;Eg.prototype.set=oSe;var MH=Eg,aSe="__lodash_hash_undefined__";function sSe(e){return this.__data__.set(e,aSe),this}var lSe=sSe;function cSe(e){return this.__data__.has(e)}var uSe=cSe,dSe=LI,hSe=lSe,fSe=uSe;function eS(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new dSe;++t<r;)this.add(e[t])}eS.prototype.add=eS.prototype.push=hSe;eS.prototype.has=fSe;var IH=eS;function pSe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var OH=pSe;function mSe(e,t){return e.has(t)}var DH=mSe,gSe=IH,ySe=OH,vSe=DH,xSe=1,bSe=2;function _Se(e,t,r,n,o,s){var h=r&xSe,i=e.length,p=t.length;if(i!=p&&!(h&&p>i))return!1;var y=s.get(e),b=s.get(t);if(y&&b)return y==t&&b==e;var _=-1,E=!0,C=r&bSe?new gSe:void 0;for(s.set(e,t),s.set(t,e);++_<i;){var k=e[_],N=t[_];if(n)var I=h?n(N,k,_,t,e,s):n(k,N,_,e,t,s);if(I!==void 0){if(I)continue;E=!1;break}if(C){if(!ySe(t,function(B,O){if(!vSe(C,O)&&(k===B||o(k,B,r,n,s)))return C.push(O)})){E=!1;break}}else if(!(k===N||o(k,N,r,n,s))){E=!1;break}}return s.delete(e),s.delete(t),E}var RH=_Se,wSe=Rl,SSe=wSe.Uint8Array,ESe=SSe;function TSe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,o){r[++t]=[o,n]}),r}var jSe=TSe;function CSe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var KI=CSe,kz=Wb,Nz=ESe,PSe=DI,ASe=RH,kSe=jSe,NSe=KI,MSe=1,ISe=2,OSe="[object Boolean]",DSe="[object Date]",RSe="[object Error]",LSe="[object Map]",BSe="[object Number]",zSe="[object RegExp]",$Se="[object Set]",FSe="[object String]",USe="[object Symbol]",VSe="[object ArrayBuffer]",qSe="[object DataView]",Mz=kz?kz.prototype:void 0,IC=Mz?Mz.valueOf:void 0;function WSe(e,t,r,n,o,s,h){switch(r){case qSe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case VSe:return!(e.byteLength!=t.byteLength||!s(new Nz(e),new Nz(t)));case OSe:case DSe:case BSe:return PSe(+e,+t);case RSe:return e.name==t.name&&e.message==t.message;case zSe:case FSe:return e==t+"";case LSe:var i=kSe;case $Se:var p=n&MSe;if(i||(i=NSe),e.size!=t.size&&!p)return!1;var y=h.get(e);if(y)return y==t;n|=ISe,h.set(e,t);var b=ASe(i(e),i(t),n,o,s,h);return h.delete(e),b;case USe:if(IC)return IC.call(e)==IC.call(t)}return!1}var GSe=WSe;function HSe(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var LH=HSe,XSe=LH,ZSe=ua;function KSe(e,t,r){var n=t(e);return ZSe(e)?n:XSe(n,r(e))}var YSe=KSe;function JSe(e,t){for(var r=-1,n=e==null?0:e.length,o=0,s=[];++r<n;){var h=e[r];t(h,r,e)&&(s[o++]=h)}return s}var QSe=JSe;function e2e(){return[]}var t2e=e2e,r2e=QSe,n2e=t2e,i2e=Object.prototype,o2e=i2e.propertyIsEnumerable,Iz=Object.getOwnPropertySymbols,a2e=Iz?function(e){return e==null?[]:(e=Object(e),r2e(Iz(e),function(t){return o2e.call(e,t)}))}:n2e,s2e=a2e;function l2e(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var c2e=l2e,u2e=Gc,d2e=Hc,h2e="[object Arguments]";function f2e(e){return d2e(e)&&u2e(e)==h2e}var p2e=f2e,Oz=p2e,m2e=Hc,BH=Object.prototype,g2e=BH.hasOwnProperty,y2e=BH.propertyIsEnumerable,v2e=Oz(function(){return arguments}())?Oz:function(e){return m2e(e)&&g2e.call(e,"callee")&&!y2e.call(e,"callee")},YI=v2e,tS={exports:{}};function x2e(){return!1}var b2e=x2e;tS.exports;(function(e,t){var r=Rl,n=b2e,o=t&&!t.nodeType&&t,s=o&&!0&&e&&!e.nodeType&&e,h=s&&s.exports===o,i=h?r.Buffer:void 0,p=i?i.isBuffer:void 0,y=p||n;e.exports=y})(tS,tS.exports);var zH=tS.exports,_2e=9007199254740991,w2e=/^(?:0|[1-9]\d*)$/;function S2e(e,t){var r=typeof e;return t=t??_2e,!!t&&(r=="number"||r!="symbol"&&w2e.test(e))&&e>-1&&e%1==0&&e<t}var JI=S2e,E2e=9007199254740991;function T2e(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=E2e}var QI=T2e,j2e=Gc,C2e=QI,P2e=Hc,A2e="[object Arguments]",k2e="[object Array]",N2e="[object Boolean]",M2e="[object Date]",I2e="[object Error]",O2e="[object Function]",D2e="[object Map]",R2e="[object Number]",L2e="[object Object]",B2e="[object RegExp]",z2e="[object Set]",$2e="[object String]",F2e="[object WeakMap]",U2e="[object ArrayBuffer]",V2e="[object DataView]",q2e="[object Float32Array]",W2e="[object Float64Array]",G2e="[object Int8Array]",H2e="[object Int16Array]",X2e="[object Int32Array]",Z2e="[object Uint8Array]",K2e="[object Uint8ClampedArray]",Y2e="[object Uint16Array]",J2e="[object Uint32Array]",zn={};zn[q2e]=zn[W2e]=zn[G2e]=zn[H2e]=zn[X2e]=zn[Z2e]=zn[K2e]=zn[Y2e]=zn[J2e]=!0;zn[A2e]=zn[k2e]=zn[U2e]=zn[N2e]=zn[V2e]=zn[M2e]=zn[I2e]=zn[O2e]=zn[D2e]=zn[R2e]=zn[L2e]=zn[B2e]=zn[z2e]=zn[$2e]=zn[F2e]=!1;function Q2e(e){return P2e(e)&&C2e(e.length)&&!!zn[j2e(e)]}var eEe=Q2e;function tEe(e){return function(t){return e(t)}}var $H=tEe,rS={exports:{}};rS.exports;(function(e,t){var r=X9,n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,s=o&&o.exports===n,h=s&&r.process,i=function(){try{var p=o&&o.require&&o.require("util").types;return p||h&&h.binding&&h.binding("util")}catch{}}();e.exports=i})(rS,rS.exports);var rEe=rS.exports,nEe=eEe,iEe=$H,Dz=rEe,Rz=Dz&&Dz.isTypedArray,oEe=Rz?iEe(Rz):nEe,FH=oEe,aEe=c2e,sEe=YI,lEe=ua,cEe=zH,uEe=JI,dEe=FH,hEe=Object.prototype,fEe=hEe.hasOwnProperty;function pEe(e,t){var r=lEe(e),n=!r&&sEe(e),o=!r&&!n&&cEe(e),s=!r&&!n&&!o&&dEe(e),h=r||n||o||s,i=h?aEe(e.length,String):[],p=i.length;for(var y in e)(t||fEe.call(e,y))&&!(h&&(y=="length"||o&&(y=="offset"||y=="parent")||s&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||uEe(y,p)))&&i.push(y);return i}var mEe=pEe,gEe=Object.prototype;function yEe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||gEe;return e===r}var vEe=yEe;function xEe(e,t){return function(r){return e(t(r))}}var UH=xEe,bEe=UH,_Ee=bEe(Object.keys,Object),wEe=_Ee,SEe=vEe,EEe=wEe,TEe=Object.prototype,jEe=TEe.hasOwnProperty;function CEe(e){if(!SEe(e))return EEe(e);var t=[];for(var r in Object(e))jEe.call(e,r)&&r!="constructor"&&t.push(r);return t}var PEe=CEe,AEe=OI,kEe=QI;function NEe(e){return e!=null&&kEe(e.length)&&!AEe(e)}var Xb=NEe,MEe=mEe,IEe=PEe,OEe=Xb;function DEe(e){return OEe(e)?MEe(e):IEe(e)}var fE=DEe,REe=YSe,LEe=s2e,BEe=fE;function zEe(e){return REe(e,BEe,LEe)}var $Ee=zEe,Lz=$Ee,FEe=1,UEe=Object.prototype,VEe=UEe.hasOwnProperty;function qEe(e,t,r,n,o,s){var h=r&FEe,i=Lz(e),p=i.length,y=Lz(t),b=y.length;if(p!=b&&!h)return!1;for(var _=p;_--;){var E=i[_];if(!(h?E in t:VEe.call(t,E)))return!1}var C=s.get(e),k=s.get(t);if(C&&k)return C==t&&k==e;var N=!0;s.set(e,t),s.set(t,e);for(var I=h;++_<p;){E=i[_];var B=e[E],O=t[E];if(n)var R=h?n(O,B,E,t,e,s):n(B,O,E,e,t,s);if(!(R===void 0?B===O||o(B,O,r,n,s):R)){N=!1;break}I||(I=E=="constructor")}if(N&&!I){var q=e.constructor,F=t.constructor;q!=F&&"constructor"in e&&"constructor"in t&&!(typeof q=="function"&&q instanceof q&&typeof F=="function"&&F instanceof F)&&(N=!1)}return s.delete(e),s.delete(t),N}var WEe=qEe,GEe=Sf,HEe=Rl,XEe=GEe(HEe,"DataView"),ZEe=XEe,KEe=Sf,YEe=Rl,JEe=KEe(YEe,"Promise"),QEe=JEe,eTe=Sf,tTe=Rl,rTe=eTe(tTe,"Set"),VH=rTe,nTe=Sf,iTe=Rl,oTe=nTe(iTe,"WeakMap"),aTe=oTe,sk=ZEe,lk=RI,ck=QEe,uk=VH,dk=aTe,qH=Gc,Tg=K9,Bz="[object Map]",sTe="[object Object]",zz="[object Promise]",$z="[object Set]",Fz="[object WeakMap]",Uz="[object DataView]",lTe=Tg(sk),cTe=Tg(lk),uTe=Tg(ck),dTe=Tg(uk),hTe=Tg(dk),Oh=qH;(sk&&Oh(new sk(new ArrayBuffer(1)))!=Uz||lk&&Oh(new lk)!=Bz||ck&&Oh(ck.resolve())!=zz||uk&&Oh(new uk)!=$z||dk&&Oh(new dk)!=Fz)&&(Oh=function(e){var t=qH(e),r=t==sTe?e.constructor:void 0,n=r?Tg(r):"";if(n)switch(n){case lTe:return Uz;case cTe:return Bz;case uTe:return zz;case dTe:return $z;case hTe:return Fz}return t});var fTe=Oh,OC=MH,pTe=RH,mTe=GSe,gTe=WEe,Vz=fTe,qz=ua,Wz=zH,yTe=FH,vTe=1,Gz="[object Arguments]",Hz="[object Array]",dw="[object Object]",xTe=Object.prototype,Xz=xTe.hasOwnProperty;function bTe(e,t,r,n,o,s){var h=qz(e),i=qz(t),p=h?Hz:Vz(e),y=i?Hz:Vz(t);p=p==Gz?dw:p,y=y==Gz?dw:y;var b=p==dw,_=y==dw,E=p==y;if(E&&Wz(e)){if(!Wz(t))return!1;h=!0,b=!1}if(E&&!b)return s||(s=new OC),h||yTe(e)?pTe(e,t,r,n,o,s):mTe(e,t,p,r,n,o,s);if(!(r&vTe)){var C=b&&Xz.call(e,"__wrapped__"),k=_&&Xz.call(t,"__wrapped__");if(C||k){var N=C?e.value():e,I=k?t.value():t;return s||(s=new OC),o(N,I,r,n,s)}}return E?(s||(s=new OC),gTe(e,t,r,n,o,s)):!1}var _Te=bTe,wTe=_Te,Zz=Hc;function WH(e,t,r,n,o){return e===t?!0:e==null||t==null||!Zz(e)&&!Zz(t)?e!==e&&t!==t:wTe(e,t,r,n,WH,o)}var eO=WH,STe=MH,ETe=eO,TTe=1,jTe=2;function CTe(e,t,r,n){var o=r.length,s=o,h=!n;if(e==null)return!s;for(e=Object(e);o--;){var i=r[o];if(h&&i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++o<s;){i=r[o];var p=i[0],y=e[p],b=i[1];if(h&&i[2]){if(y===void 0&&!(p in e))return!1}else{var _=new STe;if(n)var E=n(y,b,p,e,t,_);if(!(E===void 0?ETe(b,y,TTe|jTe,n,_):E))return!1}}return!0}var PTe=CTe,ATe=Pd;function kTe(e){return e===e&&!ATe(e)}var GH=kTe,NTe=GH,MTe=fE;function ITe(e){for(var t=MTe(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,NTe(o)]}return t}var OTe=ITe;function DTe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var HH=DTe,RTe=PTe,LTe=OTe,BTe=HH;function zTe(e){var t=LTe(e);return t.length==1&&t[0][2]?BTe(t[0][0],t[0][1]):function(r){return r===e||RTe(r,e,t)}}var $Te=zTe;function FTe(e,t){return e!=null&&t in Object(e)}var UTe=FTe,VTe=tH,qTe=YI,WTe=ua,GTe=JI,HTe=QI,XTe=J2;function ZTe(e,t,r){t=VTe(t,e);for(var n=-1,o=t.length,s=!1;++n<o;){var h=XTe(t[n]);if(!(s=e!=null&&r(e,h)))break;e=e[h]}return s||++n!=o?s:(o=e==null?0:e.length,!!o&&HTe(o)&&GTe(h,o)&&(WTe(e)||qTe(e)))}var KTe=ZTe,YTe=UTe,JTe=KTe;function QTe(e,t){return e!=null&&JTe(e,t,YTe)}var eje=QTe,tje=eO,rje=rH,nje=eje,ije=II,oje=GH,aje=HH,sje=J2,lje=1,cje=2;function uje(e,t){return ije(e)&&oje(t)?aje(sje(e),t):function(r){var n=rje(r,e);return n===void 0&&n===t?nje(r,e):tje(t,n,lje|cje)}}var dje=uje;function hje(e){return e}var jg=hje;function fje(e){return function(t){return t==null?void 0:t[e]}}var pje=fje,mje=$I;function gje(e){return function(t){return mje(t,e)}}var yje=gje,vje=pje,xje=yje,bje=II,_je=J2;function wje(e){return bje(e)?vje(_je(e)):xje(e)}var Sje=wje,Eje=$Te,Tje=dje,jje=jg,Cje=ua,Pje=Sje;function Aje(e){return typeof e=="function"?e:e==null?jje:typeof e=="object"?Cje(e)?Tje(e[0],e[1]):Eje(e):Pje(e)}var Ad=Aje;function kje(e,t,r,n){for(var o=e.length,s=r+(n?1:-1);n?s--:++s<o;)if(t(e[s],s,e))return s;return-1}var XH=kje;function Nje(e){return e!==e}var Mje=Nje;function Ije(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}var Oje=Ije,Dje=XH,Rje=Mje,Lje=Oje;function Bje(e,t,r){return t===t?Lje(e,t,r):Dje(e,Rje,r)}var zje=Bje,$je=zje;function Fje(e,t){var r=e==null?0:e.length;return!!r&&$je(e,t,0)>-1}var Uje=Fje;function Vje(e,t,r){for(var n=-1,o=e==null?0:e.length;++n<o;)if(r(t,e[n]))return!0;return!1}var qje=Vje;function Wje(){}var Gje=Wje,DC=VH,Hje=Gje,Xje=KI,Zje=1/0,Kje=DC&&1/Xje(new DC([,-0]))[1]==Zje?function(e){return new DC(e)}:Hje,Yje=Kje,Jje=IH,Qje=Uje,eCe=qje,tCe=DH,rCe=Yje,nCe=KI,iCe=200;function oCe(e,t,r){var n=-1,o=Qje,s=e.length,h=!0,i=[],p=i;if(r)h=!1,o=eCe;else if(s>=iCe){var y=t?null:rCe(e);if(y)return nCe(y);h=!1,o=tCe,p=new Jje}else p=t?[]:i;e:for(;++n<s;){var b=e[n],_=t?t(b):b;if(b=r||b!==0?b:0,h&&_===_){for(var E=p.length;E--;)if(p[E]===_)continue e;t&&p.push(_),i.push(b)}else o(p,_,r)||(p!==i&&p.push(_),i.push(b))}return i}var aCe=oCe,sCe=Ad,lCe=aCe;function cCe(e,t){return e&&e.length?lCe(e,sCe(t)):[]}var uCe=cCe;const Kz=wn(uCe);function ZH(e,t,r){return t===!0?Kz(e,r):Nr(t)?Kz(e,t):e}function Mm(e){"@babel/helpers - typeof";return Mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mm(e)}var dCe=["ref"];function Yz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ac(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yz(Object(r),!0).forEach(function(n){pE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YH(n.key),n)}}function fCe(e,t,r){return t&&Jz(e.prototype,t),r&&Jz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pCe(e,t,r){return t=nS(t),mCe(e,KH()?Reflect.construct(t,r||[],nS(e).constructor):t.apply(e,r))}function mCe(e,t){if(t&&(Mm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gCe(e)}function gCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KH=function(){return!!e})()}function nS(e){return nS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nS(e)}function yCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hk(e,t)}function hk(e,t){return hk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},hk(e,t)}function pE(e,t,r){return t=YH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YH(e){var t=vCe(e,"string");return Mm(t)=="symbol"?t:t+""}function vCe(e,t){if(Mm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xCe(e,t){if(e==null)return{};var r=bCe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function bCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function _Ce(e){return e.value}function wCe(e,t){if(je.isValidElement(e))return je.cloneElement(e,t);if(typeof e=="function")return je.createElement(e,t);t.ref;var r=xCe(t,dCe);return je.createElement(ZI,r)}var Qz=1,mm=function(e){function t(){var r;hCe(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r=pCe(this,t,[].concat(o)),pE(r,"lastBoundingBox",{width:-1,height:-1}),r}return yCe(t,e),fCe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,o=this.getBBox();o?(Math.abs(o.width-this.lastBoundingBox.width)>Qz||Math.abs(o.height-this.lastBoundingBox.height)>Qz)&&(this.lastBoundingBox.width=o.width,this.lastBoundingBox.height=o.height,n&&n(o)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?ac({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var o=this.props,s=o.layout,h=o.align,i=o.verticalAlign,p=o.margin,y=o.chartWidth,b=o.chartHeight,_,E;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(h==="center"&&s==="vertical"){var C=this.getBBoxSnapshot();_={left:((y||0)-C.width)/2}}else _=h==="right"?{right:p&&p.right||0}:{left:p&&p.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var k=this.getBBoxSnapshot();E={top:((b||0)-k.height)/2}}else E=i==="bottom"?{bottom:p&&p.bottom||0}:{top:p&&p.top||0};return ac(ac({},_),E)}},{key:"render",value:function(){var n=this,o=this.props,s=o.content,h=o.width,i=o.height,p=o.wrapperStyle,y=o.payloadUniqBy,b=o.payload,_=ac(ac({position:"absolute",width:h||"auto",height:i||"auto"},this.getDefaultPosition(p)),p);return je.createElement("div",{className:"recharts-legend-wrapper",style:_,ref:function(C){n.wrapperNode=C}},wCe(s,ac(ac({},this.props),{},{payload:ZH(b,y,_Ce)})))}}],[{key:"getWithHeight",value:function(n,o){var s=ac(ac({},this.defaultProps),n.props),h=s.layout;return h==="vertical"&&Ft(n.props.height)?{height:n.props.height}:h==="horizontal"?{width:n.props.width||o}:null}}])}(D.PureComponent);pE(mm,"displayName","Legend");pE(mm,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var e$=Wb,SCe=YI,ECe=ua,t$=e$?e$.isConcatSpreadable:void 0;function TCe(e){return ECe(e)||SCe(e)||!!(t$&&e&&e[t$])}var jCe=TCe,CCe=LH,PCe=jCe;function JH(e,t,r,n,o){var s=-1,h=e.length;for(r||(r=PCe),o||(o=[]);++s<h;){var i=e[s];t>0&&r(i)?t>1?JH(i,t-1,r,n,o):CCe(o,i):n||(o[o.length]=i)}return o}var QH=JH;function ACe(e){return function(t,r,n){for(var o=-1,s=Object(t),h=n(t),i=h.length;i--;){var p=h[e?i:++o];if(r(s[p],p,s)===!1)break}return t}}var kCe=ACe,NCe=kCe,MCe=NCe(),ICe=MCe,OCe=ICe,DCe=fE;function RCe(e,t){return e&&OCe(e,t,DCe)}var eX=RCe,LCe=Xb;function BCe(e,t){return function(r,n){if(r==null)return r;if(!LCe(r))return e(r,n);for(var o=r.length,s=t?o:-1,h=Object(r);(t?s--:++s<o)&&n(h[s],s,h)!==!1;);return r}}var zCe=BCe,$Ce=eX,FCe=zCe,UCe=FCe($Ce),tO=UCe,VCe=tO,qCe=Xb;function WCe(e,t){var r=-1,n=qCe(e)?Array(e.length):[];return VCe(e,function(o,s,h){n[++r]=t(o,s,h)}),n}var tX=WCe;function GCe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var HCe=GCe,r$=xg;function XCe(e,t){if(e!==t){var r=e!==void 0,n=e===null,o=e===e,s=r$(e),h=t!==void 0,i=t===null,p=t===t,y=r$(t);if(!i&&!y&&!s&&e>t||s&&h&&p&&!i&&!y||n&&h&&p||!r&&p||!o)return 1;if(!n&&!s&&!y&&e<t||y&&r&&o&&!n&&!s||i&&r&&o||!h&&o||!p)return-1}return 0}var ZCe=XCe,KCe=ZCe;function YCe(e,t,r){for(var n=-1,o=e.criteria,s=t.criteria,h=o.length,i=r.length;++n<h;){var p=KCe(o[n],s[n]);if(p){if(n>=i)return p;var y=r[n];return p*(y=="desc"?-1:1)}}return e.index-t.index}var JCe=YCe,RC=zI,QCe=$I,ePe=Ad,tPe=tX,rPe=HCe,nPe=$H,iPe=JCe,oPe=jg,aPe=ua;function sPe(e,t,r){t.length?t=RC(t,function(s){return aPe(s)?function(h){return QCe(h,s.length===1?s[0]:s)}:s}):t=[oPe];var n=-1;t=RC(t,nPe(ePe));var o=tPe(e,function(s,h,i){var p=RC(t,function(y){return y(s)});return{criteria:p,index:++n,value:s}});return rPe(o,function(s,h){return iPe(s,h,r)})}var lPe=sPe;function cPe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var uPe=cPe,dPe=uPe,n$=Math.max;function hPe(e,t,r){return t=n$(t===void 0?e.length-1:t,0),function(){for(var n=arguments,o=-1,s=n$(n.length-t,0),h=Array(s);++o<s;)h[o]=n[t+o];o=-1;for(var i=Array(t+1);++o<t;)i[o]=n[o];return i[t]=r(h),dPe(e,this,i)}}var fPe=hPe;function pPe(e){return function(){return e}}var mPe=pPe,gPe=Sf,yPe=function(){try{var e=gPe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),rX=yPe,vPe=mPe,i$=rX,xPe=jg,bPe=i$?function(e,t){return i$(e,"toString",{configurable:!0,enumerable:!1,value:vPe(t),writable:!0})}:xPe,_Pe=bPe,wPe=800,SPe=16,EPe=Date.now;function TPe(e){var t=0,r=0;return function(){var n=EPe(),o=SPe-(n-r);if(r=n,o>0){if(++t>=wPe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var jPe=TPe,CPe=_Pe,PPe=jPe,APe=PPe(CPe),kPe=APe,NPe=jg,MPe=fPe,IPe=kPe;function OPe(e,t){return IPe(MPe(e,t,NPe),e+"")}var DPe=OPe,RPe=DI,LPe=Xb,BPe=JI,zPe=Pd;function $Pe(e,t,r){if(!zPe(r))return!1;var n=typeof t;return(n=="number"?LPe(r)&&BPe(t,r.length):n=="string"&&t in r)?RPe(r[t],e):!1}var mE=$Pe,FPe=QH,UPe=lPe,VPe=DPe,o$=mE,qPe=VPe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&o$(e,t[0],t[1])?t=[]:r>2&&o$(t[0],t[1],t[2])&&(t=[t[0]]),UPe(e,FPe(t,1),[])}),WPe=qPe;const rO=wn(WPe);function Gx(e){"@babel/helpers - typeof";return Gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gx(e)}function fk(){return fk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fk.apply(this,arguments)}function GPe(e,t){return KPe(e)||ZPe(e,t)||XPe(e,t)||HPe()}function HPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XPe(e,t){if(e){if(typeof e=="string")return a$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a$(e,t)}}function a$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZPe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,h,i=[],p=!0,y=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);p=!0);}catch(b){y=!0,o=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return i}}function KPe(e){if(Array.isArray(e))return e}function s$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function LC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s$(Object(r),!0).forEach(function(n){YPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YPe(e,t,r){return t=JPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JPe(e){var t=QPe(e,"string");return Gx(t)=="symbol"?t:t+""}function QPe(e,t){if(Gx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eAe(e){return Array.isArray(e)&&Li(e[0])&&Li(e[1])?e.join(" ~ "):e}var tAe=function(t){var r=t.separator,n=r===void 0?" : ":r,o=t.contentStyle,s=o===void 0?{}:o,h=t.itemStyle,i=h===void 0?{}:h,p=t.labelStyle,y=p===void 0?{}:p,b=t.payload,_=t.formatter,E=t.itemSorter,C=t.wrapperClassName,k=t.labelClassName,N=t.label,I=t.labelFormatter,B=t.accessibilityLayer,O=B===void 0?!1:B,R=function(){if(b&&b.length){var ae={padding:0,margin:0},_e=(E?rO(b,E):b).map(function(Ee,xe){if(Ee.type==="none")return null;var ce=LC({display:"block",paddingTop:4,paddingBottom:4,color:Ee.color||"#000"},i),ke=Ee.formatter||_||eAe,ve=Ee.value,Pe=Ee.name,Re=ve,Be=Pe;if(ke&&Re!=null&&Be!=null){var Fe=ke(ve,Pe,Ee,xe,b);if(Array.isArray(Fe)){var Ge=GPe(Fe,2);Re=Ge[0],Be=Ge[1]}else Re=Fe}return je.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(xe),style:ce},Li(Be)?je.createElement("span",{className:"recharts-tooltip-item-name"},Be):null,Li(Be)?je.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,je.createElement("span",{className:"recharts-tooltip-item-value"},Re),je.createElement("span",{className:"recharts-tooltip-item-unit"},Ee.unit||""))});return je.createElement("ul",{className:"recharts-tooltip-item-list",style:ae},_e)}return null},q=LC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},s),F=LC({margin:0},y),X=!Wr(N),G=X?N:"",ee=Zr("recharts-default-tooltip",C),K=Zr("recharts-tooltip-label",k);X&&I&&b!==void 0&&b!==null&&(G=I(N,b));var ie=O?{role:"status","aria-live":"assertive"}:{};return je.createElement("div",fk({className:ee,style:q},ie),je.createElement("p",{className:K,style:F},je.isValidElement(G)?G:"".concat(G)),R())};function Hx(e){"@babel/helpers - typeof";return Hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hx(e)}function hw(e,t,r){return t=rAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rAe(e){var t=nAe(e,"string");return Hx(t)=="symbol"?t:t+""}function nAe(e,t){if(Hx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tv="recharts-tooltip-wrapper",iAe={visibility:"hidden"};function oAe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return Zr(Tv,hw(hw(hw(hw({},"".concat(Tv,"-right"),Ft(r)&&t&&Ft(t.x)&&r>=t.x),"".concat(Tv,"-left"),Ft(r)&&t&&Ft(t.x)&&r<t.x),"".concat(Tv,"-bottom"),Ft(n)&&t&&Ft(t.y)&&n>=t.y),"".concat(Tv,"-top"),Ft(n)&&t&&Ft(t.y)&&n<t.y))}function l$(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,o=e.offsetTopLeft,s=e.position,h=e.reverseDirection,i=e.tooltipDimension,p=e.viewBox,y=e.viewBoxDimension;if(s&&Ft(s[n]))return s[n];var b=r[n]-i-o,_=r[n]+o;if(t[n])return h[n]?b:_;if(h[n]){var E=b,C=p[n];return E<C?Math.max(_,p[n]):Math.max(b,p[n])}var k=_+i,N=p[n]+y;return k>N?Math.max(b,p[n]):Math.max(_,p[n])}function aAe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function sAe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,o=e.position,s=e.reverseDirection,h=e.tooltipBox,i=e.useTranslate3d,p=e.viewBox,y,b,_;return h.height>0&&h.width>0&&r?(b=l$({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:o,reverseDirection:s,tooltipDimension:h.width,viewBox:p,viewBoxDimension:p.width}),_=l$({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:o,reverseDirection:s,tooltipDimension:h.height,viewBox:p,viewBoxDimension:p.height}),y=aAe({translateX:b,translateY:_,useTranslate3d:i})):y=iAe,{cssProperties:y,cssClasses:oAe({translateX:b,translateY:_,coordinate:r})}}function Im(e){"@babel/helpers - typeof";return Im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Im(e)}function c$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function u$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c$(Object(r),!0).forEach(function(n){mk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iX(n.key),n)}}function cAe(e,t,r){return t&&d$(e.prototype,t),r&&d$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uAe(e,t,r){return t=iS(t),dAe(e,nX()?Reflect.construct(t,r||[],iS(e).constructor):t.apply(e,r))}function dAe(e,t){if(t&&(Im(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hAe(e)}function hAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nX=function(){return!!e})()}function iS(e){return iS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iS(e)}function fAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pk(e,t)}function pk(e,t){return pk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pk(e,t)}function mk(e,t,r){return t=iX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iX(e){var t=pAe(e,"string");return Im(t)=="symbol"?t:t+""}function pAe(e,t){if(Im(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Im(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h$=1,mAe=function(e){function t(){var r;lAe(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r=uAe(this,t,[].concat(o)),mk(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),mk(r,"handleKeyDown",function(h){if(h.key==="Escape"){var i,p,y,b;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(p=r.props.coordinate)===null||p===void 0?void 0:p.x)!==null&&i!==void 0?i:0,y:(y=(b=r.props.coordinate)===null||b===void 0?void 0:b.y)!==null&&y!==void 0?y:0}})}}),r}return fAe(t,e),cAe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>h$||Math.abs(n.height-this.state.lastBoundingBox.height)>h$)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,o;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,o=this.props,s=o.active,h=o.allowEscapeViewBox,i=o.animationDuration,p=o.animationEasing,y=o.children,b=o.coordinate,_=o.hasPayload,E=o.isAnimationActive,C=o.offset,k=o.position,N=o.reverseDirection,I=o.useTranslate3d,B=o.viewBox,O=o.wrapperStyle,R=sAe({allowEscapeViewBox:h,coordinate:b,offsetTopLeft:C,position:k,reverseDirection:N,tooltipBox:this.state.lastBoundingBox,useTranslate3d:I,viewBox:B}),q=R.cssClasses,F=R.cssProperties,X=u$(u$({transition:E&&s?"transform ".concat(i,"ms ").concat(p):void 0},F),{},{pointerEvents:"none",visibility:!this.state.dismissed&&s&&_?"visible":"hidden",position:"absolute",top:0,left:0},O);return je.createElement("div",{tabIndex:-1,className:q,style:X,ref:function(ee){n.wrapperNode=ee}},y)}}])}(D.PureComponent),gAe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Tc={isSsr:gAe(),get:function(t){return Tc[t]},set:function(t,r){if(typeof t=="string")Tc[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(o){Tc[o]=t[o]})}}};function Om(e){"@babel/helpers - typeof";return Om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Om(e)}function f$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function p$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f$(Object(r),!0).forEach(function(n){nO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aX(n.key),n)}}function vAe(e,t,r){return t&&m$(e.prototype,t),r&&m$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xAe(e,t,r){return t=oS(t),bAe(e,oX()?Reflect.construct(t,r||[],oS(e).constructor):t.apply(e,r))}function bAe(e,t){if(t&&(Om(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Ae(e)}function _Ae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oX=function(){return!!e})()}function oS(e){return oS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oS(e)}function wAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gk(e,t)}function gk(e,t){return gk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gk(e,t)}function nO(e,t,r){return t=aX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aX(e){var t=SAe(e,"string");return Om(t)=="symbol"?t:t+""}function SAe(e,t){if(Om(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Om(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EAe(e){return e.dataKey}function TAe(e,t){return je.isValidElement(e)?je.cloneElement(e,t):typeof e=="function"?je.createElement(e,t):je.createElement(tAe,t)}var Bs=function(e){function t(){return yAe(this,t),xAe(this,t,arguments)}return wAe(t,e),vAe(t,[{key:"render",value:function(){var n=this,o=this.props,s=o.active,h=o.allowEscapeViewBox,i=o.animationDuration,p=o.animationEasing,y=o.content,b=o.coordinate,_=o.filterNull,E=o.isAnimationActive,C=o.offset,k=o.payload,N=o.payloadUniqBy,I=o.position,B=o.reverseDirection,O=o.useTranslate3d,R=o.viewBox,q=o.wrapperStyle,F=k??[];_&&F.length&&(F=ZH(k.filter(function(G){return G.value!=null&&(G.hide!==!0||n.props.includeHidden)}),N,EAe));var X=F.length>0;return je.createElement(mAe,{allowEscapeViewBox:h,animationDuration:i,animationEasing:p,isAnimationActive:E,active:s,coordinate:b,hasPayload:X,offset:C,position:I,reverseDirection:B,useTranslate3d:O,viewBox:R,wrapperStyle:q},TAe(y,p$(p$({},this.props),{},{payload:F})))}}])}(D.PureComponent);nO(Bs,"displayName","Tooltip");nO(Bs,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Tc.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var jAe=Rl,CAe=function(){return jAe.Date.now()},PAe=CAe,AAe=/\s/;function kAe(e){for(var t=e.length;t--&&AAe.test(e.charAt(t)););return t}var NAe=kAe,MAe=NAe,IAe=/^\s+/;function OAe(e){return e&&e.slice(0,MAe(e)+1).replace(IAe,"")}var DAe=OAe,RAe=DAe,g$=Pd,LAe=xg,y$=0/0,BAe=/^[-+]0x[0-9a-f]+$/i,zAe=/^0b[01]+$/i,$Ae=/^0o[0-7]+$/i,FAe=parseInt;function UAe(e){if(typeof e=="number")return e;if(LAe(e))return y$;if(g$(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=g$(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=RAe(e);var r=zAe.test(e);return r||$Ae.test(e)?FAe(e.slice(2),r?2:8):BAe.test(e)?y$:+e}var sX=UAe,VAe=Pd,BC=PAe,v$=sX,qAe="Expected a function",WAe=Math.max,GAe=Math.min;function HAe(e,t,r){var n,o,s,h,i,p,y=0,b=!1,_=!1,E=!0;if(typeof e!="function")throw new TypeError(qAe);t=v$(t)||0,VAe(r)&&(b=!!r.leading,_="maxWait"in r,s=_?WAe(v$(r.maxWait)||0,t):s,E="trailing"in r?!!r.trailing:E);function C(X){var G=n,ee=o;return n=o=void 0,y=X,h=e.apply(ee,G),h}function k(X){return y=X,i=setTimeout(B,t),b?C(X):h}function N(X){var G=X-p,ee=X-y,K=t-G;return _?GAe(K,s-ee):K}function I(X){var G=X-p,ee=X-y;return p===void 0||G>=t||G<0||_&&ee>=s}function B(){var X=BC();if(I(X))return O(X);i=setTimeout(B,N(X))}function O(X){return i=void 0,E&&n?C(X):(n=o=void 0,h)}function R(){i!==void 0&&clearTimeout(i),y=0,n=p=o=i=void 0}function q(){return i===void 0?h:O(BC())}function F(){var X=BC(),G=I(X);if(n=arguments,o=this,p=X,G){if(i===void 0)return k(p);if(_)return clearTimeout(i),i=setTimeout(B,t),C(p)}return i===void 0&&(i=setTimeout(B,t)),h}return F.cancel=R,F.flush=q,F}var XAe=HAe,ZAe=XAe,KAe=Pd,YAe="Expected a function";function JAe(e,t,r){var n=!0,o=!0;if(typeof e!="function")throw new TypeError(YAe);return KAe(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),ZAe(e,t,{leading:n,maxWait:t,trailing:o})}var QAe=JAe;const lX=wn(QAe);function Xx(e){"@babel/helpers - typeof";return Xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xx(e)}function x$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function fw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x$(Object(r),!0).forEach(function(n){eke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eke(e,t,r){return t=tke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tke(e){var t=rke(e,"string");return Xx(t)=="symbol"?t:t+""}function rke(e,t){if(Xx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nke(e,t){return ske(e)||ake(e,t)||oke(e,t)||ike()}function ike(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oke(e,t){if(e){if(typeof e=="string")return b$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b$(e,t)}}function b$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ake(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,h,i=[],p=!0,y=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);p=!0);}catch(b){y=!0,o=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return i}}function ske(e){if(Array.isArray(e))return e}var cX=D.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,o=n===void 0?{width:-1,height:-1}:n,s=e.width,h=s===void 0?"100%":s,i=e.height,p=i===void 0?"100%":i,y=e.minWidth,b=y===void 0?0:y,_=e.minHeight,E=e.maxHeight,C=e.children,k=e.debounce,N=k===void 0?0:k,I=e.id,B=e.className,O=e.onResize,R=e.style,q=R===void 0?{}:R,F=D.useRef(null),X=D.useRef();X.current=O,D.useImperativeHandle(t,function(){return Object.defineProperty(F.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),F.current},configurable:!0})});var G=D.useState({containerWidth:o.width,containerHeight:o.height}),ee=nke(G,2),K=ee[0],ie=ee[1],pe=D.useCallback(function(_e,Ee){ie(function(xe){var ce=Math.round(_e),ke=Math.round(Ee);return xe.containerWidth===ce&&xe.containerHeight===ke?xe:{containerWidth:ce,containerHeight:ke}})},[]);D.useEffect(function(){var _e=function(Pe){var Re,Be=Pe[0].contentRect,Fe=Be.width,Ge=Be.height;pe(Fe,Ge),(Re=X.current)===null||Re===void 0||Re.call(X,Fe,Ge)};N>0&&(_e=lX(_e,N,{trailing:!0,leading:!1}));var Ee=new ResizeObserver(_e),xe=F.current.getBoundingClientRect(),ce=xe.width,ke=xe.height;return pe(ce,ke),Ee.observe(F.current),function(){Ee.disconnect()}},[pe,N]);var ae=D.useMemo(function(){var _e=K.containerWidth,Ee=K.containerHeight;if(_e<0||Ee<0)return null;Ec(Uh(h)||Uh(p),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,h,p),Ec(!r||r>0,"The aspect(%s) must be greater than zero.",r);var xe=Uh(h)?_e:h,ce=Uh(p)?Ee:p;r&&r>0&&(xe?ce=xe/r:ce&&(xe=ce*r),E&&ce>E&&(ce=E)),Ec(xe>0||ce>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,xe,ce,h,p,b,_,r);var ke=!Array.isArray(C)&&Sc(C.type).endsWith("Chart");return je.Children.map(C,function(ve){return je.isValidElement(ve)?D.cloneElement(ve,fw({width:xe,height:ce},ke?{style:fw({height:"100%",width:"100%",maxHeight:ce,maxWidth:xe},ve.props.style)}:{})):ve})},[r,C,p,E,_,b,K,h]);return je.createElement("div",{id:I?"".concat(I):void 0,className:Zr("recharts-responsive-container",B),style:fw(fw({},q),{},{width:h,height:p,minWidth:b,minHeight:_,maxHeight:E}),ref:F},ae)}),uX=function(t){return null};uX.displayName="Cell";function Zx(e){"@babel/helpers - typeof";return Zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zx(e)}function _$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function yk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_$(Object(r),!0).forEach(function(n){lke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lke(e,t,r){return t=cke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cke(e){var t=uke(e,"string");return Zx(t)=="symbol"?t:t+""}function uke(e,t){if(Zx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rp={widthCache:{},cacheCount:0},dke=2e3,hke={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},w$="recharts_measurement_span";function fke(e){var t=yk({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var dx=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Tc.isSsr)return{width:0,height:0};var n=fke(r),o=JSON.stringify({text:t,copyStyle:n});if(Rp.widthCache[o])return Rp.widthCache[o];try{var s=document.getElementById(w$);s||(s=document.createElement("span"),s.setAttribute("id",w$),s.setAttribute("aria-hidden","true"),document.body.appendChild(s));var h=yk(yk({},hke),n);Object.assign(s.style,h),s.textContent="".concat(t);var i=s.getBoundingClientRect(),p={width:i.width,height:i.height};return Rp.widthCache[o]=p,++Rp.cacheCount>dke&&(Rp.cacheCount=0,Rp.widthCache={}),p}catch{return{width:0,height:0}}},pke=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Kx(e){"@babel/helpers - typeof";return Kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kx(e)}function aS(e,t){return vke(e)||yke(e,t)||gke(e,t)||mke()}function mke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gke(e,t){if(e){if(typeof e=="string")return S$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S$(e,t)}}function S$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,h,i=[],p=!0,y=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);p=!0);}catch(b){y=!0,o=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return i}}function vke(e){if(Array.isArray(e))return e}function xke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ke(n.key),n)}}function bke(e,t,r){return t&&E$(e.prototype,t),r&&E$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ke(e){var t=wke(e,"string");return Kx(t)=="symbol"?t:t+""}function wke(e,t){if(Kx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var T$=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,j$=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Ske=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Eke=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,dX={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Tke=Object.keys(dX),nm="NaN";function jke(e,t){return e*dX[t]}var pw=function(){function e(t,r){xke(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!Ske.test(r)&&(this.num=NaN,this.unit=""),Tke.includes(r)&&(this.num=jke(t,r),this.unit="px")}return bke(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,o=(n=Eke.exec(r))!==null&&n!==void 0?n:[],s=aS(o,3),h=s[1],i=s[2];return new e(parseFloat(h),i??"")}}])}();function hX(e){if(e.includes(nm))return nm;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=T$.exec(t))!==null&&r!==void 0?r:[],o=aS(n,4),s=o[1],h=o[2],i=o[3],p=pw.parse(s??""),y=pw.parse(i??""),b=h==="*"?p.multiply(y):p.divide(y);if(b.isNaN())return nm;t=t.replace(T$,b.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var _,E=(_=j$.exec(t))!==null&&_!==void 0?_:[],C=aS(E,4),k=C[1],N=C[2],I=C[3],B=pw.parse(k??""),O=pw.parse(I??""),R=N==="+"?B.add(O):B.subtract(O);if(R.isNaN())return nm;t=t.replace(j$,R.toString())}return t}var C$=/\(([^()]*)\)/;function Cke(e){for(var t=e;t.includes("(");){var r=C$.exec(t),n=aS(r,2),o=n[1];t=t.replace(C$,hX(o))}return t}function Pke(e){var t=e.replace(/\s+/g,"");return t=Cke(t),t=hX(t),t}function Ake(e){try{return Pke(e)}catch{return nm}}function zC(e){var t=Ake(e.slice(5,-1));return t===nm?"":t}var kke=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Nke=["dx","dy","angle","className","breakAll"];function vk(){return vk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vk.apply(this,arguments)}function P$(e,t){if(e==null)return{};var r=Mke(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Mke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function A$(e,t){return Rke(e)||Dke(e,t)||Oke(e,t)||Ike()}function Ike(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oke(e,t){if(e){if(typeof e=="string")return k$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k$(e,t)}}function k$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,h,i=[],p=!0,y=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);p=!0);}catch(b){y=!0,o=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return i}}function Rke(e){if(Array.isArray(e))return e}var fX=/[ \f\n\r\t\v\u2028\u2029]+/,pX=function(t){var r=t.children,n=t.breakAll,o=t.style;try{var s=[];Wr(r)||(n?s=r.toString().split(""):s=r.toString().split(fX));var h=s.map(function(p){return{word:p,width:dx(p,o).width}}),i=n?0:dx("",o).width;return{wordsWithComputedWidth:h,spaceWidth:i}}catch{return null}},Lke=function(t,r,n,o,s){var h=t.maxLines,i=t.children,p=t.style,y=t.breakAll,b=Ft(h),_=i,E=function(){var xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return xe.reduce(function(ce,ke){var ve=ke.word,Pe=ke.width,Re=ce[ce.length-1];if(Re&&(o==null||s||Re.width+Pe+n<Number(o)))Re.words.push(ve),Re.width+=Pe+n;else{var Be={words:[ve],width:Pe};ce.push(Be)}return ce},[])},C=E(r),k=function(xe){return xe.reduce(function(ce,ke){return ce.width>ke.width?ce:ke})};if(!b)return C;for(var N="",I=function(xe){var ce=_.slice(0,xe),ke=pX({breakAll:y,style:p,children:ce+N}).wordsWithComputedWidth,ve=E(ke),Pe=ve.length>h||k(ve).width>Number(o);return[Pe,ve]},B=0,O=_.length-1,R=0,q;B<=O&&R<=_.length-1;){var F=Math.floor((B+O)/2),X=F-1,G=I(X),ee=A$(G,2),K=ee[0],ie=ee[1],pe=I(F),ae=A$(pe,1),_e=ae[0];if(!K&&!_e&&(B=F+1),K&&_e&&(O=F-1),!K&&_e){q=ie;break}R++}return q||C},N$=function(t){var r=Wr(t)?[]:t.toString().split(fX);return[{words:r}]},Bke=function(t){var r=t.width,n=t.scaleToFit,o=t.children,s=t.style,h=t.breakAll,i=t.maxLines;if((r||n)&&!Tc.isSsr){var p,y,b=pX({breakAll:h,children:o,style:s});if(b){var _=b.wordsWithComputedWidth,E=b.spaceWidth;p=_,y=E}else return N$(o);return Lke({breakAll:h,children:o,maxLines:i,style:s},p,y,r,n)}return N$(o)},M$="#808080",sS=function(t){var r=t.x,n=r===void 0?0:r,o=t.y,s=o===void 0?0:o,h=t.lineHeight,i=h===void 0?"1em":h,p=t.capHeight,y=p===void 0?"0.71em":p,b=t.scaleToFit,_=b===void 0?!1:b,E=t.textAnchor,C=E===void 0?"start":E,k=t.verticalAnchor,N=k===void 0?"end":k,I=t.fill,B=I===void 0?M$:I,O=P$(t,kke),R=D.useMemo(function(){return Bke({breakAll:O.breakAll,children:O.children,maxLines:O.maxLines,scaleToFit:_,style:O.style,width:O.width})},[O.breakAll,O.children,O.maxLines,_,O.style,O.width]),q=O.dx,F=O.dy,X=O.angle,G=O.className,ee=O.breakAll,K=P$(O,Nke);if(!Li(n)||!Li(s))return null;var ie=n+(Ft(q)?q:0),pe=s+(Ft(F)?F:0),ae;switch(N){case"start":ae=zC("calc(".concat(y,")"));break;case"middle":ae=zC("calc(".concat((R.length-1)/2," * -").concat(i," + (").concat(y," / 2))"));break;default:ae=zC("calc(".concat(R.length-1," * -").concat(i,")"));break}var _e=[];if(_){var Ee=R[0].width,xe=O.width;_e.push("scale(".concat((Ft(xe)?xe/Ee:1)/Ee,")"))}return X&&_e.push("rotate(".concat(X,", ").concat(ie,", ").concat(pe,")")),_e.length&&(K.transform=_e.join(" ")),je.createElement("text",vk({},Xr(K,!0),{x:ie,y:pe,className:Zr("recharts-text",G),textAnchor:C,fill:B.includes("url")?M$:B}),R.map(function(ce,ke){var ve=ce.words.join(ee?"":" ");return je.createElement("tspan",{x:ie,dy:ke===0?ae:i,key:"".concat(ve,"-").concat(ke)},ve)}))};function sd(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function zke(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function iO(e){let t,r,n;e.length!==2?(t=sd,r=(i,p)=>sd(e(i),p),n=(i,p)=>e(i)-p):(t=e===sd||e===zke?e:$ke,r=e,n=e);function o(i,p,y=0,b=i.length){if(y<b){if(t(p,p)!==0)return b;do{const _=y+b>>>1;r(i[_],p)<0?y=_+1:b=_}while(y<b)}return y}function s(i,p,y=0,b=i.length){if(y<b){if(t(p,p)!==0)return b;do{const _=y+b>>>1;r(i[_],p)<=0?y=_+1:b=_}while(y<b)}return y}function h(i,p,y=0,b=i.length){const _=o(i,p,y,b-1);return _>y&&n(i[_-1],p)>-n(i[_],p)?_-1:_}return{left:o,center:h,right:s}}function $ke(){return 0}function mX(e){return e===null?NaN:+e}function*Fke(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}const Uke=iO(sd),Vke=Uke.right;iO(mX).center;const Zb=Vke;class I$ extends Map{constructor(t,r=Gke){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,o]of t)this.set(n,o)}get(t){return super.get(O$(this,t))}has(t){return super.has(O$(this,t))}set(t,r){return super.set(qke(this,t),r)}delete(t){return super.delete(Wke(this,t))}}function O$({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function qke({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function Wke({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function Gke(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Hke(e=sd){if(e===sd)return gX;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function gX(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Xke=Math.sqrt(50),Zke=Math.sqrt(10),Kke=Math.sqrt(2);function lS(e,t,r){const n=(t-e)/Math.max(0,r),o=Math.floor(Math.log10(n)),s=n/Math.pow(10,o),h=s>=Xke?10:s>=Zke?5:s>=Kke?2:1;let i,p,y;return o<0?(y=Math.pow(10,-o)/h,i=Math.round(e*y),p=Math.round(t*y),i/y<e&&++i,p/y>t&&--p,y=-y):(y=Math.pow(10,o)*h,i=Math.round(e/y),p=Math.round(t/y),i*y<e&&++i,p*y>t&&--p),p<i&&.5<=r&&r<2?lS(e,t,r*2):[i,p,y]}function xk(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[o,s,h]=n?lS(t,e,r):lS(e,t,r);if(!(s>=o))return[];const i=s-o+1,p=new Array(i);if(n)if(h<0)for(let y=0;y<i;++y)p[y]=(s-y)/-h;else for(let y=0;y<i;++y)p[y]=(s-y)*h;else if(h<0)for(let y=0;y<i;++y)p[y]=(o+y)/-h;else for(let y=0;y<i;++y)p[y]=(o+y)*h;return p}function bk(e,t,r){return t=+t,e=+e,r=+r,lS(e,t,r)[2]}function _k(e,t,r){t=+t,e=+e,r=+r;const n=t<e,o=n?bk(t,e,r):bk(e,t,r);return(n?-1:1)*(o<0?1/-o:o)}function D$(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&(r<o||r===void 0&&o>=o)&&(r=o)}return r}function R$(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&(r>o||r===void 0&&o>=o)&&(r=o)}return r}function yX(e,t,r=0,n=1/0,o){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(o=o===void 0?gX:Hke(o);n>r;){if(n-r>600){const p=n-r+1,y=t-r+1,b=Math.log(p),_=.5*Math.exp(2*b/3),E=.5*Math.sqrt(b*_*(p-_)/p)*(y-p/2<0?-1:1),C=Math.max(r,Math.floor(t-y*_/p+E)),k=Math.min(n,Math.floor(t+(p-y)*_/p+E));yX(e,t,C,k,o)}const s=e[t];let h=r,i=n;for(jv(e,r,t),o(e[n],s)>0&&jv(e,r,n);h<i;){for(jv(e,h,i),++h,--i;o(e[h],s)<0;)++h;for(;o(e[i],s)>0;)--i}o(e[r],s)===0?jv(e,r,i):(++i,jv(e,i,n)),i<=t&&(r=i+1),t<=i&&(n=i-1)}return e}function jv(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Yke(e,t,r){if(e=Float64Array.from(Fke(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return R$(e);if(t>=1)return D$(e);var n,o=(n-1)*t,s=Math.floor(o),h=D$(yX(e,s).subarray(0,s+1)),i=R$(e.subarray(s+1));return h+(i-h)*(o-s)}}function Jke(e,t,r=mX){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,o=(n-1)*t,s=Math.floor(o),h=+r(e[s],s,e),i=+r(e[s+1],s+1,e);return h+(i-h)*(o-s)}}function Qke(e,t,r){e=+e,t=+t,r=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+r;for(var n=-1,o=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(o);++n<o;)s[n]=e+n*r;return s}function ls(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Xc(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const wk=Symbol("implicit");function oO(){var e=new I$,t=[],r=[],n=wk;function o(s){let h=e.get(s);if(h===void 0){if(n!==wk)return n;e.set(s,h=t.push(s)-1)}return r[h%r.length]}return o.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new I$;for(const h of s)e.has(h)||e.set(h,t.push(h)-1);return o},o.range=function(s){return arguments.length?(r=Array.from(s),o):r.slice()},o.unknown=function(s){return arguments.length?(n=s,o):n},o.copy=function(){return oO(t,r).unknown(n)},ls.apply(o,arguments),o}function Yx(){var e=oO().unknown(void 0),t=e.domain,r=e.range,n=0,o=1,s,h,i=!1,p=0,y=0,b=.5;delete e.unknown;function _(){var E=t().length,C=o<n,k=C?o:n,N=C?n:o;s=(N-k)/Math.max(1,E-p+y*2),i&&(s=Math.floor(s)),k+=(N-k-s*(E-p))*b,h=s*(1-p),i&&(k=Math.round(k),h=Math.round(h));var I=Qke(E).map(function(B){return k+s*B});return r(C?I.reverse():I)}return e.domain=function(E){return arguments.length?(t(E),_()):t()},e.range=function(E){return arguments.length?([n,o]=E,n=+n,o=+o,_()):[n,o]},e.rangeRound=function(E){return[n,o]=E,n=+n,o=+o,i=!0,_()},e.bandwidth=function(){return h},e.step=function(){return s},e.round=function(E){return arguments.length?(i=!!E,_()):i},e.padding=function(E){return arguments.length?(p=Math.min(1,y=+E),_()):p},e.paddingInner=function(E){return arguments.length?(p=Math.min(1,E),_()):p},e.paddingOuter=function(E){return arguments.length?(y=+E,_()):y},e.align=function(E){return arguments.length?(b=Math.max(0,Math.min(1,E)),_()):b},e.copy=function(){return Yx(t(),[n,o]).round(i).paddingInner(p).paddingOuter(y).align(b)},ls.apply(_(),arguments)}function vX(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return vX(t())},e}function hx(){return vX(Yx.apply(null,arguments).paddingInner(1))}function aO(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function xX(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Kb(){}var Jx=.7,cS=1/Jx,gm="\\s*([+-]?\\d+)\\s*",Qx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",kl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eNe=/^#([0-9a-f]{3,8})$/,tNe=new RegExp(`^rgb\\(${gm},${gm},${gm}\\)$`),rNe=new RegExp(`^rgb\\(${kl},${kl},${kl}\\)$`),nNe=new RegExp(`^rgba\\(${gm},${gm},${gm},${Qx}\\)$`),iNe=new RegExp(`^rgba\\(${kl},${kl},${kl},${Qx}\\)$`),oNe=new RegExp(`^hsl\\(${Qx},${kl},${kl}\\)$`),aNe=new RegExp(`^hsla\\(${Qx},${kl},${kl},${Qx}\\)$`),L$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};aO(Kb,eb,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:B$,formatHex:B$,formatHex8:sNe,formatHsl:lNe,formatRgb:z$,toString:z$});function B$(){return this.rgb().formatHex()}function sNe(){return this.rgb().formatHex8()}function lNe(){return bX(this).formatHsl()}function z$(){return this.rgb().formatRgb()}function eb(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=eNe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?$$(t):r===3?new ta(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?mw(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?mw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=tNe.exec(e))?new ta(t[1],t[2],t[3],1):(t=rNe.exec(e))?new ta(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=nNe.exec(e))?mw(t[1],t[2],t[3],t[4]):(t=iNe.exec(e))?mw(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=oNe.exec(e))?V$(t[1],t[2]/100,t[3]/100,1):(t=aNe.exec(e))?V$(t[1],t[2]/100,t[3]/100,t[4]):L$.hasOwnProperty(e)?$$(L$[e]):e==="transparent"?new ta(NaN,NaN,NaN,0):null}function $$(e){return new ta(e>>16&255,e>>8&255,e&255,1)}function mw(e,t,r,n){return n<=0&&(e=t=r=NaN),new ta(e,t,r,n)}function cNe(e){return e instanceof Kb||(e=eb(e)),e?(e=e.rgb(),new ta(e.r,e.g,e.b,e.opacity)):new ta}function Sk(e,t,r,n){return arguments.length===1?cNe(e):new ta(e,t,r,n??1)}function ta(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}aO(ta,Sk,xX(Kb,{brighter(e){return e=e==null?cS:Math.pow(cS,e),new ta(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Jx:Math.pow(Jx,e),new ta(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ta(Xh(this.r),Xh(this.g),Xh(this.b),uS(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:F$,formatHex:F$,formatHex8:uNe,formatRgb:U$,toString:U$}));function F$(){return`#${Vh(this.r)}${Vh(this.g)}${Vh(this.b)}`}function uNe(){return`#${Vh(this.r)}${Vh(this.g)}${Vh(this.b)}${Vh((isNaN(this.opacity)?1:this.opacity)*255)}`}function U$(){const e=uS(this.opacity);return`${e===1?"rgb(":"rgba("}${Xh(this.r)}, ${Xh(this.g)}, ${Xh(this.b)}${e===1?")":`, ${e})`}`}function uS(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Xh(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Vh(e){return e=Xh(e),(e<16?"0":"")+e.toString(16)}function V$(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Vs(e,t,r,n)}function bX(e){if(e instanceof Vs)return new Vs(e.h,e.s,e.l,e.opacity);if(e instanceof Kb||(e=eb(e)),!e)return new Vs;if(e instanceof Vs)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,o=Math.min(t,r,n),s=Math.max(t,r,n),h=NaN,i=s-o,p=(s+o)/2;return i?(t===s?h=(r-n)/i+(r<n)*6:r===s?h=(n-t)/i+2:h=(t-r)/i+4,i/=p<.5?s+o:2-s-o,h*=60):i=p>0&&p<1?0:h,new Vs(h,i,p,e.opacity)}function dNe(e,t,r,n){return arguments.length===1?bX(e):new Vs(e,t,r,n??1)}function Vs(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}aO(Vs,dNe,xX(Kb,{brighter(e){return e=e==null?cS:Math.pow(cS,e),new Vs(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Jx:Math.pow(Jx,e),new Vs(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,o=2*r-n;return new ta($C(e>=240?e-240:e+120,o,n),$C(e,o,n),$C(e<120?e+240:e-120,o,n),this.opacity)},clamp(){return new Vs(q$(this.h),gw(this.s),gw(this.l),uS(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=uS(this.opacity);return`${e===1?"hsl(":"hsla("}${q$(this.h)}, ${gw(this.s)*100}%, ${gw(this.l)*100}%${e===1?")":`, ${e})`}`}}));function q$(e){return e=(e||0)%360,e<0?e+360:e}function gw(e){return Math.max(0,Math.min(1,e||0))}function $C(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const sO=e=>()=>e;function hNe(e,t){return function(r){return e+r*t}}function fNe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function pNe(e){return(e=+e)==1?_X:function(t,r){return r-t?fNe(t,r,e):sO(isNaN(t)?r:t)}}function _X(e,t){var r=t-e;return r?hNe(e,r):sO(isNaN(e)?t:e)}const W$=function e(t){var r=pNe(t);function n(o,s){var h=r((o=Sk(o)).r,(s=Sk(s)).r),i=r(o.g,s.g),p=r(o.b,s.b),y=_X(o.opacity,s.opacity);return function(b){return o.r=h(b),o.g=i(b),o.b=p(b),o.opacity=y(b),o+""}}return n.gamma=e,n}(1);function mNe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),o;return function(s){for(o=0;o<r;++o)n[o]=e[o]*(1-s)+t[o]*s;return n}}function gNe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function yNe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,o=new Array(n),s=new Array(r),h;for(h=0;h<n;++h)o[h]=Cg(e[h],t[h]);for(;h<r;++h)s[h]=t[h];return function(i){for(h=0;h<n;++h)s[h]=o[h](i);return s}}function vNe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function dS(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function xNe(e,t){var r={},n={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?r[o]=Cg(e[o],t[o]):n[o]=t[o];return function(s){for(o in r)n[o]=r[o](s);return n}}var Ek=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,FC=new RegExp(Ek.source,"g");function bNe(e){return function(){return e}}function _Ne(e){return function(t){return e(t)+""}}function wNe(e,t){var r=Ek.lastIndex=FC.lastIndex=0,n,o,s,h=-1,i=[],p=[];for(e=e+"",t=t+"";(n=Ek.exec(e))&&(o=FC.exec(t));)(s=o.index)>r&&(s=t.slice(r,s),i[h]?i[h]+=s:i[++h]=s),(n=n[0])===(o=o[0])?i[h]?i[h]+=o:i[++h]=o:(i[++h]=null,p.push({i:h,x:dS(n,o)})),r=FC.lastIndex;return r<t.length&&(s=t.slice(r),i[h]?i[h]+=s:i[++h]=s),i.length<2?p[0]?_Ne(p[0].x):bNe(t):(t=p.length,function(y){for(var b=0,_;b<t;++b)i[(_=p[b]).i]=_.x(y);return i.join("")})}function Cg(e,t){var r=typeof t,n;return t==null||r==="boolean"?sO(t):(r==="number"?dS:r==="string"?(n=eb(t))?(t=n,W$):wNe:t instanceof eb?W$:t instanceof Date?vNe:gNe(t)?mNe:Array.isArray(t)?yNe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?xNe:dS)(e,t)}function lO(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function SNe(e,t){t===void 0&&(t=e,e=Cg);for(var r=0,n=t.length-1,o=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(o,o=t[++r]);return function(h){var i=Math.max(0,Math.min(n-1,Math.floor(h*=n)));return s[i](h-i)}}function ENe(e){return function(){return e}}function hS(e){return+e}var G$=[0,1];function Do(e){return e}function Tk(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:ENe(isNaN(t)?NaN:.5)}function TNe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function jNe(e,t,r){var n=e[0],o=e[1],s=t[0],h=t[1];return o<n?(n=Tk(o,n),s=r(h,s)):(n=Tk(n,o),s=r(s,h)),function(i){return s(n(i))}}function CNe(e,t,r){var n=Math.min(e.length,t.length)-1,o=new Array(n),s=new Array(n),h=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++h<n;)o[h]=Tk(e[h],e[h+1]),s[h]=r(t[h],t[h+1]);return function(i){var p=Zb(e,i,1,n)-1;return s[p](o[p](i))}}function Yb(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function gE(){var e=G$,t=G$,r=Cg,n,o,s,h=Do,i,p,y;function b(){var E=Math.min(e.length,t.length);return h!==Do&&(h=TNe(e[0],e[E-1])),i=E>2?CNe:jNe,p=y=null,_}function _(E){return E==null||isNaN(E=+E)?s:(p||(p=i(e.map(n),t,r)))(n(h(E)))}return _.invert=function(E){return h(o((y||(y=i(t,e.map(n),dS)))(E)))},_.domain=function(E){return arguments.length?(e=Array.from(E,hS),b()):e.slice()},_.range=function(E){return arguments.length?(t=Array.from(E),b()):t.slice()},_.rangeRound=function(E){return t=Array.from(E),r=lO,b()},_.clamp=function(E){return arguments.length?(h=E?!0:Do,b()):h!==Do},_.interpolate=function(E){return arguments.length?(r=E,b()):r},_.unknown=function(E){return arguments.length?(s=E,_):s},function(E,C){return n=E,o=C,b()}}function cO(){return gE()(Do,Do)}function PNe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function fS(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Dm(e){return e=fS(Math.abs(e)),e?e[1]:NaN}function ANe(e,t){return function(r,n){for(var o=r.length,s=[],h=0,i=e[0],p=0;o>0&&i>0&&(p+i+1>n&&(i=Math.max(1,n-p)),s.push(r.substring(o-=i,o+i)),!((p+=i+1)>n));)i=e[h=(h+1)%e.length];return s.reverse().join(t)}}function kNe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var NNe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tb(e){if(!(t=NNe.exec(e)))throw new Error("invalid format: "+e);var t;return new uO({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}tb.prototype=uO.prototype;function uO(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}uO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function MNe(e){e:for(var t=e.length,r=1,n=-1,o;r<t;++r)switch(e[r]){case".":n=o=r;break;case"0":n===0&&(n=r),o=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(o+1):e}var wX;function INe(e,t){var r=fS(e,t);if(!r)return e+"";var n=r[0],o=r[1],s=o-(wX=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,h=n.length;return s===h?n:s>h?n+new Array(s-h+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+fS(e,Math.max(0,t+s-1))[0]}function H$(e,t){var r=fS(e,t);if(!r)return e+"";var n=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+n:n.length>o+1?n.slice(0,o+1)+"."+n.slice(o+1):n+new Array(o-n.length+2).join("0")}const X$={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:PNe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>H$(e*100,t),r:H$,s:INe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Z$(e){return e}var K$=Array.prototype.map,Y$=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function ONe(e){var t=e.grouping===void 0||e.thousands===void 0?Z$:ANe(K$.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Z$:kNe(K$.call(e.numerals,String)),h=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"":e.minus+"",p=e.nan===void 0?"NaN":e.nan+"";function y(_){_=tb(_);var E=_.fill,C=_.align,k=_.sign,N=_.symbol,I=_.zero,B=_.width,O=_.comma,R=_.precision,q=_.trim,F=_.type;F==="n"?(O=!0,F="g"):X$[F]||(R===void 0&&(R=12),q=!0,F="g"),(I||E==="0"&&C==="=")&&(I=!0,E="0",C="=");var X=N==="$"?r:N==="#"&&/[boxX]/.test(F)?"0"+F.toLowerCase():"",G=N==="$"?n:/[%p]/.test(F)?h:"",ee=X$[F],K=/[defgprs%]/.test(F);R=R===void 0?6:/[gprs]/.test(F)?Math.max(1,Math.min(21,R)):Math.max(0,Math.min(20,R));function ie(pe){var ae=X,_e=G,Ee,xe,ce;if(F==="c")_e=ee(pe)+_e,pe="";else{pe=+pe;var ke=pe<0||1/pe<0;if(pe=isNaN(pe)?p:ee(Math.abs(pe),R),q&&(pe=MNe(pe)),ke&&+pe==0&&k!=="+"&&(ke=!1),ae=(ke?k==="("?k:i:k==="-"||k==="("?"":k)+ae,_e=(F==="s"?Y$[8+wX/3]:"")+_e+(ke&&k==="("?")":""),K){for(Ee=-1,xe=pe.length;++Ee<xe;)if(ce=pe.charCodeAt(Ee),48>ce||ce>57){_e=(ce===46?o+pe.slice(Ee+1):pe.slice(Ee))+_e,pe=pe.slice(0,Ee);break}}}O&&!I&&(pe=t(pe,1/0));var ve=ae.length+pe.length+_e.length,Pe=ve<B?new Array(B-ve+1).join(E):"";switch(O&&I&&(pe=t(Pe+pe,Pe.length?B-_e.length:1/0),Pe=""),C){case"<":pe=ae+pe+_e+Pe;break;case"=":pe=ae+Pe+pe+_e;break;case"^":pe=Pe.slice(0,ve=Pe.length>>1)+ae+pe+_e+Pe.slice(ve);break;default:pe=Pe+ae+pe+_e;break}return s(pe)}return ie.toString=function(){return _+""},ie}function b(_,E){var C=y((_=tb(_),_.type="f",_)),k=Math.max(-8,Math.min(8,Math.floor(Dm(E)/3)))*3,N=Math.pow(10,-k),I=Y$[8+k/3];return function(B){return C(N*B)+I}}return{format:y,formatPrefix:b}}var yw,dO,SX;DNe({thousands:",",grouping:[3],currency:["$",""]});function DNe(e){return yw=ONe(e),dO=yw.format,SX=yw.formatPrefix,yw}function RNe(e){return Math.max(0,-Dm(Math.abs(e)))}function LNe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Dm(t)/3)))*3-Dm(Math.abs(e)))}function BNe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Dm(t)-Dm(e))+1}function EX(e,t,r,n){var o=_k(e,t,r),s;switch(n=tb(n??",f"),n.type){case"s":{var h=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(s=LNe(o,h))&&(n.precision=s),SX(n,h)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=BNe(o,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=RNe(o))&&(n.precision=s-(n.type==="%")*2);break}}return dO(n)}function kd(e){var t=e.domain;return e.ticks=function(r){var n=t();return xk(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var o=t();return EX(o[0],o[o.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),o=0,s=n.length-1,h=n[o],i=n[s],p,y,b=10;for(i<h&&(y=h,h=i,i=y,y=o,o=s,s=y);b-- >0;){if(y=bk(h,i,r),y===p)return n[o]=h,n[s]=i,t(n);if(y>0)h=Math.floor(h/y)*y,i=Math.ceil(i/y)*y;else if(y<0)h=Math.ceil(h*y)/y,i=Math.floor(i*y)/y;else break;p=y}return e},e}function pS(){var e=cO();return e.copy=function(){return Yb(e,pS())},ls.apply(e,arguments),kd(e)}function TX(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,hS),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return TX(e).unknown(t)},e=arguments.length?Array.from(e,hS):[0,1],kd(r)}function jX(e,t){e=e.slice();var r=0,n=e.length-1,o=e[r],s=e[n],h;return s<o&&(h=r,r=n,n=h,h=o,o=s,s=h),e[r]=t.floor(o),e[n]=t.ceil(s),e}function J$(e){return Math.log(e)}function Q$(e){return Math.exp(e)}function zNe(e){return-Math.log(-e)}function $Ne(e){return-Math.exp(-e)}function FNe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function UNe(e){return e===10?FNe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function VNe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function e5(e){return(t,r)=>-e(-t,r)}function hO(e){const t=e(J$,Q$),r=t.domain;let n=10,o,s;function h(){return o=VNe(n),s=UNe(n),r()[0]<0?(o=e5(o),s=e5(s),e(zNe,$Ne)):e(J$,Q$),t}return t.base=function(i){return arguments.length?(n=+i,h()):n},t.domain=function(i){return arguments.length?(r(i),h()):r()},t.ticks=i=>{const p=r();let y=p[0],b=p[p.length-1];const _=b<y;_&&([y,b]=[b,y]);let E=o(y),C=o(b),k,N;const I=i==null?10:+i;let B=[];if(!(n%1)&&C-E<I){if(E=Math.floor(E),C=Math.ceil(C),y>0){for(;E<=C;++E)for(k=1;k<n;++k)if(N=E<0?k/s(-E):k*s(E),!(N<y)){if(N>b)break;B.push(N)}}else for(;E<=C;++E)for(k=n-1;k>=1;--k)if(N=E>0?k/s(-E):k*s(E),!(N<y)){if(N>b)break;B.push(N)}B.length*2<I&&(B=xk(y,b,I))}else B=xk(E,C,Math.min(C-E,I)).map(s);return _?B.reverse():B},t.tickFormat=(i,p)=>{if(i==null&&(i=10),p==null&&(p=n===10?"s":","),typeof p!="function"&&(!(n%1)&&(p=tb(p)).precision==null&&(p.trim=!0),p=dO(p)),i===1/0)return p;const y=Math.max(1,n*i/t.ticks().length);return b=>{let _=b/s(Math.round(o(b)));return _*n<n-.5&&(_*=n),_<=y?p(b):""}},t.nice=()=>r(jX(r(),{floor:i=>s(Math.floor(o(i))),ceil:i=>s(Math.ceil(o(i)))})),t}function CX(){const e=hO(gE()).domain([1,10]);return e.copy=()=>Yb(e,CX()).base(e.base()),ls.apply(e,arguments),e}function t5(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function r5(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function fO(e){var t=1,r=e(t5(t),r5(t));return r.constant=function(n){return arguments.length?e(t5(t=+n),r5(t)):t},kd(r)}function PX(){var e=fO(gE());return e.copy=function(){return Yb(e,PX()).constant(e.constant())},ls.apply(e,arguments)}function n5(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function qNe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function WNe(e){return e<0?-e*e:e*e}function pO(e){var t=e(Do,Do),r=1;function n(){return r===1?e(Do,Do):r===.5?e(qNe,WNe):e(n5(r),n5(1/r))}return t.exponent=function(o){return arguments.length?(r=+o,n()):r},kd(t)}function mO(){var e=pO(gE());return e.copy=function(){return Yb(e,mO()).exponent(e.exponent())},ls.apply(e,arguments),e}function GNe(){return mO.apply(null,arguments).exponent(.5)}function i5(e){return Math.sign(e)*e*e}function HNe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function AX(){var e=cO(),t=[0,1],r=!1,n;function o(s){var h=HNe(e(s));return isNaN(h)?n:r?Math.round(h):h}return o.invert=function(s){return e.invert(i5(s))},o.domain=function(s){return arguments.length?(e.domain(s),o):e.domain()},o.range=function(s){return arguments.length?(e.range((t=Array.from(s,hS)).map(i5)),o):t.slice()},o.rangeRound=function(s){return o.range(s).round(!0)},o.round=function(s){return arguments.length?(r=!!s,o):r},o.clamp=function(s){return arguments.length?(e.clamp(s),o):e.clamp()},o.unknown=function(s){return arguments.length?(n=s,o):n},o.copy=function(){return AX(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},ls.apply(o,arguments),kd(o)}function kX(){var e=[],t=[],r=[],n;function o(){var h=0,i=Math.max(1,t.length);for(r=new Array(i-1);++h<i;)r[h-1]=Jke(e,h/i);return s}function s(h){return h==null||isNaN(h=+h)?n:t[Zb(r,h)]}return s.invertExtent=function(h){var i=t.indexOf(h);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},s.domain=function(h){if(!arguments.length)return e.slice();e=[];for(let i of h)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(sd),o()},s.range=function(h){return arguments.length?(t=Array.from(h),o()):t.slice()},s.unknown=function(h){return arguments.length?(n=h,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return kX().domain(e).range(t).unknown(n)},ls.apply(s,arguments)}function NX(){var e=0,t=1,r=1,n=[.5],o=[0,1],s;function h(p){return p!=null&&p<=p?o[Zb(n,p,0,r)]:s}function i(){var p=-1;for(n=new Array(r);++p<r;)n[p]=((p+1)*t-(p-r)*e)/(r+1);return h}return h.domain=function(p){return arguments.length?([e,t]=p,e=+e,t=+t,i()):[e,t]},h.range=function(p){return arguments.length?(r=(o=Array.from(p)).length-1,i()):o.slice()},h.invertExtent=function(p){var y=o.indexOf(p);return y<0?[NaN,NaN]:y<1?[e,n[0]]:y>=r?[n[r-1],t]:[n[y-1],n[y]]},h.unknown=function(p){return arguments.length&&(s=p),h},h.thresholds=function(){return n.slice()},h.copy=function(){return NX().domain([e,t]).range(o).unknown(s)},ls.apply(kd(h),arguments)}function MX(){var e=[.5],t=[0,1],r,n=1;function o(s){return s!=null&&s<=s?t[Zb(e,s,0,n)]:r}return o.domain=function(s){return arguments.length?(e=Array.from(s),n=Math.min(e.length,t.length-1),o):e.slice()},o.range=function(s){return arguments.length?(t=Array.from(s),n=Math.min(e.length,t.length-1),o):t.slice()},o.invertExtent=function(s){var h=t.indexOf(s);return[e[h-1],e[h]]},o.unknown=function(s){return arguments.length?(r=s,o):r},o.copy=function(){return MX().domain(e).range(t).unknown(r)},ls.apply(o,arguments)}const UC=new Date,VC=new Date;function $i(e,t,r,n){function o(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return o.floor=s=>(e(s=new Date(+s)),s),o.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),o.round=s=>{const h=o(s),i=o.ceil(s);return s-h<i-s?h:i},o.offset=(s,h)=>(t(s=new Date(+s),h==null?1:Math.floor(h)),s),o.range=(s,h,i)=>{const p=[];if(s=o.ceil(s),i=i==null?1:Math.floor(i),!(s<h)||!(i>0))return p;let y;do p.push(y=new Date(+s)),t(s,i),e(s);while(y<s&&s<h);return p},o.filter=s=>$i(h=>{if(h>=h)for(;e(h),!s(h);)h.setTime(h-1)},(h,i)=>{if(h>=h)if(i<0)for(;++i<=0;)for(;t(h,-1),!s(h););else for(;--i>=0;)for(;t(h,1),!s(h););}),r&&(o.count=(s,h)=>(UC.setTime(+s),VC.setTime(+h),e(UC),e(VC),Math.floor(r(UC,VC))),o.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?o.filter(n?h=>n(h)%s===0:h=>o.count(0,h)%s===0):o)),o}const mS=$i(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);mS.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?$i(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):mS);mS.range;const yc=1e3,Ja=yc*60,vc=Ja*60,Bc=vc*24,gO=Bc*7,o5=Bc*30,qC=Bc*365,qh=$i(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*yc)},(e,t)=>(t-e)/yc,e=>e.getUTCSeconds());qh.range;const yO=$i(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*yc)},(e,t)=>{e.setTime(+e+t*Ja)},(e,t)=>(t-e)/Ja,e=>e.getMinutes());yO.range;const vO=$i(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ja)},(e,t)=>(t-e)/Ja,e=>e.getUTCMinutes());vO.range;const xO=$i(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*yc-e.getMinutes()*Ja)},(e,t)=>{e.setTime(+e+t*vc)},(e,t)=>(t-e)/vc,e=>e.getHours());xO.range;const bO=$i(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*vc)},(e,t)=>(t-e)/vc,e=>e.getUTCHours());bO.range;const Jb=$i(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ja)/Bc,e=>e.getDate()-1);Jb.range;const yE=$i(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Bc,e=>e.getUTCDate()-1);yE.range;const IX=$i(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Bc,e=>Math.floor(e/Bc));IX.range;function Ef(e){return $i(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ja)/gO)}const vE=Ef(0),gS=Ef(1),XNe=Ef(2),ZNe=Ef(3),Rm=Ef(4),KNe=Ef(5),YNe=Ef(6);vE.range;gS.range;XNe.range;ZNe.range;Rm.range;KNe.range;YNe.range;function Tf(e){return $i(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/gO)}const xE=Tf(0),yS=Tf(1),JNe=Tf(2),QNe=Tf(3),Lm=Tf(4),eMe=Tf(5),tMe=Tf(6);xE.range;yS.range;JNe.range;QNe.range;Lm.range;eMe.range;tMe.range;const _O=$i(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());_O.range;const wO=$i(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());wO.range;const zc=$i(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());zc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:$i(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});zc.range;const $c=$i(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());$c.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:$i(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});$c.range;function OX(e,t,r,n,o,s){const h=[[qh,1,yc],[qh,5,5*yc],[qh,15,15*yc],[qh,30,30*yc],[s,1,Ja],[s,5,5*Ja],[s,15,15*Ja],[s,30,30*Ja],[o,1,vc],[o,3,3*vc],[o,6,6*vc],[o,12,12*vc],[n,1,Bc],[n,2,2*Bc],[r,1,gO],[t,1,o5],[t,3,3*o5],[e,1,qC]];function i(y,b,_){const E=b<y;E&&([y,b]=[b,y]);const C=_&&typeof _.range=="function"?_:p(y,b,_),k=C?C.range(y,+b+1):[];return E?k.reverse():k}function p(y,b,_){const E=Math.abs(b-y)/_,C=iO(([,,I])=>I).right(h,E);if(C===h.length)return e.every(_k(y/qC,b/qC,_));if(C===0)return mS.every(Math.max(_k(y,b,_),1));const[k,N]=h[E/h[C-1][2]<h[C][2]/E?C-1:C];return k.every(N)}return[i,p]}const[rMe,nMe]=OX($c,wO,xE,IX,bO,vO),[iMe,oMe]=OX(zc,_O,vE,Jb,xO,yO);function WC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function GC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Cv(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function aMe(e){var t=e.dateTime,r=e.date,n=e.time,o=e.periods,s=e.days,h=e.shortDays,i=e.months,p=e.shortMonths,y=Pv(o),b=Av(o),_=Pv(s),E=Av(s),C=Pv(h),k=Av(h),N=Pv(i),I=Av(i),B=Pv(p),O=Av(p),R={a:ke,A:ve,b:Pe,B:Re,c:null,d:d5,e:d5,f:AMe,g:zMe,G:FMe,H:jMe,I:CMe,j:PMe,L:DX,m:kMe,M:NMe,p:Be,q:Fe,Q:p5,s:m5,S:MMe,u:IMe,U:OMe,V:DMe,w:RMe,W:LMe,x:null,X:null,y:BMe,Y:$Me,Z:UMe,"%":f5},q={a:Ge,A:Pt,b:$t,B:nr,c:null,d:h5,e:h5,f:GMe,g:rIe,G:iIe,H:VMe,I:qMe,j:WMe,L:LX,m:HMe,M:XMe,p:Nt,q:Jt,Q:p5,s:m5,S:ZMe,u:KMe,U:YMe,V:JMe,w:QMe,W:eIe,x:null,X:null,y:tIe,Y:nIe,Z:oIe,"%":f5},F={a:ie,A:pe,b:ae,B:_e,c:Ee,d:c5,e:c5,f:wMe,g:l5,G:s5,H:u5,I:u5,j:vMe,L:_Me,m:yMe,M:xMe,p:K,q:gMe,Q:EMe,s:TMe,S:bMe,u:dMe,U:hMe,V:fMe,w:uMe,W:pMe,x:xe,X:ce,y:l5,Y:s5,Z:mMe,"%":SMe};R.x=X(r,R),R.X=X(n,R),R.c=X(t,R),q.x=X(r,q),q.X=X(n,q),q.c=X(t,q);function X(ft,vt){return function(lt){var it=[],ar=-1,We=0,pt=ft.length,Wt,cr,Gr;for(lt instanceof Date||(lt=new Date(+lt));++ar<pt;)ft.charCodeAt(ar)===37&&(it.push(ft.slice(We,ar)),(cr=a5[Wt=ft.charAt(++ar)])!=null?Wt=ft.charAt(++ar):cr=Wt==="e"?" ":"0",(Gr=vt[Wt])&&(Wt=Gr(lt,cr)),it.push(Wt),We=ar+1);return it.push(ft.slice(We,ar)),it.join("")}}function G(ft,vt){return function(lt){var it=Cv(1900,void 0,1),ar=ee(it,ft,lt+="",0),We,pt;if(ar!=lt.length)return null;if("Q"in it)return new Date(it.Q);if("s"in it)return new Date(it.s*1e3+("L"in it?it.L:0));if(vt&&!("Z"in it)&&(it.Z=0),"p"in it&&(it.H=it.H%12+it.p*12),it.m===void 0&&(it.m="q"in it?it.q:0),"V"in it){if(it.V<1||it.V>53)return null;"w"in it||(it.w=1),"Z"in it?(We=GC(Cv(it.y,0,1)),pt=We.getUTCDay(),We=pt>4||pt===0?yS.ceil(We):yS(We),We=yE.offset(We,(it.V-1)*7),it.y=We.getUTCFullYear(),it.m=We.getUTCMonth(),it.d=We.getUTCDate()+(it.w+6)%7):(We=WC(Cv(it.y,0,1)),pt=We.getDay(),We=pt>4||pt===0?gS.ceil(We):gS(We),We=Jb.offset(We,(it.V-1)*7),it.y=We.getFullYear(),it.m=We.getMonth(),it.d=We.getDate()+(it.w+6)%7)}else("W"in it||"U"in it)&&("w"in it||(it.w="u"in it?it.u%7:"W"in it?1:0),pt="Z"in it?GC(Cv(it.y,0,1)).getUTCDay():WC(Cv(it.y,0,1)).getDay(),it.m=0,it.d="W"in it?(it.w+6)%7+it.W*7-(pt+5)%7:it.w+it.U*7-(pt+6)%7);return"Z"in it?(it.H+=it.Z/100|0,it.M+=it.Z%100,GC(it)):WC(it)}}function ee(ft,vt,lt,it){for(var ar=0,We=vt.length,pt=lt.length,Wt,cr;ar<We;){if(it>=pt)return-1;if(Wt=vt.charCodeAt(ar++),Wt===37){if(Wt=vt.charAt(ar++),cr=F[Wt in a5?vt.charAt(ar++):Wt],!cr||(it=cr(ft,lt,it))<0)return-1}else if(Wt!=lt.charCodeAt(it++))return-1}return it}function K(ft,vt,lt){var it=y.exec(vt.slice(lt));return it?(ft.p=b.get(it[0].toLowerCase()),lt+it[0].length):-1}function ie(ft,vt,lt){var it=C.exec(vt.slice(lt));return it?(ft.w=k.get(it[0].toLowerCase()),lt+it[0].length):-1}function pe(ft,vt,lt){var it=_.exec(vt.slice(lt));return it?(ft.w=E.get(it[0].toLowerCase()),lt+it[0].length):-1}function ae(ft,vt,lt){var it=B.exec(vt.slice(lt));return it?(ft.m=O.get(it[0].toLowerCase()),lt+it[0].length):-1}function _e(ft,vt,lt){var it=N.exec(vt.slice(lt));return it?(ft.m=I.get(it[0].toLowerCase()),lt+it[0].length):-1}function Ee(ft,vt,lt){return ee(ft,t,vt,lt)}function xe(ft,vt,lt){return ee(ft,r,vt,lt)}function ce(ft,vt,lt){return ee(ft,n,vt,lt)}function ke(ft){return h[ft.getDay()]}function ve(ft){return s[ft.getDay()]}function Pe(ft){return p[ft.getMonth()]}function Re(ft){return i[ft.getMonth()]}function Be(ft){return o[+(ft.getHours()>=12)]}function Fe(ft){return 1+~~(ft.getMonth()/3)}function Ge(ft){return h[ft.getUTCDay()]}function Pt(ft){return s[ft.getUTCDay()]}function $t(ft){return p[ft.getUTCMonth()]}function nr(ft){return i[ft.getUTCMonth()]}function Nt(ft){return o[+(ft.getUTCHours()>=12)]}function Jt(ft){return 1+~~(ft.getUTCMonth()/3)}return{format:function(ft){var vt=X(ft+="",R);return vt.toString=function(){return ft},vt},parse:function(ft){var vt=G(ft+="",!1);return vt.toString=function(){return ft},vt},utcFormat:function(ft){var vt=X(ft+="",q);return vt.toString=function(){return ft},vt},utcParse:function(ft){var vt=G(ft+="",!0);return vt.toString=function(){return ft},vt}}}var a5={"-":"",_:" ",0:"0"},Ki=/^\s*\d+/,sMe=/^%/,lMe=/[\\^$*+?|[\]().{}]/g;function sn(e,t,r){var n=e<0?"-":"",o=(n?-e:e)+"",s=o.length;return n+(s<r?new Array(r-s+1).join(t)+o:o)}function cMe(e){return e.replace(lMe,"\\$&")}function Pv(e){return new RegExp("^(?:"+e.map(cMe).join("|")+")","i")}function Av(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function uMe(e,t,r){var n=Ki.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function dMe(e,t,r){var n=Ki.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function hMe(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function fMe(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function pMe(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function s5(e,t,r){var n=Ki.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function l5(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function mMe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function gMe(e,t,r){var n=Ki.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function yMe(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function c5(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function vMe(e,t,r){var n=Ki.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function u5(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function xMe(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function bMe(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function _Me(e,t,r){var n=Ki.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function wMe(e,t,r){var n=Ki.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function SMe(e,t,r){var n=sMe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function EMe(e,t,r){var n=Ki.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function TMe(e,t,r){var n=Ki.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function d5(e,t){return sn(e.getDate(),t,2)}function jMe(e,t){return sn(e.getHours(),t,2)}function CMe(e,t){return sn(e.getHours()%12||12,t,2)}function PMe(e,t){return sn(1+Jb.count(zc(e),e),t,3)}function DX(e,t){return sn(e.getMilliseconds(),t,3)}function AMe(e,t){return DX(e,t)+"000"}function kMe(e,t){return sn(e.getMonth()+1,t,2)}function NMe(e,t){return sn(e.getMinutes(),t,2)}function MMe(e,t){return sn(e.getSeconds(),t,2)}function IMe(e){var t=e.getDay();return t===0?7:t}function OMe(e,t){return sn(vE.count(zc(e)-1,e),t,2)}function RX(e){var t=e.getDay();return t>=4||t===0?Rm(e):Rm.ceil(e)}function DMe(e,t){return e=RX(e),sn(Rm.count(zc(e),e)+(zc(e).getDay()===4),t,2)}function RMe(e){return e.getDay()}function LMe(e,t){return sn(gS.count(zc(e)-1,e),t,2)}function BMe(e,t){return sn(e.getFullYear()%100,t,2)}function zMe(e,t){return e=RX(e),sn(e.getFullYear()%100,t,2)}function $Me(e,t){return sn(e.getFullYear()%1e4,t,4)}function FMe(e,t){var r=e.getDay();return e=r>=4||r===0?Rm(e):Rm.ceil(e),sn(e.getFullYear()%1e4,t,4)}function UMe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+sn(t/60|0,"0",2)+sn(t%60,"0",2)}function h5(e,t){return sn(e.getUTCDate(),t,2)}function VMe(e,t){return sn(e.getUTCHours(),t,2)}function qMe(e,t){return sn(e.getUTCHours()%12||12,t,2)}function WMe(e,t){return sn(1+yE.count($c(e),e),t,3)}function LX(e,t){return sn(e.getUTCMilliseconds(),t,3)}function GMe(e,t){return LX(e,t)+"000"}function HMe(e,t){return sn(e.getUTCMonth()+1,t,2)}function XMe(e,t){return sn(e.getUTCMinutes(),t,2)}function ZMe(e,t){return sn(e.getUTCSeconds(),t,2)}function KMe(e){var t=e.getUTCDay();return t===0?7:t}function YMe(e,t){return sn(xE.count($c(e)-1,e),t,2)}function BX(e){var t=e.getUTCDay();return t>=4||t===0?Lm(e):Lm.ceil(e)}function JMe(e,t){return e=BX(e),sn(Lm.count($c(e),e)+($c(e).getUTCDay()===4),t,2)}function QMe(e){return e.getUTCDay()}function eIe(e,t){return sn(yS.count($c(e)-1,e),t,2)}function tIe(e,t){return sn(e.getUTCFullYear()%100,t,2)}function rIe(e,t){return e=BX(e),sn(e.getUTCFullYear()%100,t,2)}function nIe(e,t){return sn(e.getUTCFullYear()%1e4,t,4)}function iIe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Lm(e):Lm.ceil(e),sn(e.getUTCFullYear()%1e4,t,4)}function oIe(){return"+0000"}function f5(){return"%"}function p5(e){return+e}function m5(e){return Math.floor(+e/1e3)}var Lp,zX,$X;aIe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function aIe(e){return Lp=aMe(e),zX=Lp.format,Lp.parse,$X=Lp.utcFormat,Lp.utcParse,Lp}function sIe(e){return new Date(e)}function lIe(e){return e instanceof Date?+e:+new Date(+e)}function SO(e,t,r,n,o,s,h,i,p,y){var b=cO(),_=b.invert,E=b.domain,C=y(".%L"),k=y(":%S"),N=y("%I:%M"),I=y("%I %p"),B=y("%a %d"),O=y("%b %d"),R=y("%B"),q=y("%Y");function F(X){return(p(X)<X?C:i(X)<X?k:h(X)<X?N:s(X)<X?I:n(X)<X?o(X)<X?B:O:r(X)<X?R:q)(X)}return b.invert=function(X){return new Date(_(X))},b.domain=function(X){return arguments.length?E(Array.from(X,lIe)):E().map(sIe)},b.ticks=function(X){var G=E();return e(G[0],G[G.length-1],X??10)},b.tickFormat=function(X,G){return G==null?F:y(G)},b.nice=function(X){var G=E();return(!X||typeof X.range!="function")&&(X=t(G[0],G[G.length-1],X??10)),X?E(jX(G,X)):b},b.copy=function(){return Yb(b,SO(e,t,r,n,o,s,h,i,p,y))},b}function cIe(){return ls.apply(SO(iMe,oMe,zc,_O,vE,Jb,xO,yO,qh,zX).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function uIe(){return ls.apply(SO(rMe,nMe,$c,wO,xE,yE,bO,vO,qh,$X).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function bE(){var e=0,t=1,r,n,o,s,h=Do,i=!1,p;function y(_){return _==null||isNaN(_=+_)?p:h(o===0?.5:(_=(s(_)-r)*o,i?Math.max(0,Math.min(1,_)):_))}y.domain=function(_){return arguments.length?([e,t]=_,r=s(e=+e),n=s(t=+t),o=r===n?0:1/(n-r),y):[e,t]},y.clamp=function(_){return arguments.length?(i=!!_,y):i},y.interpolator=function(_){return arguments.length?(h=_,y):h};function b(_){return function(E){var C,k;return arguments.length?([C,k]=E,h=_(C,k),y):[h(0),h(1)]}}return y.range=b(Cg),y.rangeRound=b(lO),y.unknown=function(_){return arguments.length?(p=_,y):p},function(_){return s=_,r=_(e),n=_(t),o=r===n?0:1/(n-r),y}}function Nd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function FX(){var e=kd(bE()(Do));return e.copy=function(){return Nd(e,FX())},Xc.apply(e,arguments)}function UX(){var e=hO(bE()).domain([1,10]);return e.copy=function(){return Nd(e,UX()).base(e.base())},Xc.apply(e,arguments)}function VX(){var e=fO(bE());return e.copy=function(){return Nd(e,VX()).constant(e.constant())},Xc.apply(e,arguments)}function EO(){var e=pO(bE());return e.copy=function(){return Nd(e,EO()).exponent(e.exponent())},Xc.apply(e,arguments)}function dIe(){return EO.apply(null,arguments).exponent(.5)}function qX(){var e=[],t=Do;function r(n){if(n!=null&&!isNaN(n=+n))return t((Zb(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let o of n)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(sd),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,o)=>t(o/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(o,s)=>Yke(e,s/n))},r.copy=function(){return qX(t).domain(e)},Xc.apply(r,arguments)}function _E(){var e=0,t=.5,r=1,n=1,o,s,h,i,p,y=Do,b,_=!1,E;function C(N){return isNaN(N=+N)?E:(N=.5+((N=+b(N))-s)*(n*N<n*s?i:p),y(_?Math.max(0,Math.min(1,N)):N))}C.domain=function(N){return arguments.length?([e,t,r]=N,o=b(e=+e),s=b(t=+t),h=b(r=+r),i=o===s?0:.5/(s-o),p=s===h?0:.5/(h-s),n=s<o?-1:1,C):[e,t,r]},C.clamp=function(N){return arguments.length?(_=!!N,C):_},C.interpolator=function(N){return arguments.length?(y=N,C):y};function k(N){return function(I){var B,O,R;return arguments.length?([B,O,R]=I,y=SNe(N,[B,O,R]),C):[y(0),y(.5),y(1)]}}return C.range=k(Cg),C.rangeRound=k(lO),C.unknown=function(N){return arguments.length?(E=N,C):E},function(N){return b=N,o=N(e),s=N(t),h=N(r),i=o===s?0:.5/(s-o),p=s===h?0:.5/(h-s),n=s<o?-1:1,C}}function WX(){var e=kd(_E()(Do));return e.copy=function(){return Nd(e,WX())},Xc.apply(e,arguments)}function GX(){var e=hO(_E()).domain([.1,1,10]);return e.copy=function(){return Nd(e,GX()).base(e.base())},Xc.apply(e,arguments)}function HX(){var e=fO(_E());return e.copy=function(){return Nd(e,HX()).constant(e.constant())},Xc.apply(e,arguments)}function TO(){var e=pO(_E());return e.copy=function(){return Nd(e,TO()).exponent(e.exponent())},Xc.apply(e,arguments)}function hIe(){return TO.apply(null,arguments).exponent(.5)}const g5=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Yx,scaleDiverging:WX,scaleDivergingLog:GX,scaleDivergingPow:TO,scaleDivergingSqrt:hIe,scaleDivergingSymlog:HX,scaleIdentity:TX,scaleImplicit:wk,scaleLinear:pS,scaleLog:CX,scaleOrdinal:oO,scalePoint:hx,scalePow:mO,scaleQuantile:kX,scaleQuantize:NX,scaleRadial:AX,scaleSequential:FX,scaleSequentialLog:UX,scaleSequentialPow:EO,scaleSequentialQuantile:qX,scaleSequentialSqrt:dIe,scaleSequentialSymlog:VX,scaleSqrt:GNe,scaleSymlog:PX,scaleThreshold:MX,scaleTime:cIe,scaleUtc:uIe,tickFormat:EX},Symbol.toStringTag,{value:"Module"}));var fIe=xg;function pIe(e,t,r){for(var n=-1,o=e.length;++n<o;){var s=e[n],h=t(s);if(h!=null&&(i===void 0?h===h&&!fIe(h):r(h,i)))var i=h,p=s}return p}var XX=pIe;function mIe(e,t){return e>t}var gIe=mIe,yIe=XX,vIe=gIe,xIe=jg;function bIe(e){return e&&e.length?yIe(e,xIe,vIe):void 0}var _Ie=bIe;const wE=wn(_Ie);function wIe(e,t){return e<t}var SIe=wIe,EIe=XX,TIe=SIe,jIe=jg;function CIe(e){return e&&e.length?EIe(e,jIe,TIe):void 0}var PIe=CIe;const SE=wn(PIe);var AIe=zI,kIe=Ad,NIe=tX,MIe=ua;function IIe(e,t){var r=MIe(e)?AIe:NIe;return r(e,kIe(t))}var OIe=IIe,DIe=QH,RIe=OIe;function LIe(e,t){return DIe(RIe(e,t),1)}var BIe=LIe;const zIe=wn(BIe);var $Ie=eO;function FIe(e,t){return $Ie(e,t)}var UIe=FIe;const EE=wn(UIe);var Pg=1e9,VIe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},CO,Gn=!0,os="[DecimalError] ",Zh=os+"Invalid argument: ",jO=os+"Exponent out of range: ",Ag=Math.floor,Dh=Math.pow,qIe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Sa,Hi=1e7,$n=7,ZX=9007199254740991,vS=Ag(ZX/$n),er={};er.absoluteValue=er.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};er.comparedTo=er.cmp=function(e){var t,r,n,o,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(n=s.d.length,o=e.d.length,t=0,r=n<o?n:o;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return n===o?0:n>o^s.s<0?1:-1};er.decimalPlaces=er.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*$n;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};er.dividedBy=er.div=function(e){return jc(this,new this.constructor(e))};er.dividedToIntegerBy=er.idiv=function(e){var t=this,r=t.constructor;return An(jc(t,new r(e),0,1),r.precision)};er.equals=er.eq=function(e){return!this.cmp(e)};er.exponent=function(){return Ci(this)};er.greaterThan=er.gt=function(e){return this.cmp(e)>0};er.greaterThanOrEqualTo=er.gte=function(e){return this.cmp(e)>=0};er.isInteger=er.isint=function(){return this.e>this.d.length-2};er.isNegative=er.isneg=function(){return this.s<0};er.isPositive=er.ispos=function(){return this.s>0};er.isZero=function(){return this.s===0};er.lessThan=er.lt=function(e){return this.cmp(e)<0};er.lessThanOrEqualTo=er.lte=function(e){return this.cmp(e)<1};er.logarithm=er.log=function(e){var t,r=this,n=r.constructor,o=n.precision,s=o+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Sa))throw Error(os+"NaN");if(r.s<1)throw Error(os+(r.s?"NaN":"-Infinity"));return r.eq(Sa)?new n(0):(Gn=!1,t=jc(rb(r,s),rb(e,s),s),Gn=!0,An(t,o))};er.minus=er.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?JX(t,e):KX(t,(e.s=-e.s,e))};er.modulo=er.mod=function(e){var t,r=this,n=r.constructor,o=n.precision;if(e=new n(e),!e.s)throw Error(os+"NaN");return r.s?(Gn=!1,t=jc(r,e,0,1).times(e),Gn=!0,r.minus(t)):An(new n(r),o)};er.naturalExponential=er.exp=function(){return YX(this)};er.naturalLogarithm=er.ln=function(){return rb(this)};er.negated=er.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};er.plus=er.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?KX(t,e):JX(t,(e.s=-e.s,e))};er.precision=er.sd=function(e){var t,r,n,o=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Zh+e);if(t=Ci(o)+1,n=o.d.length-1,r=n*$n+1,n=o.d[n],n){for(;n%10==0;n/=10)r--;for(n=o.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};er.squareRoot=er.sqrt=function(){var e,t,r,n,o,s,h,i=this,p=i.constructor;if(i.s<1){if(!i.s)return new p(0);throw Error(os+"NaN")}for(e=Ci(i),Gn=!1,o=Math.sqrt(+i),o==0||o==1/0?(t=Sl(i.d),(t.length+e)%2==0&&(t+="0"),o=Math.sqrt(t),e=Ag((e+1)/2)-(e<0||e%2),o==1/0?t="5e"+e:(t=o.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new p(t)):n=new p(o.toString()),r=p.precision,o=h=r+3;;)if(s=n,n=s.plus(jc(i,s,h+2)).times(.5),Sl(s.d).slice(0,h)===(t=Sl(n.d)).slice(0,h)){if(t=t.slice(h-3,h+1),o==h&&t=="4999"){if(An(s,r+1,0),s.times(s).eq(i)){n=s;break}}else if(t!="9999")break;h+=4}return Gn=!0,An(n,r)};er.times=er.mul=function(e){var t,r,n,o,s,h,i,p,y,b=this,_=b.constructor,E=b.d,C=(e=new _(e)).d;if(!b.s||!e.s)return new _(0);for(e.s*=b.s,r=b.e+e.e,p=E.length,y=C.length,p<y&&(s=E,E=C,C=s,h=p,p=y,y=h),s=[],h=p+y,n=h;n--;)s.push(0);for(n=y;--n>=0;){for(t=0,o=p+n;o>n;)i=s[o]+C[n]*E[o-n-1]+t,s[o--]=i%Hi|0,t=i/Hi|0;s[o]=(s[o]+t)%Hi|0}for(;!s[--h];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,Gn?An(e,_.precision):e};er.toDecimalPlaces=er.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Il(e,0,Pg),t===void 0?t=n.rounding:Il(t,0,8),An(r,e+Ci(r)+1,t))};er.toExponential=function(e,t){var r,n=this,o=n.constructor;return e===void 0?r=hf(n,!0):(Il(e,0,Pg),t===void 0?t=o.rounding:Il(t,0,8),n=An(new o(n),e+1,t),r=hf(n,!0,e+1)),r};er.toFixed=function(e,t){var r,n,o=this,s=o.constructor;return e===void 0?hf(o):(Il(e,0,Pg),t===void 0?t=s.rounding:Il(t,0,8),n=An(new s(o),e+Ci(o)+1,t),r=hf(n.abs(),!1,e+Ci(n)+1),o.isneg()&&!o.isZero()?"-"+r:r)};er.toInteger=er.toint=function(){var e=this,t=e.constructor;return An(new t(e),Ci(e)+1,t.rounding)};er.toNumber=function(){return+this};er.toPower=er.pow=function(e){var t,r,n,o,s,h,i=this,p=i.constructor,y=12,b=+(e=new p(e));if(!e.s)return new p(Sa);if(i=new p(i),!i.s){if(e.s<1)throw Error(os+"Infinity");return i}if(i.eq(Sa))return i;if(n=p.precision,e.eq(Sa))return An(i,n);if(t=e.e,r=e.d.length-1,h=t>=r,s=i.s,h){if((r=b<0?-b:b)<=ZX){for(o=new p(Sa),t=Math.ceil(n/$n+4),Gn=!1;r%2&&(o=o.times(i),v5(o.d,t)),r=Ag(r/2),r!==0;)i=i.times(i),v5(i.d,t);return Gn=!0,e.s<0?new p(Sa).div(o):An(o,n)}}else if(s<0)throw Error(os+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,i.s=1,Gn=!1,o=e.times(rb(i,n+y)),Gn=!0,o=YX(o),o.s=s,o};er.toPrecision=function(e,t){var r,n,o=this,s=o.constructor;return e===void 0?(r=Ci(o),n=hf(o,r<=s.toExpNeg||r>=s.toExpPos)):(Il(e,1,Pg),t===void 0?t=s.rounding:Il(t,0,8),o=An(new s(o),e,t),r=Ci(o),n=hf(o,e<=r||r<=s.toExpNeg,e)),n};er.toSignificantDigits=er.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Il(e,1,Pg),t===void 0?t=n.rounding:Il(t,0,8)),An(new n(r),e,t)};er.toString=er.valueOf=er.val=er.toJSON=er[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ci(e),r=e.constructor;return hf(e,t<=r.toExpNeg||t>=r.toExpPos)};function KX(e,t){var r,n,o,s,h,i,p,y,b=e.constructor,_=b.precision;if(!e.s||!t.s)return t.s||(t=new b(e)),Gn?An(t,_):t;if(p=e.d,y=t.d,h=e.e,o=t.e,p=p.slice(),s=h-o,s){for(s<0?(n=p,s=-s,i=y.length):(n=y,o=h,i=p.length),h=Math.ceil(_/$n),i=h>i?h+1:i+1,s>i&&(s=i,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(i=p.length,s=y.length,i-s<0&&(s=i,n=y,y=p,p=n),r=0;s;)r=(p[--s]=p[s]+y[s]+r)/Hi|0,p[s]%=Hi;for(r&&(p.unshift(r),++o),i=p.length;p[--i]==0;)p.pop();return t.d=p,t.e=o,Gn?An(t,_):t}function Il(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Zh+e)}function Sl(e){var t,r,n,o=e.length-1,s="",h=e[0];if(o>0){for(s+=h,t=1;t<o;t++)n=e[t]+"",r=$n-n.length,r&&(s+=Fu(r)),s+=n;h=e[t],n=h+"",r=$n-n.length,r&&(s+=Fu(r))}else if(h===0)return"0";for(;h%10===0;)h/=10;return s+h}var jc=function(){function e(n,o){var s,h=0,i=n.length;for(n=n.slice();i--;)s=n[i]*o+h,n[i]=s%Hi|0,h=s/Hi|0;return h&&n.unshift(h),n}function t(n,o,s,h){var i,p;if(s!=h)p=s>h?1:-1;else for(i=p=0;i<s;i++)if(n[i]!=o[i]){p=n[i]>o[i]?1:-1;break}return p}function r(n,o,s){for(var h=0;s--;)n[s]-=h,h=n[s]<o[s]?1:0,n[s]=h*Hi+n[s]-o[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,o,s,h){var i,p,y,b,_,E,C,k,N,I,B,O,R,q,F,X,G,ee,K=n.constructor,ie=n.s==o.s?1:-1,pe=n.d,ae=o.d;if(!n.s)return new K(n);if(!o.s)throw Error(os+"Division by zero");for(p=n.e-o.e,G=ae.length,F=pe.length,C=new K(ie),k=C.d=[],y=0;ae[y]==(pe[y]||0);)++y;if(ae[y]>(pe[y]||0)&&--p,s==null?O=s=K.precision:h?O=s+(Ci(n)-Ci(o))+1:O=s,O<0)return new K(0);if(O=O/$n+2|0,y=0,G==1)for(b=0,ae=ae[0],O++;(y<F||b)&&O--;y++)R=b*Hi+(pe[y]||0),k[y]=R/ae|0,b=R%ae|0;else{for(b=Hi/(ae[0]+1)|0,b>1&&(ae=e(ae,b),pe=e(pe,b),G=ae.length,F=pe.length),q=G,N=pe.slice(0,G),I=N.length;I<G;)N[I++]=0;ee=ae.slice(),ee.unshift(0),X=ae[0],ae[1]>=Hi/2&&++X;do b=0,i=t(ae,N,G,I),i<0?(B=N[0],G!=I&&(B=B*Hi+(N[1]||0)),b=B/X|0,b>1?(b>=Hi&&(b=Hi-1),_=e(ae,b),E=_.length,I=N.length,i=t(_,N,E,I),i==1&&(b--,r(_,G<E?ee:ae,E))):(b==0&&(i=b=1),_=ae.slice()),E=_.length,E<I&&_.unshift(0),r(N,_,I),i==-1&&(I=N.length,i=t(ae,N,G,I),i<1&&(b++,r(N,G<I?ee:ae,I))),I=N.length):i===0&&(b++,N=[0]),k[y++]=b,i&&N[0]?N[I++]=pe[q]||0:(N=[pe[q]],I=1);while((q++<F||N[0]!==void 0)&&O--)}return k[0]||k.shift(),C.e=p,An(C,h?s+Ci(C)+1:s)}}();function YX(e,t){var r,n,o,s,h,i,p=0,y=0,b=e.constructor,_=b.precision;if(Ci(e)>16)throw Error(jO+Ci(e));if(!e.s)return new b(Sa);for(t==null?(Gn=!1,i=_):i=t,h=new b(.03125);e.abs().gte(.1);)e=e.times(h),y+=5;for(n=Math.log(Dh(2,y))/Math.LN10*2+5|0,i+=n,r=o=s=new b(Sa),b.precision=i;;){if(o=An(o.times(e),i),r=r.times(++p),h=s.plus(jc(o,r,i)),Sl(h.d).slice(0,i)===Sl(s.d).slice(0,i)){for(;y--;)s=An(s.times(s),i);return b.precision=_,t==null?(Gn=!0,An(s,_)):s}s=h}}function Ci(e){for(var t=e.e*$n,r=e.d[0];r>=10;r/=10)t++;return t}function HC(e,t,r){if(t>e.LN10.sd())throw Gn=!0,r&&(e.precision=r),Error(os+"LN10 precision limit exceeded");return An(new e(e.LN10),t)}function Fu(e){for(var t="";e--;)t+="0";return t}function rb(e,t){var r,n,o,s,h,i,p,y,b,_=1,E=10,C=e,k=C.d,N=C.constructor,I=N.precision;if(C.s<1)throw Error(os+(C.s?"NaN":"-Infinity"));if(C.eq(Sa))return new N(0);if(t==null?(Gn=!1,y=I):y=t,C.eq(10))return t==null&&(Gn=!0),HC(N,y);if(y+=E,N.precision=y,r=Sl(k),n=r.charAt(0),s=Ci(C),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)C=C.times(e),r=Sl(C.d),n=r.charAt(0),_++;s=Ci(C),n>1?(C=new N("0."+r),s++):C=new N(n+"."+r.slice(1))}else return p=HC(N,y+2,I).times(s+""),C=rb(new N(n+"."+r.slice(1)),y-E).plus(p),N.precision=I,t==null?(Gn=!0,An(C,I)):C;for(i=h=C=jc(C.minus(Sa),C.plus(Sa),y),b=An(C.times(C),y),o=3;;){if(h=An(h.times(b),y),p=i.plus(jc(h,new N(o),y)),Sl(p.d).slice(0,y)===Sl(i.d).slice(0,y))return i=i.times(2),s!==0&&(i=i.plus(HC(N,y+2,I).times(s+""))),i=jc(i,new N(_),y),N.precision=I,t==null?(Gn=!0,An(i,I)):i;i=p,o+=2}}function y5(e,t){var r,n,o;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(o=t.length;t.charCodeAt(o-1)===48;)--o;if(t=t.slice(n,o),t){if(o-=n,r=r-n-1,e.e=Ag(r/$n),e.d=[],n=(r+1)%$n,r<0&&(n+=$n),n<o){for(n&&e.d.push(+t.slice(0,n)),o-=$n;n<o;)e.d.push(+t.slice(n,n+=$n));t=t.slice(n),n=$n-t.length}else n-=o;for(;n--;)t+="0";if(e.d.push(+t),Gn&&(e.e>vS||e.e<-vS))throw Error(jO+r)}else e.s=0,e.e=0,e.d=[0];return e}function An(e,t,r){var n,o,s,h,i,p,y,b,_=e.d;for(h=1,s=_[0];s>=10;s/=10)h++;if(n=t-h,n<0)n+=$n,o=t,y=_[b=0];else{if(b=Math.ceil((n+1)/$n),s=_.length,b>=s)return e;for(y=s=_[b],h=1;s>=10;s/=10)h++;n%=$n,o=n-$n+h}if(r!==void 0&&(s=Dh(10,h-o-1),i=y/s%10|0,p=t<0||_[b+1]!==void 0||y%s,p=r<4?(i||p)&&(r==0||r==(e.s<0?3:2)):i>5||i==5&&(r==4||p||r==6&&(n>0?o>0?y/Dh(10,h-o):0:_[b-1])%10&1||r==(e.s<0?8:7))),t<1||!_[0])return p?(s=Ci(e),_.length=1,t=t-s-1,_[0]=Dh(10,($n-t%$n)%$n),e.e=Ag(-t/$n)||0):(_.length=1,_[0]=e.e=e.s=0),e;if(n==0?(_.length=b,s=1,b--):(_.length=b+1,s=Dh(10,$n-n),_[b]=o>0?(y/Dh(10,h-o)%Dh(10,o)|0)*s:0),p)for(;;)if(b==0){(_[0]+=s)==Hi&&(_[0]=1,++e.e);break}else{if(_[b]+=s,_[b]!=Hi)break;_[b--]=0,s=1}for(n=_.length;_[--n]===0;)_.pop();if(Gn&&(e.e>vS||e.e<-vS))throw Error(jO+Ci(e));return e}function JX(e,t){var r,n,o,s,h,i,p,y,b,_,E=e.constructor,C=E.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new E(e),Gn?An(t,C):t;if(p=e.d,_=t.d,n=t.e,y=e.e,p=p.slice(),h=y-n,h){for(b=h<0,b?(r=p,h=-h,i=_.length):(r=_,n=y,i=p.length),o=Math.max(Math.ceil(C/$n),i)+2,h>o&&(h=o,r.length=1),r.reverse(),o=h;o--;)r.push(0);r.reverse()}else{for(o=p.length,i=_.length,b=o<i,b&&(i=o),o=0;o<i;o++)if(p[o]!=_[o]){b=p[o]<_[o];break}h=0}for(b&&(r=p,p=_,_=r,t.s=-t.s),i=p.length,o=_.length-i;o>0;--o)p[i++]=0;for(o=_.length;o>h;){if(p[--o]<_[o]){for(s=o;s&&p[--s]===0;)p[s]=Hi-1;--p[s],p[o]+=Hi}p[o]-=_[o]}for(;p[--i]===0;)p.pop();for(;p[0]===0;p.shift())--n;return p[0]?(t.d=p,t.e=n,Gn?An(t,C):t):new E(0)}function hf(e,t,r){var n,o=Ci(e),s=Sl(e.d),h=s.length;return t?(r&&(n=r-h)>0?s=s.charAt(0)+"."+s.slice(1)+Fu(n):h>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(o<0?"e":"e+")+o):o<0?(s="0."+Fu(-o-1)+s,r&&(n=r-h)>0&&(s+=Fu(n))):o>=h?(s+=Fu(o+1-h),r&&(n=r-o-1)>0&&(s=s+"."+Fu(n))):((n=o+1)<h&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-h)>0&&(o+1===h&&(s+="."),s+=Fu(n))),e.s<0?"-"+s:s}function v5(e,t){if(e.length>t)return e.length=t,!0}function QX(e){var t,r,n;function o(s){var h=this;if(!(h instanceof o))return new o(s);if(h.constructor=o,s instanceof o){h.s=s.s,h.e=s.e,h.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Zh+s);if(s>0)h.s=1;else if(s<0)s=-s,h.s=-1;else{h.s=0,h.e=0,h.d=[0];return}if(s===~~s&&s<1e7){h.e=0,h.d=[s];return}return y5(h,s.toString())}else if(typeof s!="string")throw Error(Zh+s);if(s.charCodeAt(0)===45?(s=s.slice(1),h.s=-1):h.s=1,qIe.test(s))y5(h,s);else throw Error(Zh+s)}if(o.prototype=er,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=QX,o.config=o.set=WIe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return o.config(e),o}function WIe(e){if(!e||typeof e!="object")throw Error(os+"Object expected");var t,r,n,o=["precision",1,Pg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<o.length;t+=3)if((n=e[r=o[t]])!==void 0)if(Ag(n)===n&&n>=o[t+1]&&n<=o[t+2])this[r]=n;else throw Error(Zh+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Zh+r+": "+n);return this}var CO=QX(VIe);Sa=new CO(1);const jn=CO;function GIe(e){return KIe(e)||ZIe(e)||XIe(e)||HIe()}function HIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XIe(e,t){if(e){if(typeof e=="string")return jk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jk(e,t)}}function ZIe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function KIe(e){if(Array.isArray(e))return jk(e)}function jk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var YIe=function(t){return t},eZ={"@@functional/placeholder":!0},tZ=function(t){return t===eZ},x5=function(t){return function r(){return arguments.length===0||arguments.length===1&&tZ(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},JIe=function e(t,r){return t===1?r:x5(function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];var h=o.filter(function(i){return i!==eZ}).length;return h>=t?r.apply(void 0,o):e(t-h,x5(function(){for(var i=arguments.length,p=new Array(i),y=0;y<i;y++)p[y]=arguments[y];var b=o.map(function(_){return tZ(_)?p.shift():_});return r.apply(void 0,GIe(b).concat(p))}))})},TE=function(t){return JIe(t.length,t)},Ck=function(t,r){for(var n=[],o=t;o<r;++o)n[o-t]=o;return n},QIe=TE(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),eOe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return YIe;var o=r.reverse(),s=o[0],h=o.slice(1);return function(){return h.reduce(function(i,p){return p(i)},s.apply(void 0,arguments))}},Pk=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},rZ=function(t){var r=null,n=null;return function(){for(var o=arguments.length,s=new Array(o),h=0;h<o;h++)s[h]=arguments[h];return r&&s.every(function(i,p){return i===r[p]})||(r=s,n=t.apply(void 0,s)),n}};function tOe(e){var t;return e===0?t=1:t=Math.floor(new jn(e).abs().log(10).toNumber())+1,t}function rOe(e,t,r){for(var n=new jn(e),o=0,s=[];n.lt(t)&&o<1e5;)s.push(n.toNumber()),n=n.add(r),o++;return s}var nOe=TE(function(e,t,r){var n=+e,o=+t;return n+r*(o-n)}),iOe=TE(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),oOe=TE(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const jE={rangeStep:rOe,getDigitCount:tOe,interpolateNumber:nOe,uninterpolateNumber:iOe,uninterpolateTruncation:oOe};function Ak(e){return lOe(e)||sOe(e)||nZ(e)||aOe()}function aOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sOe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function lOe(e){if(Array.isArray(e))return kk(e)}function nb(e,t){return dOe(e)||uOe(e,t)||nZ(e,t)||cOe()}function cOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nZ(e,t){if(e){if(typeof e=="string")return kk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kk(e,t)}}function kk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uOe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,o=!1,s=void 0;try{for(var h=e[Symbol.iterator](),i;!(n=(i=h.next()).done)&&(r.push(i.value),!(t&&r.length===t));n=!0);}catch(p){o=!0,s=p}finally{try{!n&&h.return!=null&&h.return()}finally{if(o)throw s}}return r}}function dOe(e){if(Array.isArray(e))return e}function iZ(e){var t=nb(e,2),r=t[0],n=t[1],o=r,s=n;return r>n&&(o=n,s=r),[o,s]}function oZ(e,t,r){if(e.lte(0))return new jn(0);var n=jE.getDigitCount(e.toNumber()),o=new jn(10).pow(n),s=e.div(o),h=n!==1?.05:.1,i=new jn(Math.ceil(s.div(h).toNumber())).add(r).mul(h),p=i.mul(o);return t?p:new jn(Math.ceil(p))}function hOe(e,t,r){var n=1,o=new jn(e);if(!o.isint()&&r){var s=Math.abs(e);s<1?(n=new jn(10).pow(jE.getDigitCount(e)-1),o=new jn(Math.floor(o.div(n).toNumber())).mul(n)):s>1&&(o=new jn(Math.floor(e)))}else e===0?o=new jn(Math.floor((t-1)/2)):r||(o=new jn(Math.floor(e)));var h=Math.floor((t-1)/2),i=eOe(QIe(function(p){return o.add(new jn(p-h).mul(n)).toNumber()}),Ck);return i(0,t)}function aZ(e,t,r,n){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new jn(0),tickMin:new jn(0),tickMax:new jn(0)};var s=oZ(new jn(t).sub(e).div(r-1),n,o),h;e<=0&&t>=0?h=new jn(0):(h=new jn(e).add(t).div(2),h=h.sub(new jn(h).mod(s)));var i=Math.ceil(h.sub(e).div(s).toNumber()),p=Math.ceil(new jn(t).sub(h).div(s).toNumber()),y=i+p+1;return y>r?aZ(e,t,r,n,o+1):(y<r&&(p=t>0?p+(r-y):p,i=t>0?i:i+(r-y)),{step:s,tickMin:h.sub(new jn(i).mul(s)),tickMax:h.add(new jn(p).mul(s))})}function fOe(e){var t=nb(e,2),r=t[0],n=t[1],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=Math.max(o,2),i=iZ([r,n]),p=nb(i,2),y=p[0],b=p[1];if(y===-1/0||b===1/0){var _=b===1/0?[y].concat(Ak(Ck(0,o-1).map(function(){return 1/0}))):[].concat(Ak(Ck(0,o-1).map(function(){return-1/0})),[b]);return r>n?Pk(_):_}if(y===b)return hOe(y,o,s);var E=aZ(y,b,h,s),C=E.step,k=E.tickMin,N=E.tickMax,I=jE.rangeStep(k,N.add(new jn(.1).mul(C)),C);return r>n?Pk(I):I}function pOe(e,t){var r=nb(e,2),n=r[0],o=r[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=iZ([n,o]),i=nb(h,2),p=i[0],y=i[1];if(p===-1/0||y===1/0)return[n,o];if(p===y)return[p];var b=Math.max(t,2),_=oZ(new jn(y).sub(p).div(b-1),s,0),E=[].concat(Ak(jE.rangeStep(new jn(p),new jn(y).sub(new jn(.99).mul(_)),_)),[y]);return n>o?Pk(E):E}var mOe=rZ(fOe),gOe=rZ(pOe),yOe=!0,XC="Invariant failed";function ff(e,t){if(!e){if(yOe)throw new Error(XC);var r=typeof t=="function"?t():t,n=r?"".concat(XC,": ").concat(r):XC;throw new Error(n)}}var vOe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Bm(e){"@babel/helpers - typeof";return Bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bm(e)}function xS(){return xS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xS.apply(this,arguments)}function xOe(e,t){return SOe(e)||wOe(e,t)||_Oe(e,t)||bOe()}function bOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Oe(e,t){if(e){if(typeof e=="string")return b5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b5(e,t)}}function b5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,h,i=[],p=!0,y=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);p=!0);}catch(b){y=!0,o=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return i}}function SOe(e){if(Array.isArray(e))return e}function EOe(e,t){if(e==null)return{};var r=TOe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function TOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function jOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cZ(n.key),n)}}function COe(e,t,r){return t&&_5(e.prototype,t),r&&_5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function POe(e,t,r){return t=bS(t),AOe(e,sZ()?Reflect.construct(t,r||[],bS(e).constructor):t.apply(e,r))}function AOe(e,t){if(t&&(Bm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kOe(e)}function kOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sZ=function(){return!!e})()}function bS(e){return bS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bS(e)}function NOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nk(e,t)}function Nk(e,t){return Nk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Nk(e,t)}function lZ(e,t,r){return t=cZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cZ(e){var t=MOe(e,"string");return Bm(t)=="symbol"?t:t+""}function MOe(e,t){if(Bm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qb=function(e){function t(){return jOe(this,t),POe(this,t,arguments)}return NOe(t,e),COe(t,[{key:"render",value:function(){var n=this.props,o=n.offset,s=n.layout,h=n.width,i=n.dataKey,p=n.data,y=n.dataPointFormatter,b=n.xAxis,_=n.yAxis,E=EOe(n,vOe),C=Xr(E,!1);this.props.direction==="x"&&b.type!=="number"&&ff(!1);var k=p.map(function(N){var I=y(N,i),B=I.x,O=I.y,R=I.value,q=I.errorVal;if(!q)return null;var F=[],X,G;if(Array.isArray(q)){var ee=xOe(q,2);X=ee[0],G=ee[1]}else X=G=q;if(s==="vertical"){var K=b.scale,ie=O+o,pe=ie+h,ae=ie-h,_e=K(R-X),Ee=K(R+G);F.push({x1:Ee,y1:pe,x2:Ee,y2:ae}),F.push({x1:_e,y1:ie,x2:Ee,y2:ie}),F.push({x1:_e,y1:pe,x2:_e,y2:ae})}else if(s==="horizontal"){var xe=_.scale,ce=B+o,ke=ce-h,ve=ce+h,Pe=xe(R-X),Re=xe(R+G);F.push({x1:ke,y1:Re,x2:ve,y2:Re}),F.push({x1:ce,y1:Pe,x2:ce,y2:Re}),F.push({x1:ke,y1:Pe,x2:ve,y2:Pe})}return je.createElement(pi,xS({className:"recharts-errorBar",key:"bar-".concat(F.map(function(Be){return"".concat(Be.x1,"-").concat(Be.x2,"-").concat(Be.y1,"-").concat(Be.y2)}))},C),F.map(function(Be){return je.createElement("line",xS({},Be,{key:"line-".concat(Be.x1,"-").concat(Be.x2,"-").concat(Be.y1,"-").concat(Be.y2)}))}))});return je.createElement(pi,{className:"recharts-errorBars"},k)}}])}(je.Component);lZ(Qb,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});lZ(Qb,"displayName","ErrorBar");function ib(e){"@babel/helpers - typeof";return ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ib(e)}function w5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Th(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w5(Object(r),!0).forEach(function(n){IOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IOe(e,t,r){return t=OOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OOe(e){var t=DOe(e,"string");return ib(t)=="symbol"?t:t+""}function DOe(e,t){if(ib(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ib(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uZ=function(t){var r=t.children,n=t.formattedGraphicalItems,o=t.legendWidth,s=t.legendContent,h=_a(r,mm);if(!h)return null;var i=mm.defaultProps,p=i!==void 0?Th(Th({},i),h.props):{},y;return h.props&&h.props.payload?y=h.props&&h.props.payload:s==="children"?y=(n||[]).reduce(function(b,_){var E=_.item,C=_.props,k=C.sectors||C.data||[];return b.concat(k.map(function(N){return{type:h.props.iconType||E.props.legendType,value:N.name,color:N.fill,payload:N}}))},[]):y=(n||[]).map(function(b){var _=b.item,E=_.type.defaultProps,C=E!==void 0?Th(Th({},E),_.props):{},k=C.dataKey,N=C.name,I=C.legendType,B=C.hide;return{inactive:B,dataKey:k,type:p.iconType||I||"square",color:PO(_),value:N||k,payload:C}}),Th(Th(Th({},p),mm.getWithHeight(h,o)),{},{payload:y,item:h})};function ob(e){"@babel/helpers - typeof";return ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ob(e)}function S5(e){return zOe(e)||BOe(e)||LOe(e)||ROe()}function ROe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LOe(e,t){if(e){if(typeof e=="string")return Mk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mk(e,t)}}function BOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zOe(e){if(Array.isArray(e))return Mk(e)}function Mk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function di(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E5(Object(r),!0).forEach(function(n){ym(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ym(e,t,r){return t=$Oe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Oe(e){var t=FOe(e,"string");return ob(t)=="symbol"?t:t+""}function FOe(e,t){if(ob(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ob(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ka(e,t,r){return Wr(e)||Wr(t)?r:Li(t)?ts(e,t,r):Nr(t)?t(e):r}function fx(e,t,r,n){var o=zIe(e,function(i){return ka(i,t)});if(r==="number"){var s=o.filter(function(i){return Ft(i)||parseFloat(i)});return s.length?[SE(s),wE(s)]:[1/0,-1/0]}var h=n?o.filter(function(i){return!Wr(i)}):o;return h.map(function(i){return Li(i)||i instanceof Date?i:""})}var UOe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,h=-1,i=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(i<=1)return 0;if(s&&s.axisType==="angleAxis"&&Math.abs(Math.abs(s.range[1]-s.range[0])-360)<=1e-6)for(var p=s.range,y=0;y<i;y++){var b=y>0?o[y-1].coordinate:o[i-1].coordinate,_=o[y].coordinate,E=y>=i-1?o[0].coordinate:o[y+1].coordinate,C=void 0;if(Ws(_-b)!==Ws(E-_)){var k=[];if(Ws(E-_)===Ws(p[1]-p[0])){C=E;var N=_+p[1]-p[0];k[0]=Math.min(N,(N+b)/2),k[1]=Math.max(N,(N+b)/2)}else{C=b;var I=E+p[1]-p[0];k[0]=Math.min(_,(I+_)/2),k[1]=Math.max(_,(I+_)/2)}var B=[Math.min(_,(C+_)/2),Math.max(_,(C+_)/2)];if(t>B[0]&&t<=B[1]||t>=k[0]&&t<=k[1]){h=o[y].index;break}}else{var O=Math.min(b,E),R=Math.max(b,E);if(t>(O+_)/2&&t<=(R+_)/2){h=o[y].index;break}}}else for(var q=0;q<i;q++)if(q===0&&t<=(n[q].coordinate+n[q+1].coordinate)/2||q>0&&q<i-1&&t>(n[q].coordinate+n[q-1].coordinate)/2&&t<=(n[q].coordinate+n[q+1].coordinate)/2||q===i-1&&t>(n[q].coordinate+n[q-1].coordinate)/2){h=n[q].index;break}return h},PO=function(t){var r,n=t,o=n.type.displayName,s=(r=t.type)!==null&&r!==void 0&&r.defaultProps?di(di({},t.type.defaultProps),t.props):t.props,h=s.stroke,i=s.fill,p;switch(o){case"Line":p=h;break;case"Area":case"Radar":p=h&&h!=="none"?h:i;break;default:p=i;break}return p},VOe=function(t){var r=t.barSize,n=t.totalSize,o=t.stackGroups,s=o===void 0?{}:o;if(!s)return{};for(var h={},i=Object.keys(s),p=0,y=i.length;p<y;p++)for(var b=s[i[p]].stackGroups,_=Object.keys(b),E=0,C=_.length;E<C;E++){var k=b[_[E]],N=k.items,I=k.cateAxisId,B=N.filter(function(G){return Sc(G.type).indexOf("Bar")>=0});if(B&&B.length){var O=B[0].type.defaultProps,R=O!==void 0?di(di({},O),B[0].props):B[0].props,q=R.barSize,F=R[I];h[F]||(h[F]=[]);var X=Wr(q)?r:q;h[F].push({item:B[0],stackList:B.slice(1),barSize:Wr(X)?void 0:df(X,n,0)})}}return h},qOe=function(t){var r=t.barGap,n=t.barCategoryGap,o=t.bandSize,s=t.sizeList,h=s===void 0?[]:s,i=t.maxBarSize,p=h.length;if(p<1)return null;var y=df(r,o,0,!0),b,_=[];if(h[0].barSize===+h[0].barSize){var E=!1,C=o/p,k=h.reduce(function(q,F){return q+F.barSize||0},0);k+=(p-1)*y,k>=o&&(k-=(p-1)*y,y=0),k>=o&&C>0&&(E=!0,C*=.9,k=p*C);var N=(o-k)/2>>0,I={offset:N-y,size:0};b=h.reduce(function(q,F){var X={item:F.item,position:{offset:I.offset+I.size+y,size:E?C:F.barSize}},G=[].concat(S5(q),[X]);return I=G[G.length-1].position,F.stackList&&F.stackList.length&&F.stackList.forEach(function(ee){G.push({item:ee,position:I})}),G},_)}else{var B=df(n,o,0,!0);o-2*B-(p-1)*y<=0&&(y=0);var O=(o-2*B-(p-1)*y)/p;O>1&&(O>>=0);var R=i===+i?Math.min(O,i):O;b=h.reduce(function(q,F,X){var G=[].concat(S5(q),[{item:F.item,position:{offset:B+(O+y)*X+(O-R)/2,size:R}}]);return F.stackList&&F.stackList.length&&F.stackList.forEach(function(ee){G.push({item:ee,position:G[G.length-1].position})}),G},_)}return b},WOe=function(t,r,n,o){var s=n.children,h=n.width,i=n.margin,p=h-(i.left||0)-(i.right||0),y=uZ({children:s,legendWidth:p});if(y){var b=o||{},_=b.width,E=b.height,C=y.align,k=y.verticalAlign,N=y.layout;if((N==="vertical"||N==="horizontal"&&k==="middle")&&C!=="center"&&Ft(t[C]))return di(di({},t),{},ym({},C,t[C]+(_||0)));if((N==="horizontal"||N==="vertical"&&C==="center")&&k!=="middle"&&Ft(t[k]))return di(di({},t),{},ym({},k,t[k]+(E||0)))}return t},GOe=function(t,r,n){return Wr(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},dZ=function(t,r,n,o,s){var h=r.props.children,i=rs(h,Qb).filter(function(y){return GOe(o,s,y.props.direction)});if(i&&i.length){var p=i.map(function(y){return y.props.dataKey});return t.reduce(function(y,b){var _=ka(b,n);if(Wr(_))return y;var E=Array.isArray(_)?[SE(_),wE(_)]:[_,_],C=p.reduce(function(k,N){var I=ka(b,N,0),B=E[0]-Math.abs(Array.isArray(I)?I[0]:I),O=E[1]+Math.abs(Array.isArray(I)?I[1]:I);return[Math.min(B,k[0]),Math.max(O,k[1])]},[1/0,-1/0]);return[Math.min(C[0],y[0]),Math.max(C[1],y[1])]},[1/0,-1/0])}return null},HOe=function(t,r,n,o,s){var h=r.map(function(i){return dZ(t,i,n,s,o)}).filter(function(i){return!Wr(i)});return h&&h.length?h.reduce(function(i,p){return[Math.min(i[0],p[0]),Math.max(i[1],p[1])]},[1/0,-1/0]):null},hZ=function(t,r,n,o,s){var h=r.map(function(p){var y=p.props.dataKey;return n==="number"&&y&&dZ(t,p,y,o)||fx(t,y,n,s)});if(n==="number")return h.reduce(function(p,y){return[Math.min(p[0],y[0]),Math.max(p[1],y[1])]},[1/0,-1/0]);var i={};return h.reduce(function(p,y){for(var b=0,_=y.length;b<_;b++)i[y[b]]||(i[y[b]]=!0,p.push(y[b]));return p},[])},fZ=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},pZ=function(t,r,n,o){if(o)return t.map(function(p){return p.coordinate});var s,h,i=t.map(function(p){return p.coordinate===r&&(s=!0),p.coordinate===n&&(h=!0),p.coordinate});return s||i.push(r),h||i.push(n),i},xc=function(t,r,n){if(!t)return null;var o=t.scale,s=t.duplicateDomain,h=t.type,i=t.range,p=t.realScaleType==="scaleBand"?o.bandwidth()/2:2,y=(r||n)&&h==="category"&&o.bandwidth?o.bandwidth()/p:0;if(y=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?Ws(i[0]-i[1])*2*y:y,r&&(t.ticks||t.niceTicks)){var b=(t.ticks||t.niceTicks).map(function(_){var E=s?s.indexOf(_):_;return{coordinate:o(E)+y,value:_,offset:y}});return b.filter(function(_){return!Gb(_.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(_,E){return{coordinate:o(_)+y,value:_,index:E,offset:y}}):o.ticks&&!n?o.ticks(t.tickCount).map(function(_){return{coordinate:o(_)+y,value:_,offset:y}}):o.domain().map(function(_,E){return{coordinate:o(_)+y,value:s?s[_]:_,index:E,offset:y}})},ZC=new WeakMap,vw=function(t,r){if(typeof r!="function")return t;ZC.has(t)||ZC.set(t,new WeakMap);var n=ZC.get(t);if(n.has(r))return n.get(r);var o=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,o),o},XOe=function(t,r,n){var o=t.scale,s=t.type,h=t.layout,i=t.axisType;if(o==="auto")return h==="radial"&&i==="radiusAxis"?{scale:Yx(),realScaleType:"band"}:h==="radial"&&i==="angleAxis"?{scale:pS(),realScaleType:"linear"}:s==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:hx(),realScaleType:"point"}:s==="category"?{scale:Yx(),realScaleType:"band"}:{scale:pS(),realScaleType:"linear"};if(uf(o)){var p="scale".concat(cE(o));return{scale:(g5[p]||hx)(),realScaleType:g5[p]?p:"point"}}return Nr(o)?{scale:o}:{scale:hx(),realScaleType:"point"}},T5=1e-4,ZOe=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,o=t.range(),s=Math.min(o[0],o[1])-T5,h=Math.max(o[0],o[1])+T5,i=t(r[0]),p=t(r[n-1]);(i<s||i>h||p<s||p>h)&&t.domain([r[0],r[n-1]])}},KOe=function(t,r){if(!t)return null;for(var n=0,o=t.length;n<o;n++)if(t[n].item===r)return t[n].position;return null},YOe=function(t,r){if(!r||r.length!==2||!Ft(r[0])||!Ft(r[1]))return t;var n=Math.min(r[0],r[1]),o=Math.max(r[0],r[1]),s=[t[0],t[1]];return(!Ft(t[0])||t[0]<n)&&(s[0]=n),(!Ft(t[1])||t[1]>o)&&(s[1]=o),s[0]>o&&(s[0]=o),s[1]<n&&(s[1]=n),s},JOe=function(t){var r=t.length;if(!(r<=0))for(var n=0,o=t[0].length;n<o;++n)for(var s=0,h=0,i=0;i<r;++i){var p=Gb(t[i][n][1])?t[i][n][0]:t[i][n][1];p>=0?(t[i][n][0]=s,t[i][n][1]=s+p,s=t[i][n][1]):(t[i][n][0]=h,t[i][n][1]=h+p,h=t[i][n][1])}},QOe=function(t){var r=t.length;if(!(r<=0))for(var n=0,o=t[0].length;n<o;++n)for(var s=0,h=0;h<r;++h){var i=Gb(t[h][n][1])?t[h][n][0]:t[h][n][1];i>=0?(t[h][n][0]=s,t[h][n][1]=s+i,s=t[h][n][1]):(t[h][n][0]=0,t[h][n][1]=0)}},eDe={sign:JOe,expand:v1e,none:km,silhouette:x1e,wiggle:b1e,positive:QOe},tDe=function(t,r,n){var o=r.map(function(i){return i.props.dataKey}),s=eDe[n],h=y1e().keys(o).value(function(i,p){return+ka(i,p,0)}).order(nk).offset(s);return h(t)},rDe=function(t,r,n,o,s,h){if(!t)return null;var i=h?r.reverse():r,p={},y=i.reduce(function(_,E){var C,k=(C=E.type)!==null&&C!==void 0&&C.defaultProps?di(di({},E.type.defaultProps),E.props):E.props,N=k.stackId,I=k.hide;if(I)return _;var B=k[n],O=_[B]||{hasStack:!1,stackGroups:{}};if(Li(N)){var R=O.stackGroups[N]||{numericAxisId:n,cateAxisId:o,items:[]};R.items.push(E),O.hasStack=!0,O.stackGroups[N]=R}else O.stackGroups[Hb("_stackId_")]={numericAxisId:n,cateAxisId:o,items:[E]};return di(di({},_),{},ym({},B,O))},p),b={};return Object.keys(y).reduce(function(_,E){var C=y[E];if(C.hasStack){var k={};C.stackGroups=Object.keys(C.stackGroups).reduce(function(N,I){var B=C.stackGroups[I];return di(di({},N),{},ym({},I,{numericAxisId:n,cateAxisId:o,items:B.items,stackedData:tDe(t,B.items,s)}))},k)}return di(di({},_),{},ym({},E,C))},b)},nDe=function(t,r){var n=r.realScaleType,o=r.type,s=r.tickCount,h=r.originalDomain,i=r.allowDecimals,p=n||r.scale;if(p!=="auto"&&p!=="linear")return null;if(s&&o==="number"&&h&&(h[0]==="auto"||h[1]==="auto")){var y=t.domain();if(!y.length)return null;var b=mOe(y,s,i);return t.domain([SE(b),wE(b)]),{niceTicks:b}}if(s&&o==="number"){var _=t.domain(),E=gOe(_,s,i);return{niceTicks:E}}return null};function j5(e){var t=e.axis,r=e.ticks,n=e.bandSize,o=e.entry,s=e.index,h=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Wr(o[t.dataKey])){var i=W1(r,"value",o[t.dataKey]);if(i)return i.coordinate+n/2}return r[s]?r[s].coordinate+n/2:null}var p=ka(o,Wr(h)?t.dataKey:h);return Wr(p)?null:t.scale(p)}var C5=function(t){var r=t.axis,n=t.ticks,o=t.offset,s=t.bandSize,h=t.entry,i=t.index;if(r.type==="category")return n[i]?n[i].coordinate+o:null;var p=ka(h,r.dataKey,r.domain[i]);return Wr(p)?null:r.scale(p)-s/2+o},iDe=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var o=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]);return o<=0&&s>=0?0:s<0?s:o}return n[0]},oDe=function(t,r){var n,o=(n=t.type)!==null&&n!==void 0&&n.defaultProps?di(di({},t.type.defaultProps),t.props):t.props,s=o.stackId;if(Li(s)){var h=r[s];if(h){var i=h.items.indexOf(t);return i>=0?h.stackedData[i]:null}}return null},aDe=function(t){return t.reduce(function(r,n){return[SE(n.concat([r[0]]).filter(Ft)),wE(n.concat([r[1]]).filter(Ft))]},[1/0,-1/0])},mZ=function(t,r,n){return Object.keys(t).reduce(function(o,s){var h=t[s],i=h.stackedData,p=i.reduce(function(y,b){var _=aDe(b.slice(r,n+1));return[Math.min(y[0],_[0]),Math.max(y[1],_[1])]},[1/0,-1/0]);return[Math.min(p[0],o[0]),Math.max(p[1],o[1])]},[1/0,-1/0]).map(function(o){return o===1/0||o===-1/0?0:o})},P5=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,A5=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ik=function(t,r,n){if(Nr(t))return t(r,n);if(!Array.isArray(t))return r;var o=[];if(Ft(t[0]))o[0]=n?t[0]:Math.min(t[0],r[0]);else if(P5.test(t[0])){var s=+P5.exec(t[0])[1];o[0]=r[0]-s}else Nr(t[0])?o[0]=t[0](r[0]):o[0]=r[0];if(Ft(t[1]))o[1]=n?t[1]:Math.max(t[1],r[1]);else if(A5.test(t[1])){var h=+A5.exec(t[1])[1];o[1]=r[1]+h}else Nr(t[1])?o[1]=t[1](r[1]):o[1]=r[1];return o},_S=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var o=t.scale.bandwidth();if(!n||o>0)return o}if(t&&r&&r.length>=2){for(var s=rO(r,function(_){return _.coordinate}),h=1/0,i=1,p=s.length;i<p;i++){var y=s[i],b=s[i-1];h=Math.min((y.coordinate||0)-(b.coordinate||0),h)}return h===1/0?0:h}return n?void 0:0},k5=function(t,r,n){return!t||!t.length||EE(t,ts(n,"type.defaultProps.domain"))?r:t},gZ=function(t,r){var n=t.type.defaultProps?di(di({},t.type.defaultProps),t.props):t.props,o=n.dataKey,s=n.name,h=n.unit,i=n.formatter,p=n.tooltipType,y=n.chartType,b=n.hide;return di(di({},Xr(t,!1)),{},{dataKey:o,unit:h,formatter:i,name:s||o,color:PO(t),value:ka(r,o),type:p,payload:r,chartType:y,hide:b})};function ab(e){"@babel/helpers - typeof";return ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ab(e)}function N5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function M5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N5(Object(r),!0).forEach(function(n){sDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sDe(e,t,r){return t=lDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lDe(e){var t=cDe(e,"string");return ab(t)=="symbol"?t:t+""}function cDe(e,t){if(ab(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ab(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wS=Math.PI/180,uDe=function(t){return t*180/Math.PI},io=function(t,r,n,o){return{x:t+Math.cos(-wS*o)*n,y:r+Math.sin(-wS*o)*n}},dDe=function(t,r){var n=t.x,o=t.y,s=r.x,h=r.y;return Math.sqrt(Math.pow(n-s,2)+Math.pow(o-h,2))},hDe=function(t,r){var n=t.x,o=t.y,s=r.cx,h=r.cy,i=dDe({x:n,y:o},{x:s,y:h});if(i<=0)return{radius:i};var p=(n-s)/i,y=Math.acos(p);return o>h&&(y=2*Math.PI-y),{radius:i,angle:uDe(y),angleInRadian:y}},fDe=function(t){var r=t.startAngle,n=t.endAngle,o=Math.floor(r/360),s=Math.floor(n/360),h=Math.min(o,s);return{startAngle:r-h*360,endAngle:n-h*360}},pDe=function(t,r){var n=r.startAngle,o=r.endAngle,s=Math.floor(n/360),h=Math.floor(o/360),i=Math.min(s,h);return t+i*360},I5=function(t,r){var n=t.x,o=t.y,s=hDe({x:n,y:o},r),h=s.radius,i=s.angle,p=r.innerRadius,y=r.outerRadius;if(h<p||h>y)return!1;if(h===0)return!0;var b=fDe(r),_=b.startAngle,E=b.endAngle,C=i,k;if(_<=E){for(;C>E;)C-=360;for(;C<_;)C+=360;k=C>=_&&C<=E}else{for(;C>_;)C-=360;for(;C<E;)C+=360;k=C>=E&&C<=_}return k?M5(M5({},r),{},{radius:h,angle:pDe(C,r)}):null};function sb(e){"@babel/helpers - typeof";return sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sb(e)}var mDe=["offset"];function gDe(e){return bDe(e)||xDe(e)||vDe(e)||yDe()}function yDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vDe(e,t){if(e){if(typeof e=="string")return Ok(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ok(e,t)}}function xDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bDe(e){if(Array.isArray(e))return Ok(e)}function Ok(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _De(e,t){if(e==null)return{};var r=wDe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function wDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function O5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Oi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O5(Object(r),!0).forEach(function(n){SDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SDe(e,t,r){return t=EDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EDe(e){var t=TDe(e,"string");return sb(t)=="symbol"?t:t+""}function TDe(e,t){if(sb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lb(){return lb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lb.apply(this,arguments)}var jDe=function(t){var r=t.value,n=t.formatter,o=Wr(t.children)?r:t.children;return Nr(n)?n(o):o},CDe=function(t,r){var n=Ws(r-t),o=Math.min(Math.abs(r-t),360);return n*o},PDe=function(t,r,n){var o=t.position,s=t.viewBox,h=t.offset,i=t.className,p=s,y=p.cx,b=p.cy,_=p.innerRadius,E=p.outerRadius,C=p.startAngle,k=p.endAngle,N=p.clockWise,I=(_+E)/2,B=CDe(C,k),O=B>=0?1:-1,R,q;o==="insideStart"?(R=C+O*h,q=N):o==="insideEnd"?(R=k-O*h,q=!N):o==="end"&&(R=k+O*h,q=N),q=B<=0?q:!q;var F=io(y,b,I,R),X=io(y,b,I,R+(q?1:-1)*359),G="M".concat(F.x,",").concat(F.y,`
    A`).concat(I,",").concat(I,",0,1,").concat(q?0:1,`,
    `).concat(X.x,",").concat(X.y),ee=Wr(t.id)?Hb("recharts-radial-line-"):t.id;return je.createElement("text",lb({},n,{dominantBaseline:"central",className:Zr("recharts-radial-bar-label",i)}),je.createElement("defs",null,je.createElement("path",{id:ee,d:G})),je.createElement("textPath",{xlinkHref:"#".concat(ee)},r))},ADe=function(t){var r=t.viewBox,n=t.offset,o=t.position,s=r,h=s.cx,i=s.cy,p=s.innerRadius,y=s.outerRadius,b=s.startAngle,_=s.endAngle,E=(b+_)/2;if(o==="outside"){var C=io(h,i,y+n,E),k=C.x,N=C.y;return{x:k,y:N,textAnchor:k>=h?"start":"end",verticalAnchor:"middle"}}if(o==="center")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(o==="centerTop")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"start"};if(o==="centerBottom")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"end"};var I=(p+y)/2,B=io(h,i,I,E),O=B.x,R=B.y;return{x:O,y:R,textAnchor:"middle",verticalAnchor:"middle"}},kDe=function(t){var r=t.viewBox,n=t.parentViewBox,o=t.offset,s=t.position,h=r,i=h.x,p=h.y,y=h.width,b=h.height,_=b>=0?1:-1,E=_*o,C=_>0?"end":"start",k=_>0?"start":"end",N=y>=0?1:-1,I=N*o,B=N>0?"end":"start",O=N>0?"start":"end";if(s==="top"){var R={x:i+y/2,y:p-_*o,textAnchor:"middle",verticalAnchor:C};return Oi(Oi({},R),n?{height:Math.max(p-n.y,0),width:y}:{})}if(s==="bottom"){var q={x:i+y/2,y:p+b+E,textAnchor:"middle",verticalAnchor:k};return Oi(Oi({},q),n?{height:Math.max(n.y+n.height-(p+b),0),width:y}:{})}if(s==="left"){var F={x:i-I,y:p+b/2,textAnchor:B,verticalAnchor:"middle"};return Oi(Oi({},F),n?{width:Math.max(F.x-n.x,0),height:b}:{})}if(s==="right"){var X={x:i+y+I,y:p+b/2,textAnchor:O,verticalAnchor:"middle"};return Oi(Oi({},X),n?{width:Math.max(n.x+n.width-X.x,0),height:b}:{})}var G=n?{width:y,height:b}:{};return s==="insideLeft"?Oi({x:i+I,y:p+b/2,textAnchor:O,verticalAnchor:"middle"},G):s==="insideRight"?Oi({x:i+y-I,y:p+b/2,textAnchor:B,verticalAnchor:"middle"},G):s==="insideTop"?Oi({x:i+y/2,y:p+E,textAnchor:"middle",verticalAnchor:k},G):s==="insideBottom"?Oi({x:i+y/2,y:p+b-E,textAnchor:"middle",verticalAnchor:C},G):s==="insideTopLeft"?Oi({x:i+I,y:p+E,textAnchor:O,verticalAnchor:k},G):s==="insideTopRight"?Oi({x:i+y-I,y:p+E,textAnchor:B,verticalAnchor:k},G):s==="insideBottomLeft"?Oi({x:i+I,y:p+b-E,textAnchor:O,verticalAnchor:C},G):s==="insideBottomRight"?Oi({x:i+y-I,y:p+b-E,textAnchor:B,verticalAnchor:C},G):bg(s)&&(Ft(s.x)||Uh(s.x))&&(Ft(s.y)||Uh(s.y))?Oi({x:i+df(s.x,y),y:p+df(s.y,b),textAnchor:"end",verticalAnchor:"end"},G):Oi({x:i+y/2,y:p+b/2,textAnchor:"middle",verticalAnchor:"middle"},G)},NDe=function(t){return"cx"in t&&Ft(t.cx)};function So(e){var t=e.offset,r=t===void 0?5:t,n=_De(e,mDe),o=Oi({offset:r},n),s=o.viewBox,h=o.position,i=o.value,p=o.children,y=o.content,b=o.className,_=b===void 0?"":b,E=o.textBreakAll;if(!s||Wr(i)&&Wr(p)&&!D.isValidElement(y)&&!Nr(y))return null;if(D.isValidElement(y))return D.cloneElement(y,o);var C;if(Nr(y)){if(C=D.createElement(y,o),D.isValidElement(C))return C}else C=jDe(o);var k=NDe(s),N=Xr(o,!0);if(k&&(h==="insideStart"||h==="insideEnd"||h==="end"))return PDe(o,C,N);var I=k?ADe(o):kDe(o);return je.createElement(sS,lb({className:Zr("recharts-label",_)},N,I,{breakAll:E}),C)}So.displayName="Label";var yZ=function(t){var r=t.cx,n=t.cy,o=t.angle,s=t.startAngle,h=t.endAngle,i=t.r,p=t.radius,y=t.innerRadius,b=t.outerRadius,_=t.x,E=t.y,C=t.top,k=t.left,N=t.width,I=t.height,B=t.clockWise,O=t.labelViewBox;if(O)return O;if(Ft(N)&&Ft(I)){if(Ft(_)&&Ft(E))return{x:_,y:E,width:N,height:I};if(Ft(C)&&Ft(k))return{x:C,y:k,width:N,height:I}}return Ft(_)&&Ft(E)?{x:_,y:E,width:0,height:0}:Ft(r)&&Ft(n)?{cx:r,cy:n,startAngle:s||o||0,endAngle:h||o||0,innerRadius:y||0,outerRadius:b||p||i||0,clockWise:B}:t.viewBox?t.viewBox:{}},MDe=function(t,r){return t?t===!0?je.createElement(So,{key:"label-implicit",viewBox:r}):Li(t)?je.createElement(So,{key:"label-implicit",viewBox:r,value:t}):D.isValidElement(t)?t.type===So?D.cloneElement(t,{key:"label-implicit",viewBox:r}):je.createElement(So,{key:"label-implicit",content:t,viewBox:r}):Nr(t)?je.createElement(So,{key:"label-implicit",content:t,viewBox:r}):bg(t)?je.createElement(So,lb({viewBox:r},t,{key:"label-implicit"})):null:null},IDe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var o=t.children,s=yZ(t),h=rs(o,So).map(function(p,y){return D.cloneElement(p,{viewBox:r||s,key:"label-".concat(y)})});if(!n)return h;var i=MDe(t.label,r||s);return[i].concat(gDe(h))};So.parseViewBox=yZ;So.renderCallByParent=IDe;function ODe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var DDe=ODe;const RDe=wn(DDe);function cb(e){"@babel/helpers - typeof";return cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cb(e)}var LDe=["valueAccessor"],BDe=["data","dataKey","clockWise","id","textBreakAll"];function zDe(e){return VDe(e)||UDe(e)||FDe(e)||$De()}function $De(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FDe(e,t){if(e){if(typeof e=="string")return Dk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dk(e,t)}}function UDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VDe(e){if(Array.isArray(e))return Dk(e)}function Dk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SS(){return SS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},SS.apply(this,arguments)}function D5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function R5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D5(Object(r),!0).forEach(function(n){qDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qDe(e,t,r){return t=WDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WDe(e){var t=GDe(e,"string");return cb(t)=="symbol"?t:t+""}function GDe(e,t){if(cb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function L5(e,t){if(e==null)return{};var r=HDe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function HDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var XDe=function(t){return Array.isArray(t.value)?RDe(t.value):t.value};function ld(e){var t=e.valueAccessor,r=t===void 0?XDe:t,n=L5(e,LDe),o=n.data,s=n.dataKey,h=n.clockWise,i=n.id,p=n.textBreakAll,y=L5(n,BDe);return!o||!o.length?null:je.createElement(pi,{className:"recharts-label-list"},o.map(function(b,_){var E=Wr(s)?r(b,_):ka(b&&b.payload,s),C=Wr(i)?{}:{id:"".concat(i,"-").concat(_)};return je.createElement(So,SS({},Xr(b,!0),y,C,{parentViewBox:b.parentViewBox,value:E,textBreakAll:p,viewBox:So.parseViewBox(Wr(h)?b:R5(R5({},b),{},{clockWise:h})),key:"label-".concat(_),index:_}))}))}ld.displayName="LabelList";function ZDe(e,t){return e?e===!0?je.createElement(ld,{key:"labelList-implicit",data:t}):je.isValidElement(e)||Nr(e)?je.createElement(ld,{key:"labelList-implicit",data:t,content:e}):bg(e)?je.createElement(ld,SS({data:t},e,{key:"labelList-implicit"})):null:null}function KDe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,o=rs(n,ld).map(function(h,i){return D.cloneElement(h,{data:t,key:"labelList-".concat(i)})});if(!r)return o;var s=ZDe(e.label,t);return[s].concat(zDe(o))}ld.renderCallByParent=KDe;function ub(e){"@babel/helpers - typeof";return ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ub(e)}function Rk(){return Rk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rk.apply(this,arguments)}function B5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function z5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B5(Object(r),!0).forEach(function(n){YDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YDe(e,t,r){return t=JDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JDe(e){var t=QDe(e,"string");return ub(t)=="symbol"?t:t+""}function QDe(e,t){if(ub(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ub(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eRe=function(t,r){var n=Ws(r-t),o=Math.min(Math.abs(r-t),359.999);return n*o},xw=function(t){var r=t.cx,n=t.cy,o=t.radius,s=t.angle,h=t.sign,i=t.isExternal,p=t.cornerRadius,y=t.cornerIsExternal,b=p*(i?1:-1)+o,_=Math.asin(p/b)/wS,E=y?s:s+h*_,C=io(r,n,b,E),k=io(r,n,o,E),N=y?s-h*_:s,I=io(r,n,b*Math.cos(_*wS),N);return{center:C,circleTangency:k,lineTangency:I,theta:_}},vZ=function(t){var r=t.cx,n=t.cy,o=t.innerRadius,s=t.outerRadius,h=t.startAngle,i=t.endAngle,p=eRe(h,i),y=h+p,b=io(r,n,s,h),_=io(r,n,s,y),E="M ".concat(b.x,",").concat(b.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(p)>180),",").concat(+(h>y),`,
    `).concat(_.x,",").concat(_.y,`
  `);if(o>0){var C=io(r,n,o,h),k=io(r,n,o,y);E+="L ".concat(k.x,",").concat(k.y,`
            A `).concat(o,",").concat(o,`,0,
            `).concat(+(Math.abs(p)>180),",").concat(+(h<=y),`,
            `).concat(C.x,",").concat(C.y," Z")}else E+="L ".concat(r,",").concat(n," Z");return E},tRe=function(t){var r=t.cx,n=t.cy,o=t.innerRadius,s=t.outerRadius,h=t.cornerRadius,i=t.forceCornerRadius,p=t.cornerIsExternal,y=t.startAngle,b=t.endAngle,_=Ws(b-y),E=xw({cx:r,cy:n,radius:s,angle:y,sign:_,cornerRadius:h,cornerIsExternal:p}),C=E.circleTangency,k=E.lineTangency,N=E.theta,I=xw({cx:r,cy:n,radius:s,angle:b,sign:-_,cornerRadius:h,cornerIsExternal:p}),B=I.circleTangency,O=I.lineTangency,R=I.theta,q=p?Math.abs(y-b):Math.abs(y-b)-N-R;if(q<0)return i?"M ".concat(k.x,",").concat(k.y,`
        a`).concat(h,",").concat(h,",0,0,1,").concat(h*2,`,0
        a`).concat(h,",").concat(h,",0,0,1,").concat(-h*2,`,0
      `):vZ({cx:r,cy:n,innerRadius:o,outerRadius:s,startAngle:y,endAngle:b});var F="M ".concat(k.x,",").concat(k.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(_<0),",").concat(C.x,",").concat(C.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(q>180),",").concat(+(_<0),",").concat(B.x,",").concat(B.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(_<0),",").concat(O.x,",").concat(O.y,`
  `);if(o>0){var X=xw({cx:r,cy:n,radius:o,angle:y,sign:_,isExternal:!0,cornerRadius:h,cornerIsExternal:p}),G=X.circleTangency,ee=X.lineTangency,K=X.theta,ie=xw({cx:r,cy:n,radius:o,angle:b,sign:-_,isExternal:!0,cornerRadius:h,cornerIsExternal:p}),pe=ie.circleTangency,ae=ie.lineTangency,_e=ie.theta,Ee=p?Math.abs(y-b):Math.abs(y-b)-K-_e;if(Ee<0&&h===0)return"".concat(F,"L").concat(r,",").concat(n,"Z");F+="L".concat(ae.x,",").concat(ae.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(_<0),",").concat(pe.x,",").concat(pe.y,`
      A`).concat(o,",").concat(o,",0,").concat(+(Ee>180),",").concat(+(_>0),",").concat(G.x,",").concat(G.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(_<0),",").concat(ee.x,",").concat(ee.y,"Z")}else F+="L".concat(r,",").concat(n,"Z");return F},rRe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},xZ=function(t){var r=z5(z5({},rRe),t),n=r.cx,o=r.cy,s=r.innerRadius,h=r.outerRadius,i=r.cornerRadius,p=r.forceCornerRadius,y=r.cornerIsExternal,b=r.startAngle,_=r.endAngle,E=r.className;if(h<s||b===_)return null;var C=Zr("recharts-sector",E),k=h-s,N=df(i,k,0,!0),I;return N>0&&Math.abs(b-_)<360?I=tRe({cx:n,cy:o,innerRadius:s,outerRadius:h,cornerRadius:Math.min(N,k/2),forceCornerRadius:p,cornerIsExternal:y,startAngle:b,endAngle:_}):I=vZ({cx:n,cy:o,innerRadius:s,outerRadius:h,startAngle:b,endAngle:_}),je.createElement("path",Rk({},Xr(r,!0),{className:C,d:I,role:"img"}))};function db(e){"@babel/helpers - typeof";return db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},db(e)}function Lk(){return Lk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lk.apply(this,arguments)}function $5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function F5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$5(Object(r),!0).forEach(function(n){nRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nRe(e,t,r){return t=iRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iRe(e){var t=oRe(e,"string");return db(t)=="symbol"?t:t+""}function oRe(e,t){if(db(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(db(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U5={curveBasisClosed:a1e,curveBasisOpen:s1e,curveBasis:o1e,curveBumpX:Wwe,curveBumpY:Gwe,curveLinearClosed:l1e,curveLinear:dE,curveMonotoneX:c1e,curveMonotoneY:u1e,curveNatural:d1e,curveStep:h1e,curveStepAfter:p1e,curveStepBefore:f1e},bw=function(t){return t.x===+t.x&&t.y===+t.y},kv=function(t){return t.x},Nv=function(t){return t.y},aRe=function(t,r){if(Nr(t))return t;var n="curve".concat(cE(t));return(n==="curveMonotone"||n==="curveBump")&&r?U5["".concat(n).concat(r==="vertical"?"Y":"X")]:U5[n]||dE},sRe=function(t){var r=t.type,n=r===void 0?"linear":r,o=t.points,s=o===void 0?[]:o,h=t.baseLine,i=t.layout,p=t.connectNulls,y=p===void 0?!1:p,b=aRe(n,i),_=y?s.filter(function(N){return bw(N)}):s,E;if(Array.isArray(h)){var C=y?h.filter(function(N){return bw(N)}):h,k=_.map(function(N,I){return F5(F5({},N),{},{base:C[I]})});return i==="vertical"?E=uw().y(Nv).x1(kv).x0(function(N){return N.base.x}):E=uw().x(kv).y1(Nv).y0(function(N){return N.base.y}),E.defined(bw).curve(b),E(k)}return i==="vertical"&&Ft(h)?E=uw().y(Nv).x1(kv).x0(h):Ft(h)?E=uw().x(kv).y1(Nv).y0(h):E=vH().x(kv).y(Nv),E.defined(bw).curve(b),E(_)},Bk=function(t){var r=t.className,n=t.points,o=t.path,s=t.pathRef;if((!n||!n.length)&&!o)return null;var h=n&&n.length?sRe(t):o;return je.createElement("path",Lk({},Xr(t,!1),G1(t),{className:Zr("recharts-curve",r),d:h,ref:s}))},bZ={exports:{}},lRe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",cRe=lRe,uRe=cRe;function _Z(){}function wZ(){}wZ.resetWarningCache=_Z;var dRe=function(){function e(n,o,s,h,i,p){if(p!==uRe){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:wZ,resetWarningCache:_Z};return r.PropTypes=r,r};bZ.exports=dRe();var hRe=bZ.exports;const lr=wn(hRe);var fRe=Object.getOwnPropertyNames,pRe=Object.getOwnPropertySymbols,mRe=Object.prototype.hasOwnProperty;function V5(e,t){return function(n,o,s){return e(n,o,s)&&t(n,o,s)}}function _w(e){return function(r,n,o){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,o);var s=o.cache,h=s.get(r),i=s.get(n);if(h&&i)return h===n&&i===r;s.set(r,n),s.set(n,r);var p=e(r,n,o);return s.delete(r),s.delete(n),p}}function q5(e){return fRe(e).concat(pRe(e))}var gRe=Object.hasOwn||function(e,t){return mRe.call(e,t)};function jf(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var yRe="__v",vRe="__o",xRe="_owner",W5=Object.getOwnPropertyDescriptor,G5=Object.keys;function bRe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function _Re(e,t){return jf(e.getTime(),t.getTime())}function wRe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function SRe(e,t){return e===t}function H5(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var o=new Array(n),s=e.entries(),h,i,p=0;(h=s.next())&&!h.done;){for(var y=t.entries(),b=!1,_=0;(i=y.next())&&!i.done;){if(o[_]){_++;continue}var E=h.value,C=i.value;if(r.equals(E[0],C[0],p,_,e,t,r)&&r.equals(E[1],C[1],E[0],C[0],e,t,r)){b=o[_]=!0;break}_++}if(!b)return!1;p++}return!0}var ERe=jf;function TRe(e,t,r){var n=G5(e),o=n.length;if(G5(t).length!==o)return!1;for(;o-- >0;)if(!SZ(e,t,r,n[o]))return!1;return!0}function Mv(e,t,r){var n=q5(e),o=n.length;if(q5(t).length!==o)return!1;for(var s,h,i;o-- >0;)if(s=n[o],!SZ(e,t,r,s)||(h=W5(e,s),i=W5(t,s),(h||i)&&(!h||!i||h.configurable!==i.configurable||h.enumerable!==i.enumerable||h.writable!==i.writable)))return!1;return!0}function jRe(e,t){return jf(e.valueOf(),t.valueOf())}function CRe(e,t){return e.source===t.source&&e.flags===t.flags}function X5(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var o=new Array(n),s=e.values(),h,i;(h=s.next())&&!h.done;){for(var p=t.values(),y=!1,b=0;(i=p.next())&&!i.done;){if(!o[b]&&r.equals(h.value,i.value,h.value,i.value,e,t,r)){y=o[b]=!0;break}b++}if(!y)return!1}return!0}function PRe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function ARe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function SZ(e,t,r,n){return(n===xRe||n===vRe||n===yRe)&&(e.$$typeof||t.$$typeof)?!0:gRe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var kRe="[object Arguments]",NRe="[object Boolean]",MRe="[object Date]",IRe="[object Error]",ORe="[object Map]",DRe="[object Number]",RRe="[object Object]",LRe="[object RegExp]",BRe="[object Set]",zRe="[object String]",$Re="[object URL]",FRe=Array.isArray,Z5=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,K5=Object.assign,URe=Object.prototype.toString.call.bind(Object.prototype.toString);function VRe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,o=e.areFunctionsEqual,s=e.areMapsEqual,h=e.areNumbersEqual,i=e.areObjectsEqual,p=e.arePrimitiveWrappersEqual,y=e.areRegExpsEqual,b=e.areSetsEqual,_=e.areTypedArraysEqual,E=e.areUrlsEqual;return function(k,N,I){if(k===N)return!0;if(k==null||N==null)return!1;var B=typeof k;if(B!==typeof N)return!1;if(B!=="object")return B==="number"?h(k,N,I):B==="function"?o(k,N,I):!1;var O=k.constructor;if(O!==N.constructor)return!1;if(O===Object)return i(k,N,I);if(FRe(k))return t(k,N,I);if(Z5!=null&&Z5(k))return _(k,N,I);if(O===Date)return r(k,N,I);if(O===RegExp)return y(k,N,I);if(O===Map)return s(k,N,I);if(O===Set)return b(k,N,I);var R=URe(k);return R===MRe?r(k,N,I):R===LRe?y(k,N,I):R===ORe?s(k,N,I):R===BRe?b(k,N,I):R===RRe?typeof k.then!="function"&&typeof N.then!="function"&&i(k,N,I):R===$Re?E(k,N,I):R===IRe?n(k,N,I):R===kRe?i(k,N,I):R===NRe||R===DRe||R===zRe?p(k,N,I):!1}}function qRe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,o={areArraysEqual:n?Mv:bRe,areDatesEqual:_Re,areErrorsEqual:wRe,areFunctionsEqual:SRe,areMapsEqual:n?V5(H5,Mv):H5,areNumbersEqual:ERe,areObjectsEqual:n?Mv:TRe,arePrimitiveWrappersEqual:jRe,areRegExpsEqual:CRe,areSetsEqual:n?V5(X5,Mv):X5,areTypedArraysEqual:n?Mv:PRe,areUrlsEqual:ARe};if(r&&(o=K5({},o,r(o))),t){var s=_w(o.areArraysEqual),h=_w(o.areMapsEqual),i=_w(o.areObjectsEqual),p=_w(o.areSetsEqual);o=K5({},o,{areArraysEqual:s,areMapsEqual:h,areObjectsEqual:i,areSetsEqual:p})}return o}function WRe(e){return function(t,r,n,o,s,h,i){return e(t,r,i)}}function GRe(e){var t=e.circular,r=e.comparator,n=e.createState,o=e.equals,s=e.strict;if(n)return function(p,y){var b=n(),_=b.cache,E=_===void 0?t?new WeakMap:void 0:_,C=b.meta;return r(p,y,{cache:E,equals:o,meta:C,strict:s})};if(t)return function(p,y){return r(p,y,{cache:new WeakMap,equals:o,meta:void 0,strict:s})};var h={cache:void 0,equals:o,meta:void 0,strict:s};return function(p,y){return r(p,y,h)}}var HRe=Md();Md({strict:!0});Md({circular:!0});Md({circular:!0,strict:!0});Md({createInternalComparator:function(){return jf}});Md({strict:!0,createInternalComparator:function(){return jf}});Md({circular:!0,createInternalComparator:function(){return jf}});Md({circular:!0,createInternalComparator:function(){return jf},strict:!0});function Md(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,o=e.createState,s=e.strict,h=s===void 0?!1:s,i=qRe(e),p=VRe(i),y=n?n(p):WRe(p);return GRe({circular:r,comparator:p,createState:o,equals:y,strict:h})}function XRe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Y5(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function o(s){r<0&&(r=s),s-r>t?(e(s),r=-1):XRe(o)};requestAnimationFrame(n)}function zk(e){"@babel/helpers - typeof";return zk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zk(e)}function ZRe(e){return QRe(e)||JRe(e)||YRe(e)||KRe()}function KRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YRe(e,t){if(e){if(typeof e=="string")return J5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J5(e,t)}}function J5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QRe(e){if(Array.isArray(e))return e}function eLe(){var e={},t=function(){return null},r=!1,n=function o(s){if(!r){if(Array.isArray(s)){if(!s.length)return;var h=s,i=ZRe(h),p=i[0],y=i.slice(1);if(typeof p=="number"){Y5(o.bind(null,y),p);return}o(p),Y5(o.bind(null,y));return}zk(s)==="object"&&(e=s,t(e)),typeof s=="function"&&s()}};return{stop:function(){r=!0},start:function(s){r=!1,n(s)},subscribe:function(s){return t=s,function(){t=function(){return null}}}}}function hb(e){"@babel/helpers - typeof";return hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hb(e)}function Q5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function eF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q5(Object(r),!0).forEach(function(n){EZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EZ(e,t,r){return t=tLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tLe(e){var t=rLe(e,"string");return hb(t)==="symbol"?t:String(t)}function rLe(e,t){if(hb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nLe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,o){return n.filter(function(s){return o.includes(s)})})},iLe=function(t){return t},oLe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},px=function(t,r){return Object.keys(r).reduce(function(n,o){return eF(eF({},n),{},EZ({},o,t(o,r[o])))},{})},tF=function(t,r,n){return t.map(function(o){return"".concat(oLe(o)," ").concat(r,"ms ").concat(n)}).join(",")};function aLe(e,t){return cLe(e)||lLe(e,t)||TZ(e,t)||sLe()}function sLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,h,i=[],p=!0,y=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);p=!0);}catch(b){y=!0,o=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return i}}function cLe(e){if(Array.isArray(e))return e}function uLe(e){return fLe(e)||hLe(e)||TZ(e)||dLe()}function dLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TZ(e,t){if(e){if(typeof e=="string")return $k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $k(e,t)}}function hLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fLe(e){if(Array.isArray(e))return $k(e)}function $k(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ES=1e-4,jZ=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},CZ=function(t,r){return t.map(function(n,o){return n*Math.pow(r,o)}).reduce(function(n,o){return n+o})},rF=function(t,r){return function(n){var o=jZ(t,r);return CZ(o,n)}},pLe=function(t,r){return function(n){var o=jZ(t,r),s=[].concat(uLe(o.map(function(h,i){return h*i}).slice(1)),[0]);return CZ(s,n)}},nF=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0],s=r[1],h=r[2],i=r[3];if(r.length===1)switch(r[0]){case"linear":o=0,s=0,h=1,i=1;break;case"ease":o=.25,s=.1,h=.25,i=1;break;case"ease-in":o=.42,s=0,h=1,i=1;break;case"ease-out":o=.42,s=0,h=.58,i=1;break;case"ease-in-out":o=0,s=0,h=.58,i=1;break;default:{var p=r[0].split("(");if(p[0]==="cubic-bezier"&&p[1].split(")")[0].split(",").length===4){var y=p[1].split(")")[0].split(",").map(function(I){return parseFloat(I)}),b=aLe(y,4);o=b[0],s=b[1],h=b[2],i=b[3]}}}var _=rF(o,h),E=rF(s,i),C=pLe(o,h),k=function(B){return B>1?1:B<0?0:B},N=function(B){for(var O=B>1?1:B,R=O,q=0;q<8;++q){var F=_(R)-O,X=C(R);if(Math.abs(F-O)<ES||X<ES)return E(R);R=k(R-F/X)}return E(R)};return N.isStepper=!1,N},mLe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,o=t.damping,s=o===void 0?8:o,h=t.dt,i=h===void 0?17:h,p=function(b,_,E){var C=-(b-_)*n,k=E*s,N=E+(C-k)*i/1e3,I=E*i/1e3+b;return Math.abs(I-_)<ES&&Math.abs(N)<ES?[_,0]:[I,N]};return p.isStepper=!0,p.dt=i,p},gLe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0];if(typeof o=="string")switch(o){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return nF(o);case"spring":return mLe();default:if(o.split("(")[0]==="cubic-bezier")return nF(o)}return typeof o=="function"?o:null};function fb(e){"@babel/helpers - typeof";return fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fb(e)}function iF(e){return xLe(e)||vLe(e)||PZ(e)||yLe()}function yLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xLe(e){if(Array.isArray(e))return Uk(e)}function oF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Qi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oF(Object(r),!0).forEach(function(n){Fk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fk(e,t,r){return t=bLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bLe(e){var t=_Le(e,"string");return fb(t)==="symbol"?t:String(t)}function _Le(e,t){if(fb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wLe(e,t){return TLe(e)||ELe(e,t)||PZ(e,t)||SLe()}function SLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PZ(e,t){if(e){if(typeof e=="string")return Uk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Uk(e,t)}}function Uk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ELe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,h,i=[],p=!0,y=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);p=!0);}catch(b){y=!0,o=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return i}}function TLe(e){if(Array.isArray(e))return e}var TS=function(t,r,n){return t+(r-t)*n},Vk=function(t){var r=t.from,n=t.to;return r!==n},jLe=function e(t,r,n){var o=px(function(s,h){if(Vk(h)){var i=t(h.from,h.to,h.velocity),p=wLe(i,2),y=p[0],b=p[1];return Qi(Qi({},h),{},{from:y,velocity:b})}return h},r);return n<1?px(function(s,h){return Vk(h)?Qi(Qi({},h),{},{velocity:TS(h.velocity,o[s].velocity,n),from:TS(h.from,o[s].from,n)}):h},r):e(t,o,n-1)};const CLe=function(e,t,r,n,o){var s=nLe(e,t),h=s.reduce(function(I,B){return Qi(Qi({},I),{},Fk({},B,[e[B],t[B]]))},{}),i=s.reduce(function(I,B){return Qi(Qi({},I),{},Fk({},B,{from:e[B],velocity:0,to:t[B]}))},{}),p=-1,y,b,_=function(){return null},E=function(){return px(function(B,O){return O.from},i)},C=function(){return!Object.values(i).filter(Vk).length},k=function(B){y||(y=B);var O=B-y,R=O/r.dt;i=jLe(r,i,R),o(Qi(Qi(Qi({},e),t),E())),y=B,C()||(p=requestAnimationFrame(_))},N=function(B){b||(b=B);var O=(B-b)/n,R=px(function(F,X){return TS.apply(void 0,iF(X).concat([r(O)]))},h);if(o(Qi(Qi(Qi({},e),t),R)),O<1)p=requestAnimationFrame(_);else{var q=px(function(F,X){return TS.apply(void 0,iF(X).concat([r(1)]))},h);o(Qi(Qi(Qi({},e),t),q))}};return _=r.isStepper?k:N,function(){return requestAnimationFrame(_),function(){cancelAnimationFrame(p)}}};function zm(e){"@babel/helpers - typeof";return zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zm(e)}var PLe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function ALe(e,t){if(e==null)return{};var r=kLe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kLe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,s;for(s=0;s<n.length;s++)o=n[s],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function KC(e){return OLe(e)||ILe(e)||MLe(e)||NLe()}function NLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MLe(e,t){if(e){if(typeof e=="string")return qk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qk(e,t)}}function ILe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function OLe(e){if(Array.isArray(e))return qk(e)}function qk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ms(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aF(Object(r),!0).forEach(function(n){qv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qv(e,t,r){return t=AZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AZ(n.key),n)}}function RLe(e,t,r){return t&&sF(e.prototype,t),r&&sF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AZ(e){var t=LLe(e,"string");return zm(t)==="symbol"?t:String(t)}function LLe(e,t){if(zm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wk(e,t)}function Wk(e,t){return Wk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Wk(e,t)}function zLe(e){var t=$Le();return function(){var n=jS(e),o;if(t){var s=jS(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return Gk(this,o)}}function Gk(e,t){if(t&&(zm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hk(e)}function Hk(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Le(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jS(e){return jS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jS(e)}var CE=function(e){BLe(r,e);var t=zLe(r);function r(n,o){var s;DLe(this,r),s=t.call(this,n,o);var h=s.props,i=h.isActive,p=h.attributeName,y=h.from,b=h.to,_=h.steps,E=h.children,C=h.duration;if(s.handleStyleChange=s.handleStyleChange.bind(Hk(s)),s.changeStyle=s.changeStyle.bind(Hk(s)),!i||C<=0)return s.state={style:{}},typeof E=="function"&&(s.state={style:b}),Gk(s);if(_&&_.length)s.state={style:_[0].style};else if(y){if(typeof E=="function")return s.state={style:y},Gk(s);s.state={style:p?qv({},p,y):y}}else s.state={style:{}};return s}return RLe(r,[{key:"componentDidMount",value:function(){var o=this.props,s=o.isActive,h=o.canBegin;this.mounted=!0,!(!s||!h)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(o){var s=this.props,h=s.isActive,i=s.canBegin,p=s.attributeName,y=s.shouldReAnimate,b=s.to,_=s.from,E=this.state.style;if(i){if(!h){var C={style:p?qv({},p,b):b};this.state&&E&&(p&&E[p]!==b||!p&&E!==b)&&this.setState(C);return}if(!(HRe(o.to,b)&&o.canBegin&&o.isActive)){var k=!o.canBegin||!o.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var N=k||y?_:o.to;if(this.state&&E){var I={style:p?qv({},p,N):N};(p&&E[p]!==N||!p&&E!==N)&&this.setState(I)}this.runAnimation(Ms(Ms({},this.props),{},{from:N,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var o=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),o&&o()}},{key:"handleStyleChange",value:function(o){this.changeStyle(o)}},{key:"changeStyle",value:function(o){this.mounted&&this.setState({style:o})}},{key:"runJSAnimation",value:function(o){var s=this,h=o.from,i=o.to,p=o.duration,y=o.easing,b=o.begin,_=o.onAnimationEnd,E=o.onAnimationStart,C=CLe(h,i,gLe(y),p,this.changeStyle),k=function(){s.stopJSAnimation=C()};this.manager.start([E,b,k,p,_])}},{key:"runStepAnimation",value:function(o){var s=this,h=o.steps,i=o.begin,p=o.onAnimationStart,y=h[0],b=y.style,_=y.duration,E=_===void 0?0:_,C=function(N,I,B){if(B===0)return N;var O=I.duration,R=I.easing,q=R===void 0?"ease":R,F=I.style,X=I.properties,G=I.onAnimationEnd,ee=B>0?h[B-1]:I,K=X||Object.keys(F);if(typeof q=="function"||q==="spring")return[].concat(KC(N),[s.runJSAnimation.bind(s,{from:ee.style,to:F,duration:O,easing:q}),O]);var ie=tF(K,O,q),pe=Ms(Ms(Ms({},ee.style),F),{},{transition:ie});return[].concat(KC(N),[pe,O,G]).filter(iLe)};return this.manager.start([p].concat(KC(h.reduce(C,[b,Math.max(E,i)])),[o.onAnimationEnd]))}},{key:"runAnimation",value:function(o){this.manager||(this.manager=eLe());var s=o.begin,h=o.duration,i=o.attributeName,p=o.to,y=o.easing,b=o.onAnimationStart,_=o.onAnimationEnd,E=o.steps,C=o.children,k=this.manager;if(this.unSubscribe=k.subscribe(this.handleStyleChange),typeof y=="function"||typeof C=="function"||y==="spring"){this.runJSAnimation(o);return}if(E.length>1){this.runStepAnimation(o);return}var N=i?qv({},i,p):p,I=tF(Object.keys(N),h,y);k.start([b,s,Ms(Ms({},N),{},{transition:I}),h,_])}},{key:"render",value:function(){var o=this.props,s=o.children;o.begin;var h=o.duration;o.attributeName,o.easing;var i=o.isActive;o.steps,o.from,o.to,o.canBegin,o.onAnimationEnd,o.shouldReAnimate,o.onAnimationReStart;var p=ALe(o,PLe),y=D.Children.count(s),b=this.state.style;if(typeof s=="function")return s(b);if(!i||y===0||h<=0)return s;var _=function(C){var k=C.props,N=k.style,I=N===void 0?{}:N,B=k.className,O=D.cloneElement(C,Ms(Ms({},p),{},{style:Ms(Ms({},I),b),className:B}));return O};return y===1?_(D.Children.only(s)):je.createElement("div",null,D.Children.map(s,function(E){return _(E)}))}}]),r}(D.PureComponent);CE.displayName="Animate";CE.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};CE.propTypes={from:lr.oneOfType([lr.object,lr.string]),to:lr.oneOfType([lr.object,lr.string]),attributeName:lr.string,duration:lr.number,begin:lr.number,easing:lr.oneOfType([lr.string,lr.func]),steps:lr.arrayOf(lr.shape({duration:lr.number.isRequired,style:lr.object.isRequired,easing:lr.oneOfType([lr.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),lr.func]),properties:lr.arrayOf("string"),onAnimationEnd:lr.func})),children:lr.oneOfType([lr.node,lr.func]),isActive:lr.bool,canBegin:lr.bool,onAnimationEnd:lr.func,shouldReAnimate:lr.bool,onAnimationStart:lr.func,onAnimationReStart:lr.func};const $m=CE;function pb(e){"@babel/helpers - typeof";return pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pb(e)}function CS(){return CS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},CS.apply(this,arguments)}function FLe(e,t){return WLe(e)||qLe(e,t)||VLe(e,t)||ULe()}function ULe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VLe(e,t){if(e){if(typeof e=="string")return lF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lF(e,t)}}function lF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,h,i=[],p=!0,y=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);p=!0);}catch(b){y=!0,o=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return i}}function WLe(e){if(Array.isArray(e))return e}function cF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function uF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cF(Object(r),!0).forEach(function(n){GLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GLe(e,t,r){return t=HLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HLe(e){var t=XLe(e,"string");return pb(t)=="symbol"?t:t+""}function XLe(e,t){if(pb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dF=function(t,r,n,o,s){var h=Math.min(Math.abs(n)/2,Math.abs(o)/2),i=o>=0?1:-1,p=n>=0?1:-1,y=o>=0&&n>=0||o<0&&n<0?1:0,b;if(h>0&&s instanceof Array){for(var _=[0,0,0,0],E=0,C=4;E<C;E++)_[E]=s[E]>h?h:s[E];b="M".concat(t,",").concat(r+i*_[0]),_[0]>0&&(b+="A ".concat(_[0],",").concat(_[0],",0,0,").concat(y,",").concat(t+p*_[0],",").concat(r)),b+="L ".concat(t+n-p*_[1],",").concat(r),_[1]>0&&(b+="A ".concat(_[1],",").concat(_[1],",0,0,").concat(y,`,
        `).concat(t+n,",").concat(r+i*_[1])),b+="L ".concat(t+n,",").concat(r+o-i*_[2]),_[2]>0&&(b+="A ".concat(_[2],",").concat(_[2],",0,0,").concat(y,`,
        `).concat(t+n-p*_[2],",").concat(r+o)),b+="L ".concat(t+p*_[3],",").concat(r+o),_[3]>0&&(b+="A ".concat(_[3],",").concat(_[3],",0,0,").concat(y,`,
        `).concat(t,",").concat(r+o-i*_[3])),b+="Z"}else if(h>0&&s===+s&&s>0){var k=Math.min(h,s);b="M ".concat(t,",").concat(r+i*k,`
            A `).concat(k,",").concat(k,",0,0,").concat(y,",").concat(t+p*k,",").concat(r,`
            L `).concat(t+n-p*k,",").concat(r,`
            A `).concat(k,",").concat(k,",0,0,").concat(y,",").concat(t+n,",").concat(r+i*k,`
            L `).concat(t+n,",").concat(r+o-i*k,`
            A `).concat(k,",").concat(k,",0,0,").concat(y,",").concat(t+n-p*k,",").concat(r+o,`
            L `).concat(t+p*k,",").concat(r+o,`
            A `).concat(k,",").concat(k,",0,0,").concat(y,",").concat(t,",").concat(r+o-i*k," Z")}else b="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(o," h ").concat(-n," Z");return b},ZLe=function(t,r){if(!t||!r)return!1;var n=t.x,o=t.y,s=r.x,h=r.y,i=r.width,p=r.height;if(Math.abs(i)>0&&Math.abs(p)>0){var y=Math.min(s,s+i),b=Math.max(s,s+i),_=Math.min(h,h+p),E=Math.max(h,h+p);return n>=y&&n<=b&&o>=_&&o<=E}return!1},KLe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},AO=function(t){var r=uF(uF({},KLe),t),n=D.useRef(),o=D.useState(-1),s=FLe(o,2),h=s[0],i=s[1];D.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var q=n.current.getTotalLength();q&&i(q)}catch{}},[]);var p=r.x,y=r.y,b=r.width,_=r.height,E=r.radius,C=r.className,k=r.animationEasing,N=r.animationDuration,I=r.animationBegin,B=r.isAnimationActive,O=r.isUpdateAnimationActive;if(p!==+p||y!==+y||b!==+b||_!==+_||b===0||_===0)return null;var R=Zr("recharts-rectangle",C);return O?je.createElement($m,{canBegin:h>0,from:{width:b,height:_,x:p,y},to:{width:b,height:_,x:p,y},duration:N,animationEasing:k,isActive:O},function(q){var F=q.width,X=q.height,G=q.x,ee=q.y;return je.createElement($m,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:I,duration:N,isActive:B,easing:k},je.createElement("path",CS({},Xr(r,!0),{className:R,d:dF(G,ee,F,X,E),ref:n})))}):je.createElement("path",CS({},Xr(r,!0),{className:R,d:dF(p,y,b,_,E)}))};function Xk(){return Xk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xk.apply(this,arguments)}var kO=function(t){var r=t.cx,n=t.cy,o=t.r,s=t.className,h=Zr("recharts-dot",s);return r===+r&&n===+n&&o===+o?je.createElement("circle",Xk({},Xr(t,!1),G1(t),{className:h,cx:r,cy:n,r:o})):null};function mb(e){"@babel/helpers - typeof";return mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mb(e)}var YLe=["x","y","top","left","width","height","className"];function Zk(){return Zk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zk.apply(this,arguments)}function hF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function JLe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hF(Object(r),!0).forEach(function(n){QLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QLe(e,t,r){return t=e3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e3e(e){var t=t3e(e,"string");return mb(t)=="symbol"?t:t+""}function t3e(e,t){if(mb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r3e(e,t){if(e==null)return{};var r=n3e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function n3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var i3e=function(t,r,n,o,s,h){return"M".concat(t,",").concat(s,"v").concat(o,"M").concat(h,",").concat(r,"h").concat(n)},o3e=function(t){var r=t.x,n=r===void 0?0:r,o=t.y,s=o===void 0?0:o,h=t.top,i=h===void 0?0:h,p=t.left,y=p===void 0?0:p,b=t.width,_=b===void 0?0:b,E=t.height,C=E===void 0?0:E,k=t.className,N=r3e(t,YLe),I=JLe({x:n,y:s,top:i,left:y,width:_,height:C},N);return!Ft(n)||!Ft(s)||!Ft(_)||!Ft(C)||!Ft(i)||!Ft(y)?null:je.createElement("path",Zk({},Xr(I,!0),{className:Zr("recharts-cross",k),d:i3e(n,s,_,C,i,y)}))},a3e=UH,s3e=a3e(Object.getPrototypeOf,Object),l3e=s3e,c3e=Gc,u3e=l3e,d3e=Hc,h3e="[object Object]",f3e=Function.prototype,p3e=Object.prototype,kZ=f3e.toString,m3e=p3e.hasOwnProperty,g3e=kZ.call(Object);function y3e(e){if(!d3e(e)||c3e(e)!=h3e)return!1;var t=u3e(e);if(t===null)return!0;var r=m3e.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&kZ.call(r)==g3e}var v3e=y3e;const x3e=wn(v3e);var b3e=Gc,_3e=Hc,w3e="[object Boolean]";function S3e(e){return e===!0||e===!1||_3e(e)&&b3e(e)==w3e}var E3e=S3e;const T3e=wn(E3e);function gb(e){"@babel/helpers - typeof";return gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gb(e)}function PS(){return PS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PS.apply(this,arguments)}function j3e(e,t){return k3e(e)||A3e(e,t)||P3e(e,t)||C3e()}function C3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P3e(e,t){if(e){if(typeof e=="string")return fF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fF(e,t)}}function fF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,h,i=[],p=!0,y=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);p=!0);}catch(b){y=!0,o=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return i}}function k3e(e){if(Array.isArray(e))return e}function pF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function mF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pF(Object(r),!0).forEach(function(n){N3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function N3e(e,t,r){return t=M3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M3e(e){var t=I3e(e,"string");return gb(t)=="symbol"?t:t+""}function I3e(e,t){if(gb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gF=function(t,r,n,o,s){var h=n-o,i;return i="M ".concat(t,",").concat(r),i+="L ".concat(t+n,",").concat(r),i+="L ".concat(t+n-h/2,",").concat(r+s),i+="L ".concat(t+n-h/2-o,",").concat(r+s),i+="L ".concat(t,",").concat(r," Z"),i},O3e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},D3e=function(t){var r=mF(mF({},O3e),t),n=D.useRef(),o=D.useState(-1),s=j3e(o,2),h=s[0],i=s[1];D.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var R=n.current.getTotalLength();R&&i(R)}catch{}},[]);var p=r.x,y=r.y,b=r.upperWidth,_=r.lowerWidth,E=r.height,C=r.className,k=r.animationEasing,N=r.animationDuration,I=r.animationBegin,B=r.isUpdateAnimationActive;if(p!==+p||y!==+y||b!==+b||_!==+_||E!==+E||b===0&&_===0||E===0)return null;var O=Zr("recharts-trapezoid",C);return B?je.createElement($m,{canBegin:h>0,from:{upperWidth:0,lowerWidth:0,height:E,x:p,y},to:{upperWidth:b,lowerWidth:_,height:E,x:p,y},duration:N,animationEasing:k,isActive:B},function(R){var q=R.upperWidth,F=R.lowerWidth,X=R.height,G=R.x,ee=R.y;return je.createElement($m,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:I,duration:N,easing:k},je.createElement("path",PS({},Xr(r,!0),{className:O,d:gF(G,ee,q,F,X),ref:n})))}):je.createElement("g",null,je.createElement("path",PS({},Xr(r,!0),{className:O,d:gF(p,y,b,_,E)})))},R3e=["option","shapeType","propTransformer","activeClassName","isActive"];function yb(e){"@babel/helpers - typeof";return yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yb(e)}function L3e(e,t){if(e==null)return{};var r=B3e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function B3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function yF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function AS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yF(Object(r),!0).forEach(function(n){z3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z3e(e,t,r){return t=$3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $3e(e){var t=F3e(e,"string");return yb(t)=="symbol"?t:t+""}function F3e(e,t){if(yb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U3e(e,t){return AS(AS({},t),e)}function V3e(e,t){return e==="symbols"}function vF(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return je.createElement(AO,r);case"trapezoid":return je.createElement(D3e,r);case"sector":return je.createElement(xZ,r);case"symbols":if(V3e(t))return je.createElement(XI,r);break;default:return null}}function q3e(e){return D.isValidElement(e)?e.props:e}function W3e(e){var t=e.option,r=e.shapeType,n=e.propTransformer,o=n===void 0?U3e:n,s=e.activeClassName,h=s===void 0?"recharts-active-shape":s,i=e.isActive,p=L3e(e,R3e),y;if(D.isValidElement(t))y=D.cloneElement(t,AS(AS({},p),q3e(t)));else if(Nr(t))y=t(p);else if(x3e(t)&&!T3e(t)){var b=o(t,p);y=je.createElement(vF,{shapeType:r,elementProps:b})}else{var _=p;y=je.createElement(vF,{shapeType:r,elementProps:_})}return i?je.createElement(pi,{className:h},y):y}function PE(e,t){return t!=null&&"trapezoids"in e.props}function AE(e,t){return t!=null&&"sectors"in e.props}function vb(e,t){return t!=null&&"points"in e.props}function G3e(e,t){var r,n,o=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,s=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return o&&s}function H3e(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function X3e(e,t){var r=e.x===t.x,n=e.y===t.y,o=e.z===t.z;return r&&n&&o}function Z3e(e,t){var r;return PE(e,t)?r=G3e:AE(e,t)?r=H3e:vb(e,t)&&(r=X3e),r}function K3e(e,t){var r;return PE(e,t)?r="trapezoids":AE(e,t)?r="sectors":vb(e,t)&&(r="points"),r}function Y3e(e,t){if(PE(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(AE(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return vb(e,t)?t.payload:{}}function J3e(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,o=K3e(r,t),s=Y3e(r,t),h=n.filter(function(p,y){var b=EE(s,p),_=r.props[o].filter(function(k){var N=Z3e(r,t);return N(k,t)}),E=r.props[o].indexOf(_[_.length-1]),C=y===E;return b&&C}),i=n.indexOf(h[h.length-1]);return i}var Q3e=Math.ceil,e4e=Math.max;function t4e(e,t,r,n){for(var o=-1,s=e4e(Q3e((t-e)/(r||1)),0),h=Array(s);s--;)h[n?s:++o]=e,e+=r;return h}var r4e=t4e,n4e=sX,xF=1/0,i4e=17976931348623157e292;function o4e(e){if(!e)return e===0?e:0;if(e=n4e(e),e===xF||e===-xF){var t=e<0?-1:1;return t*i4e}return e===e?e:0}var NZ=o4e,a4e=r4e,s4e=mE,YC=NZ;function l4e(e){return function(t,r,n){return n&&typeof n!="number"&&s4e(t,r,n)&&(r=n=void 0),t=YC(t),r===void 0?(r=t,t=0):r=YC(r),n=n===void 0?t<r?1:-1:YC(n),a4e(t,r,n,e)}}var c4e=l4e,u4e=c4e,d4e=u4e(),h4e=d4e;const kS=wn(h4e);function xb(e){"@babel/helpers - typeof";return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xb(e)}function bF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _F(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bF(Object(r),!0).forEach(function(n){MZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MZ(e,t,r){return t=f4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f4e(e){var t=p4e(e,"string");return xb(t)=="symbol"?t:t+""}function p4e(e,t){if(xb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var m4e=["Webkit","Moz","O","ms"],g4e=function(t,r){if(!t)return null;var n=t.replace(/(\w)/,function(s){return s.toUpperCase()}),o=m4e.reduce(function(s,h){return _F(_F({},s),{},MZ({},h+n,r))},{});return o[t]=r,o};function Fm(e){"@babel/helpers - typeof";return Fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fm(e)}function NS(){return NS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},NS.apply(this,arguments)}function wF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function JC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wF(Object(r),!0).forEach(function(n){xa(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OZ(n.key),n)}}function v4e(e,t,r){return t&&SF(e.prototype,t),r&&SF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x4e(e,t,r){return t=MS(t),b4e(e,IZ()?Reflect.construct(t,r||[],MS(e).constructor):t.apply(e,r))}function b4e(e,t){if(t&&(Fm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _4e(e)}function _4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IZ=function(){return!!e})()}function MS(e){return MS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},MS(e)}function w4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kk(e,t)}function Kk(e,t){return Kk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Kk(e,t)}function xa(e,t,r){return t=OZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OZ(e){var t=S4e(e,"string");return Fm(t)=="symbol"?t:t+""}function S4e(e,t){if(Fm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E4e=function(t){var r=t.data,n=t.startIndex,o=t.endIndex,s=t.x,h=t.width,i=t.travellerWidth;if(!r||!r.length)return{};var p=r.length,y=hx().domain(kS(0,p)).range([s,s+h-i]),b=y.domain().map(function(_){return y(_)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:y(n),endX:y(o),scale:y,scaleValues:b}},EF=function(t){return t.changedTouches&&!!t.changedTouches.length},Um=function(e){function t(r){var n;return y4e(this,t),n=x4e(this,t,[r]),xa(n,"handleDrag",function(o){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(o):n.state.isSlideMoving&&n.handleSlideDrag(o)}),xa(n,"handleTouchMove",function(o){o.changedTouches!=null&&o.changedTouches.length>0&&n.handleDrag(o.changedTouches[0])}),xa(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var o=n.props,s=o.endIndex,h=o.onDragEnd,i=o.startIndex;h==null||h({endIndex:s,startIndex:i})}),n.detachDragEndListener()}),xa(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),xa(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),xa(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),xa(n,"handleSlideDragStart",function(o){var s=EF(o)?o.changedTouches[0]:o;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:s.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return w4e(t,e),v4e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var o=n.startX,s=n.endX,h=this.state.scaleValues,i=this.props,p=i.gap,y=i.data,b=y.length-1,_=Math.min(o,s),E=Math.max(o,s),C=t.getIndexInRange(h,_),k=t.getIndexInRange(h,E);return{startIndex:C-C%p,endIndex:k===b?b:k-k%p}}},{key:"getTextOfTick",value:function(n){var o=this.props,s=o.data,h=o.tickFormatter,i=o.dataKey,p=ka(s[n],i,n);return Nr(h)?h(p,n):p}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var o=this.state,s=o.slideMoveStartX,h=o.startX,i=o.endX,p=this.props,y=p.x,b=p.width,_=p.travellerWidth,E=p.startIndex,C=p.endIndex,k=p.onChange,N=n.pageX-s;N>0?N=Math.min(N,y+b-_-i,y+b-_-h):N<0&&(N=Math.max(N,y-h,y-i));var I=this.getIndex({startX:h+N,endX:i+N});(I.startIndex!==E||I.endIndex!==C)&&k&&k(I),this.setState({startX:h+N,endX:i+N,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,o){var s=EF(o)?o.changedTouches[0]:o;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:s.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var o=this.state,s=o.brushMoveStartX,h=o.movingTravellerId,i=o.endX,p=o.startX,y=this.state[h],b=this.props,_=b.x,E=b.width,C=b.travellerWidth,k=b.onChange,N=b.gap,I=b.data,B={startX:this.state.startX,endX:this.state.endX},O=n.pageX-s;O>0?O=Math.min(O,_+E-C-y):O<0&&(O=Math.max(O,_-y)),B[h]=y+O;var R=this.getIndex(B),q=R.startIndex,F=R.endIndex,X=function(){var ee=I.length-1;return h==="startX"&&(i>p?q%N===0:F%N===0)||i<p&&F===ee||h==="endX"&&(i>p?F%N===0:q%N===0)||i>p&&F===ee};this.setState(xa(xa({},h,y+O),"brushMoveStartX",n.pageX),function(){k&&X()&&k(R)})}},{key:"handleTravellerMoveKeyboard",value:function(n,o){var s=this,h=this.state,i=h.scaleValues,p=h.startX,y=h.endX,b=this.state[o],_=i.indexOf(b);if(_!==-1){var E=_+n;if(!(E===-1||E>=i.length)){var C=i[E];o==="startX"&&C>=y||o==="endX"&&C<=p||this.setState(xa({},o,C),function(){s.props.onChange(s.getIndex({startX:s.state.startX,endX:s.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,o=n.x,s=n.y,h=n.width,i=n.height,p=n.fill,y=n.stroke;return je.createElement("rect",{stroke:y,fill:p,x:o,y:s,width:h,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,o=n.x,s=n.y,h=n.width,i=n.height,p=n.data,y=n.children,b=n.padding,_=D.Children.only(y);return _?je.cloneElement(_,{x:o,y:s,width:h,height:i,margin:b,compact:!0,data:p}):null}},{key:"renderTravellerLayer",value:function(n,o){var s,h,i=this,p=this.props,y=p.y,b=p.travellerWidth,_=p.height,E=p.traveller,C=p.ariaLabel,k=p.data,N=p.startIndex,I=p.endIndex,B=Math.max(n,this.props.x),O=JC(JC({},Xr(this.props,!1)),{},{x:B,y,width:b,height:_}),R=C||"Min value: ".concat((s=k[N])===null||s===void 0?void 0:s.name,", Max value: ").concat((h=k[I])===null||h===void 0?void 0:h.name);return je.createElement(pi,{tabIndex:0,role:"slider","aria-label":R,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[o],onTouchStart:this.travellerDragStartHandlers[o],onKeyDown:function(F){["ArrowLeft","ArrowRight"].includes(F.key)&&(F.preventDefault(),F.stopPropagation(),i.handleTravellerMoveKeyboard(F.key==="ArrowRight"?1:-1,o))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(E,O))}},{key:"renderSlide",value:function(n,o){var s=this.props,h=s.y,i=s.height,p=s.stroke,y=s.travellerWidth,b=Math.min(n,o)+y,_=Math.max(Math.abs(o-n)-y,0);return je.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:p,fillOpacity:.2,x:b,y:h,width:_,height:i})}},{key:"renderText",value:function(){var n=this.props,o=n.startIndex,s=n.endIndex,h=n.y,i=n.height,p=n.travellerWidth,y=n.stroke,b=this.state,_=b.startX,E=b.endX,C=5,k={pointerEvents:"none",fill:y};return je.createElement(pi,{className:"recharts-brush-texts"},je.createElement(sS,NS({textAnchor:"end",verticalAnchor:"middle",x:Math.min(_,E)-C,y:h+i/2},k),this.getTextOfTick(o)),je.createElement(sS,NS({textAnchor:"start",verticalAnchor:"middle",x:Math.max(_,E)+p+C,y:h+i/2},k),this.getTextOfTick(s)))}},{key:"render",value:function(){var n=this.props,o=n.data,s=n.className,h=n.children,i=n.x,p=n.y,y=n.width,b=n.height,_=n.alwaysShowText,E=this.state,C=E.startX,k=E.endX,N=E.isTextActive,I=E.isSlideMoving,B=E.isTravellerMoving,O=E.isTravellerFocused;if(!o||!o.length||!Ft(i)||!Ft(p)||!Ft(y)||!Ft(b)||y<=0||b<=0)return null;var R=Zr("recharts-brush",s),q=je.Children.count(h)===1,F=g4e("userSelect","none");return je.createElement(pi,{className:R,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:F},this.renderBackground(),q&&this.renderPanorama(),this.renderSlide(C,k),this.renderTravellerLayer(C,"startX"),this.renderTravellerLayer(k,"endX"),(N||I||B||O||_)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var o=n.x,s=n.y,h=n.width,i=n.height,p=n.stroke,y=Math.floor(s+i/2)-1;return je.createElement(je.Fragment,null,je.createElement("rect",{x:o,y:s,width:h,height:i,fill:p,stroke:"none"}),je.createElement("line",{x1:o+1,y1:y,x2:o+h-1,y2:y,fill:"none",stroke:"#fff"}),je.createElement("line",{x1:o+1,y1:y+2,x2:o+h-1,y2:y+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,o){var s;return je.isValidElement(n)?s=je.cloneElement(n,o):Nr(n)?s=n(o):s=t.renderDefaultTraveller(o),s}},{key:"getDerivedStateFromProps",value:function(n,o){var s=n.data,h=n.width,i=n.x,p=n.travellerWidth,y=n.updateId,b=n.startIndex,_=n.endIndex;if(s!==o.prevData||y!==o.prevUpdateId)return JC({prevData:s,prevTravellerWidth:p,prevUpdateId:y,prevX:i,prevWidth:h},s&&s.length?E4e({data:s,width:h,x:i,travellerWidth:p,startIndex:b,endIndex:_}):{scale:null,scaleValues:null});if(o.scale&&(h!==o.prevWidth||i!==o.prevX||p!==o.prevTravellerWidth)){o.scale.range([i,i+h-p]);var E=o.scale.domain().map(function(C){return o.scale(C)});return{prevData:s,prevTravellerWidth:p,prevUpdateId:y,prevX:i,prevWidth:h,startX:o.scale(n.startIndex),endX:o.scale(n.endIndex),scaleValues:E}}return null}},{key:"getIndexInRange",value:function(n,o){for(var s=n.length,h=0,i=s-1;i-h>1;){var p=Math.floor((h+i)/2);n[p]>o?i=p:h=p}return o>=n[i]?i:h}}])}(D.PureComponent);xa(Um,"displayName","Brush");xa(Um,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var T4e=tO;function j4e(e,t){var r;return T4e(e,function(n,o,s){return r=t(n,o,s),!r}),!!r}var C4e=j4e,P4e=OH,A4e=Ad,k4e=C4e,N4e=ua,M4e=mE;function I4e(e,t,r){var n=N4e(e)?P4e:k4e;return r&&M4e(e,t,r)&&(t=void 0),n(e,A4e(t))}var O4e=I4e;const D4e=wn(O4e);var Nl=function(t,r){var n=t.alwaysShow,o=t.ifOverflow;return n&&(o="extendDomain"),o===r},TF=rX;function R4e(e,t,r){t=="__proto__"&&TF?TF(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var L4e=R4e,B4e=L4e,z4e=eX,$4e=Ad;function F4e(e,t){var r={};return t=$4e(t),z4e(e,function(n,o,s){B4e(r,o,t(n,o,s))}),r}var U4e=F4e;const V4e=wn(U4e);function q4e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var W4e=q4e,G4e=tO;function H4e(e,t){var r=!0;return G4e(e,function(n,o,s){return r=!!t(n,o,s),r}),r}var X4e=H4e,Z4e=W4e,K4e=X4e,Y4e=Ad,J4e=ua,Q4e=mE;function eBe(e,t,r){var n=J4e(e)?Z4e:K4e;return r&&Q4e(e,t,r)&&(t=void 0),n(e,Y4e(t))}var tBe=eBe;const DZ=wn(tBe);var rBe=["x","y"];function bb(e){"@babel/helpers - typeof";return bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bb(e)}function Yk(){return Yk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yk.apply(this,arguments)}function jF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Iv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jF(Object(r),!0).forEach(function(n){nBe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nBe(e,t,r){return t=iBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iBe(e){var t=oBe(e,"string");return bb(t)=="symbol"?t:t+""}function oBe(e,t){if(bb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aBe(e,t){if(e==null)return{};var r=sBe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function sBe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function lBe(e,t){var r=e.x,n=e.y,o=aBe(e,rBe),s="".concat(r),h=parseInt(s,10),i="".concat(n),p=parseInt(i,10),y="".concat(t.height||o.height),b=parseInt(y,10),_="".concat(t.width||o.width),E=parseInt(_,10);return Iv(Iv(Iv(Iv(Iv({},t),o),h?{x:h}:{}),p?{y:p}:{}),{},{height:b,width:E,name:t.name,radius:t.radius})}function CF(e){return je.createElement(W3e,Yk({shapeType:"rectangle",propTransformer:lBe,activeClassName:"recharts-active-bar"},e))}var cBe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,o){if(typeof t=="number")return t;var s=typeof n=="number";return s?t(n,o):(s||ff(!1),r)}},uBe=["value","background"],RZ;function Vm(e){"@babel/helpers - typeof";return Vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vm(e)}function dBe(e,t){if(e==null)return{};var r=hBe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hBe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function IS(){return IS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},IS.apply(this,arguments)}function PF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ei(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PF(Object(r),!0).forEach(function(n){Zu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BZ(n.key),n)}}function pBe(e,t,r){return t&&AF(e.prototype,t),r&&AF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mBe(e,t,r){return t=OS(t),gBe(e,LZ()?Reflect.construct(t,r||[],OS(e).constructor):t.apply(e,r))}function gBe(e,t){if(t&&(Vm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yBe(e)}function yBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LZ=function(){return!!e})()}function OS(e){return OS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},OS(e)}function vBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jk(e,t)}function Jk(e,t){return Jk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Jk(e,t)}function Zu(e,t,r){return t=BZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BZ(e){var t=xBe(e,"string");return Vm(t)=="symbol"?t:t+""}function xBe(e,t){if(Vm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var e0=function(e){function t(){var r;fBe(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r=mBe(this,t,[].concat(o)),Zu(r,"state",{isAnimationFinished:!1}),Zu(r,"id",Hb("recharts-bar-")),Zu(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),h&&h()}),Zu(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),h&&h()}),r}return vBe(t,e),pBe(t,[{key:"renderRectanglesStatically",value:function(n){var o=this,s=this.props,h=s.shape,i=s.dataKey,p=s.activeIndex,y=s.activeBar,b=Xr(this.props,!1);return n&&n.map(function(_,E){var C=E===p,k=C?y:h,N=Ei(Ei(Ei({},b),_),{},{isActive:C,option:k,index:E,dataKey:i,onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd});return je.createElement(pi,IS({className:"recharts-bar-rectangle"},H1(o.props,_,E),{key:"rectangle-".concat(_==null?void 0:_.x,"-").concat(_==null?void 0:_.y,"-").concat(_==null?void 0:_.value,"-").concat(E)}),je.createElement(CF,N))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,o=this.props,s=o.data,h=o.layout,i=o.isAnimationActive,p=o.animationBegin,y=o.animationDuration,b=o.animationEasing,_=o.animationId,E=this.state.prevData;return je.createElement($m,{begin:p,duration:y,isActive:i,easing:b,from:{t:0},to:{t:1},key:"bar-".concat(_),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(C){var k=C.t,N=s.map(function(I,B){var O=E&&E[B];if(O){var R=Us(O.x,I.x),q=Us(O.y,I.y),F=Us(O.width,I.width),X=Us(O.height,I.height);return Ei(Ei({},I),{},{x:R(k),y:q(k),width:F(k),height:X(k)})}if(h==="horizontal"){var G=Us(0,I.height),ee=G(k);return Ei(Ei({},I),{},{y:I.y+I.height-ee,height:ee})}var K=Us(0,I.width),ie=K(k);return Ei(Ei({},I),{},{width:ie})});return je.createElement(pi,null,n.renderRectanglesStatically(N))})}},{key:"renderRectangles",value:function(){var n=this.props,o=n.data,s=n.isAnimationActive,h=this.state.prevData;return s&&o&&o.length&&(!h||!EE(h,o))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(o)}},{key:"renderBackground",value:function(){var n=this,o=this.props,s=o.data,h=o.dataKey,i=o.activeIndex,p=Xr(this.props.background,!1);return s.map(function(y,b){y.value;var _=y.background,E=dBe(y,uBe);if(!_)return null;var C=Ei(Ei(Ei(Ei(Ei({},E),{},{fill:"#eee"},_),p),H1(n.props,y,b)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:h,index:b,className:"recharts-bar-background-rectangle"});return je.createElement(CF,IS({key:"background-bar-".concat(b),option:n.props.background,isActive:b===i},C))})}},{key:"renderErrorBar",value:function(n,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,h=s.data,i=s.xAxis,p=s.yAxis,y=s.layout,b=s.children,_=rs(b,Qb);if(!_)return null;var E=y==="vertical"?h[0].height/2:h[0].width/2,C=function(I,B){var O=Array.isArray(I.value)?I.value[1]:I.value;return{x:I.x,y:I.y,value:O,errorVal:ka(I,B)}},k={clipPath:n?"url(#clipPath-".concat(o,")"):null};return je.createElement(pi,k,_.map(function(N){return je.cloneElement(N,{key:"error-bar-".concat(o,"-").concat(N.props.dataKey),data:h,xAxis:i,yAxis:p,layout:y,offset:E,dataPointFormatter:C})}))}},{key:"render",value:function(){var n=this.props,o=n.hide,s=n.data,h=n.className,i=n.xAxis,p=n.yAxis,y=n.left,b=n.top,_=n.width,E=n.height,C=n.isAnimationActive,k=n.background,N=n.id;if(o||!s||!s.length)return null;var I=this.state.isAnimationFinished,B=Zr("recharts-bar",h),O=i&&i.allowDataOverflow,R=p&&p.allowDataOverflow,q=O||R,F=Wr(N)?this.id:N;return je.createElement(pi,{className:B},O||R?je.createElement("defs",null,je.createElement("clipPath",{id:"clipPath-".concat(F)},je.createElement("rect",{x:O?y:y-_/2,y:R?b:b-E/2,width:O?_:_*2,height:R?E:E*2}))):null,je.createElement(pi,{className:"recharts-bar-rectangles",clipPath:q?"url(#clipPath-".concat(F,")"):null},k?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(q,F),(!C||I)&&ld.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:o.curData}:n.data!==o.curData?{curData:n.data}:null}}])}(D.PureComponent);RZ=e0;Zu(e0,"displayName","Bar");Zu(e0,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Tc.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Zu(e0,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,o=e.bandSize,s=e.xAxis,h=e.yAxis,i=e.xAxisTicks,p=e.yAxisTicks,y=e.stackedData,b=e.dataStartIndex,_=e.displayedData,E=e.offset,C=KOe(n,r);if(!C)return null;var k=t.layout,N=r.type.defaultProps,I=N!==void 0?Ei(Ei({},N),r.props):r.props,B=I.dataKey,O=I.children,R=I.minPointSize,q=k==="horizontal"?h:s,F=y?q.scale.domain():null,X=iDe({numericAxis:q}),G=rs(O,uX),ee=_.map(function(K,ie){var pe,ae,_e,Ee,xe,ce;y?pe=YOe(y[b+ie],F):(pe=ka(K,B),Array.isArray(pe)||(pe=[X,pe]));var ke=cBe(R,RZ.defaultProps.minPointSize)(pe[1],ie);if(k==="horizontal"){var ve,Pe=[h.scale(pe[0]),h.scale(pe[1])],Re=Pe[0],Be=Pe[1];ae=C5({axis:s,ticks:i,bandSize:o,offset:C.offset,entry:K,index:ie}),_e=(ve=Be??Re)!==null&&ve!==void 0?ve:void 0,Ee=C.size;var Fe=Re-Be;if(xe=Number.isNaN(Fe)?0:Fe,ce={x:ae,y:h.y,width:Ee,height:h.height},Math.abs(ke)>0&&Math.abs(xe)<Math.abs(ke)){var Ge=Ws(xe||ke)*(Math.abs(ke)-Math.abs(xe));_e-=Ge,xe+=Ge}}else{var Pt=[s.scale(pe[0]),s.scale(pe[1])],$t=Pt[0],nr=Pt[1];if(ae=$t,_e=C5({axis:h,ticks:p,bandSize:o,offset:C.offset,entry:K,index:ie}),Ee=nr-$t,xe=C.size,ce={x:s.x,y:_e,width:s.width,height:xe},Math.abs(ke)>0&&Math.abs(Ee)<Math.abs(ke)){var Nt=Ws(Ee||ke)*(Math.abs(ke)-Math.abs(Ee));Ee+=Nt}}return Ei(Ei(Ei({},K),{},{x:ae,y:_e,width:Ee,height:xe,value:y?pe:pe[1],payload:K,background:ce},G&&G[ie]&&G[ie].props),{},{tooltipPayload:[gZ(r,K)],tooltipPosition:{x:ae+Ee/2,y:_e+xe/2}})});return Ei({data:ee,layout:k},E)});function _b(e){"@babel/helpers - typeof";return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_b(e)}function bBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zZ(n.key),n)}}function _Be(e,t,r){return t&&kF(e.prototype,t),r&&kF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function zs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NF(Object(r),!0).forEach(function(n){kE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kE(e,t,r){return t=zZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zZ(e){var t=wBe(e,"string");return _b(t)=="symbol"?t:t+""}function wBe(e,t){if(_b(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_b(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SBe=function(t,r,n,o,s){var h=t.width,i=t.height,p=t.layout,y=t.children,b=Object.keys(r),_={left:n.left,leftMirror:n.left,right:h-n.right,rightMirror:h-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},E=!!_a(y,e0);return b.reduce(function(C,k){var N=r[k],I=N.orientation,B=N.domain,O=N.padding,R=O===void 0?{}:O,q=N.mirror,F=N.reversed,X="".concat(I).concat(q?"Mirror":""),G,ee,K,ie,pe;if(N.type==="number"&&(N.padding==="gap"||N.padding==="no-gap")){var ae=B[1]-B[0],_e=1/0,Ee=N.categoricalDomain.sort(I_e);if(Ee.forEach(function(Pt,$t){$t>0&&(_e=Math.min((Pt||0)-(Ee[$t-1]||0),_e))}),Number.isFinite(_e)){var xe=_e/ae,ce=N.layout==="vertical"?n.height:n.width;if(N.padding==="gap"&&(G=xe*ce/2),N.padding==="no-gap"){var ke=df(t.barCategoryGap,xe*ce),ve=xe*ce/2;G=ve-ke-(ve-ke)/ce*ke}}}o==="xAxis"?ee=[n.left+(R.left||0)+(G||0),n.left+n.width-(R.right||0)-(G||0)]:o==="yAxis"?ee=p==="horizontal"?[n.top+n.height-(R.bottom||0),n.top+(R.top||0)]:[n.top+(R.top||0)+(G||0),n.top+n.height-(R.bottom||0)-(G||0)]:ee=N.range,F&&(ee=[ee[1],ee[0]]);var Pe=XOe(N,s,E),Re=Pe.scale,Be=Pe.realScaleType;Re.domain(B).range(ee),ZOe(Re);var Fe=nDe(Re,zs(zs({},N),{},{realScaleType:Be}));o==="xAxis"?(pe=I==="top"&&!q||I==="bottom"&&q,K=n.left,ie=_[X]-pe*N.height):o==="yAxis"&&(pe=I==="left"&&!q||I==="right"&&q,K=_[X]-pe*N.width,ie=n.top);var Ge=zs(zs(zs({},N),Fe),{},{realScaleType:Be,x:K,y:ie,scale:Re,width:o==="xAxis"?n.width:N.width,height:o==="yAxis"?n.height:N.height});return Ge.bandSize=_S(Ge,Fe),!N.hide&&o==="xAxis"?_[X]+=(pe?-1:1)*Ge.height:N.hide||(_[X]+=(pe?-1:1)*Ge.width),zs(zs({},C),{},kE({},k,Ge))},{})},$Z=function(t,r){var n=t.x,o=t.y,s=r.x,h=r.y;return{x:Math.min(n,s),y:Math.min(o,h),width:Math.abs(s-n),height:Math.abs(h-o)}},EBe=function(t){var r=t.x1,n=t.y1,o=t.x2,s=t.y2;return $Z({x:r,y:n},{x:o,y:s})},FZ=function(){function e(t){bBe(this,e),this.scale=t}return _Be(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.bandAware,s=n.position;if(r!==void 0){if(s)switch(s){case"start":return this.scale(r);case"middle":{var h=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+h}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(r)+i}default:return this.scale(r)}if(o){var p=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+p}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),o=n[0],s=n[n.length-1];return o<=s?r>=o&&r<=s:r>=s&&r<=o}}],[{key:"create",value:function(r){return new e(r)}}])}();kE(FZ,"EPS",1e-4);var NO=function(t){var r=Object.keys(t).reduce(function(n,o){return zs(zs({},n),{},kE({},o,FZ.create(t[o])))},{});return zs(zs({},r),{},{apply:function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=s.bandAware,i=s.position;return V4e(o,function(p,y){return r[y].apply(p,{bandAware:h,position:i})})},isInRange:function(o){return DZ(o,function(s,h){return r[h].isInRange(s)})}})};function TBe(e){return(e%180+180)%180}var jBe=function(t){var r=t.width,n=t.height,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=TBe(o),h=s*Math.PI/180,i=Math.atan(n/r),p=h>i&&h<Math.PI-i?n/Math.sin(h):r/Math.cos(h);return Math.abs(p)},CBe=Ad,PBe=Xb,ABe=fE;function kBe(e){return function(t,r,n){var o=Object(t);if(!PBe(t)){var s=CBe(r);t=ABe(t),r=function(i){return s(o[i],i,o)}}var h=e(t,r,n);return h>-1?o[s?t[h]:h]:void 0}}var NBe=kBe,MBe=NZ;function IBe(e){var t=MBe(e),r=t%1;return t===t?r?t-r:t:0}var OBe=IBe,DBe=XH,RBe=Ad,LBe=OBe,BBe=Math.max;function zBe(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var o=r==null?0:LBe(r);return o<0&&(o=BBe(n+o,0)),DBe(e,RBe(t),o)}var $Be=zBe,FBe=NBe,UBe=$Be,VBe=FBe(UBe),qBe=VBe;const WBe=wn(qBe);var GBe=D0e(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),MO=D.createContext(void 0),IO=D.createContext(void 0),UZ=D.createContext(void 0),VZ=D.createContext({}),qZ=D.createContext(void 0),WZ=D.createContext(0),GZ=D.createContext(0),MF=function(t){var r=t.state,n=r.xAxisMap,o=r.yAxisMap,s=r.offset,h=t.clipPathId,i=t.children,p=t.width,y=t.height,b=GBe(s);return je.createElement(MO.Provider,{value:n},je.createElement(IO.Provider,{value:o},je.createElement(VZ.Provider,{value:s},je.createElement(UZ.Provider,{value:b},je.createElement(qZ.Provider,{value:h},je.createElement(WZ.Provider,{value:y},je.createElement(GZ.Provider,{value:p},i)))))))},HBe=function(){return D.useContext(qZ)},HZ=function(t){var r=D.useContext(MO);r==null&&ff(!1);var n=r[t];return n==null&&ff(!1),n},XBe=function(){var t=D.useContext(MO);return Wu(t)},ZBe=function(){var t=D.useContext(IO),r=WBe(t,function(n){return DZ(n.domain,Number.isFinite)});return r||Wu(t)},XZ=function(t){var r=D.useContext(IO);r==null&&ff(!1);var n=r[t];return n==null&&ff(!1),n},KBe=function(){var t=D.useContext(UZ);return t},YBe=function(){return D.useContext(VZ)},OO=function(){return D.useContext(GZ)},DO=function(){return D.useContext(WZ)};function qm(e){"@babel/helpers - typeof";return qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qm(e)}function JBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KZ(n.key),n)}}function QBe(e,t,r){return t&&IF(e.prototype,t),r&&IF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eze(e,t,r){return t=DS(t),tze(e,ZZ()?Reflect.construct(t,r||[],DS(e).constructor):t.apply(e,r))}function tze(e,t){if(t&&(qm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rze(e)}function rze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZZ=function(){return!!e})()}function DS(e){return DS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},DS(e)}function nze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qk(e,t)}function Qk(e,t){return Qk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Qk(e,t)}function OF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function DF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OF(Object(r),!0).forEach(function(n){RO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RO(e,t,r){return t=KZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KZ(e){var t=ize(e,"string");return qm(t)=="symbol"?t:t+""}function ize(e,t){if(qm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oze(e,t){return cze(e)||lze(e,t)||sze(e,t)||aze()}function aze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sze(e,t){if(e){if(typeof e=="string")return RF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RF(e,t)}}function RF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lze(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,h,i=[],p=!0,y=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);p=!0);}catch(b){y=!0,o=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return i}}function cze(e){if(Array.isArray(e))return e}function eN(){return eN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eN.apply(this,arguments)}var uze=function(t,r){var n;return je.isValidElement(t)?n=je.cloneElement(t,r):Nr(t)?n=t(r):n=je.createElement("line",eN({},r,{className:"recharts-reference-line-line"})),n},dze=function(t,r,n,o,s,h,i,p,y){var b=s.x,_=s.y,E=s.width,C=s.height;if(n){var k=y.y,N=t.y.apply(k,{position:h});if(Nl(y,"discard")&&!t.y.isInRange(N))return null;var I=[{x:b+E,y:N},{x:b,y:N}];return p==="left"?I.reverse():I}if(r){var B=y.x,O=t.x.apply(B,{position:h});if(Nl(y,"discard")&&!t.x.isInRange(O))return null;var R=[{x:O,y:_+C},{x:O,y:_}];return i==="top"?R.reverse():R}if(o){var q=y.segment,F=q.map(function(X){return t.apply(X,{position:h})});return Nl(y,"discard")&&D4e(F,function(X){return!t.isInRange(X)})?null:F}return null};function hze(e){var t=e.x,r=e.y,n=e.segment,o=e.xAxisId,s=e.yAxisId,h=e.shape,i=e.className,p=e.alwaysShow,y=HBe(),b=HZ(o),_=XZ(s),E=KBe();if(!y||!E)return null;Ec(p===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var C=NO({x:b.scale,y:_.scale}),k=Li(t),N=Li(r),I=n&&n.length===2,B=dze(C,k,N,I,E,e.position,b.orientation,_.orientation,e);if(!B)return null;var O=oze(B,2),R=O[0],q=R.x,F=R.y,X=O[1],G=X.x,ee=X.y,K=Nl(e,"hidden")?"url(#".concat(y,")"):void 0,ie=DF(DF({clipPath:K},Xr(e,!0)),{},{x1:q,y1:F,x2:G,y2:ee});return je.createElement(pi,{className:Zr("recharts-reference-line",i)},uze(h,ie),So.renderCallByParent(e,EBe({x1:q,y1:F,x2:G,y2:ee})))}var LO=function(e){function t(){return JBe(this,t),eze(this,t,arguments)}return nze(t,e),QBe(t,[{key:"render",value:function(){return je.createElement(hze,this.props)}}])}(je.Component);RO(LO,"displayName","ReferenceLine");RO(LO,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function tN(){return tN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tN.apply(this,arguments)}function Wm(e){"@babel/helpers - typeof";return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wm(e)}function LF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function BF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LF(Object(r),!0).forEach(function(n){NE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JZ(n.key),n)}}function pze(e,t,r){return t&&zF(e.prototype,t),r&&zF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mze(e,t,r){return t=RS(t),gze(e,YZ()?Reflect.construct(t,r||[],RS(e).constructor):t.apply(e,r))}function gze(e,t){if(t&&(Wm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yze(e)}function yze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(YZ=function(){return!!e})()}function RS(e){return RS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},RS(e)}function vze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rN(e,t)}function rN(e,t){return rN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rN(e,t)}function NE(e,t,r){return t=JZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JZ(e){var t=xze(e,"string");return Wm(t)=="symbol"?t:t+""}function xze(e,t){if(Wm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bze=function(t){var r=t.x,n=t.y,o=t.xAxis,s=t.yAxis,h=NO({x:o.scale,y:s.scale}),i=h.apply({x:r,y:n},{bandAware:!0});return Nl(t,"discard")&&!h.isInRange(i)?null:i},ME=function(e){function t(){return fze(this,t),mze(this,t,arguments)}return vze(t,e),pze(t,[{key:"render",value:function(){var n=this.props,o=n.x,s=n.y,h=n.r,i=n.alwaysShow,p=n.clipPathId,y=Li(o),b=Li(s);if(Ec(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!y||!b)return null;var _=bze(this.props);if(!_)return null;var E=_.x,C=_.y,k=this.props,N=k.shape,I=k.className,B=Nl(this.props,"hidden")?"url(#".concat(p,")"):void 0,O=BF(BF({clipPath:B},Xr(this.props,!0)),{},{cx:E,cy:C});return je.createElement(pi,{className:Zr("recharts-reference-dot",I)},t.renderDot(N,O),So.renderCallByParent(this.props,{x:E-h,y:C-h,width:2*h,height:2*h}))}}])}(je.Component);NE(ME,"displayName","ReferenceDot");NE(ME,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});NE(ME,"renderDot",function(e,t){var r;return je.isValidElement(e)?r=je.cloneElement(e,t):Nr(e)?r=e(t):r=je.createElement(kO,tN({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function nN(){return nN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nN.apply(this,arguments)}function Gm(e){"@babel/helpers - typeof";return Gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gm(e)}function $F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function FF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$F(Object(r),!0).forEach(function(n){IE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$F(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eK(n.key),n)}}function wze(e,t,r){return t&&UF(e.prototype,t),r&&UF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sze(e,t,r){return t=LS(t),Eze(e,QZ()?Reflect.construct(t,r||[],LS(e).constructor):t.apply(e,r))}function Eze(e,t){if(t&&(Gm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tze(e)}function Tze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QZ=function(){return!!e})()}function LS(e){return LS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},LS(e)}function jze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iN(e,t)}function iN(e,t){return iN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iN(e,t)}function IE(e,t,r){return t=eK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eK(e){var t=Cze(e,"string");return Gm(t)=="symbol"?t:t+""}function Cze(e,t){if(Gm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pze=function(t,r,n,o,s){var h=s.x1,i=s.x2,p=s.y1,y=s.y2,b=s.xAxis,_=s.yAxis;if(!b||!_)return null;var E=NO({x:b.scale,y:_.scale}),C={x:t?E.x.apply(h,{position:"start"}):E.x.rangeMin,y:n?E.y.apply(p,{position:"start"}):E.y.rangeMin},k={x:r?E.x.apply(i,{position:"end"}):E.x.rangeMax,y:o?E.y.apply(y,{position:"end"}):E.y.rangeMax};return Nl(s,"discard")&&(!E.isInRange(C)||!E.isInRange(k))?null:$Z(C,k)},OE=function(e){function t(){return _ze(this,t),Sze(this,t,arguments)}return jze(t,e),wze(t,[{key:"render",value:function(){var n=this.props,o=n.x1,s=n.x2,h=n.y1,i=n.y2,p=n.className,y=n.alwaysShow,b=n.clipPathId;Ec(y===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var _=Li(o),E=Li(s),C=Li(h),k=Li(i),N=this.props.shape;if(!_&&!E&&!C&&!k&&!N)return null;var I=Pze(_,E,C,k,this.props);if(!I&&!N)return null;var B=Nl(this.props,"hidden")?"url(#".concat(b,")"):void 0;return je.createElement(pi,{className:Zr("recharts-reference-area",p)},t.renderRect(N,FF(FF({clipPath:B},Xr(this.props,!0)),I)),So.renderCallByParent(this.props,I))}}])}(je.Component);IE(OE,"displayName","ReferenceArea");IE(OE,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});IE(OE,"renderRect",function(e,t){var r;return je.isValidElement(e)?r=je.cloneElement(e,t):Nr(e)?r=e(t):r=je.createElement(AO,nN({},t,{className:"recharts-reference-area-rect"})),r});function tK(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],o=0;o<e.length;o+=t)if(r===void 0||r(e[o])===!0)n.push(e[o]);else return;return n}function Aze(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return jBe(n,r)}function kze(e,t,r){var n=r==="width",o=e.x,s=e.y,h=e.width,i=e.height;return t===1?{start:n?o:s,end:n?o+h:s+i}:{start:n?o+h:s+i,end:n?o:s}}function BS(e,t,r,n,o){if(e*t<e*n||e*t>e*o)return!1;var s=r();return e*(t-e*s/2-n)>=0&&e*(t+e*s/2-o)<=0}function Nze(e,t){return tK(e,t+1)}function Mze(e,t,r,n,o){for(var s=(n||[]).slice(),h=t.start,i=t.end,p=0,y=1,b=h,_=function(){var k=n==null?void 0:n[p];if(k===void 0)return{v:tK(n,y)};var N=p,I,B=function(){return I===void 0&&(I=r(k,N)),I},O=k.coordinate,R=p===0||BS(e,O,B,b,i);R||(p=0,b=h,y+=1),R&&(b=O+e*(B()/2+o),p+=y)},E;y<=s.length;)if(E=_(),E)return E.v;return[]}function wb(e){"@babel/helpers - typeof";return wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wb(e)}function VF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _o(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VF(Object(r),!0).forEach(function(n){Ize(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ize(e,t,r){return t=Oze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oze(e){var t=Dze(e,"string");return wb(t)=="symbol"?t:t+""}function Dze(e,t){if(wb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rze(e,t,r,n,o){for(var s=(n||[]).slice(),h=s.length,i=t.start,p=t.end,y=function(E){var C=s[E],k,N=function(){return k===void 0&&(k=r(C,E)),k};if(E===h-1){var I=e*(C.coordinate+e*N()/2-p);s[E]=C=_o(_o({},C),{},{tickCoord:I>0?C.coordinate-I*e:C.coordinate})}else s[E]=C=_o(_o({},C),{},{tickCoord:C.coordinate});var B=BS(e,C.tickCoord,N,i,p);B&&(p=C.tickCoord-e*(N()/2+o),s[E]=_o(_o({},C),{},{isShow:!0}))},b=h-1;b>=0;b--)y(b);return s}function Lze(e,t,r,n,o,s){var h=(n||[]).slice(),i=h.length,p=t.start,y=t.end;if(s){var b=n[i-1],_=r(b,i-1),E=e*(b.coordinate+e*_/2-y);h[i-1]=b=_o(_o({},b),{},{tickCoord:E>0?b.coordinate-E*e:b.coordinate});var C=BS(e,b.tickCoord,function(){return _},p,y);C&&(y=b.tickCoord-e*(_/2+o),h[i-1]=_o(_o({},b),{},{isShow:!0}))}for(var k=s?i-1:i,N=function(O){var R=h[O],q,F=function(){return q===void 0&&(q=r(R,O)),q};if(O===0){var X=e*(R.coordinate-e*F()/2-p);h[O]=R=_o(_o({},R),{},{tickCoord:X<0?R.coordinate-X*e:R.coordinate})}else h[O]=R=_o(_o({},R),{},{tickCoord:R.coordinate});var G=BS(e,R.tickCoord,F,p,y);G&&(p=R.tickCoord+e*(F()/2+o),h[O]=_o(_o({},R),{},{isShow:!0}))},I=0;I<k;I++)N(I);return h}function BO(e,t,r){var n=e.tick,o=e.ticks,s=e.viewBox,h=e.minTickGap,i=e.orientation,p=e.interval,y=e.tickFormatter,b=e.unit,_=e.angle;if(!o||!o.length||!n)return[];if(Ft(p)||Tc.isSsr)return Nze(o,typeof p=="number"&&Ft(p)?p:0);var E=[],C=i==="top"||i==="bottom"?"width":"height",k=b&&C==="width"?dx(b,{fontSize:t,letterSpacing:r}):{width:0,height:0},N=function(R,q){var F=Nr(y)?y(R.value,q):R.value;return C==="width"?Aze(dx(F,{fontSize:t,letterSpacing:r}),k,_):dx(F,{fontSize:t,letterSpacing:r})[C]},I=o.length>=2?Ws(o[1].coordinate-o[0].coordinate):1,B=kze(s,I,C);return p==="equidistantPreserveStart"?Mze(I,B,N,o,h):(p==="preserveStart"||p==="preserveStartEnd"?E=Lze(I,B,N,o,h,p==="preserveStartEnd"):E=Rze(I,B,N,o,h),E.filter(function(O){return O.isShow}))}var Bze=["viewBox"],zze=["viewBox"],$ze=["ticks"];function Hm(e){"@babel/helpers - typeof";return Hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hm(e)}function im(){return im=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},im.apply(this,arguments)}function qF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function No(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qF(Object(r),!0).forEach(function(n){zO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QC(e,t){if(e==null)return{};var r=Fze(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Fze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Uze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nK(n.key),n)}}function Vze(e,t,r){return t&&WF(e.prototype,t),r&&WF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qze(e,t,r){return t=zS(t),Wze(e,rK()?Reflect.construct(t,r||[],zS(e).constructor):t.apply(e,r))}function Wze(e,t){if(t&&(Hm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gze(e)}function Gze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rK=function(){return!!e})()}function zS(e){return zS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zS(e)}function Hze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oN(e,t)}function oN(e,t){return oN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oN(e,t)}function zO(e,t,r){return t=nK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nK(e){var t=Xze(e,"string");return Hm(t)=="symbol"?t:t+""}function Xze(e,t){if(Hm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kg=function(e){function t(r){var n;return Uze(this,t),n=qze(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return Hze(t,e),Vze(t,[{key:"shouldComponentUpdate",value:function(n,o){var s=n.viewBox,h=QC(n,Bze),i=this.props,p=i.viewBox,y=QC(i,zze);return!pm(s,p)||!pm(h,y)||!pm(o,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var o=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];o&&this.setState({fontSize:window.getComputedStyle(o).fontSize,letterSpacing:window.getComputedStyle(o).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var o=this.props,s=o.x,h=o.y,i=o.width,p=o.height,y=o.orientation,b=o.tickSize,_=o.mirror,E=o.tickMargin,C,k,N,I,B,O,R=_?-1:1,q=n.tickSize||b,F=Ft(n.tickCoord)?n.tickCoord:n.coordinate;switch(y){case"top":C=k=n.coordinate,I=h+ +!_*p,N=I-R*q,O=N-R*E,B=F;break;case"left":N=I=n.coordinate,k=s+ +!_*i,C=k-R*q,B=C-R*E,O=F;break;case"right":N=I=n.coordinate,k=s+ +_*i,C=k+R*q,B=C+R*E,O=F;break;default:C=k=n.coordinate,I=h+ +_*p,N=I+R*q,O=N+R*E,B=F;break}return{line:{x1:C,y1:N,x2:k,y2:I},tick:{x:B,y:O}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,o=n.orientation,s=n.mirror,h;switch(o){case"left":h=s?"start":"end";break;case"right":h=s?"end":"start";break;default:h="middle";break}return h}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,o=n.orientation,s=n.mirror,h="end";switch(o){case"left":case"right":h="middle";break;case"top":h=s?"start":"end";break;default:h=s?"end":"start";break}return h}},{key:"renderAxisLine",value:function(){var n=this.props,o=n.x,s=n.y,h=n.width,i=n.height,p=n.orientation,y=n.mirror,b=n.axisLine,_=No(No(No({},Xr(this.props,!1)),Xr(b,!1)),{},{fill:"none"});if(p==="top"||p==="bottom"){var E=+(p==="top"&&!y||p==="bottom"&&y);_=No(No({},_),{},{x1:o,y1:s+E*i,x2:o+h,y2:s+E*i})}else{var C=+(p==="left"&&!y||p==="right"&&y);_=No(No({},_),{},{x1:o+C*h,y1:s,x2:o+C*h,y2:s+i})}return je.createElement("line",im({},_,{className:Zr("recharts-cartesian-axis-line",ts(b,"className"))}))}},{key:"renderTicks",value:function(n,o,s){var h=this,i=this.props,p=i.tickLine,y=i.stroke,b=i.tick,_=i.tickFormatter,E=i.unit,C=BO(No(No({},this.props),{},{ticks:n}),o,s),k=this.getTickTextAnchor(),N=this.getTickVerticalAnchor(),I=Xr(this.props,!1),B=Xr(b,!1),O=No(No({},I),{},{fill:"none"},Xr(p,!1)),R=C.map(function(q,F){var X=h.getTickLineCoord(q),G=X.line,ee=X.tick,K=No(No(No(No({textAnchor:k,verticalAnchor:N},I),{},{stroke:"none",fill:y},B),ee),{},{index:F,payload:q,visibleTicksCount:C.length,tickFormatter:_});return je.createElement(pi,im({className:"recharts-cartesian-axis-tick",key:"tick-".concat(q.value,"-").concat(q.coordinate,"-").concat(q.tickCoord)},H1(h.props,q,F)),p&&je.createElement("line",im({},O,G,{className:Zr("recharts-cartesian-axis-tick-line",ts(p,"className"))})),b&&t.renderTickItem(b,K,"".concat(Nr(_)?_(q.value,F):q.value).concat(E||"")))});return je.createElement("g",{className:"recharts-cartesian-axis-ticks"},R)}},{key:"render",value:function(){var n=this,o=this.props,s=o.axisLine,h=o.width,i=o.height,p=o.ticksGenerator,y=o.className,b=o.hide;if(b)return null;var _=this.props,E=_.ticks,C=QC(_,$ze),k=E;return Nr(p)&&(k=E&&E.length>0?p(this.props):p(C)),h<=0||i<=0||!k||!k.length?null:je.createElement(pi,{className:Zr("recharts-cartesian-axis",y),ref:function(I){n.layerReference=I}},s&&this.renderAxisLine(),this.renderTicks(k,this.state.fontSize,this.state.letterSpacing),So.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,o,s){var h;return je.isValidElement(n)?h=je.cloneElement(n,o):Nr(n)?h=n(o):h=je.createElement(sS,im({},o,{className:"recharts-cartesian-axis-tick-value"}),s),h}}])}(D.Component);zO(kg,"displayName","CartesianAxis");zO(kg,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Zze=["x1","y1","x2","y2","key"],Kze=["offset"];function pf(e){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(e)}function GF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Eo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GF(Object(r),!0).forEach(function(n){Yze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yze(e,t,r){return t=Jze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jze(e){var t=Qze(e,"string");return pf(t)=="symbol"?t:t+""}function Qze(e,t){if(pf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wh(){return Wh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wh.apply(this,arguments)}function HF(e,t){if(e==null)return{};var r=e$e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function e$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var t$e=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,o=t.x,s=t.y,h=t.width,i=t.height,p=t.ry;return je.createElement("rect",{x:o,y:s,ry:p,width:h,height:i,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function iK(e,t){var r;if(je.isValidElement(e))r=je.cloneElement(e,t);else if(Nr(e))r=e(t);else{var n=t.x1,o=t.y1,s=t.x2,h=t.y2,i=t.key,p=HF(t,Zze),y=Xr(p,!1);y.offset;var b=HF(y,Kze);r=je.createElement("line",Wh({},b,{x1:n,y1:o,x2:s,y2:h,fill:"none",key:i}))}return r}function r$e(e){var t=e.x,r=e.width,n=e.horizontal,o=n===void 0?!0:n,s=e.horizontalPoints;if(!o||!s||!s.length)return null;var h=s.map(function(i,p){var y=Eo(Eo({},e),{},{x1:t,y1:i,x2:t+r,y2:i,key:"line-".concat(p),index:p});return iK(o,y)});return je.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function n$e(e){var t=e.y,r=e.height,n=e.vertical,o=n===void 0?!0:n,s=e.verticalPoints;if(!o||!s||!s.length)return null;var h=s.map(function(i,p){var y=Eo(Eo({},e),{},{x1:i,y1:t,x2:i,y2:t+r,key:"line-".concat(p),index:p});return iK(o,y)});return je.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function i$e(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,o=e.y,s=e.width,h=e.height,i=e.horizontalPoints,p=e.horizontal,y=p===void 0?!0:p;if(!y||!t||!t.length)return null;var b=i.map(function(E){return Math.round(E+o-o)}).sort(function(E,C){return E-C});o!==b[0]&&b.unshift(0);var _=b.map(function(E,C){var k=!b[C+1],N=k?o+h-E:b[C+1]-E;if(N<=0)return null;var I=C%t.length;return je.createElement("rect",{key:"react-".concat(C),y:E,x:n,height:N,width:s,stroke:"none",fill:t[I],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return je.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},_)}function o$e(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,o=e.fillOpacity,s=e.x,h=e.y,i=e.width,p=e.height,y=e.verticalPoints;if(!r||!n||!n.length)return null;var b=y.map(function(E){return Math.round(E+s-s)}).sort(function(E,C){return E-C});s!==b[0]&&b.unshift(0);var _=b.map(function(E,C){var k=!b[C+1],N=k?s+i-E:b[C+1]-E;if(N<=0)return null;var I=C%n.length;return je.createElement("rect",{key:"react-".concat(C),x:E,y:h,width:N,height:p,stroke:"none",fill:n[I],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return je.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},_)}var a$e=function(t,r){var n=t.xAxis,o=t.width,s=t.height,h=t.offset;return pZ(BO(Eo(Eo(Eo({},kg.defaultProps),n),{},{ticks:xc(n,!0),viewBox:{x:0,y:0,width:o,height:s}})),h.left,h.left+h.width,r)},s$e=function(t,r){var n=t.yAxis,o=t.width,s=t.height,h=t.offset;return pZ(BO(Eo(Eo(Eo({},kg.defaultProps),n),{},{ticks:xc(n,!0),viewBox:{x:0,y:0,width:o,height:s}})),h.top,h.top+h.height,r)},Bp={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function $O(e){var t,r,n,o,s,h,i=OO(),p=DO(),y=YBe(),b=Eo(Eo({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Bp.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Bp.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Bp.horizontal,horizontalFill:(o=e.horizontalFill)!==null&&o!==void 0?o:Bp.horizontalFill,vertical:(s=e.vertical)!==null&&s!==void 0?s:Bp.vertical,verticalFill:(h=e.verticalFill)!==null&&h!==void 0?h:Bp.verticalFill,x:Ft(e.x)?e.x:y.left,y:Ft(e.y)?e.y:y.top,width:Ft(e.width)?e.width:y.width,height:Ft(e.height)?e.height:y.height}),_=b.x,E=b.y,C=b.width,k=b.height,N=b.syncWithTicks,I=b.horizontalValues,B=b.verticalValues,O=XBe(),R=ZBe();if(!Ft(C)||C<=0||!Ft(k)||k<=0||!Ft(_)||_!==+_||!Ft(E)||E!==+E)return null;var q=b.verticalCoordinatesGenerator||a$e,F=b.horizontalCoordinatesGenerator||s$e,X=b.horizontalPoints,G=b.verticalPoints;if((!X||!X.length)&&Nr(F)){var ee=I&&I.length,K=F({yAxis:R?Eo(Eo({},R),{},{ticks:ee?I:R.ticks}):void 0,width:i,height:p,offset:y},ee?!0:N);Ec(Array.isArray(K),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(pf(K),"]")),Array.isArray(K)&&(X=K)}if((!G||!G.length)&&Nr(q)){var ie=B&&B.length,pe=q({xAxis:O?Eo(Eo({},O),{},{ticks:ie?B:O.ticks}):void 0,width:i,height:p,offset:y},ie?!0:N);Ec(Array.isArray(pe),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(pf(pe),"]")),Array.isArray(pe)&&(G=pe)}return je.createElement("g",{className:"recharts-cartesian-grid"},je.createElement(t$e,{fill:b.fill,fillOpacity:b.fillOpacity,x:b.x,y:b.y,width:b.width,height:b.height,ry:b.ry}),je.createElement(r$e,Wh({},b,{offset:y,horizontalPoints:X,xAxis:O,yAxis:R})),je.createElement(n$e,Wh({},b,{offset:y,verticalPoints:G,xAxis:O,yAxis:R})),je.createElement(i$e,Wh({},b,{horizontalPoints:X})),je.createElement(o$e,Wh({},b,{verticalPoints:G})))}$O.displayName="CartesianGrid";var l$e=["type","layout","connectNulls","ref"],c$e=["key"];function Xm(e){"@babel/helpers - typeof";return Xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xm(e)}function XF(e,t){if(e==null)return{};var r=u$e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function u$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function mx(){return mx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mx.apply(this,arguments)}function ZF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function va(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZF(Object(r),!0).forEach(function(n){$s(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zp(e){return p$e(e)||f$e(e)||h$e(e)||d$e()}function d$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h$e(e,t){if(e){if(typeof e=="string")return aN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aN(e,t)}}function f$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function p$e(e){if(Array.isArray(e))return aN(e)}function aN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aK(n.key),n)}}function g$e(e,t,r){return t&&KF(e.prototype,t),r&&KF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y$e(e,t,r){return t=$S(t),v$e(e,oK()?Reflect.construct(t,r||[],$S(e).constructor):t.apply(e,r))}function v$e(e,t){if(t&&(Xm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x$e(e)}function x$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oK=function(){return!!e})()}function $S(e){return $S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$S(e)}function b$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sN(e,t)}function sN(e,t){return sN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sN(e,t)}function $s(e,t,r){return t=aK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aK(e){var t=_$e(e,"string");return Xm(t)=="symbol"?t:t+""}function _$e(e,t){if(Xm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yd=function(e){function t(){var r;m$e(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r=y$e(this,t,[].concat(o)),$s(r,"state",{isAnimationFinished:!0,totalLength:0}),$s(r,"generateSimpleStrokeDasharray",function(h,i){return"".concat(i,"px ").concat(h-i,"px")}),$s(r,"getStrokeDasharray",function(h,i,p){var y=p.reduce(function(B,O){return B+O});if(!y)return r.generateSimpleStrokeDasharray(i,h);for(var b=Math.floor(h/y),_=h%y,E=i-h,C=[],k=0,N=0;k<p.length;N+=p[k],++k)if(N+p[k]>_){C=[].concat(zp(p.slice(0,k)),[_-N]);break}var I=C.length%2===0?[0,E]:[E];return[].concat(zp(t.repeat(p,b)),zp(C),I).map(function(B){return"".concat(B,"px")}).join(", ")}),$s(r,"id",Hb("recharts-line-")),$s(r,"pathRef",function(h){r.mainCurve=h}),$s(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),$s(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return b$e(t,e),g$e(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,h=s.points,i=s.xAxis,p=s.yAxis,y=s.layout,b=s.children,_=rs(b,Qb);if(!_)return null;var E=function(N,I){return{x:N.x,y:N.y,value:N.value,errorVal:ka(N.payload,I)}},C={clipPath:n?"url(#clipPath-".concat(o,")"):null};return je.createElement(pi,C,_.map(function(k){return je.cloneElement(k,{key:"bar-".concat(k.props.dataKey),data:h,xAxis:i,yAxis:p,layout:y,dataPointFormatter:E})}))}},{key:"renderDots",value:function(n,o,s){var h=this.props.isAnimationActive;if(h&&!this.state.isAnimationFinished)return null;var i=this.props,p=i.dot,y=i.points,b=i.dataKey,_=Xr(this.props,!1),E=Xr(p,!0),C=y.map(function(N,I){var B=va(va(va({key:"dot-".concat(I),r:3},_),E),{},{index:I,cx:N.x,cy:N.y,value:N.value,dataKey:b,payload:N.payload,points:y});return t.renderDotItem(p,B)}),k={clipPath:n?"url(#clipPath-".concat(o?"":"dots-").concat(s,")"):null};return je.createElement(pi,mx({className:"recharts-line-dots",key:"dots"},k),C)}},{key:"renderCurveStatically",value:function(n,o,s,h){var i=this.props,p=i.type,y=i.layout,b=i.connectNulls;i.ref;var _=XF(i,l$e),E=va(va(va({},Xr(_,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:o?"url(#clipPath-".concat(s,")"):null,points:n},h),{},{type:p,layout:y,connectNulls:b});return je.createElement(Bk,mx({},E,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,o){var s=this,h=this.props,i=h.points,p=h.strokeDasharray,y=h.isAnimationActive,b=h.animationBegin,_=h.animationDuration,E=h.animationEasing,C=h.animationId,k=h.animateNewValues,N=h.width,I=h.height,B=this.state,O=B.prevPoints,R=B.totalLength;return je.createElement($m,{begin:b,duration:_,isActive:y,easing:E,from:{t:0},to:{t:1},key:"line-".concat(C),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(q){var F=q.t;if(O){var X=O.length/i.length,G=i.map(function(ae,_e){var Ee=Math.floor(_e*X);if(O[Ee]){var xe=O[Ee],ce=Us(xe.x,ae.x),ke=Us(xe.y,ae.y);return va(va({},ae),{},{x:ce(F),y:ke(F)})}if(k){var ve=Us(N*2,ae.x),Pe=Us(I/2,ae.y);return va(va({},ae),{},{x:ve(F),y:Pe(F)})}return va(va({},ae),{},{x:ae.x,y:ae.y})});return s.renderCurveStatically(G,n,o)}var ee=Us(0,R),K=ee(F),ie;if(p){var pe="".concat(p).split(/[,\s]+/gim).map(function(ae){return parseFloat(ae)});ie=s.getStrokeDasharray(K,R,pe)}else ie=s.generateSimpleStrokeDasharray(R,K);return s.renderCurveStatically(i,n,o,{strokeDasharray:ie})})}},{key:"renderCurve",value:function(n,o){var s=this.props,h=s.points,i=s.isAnimationActive,p=this.state,y=p.prevPoints,b=p.totalLength;return i&&h&&h.length&&(!y&&b>0||!EE(y,h))?this.renderCurveWithAnimation(n,o):this.renderCurveStatically(h,n,o)}},{key:"render",value:function(){var n,o=this.props,s=o.hide,h=o.dot,i=o.points,p=o.className,y=o.xAxis,b=o.yAxis,_=o.top,E=o.left,C=o.width,k=o.height,N=o.isAnimationActive,I=o.id;if(s||!i||!i.length)return null;var B=this.state.isAnimationFinished,O=i.length===1,R=Zr("recharts-line",p),q=y&&y.allowDataOverflow,F=b&&b.allowDataOverflow,X=q||F,G=Wr(I)?this.id:I,ee=(n=Xr(h,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},K=ee.r,ie=K===void 0?3:K,pe=ee.strokeWidth,ae=pe===void 0?2:pe,_e=U_e(h)?h:{},Ee=_e.clipDot,xe=Ee===void 0?!0:Ee,ce=ie*2+ae;return je.createElement(pi,{className:R},q||F?je.createElement("defs",null,je.createElement("clipPath",{id:"clipPath-".concat(G)},je.createElement("rect",{x:q?E:E-C/2,y:F?_:_-k/2,width:q?C:C*2,height:F?k:k*2})),!xe&&je.createElement("clipPath",{id:"clipPath-dots-".concat(G)},je.createElement("rect",{x:E-ce/2,y:_-ce/2,width:C+ce,height:k+ce}))):null,!O&&this.renderCurve(X,G),this.renderErrorBar(X,G),(O||h)&&this.renderDots(X,xe,G),(!N||B)&&ld.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:o.curPoints}:n.points!==o.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,o){for(var s=n.length%2!==0?[].concat(zp(n),[0]):n,h=[],i=0;i<o;++i)h=[].concat(zp(h),zp(s));return h}},{key:"renderDotItem",value:function(n,o){var s;if(je.isValidElement(n))s=je.cloneElement(n,o);else if(Nr(n))s=n(o);else{var h=o.key,i=XF(o,c$e),p=Zr("recharts-line-dot",typeof n!="boolean"?n.className:"");s=je.createElement(kO,mx({key:h},i,{className:p}))}return s}}])}(D.PureComponent);$s(yd,"displayName","Line");$s(yd,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Tc.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});$s(yd,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,o=e.xAxisTicks,s=e.yAxisTicks,h=e.dataKey,i=e.bandSize,p=e.displayedData,y=e.offset,b=t.layout,_=p.map(function(E,C){var k=ka(E,h);return b==="horizontal"?{x:j5({axis:r,ticks:o,bandSize:i,entry:E,index:C}),y:Wr(k)?null:n.scale(k),value:k,payload:E}:{x:Wr(k)?null:r.scale(k),y:j5({axis:n,ticks:s,bandSize:i,entry:E,index:C}),value:k,payload:E}});return va({points:_,layout:b},y)});function Zm(e){"@babel/helpers - typeof";return Zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zm(e)}function w$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cK(n.key),n)}}function S$e(e,t,r){return t&&YF(e.prototype,t),r&&YF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function E$e(e,t,r){return t=FS(t),T$e(e,sK()?Reflect.construct(t,r||[],FS(e).constructor):t.apply(e,r))}function T$e(e,t){if(t&&(Zm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j$e(e)}function j$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sK=function(){return!!e})()}function FS(e){return FS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},FS(e)}function C$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lN(e,t)}function lN(e,t){return lN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lN(e,t)}function lK(e,t,r){return t=cK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cK(e){var t=P$e(e,"string");return Zm(t)=="symbol"?t:t+""}function P$e(e,t){if(Zm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cN(){return cN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cN.apply(this,arguments)}function A$e(e){var t=e.xAxisId,r=OO(),n=DO(),o=HZ(t);return o==null?null:je.createElement(kg,cN({},o,{className:Zr("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(h){return xc(h,!0)}}))}var t0=function(e){function t(){return w$e(this,t),E$e(this,t,arguments)}return C$e(t,e),S$e(t,[{key:"render",value:function(){return je.createElement(A$e,this.props)}}])}(je.Component);lK(t0,"displayName","XAxis");lK(t0,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Km(e){"@babel/helpers - typeof";return Km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Km(e)}function k$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hK(n.key),n)}}function N$e(e,t,r){return t&&JF(e.prototype,t),r&&JF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function M$e(e,t,r){return t=US(t),I$e(e,uK()?Reflect.construct(t,r||[],US(e).constructor):t.apply(e,r))}function I$e(e,t){if(t&&(Km(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O$e(e)}function O$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uK=function(){return!!e})()}function US(e){return US=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},US(e)}function D$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uN(e,t)}function uN(e,t){return uN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uN(e,t)}function dK(e,t,r){return t=hK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hK(e){var t=R$e(e,"string");return Km(t)=="symbol"?t:t+""}function R$e(e,t){if(Km(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Km(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dN(){return dN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dN.apply(this,arguments)}var L$e=function(t){var r=t.yAxisId,n=OO(),o=DO(),s=XZ(r);return s==null?null:je.createElement(kg,dN({},s,{className:Zr("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:n,height:o},ticksGenerator:function(i){return xc(i,!0)}}))},mf=function(e){function t(){return k$e(this,t),M$e(this,t,arguments)}return D$e(t,e),N$e(t,[{key:"render",value:function(){return je.createElement(L$e,this.props)}}])}(je.Component);dK(mf,"displayName","YAxis");dK(mf,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function QF(e){return F$e(e)||$$e(e)||z$e(e)||B$e()}function B$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z$e(e,t){if(e){if(typeof e=="string")return hN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hN(e,t)}}function $$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function F$e(e){if(Array.isArray(e))return hN(e)}function hN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var fN=function(t,r,n,o,s){var h=rs(t,LO),i=rs(t,ME),p=[].concat(QF(h),QF(i)),y=rs(t,OE),b="".concat(o,"Id"),_=o[0],E=r;if(p.length&&(E=p.reduce(function(N,I){if(I.props[b]===n&&Nl(I.props,"extendDomain")&&Ft(I.props[_])){var B=I.props[_];return[Math.min(N[0],B),Math.max(N[1],B)]}return N},E)),y.length){var C="".concat(_,"1"),k="".concat(_,"2");E=y.reduce(function(N,I){if(I.props[b]===n&&Nl(I.props,"extendDomain")&&Ft(I.props[C])&&Ft(I.props[k])){var B=I.props[C],O=I.props[k];return[Math.min(N[0],B,O),Math.max(N[1],B,O)]}return N},E)}return s&&s.length&&(E=s.reduce(function(N,I){return Ft(I)?[Math.min(N[0],I),Math.max(N[1],I)]:N},E)),E},fK={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function o(p,y,b){this.fn=p,this.context=y,this.once=b||!1}function s(p,y,b,_,E){if(typeof b!="function")throw new TypeError("The listener must be a function");var C=new o(b,_||p,E),k=r?r+y:y;return p._events[k]?p._events[k].fn?p._events[k]=[p._events[k],C]:p._events[k].push(C):(p._events[k]=C,p._eventsCount++),p}function h(p,y){--p._eventsCount===0?p._events=new n:delete p._events[y]}function i(){this._events=new n,this._eventsCount=0}i.prototype.eventNames=function(){var y=[],b,_;if(this._eventsCount===0)return y;for(_ in b=this._events)t.call(b,_)&&y.push(r?_.slice(1):_);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(b)):y},i.prototype.listeners=function(y){var b=r?r+y:y,_=this._events[b];if(!_)return[];if(_.fn)return[_.fn];for(var E=0,C=_.length,k=new Array(C);E<C;E++)k[E]=_[E].fn;return k},i.prototype.listenerCount=function(y){var b=r?r+y:y,_=this._events[b];return _?_.fn?1:_.length:0},i.prototype.emit=function(y,b,_,E,C,k){var N=r?r+y:y;if(!this._events[N])return!1;var I=this._events[N],B=arguments.length,O,R;if(I.fn){switch(I.once&&this.removeListener(y,I.fn,void 0,!0),B){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,b),!0;case 3:return I.fn.call(I.context,b,_),!0;case 4:return I.fn.call(I.context,b,_,E),!0;case 5:return I.fn.call(I.context,b,_,E,C),!0;case 6:return I.fn.call(I.context,b,_,E,C,k),!0}for(R=1,O=new Array(B-1);R<B;R++)O[R-1]=arguments[R];I.fn.apply(I.context,O)}else{var q=I.length,F;for(R=0;R<q;R++)switch(I[R].once&&this.removeListener(y,I[R].fn,void 0,!0),B){case 1:I[R].fn.call(I[R].context);break;case 2:I[R].fn.call(I[R].context,b);break;case 3:I[R].fn.call(I[R].context,b,_);break;case 4:I[R].fn.call(I[R].context,b,_,E);break;default:if(!O)for(F=1,O=new Array(B-1);F<B;F++)O[F-1]=arguments[F];I[R].fn.apply(I[R].context,O)}}return!0},i.prototype.on=function(y,b,_){return s(this,y,b,_,!1)},i.prototype.once=function(y,b,_){return s(this,y,b,_,!0)},i.prototype.removeListener=function(y,b,_,E){var C=r?r+y:y;if(!this._events[C])return this;if(!b)return h(this,C),this;var k=this._events[C];if(k.fn)k.fn===b&&(!E||k.once)&&(!_||k.context===_)&&h(this,C);else{for(var N=0,I=[],B=k.length;N<B;N++)(k[N].fn!==b||E&&!k[N].once||_&&k[N].context!==_)&&I.push(k[N]);I.length?this._events[C]=I.length===1?I[0]:I:h(this,C)}return this},i.prototype.removeAllListeners=function(y){var b;return y?(b=r?r+y:y,this._events[b]&&h(this,b)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=r,i.EventEmitter=i,e.exports=i})(fK);var U$e=fK.exports;const V$e=wn(U$e);var eP=new V$e,tP="recharts.syncMouseEvents";function Sb(e){"@babel/helpers - typeof";return Sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sb(e)}function q$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pK(n.key),n)}}function W$e(e,t,r){return t&&eU(e.prototype,t),r&&eU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rP(e,t,r){return t=pK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pK(e){var t=G$e(e,"string");return Sb(t)=="symbol"?t:t+""}function G$e(e,t){if(Sb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H$e=function(){function e(){q$e(this,e),rP(this,"activeIndex",0),rP(this,"coordinateList",[]),rP(this,"layout","horizontal")}return W$e(e,[{key:"setDetails",value:function(r){var n,o=r.coordinateList,s=o===void 0?null:o,h=r.container,i=h===void 0?null:h,p=r.layout,y=p===void 0?null:p,b=r.offset,_=b===void 0?null:b,E=r.mouseHandlerCallback,C=E===void 0?null:E;this.coordinateList=(n=s??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=y??this.layout,this.offset=_??this.offset,this.mouseHandlerCallback=C??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var o=this.container.getBoundingClientRect(),s=o.x,h=o.y,i=o.height,p=this.coordinateList[this.activeIndex].coordinate,y=((r=window)===null||r===void 0?void 0:r.scrollX)||0,b=((n=window)===null||n===void 0?void 0:n.scrollY)||0,_=s+p+y,E=h+this.offset.top+i/2+b;this.mouseHandlerCallback({pageX:_,pageY:E})}}}])}();function X$e(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],o=e==null?void 0:e[1];if(n&&o&&Ft(n)&&Ft(o))return!0}return!1}function Z$e(e,t,r,n){var o=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-o:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-o,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function mK(e){var t=e.cx,r=e.cy,n=e.radius,o=e.startAngle,s=e.endAngle,h=io(t,r,n,o),i=io(t,r,n,s);return{points:[h,i],cx:t,cy:r,radius:n,startAngle:o,endAngle:s}}function K$e(e,t,r){var n,o,s,h;if(e==="horizontal")n=t.x,s=n,o=r.top,h=r.top+r.height;else if(e==="vertical")o=t.y,h=o,n=r.left,s=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,p=t.cy,y=t.innerRadius,b=t.outerRadius,_=t.angle,E=io(i,p,y,_),C=io(i,p,b,_);n=E.x,o=E.y,s=C.x,h=C.y}else return mK(t);return[{x:n,y:o},{x:s,y:h}]}function Eb(e){"@babel/helpers - typeof";return Eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eb(e)}function tU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ww(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tU(Object(r),!0).forEach(function(n){Y$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y$e(e,t,r){return t=J$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J$e(e){var t=Q$e(e,"string");return Eb(t)=="symbol"?t:t+""}function Q$e(e,t){if(Eb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e5e(e){var t,r,n=e.element,o=e.tooltipEventType,s=e.isActive,h=e.activeCoordinate,i=e.activePayload,p=e.offset,y=e.activeTooltipIndex,b=e.tooltipAxisBandSize,_=e.layout,E=e.chartName,C=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!C||!s||!h||E!=="ScatterChart"&&o!=="axis")return null;var k,N=Bk;if(E==="ScatterChart")k=h,N=o3e;else if(E==="BarChart")k=Z$e(_,h,p,b),N=AO;else if(_==="radial"){var I=mK(h),B=I.cx,O=I.cy,R=I.radius,q=I.startAngle,F=I.endAngle;k={cx:B,cy:O,startAngle:q,endAngle:F,innerRadius:R,outerRadius:R},N=xZ}else k={points:K$e(_,h,p)},N=Bk;var X=ww(ww(ww(ww({stroke:"#ccc",pointerEvents:"none"},p),k),Xr(C,!1)),{},{payload:i,payloadIndex:y,className:Zr("recharts-tooltip-cursor",C.className)});return D.isValidElement(C)?D.cloneElement(C,X):D.createElement(N,X)}var t5e=["item"],r5e=["children","className","width","height","style","compact","title","desc"];function Ym(e){"@babel/helpers - typeof";return Ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ym(e)}function om(){return om=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},om.apply(this,arguments)}function rU(e,t){return o5e(e)||i5e(e,t)||yK(e,t)||n5e()}function n5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,h,i=[],p=!0,y=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);p=!0);}catch(b){y=!0,o=b}finally{try{if(!p&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return i}}function o5e(e){if(Array.isArray(e))return e}function nU(e,t){if(e==null)return{};var r=a5e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function a5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function s5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vK(n.key),n)}}function l5e(e,t,r){return t&&iU(e.prototype,t),r&&iU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c5e(e,t,r){return t=VS(t),u5e(e,gK()?Reflect.construct(t,r||[],VS(e).constructor):t.apply(e,r))}function u5e(e,t){if(t&&(Ym(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d5e(e)}function d5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gK=function(){return!!e})()}function VS(e){return VS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},VS(e)}function h5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pN(e,t)}function pN(e,t){return pN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pN(e,t)}function Jm(e){return m5e(e)||p5e(e)||yK(e)||f5e()}function f5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yK(e,t){if(e){if(typeof e=="string")return mN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mN(e,t)}}function p5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function m5e(e){if(Array.isArray(e))return mN(e)}function mN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function gt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oU(Object(r),!0).forEach(function(n){vr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vr(e,t,r){return t=vK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vK(e){var t=g5e(e,"string");return Ym(t)=="symbol"?t:t+""}function g5e(e,t){if(Ym(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ym(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y5e={xAxis:["bottom","top"],yAxis:["left","right"]},v5e={width:"100%",height:"100%"},xK={x:0,y:0};function Sw(e){return e}var x5e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},b5e=function(t,r,n,o){var s=r.find(function(b){return b&&b.index===n});if(s){if(t==="horizontal")return{x:s.coordinate,y:o.y};if(t==="vertical")return{x:o.x,y:s.coordinate};if(t==="centric"){var h=s.coordinate,i=o.radius;return gt(gt(gt({},o),io(o.cx,o.cy,i,h)),{},{angle:h,radius:i})}var p=s.coordinate,y=o.angle;return gt(gt(gt({},o),io(o.cx,o.cy,p,y)),{},{angle:y,radius:p})}return xK},DE=function(t,r){var n=r.graphicalItems,o=r.dataStartIndex,s=r.dataEndIndex,h=(n??[]).reduce(function(i,p){var y=p.props.data;return y&&y.length?[].concat(Jm(i),Jm(y)):i},[]);return h.length>0?h:t&&t.length&&Ft(o)&&Ft(s)?t.slice(o,s+1):[]};function bK(e){return e==="number"?[0,"auto"]:void 0}var gN=function(t,r,n,o){var s=t.graphicalItems,h=t.tooltipAxis,i=DE(r,t);return n<0||!s||!s.length||n>=i.length?null:s.reduce(function(p,y){var b,_=(b=y.props.data)!==null&&b!==void 0?b:r;_&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(_=_.slice(t.dataStartIndex,t.dataEndIndex+1));var E;if(h.dataKey&&!h.allowDuplicatedCategory){var C=_===void 0?i:_;E=W1(C,h.dataKey,o)}else E=_&&_[n]||i[n];return E?[].concat(Jm(p),[gZ(y,E)]):p},[])},aU=function(t,r,n,o){var s=o||{x:t.chartX,y:t.chartY},h=x5e(s,n),i=t.orderedTooltipTicks,p=t.tooltipAxis,y=t.tooltipTicks,b=UOe(h,i,y,p);if(b>=0&&y){var _=y[b]&&y[b].value,E=gN(t,r,b,_),C=b5e(n,i,b,s);return{activeTooltipIndex:b,activeLabel:_,activePayload:E,activeCoordinate:C}}return null},_5e=function(t,r){var n=r.axes,o=r.graphicalItems,s=r.axisType,h=r.axisIdKey,i=r.stackGroups,p=r.dataStartIndex,y=r.dataEndIndex,b=t.layout,_=t.children,E=t.stackOffset,C=fZ(b,s);return n.reduce(function(k,N){var I,B=N.type.defaultProps!==void 0?gt(gt({},N.type.defaultProps),N.props):N.props,O=B.type,R=B.dataKey,q=B.allowDataOverflow,F=B.allowDuplicatedCategory,X=B.scale,G=B.ticks,ee=B.includeHidden,K=B[h];if(k[K])return k;var ie=DE(t.data,{graphicalItems:o.filter(function(Fe){var Ge,Pt=h in Fe.props?Fe.props[h]:(Ge=Fe.type.defaultProps)===null||Ge===void 0?void 0:Ge[h];return Pt===K}),dataStartIndex:p,dataEndIndex:y}),pe=ie.length,ae,_e,Ee;X$e(B.domain,q,O)&&(ae=Ik(B.domain,null,q),C&&(O==="number"||X!=="auto")&&(Ee=fx(ie,R,"category")));var xe=bK(O);if(!ae||ae.length===0){var ce,ke=(ce=B.domain)!==null&&ce!==void 0?ce:xe;if(R){if(ae=fx(ie,R,O),O==="category"&&C){var ve=M_e(ae);F&&ve?(_e=ae,ae=kS(0,pe)):F||(ae=k5(ke,ae,N).reduce(function(Fe,Ge){return Fe.indexOf(Ge)>=0?Fe:[].concat(Jm(Fe),[Ge])},[]))}else if(O==="category")F?ae=ae.filter(function(Fe){return Fe!==""&&!Wr(Fe)}):ae=k5(ke,ae,N).reduce(function(Fe,Ge){return Fe.indexOf(Ge)>=0||Ge===""||Wr(Ge)?Fe:[].concat(Jm(Fe),[Ge])},[]);else if(O==="number"){var Pe=HOe(ie,o.filter(function(Fe){var Ge,Pt,$t=h in Fe.props?Fe.props[h]:(Ge=Fe.type.defaultProps)===null||Ge===void 0?void 0:Ge[h],nr="hide"in Fe.props?Fe.props.hide:(Pt=Fe.type.defaultProps)===null||Pt===void 0?void 0:Pt.hide;return $t===K&&(ee||!nr)}),R,s,b);Pe&&(ae=Pe)}C&&(O==="number"||X!=="auto")&&(Ee=fx(ie,R,"category"))}else C?ae=kS(0,pe):i&&i[K]&&i[K].hasStack&&O==="number"?ae=E==="expand"?[0,1]:mZ(i[K].stackGroups,p,y):ae=hZ(ie,o.filter(function(Fe){var Ge=h in Fe.props?Fe.props[h]:Fe.type.defaultProps[h],Pt="hide"in Fe.props?Fe.props.hide:Fe.type.defaultProps.hide;return Ge===K&&(ee||!Pt)}),O,b,!0);if(O==="number")ae=fN(_,ae,K,s,G),ke&&(ae=Ik(ke,ae,q));else if(O==="category"&&ke){var Re=ke,Be=ae.every(function(Fe){return Re.indexOf(Fe)>=0});Be&&(ae=Re)}}return gt(gt({},k),{},vr({},K,gt(gt({},B),{},{axisType:s,domain:ae,categoricalDomain:Ee,duplicateDomain:_e,originalDomain:(I=B.domain)!==null&&I!==void 0?I:xe,isCategorical:C,layout:b})))},{})},w5e=function(t,r){var n=r.graphicalItems,o=r.Axis,s=r.axisType,h=r.axisIdKey,i=r.stackGroups,p=r.dataStartIndex,y=r.dataEndIndex,b=t.layout,_=t.children,E=DE(t.data,{graphicalItems:n,dataStartIndex:p,dataEndIndex:y}),C=E.length,k=fZ(b,s),N=-1;return n.reduce(function(I,B){var O=B.type.defaultProps!==void 0?gt(gt({},B.type.defaultProps),B.props):B.props,R=O[h],q=bK("number");if(!I[R]){N++;var F;return k?F=kS(0,C):i&&i[R]&&i[R].hasStack?(F=mZ(i[R].stackGroups,p,y),F=fN(_,F,R,s)):(F=Ik(q,hZ(E,n.filter(function(X){var G,ee,K=h in X.props?X.props[h]:(G=X.type.defaultProps)===null||G===void 0?void 0:G[h],ie="hide"in X.props?X.props.hide:(ee=X.type.defaultProps)===null||ee===void 0?void 0:ee.hide;return K===R&&!ie}),"number",b),o.defaultProps.allowDataOverflow),F=fN(_,F,R,s)),gt(gt({},I),{},vr({},R,gt(gt({axisType:s},o.defaultProps),{},{hide:!0,orientation:ts(y5e,"".concat(s,".").concat(N%2),null),domain:F,originalDomain:q,isCategorical:k,layout:b})))}return I},{})},S5e=function(t,r){var n=r.axisType,o=n===void 0?"xAxis":n,s=r.AxisComp,h=r.graphicalItems,i=r.stackGroups,p=r.dataStartIndex,y=r.dataEndIndex,b=t.children,_="".concat(o,"Id"),E=rs(b,s),C={};return E&&E.length?C=_5e(t,{axes:E,graphicalItems:h,axisType:o,axisIdKey:_,stackGroups:i,dataStartIndex:p,dataEndIndex:y}):h&&h.length&&(C=w5e(t,{Axis:s,graphicalItems:h,axisType:o,axisIdKey:_,stackGroups:i,dataStartIndex:p,dataEndIndex:y})),C},E5e=function(t){var r=Wu(t),n=xc(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:rO(n,function(o){return o.coordinate}),tooltipAxis:r,tooltipAxisBandSize:_S(r,n)}},sU=function(t){var r=t.children,n=t.defaultShowTooltip,o=_a(r,Um),s=0,h=0;return t.data&&t.data.length!==0&&(h=t.data.length-1),o&&o.props&&(o.props.startIndex>=0&&(s=o.props.startIndex),o.props.endIndex>=0&&(h=o.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:s,dataEndIndex:h,activeTooltipIndex:-1,isTooltipActive:!!n}},T5e=function(t){return!t||!t.length?!1:t.some(function(r){var n=Sc(r&&r.type);return n&&n.indexOf("Bar")>=0})},lU=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},j5e=function(t,r){var n=t.props,o=t.graphicalItems,s=t.xAxisMap,h=s===void 0?{}:s,i=t.yAxisMap,p=i===void 0?{}:i,y=n.width,b=n.height,_=n.children,E=n.margin||{},C=_a(_,Um),k=_a(_,mm),N=Object.keys(p).reduce(function(F,X){var G=p[X],ee=G.orientation;return!G.mirror&&!G.hide?gt(gt({},F),{},vr({},ee,F[ee]+G.width)):F},{left:E.left||0,right:E.right||0}),I=Object.keys(h).reduce(function(F,X){var G=h[X],ee=G.orientation;return!G.mirror&&!G.hide?gt(gt({},F),{},vr({},ee,ts(F,"".concat(ee))+G.height)):F},{top:E.top||0,bottom:E.bottom||0}),B=gt(gt({},I),N),O=B.bottom;C&&(B.bottom+=C.props.height||Um.defaultProps.height),k&&r&&(B=WOe(B,o,n,r));var R=y-B.left-B.right,q=b-B.top-B.bottom;return gt(gt({brushBottom:O},B),{},{width:Math.max(R,0),height:Math.max(q,0)})},C5e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},P5e=function(t){var r=t.chartName,n=t.GraphicalChild,o=t.defaultTooltipEventType,s=o===void 0?"axis":o,h=t.validateTooltipEventTypes,i=h===void 0?["axis"]:h,p=t.axisComponents,y=t.legendContent,b=t.formatAxisMap,_=t.defaultProps,E=function(B,O){var R=O.graphicalItems,q=O.stackGroups,F=O.offset,X=O.updateId,G=O.dataStartIndex,ee=O.dataEndIndex,K=B.barSize,ie=B.layout,pe=B.barGap,ae=B.barCategoryGap,_e=B.maxBarSize,Ee=lU(ie),xe=Ee.numericAxisName,ce=Ee.cateAxisName,ke=T5e(R),ve=[];return R.forEach(function(Pe,Re){var Be=DE(B.data,{graphicalItems:[Pe],dataStartIndex:G,dataEndIndex:ee}),Fe=Pe.type.defaultProps!==void 0?gt(gt({},Pe.type.defaultProps),Pe.props):Pe.props,Ge=Fe.dataKey,Pt=Fe.maxBarSize,$t=Fe["".concat(xe,"Id")],nr=Fe["".concat(ce,"Id")],Nt={},Jt=p.reduce(function(ki,Hn){var lo=O["".concat(Hn.axisType,"Map")],cs=Fe["".concat(Hn.axisType,"Id")];lo&&lo[cs]||Hn.axisType==="zAxis"||ff(!1);var Ll=lo[cs];return gt(gt({},ki),{},vr(vr({},Hn.axisType,Ll),"".concat(Hn.axisType,"Ticks"),xc(Ll)))},Nt),ft=Jt[ce],vt=Jt["".concat(ce,"Ticks")],lt=q&&q[$t]&&q[$t].hasStack&&oDe(Pe,q[$t].stackGroups),it=Sc(Pe.type).indexOf("Bar")>=0,ar=_S(ft,vt),We=[],pt=ke&&VOe({barSize:K,stackGroups:q,totalSize:C5e(Jt,ce)});if(it){var Wt,cr,Gr=Wr(Pt)?_e:Pt,ln=(Wt=(cr=_S(ft,vt,!0))!==null&&cr!==void 0?cr:Gr)!==null&&Wt!==void 0?Wt:0;We=qOe({barGap:pe,barCategoryGap:ae,bandSize:ln!==ar?ln:ar,sizeList:pt[nr],maxBarSize:Gr}),ln!==ar&&(We=We.map(function(ki){return gt(gt({},ki),{},{position:gt(gt({},ki.position),{},{offset:ki.position.offset-ln/2})})}))}var si=Pe&&Pe.type&&Pe.type.getComposedData;si&&ve.push({props:gt(gt({},si(gt(gt({},Jt),{},{displayedData:Be,props:B,dataKey:Ge,item:Pe,bandSize:ar,barPosition:We,offset:F,stackedData:lt,layout:ie,dataStartIndex:G,dataEndIndex:ee}))),{},vr(vr(vr({key:Pe.key||"item-".concat(Re)},xe,Jt[xe]),ce,Jt[ce]),"animationId",X)),childIndex:W_e(Pe,B.children),item:Pe})}),ve},C=function(B,O){var R=B.props,q=B.dataStartIndex,F=B.dataEndIndex,X=B.updateId;if(!xz({props:R}))return null;var G=R.children,ee=R.layout,K=R.stackOffset,ie=R.data,pe=R.reverseStackOrder,ae=lU(ee),_e=ae.numericAxisName,Ee=ae.cateAxisName,xe=rs(G,n),ce=rDe(ie,xe,"".concat(_e,"Id"),"".concat(Ee,"Id"),K,pe),ke=p.reduce(function(Fe,Ge){var Pt="".concat(Ge.axisType,"Map");return gt(gt({},Fe),{},vr({},Pt,S5e(R,gt(gt({},Ge),{},{graphicalItems:xe,stackGroups:Ge.axisType===_e&&ce,dataStartIndex:q,dataEndIndex:F}))))},{}),ve=j5e(gt(gt({},ke),{},{props:R,graphicalItems:xe}),O==null?void 0:O.legendBBox);Object.keys(ke).forEach(function(Fe){ke[Fe]=b(R,ke[Fe],ve,Fe.replace("Map",""),r)});var Pe=ke["".concat(Ee,"Map")],Re=E5e(Pe),Be=E(R,gt(gt({},ke),{},{dataStartIndex:q,dataEndIndex:F,updateId:X,graphicalItems:xe,stackGroups:ce,offset:ve}));return gt(gt({formattedGraphicalItems:Be,graphicalItems:xe,offset:ve,stackGroups:ce},Re),ke)},k=function(I){function B(O){var R,q,F;return s5e(this,B),F=c5e(this,B,[O]),vr(F,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),vr(F,"accessibilityManager",new H$e),vr(F,"handleLegendBBoxUpdate",function(X){if(X){var G=F.state,ee=G.dataStartIndex,K=G.dataEndIndex,ie=G.updateId;F.setState(gt({legendBBox:X},C({props:F.props,dataStartIndex:ee,dataEndIndex:K,updateId:ie},gt(gt({},F.state),{},{legendBBox:X}))))}}),vr(F,"handleReceiveSyncEvent",function(X,G,ee){if(F.props.syncId===X){if(ee===F.eventEmitterSymbol&&typeof F.props.syncMethod!="function")return;F.applySyncEvent(G)}}),vr(F,"handleBrushChange",function(X){var G=X.startIndex,ee=X.endIndex;if(G!==F.state.dataStartIndex||ee!==F.state.dataEndIndex){var K=F.state.updateId;F.setState(function(){return gt({dataStartIndex:G,dataEndIndex:ee},C({props:F.props,dataStartIndex:G,dataEndIndex:ee,updateId:K},F.state))}),F.triggerSyncEvent({dataStartIndex:G,dataEndIndex:ee})}}),vr(F,"handleMouseEnter",function(X){var G=F.getMouseInfo(X);if(G){var ee=gt(gt({},G),{},{isTooltipActive:!0});F.setState(ee),F.triggerSyncEvent(ee);var K=F.props.onMouseEnter;Nr(K)&&K(ee,X)}}),vr(F,"triggeredAfterMouseMove",function(X){var G=F.getMouseInfo(X),ee=G?gt(gt({},G),{},{isTooltipActive:!0}):{isTooltipActive:!1};F.setState(ee),F.triggerSyncEvent(ee);var K=F.props.onMouseMove;Nr(K)&&K(ee,X)}),vr(F,"handleItemMouseEnter",function(X){F.setState(function(){return{isTooltipActive:!0,activeItem:X,activePayload:X.tooltipPayload,activeCoordinate:X.tooltipPosition||{x:X.cx,y:X.cy}}})}),vr(F,"handleItemMouseLeave",function(){F.setState(function(){return{isTooltipActive:!1}})}),vr(F,"handleMouseMove",function(X){X.persist(),F.throttleTriggeredAfterMouseMove(X)}),vr(F,"handleMouseLeave",function(X){F.throttleTriggeredAfterMouseMove.cancel();var G={isTooltipActive:!1};F.setState(G),F.triggerSyncEvent(G);var ee=F.props.onMouseLeave;Nr(ee)&&ee(G,X)}),vr(F,"handleOuterEvent",function(X){var G=q_e(X),ee=ts(F.props,"".concat(G));if(G&&Nr(ee)){var K,ie;/.*touch.*/i.test(G)?ie=F.getMouseInfo(X.changedTouches[0]):ie=F.getMouseInfo(X),ee((K=ie)!==null&&K!==void 0?K:{},X)}}),vr(F,"handleClick",function(X){var G=F.getMouseInfo(X);if(G){var ee=gt(gt({},G),{},{isTooltipActive:!0});F.setState(ee),F.triggerSyncEvent(ee);var K=F.props.onClick;Nr(K)&&K(ee,X)}}),vr(F,"handleMouseDown",function(X){var G=F.props.onMouseDown;if(Nr(G)){var ee=F.getMouseInfo(X);G(ee,X)}}),vr(F,"handleMouseUp",function(X){var G=F.props.onMouseUp;if(Nr(G)){var ee=F.getMouseInfo(X);G(ee,X)}}),vr(F,"handleTouchMove",function(X){X.changedTouches!=null&&X.changedTouches.length>0&&F.throttleTriggeredAfterMouseMove(X.changedTouches[0])}),vr(F,"handleTouchStart",function(X){X.changedTouches!=null&&X.changedTouches.length>0&&F.handleMouseDown(X.changedTouches[0])}),vr(F,"handleTouchEnd",function(X){X.changedTouches!=null&&X.changedTouches.length>0&&F.handleMouseUp(X.changedTouches[0])}),vr(F,"handleDoubleClick",function(X){var G=F.props.onDoubleClick;if(Nr(G)){var ee=F.getMouseInfo(X);G(ee,X)}}),vr(F,"handleContextMenu",function(X){var G=F.props.onContextMenu;if(Nr(G)){var ee=F.getMouseInfo(X);G(ee,X)}}),vr(F,"triggerSyncEvent",function(X){F.props.syncId!==void 0&&eP.emit(tP,F.props.syncId,X,F.eventEmitterSymbol)}),vr(F,"applySyncEvent",function(X){var G=F.props,ee=G.layout,K=G.syncMethod,ie=F.state.updateId,pe=X.dataStartIndex,ae=X.dataEndIndex;if(X.dataStartIndex!==void 0||X.dataEndIndex!==void 0)F.setState(gt({dataStartIndex:pe,dataEndIndex:ae},C({props:F.props,dataStartIndex:pe,dataEndIndex:ae,updateId:ie},F.state)));else if(X.activeTooltipIndex!==void 0){var _e=X.chartX,Ee=X.chartY,xe=X.activeTooltipIndex,ce=F.state,ke=ce.offset,ve=ce.tooltipTicks;if(!ke)return;if(typeof K=="function")xe=K(ve,X);else if(K==="value"){xe=-1;for(var Pe=0;Pe<ve.length;Pe++)if(ve[Pe].value===X.activeLabel){xe=Pe;break}}var Re=gt(gt({},ke),{},{x:ke.left,y:ke.top}),Be=Math.min(_e,Re.x+Re.width),Fe=Math.min(Ee,Re.y+Re.height),Ge=ve[xe]&&ve[xe].value,Pt=gN(F.state,F.props.data,xe),$t=ve[xe]?{x:ee==="horizontal"?ve[xe].coordinate:Be,y:ee==="horizontal"?Fe:ve[xe].coordinate}:xK;F.setState(gt(gt({},X),{},{activeLabel:Ge,activeCoordinate:$t,activePayload:Pt,activeTooltipIndex:xe}))}else F.setState(X)}),vr(F,"renderCursor",function(X){var G,ee=F.state,K=ee.isTooltipActive,ie=ee.activeCoordinate,pe=ee.activePayload,ae=ee.offset,_e=ee.activeTooltipIndex,Ee=ee.tooltipAxisBandSize,xe=F.getTooltipEventType(),ce=(G=X.props.active)!==null&&G!==void 0?G:K,ke=F.props.layout,ve=X.key||"_recharts-cursor";return je.createElement(e5e,{key:ve,activeCoordinate:ie,activePayload:pe,activeTooltipIndex:_e,chartName:r,element:X,isActive:ce,layout:ke,offset:ae,tooltipAxisBandSize:Ee,tooltipEventType:xe})}),vr(F,"renderPolarAxis",function(X,G,ee){var K=ts(X,"type.axisType"),ie=ts(F.state,"".concat(K,"Map")),pe=X.type.defaultProps,ae=pe!==void 0?gt(gt({},pe),X.props):X.props,_e=ie&&ie[ae["".concat(K,"Id")]];return D.cloneElement(X,gt(gt({},_e),{},{className:Zr(K,_e.className),key:X.key||"".concat(G,"-").concat(ee),ticks:xc(_e,!0)}))}),vr(F,"renderPolarGrid",function(X){var G=X.props,ee=G.radialLines,K=G.polarAngles,ie=G.polarRadius,pe=F.state,ae=pe.radiusAxisMap,_e=pe.angleAxisMap,Ee=Wu(ae),xe=Wu(_e),ce=xe.cx,ke=xe.cy,ve=xe.innerRadius,Pe=xe.outerRadius;return D.cloneElement(X,{polarAngles:Array.isArray(K)?K:xc(xe,!0).map(function(Re){return Re.coordinate}),polarRadius:Array.isArray(ie)?ie:xc(Ee,!0).map(function(Re){return Re.coordinate}),cx:ce,cy:ke,innerRadius:ve,outerRadius:Pe,key:X.key||"polar-grid",radialLines:ee})}),vr(F,"renderLegend",function(){var X=F.state.formattedGraphicalItems,G=F.props,ee=G.children,K=G.width,ie=G.height,pe=F.props.margin||{},ae=K-(pe.left||0)-(pe.right||0),_e=uZ({children:ee,formattedGraphicalItems:X,legendWidth:ae,legendContent:y});if(!_e)return null;var Ee=_e.item,xe=nU(_e,t5e);return D.cloneElement(Ee,gt(gt({},xe),{},{chartWidth:K,chartHeight:ie,margin:pe,onBBoxUpdate:F.handleLegendBBoxUpdate}))}),vr(F,"renderTooltip",function(){var X,G=F.props,ee=G.children,K=G.accessibilityLayer,ie=_a(ee,Bs);if(!ie)return null;var pe=F.state,ae=pe.isTooltipActive,_e=pe.activeCoordinate,Ee=pe.activePayload,xe=pe.activeLabel,ce=pe.offset,ke=(X=ie.props.active)!==null&&X!==void 0?X:ae;return D.cloneElement(ie,{viewBox:gt(gt({},ce),{},{x:ce.left,y:ce.top}),active:ke,label:xe,payload:ke?Ee:[],coordinate:_e,accessibilityLayer:K})}),vr(F,"renderBrush",function(X){var G=F.props,ee=G.margin,K=G.data,ie=F.state,pe=ie.offset,ae=ie.dataStartIndex,_e=ie.dataEndIndex,Ee=ie.updateId;return D.cloneElement(X,{key:X.key||"_recharts-brush",onChange:vw(F.handleBrushChange,X.props.onChange),data:K,x:Ft(X.props.x)?X.props.x:pe.left,y:Ft(X.props.y)?X.props.y:pe.top+pe.height+pe.brushBottom-(ee.bottom||0),width:Ft(X.props.width)?X.props.width:pe.width,startIndex:ae,endIndex:_e,updateId:"brush-".concat(Ee)})}),vr(F,"renderReferenceElement",function(X,G,ee){if(!X)return null;var K=F,ie=K.clipPathId,pe=F.state,ae=pe.xAxisMap,_e=pe.yAxisMap,Ee=pe.offset,xe=X.type.defaultProps||{},ce=X.props,ke=ce.xAxisId,ve=ke===void 0?xe.xAxisId:ke,Pe=ce.yAxisId,Re=Pe===void 0?xe.yAxisId:Pe;return D.cloneElement(X,{key:X.key||"".concat(G,"-").concat(ee),xAxis:ae[ve],yAxis:_e[Re],viewBox:{x:Ee.left,y:Ee.top,width:Ee.width,height:Ee.height},clipPathId:ie})}),vr(F,"renderActivePoints",function(X){var G=X.item,ee=X.activePoint,K=X.basePoint,ie=X.childIndex,pe=X.isRange,ae=[],_e=G.props.key,Ee=G.item.type.defaultProps!==void 0?gt(gt({},G.item.type.defaultProps),G.item.props):G.item.props,xe=Ee.activeDot,ce=Ee.dataKey,ke=gt(gt({index:ie,dataKey:ce,cx:ee.x,cy:ee.y,r:4,fill:PO(G.item),strokeWidth:2,stroke:"#fff",payload:ee.payload,value:ee.value},Xr(xe,!1)),G1(xe));return ae.push(B.renderActiveDot(xe,ke,"".concat(_e,"-activePoint-").concat(ie))),K?ae.push(B.renderActiveDot(xe,gt(gt({},ke),{},{cx:K.x,cy:K.y}),"".concat(_e,"-basePoint-").concat(ie))):pe&&ae.push(null),ae}),vr(F,"renderGraphicChild",function(X,G,ee){var K=F.filterFormatItem(X,G,ee);if(!K)return null;var ie=F.getTooltipEventType(),pe=F.state,ae=pe.isTooltipActive,_e=pe.tooltipAxis,Ee=pe.activeTooltipIndex,xe=pe.activeLabel,ce=F.props.children,ke=_a(ce,Bs),ve=K.props,Pe=ve.points,Re=ve.isRange,Be=ve.baseLine,Fe=K.item.type.defaultProps!==void 0?gt(gt({},K.item.type.defaultProps),K.item.props):K.item.props,Ge=Fe.activeDot,Pt=Fe.hide,$t=Fe.activeBar,nr=Fe.activeShape,Nt=!!(!Pt&&ae&&ke&&(Ge||$t||nr)),Jt={};ie!=="axis"&&ke&&ke.props.trigger==="click"?Jt={onClick:vw(F.handleItemMouseEnter,X.props.onClick)}:ie!=="axis"&&(Jt={onMouseLeave:vw(F.handleItemMouseLeave,X.props.onMouseLeave),onMouseEnter:vw(F.handleItemMouseEnter,X.props.onMouseEnter)});var ft=D.cloneElement(X,gt(gt({},K.props),Jt));function vt(Hn){return typeof _e.dataKey=="function"?_e.dataKey(Hn.payload):null}if(Nt)if(Ee>=0){var lt,it;if(_e.dataKey&&!_e.allowDuplicatedCategory){var ar=typeof _e.dataKey=="function"?vt:"payload.".concat(_e.dataKey.toString());lt=W1(Pe,ar,xe),it=Re&&Be&&W1(Be,ar,xe)}else lt=Pe==null?void 0:Pe[Ee],it=Re&&Be&&Be[Ee];if(nr||$t){var We=X.props.activeIndex!==void 0?X.props.activeIndex:Ee;return[D.cloneElement(X,gt(gt(gt({},K.props),Jt),{},{activeIndex:We})),null,null]}if(!Wr(lt))return[ft].concat(Jm(F.renderActivePoints({item:K,activePoint:lt,basePoint:it,childIndex:Ee,isRange:Re})))}else{var pt,Wt=(pt=F.getItemByXY(F.state.activeCoordinate))!==null&&pt!==void 0?pt:{graphicalItem:ft},cr=Wt.graphicalItem,Gr=cr.item,ln=Gr===void 0?X:Gr,si=cr.childIndex,ki=gt(gt(gt({},K.props),Jt),{},{activeIndex:si});return[D.cloneElement(ln,ki),null,null]}return Re?[ft,null,null]:[ft,null]}),vr(F,"renderCustomized",function(X,G,ee){return D.cloneElement(X,gt(gt({key:"recharts-customized-".concat(ee)},F.props),F.state))}),vr(F,"renderMap",{CartesianGrid:{handler:Sw,once:!0},ReferenceArea:{handler:F.renderReferenceElement},ReferenceLine:{handler:Sw},ReferenceDot:{handler:F.renderReferenceElement},XAxis:{handler:Sw},YAxis:{handler:Sw},Brush:{handler:F.renderBrush,once:!0},Bar:{handler:F.renderGraphicChild},Line:{handler:F.renderGraphicChild},Area:{handler:F.renderGraphicChild},Radar:{handler:F.renderGraphicChild},RadialBar:{handler:F.renderGraphicChild},Scatter:{handler:F.renderGraphicChild},Pie:{handler:F.renderGraphicChild},Funnel:{handler:F.renderGraphicChild},Tooltip:{handler:F.renderCursor,once:!0},PolarGrid:{handler:F.renderPolarGrid,once:!0},PolarAngleAxis:{handler:F.renderPolarAxis},PolarRadiusAxis:{handler:F.renderPolarAxis},Customized:{handler:F.renderCustomized}}),F.clipPathId="".concat((R=O.id)!==null&&R!==void 0?R:Hb("recharts"),"-clip"),F.throttleTriggeredAfterMouseMove=lX(F.triggeredAfterMouseMove,(q=O.throttleDelay)!==null&&q!==void 0?q:1e3/60),F.state={},F}return h5e(B,I),l5e(B,[{key:"componentDidMount",value:function(){var R,q;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(R=this.props.margin.left)!==null&&R!==void 0?R:0,top:(q=this.props.margin.top)!==null&&q!==void 0?q:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var R=this.props,q=R.children,F=R.data,X=R.height,G=R.layout,ee=_a(q,Bs);if(ee){var K=ee.props.defaultIndex;if(!(typeof K!="number"||K<0||K>this.state.tooltipTicks.length-1)){var ie=this.state.tooltipTicks[K]&&this.state.tooltipTicks[K].value,pe=gN(this.state,F,K,ie),ae=this.state.tooltipTicks[K].coordinate,_e=(this.state.offset.top+X)/2,Ee=G==="horizontal",xe=Ee?{x:ae,y:_e}:{y:ae,x:_e},ce=this.state.formattedGraphicalItems.find(function(ve){var Pe=ve.item;return Pe.type.name==="Scatter"});ce&&(xe=gt(gt({},xe),ce.props.points[K].tooltipPosition),pe=ce.props.points[K].tooltipPayload);var ke={activeTooltipIndex:K,isTooltipActive:!0,activeLabel:ie,activePayload:pe,activeCoordinate:xe};this.setState(ke),this.renderCursor(ee),this.accessibilityManager.setIndex(K)}}}},{key:"getSnapshotBeforeUpdate",value:function(R,q){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==q.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==R.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==R.margin){var F,X;this.accessibilityManager.setDetails({offset:{left:(F=this.props.margin.left)!==null&&F!==void 0?F:0,top:(X=this.props.margin.top)!==null&&X!==void 0?X:0}})}return null}},{key:"componentDidUpdate",value:function(R){XA([_a(R.children,Bs)],[_a(this.props.children,Bs)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var R=_a(this.props.children,Bs);if(R&&typeof R.props.shared=="boolean"){var q=R.props.shared?"axis":"item";return i.indexOf(q)>=0?q:s}return s}},{key:"getMouseInfo",value:function(R){if(!this.container)return null;var q=this.container,F=q.getBoundingClientRect(),X=pke(F),G={chartX:Math.round(R.pageX-X.left),chartY:Math.round(R.pageY-X.top)},ee=F.width/q.offsetWidth||1,K=this.inRange(G.chartX,G.chartY,ee);if(!K)return null;var ie=this.state,pe=ie.xAxisMap,ae=ie.yAxisMap,_e=this.getTooltipEventType(),Ee=aU(this.state,this.props.data,this.props.layout,K);if(_e!=="axis"&&pe&&ae){var xe=Wu(pe).scale,ce=Wu(ae).scale,ke=xe&&xe.invert?xe.invert(G.chartX):null,ve=ce&&ce.invert?ce.invert(G.chartY):null;return gt(gt({},G),{},{xValue:ke,yValue:ve},Ee)}return Ee?gt(gt({},G),Ee):null}},{key:"inRange",value:function(R,q){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,X=this.props.layout,G=R/F,ee=q/F;if(X==="horizontal"||X==="vertical"){var K=this.state.offset,ie=G>=K.left&&G<=K.left+K.width&&ee>=K.top&&ee<=K.top+K.height;return ie?{x:G,y:ee}:null}var pe=this.state,ae=pe.angleAxisMap,_e=pe.radiusAxisMap;if(ae&&_e){var Ee=Wu(ae);return I5({x:G,y:ee},Ee)}return null}},{key:"parseEventsOfWrapper",value:function(){var R=this.props.children,q=this.getTooltipEventType(),F=_a(R,Bs),X={};F&&q==="axis"&&(F.props.trigger==="click"?X={onClick:this.handleClick}:X={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var G=G1(this.props,this.handleOuterEvent);return gt(gt({},G),X)}},{key:"addListener",value:function(){eP.on(tP,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){eP.removeListener(tP,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(R,q,F){for(var X=this.state.formattedGraphicalItems,G=0,ee=X.length;G<ee;G++){var K=X[G];if(K.item===R||K.props.key===R.key||q===Sc(K.item.type)&&F===K.childIndex)return K}return null}},{key:"renderClipPath",value:function(){var R=this.clipPathId,q=this.state.offset,F=q.left,X=q.top,G=q.height,ee=q.width;return je.createElement("defs",null,je.createElement("clipPath",{id:R},je.createElement("rect",{x:F,y:X,height:G,width:ee})))}},{key:"getXScales",value:function(){var R=this.state.xAxisMap;return R?Object.entries(R).reduce(function(q,F){var X=rU(F,2),G=X[0],ee=X[1];return gt(gt({},q),{},vr({},G,ee.scale))},{}):null}},{key:"getYScales",value:function(){var R=this.state.yAxisMap;return R?Object.entries(R).reduce(function(q,F){var X=rU(F,2),G=X[0],ee=X[1];return gt(gt({},q),{},vr({},G,ee.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(R){var q;return(q=this.state.xAxisMap)===null||q===void 0||(q=q[R])===null||q===void 0?void 0:q.scale}},{key:"getYScaleByAxisId",value:function(R){var q;return(q=this.state.yAxisMap)===null||q===void 0||(q=q[R])===null||q===void 0?void 0:q.scale}},{key:"getItemByXY",value:function(R){var q=this.state,F=q.formattedGraphicalItems,X=q.activeItem;if(F&&F.length)for(var G=0,ee=F.length;G<ee;G++){var K=F[G],ie=K.props,pe=K.item,ae=pe.type.defaultProps!==void 0?gt(gt({},pe.type.defaultProps),pe.props):pe.props,_e=Sc(pe.type);if(_e==="Bar"){var Ee=(ie.data||[]).find(function(ve){return ZLe(R,ve)});if(Ee)return{graphicalItem:K,payload:Ee}}else if(_e==="RadialBar"){var xe=(ie.data||[]).find(function(ve){return I5(R,ve)});if(xe)return{graphicalItem:K,payload:xe}}else if(PE(K,X)||AE(K,X)||vb(K,X)){var ce=J3e({graphicalItem:K,activeTooltipItem:X,itemData:ae.data}),ke=ae.activeIndex===void 0?ce:ae.activeIndex;return{graphicalItem:gt(gt({},K),{},{childIndex:ke}),payload:vb(K,X)?ae.data[ce]:K.props.data[ce]}}}return null}},{key:"render",value:function(){var R=this;if(!xz(this))return null;var q=this.props,F=q.children,X=q.className,G=q.width,ee=q.height,K=q.style,ie=q.compact,pe=q.title,ae=q.desc,_e=nU(q,r5e),Ee=Xr(_e,!1);if(ie)return je.createElement(MF,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},je.createElement(KA,om({},Ee,{width:G,height:ee,title:pe,desc:ae}),this.renderClipPath(),_z(F,this.renderMap)));if(this.props.accessibilityLayer){var xe,ce;Ee.tabIndex=(xe=this.props.tabIndex)!==null&&xe!==void 0?xe:0,Ee.role=(ce=this.props.role)!==null&&ce!==void 0?ce:"application",Ee.onKeyDown=function(ve){R.accessibilityManager.keyboardEvent(ve)},Ee.onFocus=function(){R.accessibilityManager.focus()}}var ke=this.parseEventsOfWrapper();return je.createElement(MF,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},je.createElement("div",om({className:Zr("recharts-wrapper",X),style:gt({position:"relative",cursor:"default",width:G,height:ee},K)},ke,{ref:function(Pe){R.container=Pe}}),je.createElement(KA,om({},Ee,{width:G,height:ee,title:pe,desc:ae,style:v5e}),this.renderClipPath(),_z(F,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(D.Component);vr(k,"displayName",r),vr(k,"defaultProps",gt({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},_)),vr(k,"getDerivedStateFromProps",function(I,B){var O=I.dataKey,R=I.data,q=I.children,F=I.width,X=I.height,G=I.layout,ee=I.stackOffset,K=I.margin,ie=B.dataStartIndex,pe=B.dataEndIndex;if(B.updateId===void 0){var ae=sU(I);return gt(gt(gt({},ae),{},{updateId:0},C(gt(gt({props:I},ae),{},{updateId:0}),B)),{},{prevDataKey:O,prevData:R,prevWidth:F,prevHeight:X,prevLayout:G,prevStackOffset:ee,prevMargin:K,prevChildren:q})}if(O!==B.prevDataKey||R!==B.prevData||F!==B.prevWidth||X!==B.prevHeight||G!==B.prevLayout||ee!==B.prevStackOffset||!pm(K,B.prevMargin)){var _e=sU(I),Ee={chartX:B.chartX,chartY:B.chartY,isTooltipActive:B.isTooltipActive},xe=gt(gt({},aU(B,R,G)),{},{updateId:B.updateId+1}),ce=gt(gt(gt({},_e),Ee),xe);return gt(gt(gt({},ce),C(gt({props:I},ce),B)),{},{prevDataKey:O,prevData:R,prevWidth:F,prevHeight:X,prevLayout:G,prevStackOffset:ee,prevMargin:K,prevChildren:q})}if(!XA(q,B.prevChildren)){var ke,ve,Pe,Re,Be=_a(q,Um),Fe=Be&&(ke=(ve=Be.props)===null||ve===void 0?void 0:ve.startIndex)!==null&&ke!==void 0?ke:ie,Ge=Be&&(Pe=(Re=Be.props)===null||Re===void 0?void 0:Re.endIndex)!==null&&Pe!==void 0?Pe:pe,Pt=Fe!==ie||Ge!==pe,$t=!Wr(R),nr=$t&&!Pt?B.updateId:B.updateId+1;return gt(gt({updateId:nr},C(gt(gt({props:I},B),{},{updateId:nr,dataStartIndex:Fe,dataEndIndex:Ge}),B)),{},{prevChildren:q,dataStartIndex:Fe,dataEndIndex:Ge})}return null}),vr(k,"renderActiveDot",function(I,B,O){var R;return D.isValidElement(I)?R=D.cloneElement(I,B):Nr(I)?R=I(B):R=je.createElement(kO,B),je.createElement(pi,{className:"recharts-active-dot",key:O},R)});var N=D.forwardRef(function(B,O){return je.createElement(k,om({},B,{ref:O}))});return N.displayName=k.displayName,N},_K=P5e({chartName:"LineChart",GraphicalChild:yd,axisComponents:[{axisType:"xAxis",AxisComp:t0},{axisType:"yAxis",AxisComp:mf}],formatAxisMap:SBe});const A5e=()=>{const e=zi(),{signOut:t}=fg(),[r,n]=D.useState(null),[o,s]=D.useState({totalBookings:0,totalRevenue:0,averageRating:0,popularTables:[],pendingPayouts:0,activeBookings:0,totalTables:0}),[h,i]=D.useState([]),[p,y]=D.useState([]),[b,_]=D.useState(!0),[E,C]=D.useState(null),[k,N]=D.useState([]),[I,B]=D.useState(null);r==null||r.id;const[O,R]=D.useState(""),q=D.useRef(null),F=D.useRef(null);console.log("Dashboard currentUser (top-level):",I),D.useEffect(()=>(X(),ee(),F.current=setInterval(()=>{I&&!b&&(console.log("Auto-refreshing dashboard data..."),G(!0))},6e4),()=>{ie(),F.current&&clearInterval(F.current)}),[]),D.useEffect(()=>{I&&(async()=>{try{const{data:_e,error:Ee}=await Ve.from("user_profiles").select(`
            id,
            first_name,
            last_name,
            credit_balance,
            phone_number,
            city,
            country,
            created_at
          `).gt("credit_balance",0).order("credit_balance",{ascending:!1});Ee?console.error("Error fetching VIP members:",Ee):(console.log("VIP members fetched:",_e),N(_e||[]))}catch(_e){console.error("Error in fetchMembers:",_e)}})()},[I]);const X=async()=>{try{const{data:{session:ae},error:_e}=await Ve.auth.getSession();if(_e)throw _e;if(!ae){console.log("No session found, redirecting to login..."),Mr({title:"Authentication Required",description:"Please log in to access the dashboard",variant:"destructive"}),e("/venue-owner/login");return}const{data:{user:Ee},error:xe}=await Ve.auth.getUser();if(xe)throw xe;const{data:ce,error:ke}=await Ve.from("venue_owners").select("*").eq("user_id",Ee.id).single();if(ke||!ce){console.log("User is not a venue owner, redirecting to register..."),Mr({title:"Venue Owner Account Required",description:"Please register as a venue owner to access the dashboard",variant:"destructive"}),e("/venue-owner/register");return}G()}catch(ae){console.error("Auth check error:",ae),C(ae.message),Mr({title:"Error",description:"Failed to verify authentication",variant:"destructive"})}},G=async(ae=!1)=>{try{console.log("Fetching venue data..."),_(!0),C(null);const{data:{user:_e},error:Ee}=await Ve.auth.getUser();if(Ee)throw console.error("User fetch error:",Ee),Ee;B(_e),console.log("Current user:",_e);const{data:xe,error:ce}=await Ve.from("venues").select("*").eq("owner_id",_e.id);if(ce)throw console.error("Error fetching venues:",ce),ce;console.log("Venues data:",xe),console.log("Number of venues found:",(xe==null?void 0:xe.length)||0);const ke=xe&&xe.length>0?xe[0]:null;n(ke);const ve=(xe==null?void 0:xe.map(We=>We.id))||[];console.log("Venue IDs:",ve),!q.current&&!ae&&ve.length>0&&await pe(ve);let Pe=[];if(ve.length>0){console.log("Fetching bookings for venue IDs:",ve);const{data:We,error:pt}=await Ve.from("bookings").select(`
            *,
            venue_tables!table_id (
              id,
              table_number,
              price
            )
          `).in("venue_id",ve);if(pt){console.error("Error fetching bookings with table join:",pt),console.log("Trying fallback query without table join...");const{data:Wt,error:cr}=await Ve.from("bookings").select("*").in("venue_id",ve);if(cr)throw console.error("Fallback booking query also failed:",cr),cr;console.log("Fallback booking query succeeded:",Wt),Pe=Wt||[]}else Pe=We||[],console.log("Raw bookings data:",We),console.log("Number of bookings found:",Pe.length)}else console.log("No venue IDs found, skipping booking fetch");const{data:Re,error:Be}=await Ve.from("bookings").select("id, venue_id, user_id, status, total_amount, created_at").limit(10);console.log("All bookings in database (first 10):",Re),console.log("Total bookings in database:",(Re==null?void 0:Re.length)||0);const{data:Fe,error:Ge}=await Ve.from("venue_tables").select("*").limit(1);console.log("Sample venue_tables data:",Fe),console.log("venue_tables columns available:",Fe!=null&&Fe[0]?Object.keys(Fe[0]):"No tables found"),Ge&&console.log("venue_tables error:",Ge);let Pt=0;if(ve.length>0){const{data:We,error:pt}=await Ve.from("venue_tables").select("id").in("venue_id",ve);pt||(Pt=(We==null?void 0:We.length)||0),console.log("Total tables found:",Pt)}const $t=Pe.length,nr=Pe.reduce((We,pt)=>We+(pt.total_amount||0),0),Nt=Pe.filter(We=>We.status==="confirmed"||We.status==="pending").length,Jt=Pe.filter(We=>We.status==="confirmed").reduce((We,pt)=>We+(pt.total_amount||0),0)*.8,ft={};Pe.forEach(We=>{var pt;(pt=We.venue_tables)!=null&&pt.table_number?ft[We.venue_tables.table_number]=(ft[We.venue_tables.table_number]||0)+1:We.table_id&&(ft[`Table ${We.table_id.slice(-8)}`]=(ft[`Table ${We.table_id.slice(-8)}`]||0)+1)});const vt=Object.entries(ft).map(([We,pt])=>({name:We,count:pt})).sort((We,pt)=>pt.count-We.count).slice(0,5);s({totalBookings:$t,totalRevenue:nr,activeBookings:Nt,pendingPayouts:Jt,totalTables:Pt,popularTables:vt});const lt=Pe.sort((We,pt)=>new Date(pt.created_at)-new Date(We.created_at)).slice(0,5);i(lt);const ar=Array.from({length:7},(We,pt)=>{const Wt=new Date;return Wt.setDate(Wt.getDate()-pt),Wt.toISOString().split("T")[0]}).reverse().map(We=>({date:We,bookings:Pe.filter(pt=>pt.created_at&&pt.created_at.startsWith(We)).length,revenue:Pe.filter(pt=>pt.created_at&&pt.created_at.startsWith(We)).reduce((pt,Wt)=>pt+(Wt.total_amount||0),0)}));y(ar),console.log("Data fetch completed successfully")}catch(_e){console.error("Error in fetchVenueData:",_e),C(_e.message),Mr({title:"Error",description:`Failed to fetch venue data: ${_e.message}`,variant:"destructive"})}finally{_(!1)}},ee=async()=>{try{const{data:{user:ae},error:_e}=await Ve.auth.getUser();if(_e||!ae){R("Error fetching user info.");return}const{data:Ee,error:xe}=await Ve.from("venues").select("id, name").eq("owner_id",ae.id);if(xe){R("Error fetching venue.");return}Ee&&Ee.length>0?R(`You have successfully logged in to ${Ee[0].name}`):R("No venue found for this account.")}catch{R("Unexpected error fetching venue.")}},K=async()=>{try{await t(),Mr({title:"Success",description:"Successfully logged out"}),e("/")}catch(ae){console.error("Error logging out:",ae),Mr({title:"Error",description:"Failed to log out",variant:"destructive"})}},ie=()=>{q.current&&(console.log("Cleaning up dashboard real-time subscription..."),q.current.unsubscribe(),q.current=null)},pe=async ae=>{if(ie(),!ae||ae.length===0){console.log("No venue IDs provided for dashboard subscription");return}console.log("Setting up dashboard real-time subscription for venues:",ae);try{q.current=Ve.channel("dashboard-bookings-changes").on("postgres_changes",{event:"*",schema:"public",table:"bookings",filter:`venue_id=in.(${ae.join(",")})`},_e=>{console.log("Real-time booking change detected in dashboard:",_e),setTimeout(()=>{I&&G(!0)},1e3)}).subscribe(_e=>{console.log("Dashboard subscription status:",_e),_e==="SUBSCRIBED"&&console.log("Successfully subscribed to dashboard real-time updates")})}catch(_e){console.error("Error setting up dashboard real-time subscription:",_e)}};return b?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):E?c.jsx("div",{className:"container mx-auto px-4 py-8",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[c.jsx("h2",{className:"text-red-800 font-semibold mb-2",children:"Error Loading Dashboard"}),c.jsx("p",{className:"text-red-600",children:E}),c.jsx("button",{onClick:G,className:"mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors",children:"Retry"})]})}):!r&&!b?c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[c.jsx("h2",{className:"text-yellow-800 font-semibold mb-2",children:"No Venue Found"}),c.jsx("p",{className:"text-yellow-600",children:"You haven't created a venue yet, or your venue is not associated with your account."}),c.jsx("a",{href:"/venue-owner/register",className:"mt-4 inline-block bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 transition-colors",children:"Create Venue"})]}),c.jsxs("pre",{className:"mt-4 bg-gray-100 p-2 rounded text-xs text-gray-700 overflow-x-auto",children:["Debug Info: userId=",(I==null?void 0:I.id)||"N/A"]})]}):c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsxs("div",{className:"container py-8",children:[O&&c.jsx("div",{className:"mb-6 p-4 rounded bg-green-50 border border-green-200 text-green-800 text-center",children:O}),c.jsxs("div",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-2",children:"Venue Dashboard"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Manage your venue, bookings, and revenue"})]}),c.jsxs("div",{className:"flex gap-4",children:[c.jsxs(Et,{variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",onClick:()=>e("/venue-owner/settings"),children:[c.jsx(Xs,{className:"h-4 w-4 mr-2"}),"Settings"]}),c.jsxs(Et,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:[c.jsx(k8,{className:"h-4 w-4 mr-2"}),"Generate QR Code"]}),c.jsxs(Et,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-50",onClick:K,children:[c.jsx(lA,{className:"h-4 w-4 mr-2"}),"Log Out"]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsxs(zr,{className:"flex flex-row items-center justify-between pb-2",children:[c.jsx($r,{className:"text-sm font-medium text-brand-burgundy/70",children:"Total Revenue"}),c.jsx(rf,{className:"h-4 w-4 text-brand-gold"})]}),c.jsxs(rr,{children:[c.jsxs("div",{className:"text-2xl font-bold text-brand-burgundy",children:["",(o.totalRevenue??0).toLocaleString()]}),c.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"All time earnings"})]})]}),c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsxs(zr,{className:"flex flex-row items-center justify-between pb-2",children:[c.jsx($r,{className:"text-sm font-medium text-brand-burgundy/70",children:"Pending Payouts"}),c.jsx(p2,{className:"h-4 w-4 text-brand-gold"})]}),c.jsxs(rr,{children:[c.jsxs("div",{className:"text-2xl font-bold text-brand-burgundy",children:["",(o.pendingPayouts??0).toLocaleString()]}),c.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"Available for withdrawal"})]})]}),c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsxs(zr,{className:"flex flex-row items-center justify-between pb-2",children:[c.jsx($r,{className:"text-sm font-medium text-brand-burgundy/70",children:"Active Bookings"}),c.jsx(Lo,{className:"h-4 w-4 text-brand-gold"})]}),c.jsxs(rr,{children:[c.jsx("div",{className:"text-2xl font-bold text-brand-burgundy",children:o.activeBookings}),c.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"Current bookings"})]})]}),c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsxs(zr,{className:"flex flex-row items-center justify-between pb-2",children:[c.jsx($r,{className:"text-sm font-medium text-brand-burgundy/70",children:"Total Tables"}),c.jsx(uA,{className:"h-4 w-4 text-brand-gold"})]}),c.jsxs(rr,{children:[c.jsx("div",{className:"text-2xl font-bold text-brand-burgundy",children:o.totalTables}),c.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"Available tables"})]})]})]}),c.jsxs(Cd,{defaultValue:"bookings",className:"space-y-4",children:[c.jsxs(Wc,{className:"bg-white p-1 rounded-lg border border-brand-burgundy/10",children:[c.jsxs(vn,{value:"bookings",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[c.jsx(Lo,{className:"h-4 w-4 mr-2"}),"Bookings"]}),c.jsxs(vn,{value:"images",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[c.jsx(sA,{className:"h-4 w-4 mr-2"}),"Images"]}),c.jsxs(vn,{value:"analytics",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[c.jsx(jM,{className:"h-4 w-4 mr-2"}),"Analytics"]})]}),c.jsx(xn,{value:"bookings",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsx(rr,{className:"pt-6",children:c.jsx(H9,{currentUser:I})})})}),c.jsx(xn,{value:"images",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsx(rr,{className:"pt-6",children:r&&I?c.jsx(Jve,{currentUser:I}):c.jsx("div",{children:"Loading venue info..."})})})}),c.jsx(xn,{value:"analytics",children:c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsx(zr,{children:c.jsx($r,{className:"text-brand-burgundy",children:"Revenue Analytics"})}),c.jsxs(rr,{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-4 text-brand-burgundy",children:"Booking Trends (Last 7 Days)"}),c.jsx("div",{className:"h-80",children:c.jsx(cX,{width:"100%",height:"100%",children:c.jsxs(_K,{data:p,children:[c.jsx($O,{strokeDasharray:"3 3"}),c.jsx(t0,{dataKey:"date"}),c.jsx(mf,{yAxisId:"left"}),c.jsx(mf,{yAxisId:"right",orientation:"right"}),c.jsx(Bs,{}),c.jsx(yd,{yAxisId:"left",type:"monotone",dataKey:"bookings",stroke:"#8B4513",name:"Bookings",strokeWidth:2}),c.jsx(yd,{yAxisId:"right",type:"monotone",dataKey:"revenue",stroke:"#DAA520",name:"Revenue ()",strokeWidth:2})]})})})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-4 text-brand-burgundy",children:"Popular Tables"}),o.popularTables&&o.popularTables.length>0?c.jsx("div",{className:"space-y-4",children:o.popularTables.map((ae,_e)=>c.jsxs("div",{className:"flex justify-between items-center p-3 bg-brand-cream/30 rounded-lg",children:[c.jsx("span",{className:"font-medium text-brand-burgundy",children:ae.name}),c.jsxs("span",{className:"font-semibold text-brand-gold",children:[ae.count," bookings"]})]},_e))}):c.jsx("p",{className:"text-brand-burgundy/70",children:"No booking data available yet."})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-4 text-brand-burgundy",children:"Recent Bookings"}),h&&h.length>0?c.jsx("div",{className:"space-y-4",children:h.map(ae=>{var _e;return c.jsxs("div",{className:"flex justify-between items-center p-3 bg-brand-cream/30 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold text-brand-burgundy",children:(_e=ae.venue_tables)!=null&&_e.table_number?`Table ${ae.venue_tables.table_number}`:ae.table_id?`Table ${ae.table_id.slice(-8)}`:"Unknown Table"}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:new Date(ae.created_at).toLocaleDateString()})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("p",{className:"font-semibold text-brand-gold",children:["",(ae.total_amount||0).toLocaleString()]}),c.jsx("p",{className:"text-sm text-brand-burgundy/70 capitalize",children:ae.status})]})]},ae.id)})}):c.jsx("p",{className:"text-brand-burgundy/70",children:"No recent bookings found."})]})]})]})})]}),c.jsxs(kt,{className:"bg-white border-brand-burgundy/10 mt-8",children:[c.jsxs(zr,{children:[c.jsxs($r,{className:"text-brand-burgundy flex items-center",children:[c.jsx(Bi,{className:"h-5 w-5 mr-2"}),"Eddy VIP Members"]}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"VIP members who have deposited funds and are eligible for exclusive perks"})]}),c.jsx(rr,{children:k&&k.length>0?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-brand-burgundy",children:k.length}),c.jsx("div",{className:"text-sm text-brand-burgundy/70",children:"Total VIP Members"})]}),c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg text-center",children:[c.jsxs("div",{className:"text-2xl font-bold text-brand-gold",children:["$",k.reduce((ae,_e)=>ae+(_e.credit_balance||0),0).toLocaleString()]}),c.jsx("div",{className:"text-sm text-brand-burgundy/70",children:"Total Deposits"})]}),c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-brand-burgundy",children:k.filter(ae=>(ae.credit_balance||0)>=1e4).length}),c.jsx("div",{className:"text-sm text-brand-burgundy/70",children:"Premium Members"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full border-collapse",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b border-brand-burgundy/20",children:[c.jsx("th",{className:"text-left py-3 px-2 font-semibold text-brand-burgundy",children:"Member"}),c.jsx("th",{className:"text-left py-3 px-2 font-semibold text-brand-burgundy",children:"VIP Status"}),c.jsx("th",{className:"text-left py-3 px-2 font-semibold text-brand-burgundy",children:"Credit Balance"}),c.jsx("th",{className:"text-left py-3 px-2 font-semibold text-brand-burgundy",children:"Location"}),c.jsx("th",{className:"text-left py-3 px-2 font-semibold text-brand-burgundy",children:"Joined"}),c.jsx("th",{className:"text-left py-3 px-2 font-semibold text-brand-burgundy",children:"Contact"})]})}),c.jsx("tbody",{children:k.map(ae=>{const _e=(ae.credit_balance||0)>=1e3,Ee=(ae.credit_balance||0)>=1e4,xe=`${ae.first_name||""} ${ae.last_name||""}`.trim()||"Unknown Member",ce=[ae.city,ae.country].filter(Boolean).join(", ")||"Not specified",ke=ae.created_at?new Date(ae.created_at).toLocaleDateString():"Unknown";return c.jsxs("tr",{className:"border-b border-brand-burgundy/10 hover:bg-brand-cream/20 transition-colors",children:[c.jsx("td",{className:"py-3 px-2",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-brand-burgundy",children:xe}),c.jsxs("div",{className:"text-xs text-brand-burgundy/60",children:["ID: ",ae.id.slice(0,8),"..."]})]})}),c.jsx("td",{className:"py-3 px-2",children:c.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Ee?"bg-gradient-to-r from-brand-gold to-yellow-400 text-brand-burgundy":_e?"bg-brand-burgundy text-white":"bg-gray-100 text-gray-800"}`,children:Ee?" Premium VIP":_e?" VIP Member":" Basic Member"})}),c.jsxs("td",{className:"py-3 px-2",children:[c.jsxs("div",{className:"font-semibold text-brand-gold",children:["$",(ae.credit_balance||0).toLocaleString()]}),Ee&&c.jsx("div",{className:"text-xs text-brand-burgundy/60",children:"Premium Perks Active"})]}),c.jsx("td",{className:"py-3 px-2",children:c.jsx("div",{className:"text-sm text-brand-burgundy/80",children:ce})}),c.jsx("td",{className:"py-3 px-2",children:c.jsx("div",{className:"text-sm text-brand-burgundy/80",children:ke})}),c.jsx("td",{className:"py-3 px-2",children:c.jsx("div",{className:"text-sm text-brand-burgundy/80",children:ae.phone_number||"Not provided"})})]},ae.id)})})]})}),c.jsxs("div",{className:"mt-6 p-4 bg-brand-cream/30 rounded-lg",children:[c.jsx("h4",{className:"font-semibold text-brand-burgundy mb-2",children:"VIP Membership Tiers"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-xs",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"w-3 h-3 bg-gray-100 rounded-full"}),c.jsx("span",{className:"text-brand-burgundy/70",children:"Basic Member: $0 - $999"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"w-3 h-3 bg-brand-burgundy rounded-full"}),c.jsx("span",{className:"text-brand-burgundy/70",children:"VIP Member: $1,000 - $9,999"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"w-3 h-3 bg-brand-gold rounded-full"}),c.jsx("span",{className:"text-brand-burgundy/70",children:"Premium VIP: $10,000+"})]})]})]})]}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Bi,{className:"h-12 w-12 mx-auto text-brand-burgundy/30 mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-brand-burgundy mb-2",children:"No VIP Members Yet"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"VIP members will appear here once they make their first deposit through the app."})]})})]}),c.jsx(gd,{children:c.jsxs(Dc,{"aria-describedby":"add-table-desc",children:[c.jsx(Rc,{children:c.jsx(Lc,{children:"Add New Table"})}),c.jsx("div",{id:"add-table-desc",className:"sr-only",children:"Fill out the form below to add a new table to your venue."})]})})]})})},k5e=()=>{const e=zi(),{toast:t}=Co(),[r,n]=D.useState(!1),[o,s]=D.useState({email:"",password:""}),[h,i]=D.useState(null),p=async C=>{C.preventDefault(),n(!0),i(null);try{console.log(" Starting login process for:",o.email),console.log(" Login attempt:",{email:o.email,passwordLength:o.password.length,hasPassword:!!o.password});const{data:k,error:N}=await Ve.auth.signInWithPassword({email:o.email,password:o.password});if(console.log(" Auth result:",{data:k,error:N}),N)throw console.error(" Authentication failed:",N),N;if(!k.user)throw console.error(" No user data returned"),new Error("No user data returned from authentication");console.log(" Authentication successful for user:",k.user.id),console.log(" User details:",{id:k.user.id,email:k.user.email,emailConfirmed:!!k.user.email_confirmed_at,lastSignIn:k.user.last_sign_in_at}),console.log(" Checking venue owner status...");const{data:I,error:B}=await Ve.from("venue_owners").select("*").eq("user_id",k.user.id).single();if(console.log(" Venue owner check result:",{venueOwner:I,venueOwnerError:B}),B)throw console.error(" Venue owner lookup failed:",B),new Error("Venue owner profile not found");if(!I)throw console.error(" No venue owner record found"),new Error("No venue owner profile found for this user");if(console.log(" Venue owner found:",{id:I.id,email:I.owner_email,status:I.status,name:I.owner_name}),I.status!=="active")throw console.error(" Venue owner not active:",I.status),new Error(`Venue owner account is ${I.status}. Please contact support.`);console.log(" Login successful! Redirecting to dashboard..."),e("/venue-owner/dashboard")}catch(k){console.error(" Login error:",k),k.message==="Invalid login credentials"?i('Invalid email or password. If you recently registered, please check your email for a confirmation link and click it before logging in. You can also use the "Resend confirmation email" button below.'):k.message.includes("Email not confirmed")?i(`Please check your email and click the confirmation link before logging in. If you didn't receive the email, use the "Resend confirmation email" button below.`):k.message.includes("Invalid login credentials")?i("Invalid email or password. If you recently registered, please check your email for a confirmation link and click it before logging in."):i(k.message||"Login failed"),t({title:"Login Failed",description:'If you recently registered, please check your email for a confirmation link. Use the "Debug Account Status" button to check your account status.',variant:"destructive"})}finally{n(!1)}},y=C=>{const{name:k,value:N}=C.target;s(I=>({...I,[k]:N}))},b=async()=>{if(!o.email){i("Please enter your email address first"),t({title:"Email Required",description:"Please enter your email address to reset your password.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)){i("Please enter a valid email address"),t({title:"Invalid Email",description:"Please enter a valid email address.",variant:"destructive"});return}try{n(!0),i(null),console.log(" Sending password reset email to:",o.email),console.log(" Redirect URL:",`${window.location.origin}/venue-owner/reset-password`);const{error:k}=await Ve.auth.resetPasswordForEmail(o.email,{redirectTo:`${window.location.origin}/venue-owner/reset-password`});if(k)throw k;t({title:"Password Reset Email Sent",description:"Check your email for password reset instructions. Click the link in the email to reset your password. If you don't see it, check your spam folder.",variant:"default"}),i(null),console.log(" Password reset email sent successfully"),t({title:"Important",description:"After clicking the reset link, you will be taken to a password reset page. If you are redirected to the home page, please check the URL for any error messages.",variant:"default"})}catch(k){console.error(" Password reset error:",k),i(k.message||"Failed to send password reset email"),t({title:"Error",description:k.message||"Failed to send password reset email. Please try again.",variant:"destructive"})}finally{n(!1)}},_=async()=>{if(!o.email){i("Please enter your email address first");return}try{n(!0),i(null),console.log(" Resending confirmation email to:",o.email);const{error:C}=await Ve.auth.resend({type:"signup",email:o.email,options:{emailRedirectTo:`${window.location.origin}/venue-owner/login`}});if(C)throw C;t({title:"Confirmation Email Sent",description:"Check your email for the confirmation link. If you don't see it, check your spam folder.",variant:"default"}),i(null),console.log(" Confirmation email resent successfully")}catch(C){console.error(" Resend confirmation error:",C),i(C.message||"Failed to resend confirmation email"),t({title:"Error",description:C.message||"Failed to resend confirmation email. Please try again.",variant:"destructive"})}finally{n(!1)}},E=async()=>{try{console.log(" Debugging venue owner status...");const{data:{user:C},error:k}=await Ve.auth.getUser();if(console.log(" Current user:",C,"User Error:",k),C){const{data:F,error:X}=await Ve.from("venue_owners").select("*").eq("user_id",C.id);console.log(" Venue owners for user:",F,"Error:",X);const{data:G,error:ee}=await Ve.from("venue_owners").select("*").eq("owner_email",o.email);console.log(" Venue owners by email:",G,"Error:",ee)}const{data:N,error:I}=await Ve.from("venue_owners").select("*").eq("owner_email",o.email);console.log(" Venue owners by email:",N,"Error:",I);const{data:B,error:O}=await Ve.from("pending_venue_owner_requests").select("*").eq("email",o.email);console.log(" Pending requests:",B,"Error:",O);const{data:R,error:q}=await Ve.from("venues").select("*").eq("contact_email",o.email);console.log(" Venues by email:",R,"Error:",q),console.log(" DEBUG SUMMARY:"),console.log("   - Auth user check: Use Supabase Auth API (cannot query auth.users directly)"),console.log("   - Venue owners found:",(N==null?void 0:N.length)||0),console.log("   - Venues found:",(R==null?void 0:R.length)||0),console.log("   - Pending requests:",(B==null?void 0:B.length)||0)}catch(C){console.error(" Debug error:",C)}};return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:c.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-lg",children:[c.jsxs("div",{className:"text-center",children:[c.jsx(nt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},className:"mx-auto h-12 w-12 bg-brand-burgundy/10 rounded-full flex items-center justify-center",children:c.jsx(dd,{className:"h-6 w-6 text-brand-burgundy"})}),c.jsx("h2",{className:"mt-6 text-3xl font-heading text-brand-burgundy",children:"Welcome Back"}),c.jsx("p",{className:"mt-2 text-sm text-brand-burgundy/70",children:"Sign in to manage your venue"})]}),c.jsxs("form",{className:"mt-8 space-y-6",onSubmit:p,children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"email",className:"text-brand-burgundy",children:"Email Address"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(nf,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:o.email,onChange:y,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your email"})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"password",className:"text-brand-burgundy",children:"Password"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(b1,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:o.password,onChange:y,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your password"})]})]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-brand-burgundy border-brand-burgundy/20 rounded focus:ring-brand-burgundy"}),c.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-brand-burgundy/70",children:"Remember me"})]}),c.jsx("div",{className:"text-sm",children:c.jsx("button",{type:"button",onClick:b,className:"text-brand-burgundy hover:text-brand-gold",children:"Forgot your password?"})})]}),c.jsx("div",{children:c.jsxs(Et,{type:"submit",className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",disabled:r,children:[r?"Signing in...":"Sign in",c.jsx(jl,{className:"ml-2 h-4 w-4"})]})})]}),c.jsxs("div",{className:"text-center mt-6",children:[c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Don't have a venue account?"," ",c.jsx(In,{to:"/venue-owner/register",className:"text-brand-burgundy hover:text-brand-gold font-medium",children:"Register your venue"})]}),c.jsxs("div",{className:"mt-4 pt-4 border-t border-brand-burgundy/10",children:[c.jsx("p",{className:"text-xs text-brand-burgundy/60 mb-2",children:"Having trouble logging in?"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("button",{type:"button",onClick:_,className:"text-xs text-brand-burgundy/70 hover:text-brand-gold underline block",disabled:r,children:"Resend confirmation email"}),c.jsx("button",{type:"button",onClick:E,className:"text-xs text-brand-burgundy/70 hover:text-brand-gold underline block",disabled:r,children:"Debug Account Status"})]})]})]})]})})},Tb=je.forwardRef(({className:e,...t},r)=>c.jsx("textarea",{className:Cr("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));Tb.displayName="Textarea";function cU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function uU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cU(Object(r),!0).forEach(function(n){wK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ww(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ww=function(t){return typeof t}:Ww=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ww(e)}function wK(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SK(e,t){return N5e(e)||M5e(e,t)||I5e(e,t)||O5e()}function N5e(e){if(Array.isArray(e))return e}function M5e(e,t){var r=e&&(typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"]);if(r!=null){var n=[],o=!0,s=!1,h,i;try{for(r=r.call(e);!(o=(h=r.next()).done)&&(n.push(h.value),!(t&&n.length===t));o=!0);}catch(p){s=!0,i=p}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw i}}return n}}function I5e(e,t){if(e){if(typeof e=="string")return dU(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dU(e,t)}}function dU(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ya=function(t,r,n){var o=!!n,s=je.useRef(n);je.useEffect(function(){s.current=n},[n]),je.useEffect(function(){if(!o||!t)return function(){};var h=function(){s.current&&s.current.apply(s,arguments)};return t.on(r,h),function(){t.off(r,h)}},[o,r,t,s])},yN=function(t){var r=je.useRef(t);return je.useEffect(function(){r.current=t},[t]),r.current},Qm=function(t){return t!==null&&Ww(t)==="object"},D5e=function(t){return Qm(t)&&typeof t.then=="function"},R5e=function(t){return Qm(t)&&typeof t.elements=="function"&&typeof t.createToken=="function"&&typeof t.createPaymentMethod=="function"&&typeof t.confirmCardPayment=="function"},hU="[object Object]",L5e=function e(t,r){if(!Qm(t)||!Qm(r))return t===r;var n=Array.isArray(t),o=Array.isArray(r);if(n!==o)return!1;var s=Object.prototype.toString.call(t)===hU,h=Object.prototype.toString.call(r)===hU;if(s!==h)return!1;if(!s&&!n)return t===r;var i=Object.keys(t),p=Object.keys(r);if(i.length!==p.length)return!1;for(var y={},b=0;b<i.length;b+=1)y[i[b]]=!0;for(var _=0;_<p.length;_+=1)y[p[_]]=!0;var E=Object.keys(y);if(E.length!==i.length)return!1;var C=t,k=r,N=function(B){return e(C[B],k[B])};return E.every(N)},EK=function(t,r,n){return Qm(t)?Object.keys(t).reduce(function(o,s){var h=!Qm(r)||!L5e(t[s],r[s]);return n.includes(s)?(h&&console.warn("Unsupported prop change: options.".concat(s," is not a mutable property.")),o):h?uU(uU({},o||{}),{},wK({},s,t[s])):o},null):null},TK="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",fU=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:TK;if(t===null||R5e(t))return t;throw new Error(r)},B5e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:TK;if(D5e(t))return{tag:"async",stripePromise:Promise.resolve(t).then(function(o){return fU(o,r)})};var n=fU(t,r);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},z5e=function(t){!t||!t._registerWrapper||!t.registerAppInfo||(t._registerWrapper({name:"react-stripe-js",version:"2.8.1"}),t.registerAppInfo({name:"react-stripe-js",version:"2.8.1",url:"https://stripe.com/docs/stripe-js/react"}))},RE=je.createContext(null);RE.displayName="ElementsContext";var jK=function(t,r){if(!t)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(r," in an <Elements> provider."));return t},qS=function(t){var r=t.stripe,n=t.options,o=t.children,s=je.useMemo(function(){return B5e(r)},[r]),h=je.useState(function(){return{stripe:s.tag==="sync"?s.stripe:null,elements:s.tag==="sync"?s.stripe.elements(n):null}}),i=SK(h,2),p=i[0],y=i[1];je.useEffect(function(){var E=!0,C=function(N){y(function(I){return I.stripe?I:{stripe:N,elements:N.elements(n)}})};return s.tag==="async"&&!p.stripe?s.stripePromise.then(function(k){k&&E&&C(k)}):s.tag==="sync"&&!p.stripe&&C(s.stripe),function(){E=!1}},[s,p,n]);var b=yN(r);je.useEffect(function(){b!==null&&b!==r&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[b,r]);var _=yN(n);return je.useEffect(function(){if(p.elements){var E=EK(n,_,["clientSecret","fonts"]);E&&p.elements.update(E)}},[n,_,p.elements]),je.useEffect(function(){z5e(p.stripe)},[p.stripe]),je.createElement(RE.Provider,{value:p},o)};qS.propTypes={stripe:lr.any,options:lr.object};var $5e=function(t){var r=je.useContext(RE);return jK(r,t)},FO=function(){var t=$5e("calls useElements()"),r=t.elements;return r};lr.func.isRequired;var CK=je.createContext(null);CK.displayName="CustomCheckoutSdkContext";var F5e=function(t,r){if(!t)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(r," in an <CustomCheckoutProvider> provider."));return t},U5e=je.createContext(null);U5e.displayName="CustomCheckoutContext";lr.any,lr.shape({clientSecret:lr.string.isRequired,elementsOptions:lr.object}).isRequired;var vN=function(t){var r=je.useContext(CK),n=je.useContext(RE);if(r&&n)throw new Error("You cannot wrap the part of your app that ".concat(t," in both <CustomCheckoutProvider> and <Elements> providers."));return r?F5e(r,t):jK(n,t)},V5e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},Pi=function(t,r){var n="".concat(V5e(t),"Element"),o=function(p){var y=p.id,b=p.className,_=p.options,E=_===void 0?{}:_,C=p.onBlur,k=p.onFocus,N=p.onReady,I=p.onChange,B=p.onEscape,O=p.onClick,R=p.onLoadError,q=p.onLoaderStart,F=p.onNetworksChange,X=p.onConfirm,G=p.onCancel,ee=p.onShippingAddressChange,K=p.onShippingRateChange,ie=vN("mounts <".concat(n,">")),pe="elements"in ie?ie.elements:null,ae="customCheckoutSdk"in ie?ie.customCheckoutSdk:null,_e=je.useState(null),Ee=SK(_e,2),xe=Ee[0],ce=Ee[1],ke=je.useRef(null),ve=je.useRef(null);ya(xe,"blur",C),ya(xe,"focus",k),ya(xe,"escape",B),ya(xe,"click",O),ya(xe,"loaderror",R),ya(xe,"loaderstart",q),ya(xe,"networkschange",F),ya(xe,"confirm",X),ya(xe,"cancel",G),ya(xe,"shippingaddresschange",ee),ya(xe,"shippingratechange",K),ya(xe,"change",I);var Pe;N&&(t==="expressCheckout"?Pe=N:Pe=function(){N(xe)}),ya(xe,"ready",Pe),je.useLayoutEffect(function(){if(ke.current===null&&ve.current!==null&&(pe||ae)){var Be=null;ae?Be=ae.createElement(t,E):pe&&(Be=pe.create(t,E)),ke.current=Be,ce(Be),Be&&Be.mount(ve.current)}},[pe,ae,E]);var Re=yN(E);return je.useEffect(function(){if(ke.current){var Be=EK(E,Re,["paymentRequest"]);Be&&"update"in ke.current&&ke.current.update(Be)}},[E,Re]),je.useLayoutEffect(function(){return function(){if(ke.current&&typeof ke.current.destroy=="function")try{ke.current.destroy(),ke.current=null}catch{}}},[]),je.createElement("div",{id:y,className:b,ref:ve})},s=function(p){vN("mounts <".concat(n,">"));var y=p.id,b=p.className;return je.createElement("div",{id:y,className:b})},h=r?s:o;return h.propTypes={id:lr.string,className:lr.string,onChange:lr.func,onBlur:lr.func,onFocus:lr.func,onReady:lr.func,onEscape:lr.func,onClick:lr.func,onLoadError:lr.func,onLoaderStart:lr.func,onNetworksChange:lr.func,onConfirm:lr.func,onCancel:lr.func,onShippingAddressChange:lr.func,onShippingRateChange:lr.func,options:lr.object},h.displayName=n,h.__elementType=t,h},Ai=typeof window>"u",q5e=je.createContext(null);q5e.displayName="EmbeddedCheckoutProviderContext";var UO=function(){var t=vN("calls useStripe()"),r=t.stripe;return r};Pi("auBankAccount",Ai);var eg=Pi("card",Ai);Pi("cardNumber",Ai);Pi("cardExpiry",Ai);Pi("cardCvc",Ai);Pi("fpxBank",Ai);Pi("iban",Ai);Pi("idealBank",Ai);Pi("p24Bank",Ai);Pi("epsBank",Ai);Pi("payment",Ai);Pi("expressCheckout",Ai);Pi("currencySelector",Ai);Pi("paymentRequestButton",Ai);Pi("linkAuthentication",Ai);Pi("address",Ai);Pi("shippingAddress",Ai);Pi("paymentMethodMessaging",Ai);Pi("affirmMessage",Ai);Pi("afterpayClearpayMessage",Ai);var PK="https://js.stripe.com/v3",W5e=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,pU="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",G5e=function(){for(var t=document.querySelectorAll('script[src^="'.concat(PK,'"]')),r=0;r<t.length;r++){var n=t[r];if(W5e.test(n.src))return n}return null},mU=function(t){var r=t&&!t.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(PK).concat(r);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(n),n},H5e=function(t,r){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:r})},Ov=null,Ew=null,Tw=null,X5e=function(t){return function(){t(new Error("Failed to load Stripe.js"))}},Z5e=function(t,r){return function(){window.Stripe?t(window.Stripe):r(new Error("Stripe.js not available"))}},K5e=function(t){return Ov!==null?Ov:(Ov=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe&&t&&console.warn(pU),window.Stripe){r(window.Stripe);return}try{var o=G5e();if(o&&t)console.warn(pU);else if(!o)o=mU(t);else if(o&&Tw!==null&&Ew!==null){var s;o.removeEventListener("load",Tw),o.removeEventListener("error",Ew),(s=o.parentNode)===null||s===void 0||s.removeChild(o),o=mU(t)}Tw=Z5e(r,n),Ew=X5e(n),o.addEventListener("load",Tw),o.addEventListener("error",Ew)}catch(h){n(h);return}}),Ov.catch(function(r){return Ov=null,Promise.reject(r)}))},Y5e=function(t,r,n){if(t===null)return null;var o=t.apply(void 0,r);return H5e(o,n),o},Dv,AK=!1,kK=function(){return Dv||(Dv=K5e(null).catch(function(t){return Dv=null,Promise.reject(t)}),Dv)};Promise.resolve().then(function(){return kK()}).catch(function(e){AK||console.warn(e)});var VO=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];AK=!0;var o=Date.now();return kK().then(function(s){return Y5e(s,r,o)})};const J5e={getProfile:async e=>{const{data:t,error:r}=await Ve.from("user_profiles").select("*").eq("id",e).single();if(r)throw r;return t},updateProfile:async(e,t)=>{const{data:r,error:n}=await Ve.from("user_profiles").update(t).eq("id",e).select().single();if(n)throw n;return r},getPreferences:async e=>{const{data:t,error:r}=await Ve.from("user_preferences").select("*").eq("user_id",e).single();if(r)throw r;return t},updatePreferences:async(e,t)=>{const{data:r,error:n}=await Ve.from("user_preferences").update(t).eq("user_id",e).select().single();if(n)throw n;return r}},Q5e={getSavedVenues:async e=>{const{data:t,error:r}=await Ve.from("saved_venues").select(`
        *,
        venues (*)
      `).eq("user_id",e);if(r)throw r;return t},saveVenue:async(e,t)=>{const{data:r,error:n}=await Ve.from("saved_venues").insert([{user_id:e,venue_id:t}]).select();if(n)throw n;return r},removeSavedVenue:async(e,t)=>{const{error:r}=await Ve.from("saved_venues").delete().eq("user_id",e).eq("venue_id",t);if(r)throw r}},eFe={getUserBookings:async e=>{const{data:t,error:r}=await Ve.from("bookings").select(`
        *,
        venues (*)
      `).eq("user_id",e).order("booking_date",{ascending:!1});if(r)throw r;return t},createBooking:async e=>{const{data:t,error:r}=await Ve.from("bookings").insert([e]).select();if(r)throw r;return t},updateBookingStatus:async(e,t)=>{const{data:r,error:n}=await Ve.from("bookings").update({status:t}).eq("id",e).select();if(n)throw n;return r},cancelBooking:async e=>{const{data:t,error:r}=await Ve.from("bookings").update({status:"cancelled"}).eq("id",e).select();if(r)throw r;return t},getVenueBookings:async e=>{const{data:t,error:r}=await Ve.from("bookings").select("*, table:venue_tables(*, venue:venues(*))").eq("venue_id",e);if(r)throw r;return t}},tFe=VO("pk_live_51RcBmaD82xmrCdK7zUZNtJKtO1Cx8Vld8hH2sARagshct2ivP38bavj7tP77gIhK8yo4FEwShNPkjX7VRex3rSWw00IYtFuuxt"),qO=async()=>{const{data:{session:e}}=await Ve.auth.getSession();if(!(e!=null&&e.access_token))throw new Error("User not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`}},WO=e=>`https://${"https://agydpkzfucicraedllgl.supabase.co".split("//")[1].split(".")[0]}.functions.supabase.co/${e}`;async function rFe(e){const t=await qO(),r=WO("create-stripe-setup-intent"),n=await fetch(r,{method:"POST",headers:t,body:JSON.stringify({email:e})});if(!n.ok){const s=await n.json();throw new Error(s.error||"Failed to create SetupIntent")}return(await n.json()).clientSecret}async function nFe(e){const t=await qO(),r=WO("stripe-payment-methods"),n=await fetch(`${r}?email=${encodeURIComponent(e)}`,{method:"GET",headers:t});if(!n.ok){const s=await n.json();throw new Error(s.error||"Failed to fetch payment methods")}return(await n.json()).paymentMethods}async function iFe(e){const t=await qO(),r=WO("stripe-payment-methods"),n=await fetch(r,{method:"DELETE",headers:t,body:JSON.stringify({id:e})});if(!n.ok){const o=await n.json();throw new Error(o.error||"Failed to remove payment method")}return!0}async function oFe(e,t,r){console.log(" [ADMIN EMAIL] Starting venue submission notification...");const n="sales@oneeddy.com",o={serviceId:"service_55v7svp",templateId:"template_wh2h7sn",publicKey:"_DltRvDA4UAiyUt1E"};try{console.log(" EmailJS config check:",{serviceId:o.serviceId?"SET":"MISSING",templateId:o.templateId?"SET":"MISSING",publicKey:o.publicKey?"SET":"MISSING"}),!o.serviceId||!o.templateId||o.publicKey;const s=(await Js(()=>Promise.resolve().then(()=>B9),void 0)).default;try{s.init(o.publicKey),console.log(" EmailJS initialized successfully")}catch(b){throw console.error(" EmailJS initialization failed:",b),new Error("Failed to initialize EmailJS")}const h={ownerName:t.full_name,ownerEmail:t.email,ownerPhone:t.phone||"Not provided",venueName:e.name,venueDescription:e.description||"No description provided",venueType:e.type||"Not specified",venueCapacity:e.capacity||"Not specified",venueAddress:`${e.address||"Not provided"}, ${e.city||"Not provided"}, ${e.country||"Not provided"}`,venuePhone:e.contact_phone||"Not provided",priceRange:e.price_range||"Not specified",openingHours:e.opening_hours||"Not provided",applicationDate:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),viewUrl:"http://localhost:5173/admin/venue-approvals",to_email:n,to_name:"VIP Club Admin",from_name:"VIP Club System",reply_to:t.email};console.log(" [VENUE EMAIL] Sending with template data:",{ownerName:h.ownerName,venueName:h.venueName,ownerEmail:h.ownerEmail,viewUrl:h.viewUrl,timestamp:new Date().toISOString()});const i=s.send(o.serviceId,o.templateId,h),p=new Promise((b,_)=>{setTimeout(()=>_(new Error("EmailJS request timed out after 30 seconds")),3e4)}),y=await Promise.race([i,p]);return console.log(" Admin notification sent successfully via EmailJS:",y),{success:!0,result:y}}catch(s){throw console.error(" Error sending admin notification via EmailJS:",s),console.error(" Full error details:",{name:s.name,message:s.message,stack:s.stack}),s}}async function NK(){try{console.log(" Testing EmailJS connectivity...");const e=(await Js(()=>Promise.resolve().then(()=>B9),void 0)).default,t={serviceId:"service_55v7svp",templateId:"template_wh2h7sn",publicKey:"_DltRvDA4UAiyUt1E"};console.log(" Config check:",{serviceId:t.serviceId?"SET":"MISSING",templateId:t.templateId?"SET":"MISSING",publicKey:t.publicKey?"SET":"MISSING"}),!t.serviceId||!t.templateId||t.publicKey,e.init(t.publicKey);const r=[{name:"Common EmailJS fields",data:{email:"sales@oneeddy.com",name:"VIP Club Admin",subject:"EmailJS Connection Test",message:"This is a test message to verify EmailJS connectivity."}},{name:"Standard to/from fields",data:{to:"sales@oneeddy.com",from:"VIP Club Test",subject:"EmailJS Connection Test",message:"This is a test message to verify EmailJS connectivity."}},{name:"User-based fields",data:{user_email:"sales@oneeddy.com",user_name:"VIP Club Admin",subject:"EmailJS Connection Test",message:"This is a test message to verify EmailJS connectivity."}},{name:"Current approach",data:{to_name:"VIP Club Admin",to_email:"sales@oneeddy.com",from_name:"VIP Club Test",reply_to:"noreply@oneeddy.com",subject:"EmailJS Connection Test",message:"This is a test message to verify EmailJS connectivity.",html_message:"<p>This is a <strong>test message</strong> to verify EmailJS connectivity.</p>"}}];for(const n of r)try{console.log(` Trying ${n.name}:`,n.data);const o=await e.send(t.serviceId,t.templateId,n.data);return console.log(` SUCCESS with ${n.name}:`,o),{success:!0,result:o,workingFields:n.name,workingData:n.data}}catch(o){console.log(` Failed with ${n.name}:`,o.message)}throw new Error("All common field variations failed. Check your EmailJS template configuration.")}catch(e){return console.error(" EmailJS connection test failed:",e),{success:!1,error:e.message}}}function aFe(){return D.useEffect(()=>{async function e(){const{data:t,error:r}=await Ve.from("venue_owners").select("*");console.log(t,r)}e()},[]),c.jsx("div",{children:"Check the console for venue owners data."})}const sFe=Object.freeze(Object.defineProperty({__proto__:null,bookingsApi:eFe,createStripeSetupIntent:rFe,default:aFe,listStripePaymentMethods:nFe,notifyAdminOfVenueSubmission:oFe,removeStripePaymentMethod:iFe,savedVenuesApi:Q5e,stripePromise:tFe,testEmailJSConnection:NK,userApi:J5e},Symbol.toStringTag,{value:"Module"})),MK=async e=>{try{console.log(" Sending venue owner application approved email to:",e.email);const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"venue-owner-application-approved",data:{email:e.email,contactName:e.contact_name||e.owner_name,venueName:e.venue_name,venueType:e.venue_type||"Restaurant",venueAddress:e.venue_address,venueCity:e.venue_city,registrationUrl:`${window.location.origin}/venue-owner/register?approved=true&email=${encodeURIComponent(e.email)}`}}});if(r)throw console.error(" Failed to send application approved email:",r),r;return console.log(" Venue owner application approved email sent successfully:",t),t}catch(t){throw console.error(" Error in sendVenueOwnerApplicationApproved:",t),t}},IK=async e=>{try{console.log(" Sending venue owner registration complete email to:",e.email);const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"venue-owner-registration-complete",data:{email:e.email,ownerName:e.owner_name,venueName:e.venue_name,dashboardUrl:`${window.location.origin}/venue-owner/dashboard`,loginUrl:`${window.location.origin}/venue-owner/login`}}});if(r)throw console.error(" Failed to send registration complete email:",r),r;return console.log(" Venue owner registration complete email sent successfully:",t),t}catch(t){throw console.error(" Error in sendVenueOwnerRegistrationComplete:",t),t}},OK=async e=>{try{console.log(" Sending venue owner password reset email to:",e.email);const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"venue-owner-password-reset",data:{email:e.email,ownerName:e.owner_name,venueName:e.venue_name,resetUrl:`${window.location.origin}/venue-owner/reset-password?email=${encodeURIComponent(e.email)}`}}});if(r)throw console.error(" Failed to send password reset email:",r),r;return console.log(" Venue owner password reset email sent successfully:",t),t}catch(t){throw console.error(" Error in sendVenueOwnerPasswordReset:",t),t}},lFe=async e=>{try{console.log(" Sending venue owner email confirmation to:",e.email);const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"venue-owner-email-confirmation",data:{email:e.email,ownerName:e.owner_name,venueName:e.venue_name,confirmationUrl:`${window.location.origin}/venue-owner/confirm-email?email=${encodeURIComponent(e.email)}`}}});if(r)throw console.error(" Failed to send email confirmation:",r),r;return console.log(" Venue owner email confirmation sent successfully:",t),t}catch(t){throw console.error(" Error in sendVenueOwnerEmailConfirmation:",t),t}},DK=async e=>{try{console.log(" Notifying admin of venue owner registration");const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"admin-venue-owner-registration",data:{adminEmail:"sales@oneeddy.com",ownerName:e.owner_name,email:e.email,phone:e.phone,venueName:e.venue_name,venueType:e.venue_type,venueAddress:e.venue_address,venueCity:e.venue_city,adminUrl:`${window.location.origin}/admin/venue-approvals`}}});if(r)throw console.error(" Failed to notify admin:",r),r;return console.log(" Admin notification sent successfully:",t),t}catch(t){throw console.error(" Error in notifyAdminOfVenueOwnerRegistration:",t),t}},cFe=async e=>{try{console.log(" Attempting to send approval email via Edge Function...");const{data:t,error:r}=await Ve.functions.invoke("send-email",{body:{template:"venue-owner-invitation",data:{email:e.email,contactName:e.contact_name||e.owner_name,venueName:e.venue_name,venueType:e.venue_type||"Restaurant",venueAddress:e.venue_address,venueCity:e.venue_city}}});if(r)throw console.warn(" Edge Function failed, trying EmailJS fallback...",r),r;return console.log(" Approval email sent via Edge Function:",t),t}catch{console.log(" Falling back to EmailJS for approval email...");try{const r="service_55v7svp",n={}.VITE_EMAILJS_VENUE_OWNER_APPROVAL_TEMPLATE,o="_DltRvDA4UAiyUt1E";if(!r||!n||!o)throw new Error("EmailJS configuration missing");emailjs.init(o);const s=await emailjs.send(r,n,{email:e.email,to_name:e.contact_name||e.owner_name,from_name:"VIPClub",venue_name:e.venue_name,venue_type:e.venue_type||"Restaurant",venue_address:e.venue_address,venue_city:e.venue_city,owner_name:e.contact_name||e.owner_name,application_date:new Date().toLocaleDateString()});return console.log(" Approval email sent via EmailJS fallback:",s),s}catch(r){throw console.error(" Both Edge Function and EmailJS fallback failed:",r),r}}},RK=async(e="test@example.com")=>{console.log(" Testing venue owner email templates...");const t={email:e,ownerName:"Test Owner",contactName:"Test Contact",phone:"+234 123 456 7890",venueName:"Test Venue",venueType:"Restaurant",venueAddress:"123 Test Street",venueCity:"Lagos"};try{return console.log(" Testing application approved email..."),await MK(t),console.log(" Testing registration complete email..."),await IK(t),console.log(" Testing password reset email..."),await OK(t),console.log(" All venue owner email tests completed successfully!"),{success:!0}}catch(r){return console.error(" Venue owner email test failed:",r),{success:!1,error:r.message}}};typeof window<"u"&&(window.testVenueOwnerEmails=RK);const uFe=Object.freeze(Object.defineProperty({__proto__:null,notifyAdminOfVenueOwnerRegistration:DK,sendApprovalEmailWithFallback:cFe,sendVenueOwnerApplicationApproved:MK,sendVenueOwnerEmailConfirmation:lFe,sendVenueOwnerPasswordReset:OK,sendVenueOwnerRegistrationComplete:IK,testVenueOwnerEmails:RK},Symbol.toStringTag,{value:"Module"})),dFe=()=>{console.log(" VenueOwnerRegister component loaded - this is the CORRECT component");const e=zi();Co();const[t,r]=D.useState(!1),[n,o]=D.useState(null),[s,h]=D.useState(null),[i,p]=D.useState(()=>{const E=localStorage.getItem("venueRegistrationData");return E?JSON.parse(E):{full_name:"",email:"",phone:"",password:"",venue_name:"",venue_description:"",venue_address:"",venue_city:"",venue_country:"",venue_phone:"",venue_email:"",venue_type:"restaurant",opening_hours:"",capacity:"",price_range:"$$"}}),y=async()=>{var E;try{console.log(" Testing Supabase email configuration...");const C="test@example.com",{data:k,error:N}=await Ve.auth.signUp({email:C,password:"testpassword123",options:{emailRedirectTo:`${window.location.origin}/venue-owner/login`}});return N?(console.error(" Supabase email test failed:",N),{success:!1,error:N.message}):(console.log(" Supabase email test successful:",{user:k.user?"User created":"No user",session:k.session?"Session created":"No session",email_confirmed:(E=k.user)!=null&&E.email_confirmed_at?"Already confirmed":"Needs confirmation"}),{success:!0,data:k})}catch(C){return console.error(" Error testing Supabase email:",C),{success:!1,error:C.message}}};D.useEffect(()=>{typeof window<"u"&&(window.testSupabaseEmail=y)},[]),D.useEffect(()=>{localStorage.setItem("venueRegistrationData",JSON.stringify(i))},[i]);const b=E=>{const{name:C,value:k}=E.target;p(N=>({...N,[C]:k}))},_=async E=>{E.preventDefault(),r(!0),o(null),h(null);try{console.log(" Starting venue owner registration process..."),console.log(" Form email:",i.email);const{data:C,error:k}=await Ve.from("venue_owners").select("*").eq("owner_email",i.email).in("status",["pending_owner_signup","active"]);if(console.log(" Existing venues check:",{existingVenues:C,venueCheckError:k}),k)throw k;if(C&&C.length>0){const K=C[0];if(K.status==="active"){console.log(" Venue owner already active, redirecting to login..."),o("Account already exists and is active. Please use the login page to access your dashboard."),setTimeout(()=>{e("/venue-owner/login")},3e3);return}console.log(" Found existing approved venue owner record, creating user account..."),console.log(" Creating user account for approved venue owner..."),console.log(" Email being used for signup:",i.email),console.log(" Redirect URL:",`${window.location.origin}/venue-owner/login`);const{data:ie,error:pe}=await Ve.auth.signUp({email:i.email,password:i.password,options:{emailRedirectTo:`${window.location.origin}/venue-owner/login`,data:{full_name:i.full_name,phone:i.phone,venue_name:K.venue_name}}});if(console.log(" Sign up result:",{user:ie!=null&&ie.user?{id:ie.user.id,email:ie.user.email,email_confirmed_at:ie.user.email_confirmed_at,created_at:ie.user.created_at}:null,session:ie!=null&&ie.session?"Session created":"No session",error:pe}),pe)throw console.error(" User creation failed:",pe),pe;if(!ie.user||!ie.user.id)throw console.error(" No user data returned from signup"),new Error("Failed to create user account");console.log(" User account created successfully:",ie.user.id),await new Promise(ce=>setTimeout(ce,2e3)),console.log(" Verifying automatic venue owner link...");const{data:ae,error:_e}=await Ve.from("venue_owners").select("*").eq("owner_email",i.email).eq("user_id",ie.user.id).eq("status","active").single();if(_e||!ae){console.warn(" Automatic linking may have failed, attempting manual link...");const{error:ce}=await Ve.from("venue_owners").update({user_id:ie.user.id,status:"active",owner_name:i.full_name,owner_phone:i.phone}).eq("owner_email",i.email).eq("status","pending_owner_signup");if(ce)throw console.error(" Manual linking also failed:",ce),ce;console.log(" Manual linking successful")}else console.log(" Automatic linking successful");console.log(" Linking venue to user account...");let{data:Ee,error:xe}=await Ve.from("venues").select("*").eq("id",K.venue_id).single();if(xe&&xe.code==="PGRST116"){console.log(" No venue found by contact_email, trying alternative search...");const{data:ce}=await Ve.from("venue_owners").select("venue_name, owner_email").eq("owner_email",i.email.trim()).eq("status","active").single();if(ce){const{data:ke,error:ve}=await Ve.from("venues").select("*").eq("name",ce.venue_name).ilike("contact_email",i.email.trim()).is("owner_id",null).single();!ve&&ke&&(Ee=ke,xe=null,console.log(" Found venue using alternative search"))}}if(xe){console.error(" Failed to find venue to link:",xe);const{data:ce}=await Ve.from("venues").select("id, name, contact_email, owner_id").ilike("contact_email",`%${i.email.split("@")[0]}%`);throw console.log(" Available venues for debugging:",ce),new Error("Venue not found. Please contact support.")}if(Ee){console.log(" Found venue to link:",Ee.id);const{error:ce}=await Ve.from("venues").update({owner_id:ie.user.id,updated_at:new Date().toISOString()}).eq("id",Ee.id);if(ce)throw console.error(" Failed to update venue owner_id:",ce),ce;console.log(" Venue linked to user account successfully");const{error:ke}=await Ve.from("venue_owners").update({venue_id:Ee.id,updated_at:new Date().toISOString()}).eq("owner_email",i.email.trim()).eq("status","active");ke?console.error(" Failed to update venue_owners with venue_id:",ke):console.log(" Venue owner record updated with venue_id")}else throw console.warn(" No venue found to link - this should not happen"),new Error("Venue linking failed. Please contact support.");try{const ce={email:i.email,owner_name:i.full_name,venue_name:K.venue_name,venue_type:K.venue_type,venue_address:K.venue_address,venue_city:K.venue_city};await DK(ce),console.log(" Admin notification sent successfully")}catch(ce){console.error(" Failed to send admin notification email:",ce)}ie.user&&!ie.user.email_confirmed_at?(console.log(" Email confirmation required for venue owner"),h("Account created successfully! Please check your email and click the confirmation link before logging in.")):h("Account created successfully! You can now log in to manage your venue."),console.log(" Registration completed successfully"),p({full_name:"",email:"",phone:"",password:"",venue_name:"",venue_description:"",venue_address:"",venue_city:"",venue_country:"",venue_phone:"",venue_email:"",venue_type:"restaurant",opening_hours:"",capacity:"",price_range:"$$"}),localStorage.removeItem("venueRegistrationData");return}console.log(" No existing approved record found, creating new pending request..."),console.log(" Creating user account for new venue owner application...");const{data:N,error:I}=await Ve.auth.signUp({email:i.email,password:i.password,options:{emailRedirectTo:`${window.location.origin}/venue-owner/login`,data:{full_name:i.full_name,phone:i.phone,venue_name:i.venue_name}}});if(I){console.error(" User creation failed:",I),o(`Failed to create account: ${I.message}`);return}if(!N.user||!N.user.id){console.error(" No user data returned from signup"),o("Failed to create user account");return}console.log(" User account created successfully:",N.user.id);const{data:B,error:O}=await Ve.from("venue_owners").insert([{user_id:N.user.id,venue_name:i.venue_name,venue_description:i.venue_description,venue_address:i.venue_address,venue_city:i.venue_city,venue_country:i.venue_country,venue_phone:i.phone,owner_name:i.full_name,owner_email:i.email,owner_phone:i.phone,venue_type:i.venue_type,opening_hours:i.opening_hours||"",capacity:i.capacity||"",price_range:i.price_range||"$$",status:"pending_approval"}]).select().single();if(O){console.error(" Venue owner creation failed:",O),o(`Failed to create venue owner record: ${O.message}`);return}console.log(" Venue owner record created successfully");const R={email:i.email,venue_name:i.venue_name,venue_address:i.venue_address,venue_city:i.venue_city,venue_country:i.venue_country,contact_name:i.full_name,contact_phone:i.phone,additional_info:i.venue_description,venue_type:i.venue_type,opening_hours:i.opening_hours,capacity:i.capacity,price_range:i.price_range,status:"pending",user_id:N.user.id},{data:q,error:F}=await Ve.from("pending_venue_owner_requests").insert([R]);F&&console.warn(" Failed to create pending request record:",F);const X="service_55v7svp",G={}.VITE_EMAILJS_VENUE_OWNER_REQUEST_TEMPLATE,ee="_DltRvDA4UAiyUt1E";if(X&&G&&ee)try{Ca.init(ee),await Ca.send(X,G,{email:"info@oneeddy.com",to_name:"Admin",from_name:"Eddys Members",subject:"New Venue Owner Application",ownerName:i.full_name,ownerEmail:i.email,ownerPhone:i.phone,applicationDate:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),venueName:i.venue_name,venueDescription:i.venue_description,venueType:i.venue_type||"Not specified",venueCapacity:i.capacity||"Not specified",venueAddress:i.venue_address,priceRange:i.price_range||"Not specified",openingHours:i.opening_hours||"Not specified",venuePhone:i.phone}),console.log(" Admin notification email sent")}catch(K){console.error(" Failed to send admin notification:",K)}N.user&&!N.user.email_confirmed_at?h("Account created successfully! Please check your email and click the confirmation link to complete your registration. Your venue will be reviewed by our team within 48 hours."):h("Account created successfully! Your venue application has been submitted and will be reviewed by our team within 48 hours.")}catch(C){o(C.message||"An unexpected error occurred."),console.error("Unexpected error:",C)}finally{r(!1)}};return c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsx("div",{className:"container py-8",children:c.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-2xl w-full space-y-8 bg-white p-8 rounded-xl shadow-lg",children:[c.jsxs("div",{className:"text-center",children:[c.jsx(nt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},className:"mx-auto h-12 w-12 bg-brand-burgundy/10 rounded-full flex items-center justify-center",children:c.jsx(dd,{className:"h-6 w-6 text-brand-burgundy"})}),c.jsx("h2",{className:"mt-6 text-3xl font-heading text-brand-burgundy",children:"Register Your Venue"}),c.jsx("p",{className:"mt-2 text-sm text-brand-burgundy/70",children:"Create your venue profile to start managing bookings"}),c.jsx("div",{className:"mt-4 p-4 bg-brand-gold/10 border border-brand-gold/20 rounded-lg",children:c.jsxs("p",{className:"text-sm text-brand-burgundy/80",children:[c.jsx("strong",{children:"How it works:"})," Submit your venue application below. Our team will review it within 48 hours. If approved, you'll receive an email invitation to complete your registration and access your venue dashboard."]})})]}),c.jsxs("form",{className:"mt-8 space-y-6",onSubmit:_,children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-xl font-semibold text-brand-burgundy mb-4",children:"Your Details"}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"full_name",className:"text-brand-burgundy",children:"Full Name"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(ji,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"full_name",name:"full_name",type:"text",required:!0,value:i.full_name,onChange:b,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your full name"})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"email",className:"text-brand-burgundy",children:"Email Address"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(nf,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"email",name:"email",type:"email",required:!0,value:i.email,onChange:b,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your email"})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"password",className:"text-brand-burgundy",children:"Password"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(b1,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"password",name:"password",type:"password",required:!0,value:i.password,onChange:b,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Create a password"})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"phone",className:"text-brand-burgundy",children:"Phone Number"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(of,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"phone",name:"phone",type:"tel",required:!0,value:i.phone,onChange:b,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter contact number"})]})]})]}),c.jsxs("div",{className:"space-y-4 pt-6 border-t border-brand-burgundy/10",children:[c.jsx("h3",{className:"text-xl font-semibold text-brand-burgundy mb-4",children:"Venue Details"}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"venue_name",className:"text-brand-burgundy",children:"Venue Name"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Mc,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"venue_name",name:"venue_name",type:"text",required:!0,value:i.venue_name,onChange:b,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your venue name"})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"venue_description",className:"text-brand-burgundy",children:"Venue Description"}),c.jsx(Tb,{id:"venue_description",name:"venue_description",required:!0,value:i.venue_description,onChange:b,className:"mt-1 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Describe your venue...",rows:4})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"venue_address",className:"text-brand-burgundy",children:"Address"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(oa,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"venue_address",name:"venue_address",type:"text",required:!0,value:i.venue_address,onChange:b,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter venue address"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"venue_city",className:"text-brand-burgundy",children:"City"}),c.jsx(Xt,{id:"venue_city",name:"venue_city",type:"text",required:!0,value:i.venue_city,onChange:b,className:"mt-1 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"e.g., Lagos"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"venue_country",className:"text-brand-burgundy",children:"Country"}),c.jsx(Xt,{id:"venue_country",name:"venue_country",type:"text",required:!0,value:i.venue_country,onChange:b,className:"mt-1 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"e.g., Nigeria"})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"venue_phone",className:"text-brand-burgundy",children:"Venue Phone"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(of,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"venue_phone",name:"venue_phone",type:"tel",required:!0,value:i.venue_phone,onChange:b,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter venue phone"})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"venue_email",className:"text-brand-burgundy",children:"Venue Email"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(nf,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"venue_email",name:"venue_email",type:"email",required:!0,value:i.venue_email,onChange:b,className:"pl-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter venue email"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"capacity",className:"text-brand-burgundy",children:"Capacity (guests)"}),c.jsx(Xt,{id:"capacity",name:"capacity",type:"number",value:i.capacity,onChange:b,className:"mt-1 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"e.g., 100"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"price_range",className:"text-brand-burgundy",children:"Price Range"}),c.jsxs("select",{id:"price_range",name:"price_range",value:i.price_range,onChange:b,className:"mt-1 w-full px-3 py-2 bg-white border border-brand-burgundy/20 rounded-md focus:border-brand-burgundy focus:ring-1 focus:ring-brand-burgundy",children:[c.jsx("option",{value:"$",children:"$ (Budget)"}),c.jsx("option",{value:"$$",children:"$$ (Moderate)"}),c.jsx("option",{value:"$$$",children:"$$$ (Premium)"})]})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"opening_hours",className:"text-brand-burgundy",children:"Opening Hours"}),c.jsx(Xt,{id:"opening_hours",name:"opening_hours",type:"text",value:i.opening_hours,onChange:b,className:"mt-1 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"e.g., Mon-Sun 9AM-11PM"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"venue_type",className:"text-brand-burgundy",children:"Venue Type"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(dd,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsxs("select",{id:"venue_type",name:"venue_type",required:!0,value:i.venue_type,onChange:b,className:"w-full pl-10 pr-3 py-2 bg-white border border-brand-burgundy/20 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-burgundy focus:border-transparent",children:[c.jsx("option",{value:"restaurant",children:"Restaurant"}),c.jsx("option",{value:"bar",children:"Bar"}),c.jsx("option",{value:"club",children:"Club"}),c.jsx("option",{value:"lounge",children:"Lounge"}),c.jsx("option",{value:"other",children:"Other"})]})]})]})]}),c.jsx("div",{children:c.jsxs(Et,{type:"submit",disabled:t,className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:[t?"Registering...":"Register Venue",c.jsx(jl,{className:"ml-2 h-4 w-4"})]})}),n&&c.jsx("div",{className:"text-red-500 mb-2",children:n}),s&&c.jsx("div",{className:"text-green-600 mb-2",children:s})]}),c.jsx("div",{className:"text-center mt-6",children:c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Already have a venue account?"," ",c.jsx(In,{to:"/venue-owner/login",className:"text-brand-burgundy hover:text-brand-gold font-medium",children:"Sign in"})]})})]})})})},gU=()=>{const[e]=Y6(),t=zi(),{toast:r}=Co(),[n,o]=D.useState(!1),[s,h]=D.useState(null),[i,p]=D.useState(!1),[y,b]=D.useState(!1),[_,E]=D.useState(!1),[C,k]=D.useState(null),[N,I]=D.useState(!1),[B,O]=D.useState({password:"",confirmPassword:""});D.useEffect(()=>{const G=e.get("access_token"),ee=e.get("refresh_token"),K=e.get("token"),ie=e.get("type");if(console.log(" Reset password page loaded with params:",{accessToken:G?"Present":"Missing",refreshToken:ee?"Present":"Missing",standardToken:K?"Present":"Missing",type:ie,allParams:Object.fromEntries(e.entries())}),k({accessToken:G?"Present":"Missing",refreshToken:ee?"Present":"Missing",standardToken:K?"Present":"Missing",type:ie,allParams:Object.fromEntries(e.entries())}),K){console.log(" Standard password reset detected"),I(!0);return}if(!G||!ee){console.error(" Missing tokens for password reset"),h("Invalid or missing reset link. Please request a new password reset.");return}(async()=>{try{console.log(" Setting session with tokens...");const{error:ae}=await Ve.auth.setSession({access_token:G,refresh_token:ee});if(ae){console.error(" Session error:",ae),h("Invalid reset link. Please request a new password reset.");return}console.log(" Session set successfully");const{data:{user:_e},error:Ee}=await Ve.auth.getUser();if(Ee||!_e){console.error(" User verification failed:",Ee),h("Unable to verify user. Please request a new password reset.");return}console.log(" User verified:",_e.email)}catch(ae){console.error(" Error setting session:",ae),h("Failed to validate reset link. Please try again.")}})()},[e]);const R=G=>{O({...B,[G.target.name]:G.target.value}),h(null)},q=G=>{const K=/[A-Z]/.test(G),ie=/[a-z]/.test(G),pe=/\d/.test(G),ae=/[!@#$%^&*(),.?":{}|<>]/.test(G),_e=[];return G.length<8&&_e.push("At least 8 characters"),K||_e.push("One uppercase letter"),ie||_e.push("One lowercase letter"),pe||_e.push("One number"),ae||_e.push("One special character"),_e},F=async G=>{if(G.preventDefault(),o(!0),h(null),B.password!==B.confirmPassword){h("Passwords do not match"),o(!1);return}const ee=q(B.password);if(ee.length>0){h(`Password must contain: ${ee.join(", ")}`),o(!1);return}try{let K;if(N){const ie=e.get("token");if(!ie)throw new Error("Missing reset token");const{data:{user:pe},error:ae}=await Ve.auth.getUser();if(ae||!pe){const{error:_e}=await Ve.auth.verifyOtp({token_hash:ie,type:"recovery"});if(_e){h("Invalid or expired reset token. Please request a new password reset."),o(!1);return}}K=await Ve.auth.updateUser({password:B.password})}else K=await Ve.auth.updateUser({password:B.password});if(K.error)throw K.error;p(!0),r({title:"Password Updated",description:"Your password has been successfully updated.",variant:"default"}),setTimeout(()=>{t(N?"/":"/venue-owner/login")},2e3)}catch(K){h(K.message||"Failed to update password"),r({title:"Error",description:K.message||"Failed to update password",variant:"destructive"})}finally{o(!1)}},X=()=>{t(N?"/":"/venue-owner/login")};return i?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:c.jsxs(nt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-lg text-center",children:[c.jsx(nt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},className:"mx-auto h-16 w-16 bg-green-100 rounded-full flex items-center justify-center",children:c.jsx(Dx,{className:"h-8 w-8 text-green-600"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-heading text-gray-900",children:"Password Updated Successfully!"}),c.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Your password has been updated. You will be redirected to the login page shortly."})]}),c.jsxs(Et,{onClick:()=>t(N?"/":"/venue-owner/login"),className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:["Go to Login",c.jsx(jl,{className:"ml-2 h-4 w-4"})]})]})}):c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:c.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-lg",children:[c.jsxs("div",{className:"text-center",children:[c.jsx(nt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},className:"mx-auto h-12 w-12 bg-brand-burgundy/10 rounded-full flex items-center justify-center",children:c.jsx(dd,{className:"h-6 w-6 text-brand-burgundy"})}),c.jsx("h2",{className:"mt-6 text-3xl font-heading text-brand-burgundy",children:"Reset Your Password"}),c.jsx("p",{className:"mt-2 text-sm text-brand-burgundy/70",children:"Enter your new password below"})]}),s&&c.jsx(nt.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 rounded-md p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx(EM,{className:"h-5 w-5 text-red-400 mr-2 mt-0.5"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-red-600",children:s}),c.jsx("button",{onClick:X,className:"text-sm text-red-500 hover:text-red-700 underline mt-1",children:"Request new password reset"})]})]})}),C&&c.jsx(nt.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:c.jsxs("p",{className:"text-xs text-blue-600 font-mono",children:["Debug: ",JSON.stringify(C,null,2)]})}),c.jsxs("form",{className:"mt-8 space-y-6",onSubmit:F,children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"password",className:"text-brand-burgundy",children:"New Password"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(b1,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"password",name:"password",type:y?"text":"password",autoComplete:"new-password",required:!0,value:B.password,onChange:R,className:"pl-10 pr-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your new password"}),c.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>b(!y),children:y?c.jsx(J3,{className:"h-5 w-5 text-brand-burgundy/50"}):c.jsx(x1,{className:"h-5 w-5 text-brand-burgundy/50"})})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"confirmPassword",className:"text-brand-burgundy",children:"Confirm New Password"}),c.jsxs("div",{className:"mt-1 relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(b1,{className:"h-5 w-5 text-brand-burgundy/50"})}),c.jsx(Xt,{id:"confirmPassword",name:"confirmPassword",type:_?"text":"password",autoComplete:"new-password",required:!0,value:B.confirmPassword,onChange:R,className:"pl-10 pr-10 bg-white border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Confirm your new password"}),c.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>E(!_),children:_?c.jsx(J3,{className:"h-5 w-5 text-brand-burgundy/50"}):c.jsx(x1,{className:"h-5 w-5 text-brand-burgundy/50"})})]})]})]}),c.jsx("div",{children:c.jsxs(Et,{type:"submit",className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",disabled:n||!!s,children:[n?"Updating Password...":"Update Password",c.jsx(jl,{className:"ml-2 h-4 w-4"})]})})]}),c.jsx("div",{className:"text-center mt-6",children:c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Remember your password?"," ",c.jsx("button",{onClick:()=>t(N?"/":"/venue-owner/login"),className:"text-brand-burgundy hover:text-brand-gold font-medium",children:"Back to login"})]})})]})})};function hFe(){const e=zi(),{toast:t}=Co(),[r,n]=D.useState(null),[o,s]=D.useState(!0);D.useEffect(()=>{h()},[]);const h=async()=>{try{s(!0);const{data:{user:i},error:p}=await Ve.auth.getUser();if(p)throw p;const{data:y,error:b}=await Ve.from("venues").select("*").eq("owner_id",i.id).single();if(b)throw b;n(y),y.status==="approved"?e("/venue-owner/dashboard"):y.status==="rejected"&&t({title:"Venue Rejected",description:"Your venue application has been rejected. Please contact support for more information.",variant:"destructive"})}catch(i){console.error("Error checking venue status:",i),t({title:"Error",description:"Failed to check venue status",variant:"destructive"})}finally{s(!1)}};return o?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):c.jsx("div",{className:"container mx-auto px-4 py-8",children:c.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[c.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Venue Pending Approval"}),c.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-500 mx-auto mb-4"}),c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Your venue is under review"}),c.jsx("p",{className:"text-gray-600",children:"We're currently reviewing your venue application. This process typically takes 1-2 business days."})]}),r&&c.jsxs("div",{className:"text-left bg-gray-50 p-4 rounded-lg",children:[c.jsx("h3",{className:"font-semibold mb-2",children:"Venue Details:"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Name:"})," ",r.name]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Address:"})," ",r.address]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Type:"})," ",r.type]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Submitted:"})," ",new Date(r.created_at).toLocaleDateString()]})]}),c.jsxs("div",{className:"mt-8",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"We'll send you an email once your venue is approved. You can also check back here for updates."}),c.jsx("button",{onClick:h,className:"mt-4 bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-colors",children:"Check Status"})]})]})]})})}const LK=({currentUser:e})=>{const[t,r]=D.useState([]),[n,o]=D.useState([]),[s,h]=D.useState(!1),[i,p]=D.useState(null),[y,b]=D.useState({table_number:"",capacity:"",price:"",table_type:"",status:"available",venue_id:"",description:""});D.useEffect(()=>{console.log("[TableManagement] currentUser prop:",e)},[e]),D.useEffect(()=>{if(!(e!=null&&e.id))return;(async()=>{console.log("Fetching venues for owner_id:",e.id);const{data:B,error:O}=await Ve.from("venues").select("id, name, owner_id").eq("owner_id",e.id);if(O){Mr({title:"Error",description:O.message,variant:"destructive"}),o([]),r([]);return}console.log("currentUser.id:",e.id),console.log("venuesData:",B),console.log("venuesError:",O),o(B||[]);const R=Array.isArray(B)?B.map(X=>X.id):[];if(!R||R.length===0){r([]);return}const{data:q,error:F}=await Ve.from("venue_tables").select("*").in("venue_id",R);F?(Mr({title:"Error",description:F.message,variant:"destructive"}),r([])):(console.log("tablesData:",q),console.log("tablesError:",F),r(q||[]))})()},[e]);const _=async()=>{if(!y.venue_id){Mr({title:"Error",description:"Please select a venue for this table.",variant:"destructive"});return}if(!y.table_number||!y.capacity||!y.price||!y.table_type||!y.status){Mr({title:"Missing Fields",description:"Please fill all fields",variant:"destructive"});return}const I=parseInt(y.capacity,10),B=parseInt(y.price,10);if(isNaN(I)||isNaN(B)){Mr({title:"Invalid Input",description:"Capacity and Price must be valid numbers.",variant:"destructive"});return}const O={venue_id:y.venue_id,table_number:y.table_number,capacity:I,price:B,table_type:y.table_type,status:y.status,description:y.description};let R;if(i?R=(await Ve.from("venue_tables").update(O).eq("id",i.id)).error:R=(await Ve.from("venue_tables").insert([O])).error,R)Mr({title:"Error",description:`Failed to ${i?"update":"add"} table: ${R.message}`,variant:"destructive"});else{Mr({title:`Table ${i?"Updated":"Added"}`,description:`Table ${i?"updated":"added"} successfully!`}),b({table_number:"",capacity:"",price:"",table_type:"",status:"available",venue_id:"",description:""}),p(null),h(!1);const{data:q}=await Ve.from("venues").select("id").eq("owner_id",e.id),F=q.map(G=>G.id),{data:X}=await Ve.from("venue_tables").select("*").in("venue_id",F);r(X||[])}},E=I=>{p(I),b({table_number:I.table_number,capacity:I.capacity.toString(),price:I.price.toString(),table_type:I.table_type,status:I.status,venue_id:I.venue_id,description:I.description||""}),h(!0)},C=async I=>{if(!confirm("Are you sure you want to delete this table?"))return;const{error:B}=await Ve.from("venue_tables").delete().eq("id",I);if(B)Mr({title:"Error",description:`Failed to delete table: ${B.message}`,variant:"destructive"});else{Mr({title:"Table Deleted",description:"Table deleted successfully!"});const{data:O}=await Ve.from("venues").select("id").eq("owner_id",e.id),R=O.map(F=>F.id),{data:q}=await Ve.from("venue_tables").select("*").in("venue_id",R);r(q||[])}},k=I=>{h(I),I||(p(null),b({table_number:"",capacity:"",price:"",table_type:"",status:"available",venue_id:"",description:""}))},N=I=>{switch(I){case"available":return"bg-green-100 text-green-800";case"booked":return"bg-yellow-100 text-yellow-800";case"maintenance":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return console.log("venues in render:",n),c.jsx("div",{className:"space-y-6",children:c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy",children:"Table Management"}),c.jsxs(gd,{open:s,onOpenChange:k,children:[c.jsx(u9,{asChild:!0,children:c.jsxs(Et,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",title:"Add a new table to your venue",children:[c.jsx(CM,{className:"h-4 w-4 mr-2"}),"Add Table"]})}),c.jsxs(Dc,{className:"sm:max-w-md","aria-describedby":"add-table-desc",children:[c.jsx(Rc,{children:c.jsx(Lc,{children:i?"Edit Table":"Add New Table"})}),c.jsxs("div",{id:"add-table-desc",className:"sr-only",children:["Fill out the form below to ",i?"edit the":"add a new"," table ",i?"":"to your venue","."]}),c.jsxs("div",{className:"space-y-4 py-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(qt,{htmlFor:"tableNumber",children:"Table Number"}),c.jsx(Xt,{id:"tableNumber",value:y.table_number,onChange:I=>b({...y,table_number:I.target.value}),placeholder:"e.g., A1"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(qt,{htmlFor:"capacity",children:"Capacity"}),c.jsx(Xt,{id:"capacity",type:"number",value:y.capacity,onChange:I=>b({...y,capacity:I.target.value}),placeholder:"Number of seats"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(qt,{htmlFor:"price",children:"Price ()"}),c.jsx(Xt,{id:"price",type:"number",value:y.price,onChange:I=>b({...y,price:I.target.value}),placeholder:"Table price"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(qt,{htmlFor:"tableType",children:"Table Type"}),c.jsxs("select",{id:"tableType",value:y.table_type,onChange:I=>b({...y,table_type:I.target.value}),className:"w-full border rounded px-2 py-1",children:[c.jsx("option",{value:"",children:"Select table type"}),c.jsx("option",{value:"standard",children:"Standard"}),c.jsx("option",{value:"vip",children:"VIP"}),c.jsx("option",{value:"booth",children:"Booth"})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(qt,{htmlFor:"description",children:"Description"}),c.jsx(Xt,{id:"description",value:y.description,onChange:I=>b({...y,description:I.target.value}),placeholder:"e.g., Near window, VIP section, Corner booth"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(qt,{htmlFor:"status",children:"Status"}),c.jsxs("select",{id:"status",value:y.status,onChange:I=>b({...y,status:I.target.value}),className:"w-full border rounded px-2 py-1",children:[c.jsx("option",{value:"available",children:"Available"}),c.jsx("option",{value:"booked",children:"Booked"}),c.jsx("option",{value:"maintenance",children:"Maintenance"})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(qt,{htmlFor:"venueId",children:"Venue"}),c.jsxs("select",{id:"venueId",value:y.venue_id,onChange:I=>b({...y,venue_id:I.target.value}),className:"w-full border rounded px-2 py-1",children:[c.jsx("option",{value:"",children:"Select a venue"}),n.map(I=>c.jsx("option",{value:I.id,children:I.name},I.id))]})]}),c.jsx(Et,{className:"w-full bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",onClick:_,children:i?"Update Table":"Add Table"})]})]})]})]}),t.length===0?c.jsx("div",{className:"text-center text-brand-burgundy/70 py-8",children:"No tables yet. Add your first table!"}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(I=>c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsxs(zr,{className:"flex flex-row items-center justify-between pb-2",children:[c.jsxs($r,{className:"text-lg font-semibold text-brand-burgundy",children:["Table ",I.table_number]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Et,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>E(I),children:c.jsx(Oie,{className:"h-4 w-4"})}),c.jsx(Et,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-600",onClick:()=>C(I.id),children:c.jsx(PM,{className:"h-4 w-4"})})]})]}),c.jsx(rr,{children:c.jsxs("div",{className:"space-y-2",children:[I.description&&c.jsx("div",{className:"text-sm text-brand-burgundy/80 italic mb-2",children:I.description}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-brand-burgundy/70",children:"Type:"}),c.jsx("span",{className:"font-medium",children:I.table_type})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-brand-burgundy/70",children:"Capacity:"}),c.jsxs("span",{className:"font-medium",children:[I.capacity," seats"]})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-brand-burgundy/70",children:"Price:"}),c.jsxs("span",{className:"font-medium",children:["",I.price.toLocaleString()]})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-brand-burgundy/70",children:"Status:"}),c.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${N(I.status)}`,children:I.status.charAt(0).toUpperCase()+I.status.slice(1)})]})]})})]},I.id))})]})})},fFe=()=>{const e=zi(),[t,r]=D.useState(null),[n,o]=D.useState({totalBookings:0,totalRevenue:0,averageRating:0,popularTables:[]}),[s,h]=D.useState([]),[i,p]=D.useState([]),[y,b]=D.useState(!0),[_,E]=D.useState(null),[C,k]=D.useState([]),[N,I]=D.useState(null),B=t==null?void 0:t.id,[O,R]=D.useState("");D.useEffect(()=>{q(),X()},[]),D.useEffect(()=>{B&&(async()=>{const{data:ee,error:K}=await Ve.from("venues").select("*").eq("owner_id",N==null?void 0:N.id);if(K)console.error("Error fetching members:",K);else{const ie=Array.from(new Map(ee.map(pe=>[pe.id,pe])).values());k(ie)}})()},[B,N==null?void 0:N.id]);const q=async()=>{try{const{data:{session:G},error:ee}=await Ve.auth.getSession();if(ee)throw ee;if(!G){console.log("No session found, redirecting to login..."),Mr({title:"Authentication Required",description:"Please log in to access the dashboard",variant:"destructive"}),e("/venue-owner/login");return}const{data:{user:K},error:ie}=await Ve.auth.getUser();if(ie)throw ie;const{data:pe,error:ae}=await Ve.from("venue_owners").select("*").eq("user_id",K.id).single();if(ae||!pe){console.log("User is not a venue owner, redirecting to register..."),Mr({title:"Venue Owner Account Required",description:"Please register as a venue owner to access the dashboard",variant:"destructive"}),e("/venue-owner/register");return}F()}catch(G){console.error("Auth check error:",G),E(G.message),Mr({title:"Error",description:"Failed to verify authentication",variant:"destructive"})}},F=async()=>{try{console.log("Fetching venue data..."),b(!0),E(null);const{data:{user:G},error:ee}=await Ve.auth.getUser();if(ee)throw console.error("User fetch error:",ee),ee;I(G),console.log("Current user:",G);const{data:K,error:ie}=await Ve.from("venues").select("*").eq("owner_id",G.id);if(ie)throw console.error("Error fetching venues:",ie),ie;console.log("Venues data:",K);const pe=K&&K.length>0?K[0]:null;r(pe);const ae=K.map(Fe=>Fe.id);let _e=[];if(ae.length>0){const{data:Fe,error:Ge}=await Ve.from("bookings").select("*").in("venue_id",ae);if(Ge)throw console.error("Error fetching bookings:",Ge),Ge;_e=Fe}console.log("Bookings data:",_e);const Ee=_e.length,xe=_e.reduce((Fe,Ge)=>{var Pt;return Fe+(((Pt=Ge.tables)==null?void 0:Pt.price)||0)},0),ce=_e.reduce((Fe,Ge)=>Fe+(Ge.rating||0),0)/Ee||0,ke={};_e.forEach(Fe=>{var Ge;(Ge=Fe.tables)!=null&&Ge.name&&(ke[Fe.tables.name]=(ke[Fe.tables.name]||0)+1)});const ve=Object.entries(ke).map(([Fe,Ge])=>({name:Fe,count:Ge})).sort((Fe,Ge)=>Ge.count-Fe.count).slice(0,5);o({totalBookings:Ee,totalRevenue:xe,averageRating:ce,popularTables:ve});const Pe=_e.sort((Fe,Ge)=>new Date(Ge.created_at)-new Date(Fe.created_at)).slice(0,5);h(Pe);const Be=Array.from({length:7},(Fe,Ge)=>{const Pt=new Date;return Pt.setDate(Pt.getDate()-Ge),Pt.toISOString().split("T")[0]}).reverse().map(Fe=>({date:Fe,bookings:_e.filter(Ge=>Ge.created_at.startsWith(Fe)).length,revenue:_e.filter(Ge=>Ge.created_at.startsWith(Fe)).reduce((Ge,Pt)=>{var $t;return Ge+((($t=Pt.tables)==null?void 0:$t.price)||0)},0)}));p(Be),console.log("Data fetch completed successfully")}catch(G){console.error("Error in fetchVenueData:",G),E(G.message),Mr({title:"Error",description:`Failed to fetch venue data: ${G.message}`,variant:"destructive"})}finally{b(!1)}},X=async()=>{try{const{data:{user:G},error:ee}=await Ve.auth.getUser();if(ee||!G){R("Error fetching user info.");return}const{data:K,error:ie}=await Ve.from("venues").select("id, name").eq("owner_id",G.id);if(ie){R("Error fetching venue.");return}K&&K.length>0?R(`You have successfully logged in to ${K[0].name}`):R("No venue found for this account.")}catch{R("Unexpected error fetching venue.")}};return y?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):_?c.jsx("div",{className:"container mx-auto px-4 py-8",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[c.jsx("h2",{className:"text-red-800 font-semibold mb-2",children:"Error Loading Dashboard"}),c.jsx("p",{className:"text-red-600",children:_}),c.jsx("button",{onClick:F,className:"mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors",children:"Retry"})]})}):!t&&!y?c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[c.jsx("h2",{className:"text-yellow-800 font-semibold mb-2",children:"No Venue Found"}),c.jsx("p",{className:"text-yellow-600",children:"You haven't created a venue yet, or your venue is not associated with your account."}),c.jsx("a",{href:"/venue-owner/register",className:"mt-4 inline-block bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 transition-colors",children:"Create Venue"})]}),c.jsxs("pre",{className:"mt-4 bg-gray-100 p-2 rounded text-xs text-gray-700 overflow-x-auto",children:["Debug Info: userId=",(N==null?void 0:N.id)||"N/A"]})]}):c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsxs("div",{className:"container py-8",children:[O&&c.jsx("div",{className:"mb-6 p-4 rounded bg-green-50 border border-green-200 text-green-800 text-center",children:O}),c.jsxs("div",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-2",children:"Venue Dashboard"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Manage your venue, bookings, and revenue"})]}),c.jsxs("div",{className:"flex gap-4",children:[c.jsxs(Et,{variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",onClick:()=>e("/venue-owner/settings"),children:[c.jsx(Xs,{className:"h-4 w-4 mr-2"}),"Settings"]}),c.jsxs(Et,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:[c.jsx(k8,{className:"h-4 w-4 mr-2"}),"Generate QR Code"]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsxs(zr,{className:"flex flex-row items-center justify-between pb-2",children:[c.jsx($r,{className:"text-sm font-medium text-brand-burgundy/70",children:"Total Revenue"}),c.jsx(rf,{className:"h-4 w-4 text-brand-gold"})]}),c.jsxs(rr,{children:[c.jsxs("div",{className:"text-2xl font-bold text-brand-burgundy",children:["",(n.totalRevenue??0).toLocaleString()]}),c.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"All time earnings"})]})]}),c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsxs(zr,{className:"flex flex-row items-center justify-between pb-2",children:[c.jsx($r,{className:"text-sm font-medium text-brand-burgundy/70",children:"Pending Payouts"}),c.jsx(p2,{className:"h-4 w-4 text-brand-gold"})]}),c.jsxs(rr,{children:[c.jsxs("div",{className:"text-2xl font-bold text-brand-burgundy",children:["",(n.pendingPayouts??0).toLocaleString()]}),c.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"Available for withdrawal"})]})]}),c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsxs(zr,{className:"flex flex-row items-center justify-between pb-2",children:[c.jsx($r,{className:"text-sm font-medium text-brand-burgundy/70",children:"Active Bookings"}),c.jsx(Lo,{className:"h-4 w-4 text-brand-gold"})]}),c.jsxs(rr,{children:[c.jsx("div",{className:"text-2xl font-bold text-brand-burgundy",children:n.activeBookings}),c.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"Current bookings"})]})]}),c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsxs(zr,{className:"flex flex-row items-center justify-between pb-2",children:[c.jsx($r,{className:"text-sm font-medium text-brand-burgundy/70",children:"Total Tables"}),c.jsx(uA,{className:"h-4 w-4 text-brand-gold"})]}),c.jsxs(rr,{children:[c.jsx("div",{className:"text-2xl font-bold text-brand-burgundy",children:n.totalTables}),c.jsx("p",{className:"text-xs text-brand-burgundy/70 mt-1",children:"Available tables"})]})]})]}),c.jsxs(Cd,{defaultValue:"bookings",className:"space-y-4",children:[c.jsxs(Wc,{className:"bg-white p-1 rounded-lg border border-brand-burgundy/10",children:[c.jsxs(vn,{value:"bookings",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[c.jsx(Lo,{className:"h-4 w-4 mr-2"}),"Bookings"]}),c.jsxs(vn,{value:"tables",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[c.jsx(uA,{className:"h-4 w-4 mr-2"}),"Tables"]}),c.jsxs(vn,{value:"analytics",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[c.jsx(jM,{className:"h-4 w-4 mr-2"}),"Analytics"]}),c.jsxs(vn,{value:"staff",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[c.jsx(Bi,{className:"h-4 w-4 mr-2"}),"Staff"]})]}),c.jsx(xn,{value:"bookings",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsx(rr,{className:"pt-6",children:c.jsx(H9,{})})})}),c.jsx(xn,{value:"tables",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsx(rr,{className:"pt-6",children:t&&t.owner_id?c.jsx(LK,{currentUser:{id:t.owner_id}}):c.jsx("div",{className:"text-center text-brand-burgundy/70 py-8",children:"Loading venue info..."})})})}),c.jsx(xn,{value:"analytics",children:c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsx(zr,{children:c.jsx($r,{children:"Revenue Analytics"})}),c.jsx(rr,{children:c.jsx("p",{className:"text-brand-burgundy/70",children:"Loading analytics..."})})]})}),c.jsx(xn,{value:"staff",children:c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsx(zr,{children:c.jsx($r,{children:"Staff Management"})}),c.jsx(rr,{children:c.jsx("p",{className:"text-brand-burgundy/70",children:"Loading staff..."})})]})})]}),c.jsxs(kt,{className:"p-6 mb-8",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Booking Trends"}),c.jsx("div",{className:"h-80",children:c.jsx(cX,{width:"100%",height:"100%",children:c.jsxs(_K,{data:i,children:[c.jsx($O,{strokeDasharray:"3 3"}),c.jsx(t0,{dataKey:"date"}),c.jsx(mf,{yAxisId:"left"}),c.jsx(mf,{yAxisId:"right",orientation:"right"}),c.jsx(Bs,{}),c.jsx(yd,{yAxisId:"left",type:"monotone",dataKey:"bookings",stroke:"#8884d8",name:"Bookings"}),c.jsx(yd,{yAxisId:"right",type:"monotone",dataKey:"revenue",stroke:"#82ca9d",name:"Revenue"})]})})})]}),c.jsxs(kt,{className:"p-6 mb-8",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Popular Tables"}),c.jsx("div",{className:"space-y-4",children:n.popularTables.map((G,ee)=>c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{children:G.name}),c.jsxs("span",{className:"font-semibold",children:[G.count," bookings"]})]},ee))})]}),c.jsxs(kt,{className:"p-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Bookings"}),c.jsx("div",{className:"space-y-4",children:s.map(G=>{var ee,K;return c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:((ee=G.tables)==null?void 0:ee.name)||"Unknown Table"}),c.jsx("p",{className:"text-sm text-gray-500",children:new Date(G.created_at).toLocaleDateString()})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("p",{className:"font-semibold",children:["$",((K=G.tables)==null?void 0:K.price)||0]}),c.jsx("p",{className:"text-sm text-gray-500",children:G.status})]})]},G.id)})})]}),c.jsx(kt,{className:"bg-white border-brand-burgundy/10 mt-8",children:c.jsxs("div",{className:"p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Eddy Members"}),C&&C.length>0?c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{className:"text-left py-2",children:"Name"}),c.jsx("th",{className:"text-left py-2",children:"Credit Balance"})]})}),c.jsx("tbody",{children:C.map(G=>c.jsxs("tr",{children:[c.jsxs("td",{className:"py-2",children:[G.first_name," ",G.last_name]}),c.jsxs("td",{className:"py-2",children:["$",(G.credit_balance??0).toLocaleString()]})]},G.id))})]}):c.jsx("p",{children:"No Eddy Members yet."})]})}),c.jsx(gd,{children:c.jsxs(Dc,{"aria-describedby":"add-table-desc",children:[c.jsx(Rc,{children:c.jsx(Lc,{children:"Add New Table"})}),c.jsx("div",{id:"add-table-desc",className:"sr-only",children:"Fill out the form below to add a new table to your venue."})]})})]})})},pFe=()=>{const[e,t]=D.useState(null),[r,n]=D.useState(!0),o=zi();D.useEffect(()=>{s()},[]);const s=async()=>{try{const{data:{session:h},error:i}=await Ve.auth.getSession();if(i)throw i;if(!h){Mr({title:"Authentication Required",description:"Please log in to access table management",variant:"destructive"}),o("/venue-owner/login");return}const{data:{user:p},error:y}=await Ve.auth.getUser();if(y)throw y;const{data:b,error:_}=await Ve.from("venue_owners").select("*").eq("user_id",p.id).single();if(_||!b){Mr({title:"Venue Owner Account Required",description:"Please register as a venue owner to access table management",variant:"destructive"}),o("/venue-owner/register");return}t(p)}catch(h){console.error("Auth check error:",h),Mr({title:"Error",description:"Failed to verify authentication",variant:"destructive"})}finally{n(!1)}};return r?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsxs("div",{className:"container py-8",children:[c.jsxs("div",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-2",children:"Table Management"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Manage your venue's tables and seating arrangements"})]}),c.jsx(Et,{className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Add New Table"})]}),c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsx(rr,{className:"pt-6",children:e?c.jsx(LK,{currentUser:e}):c.jsx("div",{children:"Loading..."})})})]})})},mFe=()=>{const{toast:e}=Co(),[t,r]=D.useState(!0),[n,o]=D.useState(!1),[s,h]=D.useState([]),[i,p]=D.useState(null),[y,b]=D.useState("thisMonth"),[_,E]=D.useState({totalRevenue:0,totalBookings:0,averageBookingValue:0,confirmedBookings:0,pendingBookings:0,cancelledBookings:0,revenueGrowth:0,bookingGrowth:0,dailyRevenue:[],monthlyRevenue:[],statusBreakdown:{},recentBookings:[]}),C=D.useRef(null),k=D.useRef(null);D.useEffect(()=>(B(),k.current=setInterval(()=>{i&&!n&&(console.log("Auto-refreshing analytics data..."),O(i,!0))},3e4),()=>{N(),k.current&&clearInterval(k.current)}),[]),D.useEffect(()=>{i&&s.length>0&&F()},[s,y,i]);const N=()=>{C.current&&(console.log("Cleaning up real-time subscription..."),C.current.unsubscribe(),C.current=null)},I=async K=>{if(N(),!K||K.length===0){console.log("No venue IDs provided for subscription");return}console.log("Setting up real-time subscription for venues:",K);try{C.current=Ve.channel("venue-bookings-changes").on("postgres_changes",{event:"*",schema:"public",table:"bookings",filter:`venue_id=in.(${K.join(",")})`},ie=>{var pe;console.log("Real-time booking change detected:",ie),ie.eventType==="INSERT"?e({title:"New Booking!",description:`A new booking has been received for ${((pe=ie.new.total_amount)==null?void 0:pe.toLocaleString())||0}`,className:"bg-green-50 border-green-200"}):ie.eventType==="UPDATE"&&ie.new.status!==ie.old.status&&e({title:"Booking Updated",description:`Booking status changed to ${ie.new.status}`,className:"bg-blue-50 border-blue-200"}),setTimeout(()=>{i&&O(i,!0)},1e3)}).subscribe(ie=>{console.log("Subscription status:",ie),ie==="SUBSCRIBED"?(console.log("Successfully subscribed to real-time updates"),e({title:"Live Updates Enabled",description:"Analytics will update automatically when new bookings arrive",className:"bg-green-50 border-green-200"})):ie==="CLOSED"?console.log("Real-time subscription closed"):ie==="CHANNEL_ERROR"&&(console.error("Real-time subscription error"),e({title:"Real-time Updates Unavailable",description:"Analytics will refresh every 30 seconds instead",variant:"destructive"}))})}catch(ie){console.error("Error setting up real-time subscription:",ie),e({title:"Real-time Setup Failed",description:"Using automatic refresh instead",variant:"destructive"})}},B=async()=>{try{const{data:{user:K},error:ie}=await Ve.auth.getUser();if(ie)throw ie;if(!K){e({title:"Authentication Required",description:"Please log in to view analytics",variant:"destructive"});return}p(K),await O(K)}catch(K){console.error("Auth error:",K),e({title:"Error",description:"Failed to authenticate user",variant:"destructive"})}},O=async(K,ie=!1)=>{try{ie||r(!0);const{data:pe,error:ae}=await Ve.from("venues").select("id, name").eq("owner_id",K.id);if(ae)throw ae;if(!pe||pe.length===0){h([]);return}const _e=pe.map(ke=>ke.id);C.current||await I(_e);const Ee=Eh(new Date,6),{data:xe,error:ce}=await Ve.from("bookings").select(`
          id,
          venue_id,
          user_id,
          status,
          total_amount,
          number_of_guests,
          booking_date,
          start_time,
          end_time,
          created_at,
          updated_at,
          venues (
            id,
            name
          )
        `).in("venue_id",_e).gte("created_at",Ee.toISOString()).order("created_at",{ascending:!1});if(ce)throw ce;h(xe||[]),ie||console.log("Analytics data refreshed successfully")}catch(pe){console.error("Error fetching bookings:",pe),ie||e({title:"Error",description:"Failed to load analytics data",variant:"destructive"})}finally{ie||r(!1)}},R=async()=>{o(!0),i&&await O(i),o(!1)},q=()=>{const K=new Date;switch(y){case"thisMonth":return{start:cw(K),end:lw(K)};case"lastMonth":const ie=Eh(K,1);return{start:cw(ie),end:lw(ie)};case"thisWeek":return{start:TC(K),end:jC(K)};case"lastWeek":const pe=Eh(K,1);return{start:TC(pe),end:jC(pe)};default:return{start:cw(K),end:lw(K)}}},F=()=>{const{start:K,end:ie}=q(),pe=s.filter(vt=>{const lt=new Date(vt.booking_date||vt.created_at);return lt>=K&&lt<=ie}),ae=y.includes("Month")?cw(Eh(K,1)):TC(Eh(K,1)),_e=y.includes("Month")?lw(Eh(K,1)):jC(Eh(K,1)),Ee=s.filter(vt=>{const lt=new Date(vt.booking_date||vt.created_at);return lt>=ae&&lt<=_e}),xe=pe.reduce((vt,lt)=>vt+(lt.total_amount||0),0),ce=Ee.reduce((vt,lt)=>vt+(lt.total_amount||0),0),ke=pe.length,ve=Ee.length,Pe=pe.filter(vt=>vt.status==="confirmed").length,Re=pe.filter(vt=>vt.status==="pending").length,Be=pe.filter(vt=>vt.status==="cancelled").length,Fe=pe.filter(vt=>vt.status==="completed").length,Ge=ke>0?xe/ke:0,Pt=ce>0?(xe-ce)/ce*100:xe>0?100:0,$t=ve>0?(ke-ve)/ve*100:ke>0?100:0,Nt=Array.from({length:30},(vt,lt)=>{const it=new Date;return it.setDate(it.getDate()-(29-lt)),it}).map(vt=>{const lt=s.filter(it=>new Date(it.booking_date||it.created_at).toDateString()===vt.toDateString());return{date:q1(vt,"MMM dd"),revenue:lt.reduce((it,ar)=>it+(ar.total_amount||0),0),bookings:lt.length}}),Jt={confirmed:Pe,pending:Re,cancelled:Be,completed:Fe},ft=pe.slice(0,5);E({totalRevenue:xe,totalBookings:ke,averageBookingValue:Ge,confirmedBookings:Pe,pendingBookings:Re,cancelledBookings:Be,revenueGrowth:Pt,bookingGrowth:$t,dailyRevenue:Nt,statusBreakdown:Jt,recentBookings:ft})},X=K=>`${(K||0).toLocaleString()}`,G=K=>K>0?c.jsx(yie,{className:"h-4 w-4 text-green-600"}):K<0?c.jsx(gie,{className:"h-4 w-4 text-red-600"}):c.jsx(Z3,{className:"h-4 w-4 text-gray-400"}),ee=K=>K>0?"text-green-600":K<0?"text-red-600":"text-gray-500";return t?c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsx("div",{className:"container py-8",children:c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold mx-auto mb-4"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Loading analytics..."})]})})})}):c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsxs("div",{className:"container py-8",children:[c.jsxs("div",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-2",children:"Analytics Dashboard"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Track your venue's performance and revenue"})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("select",{value:y,onChange:K=>b(K.target.value),className:"px-3 py-2 border border-brand-burgundy/20 rounded-lg bg-white text-brand-burgundy",children:[c.jsx("option",{value:"thisWeek",children:"This Week"}),c.jsx("option",{value:"lastWeek",children:"Last Week"}),c.jsx("option",{value:"thisMonth",children:"This Month"}),c.jsx("option",{value:"lastMonth",children:"Last Month"})]}),c.jsxs(Et,{onClick:R,disabled:n,variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",children:[c.jsx(Die,{className:`h-4 w-4 mr-2 ${n?"animate-spin":""}`}),"Refresh"]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs(rr,{className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-brand-burgundy/70",children:"Total Revenue"}),c.jsx("p",{className:"text-2xl font-bold text-brand-burgundy",children:X(_.totalRevenue)})]}),c.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:c.jsx(Tie,{className:"h-6 w-6 text-green-600"})})]}),c.jsxs("div",{className:"flex items-center mt-2",children:[G(_.revenueGrowth),c.jsxs("span",{className:`text-sm ml-1 ${ee(_.revenueGrowth)}`,children:[_.revenueGrowth.toFixed(1),"% from last period"]})]})]})}),c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs(rr,{className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-brand-burgundy/70",children:"Total Bookings"}),c.jsx("p",{className:"text-2xl font-bold text-brand-burgundy",children:_.totalBookings})]}),c.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:c.jsx(Lo,{className:"h-6 w-6 text-blue-600"})})]}),c.jsxs("div",{className:"flex items-center mt-2",children:[G(_.bookingGrowth),c.jsxs("span",{className:`text-sm ml-1 ${ee(_.bookingGrowth)}`,children:[_.bookingGrowth.toFixed(1),"% from last period"]})]})]})}),c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs(rr,{className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-brand-burgundy/70",children:"Avg. Booking Value"}),c.jsx("p",{className:"text-2xl font-bold text-brand-burgundy",children:X(_.averageBookingValue)})]}),c.jsx("div",{className:"p-2 bg-yellow-100 rounded-full",children:c.jsx(p2,{className:"h-6 w-6 text-yellow-600"})})]}),c.jsxs("div",{className:"flex items-center mt-2",children:[c.jsx(Z3,{className:"h-4 w-4 text-gray-400"}),c.jsx("span",{className:"text-sm ml-1 text-gray-500",children:"Per booking average"})]})]})}),c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs(rr,{className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-brand-burgundy/70",children:"Confirmed Bookings"}),c.jsx("p",{className:"text-2xl font-bold text-brand-burgundy",children:_.confirmedBookings})]}),c.jsx("div",{className:"p-2 bg-purple-100 rounded-full",children:c.jsx(Bi,{className:"h-6 w-6 text-purple-600"})})]}),c.jsx("div",{className:"flex items-center mt-2",children:c.jsxs("span",{className:"text-sm text-gray-500",children:[_.pendingBookings," pending, ",_.cancelledBookings," cancelled"]})})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs(kt,{className:"lg:col-span-2 bg-white border-brand-burgundy/10",children:[c.jsx(zr,{children:c.jsxs($r,{className:"flex items-center",children:[c.jsx(jM,{className:"h-5 w-5 mr-2"}),"Daily Revenue Trend (Last 30 Days)"]})}),c.jsx(rr,{children:c.jsx("div",{className:"h-64 flex items-end justify-between space-x-1",children:_.dailyRevenue.map((K,ie)=>{const pe=Math.max(..._.dailyRevenue.map(_e=>_e.revenue)),ae=pe>0?K.revenue/pe*100:0;return c.jsxs("div",{className:"flex flex-col items-center flex-1",children:[c.jsx("div",{className:"bg-brand-gold rounded-t w-full min-h-[4px] transition-all duration-300 hover:bg-brand-burgundy",style:{height:`${Math.max(ae,4)}%`},title:`${K.date}: ${X(K.revenue)} (${K.bookings} bookings)`}),c.jsx("span",{className:"text-xs text-brand-burgundy/70 mt-2 rotate-45 origin-top-left",children:K.date})]},ie)})})})]}),c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsx(zr,{children:c.jsx($r,{children:"Booking Status"})}),c.jsxs(rr,{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm text-brand-burgundy/70",children:"Confirmed"}),c.jsx(bn,{className:"bg-green-100 text-green-800",children:_.statusBreakdown.confirmed})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm text-brand-burgundy/70",children:"Pending"}),c.jsx(bn,{className:"bg-yellow-100 text-yellow-800",children:_.statusBreakdown.pending})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm text-brand-burgundy/70",children:"Completed"}),c.jsx(bn,{className:"bg-blue-100 text-blue-800",children:_.statusBreakdown.completed})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm text-brand-burgundy/70",children:"Cancelled"}),c.jsx(bn,{className:"bg-red-100 text-red-800",children:_.statusBreakdown.cancelled})]})]})]})]}),_.recentBookings.length>0&&c.jsxs(kt,{className:"mt-6 bg-white border-brand-burgundy/10",children:[c.jsx(zr,{children:c.jsx($r,{children:"Recent Bookings"})}),c.jsx(rr,{children:c.jsx("div",{className:"space-y-4",children:_.recentBookings.map(K=>{var ie;return c.jsxs("div",{className:"flex items-center justify-between p-4 border border-brand-burgundy/10 rounded-lg",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"h-2 w-2 bg-brand-gold rounded-full"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-brand-burgundy",children:((ie=K.venues)==null?void 0:ie.name)||"Unknown Venue"}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[q1(new Date(K.booking_date||K.created_at),"MMM dd, yyyy"),"  ",K.guest_count," guests"]})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"font-semibold text-brand-burgundy",children:X(K.total_amount)}),c.jsx(bn,{className:K.status==="confirmed"?"bg-green-100 text-green-800":K.status==="pending"?"bg-yellow-100 text-yellow-800":K.status==="cancelled"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800",children:K.status})]})]},K.id)})})})]})]})})};var LE="Switch",[gFe,eVe]=as(LE),[yFe,vFe]=gFe(LE),BK=D.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:o,defaultChecked:s,required:h,disabled:i,value:p="on",onCheckedChange:y,form:b,..._}=e,[E,C]=D.useState(null),k=Kr(t,R=>C(R)),N=D.useRef(!1),I=E?b||!!E.closest("form"):!0,[B,O]=Nc({prop:o,defaultProp:s??!1,onChange:y,caller:LE});return c.jsxs(yFe,{scope:r,checked:B,disabled:i,children:[c.jsx(fr.button,{type:"button",role:"switch","aria-checked":B,"aria-required":h,"data-state":UK(B),"data-disabled":i?"":void 0,disabled:i,value:p,..._,ref:k,onClick:Ht(e.onClick,R=>{O(q=>!q),I&&(N.current=R.isPropagationStopped(),N.current||R.stopPropagation())})}),I&&c.jsx(FK,{control:E,bubbles:!N.current,name:n,value:p,checked:B,required:h,disabled:i,form:b,style:{transform:"translateX(-100%)"}})]})});BK.displayName=LE;var zK="SwitchThumb",$K=D.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,o=vFe(zK,r);return c.jsx(fr.span,{"data-state":UK(o.checked),"data-disabled":o.disabled?"":void 0,...n,ref:t})});$K.displayName=zK;var xFe="SwitchBubbleInput",FK=D.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:n=!0,...o},s)=>{const h=D.useRef(null),i=Kr(h,s),p=EI(r),y=LM(t);return D.useEffect(()=>{const b=h.current;if(!b)return;const _=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(_,"checked").set;if(p!==r&&C){const k=new Event("click",{bubbles:n});C.call(b,r),b.dispatchEvent(k)}},[p,r,n]),c.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...o,tabIndex:-1,ref:i,style:{...o.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});FK.displayName=xFe;function UK(e){return e?"checked":"unchecked"}var VK=BK,bFe=$K;const Ru=je.forwardRef(({className:e,...t},r)=>c.jsx(VK,{className:Cr("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:c.jsx(bFe,{className:Cr("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ru.displayName=VK.displayName;const _Fe=()=>{const e=zi(),{toast:t}=Co(),[r,n]=D.useState(!0),[o,s]=D.useState(!1),[h,i]=D.useState(null),[p,y]=D.useState(null),[b,_]=D.useState([]),[E,C]=D.useState({name:"",description:"",type:"",address:"",city:"",country:"",contact_phone:"",contact_email:"",capacity:"",price_range:"",opening_hours:"",cuisine:[],music:[],ambiance:"",dress_code:""}),[k,N]=D.useState({name:"",email:"",role:"",phone:""}),[I,B]=D.useState(!1),[O,R]=D.useState({email_bookings:!0,email_cancellations:!0,email_payments:!0,sms_bookings:!1,sms_cancellations:!1,daily_summary:!0,weekly_report:!0});D.useEffect(()=>{q()},[]);const q=async()=>{try{const{data:{session:G},error:ee}=await Ve.auth.getSession();if(ee)throw ee;if(!G){t({title:"Authentication Required",description:"Please log in to access settings",variant:"destructive"}),e("/venue-owner/login");return}const{data:{user:K},error:ie}=await Ve.auth.getUser();if(ie)throw ie;const{data:pe,error:ae}=await Ve.from("venue_owners").select("*").eq("user_id",K.id).single();if(ae||!pe){t({title:"Venue Owner Account Required",description:"Please register as a venue owner",variant:"destructive"}),e("/venue-owner/register");return}i(K),await F(K.id)}catch(G){console.error("Auth check error:",G),t({title:"Error",description:"Failed to verify authentication",variant:"destructive"})}},F=async G=>{try{n(!0);const{data:ee,error:K}=await Ve.from("venues").select("*").eq("owner_id",G).single();if(K){console.error("Error fetching venue:",K);return}y(ee),C({name:ee.name||"",description:ee.description||"",type:ee.type||"",address:ee.address||"",city:ee.city||"",country:ee.country||"",contact_phone:ee.contact_phone||"",contact_email:ee.contact_email||"",capacity:ee.capacity||"",price_range:ee.price_range||"",opening_hours:ee.opening_hours||"",cuisine:ee.cuisine||[],music:ee.music||[],ambiance:ee.ambiance||"",dress_code:ee.dress_code||""}),_([{id:1,name:"Manager",email:ee.contact_email,role:"Manager",phone:ee.contact_phone}])}catch(ee){console.error("Error fetching venue data:",ee),t({title:"Error",description:"Failed to load venue data",variant:"destructive"})}finally{n(!1)}},X=async G=>{if(G.preventDefault(),!!p)try{s(!0);const{error:ee}=await Ve.from("venues").update({name:E.name,description:E.description,type:E.type,address:E.address,city:E.city,country:E.country,contact_phone:E.contact_phone,contact_email:E.contact_email,capacity:E.capacity?parseInt(E.capacity):null,price_range:E.price_range,opening_hours:E.opening_hours,ambiance:E.ambiance,dress_code:E.dress_code,updated_at:new Date().toISOString()}).eq("id",p.id);if(ee)throw ee;t({title:"Success!",description:"Venue details updated successfully",className:"bg-green-500 text-white"}),await F(h.id)}catch(ee){console.error("Error updating venue:",ee),t({title:"Error",description:"Failed to update venue details",variant:"destructive"})}finally{s(!1)}};return r?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold"})}):p?c.jsxs("div",{className:"container py-8",children:[c.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-6",children:"Venue Settings"}),c.jsxs(Cd,{defaultValue:"profile",className:"space-y-4",children:[c.jsxs(Wc,{className:"bg-white p-1 rounded-lg border border-brand-burgundy/10 mb-4",children:[c.jsxs(vn,{value:"profile",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[c.jsx(Xs,{className:"h-4 w-4 mr-2"}),"Venue Profile"]}),c.jsxs(vn,{value:"staff",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[c.jsx(Bi,{className:"h-4 w-4 mr-2"}),"Staff Management"]}),c.jsxs(vn,{value:"notifications",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy",children:[c.jsx(Y3,{className:"h-4 w-4 mr-2"}),"Notifications"]})]}),c.jsx(xn,{value:"profile",children:c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsx(zr,{children:c.jsxs($r,{className:"flex items-center",children:[c.jsx(Xs,{className:"h-5 w-5 mr-2"}),"Venue Profile"]})}),c.jsx(rr,{children:c.jsxs("form",{onSubmit:X,className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-semibold text-brand-burgundy",children:"Basic Information"}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"name",children:"Venue Name"}),c.jsx(Xt,{id:"name",value:E.name,onChange:G=>C({...E,name:G.target.value}),placeholder:"Enter venue name"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"type",children:"Venue Type"}),c.jsxs(dc,{value:E.type,onValueChange:G=>C({...E,type:G}),children:[c.jsx(bl,{children:c.jsx(hc,{placeholder:"Select venue type"})}),c.jsxs(_l,{children:[c.jsx(qn,{value:"restaurant",children:"Restaurant"}),c.jsx(qn,{value:"club",children:"Nightclub"}),c.jsx(qn,{value:"lounge",children:"Lounge"}),c.jsx(qn,{value:"bar",children:"Bar"}),c.jsx(qn,{value:"cafe",children:"Cafe"})]})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"description",children:"Description"}),c.jsx(Tb,{id:"description",value:E.description,onChange:G=>C({...E,description:G.target.value}),placeholder:"Describe your venue",rows:3})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"capacity",children:"Capacity"}),c.jsx(Xt,{id:"capacity",type:"number",value:E.capacity,onChange:G=>C({...E,capacity:G.target.value}),placeholder:"Maximum capacity"})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-semibold text-brand-burgundy",children:"Contact & Location"}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"address",children:"Address"}),c.jsx(Tb,{id:"address",value:E.address,onChange:G=>C({...E,address:G.target.value}),placeholder:"Full address",rows:2})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"city",children:"City"}),c.jsx(Xt,{id:"city",value:E.city,onChange:G=>C({...E,city:G.target.value}),placeholder:"City"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"country",children:"Country"}),c.jsx(Xt,{id:"country",value:E.country,onChange:G=>C({...E,country:G.target.value}),placeholder:"Country"})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"contact_phone",children:"Contact Phone"}),c.jsx(Xt,{id:"contact_phone",value:E.contact_phone,onChange:G=>C({...E,contact_phone:G.target.value}),placeholder:"+234 xxx xxx xxxx"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"contact_email",children:"Contact Email"}),c.jsx(Xt,{id:"contact_email",type:"email",value:E.contact_email,onChange:G=>C({...E,contact_email:G.target.value}),placeholder:"contact@venue.com"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"opening_hours",children:"Opening Hours"}),c.jsx(Xt,{id:"opening_hours",value:E.opening_hours,onChange:G=>C({...E,opening_hours:G.target.value}),placeholder:"e.g., Mon-Sun: 6PM - 2AM"})]})]})]}),c.jsx("div",{className:"pt-4 border-t",children:c.jsx(Et,{type:"submit",disabled:o,className:"bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:o?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):c.jsxs(c.Fragment,{children:[c.jsx(n4,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})})]})})]})}),c.jsx(xn,{value:"staff",children:c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsx(zr,{children:c.jsxs($r,{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Bi,{className:"h-5 w-5 mr-2"}),"Staff Management"]}),c.jsxs(Et,{onClick:()=>B(!0),className:"bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:[c.jsx(Fie,{className:"h-4 w-4 mr-2"}),"Add Staff"]})]})}),c.jsxs(rr,{children:[I&&c.jsxs(kt,{className:"mb-6 border border-brand-gold/20",children:[c.jsx(zr,{children:c.jsx($r,{className:"text-lg",children:"Add New Staff Member"})}),c.jsxs(rr,{children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"staff_name",children:"Full Name"}),c.jsx(Xt,{id:"staff_name",value:k.name,onChange:G=>N({...k,name:G.target.value}),placeholder:"Enter staff name"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"staff_email",children:"Email"}),c.jsx(Xt,{id:"staff_email",type:"email",value:k.email,onChange:G=>N({...k,email:G.target.value}),placeholder:"Enter email address"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"staff_phone",children:"Phone"}),c.jsx(Xt,{id:"staff_phone",value:k.phone,onChange:G=>N({...k,phone:G.target.value}),placeholder:"Enter phone number"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"staff_role",children:"Role"}),c.jsxs(dc,{value:k.role,onValueChange:G=>N({...k,role:G}),children:[c.jsx(bl,{children:c.jsx(hc,{placeholder:"Select role"})}),c.jsxs(_l,{children:[c.jsx(qn,{value:"manager",children:"Manager"}),c.jsx(qn,{value:"host",children:"Host"}),c.jsx(qn,{value:"server",children:"Server"}),c.jsx(qn,{value:"bartender",children:"Bartender"}),c.jsx(qn,{value:"security",children:"Security"}),c.jsx(qn,{value:"admin",children:"Admin"})]})]})]})]}),c.jsxs("div",{className:"flex space-x-2 mt-4",children:[c.jsxs(Et,{onClick:()=>{const G={id:Date.now(),...k};_([...b,G]),N({name:"",email:"",role:"",phone:""}),B(!1),t({title:"Success!",description:"Staff member added successfully",className:"bg-green-500 text-white"})},className:"bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:[c.jsx(CM,{className:"h-4 w-4 mr-2"}),"Add Staff"]}),c.jsx(Et,{variant:"outline",onClick:()=>B(!1),children:"Cancel"})]})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-semibold text-brand-burgundy",children:"Current Staff"}),b.length===0?c.jsxs("div",{className:"text-center py-8 text-brand-burgundy/70",children:[c.jsx(Bi,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"No staff members added yet."}),c.jsx("p",{className:"text-sm",children:'Click "Add Staff" to get started.'})]}):c.jsx("div",{className:"grid gap-4",children:b.map(G=>c.jsx(kt,{className:"border border-brand-burgundy/10",children:c.jsx(rr,{className:"p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"h-10 w-10 bg-brand-burgundy/10 rounded-full flex items-center justify-center",children:c.jsx(ji,{className:"h-5 w-5 text-brand-burgundy"})}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-brand-burgundy",children:G.name}),c.jsxs("div",{className:"flex items-center space-x-4 text-sm text-brand-burgundy/70",children:[c.jsxs("span",{className:"flex items-center",children:[c.jsx(nf,{className:"h-3 w-3 mr-1"}),G.email]}),G.phone&&c.jsxs("span",{className:"flex items-center",children:[c.jsx(of,{className:"h-3 w-3 mr-1"}),G.phone]})]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(bn,{variant:"secondary",className:"bg-brand-gold/20 text-brand-burgundy",children:G.role}),c.jsx(Et,{variant:"outline",size:"sm",onClick:()=>{_(b.filter(ee=>ee.id!==G.id)),t({title:"Staff Removed",description:`${G.name} has been removed`})},className:"text-red-600 hover:text-red-700",children:c.jsx(PM,{className:"h-4 w-4"})})]})]})})},G.id))})]})]})]})}),c.jsx(xn,{value:"notifications",children:c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsx(zr,{children:c.jsxs($r,{className:"flex items-center",children:[c.jsx(Y3,{className:"h-5 w-5 mr-2"}),"Notification Preferences"]})}),c.jsx(rr,{children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-brand-burgundy mb-4",children:"Email Notifications"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border border-brand-burgundy/10 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy",children:"New Bookings"}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Get notified when new reservations are made"})]}),c.jsx(Ru,{checked:O.email_bookings,onCheckedChange:G=>R({...O,email_bookings:G})})]}),c.jsxs("div",{className:"flex items-center justify-between p-4 border border-brand-burgundy/10 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy",children:"Cancellations"}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Get notified when bookings are cancelled"})]}),c.jsx(Ru,{checked:O.email_cancellations,onCheckedChange:G=>R({...O,email_cancellations:G})})]}),c.jsxs("div",{className:"flex items-center justify-between p-4 border border-brand-burgundy/10 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy",children:"Payment Confirmations"}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Get notified when payments are processed"})]}),c.jsx(Ru,{checked:O.email_payments,onCheckedChange:G=>R({...O,email_payments:G})})]})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-brand-burgundy mb-4",children:"SMS Notifications"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border border-brand-burgundy/10 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy",children:"New Bookings"}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Get SMS alerts for new reservations"})]}),c.jsx(Ru,{checked:O.sms_bookings,onCheckedChange:G=>R({...O,sms_bookings:G})})]}),c.jsxs("div",{className:"flex items-center justify-between p-4 border border-brand-burgundy/10 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy",children:"Urgent Cancellations"}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Get SMS alerts for last-minute cancellations"})]}),c.jsx(Ru,{checked:O.sms_cancellations,onCheckedChange:G=>R({...O,sms_cancellations:G})})]})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-brand-burgundy mb-4",children:"Reports & Summaries"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border border-brand-burgundy/10 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy",children:"Daily Summary"}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Daily report of bookings and revenue"})]}),c.jsx(Ru,{checked:O.daily_summary,onCheckedChange:G=>R({...O,daily_summary:G})})]}),c.jsxs("div",{className:"flex items-center justify-between p-4 border border-brand-burgundy/10 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy",children:"Weekly Report"}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Comprehensive weekly performance report"})]}),c.jsx(Ru,{checked:O.weekly_report,onCheckedChange:G=>R({...O,weekly_report:G})})]})]})]}),c.jsx("div",{className:"pt-4 border-t",children:c.jsxs(Et,{onClick:()=>{t({title:"Success!",description:"Notification preferences updated successfully",className:"bg-green-500 text-white"})},className:"bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:[c.jsx(n4,{className:"h-4 w-4 mr-2"}),"Save Preferences"]})}),c.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:c.jsxs("div",{className:"flex items-start",children:[c.jsx(nf,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-2"}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-blue-800",children:"Email Service Status"}),c.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Email notifications will be fully functional once SMTP configuration is completed. Currently, booking confirmations are still processed but may use fallback methods."})]})]})})]})})]})})]})]}):c.jsxs("div",{className:"container py-20 text-center",children:[c.jsx("h2",{className:"text-2xl font-bold mb-4",children:"No Venue Found"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"You don't have a venue associated with your account."}),c.jsx(Et,{onClick:()=>e("/venue-owner/register"),children:"Create Venue"})]})},wFe=()=>{console.log(" ADMIN VenueApprovalsPage component loaded - this should ONLY be at /admin/venue-approvals");const[e,t]=D.useState([]),[r,n]=D.useState(!0),[o,s]=D.useState(null),[h,i]=D.useState(!1);D.useEffect(()=>{p()},[]);const p=async()=>{try{const{data:C,error:k}=await Ve.from("pending_venue_owner_requests").select("*").order("created_at",{ascending:!1});if(k)throw k;t(C||[])}catch(C){console.error("Error loading requests:",C)}finally{n(!1)}},y=async C=>{i(!0);try{const k=C.venue_type||"restaurant";console.log(" Venue type from request:",{original:C.venue_type,using:k});const{data:N,error:I}=await Ve.from("venue_owners").select("*").eq("owner_email",C.email).eq("status","pending_approval").single();if(I||!N)throw console.error(" Could not find existing venue owner record:",I),new Error(`Could not find venue owner record for ${C.email}. Make sure they have completed the registration process first.`);console.log(" Found existing venue owner record:",N);const{data:B,error:O}=await Ve.from("venues").insert([{name:C.venue_name,description:C.additional_info,type:k,price_range:C.price_range||"$$",address:C.venue_address,city:C.venue_city,state:C.venue_city,country:C.venue_country,latitude:6.5244,longitude:3.3792,contact_phone:C.contact_phone,contact_email:C.email,owner_id:N.user_id,status:"approved",is_active:!0}]).select().single();if(O)throw O;console.log(" Venue created with owner_id:",B.owner_id);const{error:R}=await Ve.from("venue_owners").update({venue_id:B.id,status:"active"}).eq("id",N.id);if(R)throw R;await Ve.from("pending_venue_owner_requests").update({status:"approved"}).eq("id",C.id);try{const q={email:C.email,contact_name:C.contact_name,owner_name:C.contact_name,venue_name:C.venue_name,venue_type:k,venue_address:C.venue_address,venue_city:C.venue_city},{sendVenueOwnerApplicationApproved:F}=await Js(()=>Promise.resolve().then(()=>uFe),void 0);await F(q),console.log(" Approval notification email sent")}catch(q){console.error(" Failed to send approval email:",q)}await p(),alert(`Venue owner approved successfully! ${C.contact_name} can now access their venue dashboard. The venue "${C.venue_name}" is now live with proper owner linking.`)}catch(k){console.error("Error approving request:",k),alert("Error approving request: "+k.message)}finally{i(!1)}},b=async C=>{i(!0);try{await Ve.from("pending_venue_owner_requests").update({status:"rejected"}).eq("id",C.id),await p(),alert("Request rejected successfully!")}catch(k){console.error("Error rejecting request:",k),alert("Error rejecting request: "+k.message)}finally{i(!1)}},_=C=>{switch(C){case"pending":return c.jsx(bn,{variant:"outline",className:"border-yellow-500 text-yellow-700",children:"Pending"});case"approved":return c.jsx(bn,{variant:"outline",className:"border-green-500 text-green-700",children:"Approved"});case"rejected":return c.jsx(bn,{variant:"outline",className:"border-red-500 text-red-700",children:"Rejected"});default:return c.jsx(bn,{variant:"outline",children:C})}},E=C=>new Date(C).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return r?c.jsx("div",{className:"min-h-screen bg-brand-cream/50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-burgundy mx-auto"}),c.jsx("p",{className:"mt-4 text-brand-burgundy",children:"Loading venue applications..."})]})}):c.jsx("div",{className:"min-h-screen bg-brand-cream/50",children:c.jsxs("div",{className:"container mx-auto py-8 px-4",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"p-3 bg-brand-burgundy/10 rounded-full",children:c.jsx(dd,{className:"h-8 w-8 text-brand-burgundy"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-brand-burgundy",children:"Venue Owner Applications"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Review and manage venue partnership requests"})]})]}),c.jsxs("div",{className:"flex gap-4 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),c.jsxs("span",{children:["Pending: ",e.filter(C=>C.status==="pending").length]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),c.jsxs("span",{children:["Approved: ",e.filter(C=>C.status==="approved").length]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),c.jsxs("span",{children:["Rejected: ",e.filter(C=>C.status==="rejected").length]})]})]})]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:e.map((C,k)=>c.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:k*.1},children:c.jsxs(kt,{className:"h-full hover:shadow-lg transition-shadow",children:[c.jsx(zr,{className:"pb-4",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx($r,{className:"text-lg text-brand-burgundy mb-2",children:C.venue_name}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-brand-burgundy/70",children:[c.jsx(Mc,{className:"h-4 w-4"}),c.jsx("span",{children:C.venue_type||"Restaurant"})]})]}),_(C.status)]})}),c.jsxs(rr,{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsxs("h4",{className:"font-semibold text-brand-burgundy flex items-center gap-2",children:[c.jsx(ji,{className:"h-4 w-4"}),"Owner Details"]}),c.jsxs("div",{className:"space-y-1 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(nf,{className:"h-3 w-3 text-brand-burgundy/50"}),c.jsx("span",{children:C.email})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(of,{className:"h-3 w-3 text-brand-burgundy/50"}),c.jsx("span",{children:C.contact_phone})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ji,{className:"h-3 w-3 text-brand-burgundy/50"}),c.jsx("span",{children:C.contact_name})]})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("h4",{className:"font-semibold text-brand-burgundy flex items-center gap-2",children:[c.jsx(oa,{className:"h-4 w-4"}),"Location"]}),c.jsxs("div",{className:"space-y-1 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(oa,{className:"h-3 w-3 text-brand-burgundy/50"}),c.jsx("span",{children:C.venue_address})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Aie,{className:"h-3 w-3 text-brand-burgundy/50"}),c.jsxs("span",{children:[C.venue_city,", ",C.venue_country]})]})]})]}),C.additional_info&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs("h4",{className:"font-semibold text-brand-burgundy flex items-center gap-2",children:[c.jsx(Q3,{className:"h-4 w-4"}),"Description"]}),c.jsx("p",{className:"text-sm text-brand-burgundy/70 line-clamp-3",children:C.additional_info})]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-brand-burgundy/60",children:[c.jsx(Lo,{className:"h-3 w-3"}),c.jsxs("span",{children:["Applied: ",E(C.created_at)]})]}),c.jsxs("div",{className:"flex gap-2 pt-4 border-t border-brand-burgundy/10",children:[c.jsxs(Et,{variant:"outline",size:"sm",className:"flex-1 border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10",onClick:()=>s(C),children:[c.jsx(x1,{className:"h-4 w-4 mr-2"}),"View Details"]}),C.status==="pending"&&c.jsxs(c.Fragment,{children:[c.jsxs(Et,{size:"sm",className:"flex-1 bg-green-600 hover:bg-green-700 text-white",onClick:()=>y(C),disabled:h,children:[c.jsx(Dx,{className:"h-4 w-4 mr-2"}),h?"Processing...":"Approve"]}),c.jsxs(Et,{size:"sm",variant:"destructive",className:"flex-1",onClick:()=>b(C),disabled:h,children:[c.jsx(w1,{className:"h-4 w-4 mr-2"}),h?"Processing...":"Reject"]})]})]})]})]})},C.id))}),e.length===0&&c.jsxs("div",{className:"text-center py-12",children:[c.jsx(dd,{className:"h-16 w-16 text-brand-burgundy/30 mx-auto mb-4"}),c.jsx("h3",{className:"text-xl font-semibold text-brand-burgundy mb-2",children:"No Applications Yet"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"When venue owners submit applications, they will appear here for review."})]}),o&&c.jsx(gd,{open:!!o,onOpenChange:()=>s(null),children:c.jsxs(Dc,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[c.jsx(Rc,{children:c.jsxs(Lc,{className:"text-xl text-brand-burgundy",children:[o.venue_name," - Application Details"]})}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg",children:[c.jsxs("h3",{className:"font-semibold text-brand-burgundy mb-3 flex items-center gap-2",children:[c.jsx(ji,{className:"h-5 w-5"}),"Owner Information"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Full Name"}),c.jsx("p",{className:"text-brand-burgundy",children:o.contact_name})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Email Address"}),c.jsx("p",{className:"text-brand-burgundy",children:o.email})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Phone Number"}),c.jsx("p",{className:"text-brand-burgundy",children:o.contact_phone})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Application Date"}),c.jsx("p",{className:"text-brand-burgundy",children:E(o.created_at)})]})]})]}),c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg",children:[c.jsxs("h3",{className:"font-semibold text-brand-burgundy mb-3 flex items-center gap-2",children:[c.jsx(Mc,{className:"h-5 w-5"}),"Venue Information"]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Venue Name"}),c.jsx("p",{className:"text-brand-burgundy font-semibold",children:o.venue_name})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Venue Type"}),c.jsx("p",{className:"text-brand-burgundy",children:o.venue_type||"Restaurant"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Description"}),c.jsx("p",{className:"text-brand-burgundy",children:o.additional_info||"No description provided"})]})]})]}),c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg",children:[c.jsxs("h3",{className:"font-semibold text-brand-burgundy mb-3 flex items-center gap-2",children:[c.jsx(oa,{className:"h-5 w-5"}),"Location Details"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Address"}),c.jsx("p",{className:"text-brand-burgundy",children:o.venue_address})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"City"}),c.jsx("p",{className:"text-brand-burgundy",children:o.venue_city})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Country"}),c.jsx("p",{className:"text-brand-burgundy",children:o.venue_country})]})]})]}),c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg",children:[c.jsxs("h3",{className:"font-semibold text-brand-burgundy mb-3 flex items-center gap-2",children:[c.jsx(Q3,{className:"h-5 w-5"}),"Additional Details"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Opening Hours"}),c.jsx("p",{className:"text-brand-burgundy",children:o.opening_hours||"Not specified"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Capacity"}),c.jsx("p",{className:"text-brand-burgundy",children:o.capacity||"Not specified"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-brand-burgundy/70",children:"Price Range"}),c.jsx("p",{className:"text-brand-burgundy",children:o.price_range||"Not specified"})]})]})]}),o.status==="pending"&&c.jsxs("div",{className:"flex gap-3 pt-4 border-t border-brand-burgundy/10",children:[c.jsxs(Et,{className:"flex-1 bg-green-600 hover:bg-green-700 text-white",onClick:()=>{y(o),s(null)},disabled:h,children:[c.jsx(Dx,{className:"h-4 w-4 mr-2"}),h?"Processing...":"Approve Application"]}),c.jsxs(Et,{variant:"destructive",className:"flex-1",onClick:()=>{b(o),s(null)},disabled:h,children:[c.jsx(w1,{className:"h-4 w-4 mr-2"}),h?"Processing...":"Reject Application"]})]})]})]})})]})})},yU=VO("pk_live_51RcBmaD82xmrCdK7zUZNtJKtO1Cx8Vld8hH2sARagshct2ivP38bavj7tP77gIhK8yo4FEwShNPkjX7VRex3rSWw00IYtFuuxt"),SFe=()=>{var ar;console.log(" UserProfilePage component is rendering");const{user:e,signIn:t,signUp:r,signOut:n}=fg();console.log(" Current user:",e);const[o,s]=D.useState(!1),[h,i]=D.useState({email:"",password:""}),[p,y]=D.useState({email:"",password:"",confirm:"",firstName:"",lastName:"",city:"",country:""}),[b,_]=D.useState(null),[E,C]=D.useState(null),[k,N]=D.useState(null),[I,B]=D.useState(null),[O,R]=D.useState([]),[q,F]=D.useState([]),X=zi(),[G,ee]=D.useState(""),[K,ie]=D.useState(!1),[pe,ae]=D.useState({first_name:"",last_name:"",phone_number:"",city:"",country:""}),[_e,Ee]=D.useState([]),[xe,ce]=D.useState([]),[ke,ve]=D.useState(!0),[Pe,Re]=D.useState(null),[Be,Fe]=D.useState(null),[Ge,Pt]=D.useState(null);D.useState(null);const[$t,nr]=D.useState(null),[Nt,Jt]=D.useState(null);D.useEffect(()=>{e&&ft()},[e]),D.useEffect(()=>{if(!e)return;ve(!0),(async()=>{try{const{data:pt,error:Wt}=await Ve.from("split_payment_requests").select("*").eq("requester_id",e.id).order("created_at",{ascending:!1}),{data:cr,error:Gr}=await Ve.from("split_payment_requests").select("*").eq("recipient_id",e.id).order("created_at",{ascending:!1});if(Wt||Gr)throw Wt||Gr;Ee(pt||[]),ce(cr||[]),Re(null),(cr||[]).find(si=>si.status==="pending"&&!si.seen_by_recipient)&&Fe("You have a new split payment request!")}catch{Re("Failed to load split payment requests.")}finally{ve(!1)}})()},[e]);const ft=async()=>{try{let{data:We,error:pt}=await Ve.from("user_profiles").select("*").eq("id",e.id).single();if(pt&&pt.code==="PGRST116"){console.log("Profile not found, attempting to create or update...");const{data:si,error:ki}=await Ve.from("user_profiles").upsert([{id:e.id,first_name:"",last_name:"",phone_number:"",city:"",country:"",credit_balance:0}]).select().single();if(ki){console.error("Error creating/updating profile:",ki);const{data:Hn,error:lo}=await Ve.from("user_profiles").select("*").eq("id",e.id).single();!lo&&Hn&&(B(Hn),ae({first_name:Hn.first_name||"",last_name:Hn.last_name||"",phone_number:Hn.phone_number||"",city:Hn.city||"",country:Hn.country||""}))}else B(si),ae({first_name:si.first_name||"",last_name:si.last_name||"",phone_number:si.phone_number||"",city:si.city||"",country:si.country||""})}else pt?console.error("Profile error:",pt):(B(We),ae({first_name:We.first_name||"",last_name:We.last_name||"",phone_number:We.phone_number||"",city:We.city||"",country:We.country||""}));const{data:Wt,error:cr}=await Ve.from("saved_venues").select(`
          *,
          venues (
            id,
            name,
            type,
            city,
            rating
          )
        `).eq("user_id",e.id);cr?(console.error("Saved venues error:",cr),R([])):R(Wt||[]);const{data:Gr,error:ln}=await Ve.from("bookings").select(`
          *,
          venues (
            id,
            name,
            type,
            city,
            address
          ),
          venue_tables!table_id (
            id,
            table_number
          )
        `).eq("user_id",e.id).order("booking_date",{ascending:!1});ln?(console.error("Bookings error:",ln),F([])):F(Gr||[])}catch(We){console.error("Error loading user data:",We)}},vt=async()=>{try{const{data:We,error:pt}=await Ve.from("user_profiles").update({first_name:pe.first_name,last_name:pe.last_name,phone_number:pe.phone_number,city:pe.city,country:pe.country}).eq("id",e.id).select().single();if(pt)throw pt;B(We),ie(!1),console.log("Profile updated successfully")}catch(We){console.error("Error updating profile:",We)}},lt=async We=>{We.preventDefault();try{const{error:pt}=await t(h);if(pt)throw pt}catch(pt){_(pt.message)}},it=async We=>{if(We.preventDefault(),p.password!==p.confirm){C("Passwords do not match");return}try{const{data:pt,error:Wt}=await Ve.auth.signUp({email:p.email,password:p.password});if(Wt){console.error("Sign up error:",Wt),C(Wt.message);return}const cr=pt.user.id,{error:Gr}=await Ve.from("user_profiles").upsert([{id:cr,first_name:p.firstName,last_name:p.lastName,phone_number:"",city:p.city,country:p.country}]);if(Gr){console.error("Upsert error:",Gr),C(Gr.message);return}}catch(pt){C(pt.message)}};return e?c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsxs("div",{className:"container py-8",children:[c.jsxs("div",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-2",children:"My Profile"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Manage your account and preferences"})]}),c.jsx(Et,{onClick:n,variant:"outline",className:"border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10",children:"Sign Out"})]}),c.jsxs(Cd,{defaultValue:"profile",className:"space-y-4",children:[c.jsxs(Wc,{className:"bg-white p-1 rounded-lg border border-brand-burgundy/10 grid grid-cols-2 md:grid-cols-6 h-auto",children:[c.jsxs(vn,{value:"profile",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[c.jsx(Xs,{className:"h-3 w-3 md:h-4 md:w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Profile"}),c.jsx("span",{className:"sm:hidden",children:"Profile"})]}),c.jsxs(vn,{value:"saved",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[c.jsx(Rx,{className:"h-3 w-3 md:h-4 md:w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Saved"}),c.jsx("span",{className:"sm:hidden",children:"Saved"})]}),c.jsxs(vn,{value:"bookings",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[c.jsx(Lo,{className:"h-3 w-3 md:h-4 md:w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Bookings"}),c.jsx("span",{className:"sm:hidden",children:"Bookings"})]}),c.jsxs(vn,{value:"settings",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[c.jsx(Xs,{className:"h-3 w-3 md:h-4 md:w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Settings"}),c.jsx("span",{className:"sm:hidden",children:"Settings"})]}),c.jsxs(vn,{value:"member",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm col-span-2 md:col-span-1",children:[c.jsx("span",{role:"img","aria-label":"VIP",className:"h-3 w-3 md:h-4 md:w-4 text-xs md:text-sm",children:""}),c.jsx("span",{className:"hidden sm:inline",children:"Member"}),c.jsx("span",{className:"sm:hidden",children:"VIP"})]}),c.jsxs(vn,{value:"split-payments",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[c.jsx(ex,{className:"h-3 w-3 md:h-4 md:w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Split Payments"}),c.jsx("span",{className:"sm:hidden",children:"Split"})]})]}),c.jsx(xn,{value:"profile",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Profile Information"}),I&&!K&&c.jsx(Et,{onClick:()=>ie(!0),variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",children:"Edit Profile"})]}),I?K?c.jsxs("div",{className:"space-y-4 max-w-md",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Email"}),c.jsxs("p",{className:"text-sm text-brand-burgundy/50",children:[e.email," (cannot be changed)"]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"First Name"}),c.jsx(Xt,{value:pe.first_name,onChange:We=>ae(pt=>({...pt,first_name:We.target.value})),placeholder:"Enter first name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Last Name"}),c.jsx(Xt,{value:pe.last_name,onChange:We=>ae(pt=>({...pt,last_name:We.target.value})),placeholder:"Enter last name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Phone Number"}),c.jsx(Xt,{value:pe.phone_number,onChange:We=>ae(pt=>({...pt,phone_number:We.target.value})),placeholder:"Enter phone number"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"City"}),c.jsx(Xt,{value:pe.city,onChange:We=>ae(pt=>({...pt,city:We.target.value})),placeholder:"Enter city"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Country"}),c.jsx(Xt,{value:pe.country,onChange:We=>ae(pt=>({...pt,country:We.target.value})),placeholder:"Enter country"})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Et,{onClick:vt,className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Save Changes"}),c.jsx(Et,{onClick:()=>{ie(!1),ae({first_name:I.first_name||"",last_name:I.last_name||"",phone_number:I.phone_number||"",city:I.city||"",country:I.country||""})},variant:"outline",className:"border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10",children:"Cancel"})]})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Email"}),c.jsx("p",{className:"mt-1",children:e.email})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Name"}),c.jsx("p",{className:"mt-1",children:I.first_name||I.last_name?`${I.first_name} ${I.last_name}`:"Not set"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Phone"}),c.jsx("p",{className:"mt-1",children:I.phone_number||"Not set"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"City"}),c.jsx("p",{className:"mt-1",children:I.city||"Not set"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Country"}),c.jsx("p",{className:"mt-1",children:I.country||"Not set"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Member Since"}),c.jsx("p",{className:"mt-1",children:new Date(I.created_at||e.created_at).toLocaleDateString()})]})]}):c.jsx("p",{children:"Loading profile..."})]})})}),c.jsx(xn,{value:"saved",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Saved Venues"}),O.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:O.map(We=>c.jsxs(kt,{className:"p-4",children:[c.jsx("h3",{className:"font-semibold",children:We.venues.name}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:We.venues.type}),c.jsx(Et,{onClick:async()=>{try{const{error:pt}=await Ve.from("saved_venues").delete().eq("user_id",e.id).eq("venue_id",We.venue_id);if(pt)throw pt;R(Wt=>Wt.filter(cr=>cr.id!==We.id))}catch(pt){console.error("Error removing saved venue:",pt)}},variant:"outline",className:"mt-2 text-red-500 border-red-500 hover:bg-red-50",children:"Remove"})]},We.id))}):c.jsx("p",{children:"No saved venues yet"})]})})}),c.jsx(xn,{value:"bookings",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"My Bookings"}),q.length>0?c.jsx("div",{className:"space-y-4",children:q.map(We=>{var pt;return c.jsx(kt,{className:"p-4",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold",children:((pt=We.venues)==null?void 0:pt.name)||"Venue not found"}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[We.booking_date?new Date(We.booking_date).toLocaleDateString():"Date not set"," at ",We.start_time||"Time not set"]}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[We.number_of_guests||We.guest_count||0," guests"]}),We.venue_tables&&c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Table: ",We.venue_tables.table_number]}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Total: ",(We.total_amount||0).toLocaleString()]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm font-medium text-brand-burgundy",children:We.status?We.status.charAt(0).toUpperCase()+We.status.slice(1):"Unknown"}),(We.status==="confirmed"||We.status==="pending")&&c.jsx(Et,{onClick:async()=>{try{const{error:Wt}=await Ve.from("bookings").update({status:"cancelled",updated_at:new Date().toISOString()}).eq("id",We.id);if(Wt)throw Wt;F(cr=>cr.map(Gr=>Gr.id===We.id?{...Gr,status:"cancelled"}:Gr))}catch(Wt){console.error("Error cancelling booking:",Wt)}},variant:"outline",className:"mt-2 text-red-500 border-red-500 hover:bg-red-50",children:"Cancel"})]})]})},We.id)})}):c.jsx("p",{children:"No bookings yet"})]})})}),c.jsx(xn,{value:"settings",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs("div",{className:"p-2 sm:p-4 md:p-6 space-y-10",children:[c.jsxs("div",{className:"space-y-2 pb-8 border-b border-brand-burgundy/10",children:[c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Change Password"}),c.jsx(EFe,{user:e})]}),c.jsx(qS,{stripe:yU,children:c.jsx("div",{className:"space-y-2 pb-8 border-b border-brand-burgundy/10",children:c.jsx(TFe,{user:e})})}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Referral Codes"}),c.jsx(jFe,{user:e})]})]})})}),c.jsx(xn,{value:"member",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"VIP Member Credit"}),c.jsx("p",{className:"mb-4 text-brand-burgundy/70",children:"Deposit funds to your Eddy account and unlock exclusive VIP perks. The more you deposit, the more power and privileges you get!"}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"text-lg font-bold",children:["Credit Balance: ",c.jsxs("span",{className:"text-brand-gold",children:["$",((ar=I==null?void 0:I.credit_balance)==null?void 0:ar.toLocaleString())??0]})]}),c.jsx("div",{className:"mt-2",children:(I==null?void 0:I.credit_balance)>=1e4?c.jsxs("div",{className:"text-green-700 font-semibold flex items-center",children:[c.jsx("span",{role:"img","aria-label":"butler",className:"mr-2",children:""}),"You have a personal butler! Contact us for your VIP concierge service."]}):c.jsxs("div",{className:"text-brand-burgundy/70",children:["Deposit ",c.jsxs("span",{className:"font-bold",children:["$",(1e4-((I==null?void 0:I.credit_balance)??0)).toLocaleString()]})," more to unlock your personal butler!"]})})]}),c.jsxs("form",{className:"space-y-4 max-w-xs",onSubmit:We=>{We.preventDefault(),!(!G||isNaN(G)||Number(G)<100)&&X("/checkout/deposit",{state:{depositAmount:Number(G)}})},children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Deposit Amount"}),c.jsx("input",{type:"number",min:"100",step:"100",className:"w-full border p-2 rounded bg-white",placeholder:"Enter amount (USD)",value:G,onChange:We=>ee(We.target.value)}),c.jsx(Et,{type:"submit",className:"w-full bg-brand-burgundy text-white",children:"Deposit"})]})]})})}),c.jsx(xn,{value:"split-payments",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Split Payments"}),Be&&c.jsxs("div",{className:"mb-4 p-3 rounded bg-brand-gold/20 text-brand-burgundy flex items-center gap-2",children:[c.jsx(ex,{className:"h-4 w-4"}),Be]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold mb-2",children:"Requests You've Sent"}),ke?c.jsx("p",{children:"Loading..."}):_e.length===0?c.jsx("p",{children:"No sent requests."}):c.jsx("div",{className:"space-y-3",children:_e.map(We=>{var pt;return c.jsx(kt,{className:"p-3 flex flex-col gap-2 border border-brand-burgundy/10",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"font-medium",children:["To: ",We.recipient_phone||We.recipient_id]}),c.jsxs("div",{className:"text-sm text-brand-burgundy/70",children:["Amount: ",(pt=We.amount)==null?void 0:pt.toLocaleString()]}),c.jsxs("div",{className:"text-xs text-brand-burgundy/50",children:["Status: ",We.status]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Et,{size:"icon",variant:"outline",onClick:()=>navigator.clipboard.writeText(We.payment_link),title:"Copy Payment Link",children:c.jsx(wie,{className:"h-4 w-4"})}),We.status==="pending"&&c.jsx(Et,{size:"icon",variant:"outline",onClick:async()=>{await Ve.from("split_payment_requests").update({status:"cancelled"}).eq("id",We.id),Ee(Wt=>Wt.map(cr=>cr.id===We.id?{...cr,status:"cancelled"}:cr))},title:"Cancel",children:c.jsx(w1,{className:"h-4 w-4 text-red-500"})})]})]})},We.id)})})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold mb-2",children:"Requests You've Received"}),ke?c.jsx("p",{children:"Loading..."}):xe.length===0?c.jsx("p",{children:"No received requests."}):c.jsx("div",{className:"space-y-3",children:xe.map(We=>{var pt;return c.jsx(kt,{className:"p-3 flex flex-col gap-2 border border-brand-burgundy/10",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"font-medium",children:["From: ",We.requester_id]}),c.jsxs("div",{className:"text-sm text-brand-burgundy/70",children:["Amount: ",(pt=We.amount)==null?void 0:pt.toLocaleString()]}),c.jsxs("div",{className:"text-xs text-brand-burgundy/50",children:["Status: ",We.status]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Et,{size:"icon",variant:"outline",onClick:()=>navigator.clipboard.writeText(We.payment_link),title:"Copy Payment Link",children:c.jsx(Nie,{className:"h-4 w-4"})}),We.status==="pending"&&c.jsx(Et,{size:"icon",variant:"outline",onClick:()=>Pt(We),title:"Pay",children:c.jsx(ex,{className:"h-4 w-4 text-brand-gold"})}),We.status==="paid"&&Nt&&c.jsx(Et,{size:"sm",variant:"outline",onClick:()=>{},title:"View Booking",children:"View Booking"})]})]})},We.id)})})]})]}),Pe&&c.jsx("div",{className:"text-red-500 mt-4",children:Pe}),Ge&&c.jsx(qS,{stripe:yU,children:c.jsx(CFe,{request:Ge,onClose:()=>Pt(null),onSuccess:async We=>{nr("Payment successful!"),Pt(null),await Ve.from("split_payment_requests").update({status:"paid",stripe_payment_id:We.id}).eq("id",Ge.id),ce(Wt=>Wt.map(cr=>cr.id===Ge.id?{...cr,status:"paid"}:cr));const{data:pt}=await Ve.from("split_payment_requests").select("*").eq("booking_id",Ge.booking_id);if(pt&&pt.every(Wt=>Wt.status==="paid")){await Ve.from("bookings").update({status:"confirmed"}).eq("id",Ge.booking_id);const{data:Wt}=await Ve.from("bookings").select("id, booking_reference").eq("id",Ge.booking_id).single();Jt((Wt==null?void 0:Wt.booking_reference)||(Wt==null?void 0:Wt.id))}}})}),$t&&c.jsxs("div",{className:"mt-4 p-3 rounded bg-green-100 text-green-800",children:[$t," ",Nt&&c.jsxs("span",{children:["Booking Ref: ",c.jsx("span",{className:"font-bold",children:Nt})]})]})]})})})]})]})}):c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsxs("div",{className:"max-w-lg mx-auto mt-16 p-8 bg-white rounded shadow mb-20",children:[c.jsx("h2",{className:"text-2xl font-bold mb-4 text-brand-burgundy",children:o?"Sign Up":"Login to your profile"}),o?c.jsxs("form",{onSubmit:it,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("input",{type:"text",name:"firstName",placeholder:"First Name",value:p.firstName,onChange:We=>y({...p,firstName:We.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),c.jsx("input",{type:"text",name:"lastName",placeholder:"Last Name",value:p.lastName,onChange:We=>y({...p,lastName:We.target.value}),className:"w-full border p-2 rounded bg-white",required:!0})]}),c.jsx("input",{type:"email",name:"email",placeholder:"Email",value:p.email,onChange:We=>y({...p,email:We.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("input",{type:"text",name:"city",placeholder:"City",value:p.city,onChange:We=>y({...p,city:We.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),c.jsx("input",{type:"text",name:"country",placeholder:"Country",value:p.country,onChange:We=>y({...p,country:We.target.value}),className:"w-full border p-2 rounded bg-white",required:!0})]}),c.jsx("input",{type:"password",name:"password",placeholder:"Password",value:p.password,onChange:We=>y({...p,password:We.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),c.jsx("input",{type:"password",name:"confirm",placeholder:"Confirm Password",value:p.confirm,onChange:We=>y({...p,confirm:We.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),E&&c.jsx("div",{className:"text-red-500",children:E}),c.jsx(Et,{type:"submit",className:"w-full bg-brand-burgundy text-white",children:"Sign Up"}),c.jsxs("div",{className:"text-center mt-4",children:[c.jsx("span",{className:"text-brand-burgundy/70",children:"Already have an account? "}),c.jsx("button",{type:"button",onClick:()=>s(!1),className:"font-bold text-brand-burgundy hover:text-brand-burgundy/80 transition-colors",children:"Log In"})]})]}):c.jsxs("form",{onSubmit:lt,className:"space-y-4",children:[c.jsx("input",{type:"email",name:"email",placeholder:"Email",value:h.email,onChange:We=>i({...h,[We.target.name]:We.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),c.jsx("input",{type:"password",name:"password",placeholder:"Password",value:h.password,onChange:We=>i({...h,[We.target.name]:We.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),b&&c.jsx("div",{className:"text-red-500",children:b}),k&&c.jsx("div",{className:"text-green-600",children:k}),c.jsx(Et,{type:"submit",className:"w-full bg-brand-burgundy text-white",children:"Login"}),c.jsx("div",{className:"text-center mt-2",children:c.jsx("button",{type:"button",onClick:async()=>{if(!h.email){_("Please enter your email address first");return}try{const{error:We}=await Ve.auth.resetPasswordForEmail(h.email,{redirectTo:`${window.location.origin}/reset-password`});if(We)throw We;N("Password reset email sent! Check your inbox."),_("")}catch(We){_(We.message||"Failed to send password reset email")}},className:"text-sm text-brand-burgundy hover:text-brand-gold transition-colors",children:"Forgot Password?"})}),c.jsxs("div",{className:"text-center mt-4",children:[c.jsx("span",{className:"text-brand-burgundy/70",children:"Don't have an account? "}),c.jsx("button",{type:"button",onClick:()=>s(!0),className:"font-bold text-brand-burgundy hover:text-brand-burgundy/80 transition-colors",children:"Sign Up"})]})]})]})})};function EFe({user:e}){const[t,r]=D.useState(""),[n,o]=D.useState(""),[s,h]=D.useState(""),[i,p]=D.useState(!1),[y,b]=D.useState(""),[_,E]=D.useState(""),C=async k=>{if(k.preventDefault(),E(""),b(""),!t||!n||!s){E("All fields are required.");return}if(n!==s){E("New passwords do not match.");return}p(!0);try{const{error:N}=await Ve.auth.signInWithPassword({email:e.email,password:t});if(N)throw N;const{error:I}=await Ve.auth.updateUser({password:n});if(I)throw I;b("Password updated successfully!"),r(""),o(""),h("")}catch(N){E(N.message||"Failed to update password.")}finally{p(!1)}};return c.jsxs("form",{onSubmit:C,className:"space-y-4 max-w-md",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Current Password"}),c.jsx("input",{type:"password",className:"w-full border p-2 rounded bg-white",value:t,onChange:k=>r(k.target.value),required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"New Password"}),c.jsx("input",{type:"password",className:"w-full border p-2 rounded bg-white",value:n,onChange:k=>o(k.target.value),required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Confirm New Password"}),c.jsx("input",{type:"password",className:"w-full border p-2 rounded bg-white",value:s,onChange:k=>h(k.target.value),required:!0})]}),_&&c.jsx("div",{className:"text-red-500",children:_}),y&&c.jsx("div",{className:"text-green-600",children:y}),c.jsx("button",{type:"submit",className:"bg-brand-gold text-brand-burgundy px-4 py-2 rounded hover:bg-brand-gold/90",disabled:i,children:i?"Updating...":"Change Password"})]})}function TFe({user:e}){const t=UO(),r=FO(),[n,o]=D.useState(""),[s,h]=D.useState(!1),i=null,p=async y=>{if(y.preventDefault(),o(""),h(!0),!t||!r){o("Stripe is not loaded"),h(!1);return}const b=await t.confirmCardSetup(i,{payment_method:{card:r.getElement(eg),billing_details:{email:e.email}}});b.error?o(b.error.message):o("Payment method saved!"),depositAmount&&e&&await Ve.from("user_profiles").update({credit_balance:Ve.raw("credit_balance + ?",[depositAmount])}).eq("id",e.id),h(!1)};return c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Payment Details"}),c.jsx("p",{className:"text-brand-burgundy/70 mb-2",children:"Your card details are processed securely by Stripe and never touch our servers. You can remove your payment method at any time."}),c.jsxs("form",{onSubmit:p,className:"space-y-4 max-w-md",children:[c.jsx(eg,{options:{hidePostalCode:!0}}),c.jsx("button",{type:"submit",className:"bg-brand-gold text-brand-burgundy px-4 py-2 rounded hover:bg-brand-gold/90",disabled:!t||s,children:s?"Saving...":"Save Payment Method"}),n&&c.jsx("div",{className:"mt-2 text-brand-burgundy",children:n})]}),c.jsx("div",{className:"mt-4 text-xs text-brand-burgundy/60",children:"We comply with GDPR. Your payment data is handled by Stripe and you may request deletion at any time."})]})}function jFe({user:e}){const[t,r]=D.useState(""),[n,o]=D.useState(""),[s,h]=D.useState(!1),[i,p]=D.useState([]),[y,b]=D.useState([]);D.useEffect(()=>{const C=JSON.parse(localStorage.getItem("nightvibe_referral_codes")||"[]");b(C);const k=JSON.parse(localStorage.getItem("lagosvibe_sent_invitations")||"[]");p(k.filter(N=>N.senderEmail===e.email))},[e.email]);const _=async C=>{if(C.preventDefault(),!t||!t.includes("@")){alert("Please enter a valid email address");return}h(!0);try{if(i.find(q=>q.email===t)){alert("You have already sent an invitation to this email address"),h(!1);return}const{data:N,error:I}=await Ve.auth.admin.inviteUserByEmail(t,{redirectTo:`${window.location.origin}/register?referred_by=${e.id}`,data:{referred_by:e.id,referrer_name:e.email.split("@")[0],personal_message:n,invitation_type:"member_referral"}});if(I)throw I;const B={id:Date.now(),email:t,personalMessage:n,senderEmail:e.email,sentAt:new Date().toISOString(),status:"sent"},O=[...i,B];p(O);const R=JSON.parse(localStorage.getItem("lagosvibe_sent_invitations")||"[]");R.push(B),localStorage.setItem("lagosvibe_sent_invitations",JSON.stringify(R)),r(""),o(""),alert("Referral invitation sent successfully!")}catch(k){console.error("Error sending referral:",k),alert("Failed to send referral invitation. Please try again.")}finally{h(!1)}},E=C=>{navigator.clipboard.writeText(C),alert(`Referral code "${C}" copied to clipboard!`)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-3",children:"Invite a Friend"}),c.jsxs("form",{onSubmit:_,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Friend's Email"}),c.jsx("input",{type:"email",className:"w-full border p-2 rounded bg-white border-brand-burgundy/30 focus:border-brand-gold",value:t,onChange:C=>r(C.target.value),placeholder:"friend@example.com",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Personal Message (Optional)"}),c.jsx("textarea",{className:"w-full border p-2 rounded bg-white border-brand-burgundy/30 focus:border-brand-gold",rows:"3",value:n,onChange:C=>o(C.target.value),placeholder:"Tell your friend why they should join VIP Club..."})]}),c.jsx("button",{type:"submit",className:"bg-brand-gold text-brand-burgundy px-4 py-2 rounded hover:bg-brand-gold/90 font-medium",disabled:s,children:s?"Sending...":"Send Invitation"})]})]}),y.length>0&&c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-3",children:"Available Referral Codes"}),c.jsx("div",{className:"space-y-2",children:y.map(C=>c.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded border border-brand-burgundy/20",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-mono font-bold text-brand-burgundy",children:C.code}),c.jsxs("span",{className:"text-sm text-brand-burgundy/70 ml-2",children:["(",C.discount,")"]}),C.perks&&c.jsx("div",{className:"text-xs text-brand-burgundy/60",children:C.perks})]}),c.jsx("button",{onClick:()=>E(C.code),className:"text-brand-gold hover:text-brand-burgundy text-sm font-medium",children:"Copy"})]},C.id))})]}),i.length>0&&c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-3",children:"Sent Invitations"}),c.jsx("div",{className:"space-y-2",children:i.map(C=>c.jsxs("div",{className:"bg-white p-3 rounded border border-brand-burgundy/20",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"font-medium text-brand-burgundy",children:C.email}),c.jsx("span",{className:"text-xs text-brand-burgundy/60",children:new Date(C.sentAt).toLocaleDateString()})]}),C.personalMessage&&c.jsxs("div",{className:"text-sm text-brand-burgundy/70 mt-1",children:['"',C.personalMessage,'"']})]},C.id))})]}),i.length===0&&c.jsx("div",{className:"text-center text-brand-burgundy/60 py-4",children:c.jsx("p",{children:"No referral invitations sent yet. Invite your friends to earn rewards!"})})]})}function CFe({request:e,onClose:t,onSuccess:r}){var b;const n=UO(),o=FO(),[s,h]=D.useState(!1),[i,p]=D.useState(null),y=async _=>{_.preventDefault(),h(!0),p(null);try{const E=await fetch("/api/create-split-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:e.amount,requestId:e.id})}),{clientSecret:C}=await E.json();if(!C)throw new Error("Failed to get payment secret");const k=await n.confirmCardPayment(C,{payment_method:{card:o.getElement(eg)}});k.error?p(k.error.message):k.paymentIntent.status==="succeeded"&&r(k.paymentIntent)}catch(E){p(E.message)}finally{h(!1)}};return c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full relative",children:[c.jsx("button",{className:"absolute top-2 right-2",onClick:t,children:c.jsx(w1,{className:"h-5 w-5 text-red-500"})}),c.jsx("h2",{className:"text-lg font-bold mb-4",children:"Pay Split Payment"}),c.jsxs("form",{onSubmit:y,className:"space-y-4",children:[c.jsxs("div",{children:["Amount: ",c.jsxs("span",{className:"font-semibold",children:["",(b=e.amount)==null?void 0:b.toLocaleString()]})]}),c.jsx(eg,{className:"p-2 border rounded"}),i&&c.jsx("div",{className:"text-red-500 text-sm",children:i}),c.jsx(Et,{type:"submit",className:"w-full bg-brand-burgundy text-white",disabled:s,children:s?"Processing...":"Pay Now"})]})]})})}const PFe=()=>(console.log(" ProfilePage wrapper is rendering"),c.jsx(SFe,{})),AFe=()=>{const[e,t]=D.useState([]),[r,n]=D.useState(!0),[o,s]=D.useState(null);D.useEffect(()=>{h()},[]);const h=async()=>{try{const{data:{user:b},error:_}=await Ve.auth.getUser();if(_||!b){n(!1);return}s(b),await i(b.id)}catch(b){console.error("Error checking auth:",b),n(!1)}},i=async b=>{try{n(!0);const{data:_,error:E}=await Ve.from("bookings").select(`
          *,
          venues (
            id,
            name,
            address,
            city,
            type
          ),
          venue_tables!table_id (
            id,
            table_number
          )
        `).eq("user_id",b).order("booking_date",{ascending:!1});if(E)throw E;t(_||[])}catch(_){console.error("Error fetching bookings:",_),Mr({title:"Error",description:"Failed to load your bookings",variant:"destructive"})}finally{n(!1)}},p=async b=>{try{const{error:_}=await Ve.from("bookings").update({status:"cancelled",updated_at:new Date().toISOString()}).eq("id",b);if(_)throw _;t(E=>E.map(C=>C.id===b?{...C,status:"cancelled"}:C)),Mr({title:"Success",description:"Booking cancelled successfully",className:"bg-green-500 text-white"})}catch(_){console.error("Error cancelling booking:",_),Mr({title:"Error",description:"Failed to cancel booking",variant:"destructive"})}},y=b=>{switch(b){case"confirmed":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"completed":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return r?c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsx("div",{className:"container py-8",children:c.jsx("div",{className:"max-w-4xl mx-auto",children:c.jsx("div",{className:"flex items-center justify-center p-8",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold"})})})})}):o?c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsx("div",{className:"container py-8",children:c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-8",children:[c.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy",children:"My Bookings"}),c.jsx(Et,{onClick:()=>i(o.id),variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",children:"Refresh"})]}),e.length===0?c.jsx(kt,{className:"bg-white border-brand-burgundy/10 text-center p-8",children:c.jsxs(rr,{children:[c.jsx("h2",{className:"text-xl font-semibold text-brand-burgundy mb-4",children:"No Bookings Yet"}),c.jsx("p",{className:"text-brand-burgundy/70 mb-6",children:"You haven't made any bookings yet. Start exploring our venues!"}),c.jsx(Et,{onClick:()=>window.location.href="/venues",className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Browse Venues"})]})}):c.jsx("div",{className:"space-y-6",children:e.map(b=>{var _,E;return c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsxs(zr,{className:"flex flex-row items-center justify-between pb-2",children:[c.jsx($r,{className:"text-xl font-semibold text-brand-burgundy",children:((_=b.venues)==null?void 0:_.name)||"Unknown Venue"}),c.jsx(bn,{className:y(b.status),children:b.status})]}),c.jsxs(rr,{children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center text-brand-burgundy/70",children:[c.jsx(Lo,{className:"h-4 w-4 mr-2"}),q1(new Date(b.booking_date),"EEEE, MMMM d, yyyy")]}),c.jsxs("div",{className:"flex items-center text-brand-burgundy/70",children:[c.jsx(wd,{className:"h-4 w-4 mr-2"}),b.start_time," - ",b.end_time]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center text-brand-burgundy/70",children:[c.jsx(oa,{className:"h-4 w-4 mr-2"}),((E=b.venues)==null?void 0:E.city)||"Unknown Location"]}),c.jsxs("div",{className:"flex items-center text-brand-burgundy/70",children:[c.jsx(Bi,{className:"h-4 w-4 mr-2"}),b.number_of_guests," ",b.number_of_guests===1?"Guest":"Guests"]})]})]}),b.venue_tables&&c.jsx("div",{className:"mt-4 pt-4 border-t border-brand-burgundy/10",children:c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Table: ",b.venue_tables.table_number]})}),c.jsx("div",{className:"mt-4 pt-4 border-t border-brand-burgundy/10",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:"Total Amount"}),c.jsxs("p",{className:"text-lg font-semibold text-brand-burgundy",children:["",(b.total_amount||0).toLocaleString()]})]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx(Et,{variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",onClick:()=>{Mr({title:"Booking Details",description:`Booking ID: ${b.id}`})},children:"View Details"}),(b.status==="pending"||b.status==="confirmed")&&c.jsx(Et,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-50",onClick:()=>p(b.id),children:"Cancel Booking"})]})]})})]})]},b.id)})})]})})}):c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsx("div",{className:"container py-8",children:c.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[c.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-4",children:"My Bookings"}),c.jsx("p",{className:"text-brand-burgundy/70 mb-6",children:"Please log in to view your bookings."}),c.jsx(Et,{onClick:()=>window.location.href="/register",className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Log In"})]})})})},kFe=VO("pk_live_51RcBmaD82xmrCdK7zUZNtJKtO1Cx8Vld8hH2sARagshct2ivP38bavj7tP77gIhK8yo4FEwShNPkjX7VRex3rSWw00IYtFuuxt"),NFe=()=>{var xe;const{user:e,signIn:t,signUp:r,signOut:n}=fg(),[o,s]=D.useState(!1),[h,i]=D.useState({email:"",password:""}),[p,y]=D.useState({email:"",password:"",confirm:"",firstName:"",lastName:"",city:"",country:""}),[b,_]=D.useState(null),[E,C]=D.useState(null),[k,N]=D.useState(null),[I,B]=D.useState([]),[O,R]=D.useState([]),q=zi(),[F,X]=D.useState(""),[G,ee]=D.useState(!1),[K,ie]=D.useState({first_name:"",last_name:"",phone_number:"",city:"",country:""});D.useEffect(()=>{e&&pe()},[e]);const pe=async()=>{try{let{data:ce,error:ke}=await Ve.from("user_profiles").select("*").eq("id",e.id).single();if(ke&&ke.code==="PGRST116"){console.log("Profile not found, attempting to create or update...");const{data:Fe,error:Ge}=await Ve.from("user_profiles").upsert([{id:e.id,first_name:"",last_name:"",phone_number:"",city:"",country:"",credit_balance:0}]).select().single();if(Ge){console.error("Error creating/updating profile:",Ge);const{data:Pt,error:$t}=await Ve.from("user_profiles").select("*").eq("id",e.id).single();!$t&&Pt&&(N(Pt),ie({first_name:Pt.first_name||"",last_name:Pt.last_name||"",phone_number:Pt.phone_number||"",city:Pt.city||"",country:Pt.country||""}))}else N(Fe),ie({first_name:Fe.first_name||"",last_name:Fe.last_name||"",phone_number:Fe.phone_number||"",city:Fe.city||"",country:Fe.country||""})}else ke?console.error("Profile error:",ke):(N(ce),ie({first_name:ce.first_name||"",last_name:ce.last_name||"",phone_number:ce.phone_number||"",city:ce.city||"",country:ce.country||""}));const{data:ve,error:Pe}=await Ve.from("saved_venues").select(`
          *,
          venues (
            id,
            name,
            type,
            city,
            rating
          )
        `).eq("user_id",e.id);Pe?(console.error("Saved venues error:",Pe),B([])):B(ve||[]);const{data:Re,error:Be}=await Ve.from("bookings").select(`
          *,
          venues (
            id,
            name,
            type,
            city,
            address
          ),
          venue_tables!table_id (
            id,
            table_number
          )
        `).eq("user_id",e.id).order("booking_date",{ascending:!1});Be?(console.error("Bookings error:",Be),R([])):R(Re||[])}catch(ce){console.error("Error loading user data:",ce)}},ae=async()=>{try{const{data:ce,error:ke}=await Ve.from("user_profiles").update({first_name:K.first_name,last_name:K.last_name,phone_number:K.phone_number,city:K.city,country:K.country}).eq("id",e.id).select().single();if(ke)throw ke;N(ce),ee(!1),console.log("Profile updated successfully")}catch(ce){console.error("Error updating profile:",ce)}},_e=async ce=>{ce.preventDefault();try{const{error:ke}=await t(h);if(ke)throw ke}catch(ke){_(ke.message)}},Ee=async ce=>{if(ce.preventDefault(),p.password!==p.confirm){C("Passwords do not match");return}try{const{data:ke,error:ve}=await Ve.auth.signUp({email:p.email,password:p.password});if(ve){console.error("Sign up error:",ve),C(ve.message);return}const Pe=ke.user.id,{error:Re}=await Ve.from("user_profiles").upsert([{id:Pe,first_name:p.firstName,last_name:p.lastName,phone_number:"",city:p.city,country:p.country}]);if(Re){console.error("Upsert error:",Re),C(Re.message);return}}catch(ke){C(ke.message)}};return e?c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsxs("div",{className:"container py-8",children:[c.jsxs("div",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-2",children:"My Profile"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Manage your account and preferences"})]}),c.jsx(Et,{onClick:n,variant:"outline",className:"border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10",children:"Sign Out"})]}),c.jsxs(Cd,{defaultValue:"profile",className:"space-y-4",children:[c.jsxs(Wc,{className:"bg-white p-1 rounded-lg border border-brand-burgundy/10 grid grid-cols-2 md:grid-cols-5 h-auto",children:[c.jsxs(vn,{value:"profile",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[c.jsx(Xs,{className:"h-3 w-3 md:h-4 md:w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Profile"}),c.jsx("span",{className:"sm:hidden",children:"Profile"})]}),c.jsxs(vn,{value:"saved",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[c.jsx(Rx,{className:"h-3 w-3 md:h-4 md:w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Saved"}),c.jsx("span",{className:"sm:hidden",children:"Saved"})]}),c.jsxs(vn,{value:"bookings",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[c.jsx(Lo,{className:"h-3 w-3 md:h-4 md:w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Bookings"}),c.jsx("span",{className:"sm:hidden",children:"Bookings"})]}),c.jsxs(vn,{value:"settings",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm",children:[c.jsx(Xs,{className:"h-3 w-3 md:h-4 md:w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Settings"}),c.jsx("span",{className:"sm:hidden",children:"Settings"})]}),c.jsxs(vn,{value:"member",className:"data-[state=active]:bg-brand-gold data-[state=active]:text-brand-burgundy flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2 p-2 md:p-3 text-xs md:text-sm col-span-2 md:col-span-1",children:[c.jsx("span",{role:"img","aria-label":"VIP",className:"h-3 w-3 md:h-4 md:w-4 text-xs md:text-sm",children:""}),c.jsx("span",{className:"hidden sm:inline",children:"Member"}),c.jsx("span",{className:"sm:hidden",children:"VIP"})]})]}),c.jsx(xn,{value:"profile",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Profile Information"}),k&&!G&&c.jsx(Et,{onClick:()=>ee(!0),variant:"outline",className:"border-brand-gold text-brand-gold hover:bg-brand-gold/10",children:"Edit Profile"})]}),k?G?c.jsxs("div",{className:"space-y-4 max-w-md",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Email"}),c.jsxs("p",{className:"text-sm text-brand-burgundy/50",children:[e.email," (cannot be changed)"]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"First Name"}),c.jsx(Xt,{value:K.first_name,onChange:ce=>ie(ke=>({...ke,first_name:ce.target.value})),placeholder:"Enter first name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Last Name"}),c.jsx(Xt,{value:K.last_name,onChange:ce=>ie(ke=>({...ke,last_name:ce.target.value})),placeholder:"Enter last name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Phone Number"}),c.jsx(Xt,{value:K.phone_number,onChange:ce=>ie(ke=>({...ke,phone_number:ce.target.value})),placeholder:"Enter phone number"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"City"}),c.jsx(Xt,{value:K.city,onChange:ce=>ie(ke=>({...ke,city:ce.target.value})),placeholder:"Enter city"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70 mb-1",children:"Country"}),c.jsx(Xt,{value:K.country,onChange:ce=>ie(ke=>({...ke,country:ce.target.value})),placeholder:"Enter country"})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Et,{onClick:ae,className:"bg-brand-gold text-brand-burgundy hover:bg-brand-gold/90",children:"Save Changes"}),c.jsx(Et,{onClick:()=>{ee(!1),ie({first_name:k.first_name||"",last_name:k.last_name||"",phone_number:k.phone_number||"",city:k.city||"",country:k.country||""})},variant:"outline",className:"border-brand-burgundy text-brand-burgundy hover:bg-brand-burgundy/10",children:"Cancel"})]})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Email"}),c.jsx("p",{className:"mt-1",children:e.email})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Name"}),c.jsx("p",{className:"mt-1",children:k.first_name||k.last_name?`${k.first_name} ${k.last_name}`:"Not set"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Phone"}),c.jsx("p",{className:"mt-1",children:k.phone_number||"Not set"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"City"}),c.jsx("p",{className:"mt-1",children:k.city||"Not set"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Country"}),c.jsx("p",{className:"mt-1",children:k.country||"Not set"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Member Since"}),c.jsx("p",{className:"mt-1",children:new Date(k.created_at||e.created_at).toLocaleDateString()})]})]}):c.jsx("p",{children:"Loading profile..."})]})})}),c.jsx(xn,{value:"saved",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Saved Venues"}),I.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:I.map(ce=>c.jsxs(kt,{className:"p-4",children:[c.jsx("h3",{className:"font-semibold",children:ce.venues.name}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:ce.venues.type}),c.jsx(Et,{onClick:async()=>{try{const{error:ke}=await Ve.from("saved_venues").delete().eq("user_id",e.id).eq("venue_id",ce.venue_id);if(ke)throw ke;B(ve=>ve.filter(Pe=>Pe.id!==ce.id))}catch(ke){console.error("Error removing saved venue:",ke)}},variant:"outline",className:"mt-2 text-red-500 border-red-500 hover:bg-red-50",children:"Remove"})]},ce.id))}):c.jsx("p",{children:"No saved venues yet"})]})})}),c.jsx(xn,{value:"bookings",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"My Bookings"}),O.length>0?c.jsx("div",{className:"space-y-4",children:O.map(ce=>c.jsx(kt,{className:"p-4",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold",children:ce.venues.name}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[new Date(ce.booking_date).toLocaleDateString()," at ",ce.start_time]}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[ce.number_of_guests," guests"]}),ce.venue_tables&&c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Table: ",ce.venue_tables.table_number]}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Total: ",(ce.total_amount||0).toLocaleString()]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm font-medium text-brand-burgundy",children:ce.status.charAt(0).toUpperCase()+ce.status.slice(1)}),(ce.status==="confirmed"||ce.status==="pending")&&c.jsx(Et,{onClick:async()=>{try{const{error:ke}=await Ve.from("bookings").update({status:"cancelled",updated_at:new Date().toISOString()}).eq("id",ce.id);if(ke)throw ke;R(ve=>ve.map(Pe=>Pe.id===ce.id?{...Pe,status:"cancelled"}:Pe))}catch(ke){console.error("Error cancelling booking:",ke)}},variant:"outline",className:"mt-2 text-red-500 border-red-500 hover:bg-red-50",children:"Cancel"})]})]})},ce.id))}):c.jsx("p",{children:"No bookings yet"})]})})}),c.jsx(xn,{value:"settings",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs("div",{className:"p-2 sm:p-4 md:p-6 space-y-10",children:[c.jsxs("div",{className:"space-y-2 pb-8 border-b border-brand-burgundy/10",children:[c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Change Password"}),c.jsx(MFe,{user:e})]}),c.jsx(qS,{stripe:kFe,children:c.jsx("div",{className:"space-y-2 pb-8 border-b border-brand-burgundy/10",children:c.jsx(IFe,{user:e})})}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Referral Codes"}),c.jsx(OFe,{user:e})]})]})})}),c.jsx(xn,{value:"member",children:c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs("div",{className:"p-2 sm:p-4 md:p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"VIP Member Credit"}),c.jsx("p",{className:"mb-4 text-brand-burgundy/70",children:"Deposit funds to your Eddy account and unlock exclusive VIP perks. The more you deposit, the more power and privileges you get!"}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"text-lg font-bold",children:["Credit Balance: ",c.jsxs("span",{className:"text-brand-gold",children:["$",((xe=k==null?void 0:k.credit_balance)==null?void 0:xe.toLocaleString())??0]})]}),c.jsx("div",{className:"mt-2",children:(k==null?void 0:k.credit_balance)>=1e4?c.jsxs("div",{className:"text-green-700 font-semibold flex items-center",children:[c.jsx("span",{role:"img","aria-label":"butler",className:"mr-2",children:""}),"You have a personal butler! Contact us for your VIP concierge service."]}):c.jsxs("div",{className:"text-brand-burgundy/70",children:["Deposit ",c.jsxs("span",{className:"font-bold",children:["$",(1e4-((k==null?void 0:k.credit_balance)??0)).toLocaleString()]})," more to unlock your personal butler!"]})})]}),c.jsxs("form",{className:"space-y-4 max-w-xs",onSubmit:ce=>{ce.preventDefault(),!(!F||isNaN(F)||Number(F)<100)&&q("/checkout/deposit",{state:{depositAmount:Number(F)}})},children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Deposit Amount"}),c.jsx("input",{type:"number",min:"100",step:"100",className:"w-full border p-2 rounded bg-white",placeholder:"Enter amount (USD)",value:F,onChange:ce=>X(ce.target.value)}),c.jsx(Et,{type:"submit",className:"w-full bg-brand-burgundy text-white",children:"Deposit"})]})]})})})]})]})}):c.jsx("div",{className:"bg-brand-cream/50 min-h-screen",children:c.jsxs("div",{className:"max-w-lg mx-auto mt-16 p-8 bg-white rounded shadow mb-20",children:[c.jsx("h2",{className:"text-2xl font-bold mb-4 text-brand-burgundy",children:o?"Sign Up":"Login to your profile"}),o?c.jsxs("form",{onSubmit:Ee,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("input",{type:"text",name:"firstName",placeholder:"First Name",value:p.firstName,onChange:ce=>y({...p,firstName:ce.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),c.jsx("input",{type:"text",name:"lastName",placeholder:"Last Name",value:p.lastName,onChange:ce=>y({...p,lastName:ce.target.value}),className:"w-full border p-2 rounded bg-white",required:!0})]}),c.jsx("input",{type:"email",name:"email",placeholder:"Email",value:p.email,onChange:ce=>y({...p,email:ce.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("input",{type:"text",name:"city",placeholder:"City",value:p.city,onChange:ce=>y({...p,city:ce.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),c.jsx("input",{type:"text",name:"country",placeholder:"Country",value:p.country,onChange:ce=>y({...p,country:ce.target.value}),className:"w-full border p-2 rounded bg-white",required:!0})]}),c.jsx("input",{type:"password",name:"password",placeholder:"Password",value:p.password,onChange:ce=>y({...p,password:ce.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),c.jsx("input",{type:"password",name:"confirm",placeholder:"Confirm Password",value:p.confirm,onChange:ce=>y({...p,confirm:ce.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),E&&c.jsx("div",{className:"text-red-500",children:E}),c.jsx(Et,{type:"submit",className:"w-full bg-brand-burgundy text-white",children:"Sign Up"}),c.jsxs("div",{className:"text-center mt-4",children:[c.jsx("span",{className:"text-brand-burgundy/70",children:"Already have an account? "}),c.jsx("button",{type:"button",onClick:()=>s(!1),className:"font-bold text-brand-burgundy hover:text-brand-burgundy/80 transition-colors",children:"Log In"})]})]}):c.jsxs("form",{onSubmit:_e,className:"space-y-4",children:[c.jsx("input",{type:"email",name:"email",placeholder:"Email",value:h.email,onChange:ce=>i({...h,[ce.target.name]:ce.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),c.jsx("input",{type:"password",name:"password",placeholder:"Password",value:h.password,onChange:ce=>i({...h,[ce.target.name]:ce.target.value}),className:"w-full border p-2 rounded bg-white",required:!0}),b&&c.jsx("div",{className:"text-red-500",children:b}),c.jsx(Et,{type:"submit",className:"w-full bg-brand-burgundy text-white",children:"Login"}),c.jsxs("div",{className:"text-center mt-4",children:[c.jsx("span",{className:"text-brand-burgundy/70",children:"Don't have an account? "}),c.jsx("button",{type:"button",onClick:()=>s(!0),className:"font-bold text-brand-burgundy hover:text-brand-burgundy/80 transition-colors",children:"Sign Up"})]})]})]})})};function MFe({user:e}){const[t,r]=D.useState(""),[n,o]=D.useState(""),[s,h]=D.useState(""),[i,p]=D.useState(!1),[y,b]=D.useState(""),[_,E]=D.useState(""),C=async k=>{if(k.preventDefault(),E(""),b(""),!t||!n||!s){E("All fields are required.");return}if(n!==s){E("New passwords do not match.");return}p(!0);try{const{error:N}=await Ve.auth.signInWithPassword({email:e.email,password:t});if(N)throw N;const{error:I}=await Ve.auth.updateUser({password:n});if(I)throw I;b("Password updated successfully!"),r(""),o(""),h("")}catch(N){E(N.message||"Failed to update password.")}finally{p(!1)}};return c.jsxs("form",{onSubmit:C,className:"space-y-4 max-w-md",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Current Password"}),c.jsx("input",{type:"password",className:"w-full border p-2 rounded bg-white",value:t,onChange:k=>r(k.target.value),required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"New Password"}),c.jsx("input",{type:"password",className:"w-full border p-2 rounded bg-white",value:n,onChange:k=>o(k.target.value),required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Confirm New Password"}),c.jsx("input",{type:"password",className:"w-full border p-2 rounded bg-white",value:s,onChange:k=>h(k.target.value),required:!0})]}),_&&c.jsx("div",{className:"text-red-500",children:_}),y&&c.jsx("div",{className:"text-green-600",children:y}),c.jsx("button",{type:"submit",className:"bg-brand-gold text-brand-burgundy px-4 py-2 rounded hover:bg-brand-gold/90",disabled:i,children:i?"Updating...":"Change Password"})]})}function IFe({user:e}){const t=UO(),r=FO(),[n,o]=D.useState(""),[s,h]=D.useState(!1),i=null,p=async y=>{if(y.preventDefault(),o(""),h(!0),!t||!r){o("Stripe is not loaded"),h(!1);return}const b=await t.confirmCardSetup(i,{payment_method:{card:r.getElement(eg),billing_details:{email:e.email}}});b.error?o(b.error.message):o("Payment method saved!"),depositAmount&&e&&await Ve.from("user_profiles").update({credit_balance:Ve.raw("credit_balance + ?",[depositAmount])}).eq("id",e.id),h(!1)};return c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Payment Details"}),c.jsx("p",{className:"text-brand-burgundy/70 mb-2",children:"Your card details are processed securely by Stripe and never touch our servers. You can remove your payment method at any time."}),c.jsxs("form",{onSubmit:p,className:"space-y-4 max-w-md",children:[c.jsx(eg,{options:{hidePostalCode:!0}}),c.jsx("button",{type:"submit",className:"bg-brand-gold text-brand-burgundy px-4 py-2 rounded hover:bg-brand-gold/90",disabled:!t||s,children:s?"Saving...":"Save Payment Method"}),n&&c.jsx("div",{className:"mt-2 text-brand-burgundy",children:n})]}),c.jsx("div",{className:"mt-4 text-xs text-brand-burgundy/60",children:"We comply with GDPR. Your payment data is handled by Stripe and you may request deletion at any time."})]})}function OFe({user:e}){const[t,r]=D.useState(""),[n,o]=D.useState(""),[s,h]=D.useState(!1),[i,p]=D.useState([]),[y,b]=D.useState([]);D.useEffect(()=>{const C=JSON.parse(localStorage.getItem("nightvibe_referral_codes")||"[]");b(C);const k=JSON.parse(localStorage.getItem("lagosvibe_sent_invitations")||"[]");p(k.filter(N=>N.senderEmail===e.email))},[e.email]);const _=async C=>{if(C.preventDefault(),!t||!t.includes("@")){alert("Please enter a valid email address");return}h(!0);try{if(i.find(q=>q.email===t)){alert("You have already sent an invitation to this email address"),h(!1);return}const{data:N,error:I}=await Ve.auth.admin.inviteUserByEmail(t,{redirectTo:`${window.location.origin}/register?referred_by=${e.id}`,data:{referred_by:e.id,referrer_name:e.email.split("@")[0],personal_message:n,invitation_type:"member_referral"}});if(I)throw I;const B={id:Date.now(),email:t,personalMessage:n,senderEmail:e.email,sentAt:new Date().toISOString(),status:"sent"},O=[...i,B];p(O);const R=JSON.parse(localStorage.getItem("lagosvibe_sent_invitations")||"[]");R.push(B),localStorage.setItem("lagosvibe_sent_invitations",JSON.stringify(R)),r(""),o(""),alert("Referral invitation sent successfully!")}catch(k){console.error("Error sending referral:",k),alert("Failed to send referral invitation. Please try again.")}finally{h(!1)}},E=C=>{navigator.clipboard.writeText(C),alert(`Referral code "${C}" copied to clipboard!`)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-3",children:"Invite a Friend"}),c.jsxs("form",{onSubmit:_,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Friend's Email"}),c.jsx("input",{type:"email",className:"w-full border p-2 rounded bg-white border-brand-burgundy/30 focus:border-brand-gold",value:t,onChange:C=>r(C.target.value),placeholder:"friend@example.com",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-burgundy/70",children:"Personal Message (Optional)"}),c.jsx("textarea",{className:"w-full border p-2 rounded bg-white border-brand-burgundy/30 focus:border-brand-gold",rows:"3",value:n,onChange:C=>o(C.target.value),placeholder:"Tell your friend why they should join VIP Club..."})]}),c.jsx("button",{type:"submit",className:"bg-brand-gold text-brand-burgundy px-4 py-2 rounded hover:bg-brand-gold/90 font-medium",disabled:s,children:s?"Sending...":"Send Invitation"})]})]}),y.length>0&&c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-3",children:"Available Referral Codes"}),c.jsx("div",{className:"space-y-2",children:y.map(C=>c.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded border border-brand-burgundy/20",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-mono font-bold text-brand-burgundy",children:C.code}),c.jsxs("span",{className:"text-sm text-brand-burgundy/70 ml-2",children:["(",C.discount,")"]}),C.perks&&c.jsx("div",{className:"text-xs text-brand-burgundy/60",children:C.perks})]}),c.jsx("button",{onClick:()=>E(C.code),className:"text-brand-gold hover:text-brand-burgundy text-sm font-medium",children:"Copy"})]},C.id))})]}),i.length>0&&c.jsxs("div",{className:"bg-brand-cream/30 p-4 rounded-lg border border-brand-burgundy/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-3",children:"Sent Invitations"}),c.jsx("div",{className:"space-y-2",children:i.map(C=>c.jsxs("div",{className:"bg-white p-3 rounded border border-brand-burgundy/20",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"font-medium text-brand-burgundy",children:C.email}),c.jsx("span",{className:"text-xs text-brand-burgundy/60",children:new Date(C.sentAt).toLocaleDateString()})]}),C.personalMessage&&c.jsxs("div",{className:"text-sm text-brand-burgundy/70 mt-1",children:['"',C.personalMessage,'"']})]},C.id))})]}),i.length===0&&c.jsx("div",{className:"text-center text-brand-burgundy/60 py-4",children:c.jsx("p",{children:"No referral invitations sent yet. Invite your friends to earn rewards!"})})]})}const DFe=D.createContext(null);function RFe(e,t){const r=Array.isArray(e)?e[0]:e?e.x:0,n=Array.isArray(e)?e[1]:e?e.y:0,o=Array.isArray(t)?t[0]:t?t.x:0,s=Array.isArray(t)?t[1]:t?t.y:0;return r===o&&n===s}function fc(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!fc(e[r],t[r]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const o of r)if(!t.hasOwnProperty(o)||!fc(e[o],t[o]))return!1;return!0}return!1}function LFe(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}function vU(e,t){if(!e.getProjection)return;const r=e.getProjection(),n=t.getProjection();fc(r,n)||t.setProjection(r)}function xU(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function bU(e,t){const r=t.viewState||t;let n=!1;if("zoom"in r){const o=e.zoom;e.zoom=r.zoom,n=n||o!==e.zoom}if("bearing"in r){const o=e.bearing;e.bearing=r.bearing,n=n||o!==e.bearing}if("pitch"in r){const o=e.pitch;e.pitch=r.pitch,n=n||o!==e.pitch}if(r.padding&&!e.isPaddingEqual(r.padding)&&(n=!0,e.padding=r.padding),"longitude"in r&&"latitude"in r){const o=e.center;e.center=new o.constructor(r.longitude,r.latitude),n=n||o!==e.center}return n}const BFe=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function _U(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const n of e.layers)t[n.id]=n;const r=e.layers.map(n=>{let o=null;"interactive"in n&&(o=Object.assign({},n),delete o.interactive);const s=t[n.ref];if(s){o=o||Object.assign({},n),delete o.ref;for(const h of BFe)h in s&&(o[h]=s[h])}return o||n});return{...e,layers:r}}const wU={version:8,sources:{},layers:[]},SU={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},nP={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},EU={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},zFe=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],$Fe=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class tg{constructor(t,r,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=o=>{const s=this.props[EU[o.type]];s?s(o):o.type==="error"&&console.error(o.error)},this._onPointerEvent=o=>{(o.type==="mousemove"||o.type==="mouseout")&&this._updateHover(o);const s=this.props[SU[o.type]];s&&(this.props.interactiveLayerIds&&o.type!=="mouseover"&&o.type!=="mouseout"&&(o.features=this._hoveredFeatures||this._queryRenderedFeatures(o.point)),s(o),delete o.features)},this._onCameraEvent=o=>{if(!this._internalUpdate){const s=this.props[nP[o.type]];s&&s(o)}o.type in this._deferredEvents&&(this._deferredEvents[o.type]=!1)},this._MapClass=t,this.props=r,this._initialize(n)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const r=this.props;this.props=t;const n=this._updateSettings(t,r);n&&this._createShadowTransform(this._map);const o=this._updateSize(t),s=this._updateViewState(t,!0);this._updateStyle(t,r),this._updateStyleComponents(t,r),this._updateHandlers(t,r),(n||o||s&&!this._map.isMoving())&&this.redraw()}static reuse(t,r){const n=tg.savedMaps.pop();if(!n)return null;const o=n.map,s=o.getContainer();for(r.className=s.className;s.childNodes.length>0;)r.appendChild(s.childNodes[0]);o._container=r;const h=o._resizeObserver;h&&(h.disconnect(),h.observe(r)),n.setProps({...t,styleDiffing:!1}),o.resize();const{initialViewState:i}=t;return i&&(i.bounds?o.fitBounds(i.bounds,{...i.fitBoundsOptions,duration:0}):n._updateViewState(i,!1)),o.isStyleLoaded()?o.fire("load"):o.once("styledata",()=>o.fire("load")),o._update(),n}_initialize(t){const{props:r}=this,{mapStyle:n=wU}=r,o={...r,...r.initialViewState,accessToken:r.mapboxAccessToken||FFe()||null,container:t,style:_U(n)},s=o.initialViewState||o.viewState||o;if(Object.assign(o,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),r.gl){const b=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=b,r.gl)}const h=new this._MapClass(o);s.padding&&h.setPadding(s.padding),r.cursor&&(h.getCanvas().style.cursor=r.cursor),this._createShadowTransform(h);const i=h._render;h._render=b=>{this._inRender=!0,i.call(h,b),this._inRender=!1};const p=h._renderTaskQueue.run;h._renderTaskQueue.run=b=>{p.call(h._renderTaskQueue,b),this._onBeforeRepaint()},h.on("render",()=>this._onAfterRepaint());const y=h.fire;h.fire=this._fireEvent.bind(this,y),h.on("resize",()=>{this._renderTransform.resize(h.transform.width,h.transform.height)}),h.on("styledata",()=>{this._updateStyleComponents(this.props,{}),vU(h.transform,this._renderTransform)}),h.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const b in SU)h.on(b,this._onPointerEvent);for(const b in nP)h.on(b,this._onCameraEvent);for(const b in EU)h.on(b,this._onEvent);this._map=h}recycle(){const r=this.map.getContainer().querySelector("[mapboxgl-children]");r==null||r.remove(),tg.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const r=LFe(t.transform);t.painter.transform=r,this._renderTransform=r}_updateSize(t){const{viewState:r}=t;if(r){const n=this._map;if(r.width!==n.transform.width||r.height!==n.transform.height)return n.resize(),!0}return!1}_updateViewState(t,r){if(this._internalUpdate)return!1;const n=this._map,o=this._renderTransform,{zoom:s,pitch:h,bearing:i}=o,p=n.isMoving();p&&(o.cameraElevationReference="sea");const y=bU(o,{...xU(n.transform),...t});if(p&&(o.cameraElevationReference="ground"),y&&r){const b=this._deferredEvents;b.move=!0,b.zoom||(b.zoom=s!==o.zoom),b.rotate||(b.rotate=i!==o.bearing),b.pitch||(b.pitch=h!==o.pitch)}return p||bU(n.transform,t),y}_updateSettings(t,r){const n=this._map;let o=!1;for(const s of zFe)if(s in t&&!fc(t[s],r[s])){o=!0;const h=n[`set${s[0].toUpperCase()}${s.slice(1)}`];h==null||h.call(n,t[s])}return o}_updateStyle(t,r){if(t.cursor!==r.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==r.mapStyle){const{mapStyle:n=wU,styleDiffing:o=!0}=t,s={diff:o};return"localIdeographFontFamily"in t&&(s.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(_U(n),s),!0}return!1}_updateStyleComponents(t,r){const n=this._map;let o=!1;return n.isStyleLoaded()&&("light"in t&&n.setLight&&!fc(t.light,r.light)&&(o=!0,n.setLight(t.light)),"fog"in t&&n.setFog&&!fc(t.fog,r.fog)&&(o=!0,n.setFog(t.fog)),"terrain"in t&&n.setTerrain&&!fc(t.terrain,r.terrain)&&(!t.terrain||n.getSource(t.terrain.source))&&(o=!0,n.setTerrain(t.terrain))),o}_updateHandlers(t,r){var n,o;const s=this._map;let h=!1;for(const i of $Fe){const p=(n=t[i])!==null&&n!==void 0?n:!0,y=(o=r[i])!==null&&o!==void 0?o:!0;fc(p,y)||(h=!0,p?s[i].enable(p):s[i].disable())}return h}_queryRenderedFeatures(t){const r=this._map,n=r.transform,{interactiveLayerIds:o=[]}=this.props;try{return r.transform=this._renderTransform,r.queryRenderedFeatures(t,{layers:o.filter(r.getLayer.bind(r))})}catch{return[]}finally{r.transform=n}}_updateHover(t){var r;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const s=t.type,h=((r=this._hoveredFeatures)===null||r===void 0?void 0:r.length)>0,i=this._queryRenderedFeatures(t.point),p=i.length>0;!p&&h&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=i,p&&!h&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=s}else this._hoveredFeatures=null}_fireEvent(t,r,n){const o=this._map,s=o.transform,h=typeof r=="string"?r:r.type;return h==="move"&&this._updateViewState(this.props,!1),h in nP&&(typeof r=="object"&&(r.viewState=xU(s)),this._map.isMoving())?(o.transform=this._renderTransform,t.call(o,r,n),o.transform=s,o):(t.call(o,r,n),o)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const n in this._deferredEvents)this._deferredEvents[n]&&t.fire(n);this._internalUpdate=!1;const r=this._map.transform;t.transform=this._renderTransform,this._onAfterRepaint=()=>{vU(this._renderTransform,r),t.transform=r}}}tg.savedMaps=[];function FFe(){let e=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||{}.MapboxAccessToken}catch{}try{e=e||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return e}const UFe=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function VFe(e){if(!e)return null;const t=e.map,r={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:n=>{const o=t.transform;t.transform=e.transform;const s=t.project(n);return t.transform=o,s},unproject:n=>{const o=t.transform;t.transform=e.transform;const s=t.unproject(n);return t.transform=o,s},queryTerrainElevation:(n,o)=>{const s=t.transform;t.transform=e.transform;const h=t.queryTerrainElevation(n,o);return t.transform=s,h},queryRenderedFeatures:(n,o)=>{const s=t.transform;t.transform=e.transform;const h=t.queryRenderedFeatures(n,o);return t.transform=s,h}};for(const n of qFe(t))!(n in r)&&!UFe.includes(n)&&(r[n]=t[n].bind(t));return r}function qFe(e){const t=new Set;let r=e;for(;r;){for(const n of Object.getOwnPropertyNames(r))n[0]!=="_"&&typeof e[n]=="function"&&n!=="fire"&&n!=="setEventedParent"&&t.add(n);r=Object.getPrototypeOf(r)}return Array.from(t)}const WFe=typeof document<"u"?D.useLayoutEffect:D.useEffect,GFe=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function HFe(e,t){for(const n of GFe)n in t&&(e[n]=t[n]);const{RTLTextPlugin:r="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;r&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(r,n=>{n&&console.error(n)},!0)}const BE=D.createContext(null);function XFe(e,t,r){const n=D.useContext(DFe),[o,s]=D.useState(null),h=D.useRef(),{current:i}=D.useRef({mapLib:null,map:null});D.useEffect(()=>{const b=e.mapLib;let _=!0,E;return Promise.resolve(b||r).then(C=>{if(!_)return;if(!C)throw new Error("Invalid mapLib");const k="Map"in C?C:C.default;if(!k.Map)throw new Error("Invalid mapLib");if(HFe(k,e),!k.supported||k.supported(e))e.reuseMaps&&(E=tg.reuse(e,h.current)),E||(E=new tg(k.Map,e,h.current)),i.map=VFe(E),i.mapLib=k,s(E),n==null||n.onMapMount(i.map,e.id);else throw new Error("Map is not supported by this browser")}).catch(C=>{const{onError:k}=e;k?k({type:"error",target:null,originalEvent:null,error:C}):console.error(C)}),()=>{_=!1,E&&(n==null||n.onMapUnmount(e.id),e.reuseMaps?E.recycle():E.destroy())}},[]),WFe(()=>{o&&o.setProps(e)}),D.useImperativeHandle(t,()=>i.map,[o]);const p=D.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),y={height:"100%"};return D.createElement("div",{id:e.id,ref:h,style:p},o&&D.createElement(BE.Provider,{value:i},D.createElement("div",{"mapboxgl-children":"",style:y},e.children)))}const ZFe=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Cf(e,t){if(!e||!t)return;const r=e.style;for(const n in t){const o=t[n];Number.isFinite(o)&&!ZFe.test(n)?r[n]=`${o}px`:r[n]=o}}function KFe(e,t){const{map:r,mapLib:n}=D.useContext(BE),o=D.useRef({props:e});o.current.props=e;const s=D.useMemo(()=>{let N=!1;D.Children.forEach(e.children,O=>{O&&(N=!0)});const I={...e,element:N?document.createElement("div"):null},B=new n.Marker(I);return B.setLngLat([e.longitude,e.latitude]),B.getElement().addEventListener("click",O=>{var R,q;(q=(R=o.current.props).onClick)===null||q===void 0||q.call(R,{type:"click",target:B,originalEvent:O})}),B.on("dragstart",O=>{var R,q;const F=O;F.lngLat=s.getLngLat(),(q=(R=o.current.props).onDragStart)===null||q===void 0||q.call(R,F)}),B.on("drag",O=>{var R,q;const F=O;F.lngLat=s.getLngLat(),(q=(R=o.current.props).onDrag)===null||q===void 0||q.call(R,F)}),B.on("dragend",O=>{var R,q;const F=O;F.lngLat=s.getLngLat(),(q=(R=o.current.props).onDragEnd)===null||q===void 0||q.call(R,F)}),B},[]);D.useEffect(()=>(s.addTo(r.getMap()),()=>{s.remove()}),[]);const{longitude:h,latitude:i,offset:p,style:y,draggable:b=!1,popup:_=null,rotation:E=0,rotationAlignment:C="auto",pitchAlignment:k="auto"}=e;return D.useEffect(()=>{Cf(s.getElement(),y)},[y]),D.useImperativeHandle(t,()=>s,[]),(s.getLngLat().lng!==h||s.getLngLat().lat!==i)&&s.setLngLat([h,i]),p&&!RFe(s.getOffset(),p)&&s.setOffset(p),s.isDraggable()!==b&&s.setDraggable(b),s.getRotation()!==E&&s.setRotation(E),s.getRotationAlignment()!==C&&s.setRotationAlignment(C),s.getPitchAlignment()!==k&&s.setPitchAlignment(k),s.getPopup()!==_&&s.setPopup(_),Uc.createPortal(e.children,s.getElement())}const YFe=D.memo(D.forwardRef(KFe));function TU(e){return new Set(e?e.trim().split(/\s+/):[])}function JFe(e,t){const{map:r,mapLib:n}=D.useContext(BE),o=D.useMemo(()=>document.createElement("div"),[]),s=D.useRef({props:e});s.current.props=e;const h=D.useMemo(()=>{const i={...e},p=new n.Popup(i);return p.setLngLat([e.longitude,e.latitude]),p.once("open",y=>{var b,_;(_=(b=s.current.props).onOpen)===null||_===void 0||_.call(b,y)}),p},[]);if(D.useEffect(()=>{const i=p=>{var y,b;(b=(y=s.current.props).onClose)===null||b===void 0||b.call(y,p)};return h.on("close",i),h.setDOMContent(o).addTo(r.getMap()),()=>{h.off("close",i),h.isOpen()&&h.remove()}},[]),D.useEffect(()=>{Cf(h.getElement(),e.style)},[e.style]),D.useImperativeHandle(t,()=>h,[]),h.isOpen()&&((h.getLngLat().lng!==e.longitude||h.getLngLat().lat!==e.latitude)&&h.setLngLat([e.longitude,e.latitude]),e.offset&&!fc(h.options.offset,e.offset)&&h.setOffset(e.offset),(h.options.anchor!==e.anchor||h.options.maxWidth!==e.maxWidth)&&(h.options.anchor=e.anchor,h.setMaxWidth(e.maxWidth)),h.options.className!==e.className)){const i=TU(h.options.className),p=TU(e.className);for(const y of i)p.has(y)||h.removeClassName(y);for(const y of p)i.has(y)||h.addClassName(y);h.options.className=e.className}return Uc.createPortal(e.children,o)}const QFe=D.memo(D.forwardRef(JFe));function r0(e,t,r,n){const o=D.useContext(BE),s=D.useMemo(()=>e(o),[]);return D.useEffect(()=>{const h=n||r||t,i=typeof t=="function"&&typeof r=="function"?t:null,p=typeof r=="function"?r:typeof t=="function"?t:null,{map:y}=o;return y.hasControl(s)||(y.addControl(s,h==null?void 0:h.position),i&&i(o)),()=>{p&&p(o),y.hasControl(s)&&y.removeControl(s)}},[]),s}function eUe(e){const t=r0(({mapLib:r})=>new r.AttributionControl(e),{position:e.position});return D.useEffect(()=>{Cf(t._container,e.style)},[e.style]),null}D.memo(eUe);function tUe(e){const t=r0(({mapLib:r})=>new r.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return D.useEffect(()=>{Cf(t._controlContainer,e.style)},[e.style]),null}D.memo(tUe);function rUe(e,t){const r=D.useRef({props:e}),n=r0(({mapLib:o})=>{const s=new o.GeolocateControl(e),h=s._setupUI;return s._setupUI=i=>{s._container.hasChildNodes()||h(i)},s.on("geolocate",i=>{var p,y;(y=(p=r.current.props).onGeolocate)===null||y===void 0||y.call(p,i)}),s.on("error",i=>{var p,y;(y=(p=r.current.props).onError)===null||y===void 0||y.call(p,i)}),s.on("outofmaxbounds",i=>{var p,y;(y=(p=r.current.props).onOutOfMaxBounds)===null||y===void 0||y.call(p,i)}),s.on("trackuserlocationstart",i=>{var p,y;(y=(p=r.current.props).onTrackUserLocationStart)===null||y===void 0||y.call(p,i)}),s.on("trackuserlocationend",i=>{var p,y;(y=(p=r.current.props).onTrackUserLocationEnd)===null||y===void 0||y.call(p,i)}),s},{position:e.position});return r.current.props=e,D.useImperativeHandle(t,()=>n,[]),D.useEffect(()=>{Cf(n._container,e.style)},[e.style]),null}D.memo(D.forwardRef(rUe));function nUe(e){const t=r0(({mapLib:r})=>new r.NavigationControl(e),{position:e.position});return D.useEffect(()=>{Cf(t._container,e.style)},[e.style]),null}D.memo(nUe);function iUe(e){const t=r0(({mapLib:s})=>new s.ScaleControl(e),{position:e.position}),r=D.useRef(e),n=r.current;r.current=e;const{style:o}=e;return e.maxWidth!==void 0&&e.maxWidth!==n.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==n.unit&&t.setUnit(e.unit),D.useEffect(()=>{Cf(t._container,o)},[o]),null}D.memo(iUe);const oUe=Js(()=>Promise.resolve().then(()=>vUe),void 0),aUe=(()=>D.forwardRef(function(t,r){return XFe(t,r,oUe)}))(),jU=YFe,sUe=QFe;const lUe=()=>{const[e,t]=D.useState([]),[r,n]=D.useState([]),[o,s]=D.useState(null),[h,i]=D.useState(!0),[p,y]=D.useState(null),[b,_]=D.useState({lat:6.5244,lng:3.3792}),[E,C]=D.useState(11),[k,N]=D.useState(!1),[I,B]=D.useState(!0),[O,R]=D.useState({search:"",type:"all",priceRange:"all",minRating:0});D.useState(!1);const q=D.useRef();D.useEffect(()=>{(()=>{if(!navigator.geolocation){console.log("Geolocation is not supported by this browser"),y({lat:6.5244,lng:3.3792});return}console.log("Getting user location..."),navigator.geolocation.getCurrentPosition(ie=>{const pe=ie.coords.latitude,ae=ie.coords.longitude;console.log("User location detected:",{lat:pe,lng:ae});const _e={lat:pe,lng:ae};y(_e),_(_e),B(!1);const Ee=ie.coords.accuracy;let xe=13;Ee>1e3?xe=11:Ee<100&&(xe=15),C(xe)},ie=>{console.log("Geolocation error:",ie);let pe={lat:6.5244,lng:3.3792};switch(ie.code){case ie.PERMISSION_DENIED:console.log("User denied location permission, using Lagos as default"),N(!0);break;case ie.POSITION_UNAVAILABLE:console.log("Location information unavailable, using Lagos as default");break;case ie.TIMEOUT:console.log("Location request timed out, using Lagos as default");break;default:console.log("Unknown location error, using Lagos as default");break}y(pe),_(pe),C(11),B(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})})()},[]),D.useEffect(()=>{(async()=>{try{i(!0);const{data:ie,error:pe}=await Ve.from("venues").select(`
            *,
            venue_images (
              image_url,
              is_primary
            )
          `).eq("status","approved").eq("is_active",!0);if(pe){console.error("Error fetching venues:",pe),t([]);return}if(!ie||ie.length===0){console.log("No venues found in database"),t([]),n([]);return}const ae=ie.map(_e=>{var xe,ce,ke,ve,Pe;const Ee=((ce=(xe=_e.venue_images)==null?void 0:xe.find(Re=>Re.is_primary))==null?void 0:ce.image_url)||((ve=(ke=_e.venue_images)==null?void 0:ke[0])==null?void 0:ve.image_url)||"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4";return{..._e,lat:_e.latitude||6.5244,lng:_e.longitude||3.3792,image:Ee,priceLevel:((Pe=_e.price_range)==null?void 0:Pe.length)||1}});t(ae),n(ae)}catch(ie){console.error("Error in fetchVenues:",ie),t([]),n([])}finally{i(!1)}})()},[]),D.useEffect(()=>{let K=e;O.search&&(K=K.filter(ie=>{var pe;return ie.name.toLowerCase().includes(O.search.toLowerCase())||((pe=ie.description)==null?void 0:pe.toLowerCase().includes(O.search.toLowerCase()))||ie.address.toLowerCase().includes(O.search.toLowerCase())||ie.city.toLowerCase().includes(O.search.toLowerCase())})),O.type!=="all"&&(K=K.filter(ie=>ie.type===O.type)),O.priceRange!=="all"&&(K=K.filter(ie=>ie.price_range===O.priceRange)),O.minRating>0&&(K=K.filter(ie=>(ie.rating||0)>=O.minRating)),n(K)},[e,O]),D.useEffect(()=>{if(!q.current||!p)return;const K=q.current.getMap();(p.lat!==6.5244||p.lng!==3.3792)&&setTimeout(()=>{K.flyTo({center:[p.lng,p.lat],zoom:E,duration:2e3})},1e3)},[p,E]),D.useEffect(()=>{if(!(!q.current||!r.length)&&(O.search||O.type!=="all"||O.priceRange!=="all"||O.minRating>0)){const K=q.current.getMap();if(r.length===1)K.flyTo({center:[r[0].lng,r[0].lat],zoom:14,duration:1e3});else if(r.length>1){const ie=r.map(_e=>_e.lat),pe=r.map(_e=>_e.lng),ae=[[Math.min(...pe)-.01,Math.min(...ie)-.01],[Math.max(...pe)+.01,Math.max(...ie)+.01]];K.fitBounds(ae,{padding:50,duration:1e3})}}},[r,O]);const F=K=>{switch(K.type){case"restaurant":return"#10B981";case"club":return"#8B5CF6";case"lounge":return"#F59E0B";default:return"#EF4444"}},X=K=>{switch(K){case"restaurant":return"";case"club":return"";case"lounge":return"";default:return""}},G=()=>{R({search:"",type:"all",priceRange:"all",minRating:0})},ee=()=>{if(!q.current||!p)return;q.current.getMap().flyTo({center:[p.lng,p.lat],zoom:15,duration:1e3})};return c.jsx("div",{className:"bg-brand-cream min-h-screen",children:c.jsxs("div",{className:"container py-8",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"Explore Lagos Venues"}),c.jsx("p",{className:"text-brand-burgundy/70 text-lg",children:"Discover the best restaurants, clubs, and lounges on our interactive map"})]}),k&&c.jsx(kt,{className:"mb-4 bg-amber-50 border-amber-200",children:c.jsx(rr,{className:"p-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(EM,{className:"h-5 w-5 text-amber-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-amber-800",children:"Location access denied"}),c.jsx("p",{className:"text-xs text-amber-700",children:"Enable location permission in your browser to see venues near you"})]})]})})}),c.jsx(kt,{className:"mb-6 bg-white border-brand-burgundy/10",children:c.jsxs(rr,{className:"p-4",children:[c.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(Tm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-brand-burgundy/50"}),c.jsx(Xt,{placeholder:"Search venues, locations...",value:O.search,onChange:K=>R(ie=>({...ie,search:K.target.value})),className:"pl-10 border-brand-burgundy/20 focus:border-brand-gold"})]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("select",{value:O.type,onChange:K=>R(ie=>({...ie,type:K.target.value})),className:"px-3 py-2 border border-brand-burgundy/20 rounded-md bg-white text-brand-burgundy",children:[c.jsx("option",{value:"all",children:"All Types"}),c.jsx("option",{value:"restaurant",children:"Restaurants"}),c.jsx("option",{value:"club",children:"Clubs"}),c.jsx("option",{value:"lounge",children:"Lounges"})]}),c.jsxs("select",{value:O.priceRange,onChange:K=>R(ie=>({...ie,priceRange:K.target.value})),className:"px-3 py-2 border border-brand-burgundy/20 rounded-md bg-white text-brand-burgundy",children:[c.jsx("option",{value:"all",children:"All Prices"}),c.jsx("option",{value:"$",children:"$ - Budget"}),c.jsx("option",{value:"$$",children:"$$ - Moderate"}),c.jsx("option",{value:"$$$",children:"$$$ - Premium"})]}),c.jsxs("select",{value:O.minRating,onChange:K=>R(ie=>({...ie,minRating:parseFloat(K.target.value)})),className:"px-3 py-2 border border-brand-burgundy/20 rounded-md bg-white text-brand-burgundy",children:[c.jsx("option",{value:0,children:"All Ratings"}),c.jsx("option",{value:4.5,children:"4.5+ Stars"}),c.jsx("option",{value:4,children:"4.0+ Stars"}),c.jsx("option",{value:3.5,children:"3.5+ Stars"})]}),c.jsx(Et,{onClick:G,variant:"outline",className:"border-brand-burgundy/20 text-brand-burgundy hover:bg-brand-burgundy/5",children:"Clear"})]})]}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:["Showing ",r.length," of ",e.length," venues"]}),I&&c.jsxs("div",{className:"flex items-center gap-2 text-xs text-brand-burgundy/60",children:[c.jsx("div",{className:"w-3 h-3 border-2 border-brand-burgundy/30 border-t-brand-burgundy rounded-full animate-spin"}),c.jsx("span",{children:"Getting your location..."})]}),p&&!I&&p.lat!==6.5244&&c.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-600",children:[c.jsx(r4,{className:"h-3 w-3"}),c.jsx("span",{children:"Location detected"})]})]}),c.jsxs("div",{className:"flex gap-4 text-xs",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),c.jsx("span",{children:"Restaurants"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-500"}),c.jsx("span",{children:"Clubs"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500"}),c.jsx("span",{children:"Lounges"})]})]})]})]})}),c.jsx(kt,{className:"overflow-hidden shadow-xl border-brand-burgundy/10",children:c.jsxs("div",{className:"h-[600px] relative",children:[p&&c.jsxs(Et,{onClick:ee,className:"absolute top-4 right-4 z-10 bg-white text-brand-burgundy border border-brand-burgundy/20 hover:bg-brand-burgundy hover:text-white shadow-lg",size:"sm",children:[c.jsx(r4,{className:"h-4 w-4 mr-2"}),"My Location"]}),h?c.jsx("div",{className:"flex items-center justify-center h-full bg-brand-cream/50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-burgundy mx-auto mb-4"}),c.jsx("p",{className:"text-brand-burgundy",children:"Loading venues..."})]})}):c.jsxs(aUe,{ref:q,initialViewState:{latitude:b.lat,longitude:b.lng,zoom:E},style:{width:"100%",height:"100%"},mapboxAccessToken:"pk.eyJ1IjoiemFrbWVhZG93czE2IiwiYSI6ImNtYzFtanRxajA1NnMyaXM5NGpicGFwdXIifQ.rE6eaOez5Q6U6t-y58gzpQ",mapStyle:"mapbox://styles/mapbox/light-v11",interactiveLayerIds:["venues"],children:[p&&c.jsx(jU,{latitude:p.lat,longitude:p.lng,children:c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full border-2 border-white shadow-lg animate-pulse"}),c.jsx("div",{className:"absolute -top-1 -left-1 w-6 h-6 bg-blue-500/20 rounded-full animate-ping"})]})}),r.map(K=>c.jsx(jU,{latitude:K.lat,longitude:K.lng,onClick:()=>s(K),children:c.jsx("div",{className:"cursor-pointer transform hover:scale-110 transition-transform duration-200",style:{color:F(K)},children:c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"w-8 h-8 rounded-full border-3 border-white shadow-lg flex items-center justify-center text-white font-bold text-sm",style:{backgroundColor:F(K)},children:X(K.type)}),c.jsx("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2",children:c.jsx("div",{className:"w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent",style:{borderTopColor:F(K)}})})]})})},K.id)),o&&c.jsx(sUe,{latitude:o.lat,longitude:o.lng,onClose:()=>s(null),closeButton:!0,closeOnClick:!1,offsetTop:-10,className:"venue-popup",children:c.jsxs("div",{className:"p-0 max-w-sm",children:[c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:o.image,alt:o.name,className:"w-full h-32 object-cover rounded-t-lg"}),c.jsx(bn,{className:"absolute top-2 right-2 bg-white/90 text-brand-burgundy",children:o.type.charAt(0).toUpperCase()+o.type.slice(1)})]}),c.jsxs("div",{className:"p-4",children:[c.jsx("h3",{className:"font-heading text-lg text-brand-burgundy mb-2",children:o.name}),c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.rating&&c.jsxs("div",{className:"flex items-center",children:[c.jsx(sa,{className:"h-4 w-4 text-yellow-400 fill-current"}),c.jsx("span",{className:"text-sm font-medium ml-1",children:o.rating})]}),c.jsx(bn,{variant:"outline",className:"text-xs",children:o.price_range})]}),c.jsx("p",{className:"text-sm text-brand-burgundy/70 mb-3 line-clamp-2",children:o.description}),c.jsxs("div",{className:"space-y-2 text-xs text-brand-burgundy/60",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(oa,{className:"h-3 w-3"}),c.jsxs("span",{children:[o.address,", ",o.city]})]}),o.contact_phone&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(of,{className:"h-3 w-3"}),c.jsx("span",{children:o.contact_phone})]})]}),c.jsx(Et,{className:"w-full mt-3 bg-brand-burgundy text-white hover:bg-brand-burgundy/90",onClick:()=>window.location.href=`/venues/${o.id}`,children:"View Details & Book"})]})]})})]})]})}),c.jsxs("div",{className:"mt-8",children:[c.jsxs("h2",{className:"text-2xl font-heading text-brand-burgundy mb-4",children:["Featured Venues (",r.length,")"]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.slice(0,6).map(K=>c.jsxs(kt,{className:"overflow-hidden hover:shadow-lg transition-shadow cursor-pointer bg-white border-brand-burgundy/10",children:[c.jsxs("div",{className:"relative h-48",children:[c.jsx("img",{src:K.image,alt:K.name,className:"w-full h-full object-cover"}),c.jsx(bn,{className:"absolute top-3 right-3 bg-white/90 text-brand-burgundy",children:K.type.charAt(0).toUpperCase()+K.type.slice(1)})]}),c.jsxs(rr,{className:"p-4",children:[c.jsx("h3",{className:"font-heading text-xl text-brand-burgundy mb-2",children:K.name}),c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[K.rating&&c.jsxs("div",{className:"flex items-center",children:[c.jsx(sa,{className:"h-4 w-4 text-yellow-400 fill-current"}),c.jsx("span",{className:"text-sm font-medium ml-1",children:K.rating})]}),c.jsx(bn,{variant:"outline",children:K.price_range})]}),c.jsx("p",{className:"text-sm text-brand-burgundy/70 mb-3 line-clamp-2",children:K.description}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-brand-burgundy/60 mb-3",children:[c.jsx(oa,{className:"h-3 w-3"}),c.jsx("span",{children:K.city})]}),c.jsx(Et,{className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",onClick:()=>window.location.href=`/venues/${K.id}`,children:"View Details"})]})]},K.id))})]})]})})},cUe=()=>{const[e,t]=D.useState([]),[r,n]=D.useState(!1),[o,s]=D.useState(null),[h,i]=D.useState(""),p=async()=>{try{n(!0),i("Testing connection...");const{data:C,error:k}=await Ve.from("venues").select("count");if(k)throw k;i(" Connection successful!")}catch(C){i(" Connection failed: "+C.message),console.error("Connection error:",C)}finally{n(!1)}},y=async()=>{try{n(!0),i("Fetching venues...");const{data:C,error:k}=await Ve.from("venues").select("*");if(k)throw k;t(C),i(" Fetched "+C.length+" venues")}catch(C){s(C.message),i(" Fetch failed: "+C.message),console.error("Fetch error:",C)}finally{n(!1)}},b=async()=>{try{n(!0),i("Inserting new venue...");const{data:C,error:k}=await Ve.from("venues").insert([{name:"Test Restaurant",type:"restaurant",price_range:"$$",rating:4.5,vibe:"Sophisticated",address:"123 Test St",city:"Lagos",state:"Lagos",country:"Nigeria",latitude:6.5244,longitude:3.3792}]).select();if(k)throw k;i(" Inserted new venue successfully"),y()}catch(C){i(" Insert failed: "+C.message),console.error("Insert error:",C)}finally{n(!1)}},_=async C=>{try{n(!0),i("Updating venue...");const{data:k,error:N}=await Ve.from("venues").update({rating:4.8}).eq("id",C).select();if(N)throw N;i(" Updated venue successfully"),y()}catch(k){i(" Update failed: "+k.message),console.error("Update error:",k)}finally{n(!1)}},E=async C=>{try{n(!0),i("Deleting venue...");const{error:k}=await Ve.from("venues").delete().eq("id",C);if(k)throw k;i(" Deleted venue successfully"),y()}catch(k){i(" Delete failed: "+k.message),console.error("Delete error:",k)}finally{n(!1)}};return D.useEffect(()=>{p()},[]),c.jsxs("div",{className:"p-4",children:[c.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Supabase Connection Test"}),c.jsxs("div",{className:"mb-4 p-4 bg-gray-100 rounded",children:[c.jsxs("p",{className:"font-semibold",children:["Test Result: ",h]}),r&&c.jsx("p",{className:"text-brand-burgundy",children:"Loading..."}),o&&c.jsxs("p",{className:"text-red-500",children:["Error: ",o]})]}),c.jsxs("div",{className:"space-y-4 mb-8",children:[c.jsx("button",{onClick:p,className:"bg-brand-burgundy text-white px-4 py-2 rounded mr-2",disabled:r,children:"Test Connection"}),c.jsx("button",{onClick:y,className:"bg-brand-burgundy text-white px-4 py-2 rounded mr-2",disabled:r,children:"Fetch All Venues"}),c.jsx("button",{onClick:b,className:"bg-brand-burgundy text-white px-4 py-2 rounded mr-2",disabled:r,children:"Insert Test Venue"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Venues:"}),e.map(C=>c.jsxs("div",{className:"border p-4 rounded",children:[c.jsx("h3",{className:"font-bold",children:C.name}),c.jsxs("p",{children:["Type: ",C.type]}),c.jsxs("p",{children:["Price Range: ",C.price_range]}),c.jsxs("p",{children:["Rating: ",C.rating]}),c.jsxs("p",{children:["Location: ",C.city,", ",C.country]}),c.jsxs("div",{className:"mt-2 space-x-2",children:[c.jsx("button",{onClick:()=>_(C.id),className:"bg-brand-gold text-brand-burgundy px-3 py-1 rounded text-sm",disabled:r,children:"Update Rating"}),c.jsx("button",{onClick:()=>E(C.id),className:"bg-red-500 text-white px-3 py-1 rounded text-sm",disabled:r,children:"Delete"})]})]},C.id))]})]})},To=(e,t)=>{throw console.error(`Error in ${t}:`,e),e},uUe={getProfile:async e=>{try{console.log("Fetching profile for user:",e);const{data:t,error:r}=await Ve.from("user_profiles").select("*").eq("id",e).single();return r&&To(r,"getProfile"),console.log("Profile data:",t),t}catch(t){To(t,"getProfile")}},updateProfile:async(e,t)=>{try{console.log("Updating profile for user:",e,"with updates:",t);const{data:r,error:n}=await Ve.from("user_profiles").update(t).eq("id",e).select().single();return n&&To(n,"updateProfile"),console.log("Updated profile:",r),r}catch(r){To(r,"updateProfile")}}},CU={getSavedVenues:async e=>{try{console.log("Fetching saved venues for user:",e);const{data:t,error:r}=await Ve.from("saved_venues").select(`
          *,
          venues (*)
        `).eq("user_id",e);return r&&To(r,"getSavedVenues"),console.log("Saved venues:",t),t}catch(t){To(t,"getSavedVenues")}},saveVenue:async(e,t)=>{try{console.log("Saving venue:",t,"for user:",e);const{data:r,error:n}=await Ve.from("saved_venues").insert([{user_id:e,venue_id:t}]).select();return n&&To(n,"saveVenue"),console.log("Saved venue:",r),r}catch(r){To(r,"saveVenue")}},removeSavedVenue:async(e,t)=>{try{console.log("Removing venue:",t,"for user:",e);const{error:r}=await Ve.from("saved_venues").delete().eq("user_id",e).eq("venue_id",t);r&&To(r,"removeSavedVenue"),console.log("Venue removed successfully")}catch(r){To(r,"removeSavedVenue")}}},PU={getUserBookings:async e=>{try{console.log("Fetching bookings for user:",e);const{data:t,error:r}=await Ve.from("user_bookings").select(`
          *,
          venues (*)
        `).eq("user_id",e).order("booking_date",{ascending:!1});return r&&To(r,"getUserBookings"),console.log("User bookings:",t),t}catch(t){To(t,"getUserBookings")}},createBooking:async e=>{try{console.log("Creating booking:",e);const{data:t,error:r}=await Ve.from("user_bookings").insert([e]).select();return r&&To(r,"createBooking"),console.log("Created booking:",t),t}catch(t){To(t,"createBooking")}},updateBookingStatus:async(e,t)=>{try{console.log("Updating booking:",e,"to status:",t);const{data:r,error:n}=await Ve.from("user_bookings").update({status:t}).eq("id",e).select();return n&&To(n,"updateBookingStatus"),console.log("Updated booking:",r),r}catch(r){To(r,"updateBookingStatus")}}},dUe=()=>{const{user:e,signIn:t,signUp:r,signOut:n}=fg(),[o,s]=D.useState(!1),[h,i]=D.useState({email:"",password:""}),[p,y]=D.useState({email:"",password:"",confirm:""}),[b,_]=D.useState(null),[E,C]=D.useState(null),[k,N]=D.useState(null),[I,B]=D.useState([]),[O,R]=D.useState([]),[q,F]=D.useState(!1);D.useEffect(()=>{e&&X()},[e]);const X=async()=>{try{F(!0);const K=await uUe.getProfile(e.id);N(K);const ie=await CU.getSavedVenues(e.id);B(ie);const pe=await PU.getUserBookings(e.id);R(pe)}catch(K){console.error("Error loading user data:",K)}finally{F(!1)}},G=async K=>{K.preventDefault();try{F(!0);const{error:ie}=await t(h);if(ie)throw ie}catch(ie){_(ie.message)}finally{F(!1)}},ee=async K=>{if(K.preventDefault(),p.password!==p.confirm){C("Passwords do not match");return}try{F(!0);const{error:ie}=await r({email:p.email,password:p.password});if(ie)throw ie}catch(ie){C(ie.message)}finally{F(!1)}};return e?c.jsxs("div",{className:"container py-8",children:[c.jsxs("div",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-brand-burgundy",children:"Test Page"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Testing authentication and API functionality"})]}),c.jsx(Et,{onClick:n,variant:"outline",children:"Sign Out"})]}),c.jsxs("div",{className:"grid gap-6",children:[c.jsxs(kt,{className:"p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Profile Information"}),q?c.jsx("p",{children:"Loading..."}):k?c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Email:"})," ",e.email]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Name:"})," ",k.first_name," ",k.last_name]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Phone:"})," ",k.phone_number||"Not set"]})]}):c.jsx("p",{children:"No profile data found"})]}),c.jsxs(kt,{className:"p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Saved Venues"}),q?c.jsx("p",{children:"Loading..."}):I.length>0?c.jsx("div",{className:"grid gap-4",children:I.map(K=>c.jsxs(kt,{className:"p-4",children:[c.jsx("h3",{className:"font-semibold",children:K.venues.name}),c.jsx("p",{className:"text-sm text-brand-burgundy/70",children:K.venues.type}),c.jsx(Et,{onClick:()=>CU.removeSavedVenue(e.id,K.venue_id),variant:"outline",className:"mt-2 text-red-500 border-red-500 hover:bg-red-50",children:"Remove"})]},K.id))}):c.jsx("p",{children:"No saved venues"})]}),c.jsxs(kt,{className:"p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Bookings"}),q?c.jsx("p",{children:"Loading..."}):O.length>0?c.jsx("div",{className:"grid gap-4",children:O.map(K=>c.jsx(kt,{className:"p-4",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold",children:K.venues.name}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[new Date(K.booking_date).toLocaleDateString()," at ",K.start_time]}),c.jsxs("p",{className:"text-sm text-brand-burgundy/70",children:[K.number_of_guests," guests"]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm font-medium text-brand-burgundy",children:K.status.charAt(0).toUpperCase()+K.status.slice(1)}),K.status==="confirmed"&&c.jsx(Et,{onClick:()=>PU.updateBookingStatus(K.id,"cancelled"),variant:"outline",className:"mt-2 text-red-500 border-red-500 hover:bg-red-50",children:"Cancel"})]})]})},K.id))}):c.jsx("p",{children:"No bookings found"})]})]})]}):c.jsx("div",{className:"container max-w-md mx-auto mt-16 p-8",children:c.jsxs(kt,{className:"p-6",children:[c.jsx("h2",{className:"text-2xl font-bold mb-4 text-brand-burgundy",children:o?"Sign Up":"Login"}),o?c.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"email",children:"Email"}),c.jsx(Xt,{id:"email",type:"email",value:p.email,onChange:K=>y({...p,email:K.target.value}),required:!0})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"password",children:"Password"}),c.jsx(Xt,{id:"password",type:"password",value:p.password,onChange:K=>y({...p,password:K.target.value}),required:!0})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"confirm",children:"Confirm Password"}),c.jsx(Xt,{id:"confirm",type:"password",value:p.confirm,onChange:K=>y({...p,confirm:K.target.value}),required:!0})]}),E&&c.jsx("div",{className:"text-red-500",children:E}),c.jsx(Et,{type:"submit",className:"w-full",disabled:q,children:q?"Signing up...":"Sign Up"}),c.jsx("div",{className:"text-center",children:c.jsx("button",{type:"button",onClick:()=>s(!1),className:"text-brand-burgundy hover:underline",children:"Already have an account? Login"})})]}):c.jsxs("form",{onSubmit:G,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"email",children:"Email"}),c.jsx(Xt,{id:"email",type:"email",value:h.email,onChange:K=>i({...h,email:K.target.value}),required:!0})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"password",children:"Password"}),c.jsx(Xt,{id:"password",type:"password",value:h.password,onChange:K=>i({...h,password:K.target.value}),required:!0})]}),b&&c.jsx("div",{className:"text-red-500",children:b}),c.jsx(Et,{type:"submit",className:"w-full",disabled:q,children:q?"Logging in...":"Login"}),c.jsx("div",{className:"text-center",children:c.jsx("button",{type:"button",onClick:()=>s(!0),className:"text-brand-burgundy hover:underline",children:"Don't have an account? Sign up"})})]})]})})},hUe=()=>{const e=Array.from({length:50},(t,r)=>({id:r,x:Math.random()*100,y:Math.random()*100,delay:Math.random()*2,duration:3+Math.random()*2}));return c.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.map(t=>c.jsx(nt.div,{className:"absolute w-1 h-1 bg-white/20 rounded-full",style:{left:`${t.x}%`,top:`${t.y}%`},animate:{y:[0,-30,0],opacity:[0,1,0],scale:[.5,1,.5]},transition:{duration:t.duration,repeat:1/0,delay:t.delay,ease:"easeInOut"}},t.id))})},fUe=()=>c.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[c.jsx(nt.div,{className:"absolute inset-0 opacity-50",animate:{background:["linear-gradient(45deg, #8B1538, #A0263A, #8B1538)","linear-gradient(135deg, #A0263A, #B8344F, #A0263A)","linear-gradient(225deg, #8B1538, #A0263A, #8B1538)"]},transition:{duration:8,repeat:1/0,ease:"easeInOut"}}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-brand-burgundy/90 via-brand-burgundy-light/80 to-brand-burgundy/90"})]}),pUe=({text:e,delay:t=0})=>{const[r,n]=D.useState(""),[o,s]=D.useState(!0);return D.useEffect(()=>{const h=setTimeout(()=>{let i=0;const p=setInterval(()=>{i<=e.length?(n(e.slice(0,i)),i++):(clearInterval(p),s(!1))},100);return()=>clearInterval(p)},t);return()=>clearTimeout(h)},[e,t]),c.jsxs("span",{children:[r,o&&c.jsx(nt.span,{animate:{opacity:[1,0]},transition:{duration:.5,repeat:1/0,ease:"easeInOut"},className:"inline-block w-0.5 h-8 md:h-12 bg-white/90 ml-1"})]})},mUe=()=>{const[e,t]=D.useState(!1),[r,n]=D.useState(!1),o=zi(),s=ZG();D.useEffect(()=>{n(!0),s.start({opacity:1,y:0,transition:{duration:1,ease:"easeOut"}})},[s]);const h=[{id:"restaurant",name:"Restaurants",description:"Discover the finest dining experiences in Lagos",icon:m2,color:"from-orange-600 to-red-600",count:"50+ venues",features:["Fine Dining","Private Rooms","Chef's Table"]},{id:"club",name:"Clubs",description:"Experience the vibrant nightlife and premium entertainment",icon:A8,color:"from-purple-600 to-pink-600",count:"30+ venues",features:["VIP Tables","Premium Sound","Top DJs"]},{id:"lounge",name:"Lounges",description:"Relax in sophisticated lounges across the city",icon:Mc,color:"from-blue-600 to-indigo-600",count:"25+ venues",features:["Cocktail Bar","Sky Views","Premium Service"]}],i=()=>{t(!0)},p=()=>{o("/venue-owner/login")},y=E=>{o(`/venues?type=${E}`)},b={hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.3,staggerChildren:.2}}},_={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100,damping:10}}};return c.jsx("div",{className:"min-h-screen bg-brand-cream overflow-hidden",children:c.jsx(GG,{mode:"wait",children:e?c.jsxs(nt.section,{className:"relative bg-brand-cream py-20 min-h-screen flex items-center overflow-hidden",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[c.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[c.jsx(nt.div,{className:"absolute inset-0 opacity-5",animate:{backgroundImage:["radial-gradient(circle at 20% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 80% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 40% 60%, #8B1538 0%, transparent 50%)","radial-gradient(circle at 80% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 20% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 60% 40%, #8B1538 0%, transparent 50%)","radial-gradient(circle at 20% 20%, #8B1538 0%, transparent 50%), radial-gradient(circle at 80% 80%, #DAA520 0%, transparent 50%), radial-gradient(circle at 40% 60%, #8B1538 0%, transparent 50%)"]},transition:{duration:10,repeat:1/0,ease:"easeInOut"}}),Array.from({length:8}).map((E,C)=>c.jsx(nt.div,{className:"absolute w-20 h-20 border-2 border-brand-burgundy/10 rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-30,0],x:[0,15,0],rotate:[0,180,360],scale:[1,1.2,1]},transition:{duration:8+Math.random()*4,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},C))]}),c.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[c.jsxs(nt.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"text-center mb-20",children:[c.jsx(nt.div,{className:"inline-block mb-6",animate:{rotate:[0,2,-2,0],scale:[1,1.02,1]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:c.jsxs("span",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-brand-burgundy/10 to-brand-gold/10 backdrop-blur-sm border border-brand-burgundy/20 rounded-full px-6 py-2 text-brand-burgundy/70 font-medium",children:[c.jsx(_1,{className:"w-4 h-4 text-brand-gold"}),"Premium Venue Categories"]})}),c.jsxs(nt.h2,{className:"text-5xl md:text-6xl lg:text-7xl font-heading text-brand-burgundy mb-6 font-bold",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:1,delay:.3},children:["Browse by"," ",c.jsxs(nt.span,{className:"relative inline-block",whileHover:{scale:1.05},children:[c.jsx("span",{className:"text-brand-gold font-extrabold",children:"Category"}),c.jsx(nt.div,{className:"absolute -bottom-2 left-0 right-0 h-1 bg-gradient-to-r from-brand-gold to-brand-burgundy rounded-full",initial:{scaleX:0},animate:{scaleX:1},transition:{duration:1,delay:.8}})]})]}),c.jsx(nt.p,{className:"text-xl md:text-2xl text-brand-burgundy/70 max-w-3xl mx-auto leading-relaxed",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.5},children:"Choose your perfect venue type and discover the best experiences Lagos has to offer"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 lg:gap-12",children:h.map((E,C)=>c.jsx(nt.div,{initial:{opacity:0,y:60,rotateY:-15},animate:{opacity:1,y:0,rotateY:0},transition:{duration:.8,delay:.6+C*.15,ease:"easeOut"},whileHover:{y:-15,scale:1.03,rotateY:5,transition:{duration:.4,ease:"easeOut",type:"spring",stiffness:200}},className:"group cursor-pointer perspective-1000",onClick:()=>y(E.id),style:{perspective:"1000px"},children:c.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl overflow-hidden border-2 border-brand-burgundy/10 group-hover:border-brand-gold/50 group-hover:shadow-3xl transition-all duration-500 transform-gpu",children:[c.jsxs(nt.div,{className:`relative h-80 bg-gradient-to-br ${E.color} flex items-center justify-center overflow-hidden`,whileHover:{scale:1.02},transition:{duration:.4},children:[c.jsx(nt.div,{className:"absolute inset-0 opacity-20",animate:{background:["radial-gradient(circle at 0% 0%, rgba(255,255,255,0.3) 0%, transparent 50%)","radial-gradient(circle at 100% 100%, rgba(255,255,255,0.3) 0%, transparent 50%)","radial-gradient(circle at 0% 0%, rgba(255,255,255,0.3) 0%, transparent 50%)"]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}}),Array.from({length:12}).map((k,N)=>c.jsx(nt.div,{className:"absolute w-2 h-2 bg-white/30 rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-20,0],x:[0,10,0],opacity:[.3,.8,.3],scale:[.5,1,.5]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},N)),c.jsx(nt.div,{className:"relative z-10",whileHover:{scale:1.15,rotate:[0,-5,5,0],y:-5},transition:{duration:.4,rotate:{duration:.6}},children:c.jsx(nt.div,{className:"relative",animate:{filter:["drop-shadow(0 0 20px rgba(255,255,255,0.5))","drop-shadow(0 0 30px rgba(255,255,255,0.8))","drop-shadow(0 0 20px rgba(255,255,255,0.5))"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:c.jsx(E.icon,{className:"w-28 h-28 text-white drop-shadow-2xl"})})}),c.jsx(nt.div,{className:"absolute top-6 right-6 bg-white/25 backdrop-blur-sm rounded-2xl px-4 py-2 border border-white/30",initial:{opacity:0,x:30,scale:.8},animate:{opacity:1,x:0,scale:1},transition:{delay:.8+C*.1,duration:.5},whileHover:{scale:1.05,y:-2},children:c.jsx("span",{className:"text-white text-sm font-bold",children:E.count})}),c.jsx(nt.div,{className:"absolute bottom-6 left-6 w-8 h-8 border-l-2 border-b-2 border-white/40",animate:{scale:[1,1.1,1],opacity:[.4,.8,.4]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})]}),c.jsxs(nt.div,{className:"p-8 relative",whileHover:{backgroundColor:"rgba(139, 21, 56, 0.02)"},transition:{duration:.3},children:[c.jsx(nt.h3,{className:"text-3xl md:text-4xl font-bold text-brand-burgundy mb-4 group-hover:text-brand-gold transition-colors duration-300",whileHover:{x:5},children:E.name}),c.jsx(nt.p,{className:"text-brand-burgundy/70 text-lg mb-8 leading-relaxed",initial:{opacity:.7},whileHover:{opacity:1},children:E.description}),c.jsx("div",{className:"space-y-3 mb-8",children:E.features.map((k,N)=>c.jsxs(nt.div,{className:"flex items-center text-brand-burgundy/60 group-hover:text-brand-burgundy/80",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1+C*.1+N*.1},whileHover:{x:5,scale:1.02},children:[c.jsx(nt.div,{className:"mr-3",animate:{rotate:[0,180,360]},transition:{duration:8,repeat:1/0,ease:"linear",delay:N*.2},children:c.jsx(sa,{className:"w-4 h-4 text-brand-gold fill-brand-gold"})}),c.jsx("span",{className:"font-medium",children:k})]},N))}),c.jsxs(nt.div,{className:"relative overflow-hidden bg-gradient-to-r from-brand-burgundy/5 to-brand-gold/5 rounded-2xl p-4 group-hover:from-brand-burgundy/10 group-hover:to-brand-gold/10 transition-all duration-300",whileHover:{scale:1.02},children:[c.jsx(nt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/20 to-brand-burgundy/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.8}}),c.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[c.jsxs("div",{children:[c.jsxs(nt.span,{className:"font-bold text-brand-burgundy group-hover:text-brand-gold transition-colors duration-300 text-lg",whileHover:{scale:1.05},children:["Explore ",E.name]}),c.jsx("p",{className:"text-sm text-brand-burgundy/60 mt-1",children:"Discover premium venues"})]}),c.jsx(nt.div,{className:"flex items-center justify-center w-12 h-12 bg-brand-burgundy group-hover:bg-brand-gold rounded-full transition-colors duration-300",whileHover:{scale:1.1,rotate:90,boxShadow:"0 8px 25px rgba(139, 21, 56, 0.3)"},whileTap:{scale:.9},children:c.jsx(jl,{className:"w-5 h-5 text-white group-hover:text-brand-burgundy transition-colors duration-300"})})]})]}),c.jsx(nt.div,{className:"absolute top-4 right-4 w-16 h-16 bg-gradient-to-br from-brand-gold/10 to-brand-burgundy/10 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500",animate:{scale:[1,1.2,1],rotate:[0,180,360]},transition:{duration:8,repeat:1/0,ease:"linear"}})]}),c.jsx(nt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/0 via-brand-gold/5 to-brand-burgundy/0 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-500",initial:{scale:.8,opacity:0},whileHover:{scale:1,opacity:1}})]})},E.id))}),c.jsxs(nt.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:1.2},className:"text-center mt-20",children:[c.jsx(nt.p,{className:"text-brand-burgundy/60 mb-6 text-lg",animate:{opacity:[.6,1,.6]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:"Can't find what you're looking for?"}),c.jsx(nt.button,{whileHover:{scale:1.05,y:-3,boxShadow:"0 15px 35px rgba(139, 21, 56, 0.2)"},whileTap:{scale:.95},onClick:()=>o("/venues"),className:"bg-gradient-to-r from-brand-burgundy to-brand-burgundy-light hover:from-brand-gold hover:to-yellow-500 text-white px-8 py-4 rounded-2xl font-semibold text-lg shadow-xl transition-all duration-300",children:"Browse All Venues"})]})]})]},"categories"):c.jsxs(nt.section,{className:"relative bg-brand-burgundy flex items-center justify-center overflow-hidden min-h-screen",initial:{opacity:1},exit:{opacity:0,scale:.95,transition:{duration:.6,ease:"easeInOut"}},children:[c.jsx(fUe,{}),c.jsx(hUe,{}),c.jsx("div",{className:"container mx-auto px-4 flex flex-col items-center justify-center h-full relative z-10",children:c.jsxs(nt.div,{className:"max-w-5xl w-full text-white text-center",variants:b,initial:"hidden",animate:"visible",children:[c.jsx(nt.div,{variants:_,className:"mb-8 pt-8 pb-4 md:pt-0 md:pb-0",children:c.jsxs(nt.div,{className:"inline-flex items-center gap-3 mb-6",whileHover:{scale:1.05},transition:{type:"spring",stiffness:400,damping:10},children:[c.jsx(nt.div,{className:"p-3 bg-brand-gold rounded-2xl",animate:{rotate:[0,5,-5,0],scale:[1,1.1,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:c.jsx(_1,{className:"w-8 h-8 text-brand-burgundy"})}),c.jsx("span",{className:"text-2xl font-bold tracking-wider text-brand-gold",children:"VIP CLUB"})]})}),c.jsxs(nt.h1,{variants:_,className:"text-5xl md:text-7xl lg:text-8xl font-heading mb-8 font-bold tracking-tight leading-tight",children:[c.jsx(nt.span,{className:"block mb-4 text-white/90",initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.8,delay:.5},children:"Discover"}),c.jsx(nt.span,{className:"block text-6xl md:text-8xl lg:text-9xl mb-4",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:1,delay:.8},children:c.jsx("span",{className:"text-brand-gold font-extrabold drop-shadow-2xl",children:c.jsx(pUe,{text:"Eddys'",delay:1200})})}),c.jsx(nt.span,{className:"block text-4xl md:text-6xl lg:text-7xl text-white/95",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:1.5},children:"Finest Venues"})]}),c.jsx(nt.p,{variants:_,className:"text-xl md:text-2xl lg:text-3xl mb-12 text-white/80 font-medium max-w-3xl mx-auto leading-relaxed",children:"Book tables, enjoy exclusive experiences, and make unforgettable memories in Lagos' most prestigious venues"}),c.jsxs(nt.div,{variants:_,className:"flex flex-col md:flex-row gap-6 lg:gap-8 justify-center items-center mb-12",children:[c.jsxs(nt.button,{whileHover:{scale:1.05,boxShadow:"0 20px 40px rgba(0,0,0,0.3)",y:-2},whileTap:{scale:.98},onClick:i,className:"group relative overflow-hidden flex items-center gap-4 bg-brand-cream text-brand-burgundy text-xl lg:text-2xl px-10 py-5 rounded-2xl font-semibold shadow-2xl hover:shadow-3xl transition-all duration-300 min-w-[250px] justify-center",children:[c.jsx(nt.div,{className:"absolute inset-0 bg-gradient-to-r from-brand-gold/20 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6}}),c.jsx(ji,{className:"w-6 h-6 group-hover:scale-110 transition-transform duration-200"}),c.jsx("span",{children:"I'm a Customer"}),c.jsx(jl,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-200"})]}),c.jsxs(nt.button,{whileHover:{scale:1.05,y:-2,boxShadow:"0 20px 40px rgba(255,255,255,0.1)"},whileTap:{scale:.98},onClick:p,className:"group relative overflow-hidden flex items-center gap-4 bg-transparent border-2 border-brand-cream text-brand-cream text-xl lg:text-2xl px-10 py-5 rounded-2xl font-semibold shadow-2xl hover:bg-brand-cream/10 backdrop-blur-sm transition-all duration-300 min-w-[250px] justify-center",children:[c.jsx(nt.div,{className:"absolute inset-0 bg-brand-cream/10",initial:{scale:0,opacity:0},whileHover:{scale:1,opacity:1},transition:{duration:.3}}),c.jsx(dd,{className:"w-6 h-6 group-hover:scale-110 transition-transform duration-200"}),c.jsx("span",{children:"I'm a Venue Owner"}),c.jsx(jl,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-200"})]})]}),c.jsxs(nt.div,{variants:_,className:"flex flex-wrap justify-center items-center gap-6 md:gap-8 text-white/60 text-sm pt-4 pb-8 md:pt-0 md:pb-0",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(sa,{className:"w-4 h-4 text-brand-gold fill-brand-gold"}),c.jsx("span",{children:"4.9/5 Customer Rating"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Mc,{className:"w-4 h-4 text-brand-gold"}),c.jsx("span",{children:"100+ Premium Venues"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Bi,{className:"w-4 h-4 text-brand-gold"}),c.jsx("span",{children:"50K+ Happy Customers"})]})]})]})})]},"hero")})})},gUe=()=>{const[e,t]=D.useState(""),[r,n]=D.useState(!1),[o,s]=D.useState([]),{toast:h}=Co(),i={serviceId:"service_55v7svp",templateId:"template_wh2h7sn",publicKey:"_DltRvDA4UAiyUt1E"},p=(b,_="info")=>{const E=new Date().toLocaleTimeString();s(C=>[...C,{message:b,type:_,timestamp:E}])},y=async()=>{if(!e){h({title:"Please enter an email",variant:"destructive"});return}n(!0),s([]);try{p("Checking EmailJS configuration...","info"),!i.serviceId||!i.templateId||i.publicKey,p(" Configuration looks good","success"),p(`Service ID: ${i.serviceId}`,"info"),p(`Template ID: ${i.templateId}`,"info"),p("Testing with simple parameters...","info");const b={to_email:e,to_name:"Test User",from_name:"VIP Club",subject:"VIP Club Test Email",message:"This is a test email to verify EmailJS configuration."};try{const C=await Ca.send(i.serviceId,i.templateId,b);p(" Simple test successful!","success"),p(`Response: ${C.text}`,"success")}catch(C){p(` Simple test failed: ${C.text||C.message}`,"error"),p(`Error status: ${C.status}`,"error")}p("Testing with alternative parameter names...","info");const _={user_email:e,email:e,to:e,recipient:e,user_name:"Test User",name:"Test User",from_name:"VIP Club",message:"Testing alternative parameter names for EmailJS template."};try{const C=await Ca.send(i.serviceId,i.templateId,_);p(" Alternative parameters test successful!","success"),p(`Response: ${C.text}`,"success")}catch(C){p(` Alternative parameters test failed: ${C.text||C.message}`,"error"),p(`Error status: ${C.status}`,"error")}p("Testing with your template parameters...","info");const E={customerName:"Test Customer",customerEmail:e,customerPhone:"+234 XXX XXX XXXX",bookingReference:"VIP-TEST123",partySize:"2",bookingDate:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),bookingTime:"7:00 PM",bookingDuration:"4",tableNumber:"VIP-001",tableType:"VIP Table",tableCapacity:"2",tableLocation:"Prime Location",tableFeatures:"Premium seating with excellent view",venueName:"Test Venue",venueDescription:"Experience luxury dining and entertainment in Lagos' most exclusive venue.",venueAddress:"Lagos, Nigeria",venuePhone:"+234 XXX XXX XXXX",venueDressCode:"Smart Casual",venueParking:"Valet parking available",venueCuisine:"International cuisine",venueHours:"6:00 PM - 2:00 AM",specialRequests:"None specified",viewBookingUrl:window.location.origin+"/profile",modifyBookingUrl:window.location.origin+"/profile",cancelBookingUrl:window.location.origin+"/profile",websiteUrl:window.location.origin,supportUrl:"mailto:support@vipclub.com",unsubscribeUrl:window.location.origin+"/settings"};try{const C=await Ca.send(i.serviceId,i.templateId,E);p(" Booking test successful!","success"),p(`Response: ${C.text}`,"success")}catch(C){p(` Booking test failed: ${C.text||C.message}`,"error"),p(`Error status: ${C.status}`,"error")}h({title:"Email tests completed",description:"Check the results below and your email inbox"})}catch(b){p(` Unexpected error: ${b.message}`,"error")}finally{n(!1)}};return c.jsx("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:c.jsxs(kt,{children:[c.jsxs(zr,{children:[c.jsx($r,{className:"text-brand-burgundy",children:"EmailJS Debug Test"}),c.jsx("p",{className:"text-gray-600",children:"Test your EmailJS configuration to fix booking confirmation emails"})]}),c.jsxs(rr,{className:"space-y-6",children:[c.jsxs("div",{className:"flex gap-4",children:[c.jsx(Xt,{type:"email",placeholder:"Enter your email to test",value:e,onChange:b=>t(b.target.value),className:"flex-1"}),c.jsx(Et,{onClick:y,disabled:r,className:"bg-brand-burgundy hover:bg-brand-burgundy/90",children:r?"Testing...":"Test EmailJS"})]}),c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[c.jsx("h3",{className:"font-medium mb-2",children:"Current Configuration:"}),c.jsxs("div",{className:"text-sm space-y-1",children:[c.jsxs("div",{children:["Service ID: ",c.jsx("code",{className:"bg-white px-1 rounded",children:i.serviceId})]}),c.jsxs("div",{children:["Template ID: ",c.jsx("code",{className:"bg-white px-1 rounded",children:i.templateId})]}),c.jsxs("div",{children:["Public Key: ",c.jsx("code",{className:"bg-white px-1 rounded",children:" Set"})]})]})]}),o.length>0&&c.jsxs("div",{className:"border rounded-lg p-4 bg-white max-h-96 overflow-y-auto",children:[c.jsx("h3",{className:"font-medium mb-2",children:"Test Results:"}),c.jsx("div",{className:"space-y-1 text-sm font-mono",children:o.map((b,_)=>c.jsxs("div",{className:`p-2 rounded ${b.type==="success"?"bg-green-50 text-green-800":b.type==="error"?"bg-red-50 text-red-800":"bg-gray-50 text-gray-700"}`,children:[c.jsxs("span",{className:"text-gray-500",children:["[",b.timestamp,"]"]})," ",b.message]},_))})]}),c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[c.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:"Instructions:"}),c.jsxs("ol",{className:"text-sm text-blue-700 space-y-1 list-decimal list-inside",children:[c.jsx("li",{children:"Enter your email address above"}),c.jsx("li",{children:'Click "Test EmailJS" to run the tests'}),c.jsx("li",{children:"Check the results below for any errors"}),c.jsx("li",{children:"Check your email inbox for test messages"}),c.jsx("li",{children:"If tests fail, check your EmailJS template configuration"})]})]})]})]})})};var qK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(no,function(){var r,n,o;function s(i,p){if(!r)r=p;else if(!n)n=p;else{var y="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",b={};r(b),o=p(b),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(o.workerUrl=window.URL.createObjectURL(new Blob([y],{type:"text/javascript"})))}}s(["exports"],function(i){var p=typeof self<"u"?self:{},y="2.15.0";let b;const _={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(b==null){const l=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{b={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):l}catch{b=l}}return b},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!_.API_URL)return null;try{const l=new URL(_.API_URL);return l.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":l.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},E={supported:!1,testSupport:function(l){!N&&k&&(I?B(l):C=l)}};let C,k,N=!1,I=!1;function B(l){const a=l.createTexture();l.bindTexture(l.TEXTURE_2D,a);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,k),l.isContextLost())return;E.supported=!0}catch{}l.deleteTexture(a),N=!0}p.document&&(k=p.document.createElement("img"),k.onload=function(){C&&B(C),C=null,I=!0},k.onerror=function(){N=!0,C=null},k.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const O="01";function R(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var q=F;function F(l,a,u,f){this.cx=3*l,this.bx=3*(u-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=a,this.p2x=u,this.p2y=f}F.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,a){if(a===void 0&&(a=1e-6),l<0)return 0;if(l>1)return 1;for(var u=l,f=0;f<8;f++){var g=this.sampleCurveX(u)-l;if(Math.abs(g)<a)return u;var x=this.sampleCurveDerivativeX(u);if(Math.abs(x)<1e-6)break;u-=g/x}var S=0,j=1;for(u=l,f=0;f<20&&(g=this.sampleCurveX(u),!(Math.abs(g-l)<a));f++)l>g?S=u:j=u,u=.5*(j-S)+S;return u},solve:function(l,a){return this.sampleCurveY(this.solveCurveX(l,a))}};var X=R(q),G=ee;function ee(l,a){this.x=l,this.y=a}ee.prototype={clone:function(){return new ee(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,a){return this.clone()._rotateAround(l,a)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var a=l.x-this.x,u=l.y-this.y;return a*a+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,a){return Math.atan2(this.x*a-this.y*l,this.x*l+this.y*a)},_matMult:function(l){var a=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=a,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var a=Math.cos(l),u=Math.sin(l),f=u*this.x+a*this.y;return this.x=a*this.x-u*this.y,this.y=f,this},_rotateAround:function(l,a){var u=Math.cos(l),f=Math.sin(l),g=a.y+f*(this.x-a.x)+u*(this.y-a.y);return this.x=a.x+u*(this.x-a.x)-f*(this.y-a.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ee.convert=function(l){return l instanceof ee?l:Array.isArray(l)?new ee(l[0],l[1]):l};var K=R(G);const ie=Math.PI/180,pe=180/Math.PI;function ae(l){return l*ie}function _e(l){return l*pe}const Ee=[[0,0],[1,0],[1,1],[0,1]];function xe(l){if(l<=0)return 0;if(l>=1)return 1;const a=l*l,u=a*l;return 4*(l<.5?u:3*(l-a)+u-.75)}function ce(l,a,u,f){const g=new X(l,a,u,f);return function(x){return g.solve(x)}}const ke=ce(.25,.1,.25,1);function ve(l,a,u){return Math.min(u,Math.max(a,l))}function Pe(l,a,u){return(u=ve((u-l)/(a-l),0,1))*u*(3-2*u)}function Re(l,a,u){const f=u-a,g=((l-a)%f+f)%f+a;return g===a?u:g}function Be(l,a,u){if(!l.length)return u(null,[]);let f=l.length;const g=new Array(l.length);let x=null;l.forEach((S,j)=>{a(S,(A,M)=>{A&&(x=A),g[j]=M,--f==0&&u(x,g)})})}function Fe(l){const a=[];for(const u in l)a.push(l[u]);return a}function Ge(l,...a){for(const u of a)for(const f in u)l[f]=u[f];return l}let Pt=1;function $t(){return Pt++}function nr(){return function l(a){return a?(a^Math.random()*(16>>a/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()}function Nt(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function Jt(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)}function ft(l,a){l.forEach(u=>{a[u]&&(a[u]=a[u].bind(a))})}function vt(l,a){return l.indexOf(a,l.length-a.length)!==-1}function lt(l,a,u){const f={};for(const g in l)f[g]=a.call(u||this,l[g],g,l);return f}function it(l,a,u){const f={};for(const g in l)a.call(u||this,l[g],g,l)&&(f[g]=l[g]);return f}function ar(l){return Array.isArray(l)?l.map(ar):typeof l=="object"&&l?lt(l,ar):l}const We={};function pt(l){We[l]||(typeof console<"u"&&console.warn(l),We[l]=!0)}function Wt(l,a,u){return(u.y-l.y)*(a.x-l.x)>(a.y-l.y)*(u.x-l.x)}function cr(l){let a=0;for(let u,f,g=0,x=l.length,S=x-1;g<x;S=g++)u=l[g],f=l[S],a+=(f.x-u.x)*(u.y+f.y);return a}function Gr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ln(l){const a={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,g,x)=>{const S=g||x;return a[f]=!S||S.toLowerCase(),""}),a["max-age"]){const u=parseInt(a["max-age"],10);isNaN(u)?delete a["max-age"]:a["max-age"]=u}return a}let si=null;function ki(l){if(si==null){const a=l.navigator?l.navigator.userAgent:null;si=!!l.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return si}function Hn(l){try{const a=p[l];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch{return!1}}function lo(l,a){return[l[4*a],l[4*a+1],l[4*a+2],l[4*a+3]]}const cs="mapbox-tiles";let Ll=500,Pf=50,Fo,nl;function Id(){try{return p.caches}catch{}}function Bl(){Id()&&!Fo&&(Fo=p.caches.open(cs))}function Zc(l){const a=l.indexOf("?");if(a<0)return l;const u=function(g){const x=g.indexOf("?");return x>0?g.slice(x+1).split("&"):[]}(l),f=u.filter(g=>{const x=g.split("=");return x[0]==="language"||x[0]==="worldview"});return f.length?`${l.slice(0,a)}?${f.join("&")}`:l.slice(0,a)}let Od=1/0;const zl={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(zl);class il extends Error{constructor(a,u,f){u===401&&Xe(f)&&(a+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(a),this.status=u,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const $l=Gr()?()=>self.worker&&self.worker.referrer:()=>(p.location.protocol==="blob:"?p.parent:p).location.href,Fl=function(l,a){if(!(/^file:/.test(u=l.url)||/^file:/.test($l())&&!/^\w+:/.test(u))){if(p.fetch&&p.Request&&p.AbortController&&p.Request.prototype.hasOwnProperty("signal"))return function(f,g){const x=new p.AbortController,S=new p.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:$l(),referrerPolicy:f.referrerPolicy,signal:x.signal});let j=!1,A=!1;const M=($=S.url).indexOf("sku=")>0&&Xe($);var $;f.type==="json"&&S.headers.set("Accept","application/json");const V=(Y,J,re)=>{if(A)return;if(Y&&Y.message!=="SecurityError"&&pt(Y.toString()),J&&re)return W(J);const le=Date.now();p.fetch(S).then(ge=>{if(ge.ok){const Ae=M?ge.clone():null;return W(ge,Ae,le)}return g(new il(ge.statusText,ge.status,f.url))}).catch(ge=>{ge.name!=="AbortError"&&g(new Error(`${ge.message} ${f.url}`))})},W=(Y,J,re)=>{(f.type==="arrayBuffer"?Y.arrayBuffer():f.type==="json"?Y.json():Y.text()).then(le=>{A||(J&&re&&function(ge,Ae,ye){if(Bl(),!Fo)return;const Te={status:Ae.status,statusText:Ae.statusText,headers:new p.Headers};Ae.headers.forEach((Qe,Ke)=>Te.headers.set(Ke,Qe));const Me=ln(Ae.headers.get("Cache-Control")||"");if(Me["no-store"])return;Me["max-age"]&&Te.headers.set("Expires",new Date(ye+1e3*Me["max-age"]).toUTCString());const Ne=Te.headers.get("Expires");Ne&&(new Date(Ne).getTime()-ye<42e4||function(Qe,Ke){if(nl===void 0)try{new Response(new ReadableStream),nl=!0}catch{nl=!1}nl?Ke(Qe.body):Qe.blob().then(Ke)}(Ae,Qe=>{const Ke=new p.Response(Qe,Te);Bl(),Fo&&Fo.then(st=>st.put(Zc(ge.url),Ke)).catch(st=>pt(st.message))}))}(S,J,re),j=!0,g(null,le,Y.headers.get("Cache-Control"),Y.headers.get("Expires")))}).catch(le=>{A||g(new Error(le.message))})};return M?function(Y,J){if(Bl(),!Fo)return J(null);const re=Zc(Y.url);Fo.then(le=>{le.match(re).then(ge=>{const Ae=function(ye){if(!ye)return!1;const Te=new Date(ye.headers.get("Expires")||0),Me=ln(ye.headers.get("Cache-Control")||"");return Te>Date.now()&&!Me["no-cache"]}(ge);le.delete(re),Ae&&le.put(re,ge.clone()),J(null,ge,Ae)}).catch(J)}).catch(J)}(S,V):V(null,null),{cancel:()=>{A=!0,j||x.abort()}}}(l,a);if(Gr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,a,void 0,!0)}var u;return function(f,g){const x=new p.XMLHttpRequest;x.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(x.responseType="arraybuffer");for(const S in f.headers)x.setRequestHeader(S,f.headers[S]);return f.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=f.credentials==="include",x.onerror=()=>{g(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let S=x.response;if(f.type==="json")try{S=JSON.parse(x.response)}catch(j){return g(j)}g(null,S,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else g(new il(x.statusText,x.status,f.url))},x.send(f.body),{cancel:()=>x.abort()}}(l,a)},Kc=function(l,a){return Fl(Ge(l,{type:"arrayBuffer"}),a)};function Af(l){const a=p.document.createElement("a");return a.href=l,a.protocol===p.document.location.protocol&&a.host===p.document.location.host}const Ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ne,oe;ne=[],oe=0;const Se=function(l,a){if(E.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),oe>=_.MAX_PARALLEL_IMAGE_REQUESTS){const x={requestParameters:l,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return ne.push(x),x}oe++;let u=!1;const f=()=>{if(!u)for(u=!0,oe--;ne.length&&oe<_.MAX_PARALLEL_IMAGE_REQUESTS;){const x=ne.shift(),{requestParameters:S,callback:j,cancelled:A}=x;A||(x.cancel=Se(S,j).cancel)}},g=Kc(l,(x,S,j,A)=>{f(),x?a(x):S&&(p.createImageBitmap?function(M,$){const V=new p.Blob([new Uint8Array(M)],{type:"image/png"});p.createImageBitmap(V).then(W=>{$(null,W)}).catch(W=>{$(new Error(`Could not load image because of ${W.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(S,(M,$)=>a(M,$,j,A)):function(M,$){const V=new p.Image,W=p.URL;V.onload=()=>{$(null,V),W.revokeObjectURL(V.src),V.onload=null,p.requestAnimationFrame(()=>{V.src=Ce})},V.onerror=()=>$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Y=new p.Blob([new Uint8Array(M)],{type:"image/png"});V.src=M.byteLength?W.createObjectURL(Y):Ce}(S,(M,$)=>a(M,$,j,A)))});return{cancel:()=>{g.cancel(),f()}}},Ie="NO_ACCESS_TOKEN";function $e(l){return l.indexOf("mapbox:")===0}function Xe(l){return _.API_URL_REGEX.test(l)}function He(l){return _.API_CDN_URL_REGEX.test(l)}function ze(l){return _.API_STYLE_REGEX.test(l)&&!rt(l)}function rt(l){return _.API_SPRITE_REGEX.test(l)}const At=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Mt(l){const a=l.match(At);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function Tt(l){const a=l.params.length?`?${l.params.join("&")}`:"";return`${l.protocol}://${l.authority}${l.path}${a}`}const pr="mapbox.eventData";function br(l){if(!l)return null;const a=l.split(".");if(!a||a.length!==3)return null;try{return JSON.parse(decodeURIComponent(p.atob(a[1]).split("").map(u=>"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class mr{constructor(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(a){const u=br(_.ACCESS_TOKEN);let f="";return f=u&&u.u?p.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,(g,x)=>String.fromCharCode(+("0x"+x)))):_.ACCESS_TOKEN||"",a?`${pr}.${a}:${f}`:`${pr}:${f}`}fetchEventData(){const a=Hn("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(a)try{const g=p.localStorage.getItem(u);g&&(this.eventData=JSON.parse(g));const x=p.localStorage.getItem(f);x&&(this.anonId=x)}catch{pt("Unable to read from LocalStorage")}}saveEventData(){const a=Hn("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(a)try{p.localStorage.setItem(f,this.anonId),Object.keys(this.eventData).length>=1&&p.localStorage.setItem(u,JSON.stringify(this.eventData))}catch{pt("Unable to write to LocalStorage")}}processRequests(a){}postEvent(a,u,f,g){if(!_.EVENTS_URL)return;const x=Mt(_.EVENTS_URL);x.params.push(`access_token=${g||_.ACCESS_TOKEN||""}`);const S={event:this.type,created:new Date(a).toISOString()},j=u?Ge(S,u):S,A={url:Tt(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([j])};this.pendingRequest=function(M,$){return Fl(Ge(M,{method:"POST"}),$)}(A,M=>{this.pendingRequest=null,f(M),this.saveEventData(),this.processRequests(g)})}queueRequest(a,u){this.queue.push(a),this.processRequests(u)}}const _r=new class extends mr{constructor(l){super("appUserTurnstile"),this._customAccessToken=l}postTurnstileEvent(l,a){_.EVENTS_URL&&_.ACCESS_TOKEN&&Array.isArray(l)&&l.some(u=>$e(u)||Xe(u))&&this.queueRequest(Date.now(),a)}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const a=br(_.ACCESS_TOKEN),u=a?a.u:_.ACCESS_TOKEN;let f=u!==this.eventData.tokenU;Jt(this.anonId)||(this.anonId=nr(),f=!0);const g=this.queue.shift();if(this.eventData.lastSuccess){const x=new Date(this.eventData.lastSuccess),S=new Date(g),j=(g-this.eventData.lastSuccess)/864e5;f=f||j>=1||j<-1||x.getDate()!==S.getDate()}else f=!0;f?this.postEvent(g,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:O,"enabled.telemetry":!1,userId:this.anonId},x=>{x||(this.eventData.lastSuccess=g,this.eventData.tokenU=u)},l):this.processRequests()}},Pr=_r.postTurnstileEvent.bind(_r),Cn=new class extends mr{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(l,a,u,f){this.skuToken=a,this.errorCb=f,_.EVENTS_URL&&(u||_.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},u):this.errorCb(new Error(Ie)))}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||(this.anonId||this.fetchEventData(),Jt(this.anonId)||(this.anonId=nr()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:O,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):a&&(this.success[a]=!0)},l))}},Xn=Cn.postMapLoadEvent.bind(Cn),Fi=new class extends mr{constructor(){super("gljs.performance")}postPerformanceEvent(l,a){_.EVENTS_URL&&(l||_.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:a},l)}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:a,performanceData:u}=this.queue.shift(),f=function(g){const x=p.performance.getEntriesByType("resource"),S=p.performance.getEntriesByType("mark"),j=function(W){const Y={};if(W){for(const J in W)if(J!=="other")for(const re of W[J]){const le=`${J}ResolveRangeMin`,ge=`${J}ResolveRangeMax`,Ae=`${J}RequestCount`,ye=`${J}RequestCachedCount`;Y[le]=Math.min(Y[le]||1/0,re.startTime),Y[ge]=Math.max(Y[ge]||-1/0,re.responseEnd);const Te=Me=>{Y[Me]===void 0&&(Y[Me]=0),++Y[Me]};re.transferSize!==void 0&&re.transferSize===0&&Te(ye),Te(Ae)}}return Y}(function(W,Y){const J={};if(W)for(const re of W){const le=Y(re);J[le]===void 0&&(J[le]=[]),J[le].push(re)}return J}(x,n0)),A=p.devicePixelRatio,M=p.navigator.connection||p.navigator.mozConnection||p.navigator.webkitConnection,$={counters:[],metadata:[],attributes:[]},V=(W,Y,J)=>{J!=null&&W.push({name:Y,value:J.toString()})};for(const W in j)V($.counters,W,j[W]);if(g.interactionRange[0]!==1/0&&g.interactionRange[1]!==-1/0&&(V($.counters,"interactionRangeMin",g.interactionRange[0]),V($.counters,"interactionRangeMax",g.interactionRange[1])),S)for(const W of Object.keys(Yc)){const Y=Yc[W],J=S.find(re=>re.name===Y);J&&V($.counters,Y,J.startTime)}return V($.counters,"visibilityHidden",g.visibilityHidden),V($.attributes,"style",function(W){if(W)for(const Y of W){const J=Y.name.split("?")[0];if(ze(J)){const re=J.split("/").slice(-2);if(re.length===2)return`mapbox://styles/${re[0]}/${re[1]}`}}}(x)),V($.attributes,"terrainEnabled",g.terrainEnabled?"true":"false"),V($.attributes,"fogEnabled",g.fogEnabled?"true":"false"),V($.attributes,"projection",g.projection),V($.attributes,"zoom",g.zoom),V($.metadata,"devicePixelRatio",A),V($.metadata,"connectionEffectiveType",M?M.effectiveType:void 0),V($.metadata,"navigatorUserAgent",p.navigator.userAgent),V($.metadata,"screenWidth",p.screen.width),V($.metadata,"screenHeight",p.screen.height),V($.metadata,"windowWidth",p.innerWidth),V($.metadata,"windowHeight",p.innerHeight),V($.metadata,"mapWidth",g.width/A),V($.metadata,"mapHeight",g.height/A),V($.metadata,"webglRenderer",g.renderer),V($.metadata,"webglVendor",g.vendor),V($.metadata,"sdkVersion",y),V($.metadata,"sdkIdentifier","mapbox-gl-js"),$}(u);for(const g of f.metadata);for(const g of f.counters);for(const g of f.attributes);this.postEvent(a,f,()=>{},l)}},li=Fi.postPerformanceEvent.bind(Fi),Ia=new class extends mr{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(l,a,u,f){if(!_.API_URL||!_.SESSION_PATH)return;const g=Mt(_.API_URL+_.SESSION_PATH);g.params.push(`sku=${a||""}`),g.params.push(`access_token=${f||_.ACCESS_TOKEN||""}`);const x={url:Tt(g),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(S,j){return Fl(Ge(S,{method:"GET"}),j)}(x,S=>{this.pendingRequest=null,u(S),this.saveEventData(),this.processRequests(f)})}getSessionAPI(l,a,u,f){this.skuToken=a,this.errorCb=f,_.SESSION_PATH&&_.API_URL&&(u||_.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},u):this.errorCb(new Error(Ie)))}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||this.getSession(u,this.skuToken,f=>{f?this.errorCb(f):a&&(this.success[a]=!0)},l)}},yi=Ia.getSessionAPI.bind(Ia),Yi=new Set,Yc={create:"create",load:"load",fullLoad:"fullLoad"},zE={mark(l){p.performance.mark(l)},measure(l,a,u){p.performance.measure(l,a,u)}};function n0(l){const a=l.name.split("?")[0];return He(a)&&a.includes("mapbox-gl.js")?"javascript":He(a)&&a.includes("mapbox-gl.css")?"css":function(u){return _.API_FONTS_REGEX.test(u)}(a)?"fontRange":rt(a)?"sprite":ze(a)?"style":function(u){return _.API_TILEJSON_REGEX.test(u)}(a)?"tilejson":"other"}const Ur=p.performance;function Ng(l){const a=l?l.url.toString():void 0;return Ur.getEntriesByName(a)}let Dd,Mg,kf,Oa;const us={now:()=>kf!==void 0?kf:p.performance.now(),setNow(l){kf=l},restoreNow(){kf=void 0},frame(l){const a=p.requestAnimationFrame(l);return{cancel:()=>p.cancelAnimationFrame(a)}},getImageData(l,a=0){const{width:u,height:f}=l;Oa||(Oa=p.document.createElement("canvas"));const g=Oa.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(u>Oa.width||f>Oa.height)&&(Oa.width=u,Oa.height=f),g.clearRect(-a,-a,u+2*a,f+2*a),g.drawImage(l,0,0,u,f),g.getImageData(-a,-a,u+2*a,f+2*a)},resolveURL:l=>(Dd||(Dd=p.document.createElement("a")),Dd.href=l,Dd.href),get devicePixelRatio(){return p.devicePixelRatio},get prefersReducedMotion(){return!!p.matchMedia&&(Mg==null&&(Mg=p.matchMedia("(prefers-reduced-motion: reduce)")),Mg.matches)}};function Ig(l,a,u){u[l]&&u[l].indexOf(a)!==-1||(u[l]=u[l]||[],u[l].push(a))}function Og(l,a,u){if(u&&u[l]){const f=u[l].indexOf(a);f!==-1&&u[l].splice(f,1)}}class Ul{constructor(a,u={}){Ge(this,u),this.type=a}}class ds extends Ul{constructor(a,u={}){super("error",Ge({error:a},u))}}class Rd{on(a,u){return this._listeners=this._listeners||{},Ig(a,u,this._listeners),this}off(a,u){return Og(a,u,this._listeners),Og(a,u,this._oneTimeListeners),this}once(a,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},Ig(a,u,this._oneTimeListeners),this):new Promise(f=>this.once(a,f))}fire(a,u){typeof a=="string"&&(a=new Ul(a,u||{}));const f=a.type;if(this.listens(f)){a.target=this;const g=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const j of g)j.call(this,a);const x=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const j of x)Og(f,j,this._oneTimeListeners),j.call(this,a);const S=this._eventedParent;S&&(Ge(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(a))}else a instanceof ds&&console.error(a.error);return this}listens(a){return!!(this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a))}setEventedParent(a,u){return this._eventedParent=a,this._eventedParentData=u,this}}var at=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function hs(l,...a){for(const u of a)for(const f in u)l[f]=u[f];return l}function Zn(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function vi(l){if(Array.isArray(l))return l.map(vi);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const a={};for(const u in l)a[u]=vi(l[u]);return a}return Zn(l)}class i0 extends Error{constructor(a,u){super(u),this.message=u,this.key=a}}var Da=i0;class Dg{constructor(a,u=[]){this.parent=a,this.bindings={};for(const[f,g]of u)this.bindings[f]=g}concat(a){return new Dg(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}var o0=Dg;const Jc={kind:"null"},Lt={kind:"number"},jr={kind:"string"},Sr={kind:"boolean"},Po={kind:"color"},da={kind:"object"},Er={kind:"value"},Ao={kind:"collator"},Ld={kind:"formatted"},Vl={kind:"resolvedImage"};function Uo(l,a){return{kind:"array",itemType:l,N:a}}function En(l){if(l.kind==="array"){const a=En(l.itemType);return typeof l.N=="number"?`array<${a}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${a}>`}return l.kind}const a0=[Jc,Lt,jr,Sr,Po,Ld,da,Uo(Er),Vl];function fs(l,a){if(a.kind==="error")return null;if(l.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!fs(l.itemType,a.itemType))&&(typeof l.N!="number"||l.N===a.N))return null}else{if(l.kind===a.kind)return null;if(l.kind==="value"){for(const u of a0)if(!fs(u,a))return null}}return`Expected ${En(l)} but found ${En(a)} instead.`}function Bd(l,a){return a.some(u=>u.kind===l.kind)}function zd(l,a){return a.some(u=>u==="null"?l===null:u==="array"?Array.isArray(l):u==="object"?l&&!Array.isArray(l)&&typeof l=="object":u===typeof l)}var Rg,s0={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function $d(l){return(l=Math.round(l))<0?0:l>255?255:l}function Fd(l){return $d(l[l.length-1]==="%"?parseFloat(l)/100*255:parseInt(l))}function Nf(l){return(a=l[l.length-1]==="%"?parseFloat(l)/100:parseFloat(l))<0?0:a>1?1:a;var a}function Qc(l,a,u){return u<0?u+=1:u>1&&(u-=1),6*u<1?l+(a-l)*u*6:2*u<1?a:3*u<2?l+(a-l)*(2/3-u)*6:l}try{Rg={}.parseCSSColor=function(l){var a,u=l.replace(/ /g,"").toLowerCase();if(u in s0)return s0[u].slice();if(u[0]==="#")return u.length===4?(a=parseInt(u.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:u.length===7&&(a=parseInt(u.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var f=u.indexOf("("),g=u.indexOf(")");if(f!==-1&&g+1===u.length){var x=u.substr(0,f),S=u.substr(f+1,g-(f+1)).split(","),j=1;switch(x){case"rgba":if(S.length!==4)return null;j=Nf(S.pop());case"rgb":return S.length!==3?null:[Fd(S[0]),Fd(S[1]),Fd(S[2]),j];case"hsla":if(S.length!==4)return null;j=Nf(S.pop());case"hsl":if(S.length!==3)return null;var A=(parseFloat(S[0])%360+360)%360/360,M=Nf(S[1]),$=Nf(S[2]),V=$<=.5?$*(M+1):$+M-$*M,W=2*$-V;return[$d(255*Qc(W,V,A+1/3)),$d(255*Qc(W,V,A)),$d(255*Qc(W,V,A-1/3)),j];default:return null}}return null}}catch{}class co{constructor(a,u,f,g=1){this.r=a,this.g=u,this.b=f,this.a=g}static parse(a){if(!a)return;if(a instanceof co)return a;if(typeof a!="string")return;const u=Rg(a);return u?new co(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toString(){const[a,u,f,g]=this.toArray();return`rgba(${Math.round(a)},${Math.round(u)},${Math.round(f)},${g})`}toArray(){const{r:a,g:u,b:f,a:g}=this;return g===0?[0,0,0,0]:[255*a/g,255*u/g,255*f/g,g]}toArray01(){const{r:a,g:u,b:f,a:g}=this;return g===0?[0,0,0,0]:[a/g,u/g,f/g,g]}toArray01PremultipliedAlpha(){const{r:a,g:u,b:f,a:g}=this;return[a,u,f,g]}}co.black=new co(0,0,0,1),co.white=new co(1,1,1,1),co.transparent=new co(0,0,0,0),co.red=new co(1,0,0,1),co.blue=new co(0,0,1,1);var Un=co;class Lg{constructor(a,u,f){this.sensitivity=a?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,u){return this.collator.compare(a,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Bg{constructor(a,u,f,g,x){this.text=a.normalize?a.normalize():a,this.image=u,this.scale=f,this.fontStack=g,this.textColor=x}}class uo{constructor(a){this.sections=a}static fromString(a){return new uo([new Bg(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof uo?a:uo.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}serialize(){const a=["format"];for(const u of this.sections){if(u.image){a.push(["image",u.image.name]);continue}a.push(u.text);const f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),a.push(f)}return a}}class Vo{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Vo({name:a,available:!1}):null}serialize(){return["image",this.name]}}function l0(l,a,u,f){return typeof l=="number"&&l>=0&&l<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[l,a,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[l,a,u,f]:[l,a,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ud(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof Un||l instanceof Lg||l instanceof uo||l instanceof Vo)return!0;if(Array.isArray(l)){for(const a of l)if(!Ud(a))return!1;return!0}if(typeof l=="object"){for(const a in l)if(!Ud(l[a]))return!1;return!0}return!1}function Dn(l){if(l===null)return Jc;if(typeof l=="string")return jr;if(typeof l=="boolean")return Sr;if(typeof l=="number")return Lt;if(l instanceof Un)return Po;if(l instanceof Lg)return Ao;if(l instanceof uo)return Ld;if(l instanceof Vo)return Vl;if(Array.isArray(l)){const a=l.length;let u;for(const f of l){const g=Dn(f);if(u){if(u===g)continue;u=Er;break}u=g}return Uo(u||Er,a)}return da}function Vd(l){const a=typeof l;return l===null?"":a==="string"||a==="number"||a==="boolean"?String(l):l instanceof Un||l instanceof uo||l instanceof Vo?l.toString():JSON.stringify(l)}class zg{constructor(a,u){this.type=a,this.value=u}static parse(a,u){if(a.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Ud(a[1]))return u.error("invalid value");const f=a[1];let g=Dn(f);const x=u.expectedType;return g.kind!=="array"||g.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(g=x),new zg(g,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Un?["rgba"].concat(this.value.toArray()):this.value instanceof uo?this.value.serialize():this.value}}var ql=zg,Ni=class{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}};const $g={string:jr,number:Lt,boolean:Sr,object:da};class Fg{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");let f,g=1;const x=a[0];if(x==="array"){let j,A;if(a.length>2){const M=a[1];if(typeof M!="string"||!(M in $g)||M==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);j=$g[M],g++}else j=Er;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return u.error('The length argument to "array" must be a positive integer literal',2);A=a[2],g++}f=Uo(j,A)}else f=$g[x];const S=[];for(;g<a.length;g++){const j=u.parse(a[g],g,Er);if(!j)return null;S.push(j)}return new Fg(f,S)}evaluate(a){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(a);if(!fs(this.type,Dn(f)))return f;if(u===this.args.length-1)throw new Ni(`Expected value to be of type ${En(this.type)}, but found ${En(Dn(f))} instead.`)}return null}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=this.type,u=[a.kind];if(a.kind==="array"){const f=a.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){u.push(f.kind);const g=a.N;(typeof g=="number"||this.args.length>1)&&u.push(g)}}return u.concat(this.args.map(f=>f.serialize()))}}var ps=Fg;class ol{constructor(a){this.type=Ld,this.sections=a}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const f=a[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const g=[];let x=!1;for(let S=1;S<=a.length-1;++S){const j=a[S];if(x&&typeof j=="object"&&!Array.isArray(j)){x=!1;let A=null;if(j["font-scale"]&&(A=u.parse(j["font-scale"],1,Lt),!A))return null;let M=null;if(j["text-font"]&&(M=u.parse(j["text-font"],1,Uo(jr)),!M))return null;let $=null;if(j["text-color"]&&($=u.parse(j["text-color"],1,Po),!$))return null;const V=g[g.length-1];V.scale=A,V.font=M,V.textColor=$}else{const A=u.parse(a[S],1,Er);if(!A)return null;const M=A.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,g.push({content:A,scale:null,font:null,textColor:null})}}return new ol(g)}evaluate(a){return new uo(this.sections.map(u=>{const f=u.content.evaluate(a);return Dn(f)===Vl?new Bg("",f,null,null,null):new Bg(Vd(f),null,u.scale?u.scale.evaluate(a):null,u.font?u.font.evaluate(a).join(","):null,u.textColor?u.textColor.evaluate(a):null)}))}eachChild(a){for(const u of this.sections)a(u.content),u.scale&&a(u.scale),u.font&&a(u.font),u.textColor&&a(u.textColor)}outputDefined(){return!1}serialize(){const a=["format"];for(const u of this.sections){a.push(u.content.serialize());const f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),a.push(f)}return a}}class Mf{constructor(a){this.type=Vl,this.input=a}static parse(a,u){if(a.length!==2)return u.error("Expected two arguments.");const f=u.parse(a[1],1,jr);return f?new Mf(f):u.error("No image name provided.")}evaluate(a){const u=this.input.evaluate(a),f=Vo.fromString(u);return f&&a.availableImages&&(f.available=a.availableImages.indexOf(u)>-1),f}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const $E={"to-boolean":Sr,"to-color":Po,"to-number":Lt,"to-string":jr};class Ug{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const f=a[0];if((f==="to-boolean"||f==="to-string")&&a.length!==2)return u.error("Expected one argument.");const g=$E[f],x=[];for(let S=1;S<a.length;S++){const j=u.parse(a[S],S,Er);if(!j)return null;x.push(j)}return new Ug(g,x)}evaluate(a){if(this.type.kind==="boolean")return!!this.args[0].evaluate(a);if(this.type.kind==="color"){let u,f;for(const g of this.args){if(u=g.evaluate(a),f=null,u instanceof Un)return u;if(typeof u=="string"){const x=a.parseColor(u);if(x)return x}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:l0(u[0],u[1],u[2],u[3]),!f))return new Un(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new Ni(f||`Could not parse color from value '${typeof u=="string"?u:String(JSON.stringify(u))}'`)}if(this.type.kind==="number"){let u=null;for(const f of this.args){if(u=f.evaluate(a),u===null)return 0;const g=Number(u);if(!isNaN(g))return g}throw new Ni(`Could not convert ${JSON.stringify(u)} to number.`)}return this.type.kind==="formatted"?uo.fromString(Vd(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?Vo.fromString(Vd(this.args[0].evaluate(a))):Vd(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ol([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Mf(this.args[0]).serialize();const a=[`to-${this.type.kind}`];return this.eachChild(u=>{a.push(u.serialize())}),a}}var eu=Ug;const Ra=["Unknown","Point","LineString","Polygon"];var Vg=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ra[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const l=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:u,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*a-l[0])+this.featureDistanceData.bearing[1]*(f*a-l[1])}return 0}parseColor(l){let a=this._parseColorCache[l];return a||(a=this._parseColorCache[l]=Un.parse(l)),a}};class Wl{constructor(a,u,f,g){this.name=a,this.type=u,this._evaluate=f,this.args=g}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(a=>a.serialize()))}static parse(a,u){const f=a[0],g=Wl.definitions[f];if(!g)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(g)?g[0]:g.type,S=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,j=S.filter(([M])=>!Array.isArray(M)||M.length===a.length-1);let A=null;for(const[M,$]of j){A=new Zg(u.registry,u.path,null,u.scope);const V=[];let W=!1;for(let Y=1;Y<a.length;Y++){const J=a[Y],re=Array.isArray(M)?M[Y-1]:M.type,le=A.parse(J,1+V.length,re);if(!le){W=!0;break}V.push(le)}if(!W)if(Array.isArray(M)&&M.length!==V.length)A.error(`Expected ${M.length} arguments, but found ${V.length} instead.`);else{for(let Y=0;Y<V.length;Y++){const J=Array.isArray(M)?M[Y]:M.type,re=V[Y];A.concat(Y+1).checkSubtype(J,re.type)}if(A.errors.length===0)return new Wl(f,x,$,V)}}if(j.length===1)u.errors.push(...A.errors);else{const M=(j.length?j:S).map(([V])=>{return W=V,Array.isArray(W)?`(${W.map(En).join(", ")})`:`(${En(W.type)}...)`;var W}).join(" | "),$=[];for(let V=1;V<a.length;V++){const W=u.parse(a[V],1+$.length);if(!W)return null;$.push(En(W.type))}u.error(`Expected arguments of type ${M}, but found (${$.join(", ")}) instead.`)}return null}static register(a,u){Wl.definitions=u;for(const f in u)a[f]=Wl}}var ms=Wl;class qd{constructor(a,u,f){this.type=Ao,this.locale=f,this.caseSensitive=a,this.diacriticSensitive=u}static parse(a,u){if(a.length!==2)return u.error("Expected one argument.");const f=a[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const g=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,Sr);if(!g)return null;const x=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,Sr);if(!x)return null;let S=null;return f.locale&&(S=u.parse(f.locale,1,jr),!S)?null:new qd(g,x,S)}evaluate(a){return new Lg(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}serialize(){const a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]}}const gs=8192;function If(l,a){l[0]=Math.min(l[0],a[0]),l[1]=Math.min(l[1],a[1]),l[2]=Math.max(l[2],a[0]),l[3]=Math.max(l[3],a[1])}function tu(l,a){return!(l[0]<=a[0]||l[2]>=a[2]||l[1]<=a[1]||l[3]>=a[3])}function Wd(l,a){const u=(180+l[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,g=Math.pow(2,a.z);return[Math.round(u*g*gs),Math.round(f*g*gs)]}function c0(l,a,u){const f=l[0]-a[0],g=l[1]-a[1],x=l[0]-u[0],S=l[1]-u[1];return f*S-x*g==0&&f*x<=0&&g*S<=0}function Of(l,a){let u=!1;for(let S=0,j=a.length;S<j;S++){const A=a[S];for(let M=0,$=A.length;M<$-1;M++){if(c0(l,A[M],A[M+1]))return!1;(g=A[M])[1]>(f=l)[1]!=(x=A[M+1])[1]>f[1]&&f[0]<(x[0]-g[0])*(f[1]-g[1])/(x[1]-g[1])+g[0]&&(u=!u)}}var f,g,x;return u}function qg(l,a){for(let u=0;u<a.length;u++)if(Of(l,a[u]))return!0;return!1}function Wg(l,a,u,f){const g=f[0]-u[0],x=f[1]-u[1],S=(l[0]-u[0])*x-g*(l[1]-u[1]),j=(a[0]-u[0])*x-g*(a[1]-u[1]);return S>0&&j<0||S<0&&j>0}function ru(l,a,u){for(const M of u)for(let $=0;$<M.length-1;++$)if((j=[(S=M[$+1])[0]-(x=M[$])[0],S[1]-x[1]])[0]*(A=[(g=a)[0]-(f=l)[0],g[1]-f[1]])[1]-j[1]*A[0]!=0&&Wg(f,g,x,S)&&Wg(x,S,f,g))return!0;var f,g,x,S,j,A;return!1}function Vr(l,a){for(let u=0;u<l.length;++u)if(!Of(l[u],a))return!1;for(let u=0;u<l.length-1;++u)if(ru(l[u],l[u+1],a))return!1;return!0}function FE(l,a){for(let u=0;u<a.length;u++)if(Vr(l,a[u]))return!0;return!1}function Gg(l,a,u){const f=[];for(let g=0;g<l.length;g++){const x=[];for(let S=0;S<l[g].length;S++){const j=Wd(l[g][S],u);If(a,j),x.push(j)}f.push(x)}return f}function u0(l,a,u){const f=[];for(let g=0;g<l.length;g++){const x=Gg(l[g],a,u);f.push(x)}return f}function Hg(l,a,u,f){if(l[0]<u[0]||l[0]>u[2]){const g=.5*f;let x=l[0]-u[0]>g?-f:u[0]-l[0]>g?f:0;x===0&&(x=l[0]-u[2]>g?-f:u[2]-l[0]>g?f:0),l[0]+=x}If(a,l)}function d0(l,a,u,f){const g=Math.pow(2,f.z)*gs,x=[f.x*gs,f.y*gs],S=[];if(!l)return S;for(const j of l)for(const A of j){const M=[A.x+x[0],A.y+x[1]];Hg(M,a,u,g),S.push(M)}return S}function Xg(l,a,u,f){const g=Math.pow(2,f.z)*gs,x=[f.x*gs,f.y*gs],S=[];if(!l)return S;for(const A of l){const M=[];for(const $ of A){const V=[$.x+x[0],$.y+x[1]];If(a,V),M.push(V)}S.push(M)}if(a[2]-a[0]<=g/2){(j=a)[0]=j[1]=1/0,j[2]=j[3]=-1/0;for(const A of S)for(const M of A)Hg(M,a,u,g)}var j;return S}class nu{constructor(a,u){this.type=Sr,this.geojson=a,this.geometries=u}static parse(a,u){if(a.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Ud(a[1])){const f=a[1];if(f.type==="FeatureCollection")for(let g=0;g<f.features.length;++g){const x=f.features[g].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new nu(f,f.features[g].geometry)}else if(f.type==="Feature"){const g=f.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new nu(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new nu(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],S=u.canonicalID();if(!S)return!1;if(f.type==="Polygon"){const j=Gg(f.coordinates,x,S),A=d0(u.geometry(),g,x,S);if(!tu(g,x))return!1;for(const M of A)if(!Of(M,j))return!1}if(f.type==="MultiPolygon"){const j=u0(f.coordinates,x,S),A=d0(u.geometry(),g,x,S);if(!tu(g,x))return!1;for(const M of A)if(!qg(M,j))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],S=u.canonicalID();if(!S)return!1;if(f.type==="Polygon"){const j=Gg(f.coordinates,x,S),A=Xg(u.geometry(),g,x,S);if(!tu(g,x))return!1;for(const M of A)if(!Vr(M,j))return!1}if(f.type==="MultiPolygon"){const j=u0(f.coordinates,x,S),A=Xg(u.geometry(),g,x,S);if(!tu(g,x))return!1;for(const M of A)if(!FE(M,j))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Df=nu;function iu(l){if(l instanceof ms&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof Df)return!1;let a=!0;return l.eachChild(u=>{a&&!iu(u)&&(a=!1)}),a}function ys(l){if(l instanceof ms&&l.name==="feature-state")return!1;let a=!0;return l.eachChild(u=>{a&&!ys(u)&&(a=!1)}),a}function Gl(l,a){if(l instanceof ms&&a.indexOf(l.name)>=0)return!1;let u=!0;return l.eachChild(f=>{u&&!Gl(f,a)&&(u=!1)}),u}class Rf{constructor(a,u){this.type=u.type,this.name=a,this.boundExpression=u}static parse(a,u){if(a.length!==2||typeof a[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=a[1];return u.scope.has(f)?new Rf(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var h0=Rf;class Gd{constructor(a,u=[],f,g=new o0,x=[]){this.registry=a,this.path=u,this.key=u.map(S=>`[${S}]`).join(""),this.scope=g,this.errors=x,this.expectedType=f}parse(a,u,f,g,x={}){return u?this.concat(u,f,g)._parse(a,x):this._parse(a,x)}_parse(a,u){function f(g,x,S){return S==="assert"?new ps(x,[g]):S==="coerce"?new eu(x,[g]):g}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=a[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[g];if(x){let S=x.parse(a,this);if(!S)return null;if(this.expectedType){const j=this.expectedType,A=S.type;if(j.kind!=="string"&&j.kind!=="number"&&j.kind!=="boolean"&&j.kind!=="object"&&j.kind!=="array"||A.kind!=="value")if(j.kind!=="color"&&j.kind!=="formatted"&&j.kind!=="resolvedImage"||A.kind!=="value"&&A.kind!=="string"){if(this.checkSubtype(j,A))return null}else S=f(S,j,u.typeAnnotation||"coerce");else S=f(S,j,u.typeAnnotation||"assert")}if(!(S instanceof ql)&&S.type.kind!=="resolvedImage"&&Kg(S)){const j=new Vg;try{S=new ql(S.type,S.evaluate(j))}catch(A){return this.error(A.message),null}}return S}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,u,f){const g=typeof a=="number"?this.path.concat(a):this.path,x=f?this.scope.concat(f):this.scope;return new Gd(this.registry,g,u||null,x,this.errors)}error(a,...u){const f=`${this.key}${u.map(g=>`[${g}]`).join("")}`;this.errors.push(new Da(f,a))}checkSubtype(a,u){const f=fs(a,u);return f&&this.error(f),f}}var Zg=Gd;function Kg(l){if(l instanceof h0)return Kg(l.boundExpression);if(l instanceof ms&&l.name==="error"||l instanceof qd||l instanceof Df)return!1;const a=l instanceof eu||l instanceof ps;let u=!0;return l.eachChild(f=>{u=a?u&&Kg(f):u&&f instanceof ql}),!!u&&iu(l)&&Gl(l,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Lf(l,a){const u=l.length-1;let f,g,x=0,S=u,j=0;for(;x<=S;)if(j=Math.floor((x+S)/2),f=l[j],g=l[j+1],f<=a){if(j===u||a<g)return j;x=j+1}else{if(!(f>a))throw new Ni("Input is not a number.");S=j-1}return 0}class Bf{constructor(a,u,f){this.type=a,this.input=u,this.labels=[],this.outputs=[];for(const[g,x]of f)this.labels.push(g),this.outputs.push(x)}static parse(a,u){if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(a[1],1,Lt);if(!f)return null;const g=[];let x=null;u.expectedType&&u.expectedType.kind!=="value"&&(x=u.expectedType);for(let S=1;S<a.length;S+=2){const j=S===1?-1/0:a[S],A=a[S+1],M=S,$=S+1;if(typeof j!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(g.length&&g[g.length-1][0]>=j)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const V=u.parse(A,$,x);if(!V)return null;x=x||V.type,g.push([j,V])}return new Bf(x,f,g)}evaluate(a){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(a);const g=this.input.evaluate(a);if(g<=u[0])return f[0].evaluate(a);const x=u.length;return g>=u[x-1]?f[x-1].evaluate(a):f[Lf(u,g)].evaluate(a)}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){const a=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&a.push(this.labels[u]),a.push(this.outputs[u].serialize());return a}}var Yg=Bf;function kr(l,a,u){return l*(1-u)+a*u}var Hd=Object.freeze({__proto__:null,array:function(l,a,u){return l.map((f,g)=>kr(f,a[g],u))},color:function(l,a,u){return new Un(kr(l.r,a.r,u),kr(l.g,a.g,u),kr(l.b,a.b,u),kr(l.a,a.a,u))},number:kr});const f0=.95047,Jg=1.08883,p0=4/29,Hl=6/29,Qg=3*Hl*Hl,UE=Hl*Hl*Hl,VE=Math.PI/180,qE=180/Math.PI;function ey(l){return l>UE?Math.pow(l,1/3):l/Qg+p0}function ty(l){return l>Hl?l*l*l:Qg*(l-p0)}function ry(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function zf(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function m0(l){const a=zf(l.r),u=zf(l.g),f=zf(l.b),g=ey((.4124564*a+.3575761*u+.1804375*f)/f0),x=ey((.2126729*a+.7151522*u+.072175*f)/1);return{l:116*x-16,a:500*(g-x),b:200*(x-ey((.0193339*a+.119192*u+.9503041*f)/Jg)),alpha:l.a}}function g0(l){let a=(l.l+16)/116,u=isNaN(l.a)?a:a+l.a/500,f=isNaN(l.b)?a:a-l.b/200;return a=1*ty(a),u=f0*ty(u),f=Jg*ty(f),new Un(ry(3.2404542*u-1.5371385*a-.4985314*f),ry(-.969266*u+1.8760108*a+.041556*f),ry(.0556434*u-.2040259*a+1.0572252*f),l.alpha)}function WE(l,a,u){const f=a-l;return l+u*(f>180||f<-180?f-360*Math.round(f/360):f)}const Xd={forward:m0,reverse:g0,interpolate:function(l,a,u){return{l:kr(l.l,a.l,u),a:kr(l.a,a.a,u),b:kr(l.b,a.b,u),alpha:kr(l.alpha,a.alpha,u)}}},ou={forward:function(l){const{l:a,a:u,b:f}=m0(l),g=Math.atan2(f,u)*qE;return{h:g<0?g+360:g,c:Math.sqrt(u*u+f*f),l:a,alpha:l.a}},reverse:function(l){const a=l.h*VE,u=l.c;return g0({l:l.l,a:Math.cos(a)*u,b:Math.sin(a)*u,alpha:l.alpha})},interpolate:function(l,a,u){return{h:WE(l.h,a.h,u),c:kr(l.c,a.c,u),l:kr(l.l,a.l,u),alpha:kr(l.alpha,a.alpha,u)}}};var ny=Object.freeze({__proto__:null,hcl:ou,lab:Xd});class Zd{constructor(a,u,f,g,x){this.type=a,this.operator=u,this.interpolation=f,this.input=g,this.labels=[],this.outputs=[];for(const[S,j]of x)this.labels.push(S),this.outputs.push(j)}static interpolationFactor(a,u,f,g){let x=0;if(a.name==="exponential")x=iy(u,a.base,f,g);else if(a.name==="linear")x=iy(u,1,f,g);else if(a.name==="cubic-bezier"){const S=a.controlPoints;x=new X(S[0],S[1],S[2],S[3]).solve(iy(u,1,f,g))}return x}static parse(a,u){let[f,g,x,...S]=a;if(!Array.isArray(g)||g.length===0)return u.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const M=g[1];if(typeof M!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:M}}else{if(g[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const M=g.slice(1);if(M.length!==4||M.some($=>typeof $!="number"||$<0||$>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:M}}}if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(x=u.parse(x,2,Lt),!x)return null;const j=[];let A=null;f==="interpolate-hcl"||f==="interpolate-lab"?A=Po:u.expectedType&&u.expectedType.kind!=="value"&&(A=u.expectedType);for(let M=0;M<S.length;M+=2){const $=S[M],V=S[M+1],W=M+3,Y=M+4;if(typeof $!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',W);if(j.length&&j[j.length-1][0]>=$)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',W);const J=u.parse(V,Y,A);if(!J)return null;A=A||J.type,j.push([$,J])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new Zd(A,f,g,x,j):u.error(`Type ${En(A)} is not interpolatable.`)}evaluate(a){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(a);const g=this.input.evaluate(a);if(g<=u[0])return f[0].evaluate(a);const x=u.length;if(g>=u[x-1])return f[x-1].evaluate(a);const S=Lf(u,g),j=Zd.interpolationFactor(this.interpolation,g,u[S],u[S+1]),A=f[S].evaluate(a),M=f[S+1].evaluate(a);return this.operator==="interpolate"?Hd[this.type.kind.toLowerCase()](A,M,j):this.operator==="interpolate-hcl"?ou.reverse(ou.interpolate(ou.forward(A),ou.forward(M),j)):Xd.reverse(Xd.interpolate(Xd.forward(A),Xd.forward(M),j))}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a;a=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const u=[this.operator,a,this.input.serialize()];for(let f=0;f<this.labels.length;f++)u.push(this.labels[f],this.outputs[f].serialize());return u}}function iy(l,a,u,f){const g=f-u,x=l-u;return g===0?0:a===1?x/g:(Math.pow(a,x)-1)/(Math.pow(a,g)-1)}var La=Zd;class $f{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expectected at least one argument.");let f=null;const g=u.expectedType;g&&g.kind!=="value"&&(f=g);const x=[];for(const j of a.slice(1)){const A=u.parse(j,1+x.length,f,void 0,{typeAnnotation:"omit"});if(!A)return null;f=f||A.type,x.push(A)}const S=g&&x.some(j=>fs(g,j.type));return new $f(S?Er:f,x)}evaluate(a){let u,f=null,g=0;for(const x of this.args){if(g++,f=x.evaluate(a),f&&f instanceof Vo&&!f.available&&(u||(u=f),f=null,g===this.args.length))return u;if(f!==null)break}return f}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=["coalesce"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var oy=$f;class Ff{constructor(a,u){this.type=u.type,this.bindings=[].concat(a),this.result=u}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const u of this.bindings)a(u[1]);a(this.result)}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const f=[];for(let x=1;x<a.length-1;x+=2){const S=a[x];if(typeof S!="string")return u.error(`Expected string, but found ${typeof S} instead.`,x);if(/[^a-zA-Z0-9_]/.test(S))return u.error("Variable names must contain only alphanumeric characters or '_'.",x);const j=u.parse(a[x+1],x+1);if(!j)return null;f.push([S,j])}const g=u.parse(a[a.length-1],a.length-1,u.expectedType,f);return g?new Ff(f,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const a=["let"];for(const[u,f]of this.bindings)a.push(u,f.serialize());return a.push(this.result.serialize()),a}}var y0=Ff;class ay{constructor(a,u,f){this.type=a,this.index=u,this.input=f}static parse(a,u){if(a.length!==3)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,Lt),g=u.parse(a[2],2,Uo(u.expectedType||Er));return f&&g?new ay(g.type.itemType,f,g):null}evaluate(a){const u=this.index.evaluate(a),f=this.input.evaluate(a);if(u<0)throw new Ni(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new Ni(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new Ni(`Array index must be an integer, but found ${u} instead.`);return f[u]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var GE=ay;class sy{constructor(a,u){this.type=Sr,this.needle=a,this.haystack=u}static parse(a,u){if(a.length!==3)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,Er),g=u.parse(a[2],2,Er);return f&&g?Bd(f.type,[Sr,jr,Lt,Jc,Er])?new sy(f,g):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${En(f.type)} instead`):null}evaluate(a){const u=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(f==null)return!1;if(!zd(u,["boolean","string","number","null"]))throw new Ni(`Expected first argument to be of type boolean, string, number or null, but found ${En(Dn(u))} instead.`);if(!zd(f,["string","array"]))throw new Ni(`Expected second argument to be of type array or string, but found ${En(Dn(f))} instead.`);return f.indexOf(u)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Uf=sy;class Kd{constructor(a,u,f){this.type=Lt,this.needle=a,this.haystack=u,this.fromIndex=f}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,Er),g=u.parse(a[2],2,Er);if(!f||!g)return null;if(!Bd(f.type,[Sr,jr,Lt,Jc,Er]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${En(f.type)} instead`);if(a.length===4){const x=u.parse(a[3],3,Lt);return x?new Kd(f,g,x):null}return new Kd(f,g)}evaluate(a){const u=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!zd(u,["boolean","string","number","null"]))throw new Ni(`Expected first argument to be of type boolean, string, number or null, but found ${En(Dn(u))} instead.`);if(!zd(f,["string","array"]))throw new Ni(`Expected second argument to be of type array or string, but found ${En(Dn(f))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(a);return f.indexOf(u,g)}return f.indexOf(u)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var v0=Kd;class ly{constructor(a,u,f,g,x,S){this.inputType=a,this.type=u,this.input=f,this.cases=g,this.outputs=x,this.otherwise=S}static parse(a,u){if(a.length<5)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return u.error("Expected an even number of arguments.");let f,g;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);const x={},S=[];for(let M=2;M<a.length-1;M+=2){let $=a[M];const V=a[M+1];Array.isArray($)||($=[$]);const W=u.concat(M);if($.length===0)return W.error("Expected at least one branch label.");for(const J of $){if(typeof J!="number"&&typeof J!="string")return W.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return W.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return W.error("Numeric branch labels must be integer values.");if(f){if(W.checkSubtype(f,Dn(J)))return null}else f=Dn(J);if(x[String(J)]!==void 0)return W.error("Branch labels must be unique.");x[String(J)]=S.length}const Y=u.parse(V,M,g);if(!Y)return null;g=g||Y.type,S.push(Y)}const j=u.parse(a[1],1,Er);if(!j)return null;const A=u.parse(a[a.length-1],a.length-1,g);return A?j.type.kind!=="value"&&u.concat(1).checkSubtype(f,j.type)?null:new ly(f,g,j,x,S,A):null}evaluate(a){const u=this.input.evaluate(a);return(Dn(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),f=[],g={};for(const S of u){const j=g[this.cases[S]];j===void 0?(g[this.cases[S]]=f.length,f.push([this.cases[S],[S]])):f[j][1].push(S)}const x=S=>this.inputType.kind==="number"?Number(S):S;for(const[S,j]of f)a.push(j.length===1?x(j[0]):j.map(x)),a.push(this.outputs[S].serialize());return a.push(this.otherwise.serialize()),a}}var HE=ly;class cy{constructor(a,u,f){this.type=a,this.branches=u,this.otherwise=f}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const g=[];for(let S=1;S<a.length-1;S+=2){const j=u.parse(a[S],S,Sr);if(!j)return null;const A=u.parse(a[S+1],S+1,f);if(!A)return null;g.push([j,A]),f=f||A.type}const x=u.parse(a[a.length-1],a.length-1,f);return x?new cy(f,g,x):null}evaluate(a){for(const[u,f]of this.branches)if(u.evaluate(a))return f.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[u,f]of this.branches)a(u),a(f);a(this.otherwise)}outputDefined(){return this.branches.every(([a,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["case"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var x0=cy;class Yd{constructor(a,u,f,g){this.type=a,this.input=u,this.beginIndex=f,this.endIndex=g}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,Er),g=u.parse(a[2],2,Lt);if(!f||!g)return null;if(!Bd(f.type,[Uo(Er),jr,Er]))return u.error(`Expected first argument to be of type array or string, but found ${En(f.type)} instead`);if(a.length===4){const x=u.parse(a[3],3,Lt);return x?new Yd(f.type,f,g,x):null}return new Yd(f.type,f,g)}evaluate(a){const u=this.input.evaluate(a),f=this.beginIndex.evaluate(a);if(!zd(u,["string","array"]))throw new Ni(`Expected first argument to be of type array or string, but found ${En(Dn(u))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(a);return u.slice(f,g)}return u.slice(f)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var b0=Yd;function Vf(l,a){return l==="=="||l==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function _0(l,a,u,f){return f.compare(a,u)===0}function au(l,a,u){const f=l!=="=="&&l!=="!=";return class WK{constructor(x,S,j){this.type=Sr,this.lhs=x,this.rhs=S,this.collator=j,this.hasUntypedArgument=x.type.kind==="value"||S.type.kind==="value"}static parse(x,S){if(x.length!==3&&x.length!==4)return S.error("Expected two or three arguments.");const j=x[0];let A=S.parse(x[1],1,Er);if(!A)return null;if(!Vf(j,A.type))return S.concat(1).error(`"${j}" comparisons are not supported for type '${En(A.type)}'.`);let M=S.parse(x[2],2,Er);if(!M)return null;if(!Vf(j,M.type))return S.concat(2).error(`"${j}" comparisons are not supported for type '${En(M.type)}'.`);if(A.type.kind!==M.type.kind&&A.type.kind!=="value"&&M.type.kind!=="value")return S.error(`Cannot compare types '${En(A.type)}' and '${En(M.type)}'.`);f&&(A.type.kind==="value"&&M.type.kind!=="value"?A=new ps(M.type,[A]):A.type.kind!=="value"&&M.type.kind==="value"&&(M=new ps(A.type,[M])));let $=null;if(x.length===4){if(A.type.kind!=="string"&&M.type.kind!=="string"&&A.type.kind!=="value"&&M.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if($=S.parse(x[3],3,Ao),!$)return null}return new WK(A,M,$)}evaluate(x){const S=this.lhs.evaluate(x),j=this.rhs.evaluate(x);if(f&&this.hasUntypedArgument){const A=Dn(S),M=Dn(j);if(A.kind!==M.kind||A.kind!=="string"&&A.kind!=="number")throw new Ni(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${A.kind}, ${M.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const A=Dn(S),M=Dn(j);if(A.kind!=="string"||M.kind!=="string")return a(x,S,j)}return this.collator?u(x,S,j,this.collator.evaluate(x)):a(x,S,j)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}serialize(){const x=[l];return this.eachChild(S=>{x.push(S.serialize())}),x}}}const XE=au("==",function(l,a,u){return a===u},_0),ZE=au("!=",function(l,a,u){return a!==u},function(l,a,u,f){return!_0(0,a,u,f)}),KE=au("<",function(l,a,u){return a<u},function(l,a,u,f){return f.compare(a,u)<0}),YE=au(">",function(l,a,u){return a>u},function(l,a,u,f){return f.compare(a,u)>0}),JE=au("<=",function(l,a,u){return a<=u},function(l,a,u,f){return f.compare(a,u)<=0}),w0=au(">=",function(l,a,u){return a>=u},function(l,a,u,f){return f.compare(a,u)>=0});class qf{constructor(a,u,f,g,x,S){this.type=jr,this.number=a,this.locale=u,this.currency=f,this.unit=g,this.minFractionDigits=x,this.maxFractionDigits=S}static parse(a,u){if(a.length!==3)return u.error("Expected two arguments.");const f=u.parse(a[1],1,Lt);if(!f)return null;const g=a[2];if(typeof g!="object"||Array.isArray(g))return u.error("NumberFormat options argument must be an object.");let x=null;if(g.locale&&(x=u.parse(g.locale,1,jr),!x))return null;let S=null;if(g.currency&&(S=u.parse(g.currency,1,jr),!S))return null;let j=null;if(g.unit&&(j=u.parse(g.unit,1,jr),!j))return null;let A=null;if(g["min-fraction-digits"]&&(A=u.parse(g["min-fraction-digits"],1,Lt),!A))return null;let M=null;return g["max-fraction-digits"]&&(M=u.parse(g["max-fraction-digits"],1,Lt),!M)?null:new qf(f,x,S,j,A,M)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(a):void 0,unit:this.unit?this.unit.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.unit&&a(this.unit),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.unit&&(a.unit=this.unit.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]}}class su{constructor(a){this.type=Lt,this.input=a}static parse(a,u){if(a.length!==2)return u.error(`Expected 1 argument, but found ${a.length-1} instead.`);const f=u.parse(a[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${En(f.type)} instead.`):new su(f):null}evaluate(a){const u=this.input.evaluate(a);if(typeof u=="string"||Array.isArray(u))return u.length;throw new Ni(`Expected value to be of type string or array, but found ${En(Dn(u))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){const a=["length"];return this.eachChild(u=>{a.push(u.serialize())}),a}}const S0={"==":XE,"!=":ZE,">":YE,"<":KE,">=":w0,"<=":JE,array:ps,at:GE,boolean:ps,case:x0,coalesce:oy,collator:qd,format:ol,image:Mf,in:Uf,"index-of":v0,interpolate:La,"interpolate-hcl":La,"interpolate-lab":La,length:su,let:y0,literal:ql,match:HE,number:ps,"number-format":qf,object:ps,slice:b0,step:Yg,string:ps,"to-boolean":eu,"to-color":eu,"to-number":eu,"to-string":eu,var:h0,within:Df};function E0(l,[a,u,f,g]){a=a.evaluate(l),u=u.evaluate(l),f=f.evaluate(l);const x=g?g.evaluate(l):1,S=l0(a,u,f,x);if(S)throw new Ni(S);return new Un(a/255*x,u/255*x,f/255*x,x)}function vs(l,a){return l in a}function Wf(l,a){const u=a[l];return u===void 0?null:u}function qo(l){return{type:l}}ms.register(S0,{error:[{kind:"error"},[jr],(l,[a])=>{throw new Ni(a.evaluate(l))}],typeof:[jr,[Er],(l,[a])=>En(Dn(a.evaluate(l)))],"to-rgba":[Uo(Lt,4),[Po],(l,[a])=>a.evaluate(l).toArray()],rgb:[Po,[Lt,Lt,Lt],E0],rgba:[Po,[Lt,Lt,Lt,Lt],E0],has:{type:Sr,overloads:[[[jr],(l,[a])=>vs(a.evaluate(l),l.properties())],[[jr,da],(l,[a,u])=>vs(a.evaluate(l),u.evaluate(l))]]},get:{type:Er,overloads:[[[jr],(l,[a])=>Wf(a.evaluate(l),l.properties())],[[jr,da],(l,[a,u])=>Wf(a.evaluate(l),u.evaluate(l))]]},"feature-state":[Er,[jr],(l,[a])=>Wf(a.evaluate(l),l.featureState||{})],properties:[da,[],l=>l.properties()],"geometry-type":[jr,[],l=>l.geometryType()],id:[Er,[],l=>l.id()],zoom:[Lt,[],l=>l.globals.zoom],pitch:[Lt,[],l=>l.globals.pitch||0],"distance-from-center":[Lt,[],l=>l.distanceFromCenter()],"heatmap-density":[Lt,[],l=>l.globals.heatmapDensity||0],"line-progress":[Lt,[],l=>l.globals.lineProgress||0],"sky-radial-progress":[Lt,[],l=>l.globals.skyRadialProgress||0],accumulated:[Er,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[Lt,qo(Lt),(l,a)=>{let u=0;for(const f of a)u+=f.evaluate(l);return u}],"*":[Lt,qo(Lt),(l,a)=>{let u=1;for(const f of a)u*=f.evaluate(l);return u}],"-":{type:Lt,overloads:[[[Lt,Lt],(l,[a,u])=>a.evaluate(l)-u.evaluate(l)],[[Lt],(l,[a])=>-a.evaluate(l)]]},"/":[Lt,[Lt,Lt],(l,[a,u])=>a.evaluate(l)/u.evaluate(l)],"%":[Lt,[Lt,Lt],(l,[a,u])=>a.evaluate(l)%u.evaluate(l)],ln2:[Lt,[],()=>Math.LN2],pi:[Lt,[],()=>Math.PI],e:[Lt,[],()=>Math.E],"^":[Lt,[Lt,Lt],(l,[a,u])=>Math.pow(a.evaluate(l),u.evaluate(l))],sqrt:[Lt,[Lt],(l,[a])=>Math.sqrt(a.evaluate(l))],log10:[Lt,[Lt],(l,[a])=>Math.log(a.evaluate(l))/Math.LN10],ln:[Lt,[Lt],(l,[a])=>Math.log(a.evaluate(l))],log2:[Lt,[Lt],(l,[a])=>Math.log(a.evaluate(l))/Math.LN2],sin:[Lt,[Lt],(l,[a])=>Math.sin(a.evaluate(l))],cos:[Lt,[Lt],(l,[a])=>Math.cos(a.evaluate(l))],tan:[Lt,[Lt],(l,[a])=>Math.tan(a.evaluate(l))],asin:[Lt,[Lt],(l,[a])=>Math.asin(a.evaluate(l))],acos:[Lt,[Lt],(l,[a])=>Math.acos(a.evaluate(l))],atan:[Lt,[Lt],(l,[a])=>Math.atan(a.evaluate(l))],min:[Lt,qo(Lt),(l,a)=>Math.min(...a.map(u=>u.evaluate(l)))],max:[Lt,qo(Lt),(l,a)=>Math.max(...a.map(u=>u.evaluate(l)))],abs:[Lt,[Lt],(l,[a])=>Math.abs(a.evaluate(l))],round:[Lt,[Lt],(l,[a])=>{const u=a.evaluate(l);return u<0?-Math.round(-u):Math.round(u)}],floor:[Lt,[Lt],(l,[a])=>Math.floor(a.evaluate(l))],ceil:[Lt,[Lt],(l,[a])=>Math.ceil(a.evaluate(l))],"filter-==":[Sr,[jr,Er],(l,[a,u])=>l.properties()[a.value]===u.value],"filter-id-==":[Sr,[Er],(l,[a])=>l.id()===a.value],"filter-type-==":[Sr,[jr],(l,[a])=>l.geometryType()===a.value],"filter-<":[Sr,[jr,Er],(l,[a,u])=>{const f=l.properties()[a.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[Sr,[Er],(l,[a])=>{const u=l.id(),f=a.value;return typeof u==typeof f&&u<f}],"filter->":[Sr,[jr,Er],(l,[a,u])=>{const f=l.properties()[a.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[Sr,[Er],(l,[a])=>{const u=l.id(),f=a.value;return typeof u==typeof f&&u>f}],"filter-<=":[Sr,[jr,Er],(l,[a,u])=>{const f=l.properties()[a.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[Sr,[Er],(l,[a])=>{const u=l.id(),f=a.value;return typeof u==typeof f&&u<=f}],"filter->=":[Sr,[jr,Er],(l,[a,u])=>{const f=l.properties()[a.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[Sr,[Er],(l,[a])=>{const u=l.id(),f=a.value;return typeof u==typeof f&&u>=f}],"filter-has":[Sr,[Er],(l,[a])=>a.value in l.properties()],"filter-has-id":[Sr,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[Sr,[Uo(jr)],(l,[a])=>a.value.indexOf(l.geometryType())>=0],"filter-id-in":[Sr,[Uo(Er)],(l,[a])=>a.value.indexOf(l.id())>=0],"filter-in-small":[Sr,[jr,Uo(Er)],(l,[a,u])=>u.value.indexOf(l.properties()[a.value])>=0],"filter-in-large":[Sr,[jr,Uo(Er)],(l,[a,u])=>function(f,g,x,S){for(;x<=S;){const j=x+S>>1;if(g[j]===f)return!0;g[j]>f?S=j-1:x=j+1}return!1}(l.properties()[a.value],u.value,0,u.value.length-1)],all:{type:Sr,overloads:[[[Sr,Sr],(l,[a,u])=>a.evaluate(l)&&u.evaluate(l)],[qo(Sr),(l,a)=>{for(const u of a)if(!u.evaluate(l))return!1;return!0}]]},any:{type:Sr,overloads:[[[Sr,Sr],(l,[a,u])=>a.evaluate(l)||u.evaluate(l)],[qo(Sr),(l,a)=>{for(const u of a)if(u.evaluate(l))return!0;return!1}]]},"!":[Sr,[Sr],(l,[a])=>!a.evaluate(l)],"is-supported-script":[Sr,[jr],(l,[a])=>{const u=l.globals&&l.globals.isSupportedScript;return!u||u(a.evaluate(l))}],upcase:[jr,[jr],(l,[a])=>a.evaluate(l).toUpperCase()],downcase:[jr,[jr],(l,[a])=>a.evaluate(l).toLowerCase()],concat:[jr,qo(Er),(l,a)=>a.map(u=>Vd(u.evaluate(l))).join("")],"resolved-locale":[jr,[Ao],(l,[a])=>a.evaluate(l).resolvedLocale()]});var Jd=S0;function T0(l){return{result:"success",value:l}}function Xl(l){return{result:"error",value:l}}function lu(l){return l["property-type"]==="data-driven"}function Gf(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function Hf(l){return!!l.expression&&l.expression.interpolated}function Ir(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function Qd(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function j0(l){return l}function Xf(l,a){const u=a.type==="color",f=l.stops&&typeof l.stops[0][0]=="object",g=f||!(f||l.property!==void 0),x=l.type||(Hf(a)?"exponential":"interval");if(u&&((l=hs({},l)).stops&&(l.stops=l.stops.map(M=>[M[0],Un.parse(M[1])])),l.default=Un.parse(l.default?l.default:a.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!ny[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let S,j,A;if(x==="exponential")S=xs;else if(x==="interval")S=Zf;else if(x==="categorical"){S=C0,j=Object.create(null);for(const M of l.stops)j[M[0]]=M[1];A=typeof l.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);S=P0}if(f){const M={},$=[];for(let Y=0;Y<l.stops.length;Y++){const J=l.stops[Y],re=J[0].zoom;M[re]===void 0&&(M[re]={zoom:re,type:l.type,property:l.property,default:l.default,stops:[]},$.push(re)),M[re].stops.push([J[0].value,J[1]])}const V=[];for(const Y of $)V.push([M[Y].zoom,Xf(M[Y],a)]);const W={name:"linear"};return{kind:"composite",interpolationType:W,interpolationFactor:La.interpolationFactor.bind(void 0,W),zoomStops:V.map(Y=>Y[0]),evaluate:({zoom:Y},J)=>xs({stops:V,base:l.base},a,Y).evaluate(Y,J)}}if(g){const M=x==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:La.interpolationFactor.bind(void 0,M),zoomStops:l.stops.map($=>$[0]),evaluate:({zoom:$})=>S(l,a,$,j,A)}}return{kind:"source",evaluate(M,$){const V=$&&$.properties?$.properties[l.property]:void 0;return V===void 0?cu(l.default,a.default):S(l,a,V,j,A)}}}function cu(l,a,u){return l!==void 0?l:a!==void 0?a:u!==void 0?u:void 0}function C0(l,a,u,f,g){return cu(typeof u===g?f[u]:void 0,l.default,a.default)}function Zf(l,a,u){if(Ir(u)!=="number")return cu(l.default,a.default);const f=l.stops.length;if(f===1||u<=l.stops[0][0])return l.stops[0][1];if(u>=l.stops[f-1][0])return l.stops[f-1][1];const g=Lf(l.stops.map(x=>x[0]),u);return l.stops[g][1]}function xs(l,a,u){const f=l.base!==void 0?l.base:1;if(Ir(u)!=="number")return cu(l.default,a.default);const g=l.stops.length;if(g===1||u<=l.stops[0][0])return l.stops[0][1];if(u>=l.stops[g-1][0])return l.stops[g-1][1];const x=Lf(l.stops.map($=>$[0]),u),S=function($,V,W,Y){const J=Y-W,re=$-W;return J===0?0:V===1?re/J:(Math.pow(V,re)-1)/(Math.pow(V,J)-1)}(u,f,l.stops[x][0],l.stops[x+1][0]),j=l.stops[x][1],A=l.stops[x+1][1];let M=Hd[a.type]||j0;if(l.colorSpace&&l.colorSpace!=="rgb"){const $=ny[l.colorSpace];M=(V,W)=>$.reverse($.interpolate($.forward(V),$.forward(W),S))}return typeof j.evaluate=="function"?{evaluate(...$){const V=j.evaluate.apply(void 0,$),W=A.evaluate.apply(void 0,$);if(V!==void 0&&W!==void 0)return M(V,W,S)}}:M(j,A,S)}function P0(l,a,u){return a.type==="color"?u=Un.parse(u):a.type==="formatted"?u=uo.fromString(u.toString()):a.type==="resolvedImage"?u=Vo.fromString(u.toString()):Ir(u)===a.type||a.type==="enum"&&a.values[u]||(u=void 0),cu(u,l.default,a.default)}class Kf{constructor(a,u){this.expression=a,this._warningHistory={},this._evaluator=new Vg,this._defaultValue=u?function(f){return f.type==="color"&&(Qd(f.default)||Array.isArray(f.default))?new Un(0,0,0,0):f.type==="color"?Un.parse(f.default)||null:f.default===void 0?null:f.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(a,u,f,g,x,S,j,A){return this._evaluator.globals=a,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=g||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=S,this._evaluator.featureTileCoord=j||null,this._evaluator.featureDistanceData=A||null,this.expression.evaluate(this._evaluator)}evaluate(a,u,f,g,x,S,j,A){this._evaluator.globals=a,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=S||null,this._evaluator.featureTileCoord=j||null,this._evaluator.featureDistanceData=A||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new Ni(`Expected value to be one of ${Object.keys(this._enumValues).map($=>JSON.stringify($)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function uu(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in Jd}function du(l,a){const u=new Zg(Jd,[],a?function(g){const x={color:Po,string:jr,number:Lt,enum:jr,boolean:Sr,formatted:Ld,resolvedImage:Vl};return g.type==="array"?Uo(x[g.value]||Er,g.length):x[g.type]}(a):void 0),f=u.parse(l,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?T0(new Kf(f,a)):Xl(u.errors)}class uy{constructor(a,u){this.kind=a,this._styleExpression=u,this.isStateDependent=a!=="constant"&&!ys(u.expression)}evaluateWithoutErrorHandling(a,u,f,g,x,S){return this._styleExpression.evaluateWithoutErrorHandling(a,u,f,g,x,S)}evaluate(a,u,f,g,x,S){return this._styleExpression.evaluate(a,u,f,g,x,S)}}class eh{constructor(a,u,f,g){this.kind=a,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=a!=="camera"&&!ys(u.expression),this.interpolationType=g}evaluateWithoutErrorHandling(a,u,f,g,x,S){return this._styleExpression.evaluateWithoutErrorHandling(a,u,f,g,x,S)}evaluate(a,u,f,g,x,S){return this._styleExpression.evaluate(a,u,f,g,x,S)}interpolationFactor(a,u,f){return this.interpolationType?La.interpolationFactor(this.interpolationType,a,u,f):0}}function th(l,a){if((l=du(l,a)).result==="error")return l;const u=l.value.expression,f=iu(u);if(!f&&!lu(a))return Xl([new Da("","data expressions not supported")]);const g=Gl(u,["zoom","pitch","distance-from-center"]);if(!g&&!Gf(a))return Xl([new Da("","zoom expressions not supported")]);const x=Jf(u);return x||g?x instanceof Da?Xl([x]):x instanceof La&&!Hf(a)?Xl([new Da("",'"interpolate" expressions cannot be used with this property')]):T0(x?new eh(f?"camera":"composite",l.value,x.labels,x instanceof La?x.interpolation:void 0):new uy(f?"constant":"source",l.value)):Xl([new Da("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Yf{constructor(a,u){this._parameters=a,this._specification=u,hs(this,Xf(this._parameters,this._specification))}static deserialize(a){return new Yf(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Jf(l){let a=null;if(l instanceof y0)a=Jf(l.result);else if(l instanceof oy){for(const u of l.args)if(a=Jf(u),a)break}else(l instanceof Yg||l instanceof La)&&l.input instanceof ms&&l.input.name==="zoom"&&(a=l);return a instanceof Da||l.eachChild(u=>{const f=Jf(u);f instanceof Da?a=f:!a&&f?a=new Da("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&f&&a!==f&&(a=new Da("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}class Bt{constructor(a,u,f,g){this.message=(a?`${a}: `:"")+f,g&&(this.identifier=g),u!=null&&u.__line__&&(this.line=u.__line__)}}function ha(l){const a=l.key,u=l.value,f=l.valueSpec||{},g=l.objectElementValidators||{},x=l.style,S=l.styleSpec;let j=[];const A=Ir(u);if(A!=="object")return[new Bt(a,u,`object expected, ${A} found`)];for(const M in u){const $=M.split(".")[0];let V;g[$]?V=g[$]:f[$]?V=Ui:g["*"]?V=g["*"]:f["*"]&&(V=Ui),V?j=j.concat(V({key:(a&&`${a}.`)+M,value:u[M],valueSpec:f[$]||f["*"],style:x,styleSpec:S,object:u,objectKey:M},u)):j.push(new Bt(a,u[M],`unknown property "${M}"`))}for(const M in f)g[M]||f[M].required&&f[M].default===void 0&&u[M]===void 0&&j.push(new Bt(a,u,`missing required property "${M}"`));return j}function A0(l){const a=l.value,u=l.valueSpec,f=l.style,g=l.styleSpec,x=l.key,S=l.arrayElementValidator||Ui;if(Ir(a)!=="array")return[new Bt(x,a,`array expected, ${Ir(a)} found`)];if(u.length&&a.length!==u.length)return[new Bt(x,a,`array length ${u.length} expected, length ${a.length} found`)];if(u["min-length"]&&a.length<u["min-length"])return[new Bt(x,a,`array length at least ${u["min-length"]} expected, length ${a.length} found`)];let j={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};g.$version<7&&(j.function=u.function),Ir(u.value)==="object"&&(j=u.value);let A=[];for(let M=0;M<a.length;M++)A=A.concat(S({array:a,arrayIndex:M,value:a[M],valueSpec:j,style:f,styleSpec:g,key:`${x}[${M}]`}));return A}function rh(l){const a=l.key,u=l.value,f=l.valueSpec;let g=Ir(u);if(g==="number"&&u!=u&&(g="NaN"),g!=="number")return[new Bt(a,u,`number expected, ${g} found`)];if("minimum"in f){let x=f.minimum;if(Ir(f.minimum)==="array"&&(x=f.minimum[l.arrayIndex]),u<x)return[new Bt(a,u,`${u} is less than the minimum value ${x}`)]}if("maximum"in f){let x=f.maximum;if(Ir(f.maximum)==="array"&&(x=f.maximum[l.arrayIndex]),u>x)return[new Bt(a,u,`${u} is greater than the maximum value ${x}`)]}return[]}function nh(l){const a=l.valueSpec,u=Zn(l.value.type);let f,g,x,S={};const j=u!=="categorical"&&l.value.property===void 0,A=!j,M=Ir(l.value.stops)==="array"&&Ir(l.value.stops[0])==="array"&&Ir(l.value.stops[0][0])==="object",$=ha({key:l.key,value:l.value,valueSpec:l.styleSpec.function,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(Y){if(u==="identity")return[new Bt(Y.key,Y.value,'identity function may not have a "stops" property')];let J=[];const re=Y.value;return J=J.concat(A0({key:Y.key,value:re,valueSpec:Y.valueSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:V})),Ir(re)==="array"&&re.length===0&&J.push(new Bt(Y.key,re,"array must have at least one stop")),J},default:function(Y){return Ui({key:Y.key,value:Y.value,valueSpec:a,style:Y.style,styleSpec:Y.styleSpec})}}});return u==="identity"&&j&&$.push(new Bt(l.key,l.value,'missing required property "property"')),u==="identity"||l.value.stops||$.push(new Bt(l.key,l.value,'missing required property "stops"')),u==="exponential"&&l.valueSpec.expression&&!Hf(l.valueSpec)&&$.push(new Bt(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(A&&!lu(l.valueSpec)?$.push(new Bt(l.key,l.value,"property functions not supported")):j&&!Gf(l.valueSpec)&&$.push(new Bt(l.key,l.value,"zoom functions not supported"))),u!=="categorical"&&!M||l.value.property!==void 0||$.push(new Bt(l.key,l.value,'"property" property is required')),$;function V(Y){let J=[];const re=Y.value,le=Y.key;if(Ir(re)!=="array")return[new Bt(le,re,`array expected, ${Ir(re)} found`)];if(re.length!==2)return[new Bt(le,re,`array length 2 expected, length ${re.length} found`)];if(M){if(Ir(re[0])!=="object")return[new Bt(le,re,`object expected, ${Ir(re[0])} found`)];if(re[0].zoom===void 0)return[new Bt(le,re,"object stop key must have zoom")];if(re[0].value===void 0)return[new Bt(le,re,"object stop key must have value")];const ge=Zn(re[0].zoom);if(typeof ge!="number")return[new Bt(le,re[0].zoom,"stop zoom values must be numbers")];if(x&&x>ge)return[new Bt(le,re[0].zoom,"stop zoom values must appear in ascending order")];ge!==x&&(x=ge,g=void 0,S={}),J=J.concat(ha({key:`${le}[0]`,value:re[0],valueSpec:{zoom:{}},style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:rh,value:W}}))}else J=J.concat(W({key:`${le}[0]`,value:re[0],valueSpec:{},style:Y.style,styleSpec:Y.styleSpec},re));return uu(vi(re[1]))?J.concat([new Bt(`${le}[1]`,re[1],"expressions are not allowed in function stops.")]):J.concat(Ui({key:`${le}[1]`,value:re[1],valueSpec:a,style:Y.style,styleSpec:Y.styleSpec}))}function W(Y,J){const re=Ir(Y.value),le=Zn(Y.value),ge=Y.value!==null?Y.value:J;if(f){if(re!==f)return[new Bt(Y.key,ge,`${re} stop domain type must match previous stop domain type ${f}`)]}else f=re;if(re!=="number"&&re!=="string"&&re!=="boolean"&&typeof le!="number"&&typeof le!="string"&&typeof le!="boolean")return[new Bt(Y.key,ge,"stop domain value must be a number, string, or boolean")];if(re!=="number"&&u!=="categorical"){let Ae=`number expected, ${re} found`;return lu(a)&&u===void 0&&(Ae+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Bt(Y.key,ge,Ae)]}return u!=="categorical"||re!=="number"||typeof le=="number"&&isFinite(le)&&Math.floor(le)===le?u!=="categorical"&&re==="number"&&typeof le=="number"&&typeof g=="number"&&g!==void 0&&le<g?[new Bt(Y.key,ge,"stop domain values must appear in ascending order")]:(g=le,u==="categorical"&&le in S?[new Bt(Y.key,ge,"stop domain values must be unique")]:(S[le]=!0,[])):[new Bt(Y.key,ge,`integer expected, found ${String(le)}`)]}}function xi(l){const a=(l.expressionContext==="property"?th:du)(vi(l.value),l.valueSpec);if(a.result==="error")return a.value.map(f=>new Bt(`${l.key}${f.key}`,l.value,f.message));const u=a.value.expression||a.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!u.outputDefined())return[new Bt(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!ys(u))return[new Bt(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter")return ih(u,l);if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!Gl(u,["zoom","feature-state"]))return[new Bt(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!iu(u))return[new Bt(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ih(l,a){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(a.valueSpec&&a.valueSpec.expression)for(const g of a.valueSpec.expression.parameters)u.delete(g);if(u.size===0)return[];const f=[];return l instanceof ms&&u.has(l.name)?[new Bt(a.key,a.value,`["${l.name}"] expression is not supported in a filter for a ${a.object.type} layer with id: ${a.object.id}`)]:(l.eachChild(g=>{f.push(...ih(g,a))}),f)}function Qf(l){const a=l.key,u=l.value,f=l.valueSpec,g=[];return Array.isArray(f.values)?f.values.indexOf(Zn(u))===-1&&g.push(new Bt(a,u,`expected one of [${f.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(f.values).indexOf(Zn(u))===-1&&g.push(new Bt(a,u,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(u)} found`)),g}function dy(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const a of l.slice(1))if(!dy(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}function ep(l,a="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};dy(l)||(l=fu(l));const u=l;let f=!0;try{f=function(M){if(!hu(M))return M;let $=vi(M);return tp($),$=k0($),$}(u)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(u,null,2)}
        `)}const g=at[`filter_${a}`],x=du(f,g);let S=null;if(x.result==="error")throw new Error(x.value.map(M=>`${M.key}: ${M.message}`).join(", "));S=(M,$,V)=>x.value.evaluate(M,$,{},V);let j=null,A=null;if(f!==u){const M=du(u,g);if(M.result==="error")throw new Error(M.value.map($=>`${$.key}: ${$.message}`).join(", "));j=($,V,W,Y,J)=>M.value.evaluate($,V,{},W,void 0,void 0,Y,J),A=!iu(M.value.expression)}return{filter:S,dynamicFilter:j||void 0,needGeometry:N0(f),needFeature:!!A}}function k0(l){if(!Array.isArray(l))return l;const a=function(u){if(hy.has(u[0])){for(let f=1;f<u.length;f++)if(hu(u[f]))return!0}return u}(l);return a===!0?a:a.map(u=>k0(u))}function tp(l){let a=!1;const u=[];if(l[0]==="case"){for(let f=1;f<l.length-1;f+=2)a=a||hu(l[f]),u.push(l[f+1]);u.push(l[l.length-1])}else if(l[0]==="match"){a=a||hu(l[1]);for(let f=2;f<l.length-1;f+=2)u.push(l[f+1]);u.push(l[l.length-1])}else if(l[0]==="step"){a=a||hu(l[1]);for(let f=1;f<l.length-1;f+=2)u.push(l[f+1])}a&&(l.length=0,l.push("any",...u));for(let f=1;f<l.length;f++)tp(l[f])}function hu(l){if(!Array.isArray(l))return!1;if((a=l[0])==="pitch"||a==="distance-from-center")return!0;var a;for(let u=1;u<l.length;u++)if(hu(l[u]))return!0;return!1}const hy=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function QE(l,a){return l<a?-1:l>a?1:0}function N0(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(let a=1;a<l.length;a++)if(N0(l[a]))return!0;return!1}function fu(l){if(!l)return!0;const a=l[0];return l.length<=1?a!=="any":a==="=="?fy(l[1],l[2],"=="):a==="!="?rp(fy(l[1],l[2],"==")):a==="<"||a===">"||a==="<="||a===">="?fy(l[1],l[2],a):a==="any"?(u=l.slice(1),["any"].concat(u.map(fu))):a==="all"?["all"].concat(l.slice(1).map(fu)):a==="none"?["all"].concat(l.slice(1).map(fu).map(rp)):a==="in"?py(l[1],l.slice(2)):a==="!in"?rp(py(l[1],l.slice(2))):a==="has"?my(l[1]):a==="!has"?rp(my(l[1])):a!=="within"||l;var u}function fy(l,a,u){switch(l){case"$type":return[`filter-type-${u}`,a];case"$id":return[`filter-id-${u}`,a];default:return[`filter-${u}`,l,a]}}function py(l,a){if(a.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(u=>typeof u!=typeof a[0])?["filter-in-large",l,["literal",a.sort(QE)]]:["filter-in-small",l,["literal",a]]}}function my(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function rp(l){return["!",l]}function oh(l){return dy(vi(l.value))?xi(hs({},l,{expressionContext:"filter",valueSpec:l.styleSpec[`filter_${l.layerType||"fill"}`]})):ah(l)}function ah(l){const a=l.value,u=l.key;if(Ir(a)!=="array")return[new Bt(u,a,`array expected, ${Ir(a)} found`)];const f=l.styleSpec;let g,x=[];if(a.length<1)return[new Bt(u,a,"filter array must have at least 1 element")];switch(x=x.concat(Qf({key:`${u}[0]`,value:a[0],valueSpec:f.filter_operator,style:l.style,styleSpec:l.styleSpec})),Zn(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&Zn(a[1])==="$type"&&x.push(new Bt(u,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&x.push(new Bt(u,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(g=Ir(a[1]),g!=="string"&&x.push(new Bt(`${u}[1]`,a[1],`string expected, ${g} found`)));for(let S=2;S<a.length;S++)g=Ir(a[S]),Zn(a[1])==="$type"?x=x.concat(Qf({key:`${u}[${S}]`,value:a[S],valueSpec:f.geometry_type,style:l.style,styleSpec:l.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&x.push(new Bt(`${u}[${S}]`,a[S],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let S=1;S<a.length;S++)x=x.concat(ah({key:`${u}[${S}]`,value:a[S],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":g=Ir(a[1]),a.length!==2?x.push(new Bt(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):g!=="string"&&x.push(new Bt(`${u}[1]`,a[1],`string expected, ${g} found`));break;case"within":g=Ir(a[1]),a.length!==2?x.push(new Bt(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):g!=="object"&&x.push(new Bt(`${u}[1]`,a[1],`object expected, ${g} found`))}return x}function gy(l,a){const u=l.key,f=l.style,g=l.styleSpec,x=l.value,S=l.objectKey,j=g[`${a}_${l.layerType}`];if(!j)return[];const A=S.match(/^(.*)-transition$/);if(a==="paint"&&A&&j[A[1]]&&j[A[1]].transition)return Ui({key:u,value:x,valueSpec:g.transition,style:f,styleSpec:g});const M=l.valueSpec||j[S];if(!M)return[new Bt(u,x,`unknown property "${S}"`)];let $;if(Ir(x)==="string"&&lu(M)&&!M.tokens&&($=/^{([^}]+)}$/.exec(x))){const W=`\`{ "type": "identity", "property": ${$?JSON.stringify($[1]):'"_"'} }\``;return[new Bt(u,x,`"${S}" does not support interpolation syntax
Use an identity property function instead: ${W}.`)]}const V=[];return l.layerType==="symbol"&&(S==="text-field"&&f&&!f.glyphs&&V.push(new Bt(u,x,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&Qd(vi(x))&&Zn(x.type)==="identity"&&V.push(new Bt(u,x,'"text-font" does not support identity functions'))),V.concat(Ui({key:l.key,value:x,valueSpec:M,style:f,styleSpec:g,expressionContext:"property",propertyType:a,propertyKey:S}))}function M0(l){return gy(l,"paint")}function yy(l){return gy(l,"layout")}function I0(l){let a=[];const u=l.value,f=l.key,g=l.style,x=l.styleSpec;u.type||u.ref||a.push(new Bt(f,u,'either "type" or "ref" is required'));let S=Zn(u.type);const j=Zn(u.ref);if(u.id){const A=Zn(u.id);for(let M=0;M<l.arrayIndex;M++){const $=g.layers[M];Zn($.id)===A&&a.push(new Bt(f,u.id,`duplicate layer id "${u.id}", previously used at line ${$.id.__line__}`))}}if("ref"in u){let A;["type","source","source-layer","filter","layout"].forEach(M=>{M in u&&a.push(new Bt(f,u[M],`"${M}" is prohibited for ref layers`))}),g.layers.forEach(M=>{Zn(M.id)===j&&(A=M)}),A?A.ref?a.push(new Bt(f,u.ref,"ref cannot reference another ref layer")):S=Zn(A.type):typeof j=="string"&&a.push(new Bt(f,u.ref,`ref layer "${j}" not found`))}else if(S!=="background"&&S!=="sky")if(u.source){const A=g.sources&&g.sources[u.source],M=A&&Zn(A.type);A?M==="vector"&&S==="raster"?a.push(new Bt(f,u.source,`layer "${u.id}" requires a raster source`)):M==="raster"&&S!=="raster"?a.push(new Bt(f,u.source,`layer "${u.id}" requires a vector source`)):M!=="vector"||u["source-layer"]?M==="raster-dem"&&S!=="hillshade"?a.push(new Bt(f,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):S!=="line"||!u.paint||!u.paint["line-gradient"]&&!u.paint["line-trim-offset"]||M==="geojson"&&A.lineMetrics||a.push(new Bt(f,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new Bt(f,u,`layer "${u.id}" must specify a "source-layer"`)):a.push(new Bt(f,u.source,`source "${u.source}" not found`))}else a.push(new Bt(f,u,'missing required property "source"'));return a=a.concat(ha({key:f,value:u,valueSpec:x.layer,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ui({key:`${f}.type`,value:u.type,valueSpec:x.layer.type,style:l.style,styleSpec:l.styleSpec,object:u,objectKey:"type"}),filter:A=>oh(hs({layerType:S},A)),layout:A=>ha({layer:u,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":M=>yy(hs({layerType:S},M))}}),paint:A=>ha({layer:u,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":M=>M0(hs({layerType:S},M))}})}})),a}function al(l){const a=l.value,u=l.key,f=Ir(a);return f!=="string"?[new Bt(u,a,`string expected, ${f} found`)]:[]}const O0={promoteId:function({key:l,value:a}){if(Ir(a)==="string")return al({key:l,value:a});{const u=[];for(const f in a)u.push(...al({key:`${l}.${f}`,value:a[f]}));return u}}};function D0(l){const a=l.value,u=l.key,f=l.styleSpec,g=l.style;if(!a.type)return[new Bt(u,a,'"type" is required')];const x=Zn(a.type);let S;switch(x){case"vector":case"raster":case"raster-dem":return S=ha({key:u,value:a,valueSpec:f[`source_${x.replace("-","_")}`],style:l.style,styleSpec:f,objectElementValidators:O0}),S;case"geojson":if(S=ha({key:u,value:a,valueSpec:f.source_geojson,style:g,styleSpec:f,objectElementValidators:O0}),a.cluster)for(const j in a.clusterProperties){const[A,M]=a.clusterProperties[j],$=typeof A=="string"?[A,["accumulated"],["get",j]]:A;S.push(...xi({key:`${u}.${j}.map`,value:M,expressionContext:"cluster-map"})),S.push(...xi({key:`${u}.${j}.reduce`,value:$,expressionContext:"cluster-reduce"}))}return S;case"video":return ha({key:u,value:a,valueSpec:f.source_video,style:g,styleSpec:f});case"image":return ha({key:u,value:a,valueSpec:f.source_image,style:g,styleSpec:f});case"canvas":return[new Bt(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Qf({key:`${u}.type`,value:a.type,valueSpec:{values:eT(f)},style:g,styleSpec:f})}}function eT(l){return l.source.reduce((a,u)=>{const f=l[u];return f.type.type==="enum"&&(a=a.concat(Object.keys(f.type.values))),a},[])}function R0(l){const a=l.value,u=l.styleSpec,f=u.light,g=l.style;let x=[];const S=Ir(a);if(a===void 0)return x;if(S!=="object")return x=x.concat([new Bt("light",a,`object expected, ${S} found`)]),x;for(const j in a){const A=j.match(/^(.*)-transition$/);x=x.concat(A&&f[A[1]]&&f[A[1]].transition?Ui({key:j,value:a[j],valueSpec:u.transition,style:g,styleSpec:u}):f[j]?Ui({key:j,value:a[j],valueSpec:f[j],style:g,styleSpec:u}):[new Bt(j,a[j],`unknown property "${j}"`)])}return x}function vy(l){const a=l.value,u=l.key,f=l.style,g=l.styleSpec,x=g.terrain;let S=[];const j=Ir(a);if(a===void 0)return S;if(j!=="object")return S=S.concat([new Bt("terrain",a,`object expected, ${j} found`)]),S;for(const A in a){const M=A.match(/^(.*)-transition$/);S=S.concat(M&&x[M[1]]&&x[M[1]].transition?Ui({key:A,value:a[A],valueSpec:g.transition,style:f,styleSpec:g}):x[A]?Ui({key:A,value:a[A],valueSpec:x[A],style:f,styleSpec:g}):[new Bt(A,a[A],`unknown property "${A}"`)])}if(a.source){const A=f.sources&&f.sources[a.source],M=A&&Zn(A.type);A?M!=="raster-dem"&&S.push(new Bt(u,a.source,`terrain cannot be used with a source of type ${String(M)}, it only be used with a "raster-dem" source type`)):S.push(new Bt(u,a.source,`source "${a.source}" not found`))}else S.push(new Bt(u,a,'terrain is missing required property "source"'));return S}function L0(l){const a=l.value,u=l.style,f=l.styleSpec,g=f.fog;let x=[];const S=Ir(a);if(a===void 0)return x;if(S!=="object")return x=x.concat([new Bt("fog",a,`object expected, ${S} found`)]),x;for(const j in a){const A=j.match(/^(.*)-transition$/);x=x.concat(A&&g[A[1]]&&g[A[1]].transition?Ui({key:j,value:a[j],valueSpec:f.transition,style:u,styleSpec:f}):g[j]?Ui({key:j,value:a[j],valueSpec:g[j],style:u,styleSpec:f}):[new Bt(j,a[j],`unknown property "${j}"`)])}return x}const B0={"*":()=>[],array:A0,boolean:function(l){const a=l.value,u=l.key,f=Ir(a);return f!=="boolean"?[new Bt(u,a,`boolean expected, ${f} found`)]:[]},number:rh,color:function(l){const a=l.key,u=l.value,f=Ir(u);return f!=="string"?[new Bt(a,u,`color expected, ${f} found`)]:Rg(u)===null?[new Bt(a,u,`color expected, "${u}" found`)]:[]},enum:Qf,filter:oh,function:nh,layer:I0,object:ha,source:D0,light:R0,terrain:vy,fog:L0,string:al,formatted:function(l){return al(l).length===0?[]:xi(l)},resolvedImage:function(l){return al(l).length===0?[]:xi(l)},projection:function(l){const a=l.value,u=l.styleSpec,f=u.projection,g=l.style;let x=[];const S=Ir(a);if(S==="object")for(const j in a)x=x.concat(Ui({key:j,value:a[j],valueSpec:f[j],style:g,styleSpec:u}));else S!=="string"&&(x=x.concat([new Bt("projection",a,`object or string expected, ${S} found`)]));return x}};function Ui(l){const a=l.value,u=l.valueSpec,f=l.styleSpec;return u.expression&&Qd(Zn(a))?nh(l):u.expression&&uu(vi(a))?xi(l):u.type&&B0[u.type]?B0[u.type](l):ha(hs({},l,{valueSpec:u.type?f[u.type]:u}))}function tT(l){const a=l.value,u=l.key,f=al(l);return f.length||(a.indexOf("{fontstack}")===-1&&f.push(new Bt(u,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&f.push(new Bt(u,a,'"glyphs" url must include a "{range}" token'))),f}function z0(l,a=at){return Wo(Ui({key:"",value:l,valueSpec:a.$root,styleSpec:a,style:l,objectElementValidators:{glyphs:tT,"*":()=>[]}}))}const rT=l=>Wo(M0(l)),nT=l=>Wo(yy(l));function Wo(l){return l.slice().sort((a,u)=>a.line&&u.line?a.line-u.line:0)}function $0(l,a){let u=!1;if(a&&a.length)for(const f of a)l.fire(new ds(new Error(f.message))),u=!0;return u}var iT=Ba,fa=3;function Ba(l,a,u){var f=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var g=new Int32Array(this.arrayBuffer);l=g[0],this.d=(a=g[1])+2*(u=g[2]);for(var x=0;x<this.d*this.d;x++){var S=g[fa+x],j=g[fa+x+1];f.push(S===j?null:g.subarray(S,j))}var A=g[fa+f.length+1];this.keys=g.subarray(g[fa+f.length],A),this.bboxes=g.subarray(A),this.insert=this._insertReadonly}else{this.d=a+2*u;for(var M=0;M<this.d*this.d;M++)f.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=l,this.padding=u,this.scale=a/l,this.uid=0;var $=u/a*l;this.min=-$,this.max=l+$}Ba.prototype.insert=function(l,a,u,f,g){this._forEachCell(a,u,f,g,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g)},Ba.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ba.prototype._insertCell=function(l,a,u,f,g,x){this.cells[g].push(x)},Ba.prototype.query=function(l,a,u,f,g){var x=this.min,S=this.max;if(l<=x&&a<=x&&S<=u&&S<=f&&!g)return Array.prototype.slice.call(this.keys);var j=[];return this._forEachCell(l,a,u,f,this._queryCell,j,{},g),j},Ba.prototype._queryCell=function(l,a,u,f,g,x,S,j){var A=this.cells[g];if(A!==null)for(var M=this.keys,$=this.bboxes,V=0;V<A.length;V++){var W=A[V];if(S[W]===void 0){var Y=4*W;(j?j($[Y+0],$[Y+1],$[Y+2],$[Y+3]):l<=$[Y+2]&&a<=$[Y+3]&&u>=$[Y+0]&&f>=$[Y+1])?(S[W]=!0,x.push(M[W])):S[W]=!1}}},Ba.prototype._forEachCell=function(l,a,u,f,g,x,S,j){for(var A=this._convertToCellCoord(l),M=this._convertToCellCoord(a),$=this._convertToCellCoord(u),V=this._convertToCellCoord(f),W=A;W<=$;W++)for(var Y=M;Y<=V;Y++){var J=this.d*Y+W;if((!j||j(this._convertFromCellCoord(W),this._convertFromCellCoord(Y),this._convertFromCellCoord(W+1),this._convertFromCellCoord(Y+1)))&&g.call(this,l,a,u,f,J,x,S,j))return}},Ba.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},Ba.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},Ba.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,a=fa+this.cells.length+1+1,u=0,f=0;f<this.cells.length;f++)u+=this.cells[f].length;var g=new Int32Array(a+u+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var x=a,S=0;S<l.length;S++){var j=l[S];g[fa+S]=x,g.set(j,x),x+=j.length}return g[fa+l.length]=x,g.set(this.keys,x),g[fa+l.length+1]=x+=this.keys.length,g.set(this.bboxes,x),x+=this.bboxes.length,g.buffer};var Zl=R(iT);const np={};function zt(l,a,u={}){Object.defineProperty(l,"_classRegistryKey",{value:a,writeable:!1}),np[a]={klass:l,omit:u.omit||[]}}zt(Object,"Object"),Zl.serialize=function(l,a){const u=l.toArrayBuffer();return a&&a.push(u),{buffer:u}},Zl.deserialize=function(l){return new Zl(l.buffer)},Object.defineProperty(Zl,"name",{value:"Grid"}),zt(Zl,"Grid"),zt(Un,"Color"),zt(Error,"Error"),zt(il,"AJAXError"),zt(Vo,"ResolvedImage"),zt(Yf,"StylePropertyFunction"),zt(Kf,"StyleExpression",{omit:["_evaluator"]}),zt(eh,"ZoomDependentExpression"),zt(uy,"ZoomConstantExpression"),zt(ms,"CompoundExpression",{omit:["_evaluate"]});for(const l in Jd)np[Jd[l]._classRegistryKey]||zt(Jd[l],`Expression${l}`);function xy(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function by(l){return p.ImageBitmap&&l instanceof p.ImageBitmap}function pu(l,a){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(xy(l)||by(l))return a&&a.push(l),l;if(ArrayBuffer.isView(l)){const u=l;return a&&a.push(u.buffer),u}if(l instanceof p.ImageData)return a&&a.push(l.data.buffer),l;if(Array.isArray(l)){const u=[];for(const f of l)u.push(pu(f,a));return u}if(typeof l=="object"){const u=l.constructor,f=u._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${f}`);const g=u.serialize?u.serialize(l,a):{};if(!u.serialize){for(const x in l)l.hasOwnProperty(x)&&(np[f].omit.indexOf(x)>=0||(g[x]=pu(l[x],a)));l instanceof Error&&(g.message=l.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(g.$name=f),g}throw new Error("can't serialize object of type "+typeof l)}function Kl(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||xy(l)||by(l)||ArrayBuffer.isView(l)||l instanceof p.ImageData)return l;if(Array.isArray(l))return l.map(Kl);if(typeof l=="object"){const a=l.$name||"Object",{klass:u}=np[a];if(!u)throw new Error(`can't deserialize unregistered class ${a}`);if(u.deserialize)return u.deserialize(l);const f=Object.create(u.prototype);for(const g of Object.keys(l))g!=="$name"&&(f[g]=Kl(l[g]));return f}throw new Error("can't deserialize object of type "+typeof l)}const Rt={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519};function _y(l){for(const a of l)if(wy(a.charCodeAt(0)))return!0;return!1}function oT(l){for(const a of l)if(!F0(a.charCodeAt(0)))return!1;return!0}function F0(l){return!(Rt.Arabic(l)||Rt["Arabic Supplement"](l)||Rt["Arabic Extended-A"](l)||Rt["Arabic Presentation Forms-A"](l)||Rt["Arabic Presentation Forms-B"](l))}function wy(l){return!(l!==746&&l!==747&&(l<4352||!(Rt["Bopomofo Extended"](l)||Rt.Bopomofo(l)||Rt["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||Rt["CJK Compatibility Ideographs"](l)||Rt["CJK Compatibility"](l)||Rt["CJK Radicals Supplement"](l)||Rt["CJK Strokes"](l)||!(!Rt["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||Rt["CJK Unified Ideographs Extension A"](l)||Rt["CJK Unified Ideographs"](l)||Rt["Enclosed CJK Letters and Months"](l)||Rt["Hangul Compatibility Jamo"](l)||Rt["Hangul Jamo Extended-A"](l)||Rt["Hangul Jamo Extended-B"](l)||Rt["Hangul Jamo"](l)||Rt["Hangul Syllables"](l)||Rt.Hiragana(l)||Rt["Ideographic Description Characters"](l)||Rt.Kanbun(l)||Rt["Kangxi Radicals"](l)||Rt["Katakana Phonetic Extensions"](l)||Rt.Katakana(l)&&l!==12540||!(!Rt["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!Rt["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||Rt["Unified Canadian Aboriginal Syllabics"](l)||Rt["Unified Canadian Aboriginal Syllabics Extended"](l)||Rt["Vertical Forms"](l)||Rt["Yijing Hexagram Symbols"](l)||Rt["Yi Syllables"](l)||Rt["Yi Radicals"](l))))}function U0(l){return!(wy(l)||function(a){return!!(Rt["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||Rt["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||Rt["Letterlike Symbols"](a)||Rt["Number Forms"](a)||Rt["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||Rt["Control Pictures"](a)&&a!==9251||Rt["Optical Character Recognition"](a)||Rt["Enclosed Alphanumerics"](a)||Rt["Geometric Shapes"](a)||Rt["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||Rt["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Rt["CJK Symbols and Punctuation"](a)||Rt.Katakana(a)||Rt["Private Use Area"](a)||Rt["CJK Compatibility Forms"](a)||Rt["Small Form Variants"](a)||Rt["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(l))}function V0(l){return l>=1424&&l<=2303||Rt["Arabic Presentation Forms-A"](l)||Rt["Arabic Presentation Forms-B"](l)}function aT(l,a){return!(!a&&V0(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||Rt.Khmer(l))}function sT(l){for(const a of l)if(V0(a.charCodeAt(0)))return!0;return!1}const Sy="deferred",Ey="loading",Ty="loaded";let mu=null,v="unavailable",d=null;const m=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(v="error"),mu&&mu(l)};function w(){T.fire(new Ul("pluginStateChange",{pluginStatus:v,pluginURL:d}))}const T=new Rd,P=function(){return v},L=function(){if(v!==Sy||!d)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");v=Ey,w(),d&&Kc({url:d},l=>{l?m(l):(v=Ty,w())})},z={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>v===Ty||z.applyArabicShaping!=null,isLoading:()=>v===Ey,setState(l){v=l.pluginStatus,d=l.pluginURL},isParsed:()=>z.applyArabicShaping!=null&&z.processBidirectionalText!=null&&z.processStyledBidirectionalText!=null,getPluginURL:()=>d};class U{constructor(a,u){this.zoom=a,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.transition=u.transition,this.pitch=u.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(a){return function(u,f){for(const g of u)if(!aT(g.charCodeAt(0),f))return!1;return!0}(a,z.isLoaded())}}class Z{constructor(a,u){this.property=a,this.value=u,this.expression=function(f,g){if(Qd(f))return new Yf(f,g);if(uu(f)){const x=th(f,g);if(x.result==="error")throw new Error(x.value.map(S=>`${S.key}: ${S.message}`).join(", "));return x.value}{let x=f;return typeof f=="string"&&g.type==="color"&&(x=Un.parse(f)),{kind:"constant",evaluate:()=>x}}}(u===void 0?a.specification.default:u,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,u,f){return this.property.possiblyEvaluate(this,a,u,f)}}class H{constructor(a){this.property=a,this.value=new Z(a,void 0)}transitioned(a,u){return new se(this.property,this.value,u,Ge({},a.transition,this.transition),a.now)}untransitioned(){return new se(this.property,this.value,null,{},0)}}class Q{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return ar(this._values[a].value.value)}setValue(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new H(this._values[a].property)),this._values[a].value=new Z(this._values[a].property,u===null?void 0:ar(u))}getTransition(a){return ar(this._values[a].transition)}setTransition(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new H(this._values[a].property)),this._values[a].transition=ar(u)||void 0}serialize(){const a={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(a[u]=f);const g=this.getTransition(u);g!==void 0&&(a[`${u}-transition`]=g)}return a}transitioned(a,u){const f=new de(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].transitioned(a,u._values[g]);return f}untransitioned(){const a=new de(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].untransitioned();return a}}class se{constructor(a,u,f,g,x){const S=g.delay||0,j=g.duration||0;x=x||0,this.property=a,this.value=u,this.begin=x+S,this.end=this.begin+j,a.specification.transition&&(g.delay||g.duration)&&(this.prior=f)}possiblyEvaluate(a,u,f){const g=a.now||0,x=this.value.possiblyEvaluate(a,u,f),S=this.prior;if(S){if(g>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(g<this.begin)return S.possiblyEvaluate(a,u,f);{const j=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(a,u,f),x,xe(j))}}return x}}class de{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,u,f){const g=new me(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(a,u,f);return g}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class fe{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}getValue(a){return ar(this._values[a].value)}setValue(a,u){this._values[a]=new Z(this._values[a].property,u===null?void 0:ar(u))}serialize(){const a={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(a[u]=f)}return a}possiblyEvaluate(a,u,f){const g=new me(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(a,u,f);return g}}class he{constructor(a,u,f){this.property=a,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,u,f,g){return this.property.evaluate(this.value,this.parameters,a,u,f,g)}}class me{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class te{constructor(a){this.specification=a}possiblyEvaluate(a,u){return a.expression.evaluate(u)}interpolate(a,u,f){const g=Hd[this.specification.type];return g?g(a,u,f):a}}class ue{constructor(a,u){this.specification=a,this.overrides=u}possiblyEvaluate(a,u,f,g){return new he(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(u,null,{},f,g)}:a.expression,u)}interpolate(a,u,f){if(a.value.kind!=="constant"||u.value.kind!=="constant")return a;if(a.value.value===void 0||u.value.value===void 0)return new he(this,{kind:"constant",value:void 0},a.parameters);const g=Hd[this.specification.type];return g?new he(this,{kind:"constant",value:g(a.value.value,u.value.value,f)},a.parameters):a}evaluate(a,u,f,g,x,S){return a.kind==="constant"?a.value:a.evaluate(u,f,g,x,S)}}class be{constructor(a){this.specification=a}possiblyEvaluate(a,u,f,g){return!!a.expression.evaluate(u,null,{},f,g)}interpolate(){return!1}}class we{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const u=new U(0,{});for(const f in a){const g=a[f];g.specification.overridable&&this.overridableProperties.push(f);const x=this.defaultPropertyValues[f]=new Z(g,void 0),S=this.defaultTransitionablePropertyValues[f]=new H(g);this.defaultTransitioningPropertyValues[f]=S.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=x.possiblyEvaluate(u)}}}function Oe(l,a){return 256*(l=ve(Math.floor(l),0,255))+ve(Math.floor(a),0,255)}zt(ue,"DataDrivenProperty"),zt(te,"DataConstantProperty"),zt(be,"ColorRampProperty");const Le={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class De{constructor(a,u){this._structArray=a,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class qe{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,u){return a._trim(),u&&(a.isTransferred=!0,u.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const u=Object.create(this.prototype);return u.arrayBuffer=a.arrayBuffer,u.length=a.length,u.capacity=a.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ue(l,a=1){let u=0,f=0;return{members:l.map(g=>{const x=Le[g.type].BYTES_PER_ELEMENT,S=u=Je(u,Math.max(a,x)),j=g.components||1;return f=Math.max(f,x),u+=x*j,{name:g.name,type:g.type,components:j,offset:S}}),size:Je(u,Math.max(f,a)),alignment:a}}function Je(l,a){return Math.ceil(l/a)*a}class bt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.int16[g+0]=u,this.int16[g+1]=f,a}}bt.prototype.bytesPerElement=4,zt(bt,"StructArrayLayout2i4");class Ze extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const x=3*a;return this.int16[x+0]=u,this.int16[x+1]=f,this.int16[x+2]=g,a}}Ze.prototype.bytesPerElement=6,zt(Ze,"StructArrayLayout3i6");class ut extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,a,u,f,g)}emplace(a,u,f,g,x){const S=4*a;return this.int16[S+0]=u,this.int16[S+1]=f,this.int16[S+2]=g,this.int16[S+3]=x,a}}ut.prototype.bytesPerElement=8,zt(ut,"StructArrayLayout4i8");class et extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j){const A=this.length;return this.resize(A+1),this.emplace(A,a,u,f,g,x,S,j)}emplace(a,u,f,g,x,S,j,A){const M=6*a,$=12*a,V=3*a;return this.int16[M+0]=u,this.int16[M+1]=f,this.uint8[$+4]=g,this.uint8[$+5]=x,this.uint8[$+6]=S,this.uint8[$+7]=j,this.float32[V+2]=A,a}}et.prototype.bytesPerElement=12,zt(et,"StructArrayLayout2i4ub1f12");class xt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,a,u,f,g)}emplace(a,u,f,g,x){const S=4*a;return this.float32[S+0]=u,this.float32[S+1]=f,this.float32[S+2]=g,this.float32[S+3]=x,a}}xt.prototype.bytesPerElement=16,zt(xt,"StructArrayLayout4f16");class Ye extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x){const S=this.length;return this.resize(S+1),this.emplace(S,a,u,f,g,x)}emplace(a,u,f,g,x,S){const j=6*a,A=3*a;return this.uint16[j+0]=u,this.uint16[j+1]=f,this.uint16[j+2]=g,this.uint16[j+3]=x,this.float32[A+2]=S,a}}Ye.prototype.bytesPerElement=12,zt(Ye,"StructArrayLayout4ui1f12");class ct extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,a,u,f,g)}emplace(a,u,f,g,x){const S=4*a;return this.uint16[S+0]=u,this.uint16[S+1]=f,this.uint16[S+2]=g,this.uint16[S+3]=x,a}}ct.prototype.bytesPerElement=8,zt(ct,"StructArrayLayout4ui8");class wt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S){const j=this.length;return this.resize(j+1),this.emplace(j,a,u,f,g,x,S)}emplace(a,u,f,g,x,S,j){const A=6*a;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=g,this.int16[A+3]=x,this.int16[A+4]=S,this.int16[A+5]=j,a}}wt.prototype.bytesPerElement=12,zt(wt,"StructArrayLayout6i12");class mt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j,A,M,$,V,W){const Y=this.length;return this.resize(Y+1),this.emplace(Y,a,u,f,g,x,S,j,A,M,$,V,W)}emplace(a,u,f,g,x,S,j,A,M,$,V,W,Y){const J=12*a;return this.int16[J+0]=u,this.int16[J+1]=f,this.int16[J+2]=g,this.int16[J+3]=x,this.uint16[J+4]=S,this.uint16[J+5]=j,this.uint16[J+6]=A,this.uint16[J+7]=M,this.int16[J+8]=$,this.int16[J+9]=V,this.int16[J+10]=W,this.int16[J+11]=Y,a}}mt.prototype.bytesPerElement=24,zt(mt,"StructArrayLayout4i4ui4i24");class St extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S){const j=this.length;return this.resize(j+1),this.emplace(j,a,u,f,g,x,S)}emplace(a,u,f,g,x,S,j){const A=10*a,M=5*a;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=g,this.float32[M+2]=x,this.float32[M+3]=S,this.float32[M+4]=j,a}}St.prototype.bytesPerElement=20,zt(St,"StructArrayLayout3i3f20");class Kt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint32[1*a+0]=u,a}}Kt.prototype.bytesPerElement=4,zt(Kt,"StructArrayLayout1ul4");class sr extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j,A,M,$,V,W,Y){const J=this.length;return this.resize(J+1),this.emplace(J,a,u,f,g,x,S,j,A,M,$,V,W,Y)}emplace(a,u,f,g,x,S,j,A,M,$,V,W,Y,J){const re=20*a,le=10*a;return this.int16[re+0]=u,this.int16[re+1]=f,this.int16[re+2]=g,this.int16[re+3]=x,this.int16[re+4]=S,this.float32[le+3]=j,this.float32[le+4]=A,this.float32[le+5]=M,this.float32[le+6]=$,this.int16[re+14]=V,this.uint32[le+8]=W,this.uint16[re+18]=Y,this.uint16[re+19]=J,a}}sr.prototype.bytesPerElement=40,zt(sr,"StructArrayLayout5i4f1i1ul2ui40");class Ut extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j){const A=this.length;return this.resize(A+1),this.emplace(A,a,u,f,g,x,S,j)}emplace(a,u,f,g,x,S,j,A){const M=8*a;return this.int16[M+0]=u,this.int16[M+1]=f,this.int16[M+2]=g,this.int16[M+4]=x,this.int16[M+5]=S,this.int16[M+6]=j,this.int16[M+7]=A,a}}Ut.prototype.bytesPerElement=16,zt(Ut,"StructArrayLayout3i2i2i16");class ir extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x){const S=this.length;return this.resize(S+1),this.emplace(S,a,u,f,g,x)}emplace(a,u,f,g,x,S){const j=4*a,A=8*a;return this.float32[j+0]=u,this.float32[j+1]=f,this.float32[j+2]=g,this.int16[A+6]=x,this.int16[A+7]=S,a}}ir.prototype.bytesPerElement=16,zt(ir,"StructArrayLayout2f1f2i16");class Tr extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,a,u,f,g)}emplace(a,u,f,g,x){const S=12*a,j=3*a;return this.uint8[S+0]=u,this.uint8[S+1]=f,this.float32[j+1]=g,this.float32[j+2]=x,a}}Tr.prototype.bytesPerElement=12,zt(Tr,"StructArrayLayout2ub2f12");class wr extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const x=3*a;return this.float32[x+0]=u,this.float32[x+1]=f,this.float32[x+2]=g,a}}wr.prototype.bytesPerElement=12,zt(wr,"StructArrayLayout3f12");class Zt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const x=3*a;return this.uint16[x+0]=u,this.uint16[x+1]=f,this.uint16[x+2]=g,a}}Zt.prototype.bytesPerElement=6,zt(Zt,"StructArrayLayout3ui6");class Hr extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j,A,M,$,V,W,Y,J,re,le,ge,Ae,ye,Te,Me){const Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,a,u,f,g,x,S,j,A,M,$,V,W,Y,J,re,le,ge,Ae,ye,Te,Me)}emplace(a,u,f,g,x,S,j,A,M,$,V,W,Y,J,re,le,ge,Ae,ye,Te,Me,Ne){const Qe=30*a,Ke=15*a,st=60*a;return this.int16[Qe+0]=u,this.int16[Qe+1]=f,this.int16[Qe+2]=g,this.float32[Ke+2]=x,this.float32[Ke+3]=S,this.uint16[Qe+8]=j,this.uint16[Qe+9]=A,this.uint32[Ke+5]=M,this.uint32[Ke+6]=$,this.uint32[Ke+7]=V,this.uint16[Qe+16]=W,this.uint16[Qe+17]=Y,this.uint16[Qe+18]=J,this.float32[Ke+10]=re,this.float32[Ke+11]=le,this.uint8[st+48]=ge,this.uint8[st+49]=Ae,this.uint8[st+50]=ye,this.uint32[Ke+13]=Te,this.int16[Qe+28]=Me,this.uint8[st+58]=Ne,a}}Hr.prototype.bytesPerElement=60,zt(Hr,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Jr extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x,S,j,A,M,$,V,W,Y,J,re,le,ge,Ae,ye,Te,Me,Ne,Qe,Ke,st,_t,tt,dt,ht,yt){const jt=this.length;return this.resize(jt+1),this.emplace(jt,a,u,f,g,x,S,j,A,M,$,V,W,Y,J,re,le,ge,Ae,ye,Te,Me,Ne,Qe,Ke,st,_t,tt,dt,ht,yt)}emplace(a,u,f,g,x,S,j,A,M,$,V,W,Y,J,re,le,ge,Ae,ye,Te,Me,Ne,Qe,Ke,st,_t,tt,dt,ht,yt,jt){const ot=38*a,Ot=19*a;return this.int16[ot+0]=u,this.int16[ot+1]=f,this.int16[ot+2]=g,this.float32[Ot+2]=x,this.float32[Ot+3]=S,this.int16[ot+8]=j,this.int16[ot+9]=A,this.int16[ot+10]=M,this.int16[ot+11]=$,this.int16[ot+12]=V,this.int16[ot+13]=W,this.uint16[ot+14]=Y,this.uint16[ot+15]=J,this.uint16[ot+16]=re,this.uint16[ot+17]=le,this.uint16[ot+18]=ge,this.uint16[ot+19]=Ae,this.uint16[ot+20]=ye,this.uint16[ot+21]=Te,this.uint16[ot+22]=Me,this.uint16[ot+23]=Ne,this.uint16[ot+24]=Qe,this.uint16[ot+25]=Ke,this.uint16[ot+26]=st,this.uint16[ot+27]=_t,this.uint16[ot+28]=tt,this.uint32[Ot+15]=dt,this.float32[Ot+16]=ht,this.float32[Ot+17]=yt,this.float32[Ot+18]=jt,a}}Jr.prototype.bytesPerElement=76,zt(Jr,"StructArrayLayout3i2f6i15ui1ul3f76");class Qr extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.float32[1*a+0]=u,a}}Qr.prototype.bytesPerElement=4,zt(Qr,"StructArrayLayout1f4");class en extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,x){const S=this.length;return this.resize(S+1),this.emplace(S,a,u,f,g,x)}emplace(a,u,f,g,x,S){const j=5*a;return this.float32[j+0]=u,this.float32[j+1]=f,this.float32[j+2]=g,this.float32[j+3]=x,this.float32[j+4]=S,a}}en.prototype.bytesPerElement=20,zt(en,"StructArrayLayout5f20");class Vi extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,a,u,f,g)}emplace(a,u,f,g,x){const S=6*a;return this.uint32[3*a+0]=u,this.uint16[S+2]=f,this.uint16[S+3]=g,this.uint16[S+4]=x,a}}Vi.prototype.bytesPerElement=12,zt(Vi,"StructArrayLayout1ul3ui12");class bi extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.uint16[g+0]=u,this.uint16[g+1]=f,a}}bi.prototype.bytesPerElement=4,zt(bi,"StructArrayLayout2ui4");class Go extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint16[1*a+0]=u,a}}Go.prototype.bytesPerElement=2,zt(Go,"StructArrayLayout1ui2");class za extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.float32[g+0]=u,this.float32[g+1]=f,a}}za.prototype.bytesPerElement=8,zt(za,"StructArrayLayout2f8");class Tn extends De{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Tn.prototype.size=40;class tn extends sr{get(a){return new Tn(this,a)}}zt(tn,"CollisionBoxArray");class Dr extends De{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(a){this._structArray.uint8[this._pos1+49]=a}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(a){this._structArray.uint8[this._pos1+50]=a}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(a){this._structArray.uint32[this._pos4+13]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(a){this._structArray.uint8[this._pos1+58]=a}}Dr.prototype.size=60;class Kn extends Hr{get(a){return new Dr(this,a)}}zt(Kn,"PlacedSymbolArray");class Ji extends De{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(a){this._structArray.uint32[this._pos4+15]=a}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ji.prototype.size=76;class mn extends Jr{get(a){return new Ji(this,a)}}zt(mn,"SymbolInstanceArray");class ho extends Qr{getoffsetX(a){return this.float32[1*a+0]}}zt(ho,"GlyphOffsetArray");class ip extends bt{getx(a){return this.int16[2*a+0]}gety(a){return this.int16[2*a+1]}}zt(ip,"SymbolLineVertexArray");class Yl extends De{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Yl.prototype.size=12;class sh extends Vi{get(a){return new Yl(this,a)}}zt(sh,"FeatureIndexArray");class bs extends bi{geta_centroid_pos0(a){return this.uint16[2*a+0]}geta_centroid_pos1(a){return this.uint16[2*a+1]}}zt(bs,"FillExtrusionCentroidArray");const sl=Ue([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Jl=Ue([{name:"a_dash",components:4,type:"Uint16"}]);var op={exports:{}},lh={exports:{}};lh.exports=function(l,a){var u,f,g,x,S,j,A,M;for(f=l.length-(u=3&l.length),g=a,S=3432918353,j=461845907,M=0;M<f;)A=255&l.charCodeAt(M)|(255&l.charCodeAt(++M))<<8|(255&l.charCodeAt(++M))<<16|(255&l.charCodeAt(++M))<<24,++M,g=27492+(65535&(x=5*(65535&(g=(g^=A=(65535&(A=(A=(65535&A)*S+(((A>>>16)*S&65535)<<16)&4294967295)<<15|A>>>17))*j+(((A>>>16)*j&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(A=0,u){case 3:A^=(255&l.charCodeAt(M+2))<<16;case 2:A^=(255&l.charCodeAt(M+1))<<8;case 1:g^=A=(65535&(A=(A=(65535&(A^=255&l.charCodeAt(M)))*S+(((A>>>16)*S&65535)<<16)&4294967295)<<15|A>>>17))*j+(((A>>>16)*j&65535)<<16)&4294967295}return g^=l.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var jy=lh.exports,GO={exports:{}};GO.exports=function(l,a){for(var u,f=l.length,g=a^f,x=0;f>=4;)u=1540483477*(65535&(u=255&l.charCodeAt(x)|(255&l.charCodeAt(++x))<<8|(255&l.charCodeAt(++x))<<16|(255&l.charCodeAt(++x))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:g^=(255&l.charCodeAt(x+2))<<16;case 2:g^=(255&l.charCodeAt(x+1))<<8;case 1:g=1540483477*(65535&(g^=255&l.charCodeAt(x)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var HO=jy,HK=GO.exports;op.exports=HO,op.exports.murmur3=HO,op.exports.murmur2=HK;var lT=R(op.exports);class q0{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,u,f,g){this.ids.push(XO(a)),this.positions.push(u,f,g)}getPositions(a){const u=XO(a);let f=0,g=this.ids.length-1;for(;f<g;){const S=f+g>>1;this.ids[S]>=u?g=S:f=S+1}const x=[];for(;this.ids[f]===u;)x.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return x}static serialize(a,u){const f=new Float64Array(a.ids),g=new Uint32Array(a.positions);return cT(f,g,0,f.length-1),u&&u.push(f.buffer,g.buffer),{ids:f,positions:g}}static deserialize(a){const u=new q0;return u.ids=a.ids,u.positions=a.positions,u.indexed=!0,u}}function XO(l){const a=+l;return!isNaN(a)&&Number.MIN_SAFE_INTEGER<=a&&a<=Number.MAX_SAFE_INTEGER?a:lT(String(l))}function cT(l,a,u,f){for(;u<f;){const g=l[u+f>>1];let x=u-1,S=f+1;for(;;){do x++;while(l[x]<g);do S--;while(l[S]>g);if(x>=S)break;W0(l,x,S),W0(a,3*x,3*S),W0(a,3*x+1,3*S+1),W0(a,3*x+2,3*S+2)}S-u<f-S?(cT(l,a,u,S),u=S+1):(cT(l,a,S+1,f),f=S)}}function W0(l,a,u){const f=l[a];l[a]=l[u],l[u]=f}zt(q0,"FeaturePositionMap");class Ql{constructor(a){this.gl=a.gl,this.initialized=!1}fetchUniformLocation(a,u){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(a,u),this.initialized=!0),!!this.location}}class G0 extends Ql{constructor(a){super(a),this.current=0}set(a,u,f){this.fetchUniformLocation(a,u)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class ZO extends Ql{constructor(a){super(a),this.current=[0,0,0,0]}set(a,u,f){this.fetchUniformLocation(a,u)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class KO extends Ql{constructor(a){super(a),this.current=Un.transparent}set(a,u,f){this.fetchUniformLocation(a,u)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const XK=new Float32Array(16),ZK=new Float32Array(9),KK=new Float32Array(4);function uT(l){return[Oe(255*l.r,255*l.g),Oe(255*l.b,255*l.a)]}class Cy{constructor(a,u,f){this.value=a,this.uniformNames=u.map(g=>`u_${g}`),this.type=f}setUniform(a,u,f,g,x){u.set(a,x,g.constantOr(this.value))}getBinding(a,u){return this.type==="color"?new KO(a):new G0(a)}}class ap{constructor(a,u){this.uniformNames=u.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(a){this.pixelRatio=a.pixelRatio||1,this.pattern=a.tl.concat(a.br)}setUniform(a,u,f,g,x){const S=x==="u_pattern"||x==="u_dash"?this.pattern:x==="u_pixel_ratio"?this.pixelRatio:null;S&&u.set(a,x,S)}getBinding(a,u){return u==="u_pattern"||u==="u_dash"?new ZO(a):new G0(a)}}class ec{constructor(a,u,f,g){this.expression=a,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(x=>({name:`a_${x}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(a,u,f,g,x,S){const j=this.paintVertexArray.length,A=this.expression.evaluate(new U(0),u,{},x,g,S);this.paintVertexArray.resize(a),this._setPaintValue(j,a,A)}updatePaintArray(a,u,f,g,x){const S=this.expression.evaluate({zoom:0},f,g,void 0,x);this._setPaintValue(a,u,S)}_setPaintValue(a,u,f){if(this.type==="color"){const g=uT(f);for(let x=a;x<u;x++)this.paintVertexArray.emplace(x,g[0],g[1])}else{for(let g=a;g<u;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class _s{constructor(a,u,f,g,x,S){this.expression=a,this.uniformNames=u.map(j=>`u_${j}_t`),this.type=f,this.useIntegerZoom=g,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=u.map(j=>({name:`a_${j}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(a,u,f,g,x,S){const j=this.expression.evaluate(new U(this.zoom),u,{},x,g,S),A=this.expression.evaluate(new U(this.zoom+1),u,{},x,g,S),M=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(M,a,j,A)}updatePaintArray(a,u,f,g,x){const S=this.expression.evaluate({zoom:this.zoom},f,g,void 0,x),j=this.expression.evaluate({zoom:this.zoom+1},f,g,void 0,x);this._setPaintValue(a,u,S,j)}_setPaintValue(a,u,f,g){if(this.type==="color"){const x=uT(f),S=uT(g);for(let j=a;j<u;j++)this.paintVertexArray.emplace(j,x[0],x[1],S[0],S[1])}else{for(let x=a;x<u;x++)this.paintVertexArray.emplace(x,f,g);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(g))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,u,f,g,x){const S=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,j=ve(this.expression.interpolationFactor(S,this.zoom,this.zoom+1),0,1);u.set(a,x,j)}getBinding(a,u){return new G0(a)}}class gu{constructor(a,u,f,g,x){this.expression=a,this.layerId=x,this.paintVertexAttributes=(f==="array"?Jl:sl).members;for(let S=0;S<u.length;++S);this.paintVertexArray=new g}populatePaintArray(a,u,f){const g=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValues(g,a,u.patterns&&u.patterns[this.layerId],f)}updatePaintArray(a,u,f,g,x,S){this._setPaintValues(a,u,f.patterns&&f.patterns[this.layerId],S)}_setPaintValues(a,u,f,g){if(!g||!f)return;const x=g[f];if(!x)return;const{tl:S,br:j,pixelRatio:A}=x;for(let M=a;M<u;M++)this.paintVertexArray.emplace(M,S[0],S[1],j[0],j[1],A)}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class yu{constructor(a,u,f=()=>!0){this.binders={},this._buffers=[];const g=[];for(const x in a.paint._values){if(!f(x))continue;const S=a.paint.get(x);if(!(S instanceof he&&lu(S.property.specification)))continue;const j=JK(x,a.type),A=S.value,M=S.property.specification.type,$=!!S.property.useIntegerZoom,V=x==="line-dasharray"||x.endsWith("pattern"),W=x==="line-dasharray"&&a.layout.get("line-cap").value.kind!=="constant";if(A.kind!=="constant"||W)if(A.kind==="source"||W||V){const Y=YO(x,M,"source");this.binders[x]=V?new gu(A,j,M,Y,a.id):new ec(A,j,M,Y),g.push(`/a_${x}`)}else{const Y=YO(x,M,"composite");this.binders[x]=new _s(A,j,M,$,u,Y),g.push(`/z_${x}`)}else this.binders[x]=V?new ap(A.value,j):new Cy(A.value,j,M),g.push(`/u_${x}`)}this.cacheKey=g.sort().join("")}getMaxValue(a){const u=this.binders[a];return u instanceof ec||u instanceof _s?u.maxValue:0}populatePaintArrays(a,u,f,g,x,S){for(const j in this.binders){const A=this.binders[j];(A instanceof ec||A instanceof _s||A instanceof gu)&&A.populatePaintArray(a,u,f,g,x,S)}}setConstantPatternPositions(a){for(const u in this.binders){const f=this.binders[u];f instanceof ap&&f.setConstantPatternPositions(a)}}updatePaintArrays(a,u,f,g,x,S){let j=!1;for(const A in a){const M=u.getPositions(A);for(const $ of M){const V=f.feature($.index);for(const W in this.binders){const Y=this.binders[W];if((Y instanceof ec||Y instanceof _s||Y instanceof gu)&&Y.expression.isStateDependent===!0){const J=g.paint.get(W);Y.expression=J.value,Y.updatePaintArray($.start,$.end,V,a[A],x,S),j=!0}}}}return j}defines(){const a=[];for(const u in this.binders){const f=this.binders[u];(f instanceof Cy||f instanceof ap)&&a.push(...f.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return a}getBinderAttributes(){const a=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof ec||f instanceof _s||f instanceof gu)for(let g=0;g<f.paintVertexAttributes.length;g++)a.push(f.paintVertexAttributes[g].name)}return a}getBinderUniforms(){const a=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Cy||f instanceof ap||f instanceof _s)for(const g of f.uniformNames)a.push(g)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a){const u=[];for(const f in this.binders){const g=this.binders[f];if(g instanceof Cy||g instanceof ap||g instanceof _s)for(const x of g.uniformNames)u.push({name:x,property:f,binding:g.getBinding(a,x)})}return u}setUniforms(a,u,f,g,x){for(const{name:S,property:j,binding:A}of f)this.binders[j].setUniform(a,A,x,g.get(j),S)}updatePaintBuffers(){this._buffers=[];for(const a in this.binders){const u=this.binders[a];(u instanceof ec||u instanceof _s||u instanceof gu)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(a){for(const u in this.binders){const f=this.binders[u];(f instanceof ec||f instanceof _s||f instanceof gu)&&f.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const u=this.binders[a];(u instanceof ec||u instanceof _s||u instanceof gu)&&u.destroy()}}}class ch{constructor(a,u,f=()=>!0){this.programConfigurations={};for(const g of a)this.programConfigurations[g.id]=new yu(g,u,f);this.needsUpload=!1,this._featureMap=new q0,this._bufferOffset=0}populatePaintArrays(a,u,f,g,x,S,j){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(a,u,g,x,S,j);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,u,f,g,x){for(const S of f)this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(a,this._featureMap,u,S,g,x)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}const YK={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function JK(l,a){return YK[l]||[l.replace(`${a}-`,"").replace(/-/g,"_")]}const QK={"line-pattern":{source:Ye,composite:Ye},"fill-pattern":{source:Ye,composite:Ye},"fill-extrusion-pattern":{source:Ye,composite:Ye},"line-dasharray":{source:ct,composite:ct}},eY={color:{source:za,composite:xt},number:{source:Qr,composite:za}};function YO(l,a,u){const f=QK[l];return f&&f[u]||eY[a][u]}zt(Cy,"ConstantBinder"),zt(ap,"PatternConstantBinder"),zt(ec,"SourceExpressionBinder"),zt(gu,"PatternCompositeBinder"),zt(_s,"CompositeExpressionBinder"),zt(yu,"ProgramConfiguration",{omit:["_buffers"]}),zt(ch,"ProgramConfigurationSet");const JO="-transition";class ws extends Rd{constructor(a,u){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&a.type!=="sky"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),u.layout&&(this._unevaluatedLayout=new fe(u.layout)),u.paint)){this._transitionablePaint=new Q(u.paint);for(const f in a.paint)this.setPaintProperty(f,a.paint[f],{validate:!1});for(const f in a.layout)this.setLayoutProperty(f,a.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new me(u.paint)}}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,u,f={}){u!=null&&this._validate(nT,`layers.${this.id}.layout.${a}`,a,u,f)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,u):this.visibility=u)}getPaintProperty(a){return vt(a,JO)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,u,f={}){if(u!=null&&this._validate(rT,`layers.${this.id}.paint.${a}`,a,u,f))return!1;if(vt(a,JO))return this._transitionablePaint.setTransition(a.slice(0,-11),u||void 0),!1;{const g=this._transitionablePaint._values[a],x=g.value.isDataDriven(),S=g.value;this._transitionablePaint.setValue(a,u),this._handleSpecialPaintPropertyUpdate(a);const j=this._transitionablePaint._values[a].value,A=j.isDataDriven(),M=vt(a,"pattern")||a==="line-dasharray";return A||x||M||this._handleOverridablePaintPropertyUpdate(a,S,j)}}_handleSpecialPaintPropertyUpdate(a){}getProgramIds(){return null}getProgramConfiguration(a){return null}_handleOverridablePaintPropertyUpdate(a,u,f){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,u){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,u)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),it(a,(u,f)=>!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length))}_validate(a,u,f,g,x={}){return(!x||x.validate!==!1)&&$0(this,a.call(z0,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:at,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const u=this.paint.get(a);if(u instanceof he&&lu(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ep(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const tY=Ue([{name:"a_pos",components:2,type:"Int16"}],4),rY=Ue([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Yn{constructor(a=[]){this.segments=a}prepareSegment(a,u,f,g){let x=this.segments[this.segments.length-1];return a>Yn.MAX_VERTEX_ARRAY_LENGTH&&pt(`Max vertices per segment is ${Yn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!x||x.vertexLength+a>Yn.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==g)&&(x={vertexOffset:u.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},g!==void 0&&(x.sortKey=g),this.segments.push(x)),x}get(){return this.segments}destroy(){for(const a of this.segments)for(const u in a.vaos)a.vaos[u].destroy()}static simpleSegment(a,u,f,g){return new Yn([{vertexOffset:a,primitiveOffset:u,vertexLength:f,primitiveLength:g,vaos:{},sortKey:0}])}}Yn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,zt(Yn,"SegmentVector");var tr=8192;class vu{constructor(a,u){a&&(u?this.setSouthWest(a).setNorthEast(u):a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))}setNorthEast(a){return this._ne=a instanceof rn?new rn(a.lng,a.lat):rn.convert(a),this}setSouthWest(a){return this._sw=a instanceof rn?new rn(a.lng,a.lat):rn.convert(a),this}extend(a){const u=this._sw,f=this._ne;let g,x;if(a instanceof rn)g=a,x=a;else{if(!(a instanceof vu))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(vu.convert(a)):this.extend(rn.convert(a)):typeof a=="object"&&a!==null&&a.hasOwnProperty("lat")&&(a.hasOwnProperty("lon")||a.hasOwnProperty("lng"))?this.extend(rn.convert(a)):this;if(g=a._sw,x=a._ne,!g||!x)return this}return u||f?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),f.lng=Math.max(x.lng,f.lng),f.lat=Math.max(x.lat,f.lat)):(this._sw=new rn(g.lng,g.lat),this._ne=new rn(x.lng,x.lat)),this}getCenter(){return new rn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new rn(this.getWest(),this.getNorth())}getSouthEast(){return new rn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:u,lat:f}=rn.convert(a);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(a){return!a||a instanceof vu?a:new vu(a)}}var H0=1e-6,Ho=typeof Float32Array<"u"?Float32Array:Array;function QO(){var l=new Ho(9);return Ho!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function eD(l,a,u){var f=a[0],g=a[1],x=a[2],S=a[3],j=a[4],A=a[5],M=a[6],$=a[7],V=a[8],W=u[0],Y=u[1],J=u[2],re=u[3],le=u[4],ge=u[5],Ae=u[6],ye=u[7],Te=u[8];return l[0]=W*f+Y*S+J*M,l[1]=W*g+Y*j+J*$,l[2]=W*x+Y*A+J*V,l[3]=re*f+le*S+ge*M,l[4]=re*g+le*j+ge*$,l[5]=re*x+le*A+ge*V,l[6]=Ae*f+ye*S+Te*M,l[7]=Ae*g+ye*j+Te*$,l[8]=Ae*x+ye*A+Te*V,l}function Ss(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function dT(l,a){var u=a[0],f=a[1],g=a[2],x=a[3],S=a[4],j=a[5],A=a[6],M=a[7],$=a[8],V=a[9],W=a[10],Y=a[11],J=a[12],re=a[13],le=a[14],ge=a[15],Ae=u*j-f*S,ye=u*A-g*S,Te=u*M-x*S,Me=f*A-g*j,Ne=f*M-x*j,Qe=g*M-x*A,Ke=$*re-V*J,st=$*le-W*J,_t=$*ge-Y*J,tt=V*le-W*re,dt=V*ge-Y*re,ht=W*ge-Y*le,yt=Ae*ht-ye*dt+Te*tt+Me*_t-Ne*st+Qe*Ke;return yt?(l[0]=(j*ht-A*dt+M*tt)*(yt=1/yt),l[1]=(g*dt-f*ht-x*tt)*yt,l[2]=(re*Qe-le*Ne+ge*Me)*yt,l[3]=(W*Ne-V*Qe-Y*Me)*yt,l[4]=(A*_t-S*ht-M*st)*yt,l[5]=(u*ht-g*_t+x*st)*yt,l[6]=(le*Te-J*Qe-ge*ye)*yt,l[7]=($*Qe-W*Te+Y*ye)*yt,l[8]=(S*dt-j*_t+M*Ke)*yt,l[9]=(f*_t-u*dt-x*Ke)*yt,l[10]=(J*Ne-re*Te+ge*Ae)*yt,l[11]=(V*Te-$*Ne-Y*Ae)*yt,l[12]=(j*st-S*tt-A*Ke)*yt,l[13]=(u*tt-f*st+g*Ke)*yt,l[14]=(re*ye-J*Me-le*Ae)*yt,l[15]=($*Me-V*ye+W*Ae)*yt,l):null}function uh(l,a,u){var f=a[0],g=a[1],x=a[2],S=a[3],j=a[4],A=a[5],M=a[6],$=a[7],V=a[8],W=a[9],Y=a[10],J=a[11],re=a[12],le=a[13],ge=a[14],Ae=a[15],ye=u[0],Te=u[1],Me=u[2],Ne=u[3];return l[0]=ye*f+Te*j+Me*V+Ne*re,l[1]=ye*g+Te*A+Me*W+Ne*le,l[2]=ye*x+Te*M+Me*Y+Ne*ge,l[3]=ye*S+Te*$+Me*J+Ne*Ae,l[4]=(ye=u[4])*f+(Te=u[5])*j+(Me=u[6])*V+(Ne=u[7])*re,l[5]=ye*g+Te*A+Me*W+Ne*le,l[6]=ye*x+Te*M+Me*Y+Ne*ge,l[7]=ye*S+Te*$+Me*J+Ne*Ae,l[8]=(ye=u[8])*f+(Te=u[9])*j+(Me=u[10])*V+(Ne=u[11])*re,l[9]=ye*g+Te*A+Me*W+Ne*le,l[10]=ye*x+Te*M+Me*Y+Ne*ge,l[11]=ye*S+Te*$+Me*J+Ne*Ae,l[12]=(ye=u[12])*f+(Te=u[13])*j+(Me=u[14])*V+(Ne=u[15])*re,l[13]=ye*g+Te*A+Me*W+Ne*le,l[14]=ye*x+Te*M+Me*Y+Ne*ge,l[15]=ye*S+Te*$+Me*J+Ne*Ae,l}function Py(l,a,u){var f,g,x,S,j,A,M,$,V,W,Y,J,re=u[0],le=u[1],ge=u[2];return a===l?(l[12]=a[0]*re+a[4]*le+a[8]*ge+a[12],l[13]=a[1]*re+a[5]*le+a[9]*ge+a[13],l[14]=a[2]*re+a[6]*le+a[10]*ge+a[14],l[15]=a[3]*re+a[7]*le+a[11]*ge+a[15]):(g=a[1],x=a[2],S=a[3],j=a[4],A=a[5],M=a[6],$=a[7],V=a[8],W=a[9],Y=a[10],J=a[11],l[0]=f=a[0],l[1]=g,l[2]=x,l[3]=S,l[4]=j,l[5]=A,l[6]=M,l[7]=$,l[8]=V,l[9]=W,l[10]=Y,l[11]=J,l[12]=f*re+j*le+V*ge+a[12],l[13]=g*re+A*le+W*ge+a[13],l[14]=x*re+M*le+Y*ge+a[14],l[15]=S*re+$*le+J*ge+a[15]),l}function dh(l,a,u){var f=u[0],g=u[1],x=u[2];return l[0]=a[0]*f,l[1]=a[1]*f,l[2]=a[2]*f,l[3]=a[3]*f,l[4]=a[4]*g,l[5]=a[5]*g,l[6]=a[6]*g,l[7]=a[7]*g,l[8]=a[8]*x,l[9]=a[9]*x,l[10]=a[10]*x,l[11]=a[11]*x,l[12]=a[12],l[13]=a[13],l[14]=a[14],l[15]=a[15],l}function hT(l,a,u){var f=Math.sin(u),g=Math.cos(u),x=a[4],S=a[5],j=a[6],A=a[7],M=a[8],$=a[9],V=a[10],W=a[11];return a!==l&&(l[0]=a[0],l[1]=a[1],l[2]=a[2],l[3]=a[3],l[12]=a[12],l[13]=a[13],l[14]=a[14],l[15]=a[15]),l[4]=x*g+M*f,l[5]=S*g+$*f,l[6]=j*g+V*f,l[7]=A*g+W*f,l[8]=M*g-x*f,l[9]=$*g-S*f,l[10]=V*g-j*f,l[11]=W*g-A*f,l}function X0(l,a,u){var f=Math.sin(u),g=Math.cos(u),x=a[0],S=a[1],j=a[2],A=a[3],M=a[8],$=a[9],V=a[10],W=a[11];return a!==l&&(l[4]=a[4],l[5]=a[5],l[6]=a[6],l[7]=a[7],l[12]=a[12],l[13]=a[13],l[14]=a[14],l[15]=a[15]),l[0]=x*g-M*f,l[1]=S*g-$*f,l[2]=j*g-V*f,l[3]=A*g-W*f,l[8]=x*f+M*g,l[9]=S*f+$*g,l[10]=j*f+V*g,l[11]=A*f+W*g,l}function tD(l,a){return l[0]=a[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=a[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=a[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function rD(l,a,u){var f,g,x,S=u[0],j=u[1],A=u[2],M=Math.hypot(S,j,A);return M<H0?null:(S*=M=1/M,j*=M,A*=M,f=Math.sin(a),g=Math.cos(a),l[0]=S*S*(x=1-g)+g,l[1]=j*S*x+A*f,l[2]=A*S*x-j*f,l[3]=0,l[4]=S*j*x-A*f,l[5]=j*j*x+g,l[6]=A*j*x+S*f,l[7]=0,l[8]=S*A*x+j*f,l[9]=j*A*x-S*f,l[10]=A*A*x+g,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l)}Math.hypot||(Math.hypot=function(){for(var l=0,a=arguments.length;a--;)l+=arguments[a]*arguments[a];return Math.sqrt(l)});var nY=uh;function fT(){var l=new Ho(3);return Ho!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function nD(l){var a=new Ho(3);return a[0]=l[0],a[1]=l[1],a[2]=l[2],a}function Ay(l){return Math.hypot(l[0],l[1],l[2])}function sp(l,a,u){var f=new Ho(3);return f[0]=l,f[1]=a,f[2]=u,f}function tc(l,a,u){return l[0]=a[0]+u[0],l[1]=a[1]+u[1],l[2]=a[2]+u[2],l}function pT(l,a,u){return l[0]=a[0]-u[0],l[1]=a[1]-u[1],l[2]=a[2]-u[2],l}function iD(l,a,u){return l[0]=a[0]*u[0],l[1]=a[1]*u[1],l[2]=a[2]*u[2],l}function ky(l,a,u){return l[0]=Math.min(a[0],u[0]),l[1]=Math.min(a[1],u[1]),l[2]=Math.min(a[2],u[2]),l}function Ny(l,a,u){return l[0]=Math.max(a[0],u[0]),l[1]=Math.max(a[1],u[1]),l[2]=Math.max(a[2],u[2]),l}function pa(l,a,u){return l[0]=a[0]*u,l[1]=a[1]*u,l[2]=a[2]*u,l}function My(l,a,u,f){return l[0]=a[0]+u[0]*f,l[1]=a[1]+u[1]*f,l[2]=a[2]+u[2]*f,l}function fo(l,a){var u=a[0],f=a[1],g=a[2],x=u*u+f*f+g*g;return x>0&&(x=1/Math.sqrt(x)),l[0]=a[0]*x,l[1]=a[1]*x,l[2]=a[2]*x,l}function $a(l,a){return l[0]*a[0]+l[1]*a[1]+l[2]*a[2]}function mT(l,a,u){var f=a[0],g=a[1],x=a[2],S=u[0],j=u[1],A=u[2];return l[0]=g*A-x*j,l[1]=x*S-f*A,l[2]=f*j-g*S,l}function Vn(l,a,u){var f=a[0],g=a[1],x=a[2],S=u[3]*f+u[7]*g+u[11]*x+u[15];return l[0]=(u[0]*f+u[4]*g+u[8]*x+u[12])/(S=S||1),l[1]=(u[1]*f+u[5]*g+u[9]*x+u[13])/S,l[2]=(u[2]*f+u[6]*g+u[10]*x+u[14])/S,l}function oD(l,a,u){var f=u[0],g=u[1],x=u[2],S=a[0],j=a[1],A=a[2],M=g*A-x*j,$=x*S-f*A,V=f*j-g*S,W=g*V-x*$,Y=x*M-f*V,J=f*$-g*M,re=2*u[3];return $*=re,V*=re,Y*=2,J*=2,l[0]=S+(M*=re)+(W*=2),l[1]=j+$+Y,l[2]=A+V+J,l}var Iy,Es=pT,iY=iD,oY=Ay;function aD(l,a,u){return l[0]=a[0]*u,l[1]=a[1]*u,l[2]=a[2]*u,l[3]=a[3]*u,l}function sD(l,a){var u=a[0],f=a[1],g=a[2],x=a[3],S=u*u+f*f+g*g+x*x;return S>0&&(S=1/Math.sqrt(S)),l[0]=u*S,l[1]=f*S,l[2]=g*S,l[3]=x*S,l}function hh(l,a,u){var f=a[0],g=a[1],x=a[2],S=a[3];return l[0]=u[0]*f+u[4]*g+u[8]*x+u[12]*S,l[1]=u[1]*f+u[5]*g+u[9]*x+u[13]*S,l[2]=u[2]*f+u[6]*g+u[10]*x+u[14]*S,l[3]=u[3]*f+u[7]*g+u[11]*x+u[15]*S,l}function lD(){var l=new Ho(4);return Ho!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function cD(l){return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l}function uD(l,a,u){u*=.5;var f=a[0],g=a[1],x=a[2],S=a[3],j=Math.sin(u),A=Math.cos(u);return l[0]=f*A+S*j,l[1]=g*A+x*j,l[2]=x*A-g*j,l[3]=S*A-f*j,l}function dD(l,a,u){u*=.5;var f=a[0],g=a[1],x=a[2],S=a[3],j=Math.sin(u),A=Math.cos(u);return l[0]=f*A-x*j,l[1]=g*A+S*j,l[2]=x*A+f*j,l[3]=S*A-g*j,l}fT(),Iy=new Ho(4),Ho!=Float32Array&&(Iy[0]=0,Iy[1]=0,Iy[2]=0,Iy[3]=0);var aY=sD;fT(),sp(1,0,0),sp(0,1,0),lD(),lD(),QO();const sY=Ue([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:hD}=sY,fD=Ue([{name:"a_pos_3",components:3,type:"Int16"}]);var Oy=Ue([{name:"a_pos",type:"Int16",components:2}]);class gT{constructor(a,u){this.pos=a,this.dir=u}intersectsPlane(a,u,f){const g=$a(u,this.dir);if(Math.abs(g)<1e-6)return!1;const x=((a[0]-this.pos[0])*u[0]+(a[1]-this.pos[1])*u[1]+(a[2]-this.pos[2])*u[2])/g;return f[0]=this.pos[0]+this.dir[0]*x,f[1]=this.pos[1]+this.dir[1]*x,f[2]=this.pos[2]+this.dir[2]*x,!0}closestPointOnSphere(a,u,f){if(function(Y,J){var re=Y[0],le=Y[1],ge=Y[2],Ae=J[0],ye=J[1],Te=J[2];return Math.abs(re-Ae)<=H0*Math.max(1,Math.abs(re),Math.abs(Ae))&&Math.abs(le-ye)<=H0*Math.max(1,Math.abs(le),Math.abs(ye))&&Math.abs(ge-Te)<=H0*Math.max(1,Math.abs(ge),Math.abs(Te))}(this.pos,a)||u===0)return f[0]=f[1]=f[2]=0,!1;const[g,x,S]=this.dir,j=this.pos[0]-a[0],A=this.pos[1]-a[1],M=this.pos[2]-a[2],$=g*g+x*x+S*S,V=2*(j*g+A*x+M*S),W=V*V-4*$*(j*j+A*A+M*M-u*u);if(W<0){const Y=Math.max(-V/2,0),J=j+g*Y,re=A+x*Y,le=M+S*Y,ge=Math.hypot(J,re,le);return f[0]=J*u/ge,f[1]=re*u/ge,f[2]=le*u/ge,!1}{const Y=(-V-Math.sqrt(W))/(2*$);if(Y<0){const J=Math.hypot(j,A,M);return f[0]=j*u/J,f[1]=A*u/J,f[2]=M*u/J,!1}return f[0]=j+g*Y,f[1]=A+x*Y,f[2]=M+S*Y,!0}}}class yT{constructor(a,u,f,g,x){this.TL=a,this.TR=u,this.BR=f,this.BL=g,this.horizon=x}static fromInvProjectionMatrix(a,u,f){const g=[-1,1,1],x=[1,1,1],S=[1,-1,1],j=[-1,-1,1],A=Vn(g,g,a),M=Vn(x,x,a),$=Vn(S,S,a),V=Vn(j,j,a);return new yT(A,M,$,V,u/f)}}class vT{constructor(a,u){this.points=a,this.planes=u}static fromInvProjectionMatrix(a,u,f,g){const x=Math.pow(2,f),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const M=hh([],A,a),$=1/M[3]/u*x;return function(V,W,Y){return V[0]=W[0]*Y[0],V[1]=W[1]*Y[1],V[2]=W[2]*Y[2],V[3]=W[3]*Y[3],V}(M,M,[$,$,g?1/M[3]:$,$])}),j=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const M=fo([],mT([],Es([],S[A[0]],S[A[1]]),Es([],S[A[2]],S[A[1]]))),$=-$a(M,S[A[1]]);return M.concat($)});return new vT(S,j)}}class po{static fromPoints(a){const u=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const g of a)ky(u,u,g),Ny(f,f,g);return new po(u,f)}static applyTransform(a,u){const f=a.getCorners();for(let g=0;g<f.length;++g)Vn(f[g],f[g],u);return po.fromPoints(f)}constructor(a,u){this.min=a,this.max=u,this.center=pa([],tc([],this.min,this.max),.5)}quadrant(a){const u=[a%2==0,a<2],f=nD(this.min),g=nD(this.max);for(let x=0;x<u.length;x++)f[x]=u[x]?this.min[x]:this.center[x],g[x]=u[x]?this.center[x]:this.max[x];return g[2]=this.max[2],new po(f,g)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}distanceZ(a){return Math.max(Math.min(this.max[2],a[2]),this.min[2])-a[2]}getCorners(){const a=this.min,u=this.max;return[[a[0],a[1],a[2]],[u[0],a[1],a[2]],[u[0],u[1],a[2]],[a[0],u[1],a[2]],[a[0],a[1],u[2]],[u[0],a[1],u[2]],[u[0],u[1],u[2]],[a[0],u[1],u[2]]]}intersects(a){const u=this.getCorners();let f=!0;for(let g=0;g<a.planes.length;g++){const x=a.planes[g];let S=0;for(let j=0;j<u.length;j++)S+=$a(x,u[j])+x[3]>=0;if(S===0)return 0;S!==u.length&&(f=!1)}if(f)return 2;for(let g=0;g<3;g++){let x=Number.MAX_VALUE,S=-Number.MAX_VALUE;for(let j=0;j<a.points.length;j++){const A=a.points[j][g]-this.min[g];x=Math.min(x,A),S=Math.max(S,A)}if(S<0||x>this.max[g]-this.min[g])return 0}return 1}}const xT=5,pD=6,ll=tr/Math.PI/2,lY=16383,fh=64,Dy=[fh,32,16],Fa=-ll,Ua=ll,cY=[new po([Fa,Fa,Fa],[Ua,Ua,Ua]),new po([Fa,Fa,Fa],[0,0,Ua]),new po([0,Fa,Fa],[Ua,0,Ua]),new po([Fa,0,Fa],[0,Ua,Ua]),new po([0,0,Fa],[Ua,Ua,Ua])];function Z0(l){return l*ll/By}function mD(l,a,u,f=!0){const g=pa([],l._camera.position,l.worldSize),x=[a,u,1,1];hh(x,x,l.pixelMatrixInverse),aD(x,x,1/x[3]);const S=fo([],Es([],x,g)),j=l.globeMatrix,A=[j[12],j[13],j[14]],M=Es([],A,g),$=Ay(M),V=fo([],M),W=l.worldSize/(2*Math.PI),Y=$a(V,S),J=Math.asin(W/$);if(J<Math.acos(Y)){if(!f)return null;const _t=[],tt=[];pa(_t,S,$/Y),fo(tt,Es(tt,_t,M)),fo(S,tc(S,M,pa(S,tt,Math.tan(J)*$)))}const re=[];new gT(g,S).closestPointOnSphere(A,W,re);const le=fo([],lo(j,0)),ge=fo([],lo(j,1)),Ae=fo([],lo(j,2)),ye=$a(le,re),Te=$a(ge,re),Me=$a(Ae,re),Ne=_e(Math.asin(-Te/W));let Qe=_e(Math.atan2(ye,Me));Qe=l.center.lng+function(_t,tt){const dt=(tt-_t+180)%360-180;return dt<-180?dt+360:dt}(l.center.lng,Qe);const Ke=ul(Qe),st=ve(dl(Ne),0,1);return new dp(Ke,st)}class uY{constructor(a,u,f){this.a=Es([],a,f),this.b=Es([],u,f),this.center=f;const g=fo([],this.a),x=fo([],this.b);this.angle=Math.acos($a(g,x))}}function bT(l,a){if(l.angle===0)return null;let u;return u=l.a[a]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[a]/l.a[a]/Math.sin(l.angle)-1/Math.tan(l.angle)),u<0||u>1?null:function(f,g,x,S){const j=Math.sin(x);return f*(Math.sin((1-S)*x)/j)+g*(Math.sin(S*x)/j)}(l.a[a],l.b[a],l.angle,ve(u,0,1))+l.center[a]}function cl(l){if(l.z<=1)return cY[l.z+2*l.y+l.x];const a=_T(K0(l));return po.fromPoints(a)}function ph(l,a,u){return pa(l,l,1-u),My(l,l,a,u)}function gD(l,a){const u=up(a.zoom);if(u===0)return cl(l);const f=K0(l),g=_T(f),x=ul(f.getWest())*a.worldSize,S=ul(f.getEast())*a.worldSize,j=dl(f.getNorth())*a.worldSize,A=dl(f.getSouth())*a.worldSize,M=[x,j,0],$=[S,j,0],V=[x,A,0],W=[S,A,0],Y=dT([],a.globeMatrix);return Vn(M,M,Y),Vn($,$,Y),Vn(V,V,Y),Vn(W,W,Y),g[0]=ph(g[0],V,u),g[1]=ph(g[1],W,u),g[2]=ph(g[2],$,u),g[3]=ph(g[3],M,u),po.fromPoints(g)}function yD(l,a,u){for(const f of l)Vn(f,f,a),pa(f,f,u)}function dY(l,a,u){const f=a/l.worldSize,g=l.globeMatrix;if(u.z<=1){const Ke=cl(u).getCorners();return yD(Ke,g,f),po.fromPoints(Ke)}const x=K0(u),S=_T(x);yD(S,g,f);const j=Number.MAX_VALUE,A=[-j,-j,-j],M=[j,j,j];if(x.contains(l.center)){for(const _t of S)ky(M,M,_t),Ny(A,A,_t);A[2]=0;const Ke=l.point,st=[Ke.x*f,Ke.y*f,0];return ky(M,M,st),Ny(A,A,st),new po(M,A)}const $=[g[12]*f,g[13]*f,g[14]*f],V=x.getCenter(),W=ve(l.center.lat,-Wi,Wi),Y=ve(V.lat,-Wi,Wi),J=ul(l.center.lng),re=dl(W);let le=J-ul(V.lng);const ge=re-dl(Y);le>.5?le-=1:le<-.5&&(le+=1);let Ae=0;Math.abs(le)>Math.abs(ge)?Ae=le>=0?1:3:(Ae=ge>=0?0:2,My($,$,[g[4]*f,g[5]*f,g[6]*f],-Math.sin(ae(ge>=0?x.getSouth():x.getNorth()))*ll));const ye=S[Ae],Te=S[(Ae+1)%4],Me=new uY(ye,Te,$),Ne=[bT(Me,0)||ye[0],bT(Me,1)||ye[1],bT(Me,2)||ye[2]],Qe=up(l.zoom);if(Qe>0){const Ke=function({x:_t,y:tt,z:dt},ht,yt,jt,ot){const Ot=1/(1<<dt);let Vt=_t*Ot,Dt=Vt+Ot,ur=tt*Ot,Ct=ur+Ot,Yt=0;const dr=(Vt+Dt)/2-jt;return dr>.5?Yt=-1:dr<-.5&&(Yt=1),Vt=((Vt+Yt)*ht-(jt*=ht))*yt+jt,Dt=((Dt+Yt)*ht-jt)*yt+jt,ur=(ur*ht-(ot*=ht))*yt+ot,Ct=(Ct*ht-ot)*yt+ot,[[Vt,Ct,0],[Dt,Ct,0],[Dt,ur,0],[Vt,ur,0]]}(u,a,l._pixelsPerMercatorPixel,J,re);for(let _t=0;_t<S.length;_t++)ph(S[_t],Ke[_t],Qe);const st=tc([],Ke[Ae],Ke[(Ae+1)%4]);pa(st,st,.5),ph(Ne,st,Qe)}for(const Ke of S)ky(M,M,Ke),Ny(A,A,Ke);return M[2]=Math.min(ye[2],Te[2]),ky(M,M,Ne),Ny(A,A,Ne),new po(M,A)}function K0({x:l,y:a,z:u}){const f=1/(1<<u),g=new rn(ma(l*f),qi((a+1)*f)),x=new rn(ma((l+1)*f),qi(a*f));return new vu(g,x)}function _T(l){const a=ae(l.getNorth()),u=ae(l.getSouth()),f=Math.cos(a),g=Math.cos(u),x=Math.sin(a),S=Math.sin(u),j=l.getWest(),A=l.getEast();return[lp(g,S,j),lp(g,S,A),lp(f,x,A),lp(f,x,j)]}function lp(l,a,u,f=ll){return u=ae(u),[l*Math.sin(u)*f,-a*f,l*Math.cos(u)*f]}function cp(l,a,u){return lp(Math.cos(ae(l)),Math.sin(ae(l)),a,u)}function Ry(l,a,u,f){const g=1<<u.z,x=(l/tr+u.x)/g;return cp(qi((a/tr+u.y)/g),ma(x),f)}function Y0({min:l,max:a}){return lY/Math.max(a[0]-l[0],a[1]-l[1],a[2]-l[2])}const vD=new Float64Array(16);function Ly(l){const a=Y0(l),u=tD(vD,[a,a,a]);return Py(u,u,((f=[])[0]=-(g=l.min)[0],f[1]=-g[1],f[2]=-g[2],f));var f,g}function wT(l){const a=(f=l.min,(u=vD)[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=f[0],u[13]=f[1],u[14]=f[2],u[15]=1,u);var u,f;const g=1/Y0(l);return dh(a,a,[g,g,g])}function xD(l,a,u,f,g){const x=function(A){const M=tr/(2*Math.PI);return A/(2*Math.PI)/M}(u),S=[l,a,-u/(2*Math.PI)],j=Ss(new Float64Array(16));return Py(j,j,S),dh(j,j,[x,x,x]),hT(j,j,ae(-g)),X0(j,j,ae(-f)),j}function up(l){return Pe(xT,pD,l)}function bD(l,a){const u=cp(a.lat,a.lng),f=function(J){const re=cp(J._center.lat,J._center.lng);let le=mT([],sp(0,1,0),re);const ge=rD([],-J.angle,re);le=Vn(le,le,ge),rD(ge,-J._pitch,le);const Ae=fo([],re);return pa(Ae,Ae,Z0(J.cameraToCenterDistance/J.pixelsPerMeter)),Vn(Ae,Ae,ge),tc([],re,Ae)}(l);return S=(g=pT([],f,u))[0],j=g[1],A=g[2],M=(x=u)[0],$=x[1],V=x[2],Y=(W=Math.sqrt(S*S+j*j+A*A)*Math.sqrt(M*M+$*$+V*V))&&$a(g,x)/W,Math.acos(Math.min(Math.max(Y,-1),1));var g,x,S,j,A,M,$,V,W,Y}function ST(l,a){return bD(l,a)>Math.PI/2*1.01}const _D=ae(85),hY=Math.cos(_D),fY=Math.sin(_D),By=63710088e-1,wD=2*Math.PI*By;class xu{constructor(a,u){if(isNaN(a)||isNaN(u))throw new Error(`Invalid LngLat object: (${a}, ${u})`);if(this.lng=+a,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new xu(Re(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const u=Math.PI/180,f=this.lat*u,g=a.lat*u,x=Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos((a.lng-this.lng)*u);return By*Math.acos(Math.min(x,1))}toBounds(a=0){const u=360*a/40075017,f=u/Math.cos(Math.PI/180*this.lat);return new vu(new xu(this.lng-f,this.lat-u),new xu(this.lng+f,this.lat+u))}toEcef(a){const u=Z0(a);return cp(this.lat,this.lng,ll+u)}static convert(a){if(a instanceof xu)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new xu(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new xu(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var rn=xu;function ET(l){return wD*Math.cos(l*Math.PI/180)}function ul(l){return(180+l)/360}function dl(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function Ts(l,a){return l/ET(a)}function ma(l){return 360*l-180}function qi(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function SD(l,a){return l*ET(qi(a))}const Wi=85.051129;function ED(l){return 1/Math.cos(l*Math.PI/180)}class dp{constructor(a,u,f=0){this.x=+a,this.y=+u,this.z=+f}static fromLngLat(a,u=0){const f=rn.convert(a);return new dp(ul(f.lng),dl(f.lat),Ts(u,f.lat))}toLngLat(){return new rn(ma(this.x),qi(this.y))}toAltitude(){return SD(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/wD*ED(qi(this.y))}}function TT(l,a,u,f,g,x,S,j,A){const M=(a+f)/2,$=(u+g)/2,V=new K(M,$);j(V),function(W,Y,J,re,le,ge){const Ae=J-le,ye=re-ge;return Math.abs((re-Y)*Ae-(J-W)*ye)/Math.hypot(Ae,ye)}(V.x,V.y,x.x,x.y,S.x,S.y)>=A?(TT(l,a,u,M,$,x,V,j,A),TT(l,M,$,f,g,V,S,j,A)):l.push(S)}function TD(l,a,u){let f=l[0],g=f.x,x=f.y;a(f);const S=[f];for(let j=1;j<l.length;j++){const A=l[j],{x:M,y:$}=A;a(A),TT(S,g,x,M,$,f,A,a,u),g=M,x=$,f=A}return S}function jT(l,a,u,f){if(f(a,u)){const g=a.add(u)._mult(.5);jT(l,a,g,f),jT(l,g,u,f)}else l.push(u)}function pY(l,a){let u=l[0];const f=[u];for(let g=1;g<l.length;g++){const x=l[g];jT(f,u,x,a),u=x}return f}const CT=Math.pow(2,14)-1,jD=-CT-1;function mY(l,a){const u=Math.round(l.x*a),f=Math.round(l.y*a);return l.x=ve(u,jD,CT),l.y=ve(f,jD,CT),(u<l.x||u>l.x+1||f<l.y||f>l.y+1)&&pt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function rc(l,a,u){const f=l.loadGeometry(),g=l.extent,x=tr/g;if(a&&u&&u.projection.isReprojectedInTileSpace){const S=1<<a.z,{scale:j,x:A,y:M,projection:$}=u,V=W=>{const Y=ma((a.x+W.x/g)/S),J=qi((a.y+W.y/g)/S),re=$.project(Y,J);W.x=(re.x*j-A)*g,W.y=(re.y*j-M)*g};for(let W=0;W<f.length;W++)if(l.type!==1)f[W]=TD(f[W],V,1);else{const Y=[];for(const J of f[W])J.x<0||J.x>=g||J.y<0||J.y>=g||(V(J),Y.push(J));f[W]=Y}}for(const S of f)for(const j of S)mY(j,x);return f}function mh(l,a){return{type:l.type,id:l.id,properties:l.properties,geometry:a?rc(l):[]}}function J0(l,a,u,f,g){l.emplaceBack(2*a+(f+1)/2,2*u+(g+1)/2)}function Q0(l,a,u){l.emplaceBack(a.x,a.y,a.z,u[0]*16384,u[1]*16384,u[2]*16384)}class PT{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.projection=a.projection,this.layoutVertexArray=new bt,this.indexArray=new Zt,this.segments=new Yn,this.programConfigurations=new ch(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,f,g){const x=this.layers[0],S=[];let j=null;x.type==="circle"&&(j=x.layout.get("circle-sort-key"));for(const{feature:M,id:$,index:V,sourceLayerIndex:W}of a){const Y=this.layers[0]._featureFilter.needGeometry,J=mh(M,Y);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),J,f))continue;const re=j?j.evaluate(J,{},f):void 0,le={id:$,properties:M.properties,type:M.type,sourceLayerIndex:W,index:V,geometry:Y?J.geometry:rc(M,f,g),patterns:{},sortKey:re};S.push(le)}j&&S.sort((M,$)=>M.sortKey-$.sortKey);let A=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new wt,A=g.projection);for(const M of S){const{geometry:$,index:V,sourceLayerIndex:W}=M,Y=a[V].feature;this.addFeature(M,$,V,u.availableImages,f,A),u.featureIndex.insert(Y,$,V,W,this.index)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,tY.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,rY.members))),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(a,u,f,g,x,S){for(const j of u)for(const A of j){const M=A.x,$=A.y;if(M<0||M>=tr||$<0||$>=tr)continue;if(S){const Y=S.projectTilePoint(M,$,x),J=S.upVector(x,M,$),re=this.globeExtVertexArray;Q0(re,Y,J),Q0(re,Y,J),Q0(re,Y,J),Q0(re,Y,J)}const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),W=V.vertexLength;J0(this.layoutVertexArray,M,$,-1,-1),J0(this.layoutVertexArray,M,$,1,-1),J0(this.layoutVertexArray,M,$,1,1),J0(this.layoutVertexArray,M,$,-1,1),this.indexArray.emplaceBack(W,W+1,W+2),this.indexArray.emplaceBack(W,W+2,W+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{},g,x)}}function CD(l,a){for(let u=0;u<l.length;u++)if(gh(a,l[u]))return!0;for(let u=0;u<a.length;u++)if(gh(l,a[u]))return!0;return!!AT(l,a)}function gY(l,a,u){return!!gh(l,a)||!!kT(a,l,u)}function PD(l,a){if(l.length===1)return kD(a,l[0]);for(let u=0;u<a.length;u++){const f=a[u];for(let g=0;g<f.length;g++)if(gh(l,f[g]))return!0}for(let u=0;u<l.length;u++)if(kD(a,l[u]))return!0;for(let u=0;u<a.length;u++)if(AT(l,a[u]))return!0;return!1}function yY(l,a,u){if(l.length>1){if(AT(l,a))return!0;for(let f=0;f<a.length;f++)if(kT(a[f],l,u))return!0}for(let f=0;f<l.length;f++)if(kT(l[f],a,u))return!0;return!1}function AT(l,a){if(l.length===0||a.length===0)return!1;for(let u=0;u<l.length-1;u++){const f=l[u],g=l[u+1];for(let x=0;x<a.length-1;x++)if(vY(f,g,a[x],a[x+1]))return!0}return!1}function vY(l,a,u,f){return Wt(l,u,f)!==Wt(a,u,f)&&Wt(l,a,u)!==Wt(l,a,f)}function kT(l,a,u){const f=u*u;if(a.length===1)return l.distSqr(a[0])<f;for(let g=1;g<a.length;g++)if(AD(l,a[g-1],a[g])<f)return!0;return!1}function AD(l,a,u){const f=a.distSqr(u);if(f===0)return l.distSqr(a);const g=((l.x-a.x)*(u.x-a.x)+(l.y-a.y)*(u.y-a.y))/f;return l.distSqr(g<0?a:g>1?u:u.sub(a)._mult(g)._add(a))}function kD(l,a){let u,f,g,x=!1;for(let S=0;S<l.length;S++){u=l[S];for(let j=0,A=u.length-1;j<u.length;A=j++)f=u[j],g=u[A],f.y>a.y!=g.y>a.y&&a.x<(g.x-f.x)*(a.y-f.y)/(g.y-f.y)+f.x&&(x=!x)}return x}function gh(l,a){let u=!1;for(let f=0,g=l.length-1;f<l.length;g=f++){const x=l[f],S=l[g];x.y>a.y!=S.y>a.y&&a.x<(S.x-x.x)*(a.y-x.y)/(S.y-x.y)+x.x&&(u=!u)}return u}function ND(l,a,u,f,g){for(const S of l)if(a<=S.x&&u<=S.y&&f>=S.x&&g>=S.y)return!0;const x=[new K(a,u),new K(a,g),new K(f,g),new K(f,u)];if(l.length>2){for(const S of x)if(gh(l,S))return!0}for(let S=0;S<l.length-1;S++)if(xY(l[S],l[S+1],x))return!0;return!1}function xY(l,a,u){const f=u[0],g=u[2];if(l.x<f.x&&a.x<f.x||l.x>g.x&&a.x>g.x||l.y<f.y&&a.y<f.y||l.y>g.y&&a.y>g.y)return!1;const x=Wt(l,a,u[0]);return x!==Wt(l,a,u[1])||x!==Wt(l,a,u[2])||x!==Wt(l,a,u[3])}function hp(l,a,u){const f=a.paint.get(l).value;return f.kind==="constant"?f.value:u.programConfigurations.get(a.id).getMaxValue(l)}function e_(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function MD(l,a,u,f,g){if(!a[0]&&!a[1])return l;const x=K.convert(a)._mult(g);u==="viewport"&&x._rotate(-f);const S=[];for(let j=0;j<l.length;j++)S.push(l[j].sub(x));return S}function ID(l,a,u,f){const g=K.convert(l)._mult(f);return a==="viewport"&&g._rotate(-u),g}zt(PT,"CircleBucket",{omit:["layers"]});const bY=new we({"circle-sort-key":new ue(at.layout_circle["circle-sort-key"])});var _Y={paint:new we({"circle-radius":new ue(at.paint_circle["circle-radius"]),"circle-color":new ue(at.paint_circle["circle-color"]),"circle-blur":new ue(at.paint_circle["circle-blur"]),"circle-opacity":new ue(at.paint_circle["circle-opacity"]),"circle-translate":new te(at.paint_circle["circle-translate"]),"circle-translate-anchor":new te(at.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new te(at.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new te(at.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ue(at.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ue(at.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ue(at.paint_circle["circle-stroke-opacity"])}),layout:bY};function OD(l,a,u,f,g,x,S,j,A){if(x&&l.queryGeometry.isAboveHorizon)return!1;x&&(A*=l.pixelToTileUnitsFactor);const M=l.tileID.canonical,$=u.projection.upVectorScale(M,u.center.lat,u.worldSize).metersToTile;for(const V of a)for(const W of V){const Y=W.add(j),J=g&&u.elevation?u.elevation.exaggeration()*g.getElevationAt(Y.x,Y.y,!0):0,re=u.projection.projectTilePoint(Y.x,Y.y,M);if(J>0){const ye=u.projection.upVector(M,Y.x,Y.y);re.x+=ye[0]*$*J,re.y+=ye[1]*$*J,re.z+=ye[2]*$*J}const le=x?Y:wY(re.x,re.y,re.z,f),ge=x?l.tilespaceRays.map(ye=>EY(ye,J)):l.queryGeometry.screenGeometry,Ae=hh([],[re.x,re.y,re.z,1],f);if(!S&&x?A*=Ae[3]/u.cameraToCenterDistance:S&&!x&&(A*=u.cameraToCenterDistance/Ae[3]),x){const ye=qi((W.y/tr+M.y)/(1<<M.z));A/=u.projection.pixelsPerMeter(ye,1)/Ts(1,ye)}if(gY(ge,le,A))return!0}return!1}function wY(l,a,u,f){const g=hh([],[l,a,u,1],f);return new K(g[0]/g[3],g[1]/g[3])}const DD=sp(0,0,0),SY=sp(0,0,1);function EY(l,a){const u=fT();return DD[2]=a,l.intersectsPlane(DD,SY,u),new K(u[0],u[1])}class RD extends PT{}function LD(l,{width:a,height:u},f,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==a*u*f)throw new RangeError("mismatched image size")}else g=new Uint8Array(a*u*f);return l.width=a,l.height=u,l.data=g,l}function BD(l,a,u){const{width:f,height:g}=a;f===l.width&&g===l.height||(NT(l,a,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,f),height:Math.min(l.height,g)},u),l.width=f,l.height=g,l.data=a.data)}function NT(l,a,u,f,g,x){if(g.width===0||g.height===0)return a;if(g.width>l.width||g.height>l.height||u.x>l.width-g.width||u.y>l.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>a.width||g.height>a.height||f.x>a.width-g.width||f.y>a.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const S=l.data,j=a.data;for(let A=0;A<g.height;A++){const M=((u.y+A)*l.width+u.x)*x,$=((f.y+A)*a.width+f.x)*x;for(let V=0;V<g.width*x;V++)j[$+V]=S[M+V]}return a}zt(RD,"HeatmapBucket",{omit:["layers"]});class nc{constructor(a,u){LD(this,a,1,u)}resize(a){BD(this,new nc(a),1)}clone(){return new nc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,f,g,x){NT(a,u,f,g,x,1)}}class Xo{constructor(a,u){LD(this,a,4,u)}resize(a){BD(this,new Xo(a),4)}replace(a,u){u?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new Xo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,f,g,x){NT(a,u,f,g,x,4)}}zt(nc,"AlphaImage"),zt(Xo,"RGBAImage");var TY={paint:new we({"heatmap-radius":new ue(at.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ue(at.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new te(at.paint_heatmap["heatmap-intensity"]),"heatmap-color":new be(at.paint_heatmap["heatmap-color"]),"heatmap-opacity":new te(at.paint_heatmap["heatmap-opacity"])})};function MT(l){const a={},u=l.resolution||256,f=l.clips?l.clips.length:1,g=l.image||new Xo({width:u,height:f}),x=(S,j,A)=>{a[l.evaluationKey]=A;const M=l.expression.evaluate(a);g.data[S+j+0]=Math.floor(255*M.r/M.a),g.data[S+j+1]=Math.floor(255*M.g/M.a),g.data[S+j+2]=Math.floor(255*M.b/M.a),g.data[S+j+3]=Math.floor(255*M.a)};if(l.clips)for(let S=0,j=0;S<f;++S,j+=4*u)for(let A=0,M=0;A<u;A++,M+=4){const $=A/(u-1),{start:V,end:W}=l.clips[S];x(j,M,V*(1-$)+W*$)}else for(let S=0,j=0;S<u;S++,j+=4)x(0,j,S/(u-1));return g}var jY={paint:new we({"hillshade-illumination-direction":new te(at.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new te(at.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new te(at.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new te(at.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new te(at.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new te(at.paint_hillshade["hillshade-accent-color"])})};const CY=Ue([{name:"a_pos",components:2,type:"Int16"}],4),{members:PY}=CY;var IT={exports:{}};function t_(l,a,u){u=u||2;var f,g,x,S,j,A,M,$=a&&a.length,V=$?a[0]*u:l.length,W=zD(l,0,V,u,!0),Y=[];if(!W||W.next===W.prev)return Y;if($&&(W=function(re,le,ge,Ae){var ye,Te,Me,Ne=[];for(ye=0,Te=le.length;ye<Te;ye++)(Me=zD(re,le[ye]*Ae,ye<Te-1?le[ye+1]*Ae:re.length,Ae,!1))===Me.next&&(Me.steiner=!0),Ne.push(RY(Me));for(Ne.sort(IY),ye=0;ye<Ne.length;ye++)ge=OY(Ne[ye],ge);return ge}(l,a,W,u)),l.length>80*u){f=x=l[0],g=S=l[1];for(var J=u;J<V;J+=u)(j=l[J])<f&&(f=j),(A=l[J+1])<g&&(g=A),j>x&&(x=j),A>S&&(S=A);M=(M=Math.max(x-f,S-g))!==0?32767/M:0}return zy(W,Y,u,f,g,M,0),Y}function zD(l,a,u,f,g){var x,S;if(g===RT(l,a,u,f)>0)for(x=a;x<u;x+=f)S=UD(x,l[x],l[x+1],S);else for(x=u-f;x>=a;x-=f)S=UD(x,l[x],l[x+1],S);return S&&r_(S,S.next)&&(Fy(S),S=S.next),S}function yh(l,a){if(!l)return l;a||(a=l);var u,f=l;do if(u=!1,f.steiner||!r_(f,f.next)&&Jn(f.prev,f,f.next)!==0)f=f.next;else{if(Fy(f),(f=a=f.prev)===f.next)break;u=!0}while(u||f!==a);return a}function zy(l,a,u,f,g,x,S){if(l){!S&&x&&function($,V,W,Y){var J=$;do J.z===0&&(J.z=OT(J.x,J.y,V,W,Y)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==$);J.prevZ.nextZ=null,J.prevZ=null,function(re){var le,ge,Ae,ye,Te,Me,Ne,Qe,Ke=1;do{for(ge=re,re=null,Te=null,Me=0;ge;){for(Me++,Ae=ge,Ne=0,le=0;le<Ke&&(Ne++,Ae=Ae.nextZ);le++);for(Qe=Ke;Ne>0||Qe>0&&Ae;)Ne!==0&&(Qe===0||!Ae||ge.z<=Ae.z)?(ye=ge,ge=ge.nextZ,Ne--):(ye=Ae,Ae=Ae.nextZ,Qe--),Te?Te.nextZ=ye:re=ye,ye.prevZ=Te,Te=ye;ge=Ae}Te.nextZ=null,Ke*=2}while(Me>1)}(J)}(l,f,g,x);for(var j,A,M=l;l.prev!==l.next;)if(j=l.prev,A=l.next,x?kY(l,f,g,x):AY(l))a.push(j.i/u|0),a.push(l.i/u|0),a.push(A.i/u|0),Fy(l),l=A.next,M=A.next;else if((l=A)===M){S?S===1?zy(l=NY(yh(l),a,u),a,u,f,g,x,2):S===2&&MY(l,a,u,f,g,x):zy(yh(l),a,u,f,g,x,1);break}}}function AY(l){var a=l.prev,u=l,f=l.next;if(Jn(a,u,f)>=0)return!1;for(var g=a.x,x=u.x,S=f.x,j=a.y,A=u.y,M=f.y,$=g<x?g<S?g:S:x<S?x:S,V=j<A?j<M?j:M:A<M?A:M,W=g>x?g>S?g:S:x>S?x:S,Y=j>A?j>M?j:M:A>M?A:M,J=f.next;J!==a;){if(J.x>=$&&J.x<=W&&J.y>=V&&J.y<=Y&&fp(g,j,x,A,S,M,J.x,J.y)&&Jn(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function kY(l,a,u,f){var g=l.prev,x=l,S=l.next;if(Jn(g,x,S)>=0)return!1;for(var j=g.x,A=x.x,M=S.x,$=g.y,V=x.y,W=S.y,Y=j<A?j<M?j:M:A<M?A:M,J=$<V?$<W?$:W:V<W?V:W,re=j>A?j>M?j:M:A>M?A:M,le=$>V?$>W?$:W:V>W?V:W,ge=OT(Y,J,a,u,f),Ae=OT(re,le,a,u,f),ye=l.prevZ,Te=l.nextZ;ye&&ye.z>=ge&&Te&&Te.z<=Ae;){if(ye.x>=Y&&ye.x<=re&&ye.y>=J&&ye.y<=le&&ye!==g&&ye!==S&&fp(j,$,A,V,M,W,ye.x,ye.y)&&Jn(ye.prev,ye,ye.next)>=0||(ye=ye.prevZ,Te.x>=Y&&Te.x<=re&&Te.y>=J&&Te.y<=le&&Te!==g&&Te!==S&&fp(j,$,A,V,M,W,Te.x,Te.y)&&Jn(Te.prev,Te,Te.next)>=0))return!1;Te=Te.nextZ}for(;ye&&ye.z>=ge;){if(ye.x>=Y&&ye.x<=re&&ye.y>=J&&ye.y<=le&&ye!==g&&ye!==S&&fp(j,$,A,V,M,W,ye.x,ye.y)&&Jn(ye.prev,ye,ye.next)>=0)return!1;ye=ye.prevZ}for(;Te&&Te.z<=Ae;){if(Te.x>=Y&&Te.x<=re&&Te.y>=J&&Te.y<=le&&Te!==g&&Te!==S&&fp(j,$,A,V,M,W,Te.x,Te.y)&&Jn(Te.prev,Te,Te.next)>=0)return!1;Te=Te.nextZ}return!0}function NY(l,a,u){var f=l;do{var g=f.prev,x=f.next.next;!r_(g,x)&&$D(g,f,f.next,x)&&$y(g,x)&&$y(x,g)&&(a.push(g.i/u|0),a.push(f.i/u|0),a.push(x.i/u|0),Fy(f),Fy(f.next),f=l=x),f=f.next}while(f!==l);return yh(f)}function MY(l,a,u,f,g,x){var S=l;do{for(var j=S.next.next;j!==S.prev;){if(S.i!==j.i&&LY(S,j)){var A=FD(S,j);return S=yh(S,S.next),A=yh(A,A.next),zy(S,a,u,f,g,x,0),void zy(A,a,u,f,g,x,0)}j=j.next}S=S.next}while(S!==l)}function IY(l,a){return l.x-a.x}function OY(l,a){var u=function(g,x){var S,j=x,A=g.x,M=g.y,$=-1/0;do{if(M<=j.y&&M>=j.next.y&&j.next.y!==j.y){var V=j.x+(M-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(V<=A&&V>$&&($=V,S=j.x<j.next.x?j:j.next,V===A))return S}j=j.next}while(j!==x);if(!S)return null;var W,Y=S,J=S.x,re=S.y,le=1/0;j=S;do A>=j.x&&j.x>=J&&A!==j.x&&fp(M<re?A:$,M,J,re,M<re?$:A,M,j.x,j.y)&&(W=Math.abs(M-j.y)/(A-j.x),$y(j,g)&&(W<le||W===le&&(j.x>S.x||j.x===S.x&&DY(S,j)))&&(S=j,le=W)),j=j.next;while(j!==Y);return S}(l,a);if(!u)return a;var f=FD(u,l);return yh(f,f.next),yh(u,u.next)}function DY(l,a){return Jn(l.prev,l,a.prev)<0&&Jn(a.next,l,l.next)<0}function OT(l,a,u,f,g){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-u)*g|0)|l<<8))|l<<4))|l<<2))|l<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-f)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function RY(l){var a=l,u=l;do(a.x<u.x||a.x===u.x&&a.y<u.y)&&(u=a),a=a.next;while(a!==l);return u}function fp(l,a,u,f,g,x,S,j){return(g-S)*(a-j)>=(l-S)*(x-j)&&(l-S)*(f-j)>=(u-S)*(a-j)&&(u-S)*(x-j)>=(g-S)*(f-j)}function LY(l,a){return l.next.i!==a.i&&l.prev.i!==a.i&&!function(u,f){var g=u;do{if(g.i!==u.i&&g.next.i!==u.i&&g.i!==f.i&&g.next.i!==f.i&&$D(g,g.next,u,f))return!0;g=g.next}while(g!==u);return!1}(l,a)&&($y(l,a)&&$y(a,l)&&function(u,f){var g=u,x=!1,S=(u.x+f.x)/2,j=(u.y+f.y)/2;do g.y>j!=g.next.y>j&&g.next.y!==g.y&&S<(g.next.x-g.x)*(j-g.y)/(g.next.y-g.y)+g.x&&(x=!x),g=g.next;while(g!==u);return x}(l,a)&&(Jn(l.prev,l,a.prev)||Jn(l,a.prev,a))||r_(l,a)&&Jn(l.prev,l,l.next)>0&&Jn(a.prev,a,a.next)>0)}function Jn(l,a,u){return(a.y-l.y)*(u.x-a.x)-(a.x-l.x)*(u.y-a.y)}function r_(l,a){return l.x===a.x&&l.y===a.y}function $D(l,a,u,f){var g=i_(Jn(l,a,u)),x=i_(Jn(l,a,f)),S=i_(Jn(u,f,l)),j=i_(Jn(u,f,a));return g!==x&&S!==j||!(g!==0||!n_(l,u,a))||!(x!==0||!n_(l,f,a))||!(S!==0||!n_(u,l,f))||!(j!==0||!n_(u,a,f))}function n_(l,a,u){return a.x<=Math.max(l.x,u.x)&&a.x>=Math.min(l.x,u.x)&&a.y<=Math.max(l.y,u.y)&&a.y>=Math.min(l.y,u.y)}function i_(l){return l>0?1:l<0?-1:0}function $y(l,a){return Jn(l.prev,l,l.next)<0?Jn(l,a,l.next)>=0&&Jn(l,l.prev,a)>=0:Jn(l,a,l.prev)<0||Jn(l,l.next,a)<0}function FD(l,a){var u=new DT(l.i,l.x,l.y),f=new DT(a.i,a.x,a.y),g=l.next,x=a.prev;return l.next=a,a.prev=l,u.next=g,g.prev=u,f.next=u,u.prev=f,x.next=f,f.prev=x,f}function UD(l,a,u,f){var g=new DT(l,a,u);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function Fy(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function DT(l,a,u){this.i=l,this.x=a,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function RT(l,a,u,f){for(var g=0,x=a,S=u-f;x<u;x+=f)g+=(l[S]-l[x])*(l[x+1]+l[S+1]),S=x;return g}IT.exports=t_,IT.exports.default=t_,t_.deviation=function(l,a,u,f){var g=a&&a.length,x=Math.abs(RT(l,0,g?a[0]*u:l.length,u));if(g)for(var S=0,j=a.length;S<j;S++)x-=Math.abs(RT(l,a[S]*u,S<j-1?a[S+1]*u:l.length,u));var A=0;for(S=0;S<f.length;S+=3){var M=f[S]*u,$=f[S+1]*u,V=f[S+2]*u;A+=Math.abs((l[M]-l[V])*(l[$+1]-l[M+1])-(l[M]-l[$])*(l[V+1]-l[M+1]))}return x===0&&A===0?0:Math.abs((A-x)/x)},t_.flatten=function(l){for(var a=l[0][0].length,u={vertices:[],holes:[],dimensions:a},f=0,g=0;g<l.length;g++){for(var x=0;x<l[g].length;x++)for(var S=0;S<a;S++)u.vertices.push(l[g][x][S]);g>0&&u.holes.push(f+=l[g-1].length)}return u};var LT=R(IT.exports);function BY(l,a,u,f,g){VD(l,a,u||0,f||l.length-1,g||zY)}function VD(l,a,u,f,g){for(;f>u;){if(f-u>600){var x=f-u+1,S=a-u+1,j=Math.log(x),A=.5*Math.exp(2*j/3),M=.5*Math.sqrt(j*A*(x-A)/x)*(S-x/2<0?-1:1);VD(l,a,Math.max(u,Math.floor(a-S*A/x+M)),Math.min(f,Math.floor(a+(x-S)*A/x+M)),g)}var $=l[a],V=u,W=f;for(Uy(l,u,a),g(l[f],$)>0&&Uy(l,u,f);V<W;){for(Uy(l,V,W),V++,W--;g(l[V],$)<0;)V++;for(;g(l[W],$)>0;)W--}g(l[u],$)===0?Uy(l,u,W):Uy(l,++W,f),W<=a&&(u=W+1),a<=W&&(f=W-1)}}function Uy(l,a,u){var f=l[a];l[a]=l[u],l[u]=f}function zY(l,a){return l<a?-1:l>a?1:0}function BT(l,a){const u=l.length;if(u<=1)return[l];const f=[];let g,x;for(let S=0;S<u;S++){const j=cr(l[S]);j!==0&&(l[S].area=Math.abs(j),x===void 0&&(x=j<0),x===j<0?(g&&f.push(g),g=[l[S]]):g.push(l[S]))}if(g&&f.push(g),a>1)for(let S=0;S<f.length;S++)f[S].length<=a||(BY(f[S],a,1,f[S].length-1,$Y),f[S]=f[S].slice(0,a));return f}function $Y(l,a){return a.area-l.area}function zT(l,a,u){const f=u.patternDependencies;let g=!1;for(const x of a){const S=x.paint.get(`${l}-pattern`);S.isConstant()||(g=!0);const j=S.constantOr(null);j&&(g=!0,f[j]=!0)}return g}function $T(l,a,u,f,g){const x=g.patternDependencies;for(const S of a){const j=S.paint.get(`${l}-pattern`).value;if(j.kind!=="constant"){let A=j.evaluate({zoom:f},u,{},g.availableImages);A=A&&A.name?A.name:A,x[A]=!0,u.patterns[S.id]=A}}return u}class o_{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new bt,this.indexArray=new Zt,this.indexArray2=new bi,this.programConfigurations=new ch(a.layers,a.zoom),this.segments=new Yn,this.segments2=new Yn,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.projection=a.projection}populate(a,u,f,g){this.hasPattern=zT("fill",this.layers,u);const x=this.layers[0].layout.get("fill-sort-key"),S=[];for(const{feature:j,id:A,index:M,sourceLayerIndex:$}of a){const V=this.layers[0]._featureFilter.needGeometry,W=mh(j,V);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),W,f))continue;const Y=x?x.evaluate(W,{},f,u.availableImages):void 0,J={id:A,properties:j.properties,type:j.type,sourceLayerIndex:$,index:M,geometry:V?W.geometry:rc(j,f,g),patterns:{},sortKey:Y};S.push(J)}x&&S.sort((j,A)=>j.sortKey-A.sortKey);for(const j of S){const{geometry:A,index:M,sourceLayerIndex:$}=j;if(this.hasPattern){const V=$T("fill",this.layers,j,this.zoom,u);this.patternFeatures.push(V)}else this.addFeature(j,A,M,f,{},u.availableImages);u.featureIndex.insert(a[M].feature,A,M,$,this.index)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}addFeatures(a,u,f,g,x){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,u,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,PY),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,u,f,g,x,S=[]){for(const j of BT(u,500)){let A=0;for(const J of j)A+=J.length;const M=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),$=M.vertexLength,V=[],W=[];for(const J of j){if(J.length===0)continue;J!==j[0]&&W.push(V.length/2);const re=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),le=re.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(le+J.length-1,le),V.push(J[0].x),V.push(J[0].y);for(let ge=1;ge<J.length;ge++)this.layoutVertexArray.emplaceBack(J[ge].x,J[ge].y),this.indexArray2.emplaceBack(le+ge-1,le+ge),V.push(J[ge].x),V.push(J[ge].y);re.vertexLength+=J.length,re.primitiveLength+=J.length}const Y=LT(V,W);for(let J=0;J<Y.length;J+=3)this.indexArray.emplaceBack($+Y[J],$+Y[J+1],$+Y[J+2]);M.vertexLength+=A,M.primitiveLength+=Y.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,x,S,g)}}zt(o_,"FillBucket",{omit:["layers","patternFeatures"]});const FY=new we({"fill-sort-key":new ue(at.layout_fill["fill-sort-key"])});var UY={paint:new we({"fill-antialias":new te(at.paint_fill["fill-antialias"]),"fill-opacity":new ue(at.paint_fill["fill-opacity"]),"fill-color":new ue(at.paint_fill["fill-color"]),"fill-outline-color":new ue(at.paint_fill["fill-outline-color"]),"fill-translate":new te(at.paint_fill["fill-translate"]),"fill-translate-anchor":new te(at.paint_fill["fill-translate-anchor"]),"fill-pattern":new ue(at.paint_fill["fill-pattern"])}),layout:FY};const VY=Ue([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),qY=Ue([{name:"a_centroid_pos",components:2,type:"Uint16"}]),WY=Ue([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:GY}=VY;var a_={},HY=G,qD=pp;function pp(l,a,u,f,g){this.properties={},this.extent=u,this.type=0,this._pbf=l,this._geometry=-1,this._keys=f,this._values=g,l.readFields(XY,this,a)}function XY(l,a,u){l==1?a.id=u.readVarint():l==2?function(f,g){for(var x=f.readVarint()+f.pos;f.pos<x;){var S=g._keys[f.readVarint()],j=g._values[f.readVarint()];g.properties[S]=j}}(u,a):l==3?a.type=u.readVarint():l==4&&(a._geometry=u.pos)}function ZY(l){for(var a,u,f=0,g=0,x=l.length,S=x-1;g<x;S=g++)f+=((u=l[S]).x-(a=l[g]).x)*(a.y+u.y);return f}pp.types=["Unknown","Point","LineString","Polygon"],pp.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var a,u=l.readVarint()+l.pos,f=1,g=0,x=0,S=0,j=[];l.pos<u;){if(g<=0){var A=l.readVarint();f=7&A,g=A>>3}if(g--,f===1||f===2)x+=l.readSVarint(),S+=l.readSVarint(),f===1&&(a&&j.push(a),a=[]),a.push(new HY(x,S));else{if(f!==7)throw new Error("unknown command "+f);a&&a.push(a[0].clone())}}return a&&j.push(a),j},pp.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var a=l.readVarint()+l.pos,u=1,f=0,g=0,x=0,S=1/0,j=-1/0,A=1/0,M=-1/0;l.pos<a;){if(f<=0){var $=l.readVarint();u=7&$,f=$>>3}if(f--,u===1||u===2)(g+=l.readSVarint())<S&&(S=g),g>j&&(j=g),(x+=l.readSVarint())<A&&(A=x),x>M&&(M=x);else if(u!==7)throw new Error("unknown command "+u)}return[S,A,j,M]},pp.prototype.toGeoJSON=function(l,a,u){var f,g,x=this.extent*Math.pow(2,u),S=this.extent*l,j=this.extent*a,A=this.loadGeometry(),M=pp.types[this.type];function $(Y){for(var J=0;J<Y.length;J++){var re=Y[J];Y[J]=[360*(re.x+S)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(re.y+j)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(f=0;f<A.length;f++)V[f]=A[f][0];$(A=V);break;case 2:for(f=0;f<A.length;f++)$(A[f]);break;case 3:for(A=function(Y){var J=Y.length;if(J<=1)return[Y];for(var re,le,ge=[],Ae=0;Ae<J;Ae++){var ye=ZY(Y[Ae]);ye!==0&&(le===void 0&&(le=ye<0),le===ye<0?(re&&ge.push(re),re=[Y[Ae]]):re.push(Y[Ae]))}return re&&ge.push(re),ge}(A),f=0;f<A.length;f++)for(g=0;g<A[f].length;g++)$(A[f][g])}A.length===1?A=A[0]:M="Multi"+M;var W={type:"Feature",geometry:{type:M,coordinates:A},properties:this.properties};return"id"in this&&(W.id=this.id),W};var KY=qD,WD=GD;function GD(l,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(YY,this,a),this.length=this._features.length}function YY(l,a,u){l===15?a.version=u.readVarint():l===1?a.name=u.readString():l===5?a.extent=u.readVarint():l===2?a._features.push(u.pos):l===3?a._keys.push(u.readString()):l===4&&a._values.push(function(f){for(var g=null,x=f.readVarint()+f.pos;f.pos<x;){var S=f.readVarint()>>3;g=S===1?f.readString():S===2?f.readFloat():S===3?f.readDouble():S===4?f.readVarint64():S===5?f.readVarint():S===6?f.readSVarint():S===7?f.readBoolean():null}return g}(u))}GD.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var a=this._pbf.readVarint()+this._pbf.pos;return new KY(this._pbf,a,this.extent,this._keys,this._values)};var JY=WD;function QY(l,a,u){if(l===3){var f=new JY(u,u.readVarint()+u.pos);f.length&&(a[f.name]=f)}}var FT=a_.VectorTile=function(l,a){this.layers=l.readFields(QY,{},a)},s_=a_.VectorTileFeature=qD;function l_(l,a,u,f){const g=[],x=f===0?(S,j,A,M,$,V)=>{S.push(new K(V,A+(V-j)/(M-j)*($-A)))}:(S,j,A,M,$,V)=>{S.push(new K(j+(V-A)/($-A)*(M-j),V))};for(const S of l){const j=[];for(const A of S){if(A.length<=2)continue;const M=[];for(let W=0;W<A.length-1;W++){const Y=A[W].x,J=A[W].y,re=A[W+1].x,le=A[W+1].y,ge=f===0?Y:J,Ae=f===0?re:le;ge<a?Ae>a&&x(M,Y,J,re,le,a):ge>u?Ae<u&&x(M,Y,J,re,le,u):M.push(A[W]),Ae<a&&ge>=a&&x(M,Y,J,re,le,a),Ae>u&&ge<=u&&x(M,Y,J,re,le,u)}let $=A[A.length-1];const V=f===0?$.x:$.y;V>=a&&V<=u&&M.push($),M.length&&($=M[M.length-1],M[0].x===$.x&&M[0].y===$.y||M.push(M[0]),j.push(M))}j.length&&g.push(j)}return g}a_.VectorTileLayer=WD;const eJ=s_.types,tJ=Math.pow(2,13);function Vy(l,a,u,f,g,x,S,j){l.emplaceBack((a<<1)+S,(u<<1)+x,(Math.floor(f*tJ)<<1)+g,Math.round(j))}function qy(l,a,u){l.emplaceBack(a.x,a.y,a.z,u[0]*16384,u[1]*16384,u[2]*16384)}class HD{constructor(){this.acc=new K(0,0),this.polyCount=[]}startRing(a){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new K(a.x,a.y),this.max=new K(a.x,a.y))}append(a,u){this.currentPolyCount.edges++,this.acc._add(a);const f=this.min,g=this.max;a.x<f.x?f.x=a.x:a.x>g.x&&(g.x=a.x),a.y<f.y?f.y=a.y:a.y>g.y&&(g.y=a.y),((a.x===0||a.x===tr)&&a.x===u.x)!=((a.y===0||a.y===tr)&&a.y===u.y)&&this.processBorderOverlap(a,u),u.x<0!=a.x<0&&this.addBorderIntersection(0,kr(u.y,a.y,(0-u.x)/(a.x-u.x))),u.x>tr!=a.x>tr&&this.addBorderIntersection(1,kr(u.y,a.y,(tr-u.x)/(a.x-u.x))),u.y<0!=a.y<0&&this.addBorderIntersection(2,kr(u.x,a.x,(0-u.y)/(a.y-u.y))),u.y>tr!=a.y>tr&&this.addBorderIntersection(3,kr(u.x,a.x,(tr-u.y)/(a.y-u.y)))}addBorderIntersection(a,u){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[a];u<f[0]&&(f[0]=u),u>f[1]&&(f[1]=u)}processBorderOverlap(a,u){if(a.x===u.x){if(a.y===u.y)return;const f=a.x===0?0:1;this.addBorderIntersection(f,u.y),this.addBorderIntersection(f,a.y)}else{const f=a.y===0?2:3;this.addBorderIntersection(f,u.x),this.addBorderIntersection(f,a.x)}}centroid(){const a=this.polyCount.reduce((u,f)=>u+f.edges,0);return a!==0?this.acc.div(a)._round():new K(0,0)}span(){return new K(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((a,u)=>a+ +(u[0]!==Number.MAX_VALUE),0)}}class Wy{constructor(a){this.zoom=a.zoom,this.canonical=a.canonical,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=a.projection,this.layoutVertexArray=new ut,this.centroidVertexArray=new bs,this.indexArray=new Zt,this.programConfigurations=new ch(a.layers,a.zoom),this.segments=new Yn,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.enableTerrain=a.enableTerrain}populate(a,u,f,g){this.features=[],this.hasPattern=zT("fill-extrusion",this.layers,u),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(x){const S=Math.exp(Math.PI*(1-x.y/(1<<x.z)*2));return 80150034*S/(S*S+1)/tr/(1<<x.z)}(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:x,id:S,index:j,sourceLayerIndex:A}of a){const M=this.layers[0]._featureFilter.needGeometry,$=mh(x,M);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),$,f))continue;const V={id:S,sourceLayerIndex:A,index:j,geometry:M?$.geometry:rc(x,f,g),properties:x.properties,type:x.type,patterns:{}},W=this.layoutVertexArray.length;this.hasPattern?this.features.push($T("fill-extrusion",this.layers,V,this.zoom,u)):this.addFeature(V,V.geometry,j,f,{},u.availableImages,g),u.featureIndex.insert(x,V.geometry,j,A,this.index,W)}this.sortBorders()}addFeatures(a,u,f,g,x){for(const S of this.features){const{geometry:j}=S;this.addFeature(S,j,S.index,u,f,g,x)}this.sortBorders()}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,GY),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=a.createVertexBuffer(this.layoutVertexExtArray,WY.members,!0))),this.programConfigurations.upload(a),this.uploaded=!0}uploadCentroid(a){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,qY.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,u,f,g,x,S,j){const A=[new K(0,0),new K(tr,tr)],M=j.projection,$=M.name==="globe",V=this.enableTerrain&&!$?new HD:null,W=eJ[a.type]==="Polygon";$&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new wt);const Y=BT(u,500);for(let ge=Y.length-1;ge>=0;ge--){const Ae=Y[ge];(Ae.length===0||(J=Ae[0]).every(ye=>ye.x<=0)||J.every(ye=>ye.x>=tr)||J.every(ye=>ye.y<=0)||J.every(ye=>ye.y>=tr))&&Y.splice(ge,1)}var J;let re;if($)re=eR(Y,A,g);else{re=[];for(const ge of Y)re.push({polygon:ge,bounds:A})}const le=W?this.edgeRadius:0;for(const{polygon:ge,bounds:Ae}of re){let ye=0,Te=0;for(const Ne of ge)W&&!Ne[0].equals(Ne[Ne.length-1])&&Ne.push(Ne[0]),Te+=W?Ne.length-1:Ne.length;const Me=this.segments.prepareSegment((W?5:4)*Te,this.layoutVertexArray,this.indexArray);if(W){const Ne=[],Qe=[];ye=Me.vertexLength;for(const st of ge){let _t,tt;st.length&&st!==ge[0]&&Qe.push(Ne.length/2),_t=st[1].sub(st[0])._perp()._unit();for(let dt=1;dt<st.length;dt++){const ht=st[dt],yt=st[dt===st.length-1?1:dt+1];let{x:jt,y:ot}=ht;if(le){tt=yt.sub(ht)._perp()._unit();const Ot=_t.add(tt)._unit(),Vt=le*Math.min(4,1/(_t.x*Ot.x+_t.y*Ot.y));jt+=Vt*Ot.x,ot+=Vt*Ot.y,_t=tt}Vy(this.layoutVertexArray,jt,ot,0,0,1,1,0),Me.vertexLength++,Ne.push(ht.x,ht.y),$&&qy(this.layoutVertexExtArray,M.projectTilePoint(jt,ot,g),M.upVector(g,jt,ot))}}const Ke=LT(Ne,Qe);for(let st=0;st<Ke.length;st+=3)this.indexArray.emplaceBack(ye+Ke[st],ye+Ke[st+2],ye+Ke[st+1]),Me.primitiveLength++}for(const Ne of ge){V&&Ne.length&&V.startRing(Ne[0]);let Qe,Ke,st,_t=Ne.length>4&&YD(Ne[Ne.length-2],Ne[0],Ne[1]),tt=le?rJ(Ne[Ne.length-2],Ne[0],Ne[1],le):0;Ke=Ne[1].sub(Ne[0])._perp()._unit();let dt=!0;for(let ht=1,yt=0;ht<Ne.length;ht++){let jt=Ne[ht-1],ot=Ne[ht];const Ot=Ne[ht===Ne.length-1?1:ht+1];if(V&&W&&V.currentPolyCount.top++,KD(ot,jt,Ae)){le&&(Ke=Ot.sub(ot)._perp()._unit(),dt=!dt);continue}V&&V.append(ot,jt);const Vt=ot.sub(jt)._perp(),Dt=Vt.x/(Math.abs(Vt.x)+Math.abs(Vt.y)),ur=Vt.y>0?1:0,Ct=jt.dist(ot);if(yt+Ct>32768&&(yt=0),le){st=Ot.sub(ot)._perp()._unit();let hr=ZD(jt,ot,Ot,XD(Ke,st),le);isNaN(hr)&&(hr=0);const or=ot.sub(jt)._unit();jt=jt.add(or.mult(tt))._round(),ot=ot.add(or.mult(-hr))._round(),tt=hr,Ke=st}const Yt=Me.vertexLength,dr=Ne.length>4&&YD(jt,ot,Ot);let Or=JD(yt,_t,dt);if(Vy(this.layoutVertexArray,jt.x,jt.y,Dt,ur,0,0,Or),Vy(this.layoutVertexArray,jt.x,jt.y,Dt,ur,0,1,Or),yt+=Ct,Or=JD(yt,dr,!dt),_t=dr,Vy(this.layoutVertexArray,ot.x,ot.y,Dt,ur,0,0,Or),Vy(this.layoutVertexArray,ot.x,ot.y,Dt,ur,0,1,Or),Me.vertexLength+=4,this.indexArray.emplaceBack(Yt+0,Yt+1,Yt+2),this.indexArray.emplaceBack(Yt+1,Yt+3,Yt+2),Me.primitiveLength+=2,le){const hr=ye+(ht===1?Ne.length-2:ht-2),or=ht===1?ye:hr+1;if(this.indexArray.emplaceBack(Yt+1,hr,Yt+3),this.indexArray.emplaceBack(hr,or,Yt+3),Me.primitiveLength+=2,Qe===void 0&&(Qe=Yt),!KD(Ot,Ne[ht],Ae)){const pn=ht===Ne.length-1?Qe:Me.vertexLength;this.indexArray.emplaceBack(Yt+2,Yt+3,pn),this.indexArray.emplaceBack(Yt+3,pn+1,pn),this.indexArray.emplaceBack(Yt+3,or,pn+1),Me.primitiveLength+=3}dt=!dt}if($){const hr=this.layoutVertexExtArray,or=M.projectTilePoint(jt.x,jt.y,g),pn=M.projectTilePoint(ot.x,ot.y,g),gr=M.upVector(g,jt.x,jt.y),yr=M.upVector(g,ot.x,ot.y);qy(hr,or,gr),qy(hr,or,gr),qy(hr,pn,yr),qy(hr,pn,yr)}}W&&(ye+=Ne.length-1)}}if(V&&V.polyCount.length>0){if(V.borders){V.vertexArrayOffset=this.centroidVertexArray.length;const ge=V.borders,Ae=this.featuresOnBorder.push(V)-1;for(let ye=0;ye<4;ye++)ge[ye][0]!==Number.MAX_VALUE&&this.borders[ye].push(Ae)}this.encodeCentroid(V.borders?void 0:V.centroid(),V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,x,S,g)}sortBorders(){for(let a=0;a<4;a++)this.borders[a].sort((u,f)=>this.featuresOnBorder[u].borders[a][0]-this.featuresOnBorder[f].borders[a][0])}encodeCentroid(a,u,f=!0){let g,x;if(a)if(a.y!==0){const j=u.span()._mult(this.tileToMeter);g=(Math.max(a.x,1)<<3)+Math.min(7,Math.round(j.x/10)),x=(Math.max(a.y,1)<<3)+Math.min(7,Math.round(j.y/10))}else g=Math.ceil(7*(a.x+450)),x=0;else g=0,x=+f;let S=f?this.centroidVertexArray.length:u.vertexArrayOffset;for(const j of u.polyCount){f&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*j.edges+j.top);for(let A=0;A<j.top;A++)this.centroidVertexArray.emplace(S++,g,x);for(let A=0;A<2*j.edges;A++)this.centroidVertexArray.emplace(S++,0,x),this.centroidVertexArray.emplace(S++,g,x)}}}function XD(l,a){const u=l.add(a)._unit();return l.x*u.x+l.y*u.y}function rJ(l,a,u,f){const g=a.sub(l)._perp()._unit(),x=u.sub(a)._perp()._unit();return ZD(l,a,u,XD(g,x),f)}function ZD(l,a,u,f,g){const x=Math.sqrt(1-f*f);return Math.min(l.dist(a)/3,a.dist(u)/3,g*x/f)}function KD(l,a,u){return l.x<u[0].x&&a.x<u[0].x||l.x>u[1].x&&a.x>u[1].x||l.y<u[0].y&&a.y<u[0].y||l.y>u[1].y&&a.y>u[1].y}function YD(l,a,u){if(l.x<0||l.x>=tr||a.x<0||a.x>=tr||u.x<0||u.x>=tr)return!1;const f=u.sub(a),g=f.perp(),x=l.sub(a);return(f.x*x.x+f.y*x.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(x.x*x.x+x.y*x.y))>-.866&&g.x*x.x+g.y*x.y<0}function JD(l,a,u){const f=a?2|l:-3&l;return u?1|f:-2&f}function QD(){const l=Math.PI/32,a=Math.tan(l),u=By;return u*Math.sqrt(1+2*a*a)-u}function eR(l,a,u){const f=1<<u.z,g=ma(u.x/f),x=ma((u.x+1)/f),S=qi(u.y/f),j=qi((u.y+1)/f);return function(A,M,$,V,W=0,Y){const J=[];if(!A.length||!$||!V)return J;const re=(Ne,Qe)=>{for(const Ke of Ne)J.push({polygon:Ke,bounds:Qe})},le=Math.ceil(Math.log2($)),ge=Math.ceil(Math.log2(V)),Ae=le-ge,ye=[];for(let Ne=0;Ne<Math.abs(Ae);Ne++)ye.push(Ae>0?0:1);for(let Ne=0;Ne<Math.min(le,ge);Ne++)ye.push(0),ye.push(1);let Te=A;if(Te=l_(Te,M[0].y-W,M[1].y+W,1),Te=l_(Te,M[0].x-W,M[1].x+W,0),!Te.length)return J;const Me=[];for(ye.length?Me.push({polygons:Te,bounds:M,depth:0}):re(Te,M);Me.length;){const Ne=Me.pop(),Qe=Ne.depth,Ke=ye[Qe],st=Ne.bounds[0],_t=Ne.bounds[1],tt=Ke===0?st.x:st.y,dt=Ke===0?_t.x:_t.y,ht=Y?Y(Ke,tt,dt):.5*(tt+dt),yt=l_(Ne.polygons,tt-W,ht+W,Ke),jt=l_(Ne.polygons,ht-W,dt+W,Ke);if(yt.length){const ot=[st,new K(Ke===0?ht:_t.x,Ke===1?ht:_t.y)];ye.length>Qe+1?Me.push({polygons:yt,bounds:ot,depth:Qe+1}):re(yt,ot)}if(jt.length){const ot=[new K(Ke===0?ht:st.x,Ke===1?ht:st.y),_t];ye.length>Qe+1?Me.push({polygons:jt,bounds:ot,depth:Qe+1}):re(jt,ot)}}return J}(l,a,Math.ceil((x-g)/11.25),Math.ceil((S-j)/11.25),1,(A,M,$)=>{if(A===0)return .5*(M+$);{const V=qi((u.y+M/tr)/f);return(dl(.5*(qi((u.y+$/tr)/f)+V))*f-u.y)*tr}})}zt(Wy,"FillExtrusionBucket",{omit:["layers","features"]}),zt(HD,"PartMetadata");const nJ=new we({"fill-extrusion-edge-radius":new te(at["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var iJ={paint:new we({"fill-extrusion-opacity":new te(at["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ue(at["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new te(at["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new te(at["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ue(at["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ue(at["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ue(at["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new te(at["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new te(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new te(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new te(at["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:nJ};function tR(l,a,u){var f=2*Math.PI*6378137/256/Math.pow(2,u);return[l*f-2*Math.PI*6378137/2,a*f-2*Math.PI*6378137/2]}class c_{constructor(a,u,f){this.z=a,this.x=u,this.y=f,this.key=Gy(0,a,a,u,f)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,u){const f=function(x,S,j){var A=tR(256*x,256*(S=Math.pow(2,j)-S-1),j),M=tR(256*(x+1),256*(S+1),j);return A[0]+","+A[1]+","+M[0]+","+M[1]}(this.x,this.y,this.z),g=function(x,S,j){let A,M="";for(let $=x;$>0;$--)A=1<<$-1,M+=(S&A?1:0)+(j&A?2:0);return M}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class rR{constructor(a,u){this.wrap=a,this.canonical=u,this.key=Gy(a,u.z,u.z,u.x,u.y)}}class mo{constructor(a,u,f,g,x){this.overscaledZ=a,this.wrap=u,this.canonical=new c_(f,+g,+x),this.key=u===0&&a===f?this.canonical.key:Gy(u,a,f,g,x)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){const u=this.canonical.z-a;return a>this.canonical.z?new mo(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new mo(a,this.wrap,a,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(a,u=!0){if(this.overscaledZ===a&&u)return this.key;if(a>this.canonical.z)return Gy(this.wrap*+u,a,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-a;return Gy(this.wrap*+u,a,a,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(a){if(a.wrap!==this.wrap)return!1;const u=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>u&&a.canonical.y===this.canonical.y>>u}children(a){if(this.overscaledZ>=a)return[new mo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,g=2*this.canonical.y;return[new mo(u,this.wrap,u,f,g),new mo(u,this.wrap,u,f+1,g),new mo(u,this.wrap,u,f,g+1),new mo(u,this.wrap,u,f+1,g+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new mo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new mo(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new rR(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Gy(l,a,u,f,g){const x=1<<Math.min(u,22);let S=x*(g%x)+f%x;return l&&u<22&&(S+=x*x*((l<0?-2*l-1:2*l)%(1<<2*(22-u)))),16*(32*S+u)+(a-u)}zt(c_,"CanonicalTileID"),zt(mo,"OverscaledTileID",{omit:["projMatrix"]});class mp extends K{constructor(a,u,f){super(a,u),this.z=f}}function Hy(l,a){return l.x*a.x+l.y*a.y}function nR(l,a){if(l.length===1){let u=0;const f=a[u++];let g;for(;!g||f.equals(g);)if(g=a[u++],!g)return 1/0;for(;u<a.length;u++){const x=a[u],S=l[0],j=g.sub(f),A=x.sub(f),M=S.sub(f),$=Hy(j,j),V=Hy(j,A),W=Hy(A,A),Y=Hy(M,j),J=Hy(M,A),re=$*W-V*V,le=(W*Y-V*J)/re,ge=($*J-V*Y)/re,Ae=f.z*(1-le-ge)+g.z*le+x.z*ge;if(isFinite(Ae))return Ae}return 1/0}{let u=1/0;for(const f of a)u=Math.min(u,f.z);return u}}function iR(l,a,u,f,g,x,S,j){const A=S*g.getElevationAt(l,a,!0,!0),M=x[0]!==0,$=M?x[1]===0?S*(x[0]/7-450):S*function(V,W,Y){const J=Math.floor(W[0]/8),re=Math.floor(W[1]/8),le=10*(W[0]-8*J),ge=10*(W[1]-8*re),Ae=V.getElevationAt(J,re,!0,!0),ye=V.getMeterToDEM(Y),Te=Math.floor(.5*(le*ye-1)),Me=Math.floor(.5*(ge*ye-1)),Ne=V.tileCoordToPixel(J,re),Qe=2*Te+1,Ke=2*Me+1,st=function(jt,ot,Ot,Vt,Dt){return[jt.getElevationAtPixel(ot,Ot,!0),jt.getElevationAtPixel(ot+Dt,Ot,!0),jt.getElevationAtPixel(ot,Ot+Dt,!0),jt.getElevationAtPixel(ot+Vt,Ot+Dt,!0)]}(V,Ne.x-Te,Ne.y-Me,Qe,Ke),_t=Math.abs(st[0]-st[1]),tt=Math.abs(st[2]-st[3]),dt=Math.abs(st[0]-st[2])+Math.abs(st[1]-st[3]),ht=Math.min(.25,.5*ye*(_t+tt)/Qe),yt=Math.min(.25,.5*ye*dt/Ke);return Ae+Math.max(ht*le,yt*ge)}(g,x,j):A;return{base:A+(u===0)?-1:u,top:M?Math.max($+f,A+u+2):A+f}}const oJ=Ue([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:aJ}=oJ,sJ=Ue([{name:"a_packed",components:4,type:"Float32"}]),{members:lJ}=sJ,cJ=s_.types,uJ=Math.cos(Math.PI/180*37.5);class u_{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.projection=a.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new et,this.layoutVertexArray2=new xt,this.indexArray=new Zt,this.programConfigurations=new ch(a.layers,a.zoom),this.segments=new Yn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,f,g){this.hasPattern=zT("line",this.layers,u);const x=this.layers[0].layout.get("line-sort-key"),S=[];for(const{feature:$,id:V,index:W,sourceLayerIndex:Y}of a){const J=this.layers[0]._featureFilter.needGeometry,re=mh($,J);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),re,f))continue;const le=x?x.evaluate(re,{},f):void 0,ge={id:V,properties:$.properties,type:$.type,sourceLayerIndex:Y,index:W,geometry:J?re.geometry:rc($,f,g),patterns:{},sortKey:le};S.push(ge)}x&&S.sort(($,V)=>$.sortKey-V.sortKey);const{lineAtlas:j,featureIndex:A}=u,M=this.addConstantDashes(j);for(const $ of S){const{geometry:V,index:W,sourceLayerIndex:Y}=$;if(M&&this.addFeatureDashes($,j),this.hasPattern){const J=$T("line",this.layers,$,this.zoom,u);this.patternFeatures.push(J)}else this.addFeature($,V,W,f,j.positions,u.availableImages);A.insert(a[W].feature,V,W,Y,this.index)}}addConstantDashes(a){let u=!1;for(const f of this.layers){const g=f.paint.get("line-dasharray").value,x=f.layout.get("line-cap").value;if(g.kind!=="constant"||x.kind!=="constant")u=!0;else{const S=x.value,j=g.value;if(!j)continue;a.addDash(j,S)}}return u}addFeatureDashes(a,u){const f=this.zoom;for(const g of this.layers){const x=g.paint.get("line-dasharray").value,S=g.layout.get("line-cap").value;if(x.kind==="constant"&&S.kind==="constant")continue;let j,A;if(x.kind==="constant"){if(j=x.value,!j)continue}else j=x.evaluate({zoom:f},a);A=S.kind==="constant"?S.value:S.evaluate({zoom:f},a),u.addDash(j,A),a.patterns[g.id]=u.getKey(j,A)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}addFeatures(a,u,f,g,x){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,u,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,lJ)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,aJ),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,u,f,g,x,S){const j=this.layers[0].layout,A=j.get("line-join").evaluate(a,{}),M=j.get("line-cap").evaluate(a,{}),$=j.get("line-miter-limit"),V=j.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const W of u)this.addLine(W,a,A,M,$,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,x,S,g)}addLine(a,u,f,g,x,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<a.length-1;ge++)this.totalDistance+=a[ge].dist(a[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=cJ[u.type]==="Polygon";let A=a.length;for(;A>=2&&a[A-1].equals(a[A-2]);)A--;let M=0;for(;M<A-1&&a[M].equals(a[M+1]);)M++;if(A<(j?3:2))return;f==="bevel"&&(x=1.05);const $=this.overscaling<=16?15*tr/(512*this.overscaling):0,V=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let W,Y,J,re,le;this.e1=this.e2=-1,j&&(W=a[A-2],le=a[M].sub(W)._unit()._perp());for(let ge=M;ge<A;ge++){if(J=ge===A-1?j?a[M+1]:void 0:a[ge+1],J&&a[ge].equals(J))continue;le&&(re=le),W&&(Y=W),W=a[ge],le=J?J.sub(W)._unit()._perp():re,re=re||le;let Ae=re.add(le);Ae.x===0&&Ae.y===0||Ae._unit();const ye=re.x*le.x+re.y*le.y,Te=Ae.x*le.x+Ae.y*le.y,Me=Te!==0?1/Te:1/0,Ne=2*Math.sqrt(2-2*Te),Qe=Te<uJ&&Y&&J,Ke=re.x*le.y-re.y*le.x>0;if(Qe&&ge>M){const tt=W.dist(Y);if(tt>2*$){const dt=W.sub(W.sub(Y)._mult($/tt)._round());this.updateDistance(Y,dt),this.addCurrentVertex(dt,re,0,0,V),Y=dt}}const st=Y&&J;let _t=st?f:j?"butt":g;if(st&&_t==="round"&&(Me<S?_t="miter":Me<=2&&(_t="fakeround")),_t==="miter"&&Me>x&&(_t="bevel"),_t==="bevel"&&(Me>2&&(_t="flipbevel"),Me<x&&(_t="miter")),Y&&this.updateDistance(Y,W),_t==="miter")Ae._mult(Me),this.addCurrentVertex(W,Ae,0,0,V);else if(_t==="flipbevel"){if(Me>100)Ae=le.mult(-1);else{const tt=Me*re.add(le).mag()/re.sub(le).mag();Ae._perp()._mult(tt*(Ke?-1:1))}this.addCurrentVertex(W,Ae,0,0,V),this.addCurrentVertex(W,Ae.mult(-1),0,0,V)}else if(_t==="bevel"||_t==="fakeround"){const tt=-Math.sqrt(Me*Me-1),dt=Ke?tt:0,ht=Ke?0:tt;if(Y&&this.addCurrentVertex(W,re,dt,ht,V),_t==="fakeround"){const yt=Math.round(180*Ne/Math.PI/20);for(let jt=1;jt<yt;jt++){let ot=jt/yt;if(ot!==.5){const Vt=ot-.5;ot+=ot*Vt*(ot-1)*((1.0904+ye*(ye*(3.55645-1.43519*ye)-3.2452))*Vt*Vt+(.848013+ye*(.215638*ye-1.06021)))}const Ot=le.sub(re)._mult(ot)._add(re)._unit()._mult(Ke?-1:1);this.addHalfVertex(W,Ot.x,Ot.y,!1,Ke,0,V)}}J&&this.addCurrentVertex(W,le,-dt,-ht,V)}else if(_t==="butt")this.addCurrentVertex(W,Ae,0,0,V);else if(_t==="square"){const tt=Y?1:-1;Y||this.addCurrentVertex(W,Ae,tt,tt,V),this.addCurrentVertex(W,Ae,0,0,V),Y&&this.addCurrentVertex(W,Ae,tt,tt,V)}else _t==="round"&&(Y&&(this.addCurrentVertex(W,re,0,0,V),this.addCurrentVertex(W,re,1,1,V,!0)),J&&(this.addCurrentVertex(W,le,-1,-1,V,!0),this.addCurrentVertex(W,le,0,0,V)));if(Qe&&ge<A-1){const tt=W.dist(J);if(tt>2*$){const dt=W.add(J.sub(W)._mult($/tt)._round());this.updateDistance(W,dt),this.addCurrentVertex(dt,le,0,0,V),W=dt}}}}addCurrentVertex(a,u,f,g,x,S=!1){const j=u.y*g-u.x,A=-u.y-u.x*g;this.addHalfVertex(a,u.x+u.y*f,u.y-u.x*f,S,!1,f,x),this.addHalfVertex(a,j,A,S,!0,-g,x)}addHalfVertex({x:a,y:u},f,g,x,S,j,A){this.layoutVertexArray.emplaceBack((a<<1)+(x?1:0),(u<<1)+(S?1:0),Math.round(63*f)+128,Math.round(63*g)+128,1+(j===0?0:j<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const M=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),A.primitiveLength++),S?this.e2=M:this.e1=M}updateScaledDistance(){if(this.lineClips){const a=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=a*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(a,u){this.distance+=a.dist(u),this.updateScaledDistance()}}zt(u_,"LineBucket",{omit:["layers","patternFeatures"]});const dJ=new we({"line-cap":new ue(at.layout_line["line-cap"]),"line-join":new ue(at.layout_line["line-join"]),"line-miter-limit":new te(at.layout_line["line-miter-limit"]),"line-round-limit":new te(at.layout_line["line-round-limit"]),"line-sort-key":new ue(at.layout_line["line-sort-key"])});var oR={paint:new we({"line-opacity":new ue(at.paint_line["line-opacity"]),"line-color":new ue(at.paint_line["line-color"]),"line-translate":new te(at.paint_line["line-translate"]),"line-translate-anchor":new te(at.paint_line["line-translate-anchor"]),"line-width":new ue(at.paint_line["line-width"]),"line-gap-width":new ue(at.paint_line["line-gap-width"]),"line-offset":new ue(at.paint_line["line-offset"]),"line-blur":new ue(at.paint_line["line-blur"]),"line-dasharray":new ue(at.paint_line["line-dasharray"]),"line-pattern":new ue(at.paint_line["line-pattern"]),"line-gradient":new be(at.paint_line["line-gradient"]),"line-trim-offset":new te(at.paint_line["line-trim-offset"])}),layout:dJ};const aR=new class extends ue{possiblyEvaluate(l,a){return a=new U(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition}),super.possiblyEvaluate(l,a)}evaluate(l,a,u,f){return a=Ge({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(l,a,u,f)}}(oR.paint.properties["line-width"].specification);function sR(l,a){return a>0?a+2*l:l}aR.useIntegerZoom=!0;const hJ=Ue([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),fJ=Ue([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),pJ=Ue([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ue([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const mJ=Ue([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),gJ=Ue([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ue([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const lR=Ue([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),yJ=Ue([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ue([{name:"triangle",components:3,type:"Uint16"}]),Ue([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ue([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ue([{type:"Float32",name:"offsetX"}]),Ue([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Mi=24;const js=128;function UT(l,a){const{expression:u}=a;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new U(l+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:g}=u;let x=0;for(;x<f.length&&f[x]<=l;)x++;x=Math.max(0,x-1);let S=x;for(;S<f.length&&f[S]<l+1;)S++;S=Math.min(f.length-1,S);const j=f[x],A=f[S];return u.kind==="composite"?{kind:"composite",minZoom:j,maxZoom:A,interpolationType:g}:{kind:"camera",minZoom:j,maxZoom:A,minSize:u.evaluate(new U(j)),maxSize:u.evaluate(new U(A)),interpolationType:g}}}function d_(l,{uSize:a,uSizeT:u},{lowerSize:f,upperSize:g}){return l.kind==="source"?f/js:l.kind==="composite"?kr(f/js,g/js,u):a}function gp(l,a){let u=0,f=0;if(l.kind==="constant")f=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:g,minZoom:x,maxZoom:S}=l,j=g?ve(La.interpolationFactor(g,a,x,S),0,1):0;l.kind==="camera"?f=kr(l.minSize,l.maxSize,j):u=j}return{uSizeT:u,uSize:f}}var vJ=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:js,evaluateSizeForFeature:d_,evaluateSizeForZoom:gp,getSizeData:UT});function xJ(l,a,u){return l.sections.forEach(f=>{f.text=function(g,x,S){const j=x.layout.get("text-transform").evaluate(S,{});return j==="uppercase"?g=g.toLocaleUpperCase():j==="lowercase"&&(g=g.toLocaleLowerCase()),z.applyArabicShaping&&(g=z.applyArabicShaping(g)),g}(f.text,a,u)}),l}const Xy={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function bJ(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}function _J(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}var cR=cn,uR=function(l,a,u,f,g){var x,S,j=8*g-f-1,A=(1<<j)-1,M=A>>1,$=-7,V=u?g-1:0,W=u?-1:1,Y=l[a+V];for(V+=W,x=Y&(1<<-$)-1,Y>>=-$,$+=j;$>0;x=256*x+l[a+V],V+=W,$-=8);for(S=x&(1<<-$)-1,x>>=-$,$+=f;$>0;S=256*S+l[a+V],V+=W,$-=8);if(x===0)x=1-M;else{if(x===A)return S?NaN:1/0*(Y?-1:1);S+=Math.pow(2,f),x-=M}return(Y?-1:1)*S*Math.pow(2,x-f)},dR=function(l,a,u,f,g,x){var S,j,A,M=8*x-g-1,$=(1<<M)-1,V=$>>1,W=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=f?0:x-1,J=f?1:-1,re=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(j=isNaN(a)?1:0,S=$):(S=Math.floor(Math.log(a)/Math.LN2),a*(A=Math.pow(2,-S))<1&&(S--,A*=2),(a+=S+V>=1?W/A:W*Math.pow(2,1-V))*A>=2&&(S++,A/=2),S+V>=$?(j=0,S=$):S+V>=1?(j=(a*A-1)*Math.pow(2,g),S+=V):(j=a*Math.pow(2,V-1)*Math.pow(2,g),S=0));g>=8;l[u+Y]=255&j,Y+=J,j/=256,g-=8);for(S=S<<g|j,M+=g;M>0;l[u+Y]=255&S,Y+=J,S/=256,M-=8);l[u+Y-J]|=128*re};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function cn(l){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(l)?l:new Uint8Array(l||0),this.pos=0,this.type=0,this.length=this.buf.length}cn.Varint=0,cn.Fixed64=1,cn.Bytes=2,cn.Fixed32=5;var VT=4294967296,hR=1/VT,fR=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ic(l){return l.type===cn.Bytes?l.readVarint()+l.pos:l.pos+1}function yp(l,a,u){return u?4294967296*a+(l>>>0):4294967296*(a>>>0)+(l>>>0)}function pR(l,a,u){var f=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));u.realloc(f);for(var g=u.pos-1;g>=l;g--)u.buf[g+f]=u.buf[g]}function wJ(l,a){for(var u=0;u<l.length;u++)a.writeVarint(l[u])}function SJ(l,a){for(var u=0;u<l.length;u++)a.writeSVarint(l[u])}function EJ(l,a){for(var u=0;u<l.length;u++)a.writeFloat(l[u])}function TJ(l,a){for(var u=0;u<l.length;u++)a.writeDouble(l[u])}function jJ(l,a){for(var u=0;u<l.length;u++)a.writeBoolean(l[u])}function CJ(l,a){for(var u=0;u<l.length;u++)a.writeFixed32(l[u])}function PJ(l,a){for(var u=0;u<l.length;u++)a.writeSFixed32(l[u])}function AJ(l,a){for(var u=0;u<l.length;u++)a.writeFixed64(l[u])}function kJ(l,a){for(var u=0;u<l.length;u++)a.writeSFixed64(l[u])}function h_(l,a){return(l[a]|l[a+1]<<8|l[a+2]<<16)+16777216*l[a+3]}function vp(l,a,u){l[u]=a,l[u+1]=a>>>8,l[u+2]=a>>>16,l[u+3]=a>>>24}function mR(l,a){return(l[a]|l[a+1]<<8|l[a+2]<<16)+(l[a+3]<<24)}cn.prototype={destroy:function(){this.buf=null},readFields:function(l,a,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),g=f>>3,x=this.pos;this.type=7&f,l(g,a,this),this.pos===x&&this.skip(f)}return a},readMessage:function(l,a){return this.readFields(l,a,this.readVarint()+this.pos)},readFixed32:function(){var l=h_(this.buf,this.pos);return this.pos+=4,l},readSFixed32:function(){var l=mR(this.buf,this.pos);return this.pos+=4,l},readFixed64:function(){var l=h_(this.buf,this.pos)+h_(this.buf,this.pos+4)*VT;return this.pos+=8,l},readSFixed64:function(){var l=h_(this.buf,this.pos)+mR(this.buf,this.pos+4)*VT;return this.pos+=8,l},readFloat:function(){var l=uR(this.buf,this.pos,!0,23,4);return this.pos+=4,l},readDouble:function(){var l=uR(this.buf,this.pos,!0,52,8);return this.pos+=8,l},readVarint:function(l){var a,u,f=this.buf;return a=127&(u=f[this.pos++]),u<128?a:(a|=(127&(u=f[this.pos++]))<<7,u<128?a:(a|=(127&(u=f[this.pos++]))<<14,u<128?a:(a|=(127&(u=f[this.pos++]))<<21,u<128?a:function(g,x,S){var j,A,M=S.buf;if(j=(112&(A=M[S.pos++]))>>4,A<128||(j|=(127&(A=M[S.pos++]))<<3,A<128)||(j|=(127&(A=M[S.pos++]))<<10,A<128)||(j|=(127&(A=M[S.pos++]))<<17,A<128)||(j|=(127&(A=M[S.pos++]))<<24,A<128)||(j|=(1&(A=M[S.pos++]))<<31,A<128))return yp(g,j,x);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(u=f[this.pos]))<<28,l,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var l=this.readVarint();return l%2==1?(l+1)/-2:l/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var l=this.readVarint()+this.pos,a=this.pos;return this.pos=l,l-a>=12&&fR?function(u,f,g){return fR.decode(u.subarray(f,g))}(this.buf,a,l):function(u,f,g){for(var x="",S=f;S<g;){var j,A,M,$=u[S],V=null,W=$>239?4:$>223?3:$>191?2:1;if(S+W>g)break;W===1?$<128&&(V=$):W===2?(192&(j=u[S+1]))==128&&(V=(31&$)<<6|63&j)<=127&&(V=null):W===3?(A=u[S+2],(192&(j=u[S+1]))==128&&(192&A)==128&&((V=(15&$)<<12|(63&j)<<6|63&A)<=2047||V>=55296&&V<=57343)&&(V=null)):W===4&&(A=u[S+2],M=u[S+3],(192&(j=u[S+1]))==128&&(192&A)==128&&(192&M)==128&&((V=(15&$)<<18|(63&j)<<12|(63&A)<<6|63&M)<=65535||V>=1114112)&&(V=null)),V===null?(V=65533,W=1):V>65535&&(V-=65536,x+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),x+=String.fromCharCode(V),S+=W}return x}(this.buf,a,l)},readBytes:function(){var l=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,l);return this.pos=l,a},readPackedVarint:function(l,a){if(this.type!==cn.Bytes)return l.push(this.readVarint(a));var u=ic(this);for(l=l||[];this.pos<u;)l.push(this.readVarint(a));return l},readPackedSVarint:function(l){if(this.type!==cn.Bytes)return l.push(this.readSVarint());var a=ic(this);for(l=l||[];this.pos<a;)l.push(this.readSVarint());return l},readPackedBoolean:function(l){if(this.type!==cn.Bytes)return l.push(this.readBoolean());var a=ic(this);for(l=l||[];this.pos<a;)l.push(this.readBoolean());return l},readPackedFloat:function(l){if(this.type!==cn.Bytes)return l.push(this.readFloat());var a=ic(this);for(l=l||[];this.pos<a;)l.push(this.readFloat());return l},readPackedDouble:function(l){if(this.type!==cn.Bytes)return l.push(this.readDouble());var a=ic(this);for(l=l||[];this.pos<a;)l.push(this.readDouble());return l},readPackedFixed32:function(l){if(this.type!==cn.Bytes)return l.push(this.readFixed32());var a=ic(this);for(l=l||[];this.pos<a;)l.push(this.readFixed32());return l},readPackedSFixed32:function(l){if(this.type!==cn.Bytes)return l.push(this.readSFixed32());var a=ic(this);for(l=l||[];this.pos<a;)l.push(this.readSFixed32());return l},readPackedFixed64:function(l){if(this.type!==cn.Bytes)return l.push(this.readFixed64());var a=ic(this);for(l=l||[];this.pos<a;)l.push(this.readFixed64());return l},readPackedSFixed64:function(l){if(this.type!==cn.Bytes)return l.push(this.readSFixed64());var a=ic(this);for(l=l||[];this.pos<a;)l.push(this.readSFixed64());return l},skip:function(l){var a=7&l;if(a===cn.Varint)for(;this.buf[this.pos++]>127;);else if(a===cn.Bytes)this.pos=this.readVarint()+this.pos;else if(a===cn.Fixed32)this.pos+=4;else{if(a!==cn.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(l,a){this.writeVarint(l<<3|a)},realloc:function(l){for(var a=this.length||16;a<this.pos+l;)a*=2;if(a!==this.length){var u=new Uint8Array(a);u.set(this.buf),this.buf=u,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(l){this.realloc(4),vp(this.buf,l,this.pos),this.pos+=4},writeSFixed32:function(l){this.realloc(4),vp(this.buf,l,this.pos),this.pos+=4},writeFixed64:function(l){this.realloc(8),vp(this.buf,-1&l,this.pos),vp(this.buf,Math.floor(l*hR),this.pos+4),this.pos+=8},writeSFixed64:function(l){this.realloc(8),vp(this.buf,-1&l,this.pos),vp(this.buf,Math.floor(l*hR),this.pos+4),this.pos+=8},writeVarint:function(l){(l=+l||0)>268435455||l<0?function(a,u){var f,g;if(a>=0?(f=a%4294967296|0,g=a/4294967296|0):(g=~(-a/4294967296),4294967295^(f=~(-a%4294967296))?f=f+1|0:(f=0,g=g+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(x,S,j){j.buf[j.pos++]=127&x|128,x>>>=7,j.buf[j.pos++]=127&x|128,x>>>=7,j.buf[j.pos++]=127&x|128,x>>>=7,j.buf[j.pos++]=127&x|128,j.buf[j.pos]=127&(x>>>=7)}(f,0,u),function(x,S){var j=(7&x)<<4;S.buf[S.pos++]|=j|((x>>>=3)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x)))))}(g,u)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))},writeSVarint:function(l){this.writeVarint(l<0?2*-l-1:2*l)},writeBoolean:function(l){this.writeVarint(!!l)},writeString:function(l){l=String(l),this.realloc(4*l.length),this.pos++;var a=this.pos;this.pos=function(f,g,x){for(var S,j,A=0;A<g.length;A++){if((S=g.charCodeAt(A))>55295&&S<57344){if(!j){S>56319||A+1===g.length?(f[x++]=239,f[x++]=191,f[x++]=189):j=S;continue}if(S<56320){f[x++]=239,f[x++]=191,f[x++]=189,j=S;continue}S=j-55296<<10|S-56320|65536,j=null}else j&&(f[x++]=239,f[x++]=191,f[x++]=189,j=null);S<128?f[x++]=S:(S<2048?f[x++]=S>>6|192:(S<65536?f[x++]=S>>12|224:(f[x++]=S>>18|240,f[x++]=S>>12&63|128),f[x++]=S>>6&63|128),f[x++]=63&S|128)}return x}(this.buf,l,this.pos);var u=this.pos-a;u>=128&&pR(a,u,this),this.pos=a-1,this.writeVarint(u),this.pos+=u},writeFloat:function(l){this.realloc(4),dR(this.buf,l,this.pos,!0,23,4),this.pos+=4},writeDouble:function(l){this.realloc(8),dR(this.buf,l,this.pos,!0,52,8),this.pos+=8},writeBytes:function(l){var a=l.length;this.writeVarint(a),this.realloc(a);for(var u=0;u<a;u++)this.buf[this.pos++]=l[u]},writeRawMessage:function(l,a){this.pos++;var u=this.pos;l(a,this);var f=this.pos-u;f>=128&&pR(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(l,a,u){this.writeTag(l,cn.Bytes),this.writeRawMessage(a,u)},writePackedVarint:function(l,a){a.length&&this.writeMessage(l,wJ,a)},writePackedSVarint:function(l,a){a.length&&this.writeMessage(l,SJ,a)},writePackedBoolean:function(l,a){a.length&&this.writeMessage(l,jJ,a)},writePackedFloat:function(l,a){a.length&&this.writeMessage(l,EJ,a)},writePackedDouble:function(l,a){a.length&&this.writeMessage(l,TJ,a)},writePackedFixed32:function(l,a){a.length&&this.writeMessage(l,CJ,a)},writePackedSFixed32:function(l,a){a.length&&this.writeMessage(l,PJ,a)},writePackedFixed64:function(l,a){a.length&&this.writeMessage(l,AJ,a)},writePackedSFixed64:function(l,a){a.length&&this.writeMessage(l,kJ,a)},writeBytesField:function(l,a){this.writeTag(l,cn.Bytes),this.writeBytes(a)},writeFixed32Field:function(l,a){this.writeTag(l,cn.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(l,a){this.writeTag(l,cn.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(l,a){this.writeTag(l,cn.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(l,a){this.writeTag(l,cn.Fixed64),this.writeSFixed64(a)},writeVarintField:function(l,a){this.writeTag(l,cn.Varint),this.writeVarint(a)},writeSVarintField:function(l,a){this.writeTag(l,cn.Varint),this.writeSVarint(a)},writeStringField:function(l,a){this.writeTag(l,cn.Bytes),this.writeString(a)},writeFloatField:function(l,a){this.writeTag(l,cn.Fixed32),this.writeFloat(a)},writeDoubleField:function(l,a){this.writeTag(l,cn.Fixed64),this.writeDouble(a)},writeBooleanField:function(l,a){this.writeVarintField(l,!!a)}};var f_=R(cR);const qT=3;function NJ(l,a,u){a.glyphs=[],l===1&&u.readMessage(MJ,a)}function MJ(l,a,u){if(l===3){const{id:f,bitmap:g,width:x,height:S,left:j,top:A,advance:M}=u.readMessage(IJ,{});a.glyphs.push({id:f,bitmap:new nc({width:x+2*qT,height:S+2*qT},g),metrics:{width:x,height:S,left:j,top:A,advance:M}})}else l===4?a.ascender=u.readSVarint():l===5&&(a.descender=u.readSVarint())}function IJ(l,a,u){l===1?a.id=u.readVarint():l===2?a.bitmap=u.readBytes():l===3?a.width=u.readVarint():l===4?a.height=u.readVarint():l===5?a.left=u.readSVarint():l===6?a.top=u.readSVarint():l===7&&(a.advance=u.readVarint())}const gR=qT;function WT(l){let a=0,u=0;for(const S of l)a+=S.w*S.h,u=Math.max(u,S.w);l.sort((S,j)=>j.h-S.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),u),h:1/0}];let g=0,x=0;for(const S of l)for(let j=f.length-1;j>=0;j--){const A=f[j];if(!(S.w>A.w||S.h>A.h)){if(S.x=A.x,S.y=A.y,x=Math.max(x,S.y+S.h),g=Math.max(g,S.x+S.w),S.w===A.w&&S.h===A.h){const M=f.pop();j<f.length&&(f[j]=M)}else S.h===A.h?(A.x+=S.w,A.w-=S.w):S.w===A.w?(A.y+=S.h,A.h-=S.h):(f.push({x:A.x+S.w,y:A.y,w:A.w-S.w,h:S.h}),A.y+=S.h,A.h-=S.h);break}}return{w:g,h:x,fill:a/(g*x)||0}}const ko=1;class GT{constructor(a,{pixelRatio:u,version:f,stretchX:g,stretchY:x,content:S}){this.paddedRect=a,this.pixelRatio=u,this.stretchX=g,this.stretchY=x,this.content=S,this.version=f}get tl(){return[this.paddedRect.x+ko,this.paddedRect.y+ko]}get br(){return[this.paddedRect.x+this.paddedRect.w-ko,this.paddedRect.y+this.paddedRect.h-ko]}get displaySize(){return[(this.paddedRect.w-2*ko)/this.pixelRatio,(this.paddedRect.h-2*ko)/this.pixelRatio]}}class yR{constructor(a,u){const f={},g={};this.haveRenderCallbacks=[];const x=[];this.addImages(a,f,x),this.addImages(u,g,x);const{w:S,h:j}=WT(x),A=new Xo({width:S||1,height:j||1});for(const M in a){const $=a[M],V=f[M].paddedRect;Xo.copy($.data,A,{x:0,y:0},{x:V.x+ko,y:V.y+ko},$.data)}for(const M in u){const $=u[M],V=g[M].paddedRect,W=V.x+ko,Y=V.y+ko,J=$.data.width,re=$.data.height;Xo.copy($.data,A,{x:0,y:0},{x:W,y:Y},$.data),Xo.copy($.data,A,{x:0,y:re-1},{x:W,y:Y-1},{width:J,height:1}),Xo.copy($.data,A,{x:0,y:0},{x:W,y:Y+re},{width:J,height:1}),Xo.copy($.data,A,{x:J-1,y:0},{x:W-1,y:Y},{width:1,height:re}),Xo.copy($.data,A,{x:0,y:0},{x:W+J,y:Y},{width:1,height:re})}this.image=A,this.iconPositions=f,this.patternPositions=g}addImages(a,u,f){for(const g in a){const x=a[g],S={x:0,y:0,w:x.data.width+2*ko,h:x.data.height+2*ko};f.push(S),u[g]=new GT(S,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(a,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>a.hasImage(f)),a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in a.updatedImages)this.patchUpdatedImage(this.iconPositions[f],a.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],a.getImage(f),u)}patchUpdatedImage(a,u,f){if(!a||!u||a.version===u.version)return;a.version=u.version;const[g,x]=a.tl;f.update(u.data,void 0,{x:g,y:x})}}zt(GT,"ImagePosition"),zt(yR,"ImageAtlas");const ga={horizontal:1,vertical:2,horizontalOnly:3},vR=-17;class Zy{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,u){const f=new Zy;return f.scale=a||1,f.fontStack=u,f}static forImage(a){const u=new Zy;return u.imageName=a,u}}class xp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,u){const f=new xp;for(let g=0;g<a.sections.length;g++){const x=a.sections[g];x.image?f.addImageSection(x):f.addTextSection(x,u)}return f}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSections(){return this.sections}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(a){this.text=function(u,f){let g="";for(let x=0;x<u.length;x++){const S=u.charCodeAt(x+1)||null,j=u.charCodeAt(x-1)||null;g+=!f&&(S&&U0(S)&&!Xy[u[x+1]]||j&&U0(j)&&!Xy[u[x-1]])||!Xy[u[x]]?u[x]:Xy[u[x]]}return g}(this.text,a)}trim(){let a=0;for(let f=0;f<this.text.length&&p_[this.text.charCodeAt(f)];f++)a++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=a&&p_[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(a,u),this.sectionIndex=this.sectionIndex.slice(a,u)}substring(a,u){const f=new xp;return f.text=this.text.substring(a,u),f.sectionIndex=this.sectionIndex.slice(a,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,u)=>Math.max(a,this.sections[u].scale),0)}addTextSection(a,u){this.text+=a.text,this.sections.push(Zy.forText(a.scale,a.fontStack||u));const f=this.sections.length-1;for(let g=0;g<a.text.length;++g)this.sectionIndex.push(f)}addImageSection(a){const u=a.image?a.image.name:"";if(u.length===0)return void pt("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Zy.forImage(u)),this.sectionIndex.push(this.sections.length-1)):pt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function HT(l,a,u,f,g,x,S,j,A,M,$,V,W,Y,J){const re=xp.fromFeature(l,g);V===ga.vertical&&re.verticalizePunctuation(W);let le=[];const ge=function(Ne,Qe,Ke,st,_t,tt){if(!Ne)return[];const dt=[],ht=function(Ot,Vt,Dt,ur,Ct,Yt){let dr=0;for(let Or=0;Or<Ot.length();Or++){const hr=Ot.getSection(Or);dr+=xR(Ot.getCharCode(Or),hr,ur,Ct,Vt,Yt)}return dr/Math.max(1,Math.ceil(dr/Dt))}(Ne,Qe,Ke,st,_t,tt),yt=Ne.text.indexOf("")>=0;let jt=0;for(let Ot=0;Ot<Ne.length();Ot++){const Vt=Ne.getSection(Ot),Dt=Ne.getCharCode(Ot);if(p_[Dt]||(jt+=xR(Dt,Vt,st,_t,Qe,tt)),Ot<Ne.length()-1){const ur=!((ot=Dt)<11904||!(Rt["Bopomofo Extended"](ot)||Rt.Bopomofo(ot)||Rt["CJK Compatibility Forms"](ot)||Rt["CJK Compatibility Ideographs"](ot)||Rt["CJK Compatibility"](ot)||Rt["CJK Radicals Supplement"](ot)||Rt["CJK Strokes"](ot)||Rt["CJK Symbols and Punctuation"](ot)||Rt["CJK Unified Ideographs Extension A"](ot)||Rt["CJK Unified Ideographs"](ot)||Rt["Enclosed CJK Letters and Months"](ot)||Rt["Halfwidth and Fullwidth Forms"](ot)||Rt.Hiragana(ot)||Rt["Ideographic Description Characters"](ot)||Rt["Kangxi Radicals"](ot)||Rt["Katakana Phonetic Extensions"](ot)||Rt.Katakana(ot)||Rt["Vertical Forms"](ot)||Rt["Yi Radicals"](ot)||Rt["Yi Syllables"](ot)));(OJ[Dt]||ur||Vt.imageName)&&dt.push(_R(Ot+1,jt,ht,dt,DJ(Dt,Ne.getCharCode(Ot+1),ur&&yt),!1))}}var ot;return wR(_R(Ne.length(),jt,ht,dt,0,!0))}(re,M,x,a,f,Y),{processBidirectionalText:Ae,processStyledBidirectionalText:ye}=z;if(Ae&&re.sections.length===1){const Ne=Ae(re.toString(),ge);for(const Qe of Ne){const Ke=new xp;Ke.text=Qe,Ke.sections=re.sections;for(let st=0;st<Qe.length;st++)Ke.sectionIndex.push(0);le.push(Ke)}}else if(ye){const Ne=ye(re.text,re.sectionIndex,ge);for(const Qe of Ne){const Ke=new xp;Ke.text=Qe[0],Ke.sectionIndex=Qe[1],Ke.sections=re.sections,le.push(Ke)}}else le=function(Ne,Qe){const Ke=[],st=Ne.text;let _t=0;for(const tt of Qe)Ke.push(Ne.substring(_t,tt)),_t=tt;return _t<st.length&&Ke.push(Ne.substring(_t,st.length)),Ke}(re,ge);const Te=[],Me={positionedLines:Te,text:re.toString(),top:$[1],bottom:$[1],left:$[0],right:$[0],writingMode:V,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Ne,Qe,Ke,st,_t,tt,dt,ht,yt,jt,ot,Ot){let Vt=0,Dt=0,ur=0;const Ct=ht==="right"?1:ht==="left"?0:.5;let Yt=!1;for(const gr of _t){const yr=gr.getSections();for(const nn of yr){if(nn.imageName)continue;const un=Qe[nn.fontStack];if(un&&(Yt=un.ascender!==void 0&&un.descender!==void 0,!Yt))break}if(!Yt)break}let dr=0;for(const gr of _t){gr.trim();const yr=gr.getMaxScale(),nn=(yr-1)*Mi,un={positionedGlyphs:[],lineOffset:0};Ne.positionedLines[dr]=un;const dn=un.positionedGlyphs;let on=0;if(!gr.length()){Dt+=tt,++dr;continue}let Pn=0,Rn=0;for(let an=0;an<gr.length();an++){const ci=gr.getSection(an),ei=gr.getSectionIndex(an),kn=gr.getCharCode(an);let Rr=ci.scale,ti=null,hn=null,go=null,ri=Mi,Ii=0;const _i=!(yt===ga.horizontal||!ot&&!wy(kn)||ot&&(p_[kn]||(Or=kn,Rt.Arabic(Or)||Rt["Arabic Supplement"](Or)||Rt["Arabic Extended-A"](Or)||Rt["Arabic Presentation Forms-A"](Or)||Rt["Arabic Presentation Forms-B"](Or))));if(ci.imageName){const yo=st[ci.imageName];if(!yo)continue;go=ci.imageName,Ne.iconsInText=Ne.iconsInText||!0,hn=yo.paddedRect;const wi=yo.displaySize;Rr=Rr*Mi/Ot,ti={width:wi[0],height:wi[1],left:ko,top:-gR,advance:_i?wi[1]:wi[0],localGlyph:!1},Ii=Yt?-ti.height*Rr:vR+yr*Mi-wi[1]*Rr,ri=ti.advance;const As=(_i?wi[0]:wi[1])*Rr-Mi*yr;As>0&&As>on&&(on=As)}else{const yo=Ke[ci.fontStack];if(!yo)continue;yo[kn]&&(hn=yo[kn]);const wi=Qe[ci.fontStack];if(!wi)continue;const As=wi.glyphs[kn];if(!As)continue;if(ti=As.metrics,ri=kn!==8203?Mi:0,Yt){const jp=wi.ascender!==void 0?Math.abs(wi.ascender):0,ov=wi.descender!==void 0?Math.abs(wi.descender):0,av=(jp+ov)*Rr;Pn<av&&(Pn=av,Rn=(jp-ov)/2*Rr),Ii=-jp*Rr}else Ii=vR+(yr-Rr)*Mi}_i?(Ne.verticalizable=!0,dn.push({glyph:kn,imageName:go,x:Vt,y:Dt+Ii,vertical:_i,scale:Rr,localGlyph:ti.localGlyph,fontStack:ci.fontStack,sectionIndex:ei,metrics:ti,rect:hn}),Vt+=ri*Rr+jt):(dn.push({glyph:kn,imageName:go,x:Vt,y:Dt+Ii,vertical:_i,scale:Rr,localGlyph:ti.localGlyph,fontStack:ci.fontStack,sectionIndex:ei,metrics:ti,rect:hn}),Vt+=ti.advance*Rr+jt)}dn.length!==0&&(ur=Math.max(Vt-jt,ur),Yt?SR(dn,Ct,on,Rn,tt*yr/2):SR(dn,Ct,on,0,tt/2)),Vt=0;const Qn=tt*yr+on;un.lineOffset=Math.max(on,nn),Dt+=Qn,++dr}var Or;const hr=Dt,{horizontalAlign:or,verticalAlign:pn}=XT(dt);(function(gr,yr,nn,un,dn,on){const Pn=(yr-nn)*dn,Rn=-on*un;for(const Qn of gr)for(const an of Qn.positionedGlyphs)an.x+=Pn,an.y+=Rn})(Ne.positionedLines,Ct,or,pn,ur,hr),Ne.top+=-pn*hr,Ne.bottom=Ne.top+hr,Ne.left+=-or*ur,Ne.right=Ne.left+ur,Ne.hasBaseline=Yt}(Me,a,u,f,le,S,j,A,V,M,W,J),!function(Ne){for(const Qe of Ne)if(Qe.positionedGlyphs.length!==0)return!1;return!0}(Te)&&Me}const p_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},OJ={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function xR(l,a,u,f,g,x){if(a.imageName){const S=f[a.imageName];return S?S.displaySize[0]*a.scale*Mi/x+g:0}{const S=u[a.fontStack],j=S&&S.glyphs[l];return j?j.metrics.advance*a.scale+g:0}}function bR(l,a,u,f){const g=Math.pow(l-a,2);return f?l<a?g/2:2*g:g+Math.abs(u)*u}function DJ(l,a,u){let f=0;return l===10&&(f-=1e4),u&&(f+=150),l!==40&&l!==65288||(f+=50),a!==41&&a!==65289||(f+=50),f}function _R(l,a,u,f,g,x){let S=null,j=bR(a,u,g,x);for(const A of f){const M=bR(a-A.x,u,g,x)+A.badness;M<=j&&(S=A,j=M)}return{index:l,x:a,priorBreak:S,badness:j}}function wR(l){return l?wR(l.priorBreak).concat(l.index):[]}function XT(l){let a=.5,u=.5;switch(l){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:a,verticalAlign:u}}function SR(l,a,u,f,g){if(!(a||u||f||g))return;const x=l.length-1,S=l[x],j=(S.x+S.metrics.advance*S.scale)*a;for(let A=0;A<=x;A++)l[A].x-=j,l[A].y+=u+f+g}function RJ(l,a,u){const{horizontalAlign:f,verticalAlign:g}=XT(u),x=a[0]-l.displaySize[0]*f,S=a[1]-l.displaySize[1]*g;return{image:l,top:S,bottom:S+l.displaySize[1],left:x,right:x+l.displaySize[0]}}function ER(l,a,u,f,g,x){const S=l.image;let j;if(S.content){const le=S.content,ge=S.pixelRatio||1;j=[le[0]/ge,le[1]/ge,S.displaySize[0]-le[2]/ge,S.displaySize[1]-le[3]/ge]}const A=a.left*x,M=a.right*x;let $,V,W,Y;u==="width"||u==="both"?(Y=g[0]+A-f[3],V=g[0]+M+f[1]):(Y=g[0]+(A+M-S.displaySize[0])/2,V=Y+S.displaySize[0]);const J=a.top*x,re=a.bottom*x;return u==="height"||u==="both"?($=g[1]+J-f[0],W=g[1]+re+f[2]):($=g[1]+(J+re-S.displaySize[1])/2,W=$+S.displaySize[1]),{image:S,top:$,right:V,bottom:W,left:Y,collisionPadding:j}}class oc extends K{constructor(a,u,f,g,x){super(a,u),this.angle=g,this.z=f,x!==void 0&&(this.segment=x)}clone(){return new oc(this.x,this.y,this.z,this.angle,this.segment)}}function TR(l,a,u,f,g){if(a.segment===void 0)return!0;let x=a,S=a.segment+1,j=0;for(;j>-u/2;){if(S--,S<0)return!1;j-=l[S].dist(x),x=l[S]}j+=l[S].dist(l[S+1]),S++;const A=[];let M=0;for(;j<u/2;){const $=l[S],V=l[S+1];if(!V)return!1;let W=l[S-1].angleTo($)-$.angleTo(V);for(W=Math.abs((W+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:j,angleDelta:W}),M+=W;j-A[0].distance>f;)M-=A.shift().angleDelta;if(M>g)return!1;S++,j+=$.dist(V)}return!0}function jR(l){let a=0;for(let u=0;u<l.length-1;u++)a+=l[u].dist(l[u+1]);return a}function CR(l,a,u){return l?.6*a*u:0}function PR(l,a){return Math.max(l?l.right-l.left:0,a?a.right-a.left:0)}function LJ(l,a,u,f,g,x){const S=CR(u,g,x),j=PR(u,f)*x;let A=0;const M=jR(l)/2;for(let $=0;$<l.length-1;$++){const V=l[$],W=l[$+1],Y=V.dist(W);if(A+Y>M){const J=(M-A)/Y,re=kr(V.x,W.x,J),le=kr(V.y,W.y,J),ge=new oc(re,le,0,W.angleTo(V),$);return!S||TR(l,ge,j,S,a)?ge:void 0}A+=Y}}function BJ(l,a,u,f,g,x,S,j,A){const M=CR(f,x,S),$=PR(f,g),V=$*S,W=l[0].x===0||l[0].x===A||l[0].y===0||l[0].y===A;return a-V<a/4&&(a=V+a/4),AR(l,W?a/2*j%a:($/2+2*x)*S*j%a,a,M,u,V,W,!1,A)}function AR(l,a,u,f,g,x,S,j,A){const M=x/2,$=jR(l);let V=0,W=a-u,Y=[];for(let J=0;J<l.length-1;J++){const re=l[J],le=l[J+1],ge=re.dist(le),Ae=le.angleTo(re);for(;W+u<V+ge;){W+=u;const ye=(W-V)/ge,Te=kr(re.x,le.x,ye),Me=kr(re.y,le.y,ye);if(Te>=0&&Te<A&&Me>=0&&Me<A&&W-M>=0&&W+M<=$){const Ne=new oc(Te,Me,0,Ae,J);Ne._round(),f&&!TR(l,Ne,x,f,g)||Y.push(Ne)}}V+=ge}return j||Y.length||S||(Y=AR(l,V/2,u,f,g,x,S,!0,A)),Y}function kR(l,a,u,f,g){const x=[];for(let S=0;S<l.length;S++){const j=l[S];let A;for(let M=0;M<j.length-1;M++){let $=j[M],V=j[M+1];$.x<a&&V.x<a||($.x<a?$=new K(a,$.y+(a-$.x)/(V.x-$.x)*(V.y-$.y))._round():V.x<a&&(V=new K(a,$.y+(a-$.x)/(V.x-$.x)*(V.y-$.y))._round()),$.y<u&&V.y<u||($.y<u?$=new K($.x+(u-$.y)/(V.y-$.y)*(V.x-$.x),u)._round():V.y<u&&(V=new K($.x+(u-$.y)/(V.y-$.y)*(V.x-$.x),u)._round()),$.x>=f&&V.x>=f||($.x>=f?$=new K(f,$.y+(f-$.x)/(V.x-$.x)*(V.y-$.y))._round():V.x>=f&&(V=new K(f,$.y+(f-$.x)/(V.x-$.x)*(V.y-$.y))._round()),$.y>=g&&V.y>=g||($.y>=g?$=new K($.x+(g-$.y)/(V.y-$.y)*(V.x-$.x),g)._round():V.y>=g&&(V=new K($.x+(g-$.y)/(V.y-$.y)*(V.x-$.x),g)._round()),A&&$.equals(A[A.length-1])||(A=[$],x.push(A)),A.push(V)))))}}return x}zt(oc,"Anchor");const Ky=1e20;function NR(l,a,u,f,g,x,S,j,A){for(let M=a;M<a+f;M++)MR(l,u*x+M,x,g,S,j,A);for(let M=u;M<u+g;M++)MR(l,M*x+a,1,f,S,j,A)}function MR(l,a,u,f,g,x,S){x[0]=0,S[0]=-Ky,S[1]=Ky,g[0]=l[a];for(let j=1,A=0,M=0;j<f;j++){g[j]=l[a+j*u];const $=j*j;do{const V=x[A];M=(g[j]-g[V]+$-V*V)/(j-V)/2}while(M<=S[A]&&--A>-1);A++,x[A]=j,S[A]=M,S[A+1]=Ky}for(let j=0,A=0;j<f;j++){for(;S[A+1]<j;)A++;const M=x[A],$=j-M;l[a+j*u]=g[M]+$*$}}const Cs=2,ZT={none:0,ideographs:1,all:2};class bp{constructor(a,u,f){this.requestManager=a,this.localGlyphMode=u,this.localFontFamily=f,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(a){this.url=a}getGlyphs(a,u){const f=[];for(const g in a)for(const x of a[g])f.push({stack:g,id:x});Be(f,({stack:g,id:x},S)=>{let j=this.entries[g];j||(j=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let A=j.glyphs[x];if(A!==void 0)return void S(null,{stack:g,id:x,glyph:A});if(A=this._tinySDF(j,g,x),A)return j.glyphs[x]=A,void S(null,{stack:g,id:x,glyph:A});const M=Math.floor(x/256);if(256*M>65535)return void S(new Error("glyphs > 65535 not supported"));if(j.ranges[M])return void S(null,{stack:g,id:x,glyph:A});let $=j.requests[M];$||($=j.requests[M]=[],bp.loadGlyphRange(g,M,this.url,this.requestManager,(V,W)=>{if(W){j.ascender=W.ascender,j.descender=W.descender;for(const Y in W.glyphs)this._doesCharSupportLocalGlyph(+Y)||(j.glyphs[+Y]=W.glyphs[+Y]);j.ranges[M]=!0}for(const Y of $)Y(V,W);delete j.requests[M]})),$.push((V,W)=>{V?S(V):W&&S(null,{stack:g,id:x,glyph:W.glyphs[x]||null})})},(g,x)=>{if(g)u(g);else if(x){const S={};for(const{stack:j,id:A,glyph:M}of x)S[j]===void 0&&(S[j]={}),S[j].glyphs===void 0&&(S[j].glyphs={}),S[j].glyphs[A]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},S[j].ascender=this.entries[j].ascender,S[j].descender=this.entries[j].descender;u(null,S)}})}_doesCharSupportLocalGlyph(a){return this.localGlyphMode!==ZT.none&&(this.localGlyphMode===ZT.all?!!this.localFontFamily:!!this.localFontFamily&&(Rt["CJK Unified Ideographs"](a)||Rt["Hangul Syllables"](a)||Rt.Hiragana(a)||Rt.Katakana(a)||Rt["CJK Symbols and Punctuation"](a)))}_tinySDF(a,u,f){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let x=a.tinySDF;if(!x){let re="400";/bold/i.test(u)?re="900":/medium/i.test(u)?re="500":/light/i.test(u)&&(re="200"),x=a.tinySDF=new bp.TinySDF({fontFamily:g,fontWeight:re,fontSize:24*Cs,buffer:3*Cs,radius:8*Cs}),x.fontWeight=re}if(this.localGlyphs[x.fontWeight][f])return this.localGlyphs[x.fontWeight][f];const S=String.fromCharCode(f),{data:j,width:A,height:M,glyphWidth:$,glyphHeight:V,glyphLeft:W,glyphTop:Y,glyphAdvance:J}=x.draw(S);return this.localGlyphs[x.fontWeight][f]={id:f,bitmap:new nc({width:A,height:M},j),metrics:{width:$/Cs,height:V/Cs,left:W/Cs,top:Y/Cs-27,advance:J/Cs,localGlyph:!0}}}}bp.loadGlyphRange=function(l,a,u,f,g){const x=256*a,S=x+255,j=f.transformRequest(f.normalizeGlyphsURL(u).replace("{fontstack}",l).replace("{range}",`${x}-${S}`),zl.Glyphs);Kc(j,(A,M)=>{if(A)g(A);else if(M){const $={},V=function(W){return new f_(W).readFields(NJ,{})}(M);for(const W of V.glyphs)$[W.id]=W;g(null,{glyphs:$,ascender:V.ascender,descender:V.descender})}})},bp.TinySDF=class{constructor({fontSize:l=24,buffer:a=3,radius:u=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:x="normal",fontStyle:S="normal"}={}){this.buffer=a,this.cutoff=f,this.radius=u;const j=this.size=l+4*a,A=this._createCanvas(j),M=this.ctx=A.getContext("2d",{willReadFrequently:!0});M.font=`${S} ${x} ${l}px ${g}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(j*j),this.gridInner=new Float64Array(j*j),this.f=new Float64Array(j),this.z=new Float64Array(j+1),this.v=new Uint16Array(j)}_createCanvas(l){const a=document.createElement("canvas");return a.width=a.height=l,a}draw(l){const{width:a,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:x}=this.ctx.measureText(l),S=Math.ceil(u),j=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-g))),A=Math.min(this.size-this.buffer,S+Math.ceil(f)),M=j+2*this.buffer,$=A+2*this.buffer,V=Math.max(M*$,0),W=new Uint8ClampedArray(V),Y={data:W,width:M,height:$,glyphWidth:j,glyphHeight:A,glyphTop:S,glyphLeft:0,glyphAdvance:a};if(j===0||A===0)return Y;const{ctx:J,buffer:re,gridInner:le,gridOuter:ge}=this;J.clearRect(re,re,j,A),J.fillText(l,re,re+S);const Ae=J.getImageData(re,re,j,A);ge.fill(Ky,0,V),le.fill(0,0,V);for(let ye=0;ye<A;ye++)for(let Te=0;Te<j;Te++){const Me=Ae.data[4*(ye*j+Te)+3]/255;if(Me===0)continue;const Ne=(ye+re)*M+Te+re;if(Me===1)ge[Ne]=0,le[Ne]=Ky;else{const Qe=.5-Me;ge[Ne]=Qe>0?Qe*Qe:0,le[Ne]=Qe<0?Qe*Qe:0}}NR(ge,0,0,M,$,M,this.f,this.v,this.z),NR(le,re,re,j,A,M,this.f,this.v,this.z);for(let ye=0;ye<V;ye++){const Te=Math.sqrt(ge[ye])-Math.sqrt(le[ye]);W[ye]=Math.round(255-255*(Te/this.radius+this.cutoff))}return Y}};const _p=ko;function IR(l,a,u,f){const g=[],x=l.image,S=x.pixelRatio,j=x.paddedRect.w-2*_p,A=x.paddedRect.h-2*_p,M=l.right-l.left,$=l.bottom-l.top,V=x.stretchX||[[0,j]],W=x.stretchY||[[0,A]],Y=(tt,dt)=>tt+dt[1]-dt[0],J=V.reduce(Y,0),re=W.reduce(Y,0),le=j-J,ge=A-re;let Ae=0,ye=J,Te=0,Me=re,Ne=0,Qe=le,Ke=0,st=ge;if(x.content&&f){const tt=x.content;Ae=m_(V,0,tt[0]),Te=m_(W,0,tt[1]),ye=m_(V,tt[0],tt[2]),Me=m_(W,tt[1],tt[3]),Ne=tt[0]-Ae,Ke=tt[1]-Te,Qe=tt[2]-tt[0]-ye,st=tt[3]-tt[1]-Me}const _t=(tt,dt,ht,yt)=>{const jt=g_(tt.stretch-Ae,ye,M,l.left),ot=y_(tt.fixed-Ne,Qe,tt.stretch,J),Ot=g_(dt.stretch-Te,Me,$,l.top),Vt=y_(dt.fixed-Ke,st,dt.stretch,re),Dt=g_(ht.stretch-Ae,ye,M,l.left),ur=y_(ht.fixed-Ne,Qe,ht.stretch,J),Ct=g_(yt.stretch-Te,Me,$,l.top),Yt=y_(yt.fixed-Ke,st,yt.stretch,re),dr=new K(jt,Ot),Or=new K(Dt,Ot),hr=new K(Dt,Ct),or=new K(jt,Ct),pn=new K(ot/S,Vt/S),gr=new K(ur/S,Yt/S),yr=a*Math.PI/180;if(yr){const dn=Math.sin(yr),on=Math.cos(yr),Pn=[on,-dn,dn,on];dr._matMult(Pn),Or._matMult(Pn),or._matMult(Pn),hr._matMult(Pn)}const nn=tt.stretch+tt.fixed,un=dt.stretch+dt.fixed;return{tl:dr,tr:Or,bl:or,br:hr,tex:{x:x.paddedRect.x+_p+nn,y:x.paddedRect.y+_p+un,w:ht.stretch+ht.fixed-nn,h:yt.stretch+yt.fixed-un},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:pn,pixelOffsetBR:gr,minFontScaleX:Qe/S/M,minFontScaleY:st/S/$,isSDF:u}};if(f&&(x.stretchX||x.stretchY)){const tt=OR(V,le,J),dt=OR(W,ge,re);for(let ht=0;ht<tt.length-1;ht++){const yt=tt[ht],jt=tt[ht+1];for(let ot=0;ot<dt.length-1;ot++)g.push(_t(yt,dt[ot],jt,dt[ot+1]))}}else g.push(_t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:j+1},{fixed:0,stretch:A+1}));return g}function m_(l,a,u){let f=0;for(const g of l)f+=Math.max(a,Math.min(u,g[1]))-Math.max(a,Math.min(u,g[0]));return f}function OR(l,a,u){const f=[{fixed:-_p,stretch:0}];for(const[g,x]of l){const S=f[f.length-1];f.push({fixed:g-S.stretch,stretch:S.stretch}),f.push({fixed:g-S.stretch,stretch:S.stretch+(x-g)})}return f.push({fixed:a+_p,stretch:u}),f}function g_(l,a,u,f){return l/a*u+f}function y_(l,a,u,f){return l-a*u/f}function zJ(l,a,u,f){const g=a+l.positionedLines[f].lineOffset;return f===0?u+g/2:u+(g+(a+l.positionedLines[f-1].lineOffset))/2}class $J{constructor(a=[],u=FJ){if(this.data=a,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const a=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:u,compare:f}=this,g=u[a];for(;a>0;){const x=a-1>>1,S=u[x];if(f(g,S)>=0)break;u[a]=S,a=x}u[a]=g}_down(a){const{data:u,compare:f}=this,g=this.length>>1,x=u[a];for(;a<g;){let S=1+(a<<1),j=u[S];const A=S+1;if(A<this.length&&f(u[A],j)<0&&(S=A,j=u[A]),f(j,x)>=0)break;u[a]=j,a=S}u[a]=x}}function FJ(l,a){return l<a?-1:l>a?1:0}function UJ(l,a=1,u=!1){let f=1/0,g=1/0,x=-1/0,S=-1/0;const j=l[0];for(let Y=0;Y<j.length;Y++){const J=j[Y];(!Y||J.x<f)&&(f=J.x),(!Y||J.y<g)&&(g=J.y),(!Y||J.x>x)&&(x=J.x),(!Y||J.y>S)&&(S=J.y)}const A=Math.min(x-f,S-g);let M=A/2;const $=new $J([],VJ);if(A===0)return new K(f,g);for(let Y=f;Y<x;Y+=A)for(let J=g;J<S;J+=A)$.push(new wp(Y+M,J+M,M,l));let V=function(Y){let J=0,re=0,le=0;const ge=Y[0];for(let Ae=0,ye=ge.length,Te=ye-1;Ae<ye;Te=Ae++){const Me=ge[Ae],Ne=ge[Te],Qe=Me.x*Ne.y-Ne.x*Me.y;re+=(Me.x+Ne.x)*Qe,le+=(Me.y+Ne.y)*Qe,J+=3*Qe}return new wp(re/J,le/J,0,Y)}(l),W=$.length;for(;$.length;){const Y=$.pop();(Y.d>V.d||!V.d)&&(V=Y,u&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,W)),Y.max-V.d<=a||(M=Y.h/2,$.push(new wp(Y.p.x-M,Y.p.y-M,M,l)),$.push(new wp(Y.p.x+M,Y.p.y-M,M,l)),$.push(new wp(Y.p.x-M,Y.p.y+M,M,l)),$.push(new wp(Y.p.x+M,Y.p.y+M,M,l)),W+=4)}return u&&(console.log(`num probes: ${W}`),console.log(`best distance: ${V.d}`)),V.p}function VJ(l,a){return a.max-l.max}class wp{constructor(a,u,f,g){this.p=new K(a,u),this.h=f,this.d=function(x,S){let j=!1,A=1/0;for(let M=0;M<S.length;M++){const $=S[M];for(let V=0,W=$.length,Y=W-1;V<W;Y=V++){const J=$[V],re=$[Y];J.y>x.y!=re.y>x.y&&x.x<(re.x-J.x)*(x.y-J.y)/(re.y-J.y)+J.x&&(j=!j),A=Math.min(A,AD(x,J,re))}}return(j?1:-1)*Math.sqrt(A)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}}const Sp=7,KT=Number.POSITIVE_INFINITY,qJ=Math.sqrt(2);function DR(l,[a,u]){let f=0,g=0;if(u===KT){a<0&&(a=0);const x=a/qJ;switch(l){case"top-right":case"top-left":g=x-Sp;break;case"bottom-right":case"bottom-left":g=-x+Sp;break;case"bottom":g=-a+Sp;break;case"top":g=a-Sp}switch(l){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=a;break;case"right":f=-a}}else{switch(a=Math.abs(a),u=Math.abs(u),l){case"top-right":case"top-left":case"top":g=u-Sp;break;case"bottom-right":case"bottom-left":case"bottom":g=-u+Sp}switch(l){case"top-right":case"bottom-right":case"right":f=-a;break;case"top-left":case"bottom-left":case"left":f=a}}return[f,g]}function WJ(l,a,u,f,g,x,S,j,A,M){l.createArrays(),l.tilePixelRatio=tr/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const $=l.layers[0].layout,V=l.layers[0]._unevaluatedLayout._values,W={};if(l.textSizeData.kind==="composite"){const{minZoom:re,maxZoom:le}=l.textSizeData;W.compositeTextSizes=[V["text-size"].possiblyEvaluate(new U(re),j),V["text-size"].possiblyEvaluate(new U(le),j)]}if(l.iconSizeData.kind==="composite"){const{minZoom:re,maxZoom:le}=l.iconSizeData;W.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new U(re),j),V["icon-size"].possiblyEvaluate(new U(le),j)]}W.layoutTextSize=V["text-size"].possiblyEvaluate(new U(A+1),j),W.layoutIconSize=V["icon-size"].possiblyEvaluate(new U(A+1),j),W.textMaxSize=V["text-size"].possiblyEvaluate(new U(18),j);const Y=$.get("text-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",J=$.get("text-size");for(const re of l.features){const le=$.get("text-font").evaluate(re,{},j).join(","),ge=J.evaluate(re,{},j),Ae=W.layoutTextSize.evaluate(re,{},j),ye=(W.layoutIconSize.evaluate(re,{},j),{horizontal:{},vertical:void 0}),Te=re.text;let Me,Ne=[0,0];if(Te){const st=Te.toString(),_t=$.get("text-letter-spacing").evaluate(re,{},j)*Mi,tt=$.get("text-line-height").evaluate(re,{},j)*Mi,dt=oT(st)?_t:0,ht=$.get("text-anchor").evaluate(re,{},j),yt=$.get("text-variable-anchor");if(!yt){const Dt=$.get("text-radial-offset").evaluate(re,{},j);Ne=Dt?DR(ht,[Dt*Mi,KT]):$.get("text-offset").evaluate(re,{},j).map(ur=>ur*Mi)}let jt=Y?"center":$.get("text-justify").evaluate(re,{},j);const ot=$.get("symbol-placement")==="point",Ot=ot?$.get("text-max-width").evaluate(re,{},j)*Mi:1/0,Vt=Dt=>{l.allowVerticalPlacement&&_y(st)&&(ye.vertical=HT(Te,a,u,g,le,Ot,tt,ht,Dt,dt,Ne,ga.vertical,!0,Ae,ge))};if(!Y&&yt){const Dt=jt==="auto"?yt.map(Ct=>YT(Ct)):[jt];let ur=!1;for(let Ct=0;Ct<Dt.length;Ct++){const Yt=Dt[Ct];if(!ye.horizontal[Yt])if(ur)ye.horizontal[Yt]=ye.horizontal[0];else{const dr=HT(Te,a,u,g,le,Ot,tt,"center",Yt,dt,Ne,ga.horizontal,!1,Ae,ge);dr&&(ye.horizontal[Yt]=dr,ur=dr.positionedLines.length===1)}}Vt("left")}else{if(jt==="auto"&&(jt=YT(ht)),ot||$.get("text-writing-mode").indexOf("horizontal")>=0||!_y(st)){const Dt=HT(Te,a,u,g,le,Ot,tt,ht,jt,dt,Ne,ga.horizontal,!1,Ae,ge);Dt&&(ye.horizontal[jt]=Dt)}Vt(ot?"left":jt)}}let Qe=!1;if(re.icon&&re.icon.name){const st=f[re.icon.name];st&&(Me=RJ(g[re.icon.name],$.get("icon-offset").evaluate(re,{},j),$.get("icon-anchor").evaluate(re,{},j)),Qe=st.sdf,l.sdfIcons===void 0?l.sdfIcons=st.sdf:l.sdfIcons!==st.sdf&&pt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(st.pixelRatio!==l.pixelRatio||$.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0))}const Ke=LR(ye.horizontal)||ye.vertical;l.iconsInText||(l.iconsInText=!!Ke&&Ke.iconsInText),(Ke||Me)&&GJ(l,re,ye,Me,f,W,Ae,0,Ne,Qe,S,j,M)}x&&l.generateCollisionDebugBuffers(A,l.collisionBoxArray)}function YT(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function GJ(l,a,u,f,g,x,S,j,A,M,$,V,W){let Y=x.textMaxSize.evaluate(a,{},V);Y===void 0&&(Y=S);const J=l.layers[0].layout,re=J.get("icon-offset").evaluate(a,{},V),le=LR(u.horizontal)||u.vertical,ge=W.name==="globe",Ae=Mi,ye=S/Ae,Te=l.tilePixelRatio*Y/Ae,Me=(ht=l.overscaling,l.zoom>18&&ht>2&&(ht>>=1),Math.max(tr/(512*ht),1)*J.get("symbol-spacing")),Ne=J.get("text-padding")*l.tilePixelRatio,Qe=J.get("icon-padding")*l.tilePixelRatio,Ke=ae(J.get("text-max-angle")),st=J.get("text-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",_t=J.get("icon-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",tt=J.get("symbol-placement"),dt=Me/2;var ht;const yt=J.get("icon-text-fit");let jt;f&&yt!=="none"&&(l.allowVerticalPlacement&&u.vertical&&(jt=ER(f,u.vertical,yt,J.get("icon-text-fit-padding"),re,ye)),le&&(f=ER(f,le,yt,J.get("icon-text-fit-padding"),re,ye)));const ot=(Ot,Vt,Dt)=>{if(Vt.x<0||Vt.x>=tr||Vt.y<0||Vt.y>=tr)return;let ur=null;if(ge){const{x:Ct,y:Yt,z:dr}=W.projectTilePoint(Vt.x,Vt.y,Dt);ur={anchor:new oc(Ct,Yt,dr,0,void 0),up:W.upVector(Dt,Vt.x,Vt.y)}}(function(Ct,Yt,dr,Or,hr,or,pn,gr,yr,nn,un,dn,on,Pn,Rn,Qn,an,ci,ei,kn,Rr,ti,hn,go,ri){const Ii=Ct.addToLineVertexArray(Yt,Or);let _i,yo,wi,As,jp,ov,av,gL=0,yL=0,vL=0,xL=0,hj=-1,fj=-1;const ml={};let bL=lT("");const bh=dr?dr.anchor:Yt;let pj=0,mj=0;if(yr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[pj,mj]=yr.layout.get("text-offset").evaluate(Rr,{},ri).map(Zo=>Zo*Mi):(pj=yr.layout.get("text-radial-offset").evaluate(Rr,{},ri)*Mi,mj=KT),Ct.allowVerticalPlacement&&hr.vertical){const Zo=hr.vertical;if(Rn)ov=JT(Zo),gr&&(av=JT(gr));else{const Ko=yr.layout.get("text-rotate").evaluate(Rr,{},ri)+90;wi=v_(nn,bh,Yt,un,dn,on,Zo,Pn,Ko,Qn),gr&&(As=v_(nn,bh,Yt,un,dn,on,gr,ci,Ko))}}if(or){const Zo=yr.layout.get("icon-rotate").evaluate(Rr,{},ri),Ko=yr.layout.get("icon-text-fit")!=="none",sv=IR(or,Zo,hn,Ko),yj=gr?IR(gr,Zo,hn,Ko):void 0;yo=v_(nn,bh,Yt,un,dn,on,or,ci,Zo),gL=4*sv.length;const _L=Ct.iconSizeData;let _h=null;_L.kind==="source"?(_h=[js*yr.layout.get("icon-size").evaluate(Rr,{},ri)],_h[0]>bu&&pt(`${Ct.layerIds[0]}: Value for "icon-size" is >= ${Yy}. Reduce your "icon-size".`)):_L.kind==="composite"&&(_h=[js*ti.compositeIconSizes[0].evaluate(Rr,{},ri),js*ti.compositeIconSizes[1].evaluate(Rr,{},ri)],(_h[0]>bu||_h[1]>bu)&&pt(`${Ct.layerIds[0]}: Value for "icon-size" is >= ${Yy}. Reduce your "icon-size".`)),Ct.addSymbols(Ct.icon,sv,_h,kn,ei,Rr,!1,dr,Yt,Ii.lineStartIndex,Ii.lineLength,-1,go,ri),hj=Ct.icon.placedSymbolArray.length-1,yj&&(yL=4*yj.length,Ct.addSymbols(Ct.icon,yj,_h,kn,ei,Rr,ga.vertical,dr,Yt,Ii.lineStartIndex,Ii.lineLength,-1,go,ri),fj=Ct.icon.placedSymbolArray.length-1)}for(const Zo in hr.horizontal){const Ko=hr.horizontal[Zo];_i||(bL=lT(Ko.text),Rn?jp=JT(Ko):_i=v_(nn,bh,Yt,un,dn,on,Ko,Pn,yr.layout.get("text-rotate").evaluate(Rr,{},ri),Qn));const sv=Ko.positionedLines.length===1;if(vL+=RR(Ct,dr,Yt,Ko,pn,yr,Rn,Rr,Qn,Ii,hr.vertical?ga.horizontal:ga.horizontalOnly,sv?Object.keys(hr.horizontal):[Zo],ml,hj,ti,go,ri),sv)break}hr.vertical&&(xL+=RR(Ct,dr,Yt,hr.vertical,pn,yr,Rn,Rr,Qn,Ii,ga.vertical,["vertical"],ml,fj,ti,go,ri));let ju=-1;const gj=(Zo,Ko)=>Zo?Math.max(Zo,Ko):Ko;ju=gj(jp,ju),ju=gj(ov,ju),ju=gj(av,ju);const bQ=ju>-1?1:0;Ct.glyphOffsetArray.length>=wu.MAX_GLYPHS&&pt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Rr.sortKey!==void 0&&Ct.addToSortKeyRanges(Ct.symbolInstances.length,Rr.sortKey),Ct.symbolInstances.emplaceBack(bh.x,bh.y,bh.z,Yt.x,Yt.y,ml.right>=0?ml.right:-1,ml.center>=0?ml.center:-1,ml.left>=0?ml.left:-1,ml.vertical>=0?ml.vertical:-1,hj,fj,bL,_i!==void 0?_i:Ct.collisionBoxArray.length,_i!==void 0?_i+1:Ct.collisionBoxArray.length,wi!==void 0?wi:Ct.collisionBoxArray.length,wi!==void 0?wi+1:Ct.collisionBoxArray.length,yo!==void 0?yo:Ct.collisionBoxArray.length,yo!==void 0?yo+1:Ct.collisionBoxArray.length,As||Ct.collisionBoxArray.length,As?As+1:Ct.collisionBoxArray.length,un,vL,xL,gL,yL,bQ,0,pj,mj,ju)})(l,Vt,ur,Ot,u,f,g,jt,l.layers[0],l.collisionBoxArray,a.index,a.sourceLayerIndex,l.index,Ne,st,A,0,Qe,_t,re,a,x,M,$,V)};if(tt==="line")for(const Ot of kR(a.geometry,0,0,tr,tr)){const Vt=BJ(Ot,Me,Ke,u.vertical||le,f,Ae,Te,l.overscaling,tr);for(const Dt of Vt)le&&HJ(l,le.text,dt,Dt)||ot(Ot,Dt,V)}else if(tt==="line-center"){for(const Ot of a.geometry)if(Ot.length>1){const Vt=LJ(Ot,Ke,u.vertical||le,f,Ae,Te);Vt&&ot(Ot,Vt,V)}}else if(a.type==="Polygon")for(const Ot of BT(a.geometry,0)){const Vt=UJ(Ot,16);ot(Ot[0],new oc(Vt.x,Vt.y,0,0,void 0),V)}else if(a.type==="LineString")for(const Ot of a.geometry)ot(Ot,new oc(Ot[0].x,Ot[0].y,0,0,void 0),V);else if(a.type==="Point")for(const Ot of a.geometry)for(const Vt of Ot)ot([Vt],new oc(Vt.x,Vt.y,0,0,void 0),V)}const Yy=255,bu=Yy*js;function RR(l,a,u,f,g,x,S,j,A,M,$,V,W,Y,J,re,le){const ge=function(Te,Me,Ne,Qe,Ke,st,_t,tt){const dt=[];if(Me.positionedLines.length===0)return dt;const ht=Qe.layout.get("text-rotate").evaluate(st,{})*Math.PI/180,yt=function(Dt){const ur=Dt[0],Ct=Dt[1],Yt=ur*Ct;return Yt>0?[ur,-Ct]:Yt<0?[-ur,Ct]:ur===0?[Ct,ur]:[Ct,-ur]}(Ne);let jt=Math.abs(Me.top-Me.bottom);for(const Dt of Me.positionedLines)jt-=Dt.lineOffset;const ot=Me.positionedLines.length,Ot=jt/ot;let Vt=Me.top-Ne[1];for(let Dt=0;Dt<ot;++Dt){const ur=Me.positionedLines[Dt];Vt=zJ(Me,Ot,Vt,Dt);for(const Ct of ur.positionedGlyphs){if(!Ct.rect)continue;const Yt=Ct.rect||{};let dr=gR+1,Or=!0,hr=1,or=0;if(Ct.imageName){const hn=_t[Ct.imageName];if(!hn)continue;if(hn.sdf){pt("SDF images are not supported in formatted text and will be ignored.");continue}Or=!1,hr=hn.pixelRatio,dr=ko/hr}const pn=(Ke||tt)&&Ct.vertical,gr=Ct.metrics.advance*Ct.scale/2,yr=Ct.metrics,nn=Ct.rect;if(nn===null)continue;tt&&Me.verticalizable&&(or=Ct.imageName?gr-Ct.metrics.width*Ct.scale/2:0);const un=Ke?[Ct.x+gr,Ct.y]:[0,0];let dn=[0,0],on=[0,0],Pn=!1;Ke||(pn?(on=[Ct.x+gr+yt[0],Ct.y+yt[1]-or],Pn=!0):dn=[Ct.x+gr+Ne[0],Ct.y+Ne[1]-or]);const Rn=nn.w*Ct.scale/(hr*(Ct.localGlyph?Cs:1)),Qn=nn.h*Ct.scale/(hr*(Ct.localGlyph?Cs:1));let an,ci,ei,kn;if(pn){const hn=Ct.y-Vt,go=new K(-gr,gr-hn),ri=-Math.PI/2,Ii=new K(...on);an=new K(-gr+dn[0],dn[1]),an._rotateAround(ri,go)._add(Ii),an.x+=-hn+gr,an.y-=(yr.left-dr)*Ct.scale;const _i=Ct.imageName?yr.advance*Ct.scale:Mi*Ct.scale,yo=String.fromCharCode(Ct.glyph);bJ(yo)?an.x+=(1-dr)*Ct.scale:_J(yo)?an.x+=_i-yr.height*Ct.scale+(-dr-1)*Ct.scale:an.x+=Ct.imageName||yr.width+2*dr===nn.w&&yr.height+2*dr===nn.h?(_i-Qn)/2:(_i-(yr.height+2*dr)*Ct.scale)/2,ci=new K(an.x,an.y-Rn),ei=new K(an.x+Qn,an.y),kn=new K(an.x+Qn,an.y-Rn)}else{const hn=(yr.left-dr)*Ct.scale-gr+dn[0],go=(-yr.top-dr)*Ct.scale+dn[1],ri=hn+Rn,Ii=go+Qn;an=new K(hn,go),ci=new K(ri,go),ei=new K(hn,Ii),kn=new K(ri,Ii)}if(ht){let hn;hn=Ke?new K(0,0):Pn?new K(yt[0],yt[1]):new K(Ne[0],Ne[1]),an._rotateAround(ht,hn),ci._rotateAround(ht,hn),ei._rotateAround(ht,hn),kn._rotateAround(ht,hn)}const Rr=new K(0,0),ti=new K(0,0);dt.push({tl:an,tr:ci,bl:ei,br:kn,tex:Yt,writingMode:Me.writingMode,glyphOffset:un,sectionIndex:Ct.sectionIndex,isSDF:Or,pixelOffsetTL:Rr,pixelOffsetBR:ti,minFontScaleX:0,minFontScaleY:0})}}return dt}(0,f,A,x,S,j,g,l.allowVerticalPlacement),Ae=l.textSizeData;let ye=null;Ae.kind==="source"?(ye=[js*x.layout.get("text-size").evaluate(j,{},le)],ye[0]>bu&&pt(`${l.layerIds[0]}: Value for "text-size" is >= ${Yy}. Reduce your "text-size".`)):Ae.kind==="composite"&&(ye=[js*J.compositeTextSizes[0].evaluate(j,{},le),js*J.compositeTextSizes[1].evaluate(j,{},le)],(ye[0]>bu||ye[1]>bu)&&pt(`${l.layerIds[0]}: Value for "text-size" is >= ${Yy}. Reduce your "text-size".`)),l.addSymbols(l.text,ge,ye,A,S,j,$,a,u,M.lineStartIndex,M.lineLength,Y,re,le);for(const Te of V)W[Te]=l.text.placedSymbolArray.length-1;return 4*ge.length}function LR(l){for(const a in l)return l[a];return null}function v_(l,a,u,f,g,x,S,j,A,M){let $=S.top,V=S.bottom,W=S.left,Y=S.right;const J=S.collisionPadding;if(J&&(W-=J[0],$-=J[1],Y+=J[2],V+=J[3]),A){const re=new K(W,$),le=new K(Y,$),ge=new K(W,V),Ae=new K(Y,V),ye=ae(A);let Te=new K(0,0);M&&(Te=new K(M[0],M[1])),re._rotateAround(ye,Te),le._rotateAround(ye,Te),ge._rotateAround(ye,Te),Ae._rotateAround(ye,Te),W=Math.min(re.x,le.x,ge.x,Ae.x),Y=Math.max(re.x,le.x,ge.x,Ae.x),$=Math.min(re.y,le.y,ge.y,Ae.y),V=Math.max(re.y,le.y,ge.y,Ae.y)}return l.emplaceBack(a.x,a.y,a.z,u.x,u.y,W,$,Y,V,j,f,g,x),l.length-1}function JT(l){l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const a=l.bottom-l.top;return a>0?Math.max(10,a):null}function HJ(l,a,u,f){const g=l.compareText;if(a in g){const x=g[a];for(let S=x.length-1;S>=0;S--)if(f.dist(x[S])<u)return!0}else g[a]=[];return g[a].push(f),!1}function BR(l,a){const u=l.fovAboveCenter,f=l.elevation?l.elevation.getMinElevationBelowMSL()*a:0,g=(l._camera.position[2]*l.worldSize-f)/Math.cos(l._pitch),x=Math.sin(u)*g/Math.sin(Math.max(Math.PI/2-l._pitch-u,.01)),S=Math.sin(l._pitch)*x+g;return Math.min(1.01*S,g*(1/l._horizonShift))}function vh(l,a){if(!a.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:a};const u=Math.pow(2,-l.z),f=l.x*u,g=(l.x+1)*u,x=l.y*u,S=(l.y+1)*u,j=ma(f),A=ma(g),M=qi(x),$=qi(S),V=a.project(j,M),W=a.project(A,M),Y=a.project(A,$),J=a.project(j,$);let re=Math.min(V.x,W.x,Y.x,J.x),le=Math.min(V.y,W.y,Y.y,J.y),ge=Math.max(V.x,W.x,Y.x,J.x),Ae=Math.max(V.y,W.y,Y.y,J.y);const ye=u/16;function Te(Ne,Qe,Ke,st,_t,tt){const dt=(Ke+_t)/2,ht=(st+tt)/2,yt=a.project(ma(dt),qi(ht)),jt=Math.max(0,re-yt.x,le-yt.y,yt.x-ge,yt.y-Ae);re=Math.min(re,yt.x),ge=Math.max(ge,yt.x),le=Math.min(le,yt.y),Ae=Math.max(Ae,yt.y),jt>ye&&(Te(Ne,yt,Ke,st,dt,ht),Te(yt,Qe,dt,ht,_t,tt))}Te(V,W,f,x,g,x),Te(W,Y,g,x,g,S),Te(Y,J,g,S,f,S),Te(J,V,f,S,f,x),re-=ye,le-=ye,ge+=ye,Ae+=ye;const Me=1/Math.max(ge-re,Ae-le);return{scale:Me,x:re*Me,y:le*Me,x2:ge*Me,y2:Ae*Me,projection:a}}const XJ=Ss(new Float32Array(16));class _u{constructor(a){this.spec=a,this.name=a.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(a,u){return{x:0,y:0,z:0}}unproject(a,u){return new rn(0,0)}projectTilePoint(a,u,f){return{x:a,y:u,z:0}}locationPoint(a,u,f=!0){return a._coordinatePoint(a.locationCoordinate(u),f)}pixelsPerMeter(a,u){return Ts(1,a)*u}pixelSpaceConversion(a,u,f){return 1}farthestPixelDistance(a){return BR(a,a.pixelsPerMeter)}pointCoordinate(a,u,f,g){const x=a.horizonLineFromTop(!1),S=new K(u,Math.max(x,f));return a.rayIntersectionCoordinate(a.pointRayIntersection(S,g))}pointCoordinate3D(a,u,f){const g=new K(u,f);if(a.elevation)return a.elevation.pointCoordinate(g);{const x=this.pointCoordinate(a,g.x,g.y,0);return[x.x,x.y,x.z]}}isPointAboveHorizon(a,u){if(a.elevation)return!this.pointCoordinate3D(a,u.x,u.y);const f=a.horizonLineFromTop();return u.y<f}createInversionMatrix(a,u){return XJ}createTileMatrix(a,u,f){let g,x,S;const j=f.canonical,A=Ss(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=vh(j,this);g=1,x=M.x+f.wrap*M.scale,S=M.y,dh(A,A,[g/M.scale,g/M.scale,a.pixelsPerMeter/u])}else g=u/a.zoomScale(j.z),x=(j.x+Math.pow(2,j.z)*f.wrap)*g,S=j.y*g;return Py(A,A,[x,S,0]),dh(A,A,[g/tr,g/tr,1]),A}upVector(a,u,f){return[0,0,1]}upVectorScale(a,u,f){return{metersToTile:1}}}class ZJ extends _u{constructor(a){super(a),this.range=[4,7],this.center=a.center||[-96,37.5];const[u,f]=this.parallels=a.parallels||[29.5,45.5],g=Math.sin(ae(u));this.n=(g+Math.sin(ae(f)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(a,u){const{n:f,c:g,r0:x}=this,S=ae(a-this.center[0]),j=ae(u),A=Math.sqrt(g-2*f*Math.sin(j))/f;return{x:A*Math.sin(S*f),y:A*Math.cos(S*f)-x,z:0}}unproject(a,u){const{n:f,c:g,r0:x}=this,S=x+u;let j=Math.atan2(a,Math.abs(S))*Math.sign(S);S*f<0&&(j-=Math.PI*Math.sign(a)*Math.sign(S));const A=ae(this.center[0])*f;j=Re(j,-Math.PI-A,Math.PI-A);const M=ve(_e(j/f)+this.center[0],-180,180),$=Math.asin(ve((g-(a*a+S*S)*f*f)/(2*f),-1,1)),V=ve(_e($),-Wi,Wi);return new rn(M,V)}}const Jy=1.340264,Qy=-.081106,ev=893e-6,tv=.003796,x_=Math.sqrt(3)/2;class KJ extends _u{project(a,u){u=u/180*Math.PI,a=a/180*Math.PI;const f=Math.asin(x_*Math.sin(u)),g=f*f,x=g*g*g;return{x:.5*(a*Math.cos(f)/(x_*(Jy+3*Qy*g+x*(7*ev+9*tv*g)))/Math.PI+.5),y:1-.5*(f*(Jy+Qy*g+x*(ev+tv*g))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,g=f*f,x=g*g*g;for(let $,V,W,Y=0;Y<12&&(V=f*(Jy+Qy*g+x*(ev+tv*g))-u,W=Jy+3*Qy*g+x*(7*ev+9*tv*g),$=V/W,f=ve(f-$,-Math.PI/3,Math.PI/3),g=f*f,x=g*g*g,!(Math.abs($)<1e-12));++Y);const S=x_*a*(Jy+3*Qy*g+x*(7*ev+9*tv*g))/Math.cos(f),j=Math.asin(Math.sin(f)/x_),A=ve(180*S/Math.PI,-180,180),M=ve(180*j/Math.PI,-Wi,Wi);return new rn(A,M)}}class YJ extends _u{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){return{x:.5+a/360,y:.5-u/360,z:0}}unproject(a,u){const f=360*(a-.5),g=ve(360*(.5-u),-Wi,Wi);return new rn(f,g)}}const Ep=Math.PI/2;function b_(l){return Math.tan((Ep+l)/2)}class JJ extends _u{constructor(a){super(a),this.center=a.center||[0,30];const[u,f]=this.parallels=a.parallels||[30,30];let g=ae(u),x=ae(f);this.southernCenter=g+x<0,this.southernCenter&&(g=-g,x=-x);const S=Math.cos(g),j=b_(g);this.n=g===x?Math.sin(g):Math.log(S/Math.cos(x))/Math.log(b_(x)/j),this.f=S*Math.pow(b_(g),this.n)/this.n}project(a,u){u=ae(u),this.southernCenter&&(u=-u),a=ae(a-this.center[0]);const f=1e-6,{n:g,f:x}=this;x>0?u<-Ep+f&&(u=-Ep+f):u>Ep-f&&(u=Ep-f);const S=x/Math.pow(b_(u),g);let j=S*Math.sin(g*a),A=x-S*Math.cos(g*a);return j=.5*(j/Math.PI+.5),A=.5*(A/Math.PI+.5),{x:j,y:this.southernCenter?A:1-A,z:0}}unproject(a,u){a=(2*a-.5)*Math.PI,this.southernCenter&&(u=1-u),u=(2*(1-u)-.5)*Math.PI;const{n:f,f:g}=this,x=g-u,S=Math.sign(x),j=Math.sign(f)*Math.sqrt(a*a+x*x);let A=Math.atan2(a,Math.abs(x))*S;x*f<0&&(A-=Math.PI*Math.sign(a)*S);const M=ve(_e(A/f)+this.center[0],-180,180),$=ve(_e(2*Math.atan(Math.pow(g/j,1/f))-Ep),-Wi,Wi);return new rn(M,this.southernCenter?-$:$)}}class zR extends _u{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(a,u){return{x:ul(a),y:dl(u),z:0}}unproject(a,u){const f=ma(a),g=qi(u);return new rn(f,g)}}const $R=ae(Wi);class QJ extends _u{project(a,u){const f=(u=ae(u))*u,g=f*f;return{x:.5*((a=ae(a))*(.8707-.131979*f+g*(g*(.003971*f-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(u*(1.007226+f*(.015085+g*(.028874*f-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,g=25,x=0,S=f*f;do{S=f*f;const M=S*S;x=(f*(1.007226+S*(.015085+M*(.028874*S-.044475-.005916*M)))-u)/(1.007226+S*(.045255+M*(.259866*S-.311325-.005916*11*M))),f=ve(f-x,-$R,$R)}while(Math.abs(x)>1e-6&&--g>0);S=f*f;const j=ve(_e(a/(.8707+S*(S*(S*S*S*(.003971-.001529*S)-.013791)-.131979))),-180,180),A=_e(f);return new rn(j,A)}}const FR=ae(Wi);class eQ extends _u{project(a,u){u=ae(u),a=ae(a);const f=Math.cos(u),g=2/Math.PI,x=Math.acos(f*Math.cos(a/2)),S=Math.sin(x)/x,j=.5*(a*g+2*f*Math.sin(a/2)/S)||0,A=.5*(u+Math.sin(u)/S)||0;return{x:.5*(j/Math.PI+.5),y:1-.5*(A/Math.PI+1),z:0}}unproject(a,u){let f=a=(2*a-.5)*Math.PI,g=u=(2*(1-u)-1)*Math.PI,x=25;const S=1e-6;let j=0,A=0;do{const M=Math.cos(g),$=Math.sin(g),V=2*$*M,W=$*$,Y=M*M,J=Math.cos(f/2),re=Math.sin(f/2),le=2*J*re,ge=re*re,Ae=1-Y*J*J,ye=Ae?1/Ae:0,Te=Ae?Math.acos(M*J)*Math.sqrt(1/Ae):0,Me=.5*(2*Te*M*re+2*f/Math.PI)-a,Ne=.5*(Te*$+g)-u,Qe=.5*ye*(Y*ge+Te*M*J*W)+1/Math.PI,Ke=ye*(le*V/4-Te*$*re),st=.125*ye*(V*re-Te*$*Y*le),_t=.5*ye*(W*J+Te*ge*M)+.5,tt=Ke*st-_t*Qe;j=(Ne*Ke-Me*_t)/tt,A=(Me*st-Ne*Qe)/tt,f=ve(f-j,-Math.PI,Math.PI),g=ve(g-A,-FR,FR)}while((Math.abs(j)>S||Math.abs(A)>S)&&--x>0);return new rn(_e(f),_e(g))}}class UR extends _u{constructor(a){super(a),this.center=a.center||[0,0],this.parallels=a.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ae(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){const{scale:f,cosPhi:g}=this;return{x:ae(a)*g*f+.5,y:-Math.sin(ae(u))/g*f+.5,z:0}}unproject(a,u){const{scale:f,cosPhi:g}=this,x=-(u-.5)/f,S=ve(_e((a-.5)/f)/g,-180,180),j=Math.asin(ve(x*g,-1,1)),A=ve(_e(j),-Wi,Wi);return new rn(S,A)}}class tQ extends zR{constructor(a){super(a),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(a,u,f){const g=Ry(a,u,f);return Vn(g,g,Ly(cl(f))),{x:g[0],y:g[1],z:g[2]}}locationPoint(a,u){const f=cp(u.lat,u.lng),g=fo([],f),x=a.elevation?a.elevation.getAtPointOrZero(a.locationCoordinate(u),a._centerAltitude):a._centerAltitude;My(f,f,g,Ts(1,0)*tr*x);const S=Ss(new Float64Array(16));return uh(S,a.pixelMatrix,a.globeMatrix),Vn(f,f,S),new K(f[0],f[1])}pixelsPerMeter(a,u){return Ts(1,0)*u}pixelSpaceConversion(a,u,f){const g=Ts(1,a)*u,x=kr(Ts(1,45)*u,g,f);return this.pixelsPerMeter(a,u)/x}createTileMatrix(a,u,f){const g=wT(cl(f.canonical));return uh(new Float64Array(16),a.globeMatrix,g)}createInversionMatrix(a,u){const{center:f}=a,g=Ly(cl(u));return X0(g,g,ae(f.lng)),hT(g,g,ae(f.lat)),dh(g,g,[a._pixelsPerMercatorPixel,a._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(a,u,f,g){return mD(a,u,f,!0)||new dp(0,0)}pointCoordinate3D(a,u,f){const g=this.pointCoordinate(a,u,f,0);return[g.x,g.y,g.z]}isPointAboveHorizon(a,u){return!mD(a,u.x,u.y,!1)}farthestPixelDistance(a){const u=function(g,x){const S=g.cameraToCenterDistance,j=g._centerAltitude*x,A=g._camera,M=g._camera.forward(),$=tc([],pa([],M,-S),[0,0,j]),V=g.worldSize/(2*Math.PI),W=[0,0,-V],Y=g.width/g.height,J=Math.tan(g.fovAboveCenter),re=pa([],A.up(),J),le=pa([],A.right(),J*Y),ge=fo([],tc([],tc([],M,re),le)),Ae=[];let ye;if(new gT($,ge).closestPointOnSphere(W,V,Ae)){const Te=tc([],Ae,W),Me=Es([],Te,$);ye=Math.cos(g.fovAboveCenter)*Ay(Me)}else{const Te=Es([],$,W),Me=Es([],W,$);fo(Me,Me);const Ne=Ay(Te)-V;ye=Math.sqrt(Ne*(Ne+2*V));const Qe=Math.acos(ye/(V+Ne))-Math.acos($a(M,Me));ye*=Math.cos(Qe)}return 1.01*ye}(a,this.pixelsPerMeter(a.center.lat,a.worldSize)),f=up(a.zoom);if(f>0){const g=BR(a,Ts(1,a.center.lat)*a.worldSize),x=a.worldSize/(2*Math.PI),S=Math.max(a.width,a.height)/a.worldSize*Math.PI;return kr(u,g+x*(1-Math.cos(S)),Math.pow(f,10))}return u}upVector(a,u,f){return Ry(u,f,a,1)}upVectorScale(a){return{metersToTile:Z0(Y0(cl(a)))}}}function VR(l){const a=l.parallels,u=!!a&&Math.abs(a[0]+a[1])<.01;switch(l.name){case"mercator":return new zR(l);case"equirectangular":return new YJ(l);case"naturalEarth":return new QJ(l);case"equalEarth":return new KJ(l);case"winkelTripel":return new eQ(l);case"albers":return u?new UR(l):new ZJ(l);case"lambertConformalConic":return u?new UR(l):new JJ(l);case"globe":return new tQ(l)}throw new Error(`Invalid projection name: ${l.name}`)}const rQ=s_.types,nQ=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function __(l,a,u,f,g,x,S,j,A,M,$,V,W){const Y=j?Math.min(bu,Math.round(j[0])):0,J=j?Math.min(bu,Math.round(j[1])):0;l.emplaceBack(a,u,Math.round(32*f),Math.round(32*g),x,S,(Y<<1)+(A?1:0),J,16*M,16*$,256*V,256*W)}function w_(l,a,u,f,g,x,S){l.emplaceBack(a,u,f,g,x,S)}function S_(l,a,u,f,g){l.emplaceBack(a,u,f,g),l.emplaceBack(a,u,f,g),l.emplaceBack(a,u,f,g),l.emplaceBack(a,u,f,g)}function iQ(l){for(const a of l.sections)if(sT(a.text))return!0;return!1}class QT{constructor(a){this.layoutVertexArray=new mt,this.indexArray=new Zt,this.programConfigurations=a,this.segments=new Yn,this.dynamicLayoutVertexArray=new xt,this.opacityVertexArray=new Kt,this.placedSymbolArray=new Kn,this.globeExtVertexArray=new St}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,u,f,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,hJ.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,pJ.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,nQ,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,fJ.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||g)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}zt(QT,"SymbolBuffers");class ej{constructor(a,u,f){this.layoutVertexArray=new a,this.layoutAttributes=u,this.indexArray=new f,this.segments=new Yn,this.collisionVertexArray=new Tr,this.collisionVertexArrayExt=new wr}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,mJ.members,!0),this.collisionVertexBufferExt=a.createVertexBuffer(this.collisionVertexArrayExt,gJ.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}zt(ej,"CollisionBuffers");class wu{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(S=>S.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ss([]),this.placementViewportMatrix=Ss([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=UT(this.zoom,u["text-size"]),this.iconSizeData=UT(this.zoom,u["icon-size"]);const f=this.layers[0].layout,g=f.get("symbol-sort-key"),x=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(S=>ga[S]),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=a.sourceID,this.projection=a.projection}createArrays(){this.text=new QT(new ch(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new QT(new ch(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new ho,this.lineVertexArray=new ip,this.symbolInstances=new mn}calculateGlyphDependencies(a,u,f,g,x){for(let S=0;S<a.length;S++)if(u[a.charCodeAt(S)]=!0,g&&x){const j=Xy[a.charAt(S)];j&&(u[j.charCodeAt(0)]=!0)}}populate(a,u,f,g){const x=this.layers[0],S=x.layout,j=this.projection.name==="globe",A=S.get("text-font"),M=S.get("text-field"),$=S.get("icon-image"),V=(M.value.kind!=="constant"||M.value.value instanceof uo&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),W=$.value.kind!=="constant"||!!$.value.value||Object.keys($.parameters).length>0,Y=S.get("symbol-sort-key");if(this.features=[],!V&&!W)return;const J=u.iconDependencies,re=u.glyphDependencies,le=u.availableImages,ge=new U(this.zoom);for(const{feature:Ae,id:ye,index:Te,sourceLayerIndex:Me}of a){const Ne=x._featureFilter.needGeometry,Qe=mh(Ae,Ne);if(!x._featureFilter.filter(ge,Qe,f))continue;if(Ne||(Qe.geometry=rc(Ae,f,g)),j&&Ae.type!==1&&f.z<=5){const tt=Qe.geometry,dt=.98078528056,ht=(yt,jt)=>$a(Ry(yt.x,yt.y,f,1),Ry(jt.x,jt.y,f,1))<dt;for(let yt=0;yt<tt.length;yt++)tt[yt]=pY(tt[yt],ht)}let Ke,st;if(V){const tt=x.getValueAndResolveTokens("text-field",Qe,f,le),dt=uo.factory(tt);iQ(dt)&&(this.hasRTLText=!0),(!this.hasRTLText||P()==="unavailable"||this.hasRTLText&&z.isParsed())&&(Ke=xJ(dt,x,Qe))}if(W){const tt=x.getValueAndResolveTokens("icon-image",Qe,f,le);st=tt instanceof Vo?tt:Vo.fromString(tt)}if(!Ke&&!st)continue;const _t=this.sortFeaturesByKey?Y.evaluate(Qe,{},f):void 0;if(this.features.push({id:ye,text:Ke,icon:st,index:Te,sourceLayerIndex:Me,geometry:Qe.geometry,properties:Ae.properties,type:rQ[Ae.type],sortKey:_t}),st&&(J[st.name]=!0),Ke){const tt=A.evaluate(Qe,{},f).join(","),dt=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ga.vertical)>=0;for(const ht of Ke.sections)if(ht.image)J[ht.image.name]=!0;else{const yt=_y(Ke.toString()),jt=ht.fontStack||tt,ot=re[jt]=re[jt]||{};this.calculateGlyphDependencies(ht.text,ot,dt,this.allowVerticalPlacement,yt)}}}S.get("symbol-placement")==="line"&&(this.features=function(Ae){const ye={},Te={},Me=[];let Ne=0;function Qe(tt){Me.push(Ae[tt]),Ne++}function Ke(tt,dt,ht){const yt=Te[tt];return delete Te[tt],Te[dt]=yt,Me[yt].geometry[0].pop(),Me[yt].geometry[0]=Me[yt].geometry[0].concat(ht[0]),yt}function st(tt,dt,ht){const yt=ye[dt];return delete ye[dt],ye[tt]=yt,Me[yt].geometry[0].shift(),Me[yt].geometry[0]=ht[0].concat(Me[yt].geometry[0]),yt}function _t(tt,dt,ht){const yt=ht?dt[0][dt[0].length-1]:dt[0][0];return`${tt}:${yt.x}:${yt.y}`}for(let tt=0;tt<Ae.length;tt++){const dt=Ae[tt],ht=dt.geometry,yt=dt.text?dt.text.toString():null;if(!yt){Qe(tt);continue}const jt=_t(yt,ht),ot=_t(yt,ht,!0);if(jt in Te&&ot in ye&&Te[jt]!==ye[ot]){const Ot=st(jt,ot,ht),Vt=Ke(jt,ot,Me[Ot].geometry);delete ye[jt],delete Te[ot],Te[_t(yt,Me[Vt].geometry,!0)]=Vt,Me[Ot].geometry=null}else jt in Te?Ke(jt,ot,ht):ot in ye?st(jt,ot,ht):(Qe(tt),ye[jt]=Ne-1,Te[ot]=Ne-1)}return Me.filter(tt=>tt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ae,ye)=>Ae.sortKey-ye.sortKey)}update(a,u,f,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,u,this.layers,f,g),this.icon.programConfigurations.updatePaintArrays(a,u,this.layers,f,g))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=VR(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,u){const f=this.lineVertexArray.length;if(a.segment!==void 0)for(const{x:g,y:x}of u)this.lineVertexArray.emplaceBack(g,x);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(a,u,f,g,x,S,j,A,M,$,V,W,Y,J){const re=a.indexArray,le=a.layoutVertexArray,ge=a.globeExtVertexArray,Ae=a.segments.prepareSegment(4*u.length,le,re,this.canOverlap?S.sortKey:void 0),ye=this.glyphOffsetArray.length,Te=Ae.vertexLength,Me=this.allowVerticalPlacement&&j===ga.vertical?Math.PI/2:0,Ne=S.text&&S.text.sections;for(let Ke=0;Ke<u.length;Ke++){const{tl:st,tr:_t,bl:tt,br:dt,tex:ht,pixelOffsetTL:yt,pixelOffsetBR:jt,minFontScaleX:ot,minFontScaleY:Ot,glyphOffset:Vt,isSDF:Dt,sectionIndex:ur}=u[Ke],Ct=Ae.vertexLength,Yt=Vt[1];if(__(le,M.x,M.y,st.x,Yt+st.y,ht.x,ht.y,f,Dt,yt.x,yt.y,ot,Ot),__(le,M.x,M.y,_t.x,Yt+_t.y,ht.x+ht.w,ht.y,f,Dt,jt.x,yt.y,ot,Ot),__(le,M.x,M.y,tt.x,Yt+tt.y,ht.x,ht.y+ht.h,f,Dt,yt.x,jt.y,ot,Ot),__(le,M.x,M.y,dt.x,Yt+dt.y,ht.x+ht.w,ht.y+ht.h,f,Dt,jt.x,jt.y,ot,Ot),A){const{x:dr,y:Or,z:hr}=A.anchor,[or,pn,gr]=A.up;w_(ge,dr,Or,hr,or,pn,gr),w_(ge,dr,Or,hr,or,pn,gr),w_(ge,dr,Or,hr,or,pn,gr),w_(ge,dr,Or,hr,or,pn,gr),S_(a.dynamicLayoutVertexArray,dr,Or,hr,Me)}else S_(a.dynamicLayoutVertexArray,M.x,M.y,M.z,Me);re.emplaceBack(Ct,Ct+1,Ct+2),re.emplaceBack(Ct+1,Ct+2,Ct+3),Ae.vertexLength+=4,Ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Vt[0]),Ke!==u.length-1&&ur===u[Ke+1].sectionIndex||a.programConfigurations.populatePaintArrays(le.length,S,S.index,{},Y,J,Ne&&Ne[ur])}const Qe=A?A.anchor:M;a.placedSymbolArray.emplaceBack(Qe.x,Qe.y,Qe.z,M.x,M.y,ye,this.glyphOffsetArray.length-ye,Te,$,V,M.segment,f?f[0]:0,f?f[1]:0,g[0],g[1],j,0,!1,0,W,0)}_commitLayoutVertex(a,u,f,g,x,S,j){a.emplaceBack(u,f,g,x,S,Math.round(j.x),Math.round(j.y))}_addCollisionDebugVertices(a,u,f,g,x,S,j){const A=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),M=A.vertexLength,$=j.tileAnchorX,V=j.tileAnchorY;for(let Y=0;Y<4;Y++)f.collisionVertexArray.emplaceBack(0,0,0,0);f.collisionVertexArrayExt.emplaceBack(u,-a.padding,-a.padding),f.collisionVertexArrayExt.emplaceBack(u,a.padding,-a.padding),f.collisionVertexArrayExt.emplaceBack(u,a.padding,a.padding),f.collisionVertexArrayExt.emplaceBack(u,-a.padding,a.padding),this._commitLayoutVertex(f.layoutVertexArray,g,x,S,$,V,new K(a.x1,a.y1)),this._commitLayoutVertex(f.layoutVertexArray,g,x,S,$,V,new K(a.x2,a.y1)),this._commitLayoutVertex(f.layoutVertexArray,g,x,S,$,V,new K(a.x2,a.y2)),this._commitLayoutVertex(f.layoutVertexArray,g,x,S,$,V,new K(a.x1,a.y2)),A.vertexLength+=4;const W=f.indexArray;W.emplaceBack(M,M+1),W.emplaceBack(M+1,M+2),W.emplaceBack(M+2,M+3),W.emplaceBack(M+3,M),A.primitiveLength+=4}_addTextDebugCollisionBoxes(a,u,f,g,x,S){for(let j=g;j<x;j++){const A=f.get(j),M=this.getSymbolInstanceTextSize(a,S,u,j);this._addCollisionDebugVertices(A,M,this.textCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,S)}}_addIconDebugCollisionBoxes(a,u,f,g,x,S){for(let j=g;j<x;j++){const A=f.get(j),M=this.getSymbolInstanceIconSize(a,u,S.placedIconSymbolIndex);this._addCollisionDebugVertices(A,M,this.iconCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,S)}}generateCollisionDebugBuffers(a,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ej(Ut,lR.members,bi),this.iconCollisionBox=new ej(Ut,lR.members,bi);const f=gp(this.iconSizeData,a),g=gp(this.textSizeData,a);for(let x=0;x<this.symbolInstances.length;x++){const S=this.symbolInstances.get(x);this._addTextDebugCollisionBoxes(g,a,u,S.textBoxStartIndex,S.textBoxEndIndex,S),this._addTextDebugCollisionBoxes(g,a,u,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S),this._addIconDebugCollisionBoxes(f,a,u,S.iconBoxStartIndex,S.iconBoxEndIndex,S),this._addIconDebugCollisionBoxes(f,a,u,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex,S)}}getSymbolInstanceTextSize(a,u,f,g){const x=this.text.placedSymbolArray.get(u.rightJustifiedTextSymbolIndex>=0?u.rightJustifiedTextSymbolIndex:u.centerJustifiedTextSymbolIndex>=0?u.centerJustifiedTextSymbolIndex:u.leftJustifiedTextSymbolIndex>=0?u.leftJustifiedTextSymbolIndex:u.verticalPlacedTextSymbolIndex>=0?u.verticalPlacedTextSymbolIndex:g),S=d_(this.textSizeData,a,x)/Mi;return this.tilePixelRatio*S}getSymbolInstanceIconSize(a,u,f){const g=this.icon.placedSymbolArray.get(f),x=d_(this.iconSizeData,a,g);return this.tilePixelRatio*x}_commitDebugCollisionVertexUpdate(a,u,f){a.emplaceBack(u,-f,-f),a.emplaceBack(u,f,-f),a.emplaceBack(u,f,f),a.emplaceBack(u,-f,f)}_updateTextDebugCollisionBoxes(a,u,f,g,x,S){for(let j=g;j<x;j++){const A=f.get(j),M=this.getSymbolInstanceTextSize(a,S,u,j);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,M,A.padding)}}_updateIconDebugCollisionBoxes(a,u,f,g,x,S){for(let j=g;j<x;j++){const A=f.get(j),M=this.getSymbolInstanceIconSize(a,u,S);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,M,A.padding)}}updateCollisionDebugBuffers(a,u){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=gp(this.iconSizeData,a),g=gp(this.textSizeData,a);for(let x=0;x<this.symbolInstances.length;x++){const S=this.symbolInstances.get(x);this._updateTextDebugCollisionBoxes(g,a,u,S.textBoxStartIndex,S.textBoxEndIndex,S),this._updateTextDebugCollisionBoxes(g,a,u,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S),this._updateIconDebugCollisionBoxes(f,a,u,S.iconBoxStartIndex,S.iconBoxEndIndex,S.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(f,a,u,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex,S.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(a,u,f,g,x,S,j,A,M){const $={};if(u<f){const{x1:V,y1:W,x2:Y,y2:J,padding:re,projectedAnchorX:le,projectedAnchorY:ge,projectedAnchorZ:Ae,tileAnchorX:ye,tileAnchorY:Te,featureIndex:Me}=a.get(u);$.textBox={x1:V,y1:W,x2:Y,y2:J,padding:re,projectedAnchorX:le,projectedAnchorY:ge,projectedAnchorZ:Ae,tileAnchorX:ye,tileAnchorY:Te},$.textFeatureIndex=Me}if(g<x){const{x1:V,y1:W,x2:Y,y2:J,padding:re,projectedAnchorX:le,projectedAnchorY:ge,projectedAnchorZ:Ae,tileAnchorX:ye,tileAnchorY:Te,featureIndex:Me}=a.get(g);$.verticalTextBox={x1:V,y1:W,x2:Y,y2:J,padding:re,projectedAnchorX:le,projectedAnchorY:ge,projectedAnchorZ:Ae,tileAnchorX:ye,tileAnchorY:Te},$.verticalTextFeatureIndex=Me}if(S<j){const{x1:V,y1:W,x2:Y,y2:J,padding:re,projectedAnchorX:le,projectedAnchorY:ge,projectedAnchorZ:Ae,tileAnchorX:ye,tileAnchorY:Te,featureIndex:Me}=a.get(S);$.iconBox={x1:V,y1:W,x2:Y,y2:J,padding:re,projectedAnchorX:le,projectedAnchorY:ge,projectedAnchorZ:Ae,tileAnchorX:ye,tileAnchorY:Te},$.iconFeatureIndex=Me}if(A<M){const{x1:V,y1:W,x2:Y,y2:J,padding:re,projectedAnchorX:le,projectedAnchorY:ge,projectedAnchorZ:Ae,tileAnchorX:ye,tileAnchorY:Te,featureIndex:Me}=a.get(A);$.verticalIconBox={x1:V,y1:W,x2:Y,y2:J,padding:re,projectedAnchorX:le,projectedAnchorY:ge,projectedAnchorZ:Ae,tileAnchorX:ye,tileAnchorY:Te},$.verticalIconFeatureIndex=Me}return $}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,u){const f=a.placedSymbolArray.get(u),g=f.vertexStartIndex+4*f.numGlyphs;for(let x=f.vertexStartIndex;x<g;x+=4)a.indexArray.emplaceBack(x,x+1,x+2),a.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(a),f=Math.cos(a),g=[],x=[],S=[];for(let j=0;j<this.symbolInstances.length;++j){S.push(j);const A=this.symbolInstances.get(j);g.push(0|Math.round(u*A.tileAnchorX+f*A.tileAnchorY)),x.push(A.featureIndex)}return S.sort((j,A)=>g[j]-g[A]||x[A]-x[j]),S}addToSortKeyRanges(a,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:x,leftJustifiedTextSymbolIndex:S,verticalPlacedTextSymbolIndex:j,placedIconSymbolIndex:A,verticalPlacedIconSymbolIndex:M}=f;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),x>=0&&x!==g&&this.addIndicesForPlacedSymbol(this.text,x),S>=0&&S!==x&&S!==g&&this.addIndicesForPlacedSymbol(this.text,S),j>=0&&this.addIndicesForPlacedSymbol(this.text,j),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}zt(wu,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),wu.MAX_GLYPHS=65535,wu.addDynamicAttributes=S_;const oQ=new we({"symbol-placement":new te(at.layout_symbol["symbol-placement"]),"symbol-spacing":new te(at.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new te(at.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ue(at.layout_symbol["symbol-sort-key"]),"symbol-z-order":new te(at.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new te(at.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new te(at.layout_symbol["icon-ignore-placement"]),"icon-optional":new te(at.layout_symbol["icon-optional"]),"icon-rotation-alignment":new te(at.layout_symbol["icon-rotation-alignment"]),"icon-size":new ue(at.layout_symbol["icon-size"]),"icon-text-fit":new te(at.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new te(at.layout_symbol["icon-text-fit-padding"]),"icon-image":new ue(at.layout_symbol["icon-image"]),"icon-rotate":new ue(at.layout_symbol["icon-rotate"]),"icon-padding":new te(at.layout_symbol["icon-padding"]),"icon-keep-upright":new te(at.layout_symbol["icon-keep-upright"]),"icon-offset":new ue(at.layout_symbol["icon-offset"]),"icon-anchor":new ue(at.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new te(at.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new te(at.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new te(at.layout_symbol["text-rotation-alignment"]),"text-field":new ue(at.layout_symbol["text-field"]),"text-font":new ue(at.layout_symbol["text-font"]),"text-size":new ue(at.layout_symbol["text-size"]),"text-max-width":new ue(at.layout_symbol["text-max-width"]),"text-line-height":new ue(at.layout_symbol["text-line-height"]),"text-letter-spacing":new ue(at.layout_symbol["text-letter-spacing"]),"text-justify":new ue(at.layout_symbol["text-justify"]),"text-radial-offset":new ue(at.layout_symbol["text-radial-offset"]),"text-variable-anchor":new te(at.layout_symbol["text-variable-anchor"]),"text-anchor":new ue(at.layout_symbol["text-anchor"]),"text-max-angle":new te(at.layout_symbol["text-max-angle"]),"text-writing-mode":new te(at.layout_symbol["text-writing-mode"]),"text-rotate":new ue(at.layout_symbol["text-rotate"]),"text-padding":new te(at.layout_symbol["text-padding"]),"text-keep-upright":new te(at.layout_symbol["text-keep-upright"]),"text-transform":new ue(at.layout_symbol["text-transform"]),"text-offset":new ue(at.layout_symbol["text-offset"]),"text-allow-overlap":new te(at.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new te(at.layout_symbol["text-ignore-placement"]),"text-optional":new te(at.layout_symbol["text-optional"])});var tj={paint:new we({"icon-opacity":new ue(at.paint_symbol["icon-opacity"]),"icon-color":new ue(at.paint_symbol["icon-color"]),"icon-halo-color":new ue(at.paint_symbol["icon-halo-color"]),"icon-halo-width":new ue(at.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ue(at.paint_symbol["icon-halo-blur"]),"icon-translate":new te(at.paint_symbol["icon-translate"]),"icon-translate-anchor":new te(at.paint_symbol["icon-translate-anchor"]),"text-opacity":new ue(at.paint_symbol["text-opacity"]),"text-color":new ue(at.paint_symbol["text-color"],{runtimeType:Po,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new ue(at.paint_symbol["text-halo-color"]),"text-halo-width":new ue(at.paint_symbol["text-halo-width"]),"text-halo-blur":new ue(at.paint_symbol["text-halo-blur"]),"text-translate":new te(at.paint_symbol["text-translate"]),"text-translate-anchor":new te(at.paint_symbol["text-translate-anchor"])}),layout:oQ};class qR{constructor(a){this.type=a.property.overrides?a.property.overrides.runtimeType:Jc,this.defaultValue=a}evaluate(a){if(a.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(a.formattedSection))return u.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}zt(qR,"FormatSectionOverride",{omit:["defaultValue"]});class E_ extends ws{constructor(a){super(a,tj)}recalculate(a,u){super.recalculate(a,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const g=[];for(const x of f)g.indexOf(x)<0&&g.push(x);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(a,u,f,g){const x=this.layout.get(a).evaluate(u,{},f,g),S=this._unevaluatedLayout._values[a];return S.isDataDriven()||uu(S.value)||!x?x:function(j,A){return A.replace(/{([^{}]+)}/g,(M,$)=>$ in j?String(j[$]):"")}(u.properties,x)}createBucket(a){return new wu(a)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const a of tj.paint.overridableProperties){if(!E_.hasPaintOverride(this.layout,a))continue;const u=this.paint.get(a),f=new qR(u),g=new Kf(f,u.property.specification);let x=null;x=u.value.kind==="constant"||u.value.kind==="source"?new uy("source",g):new eh("composite",g,u.value.zoomStops,u.value._interpolationType),this.paint._values[a]=new he(u.property,x,u.parameters)}}_handleOverridablePaintPropertyUpdate(a,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&E_.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,u){const f=a.get("text-field"),g=tj.paint.properties[u];let x=!1;const S=j=>{for(const A of j)if(g.overrides&&g.overrides.hasOverride(A))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof uo)S(f.value.value.sections);else if(f.value.kind==="source"){const j=M=>{x||(M instanceof ql&&Dn(M.value)===Ld?S(M.value.sections):M instanceof ol?S(M.sections):M.eachChild(j))},A=f.value;A._styleExpression&&j(A._styleExpression.expression)}return x}getProgramConfiguration(a){return new yu(this,a)}}var aQ={paint:new we({"background-color":new te(at.paint_background["background-color"]),"background-pattern":new te(at.paint_background["background-pattern"]),"background-opacity":new te(at.paint_background["background-opacity"])})},sQ={paint:new we({"raster-opacity":new te(at.paint_raster["raster-opacity"]),"raster-hue-rotate":new te(at.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new te(at.paint_raster["raster-brightness-min"]),"raster-brightness-max":new te(at.paint_raster["raster-brightness-max"]),"raster-saturation":new te(at.paint_raster["raster-saturation"]),"raster-contrast":new te(at.paint_raster["raster-contrast"]),"raster-resampling":new te(at.paint_raster["raster-resampling"]),"raster-fade-duration":new te(at.paint_raster["raster-fade-duration"])})};class lQ extends ws{constructor(a){super(a,{}),this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)}onRemove(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)}}var cQ={paint:new we({"sky-type":new te(at.paint_sky["sky-type"]),"sky-atmosphere-sun":new te(at.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new te(at.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new te(at.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new te(at.paint_sky["sky-gradient-radius"]),"sky-gradient":new be(at.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new te(at.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new te(at.paint_sky["sky-atmosphere-color"]),"sky-opacity":new te(at.paint_sky["sky-opacity"])})};function rj(l,a,u){const f=[0,0,1],g=cD([]);return dD(g,g,u?-ae(l)+Math.PI:ae(l)),uD(g,g,-ae(a)),oD(f,f,g),fo(f,f)}const uQ={circle:class extends ws{constructor(l){super(l,_Y)}createBucket(l){return new PT(l)}queryRadius(l){const a=l;return hp("circle-radius",this,a)+hp("circle-stroke-width",this,a)+e_(this.paint.get("circle-translate"))}queryIntersectsFeature(l,a,u,f,g,x,S,j){const A=ID(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,l.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(a,u)+this.paint.get("circle-stroke-width").evaluate(a,u);return OD(l,f,x,S,j,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",A,M)}getProgramIds(){return["circle"]}getProgramConfiguration(l){return new yu(this,l)}},heatmap:class extends ws{createBucket(l){return new RD(l)}constructor(l){super(l,TY),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=MT({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return hp("heatmap-radius",this,l)}queryIntersectsFeature(l,a,u,f,g,x,S,j){const A=this.paint.get("heatmap-radius").evaluate(a,u);return OD(l,f,x,S,j,!0,!0,new K(0,0),A)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(l){return new yu(this,l)}},hillshade:class extends ws{constructor(l){super(l,jY)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends ws{constructor(l){super(l,UY)}getProgramIds(){const l=this.paint.get("fill-pattern"),a=l&&l.constantOr(1),u=[a?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&u.push(a&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),u}getProgramConfiguration(l){return new yu(this,l)}recalculate(l,a){super.recalculate(l,a);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new o_(l)}queryRadius(){return e_(this.paint.get("fill-translate"))}queryIntersectsFeature(l,a,u,f,g,x){return!l.queryGeometry.isAboveHorizon&&PD(MD(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,l.pixelToTileUnitsFactor),f)}isTileClipped(){return!0}},"fill-extrusion":class extends ws{constructor(l){super(l,iJ)}createBucket(l){return new Wy(l)}queryRadius(){return e_(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(l){return new yu(this,l)}queryIntersectsFeature(l,a,u,f,g,x,S,j,A){const M=ID(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,l.pixelToTileUnitsFactor),$=this.paint.get("fill-extrusion-height").evaluate(a,u),V=this.paint.get("fill-extrusion-base").evaluate(a,u),W=[0,0],Y=j&&x.elevation,J=x.elevation?x.elevation.exaggeration():1,re=l.tile.getBucket(this);if(Y&&re instanceof Wy){const Te=re.centroidVertexArray,Me=A+1;Me<Te.length&&(W[0]=Te.geta_centroid_pos0(Me),W[1]=Te.geta_centroid_pos1(Me))}if(W[0]===0&&W[1]===1)return!1;x.projection.name==="globe"&&(f=eR([f],[new K(0,0),new K(tr,tr)],l.tileID.canonical).map(Te=>Te.polygon).flat());const le=Y?j:null,[ge,Ae]=function(Te,Me,Ne,Qe,Ke,st,_t,tt,dt,ht,yt){return Te.projection.name==="globe"?function(jt,ot,Ot,Vt,Dt,ur,Ct,Yt,dr,Or,hr){const or=[],pn=[],gr=jt.projection.upVectorScale(hr,jt.center.lat,jt.worldSize).metersToTile,yr=[0,0,0,1],nn=[0,0,0,1],un=(on,Pn,Rn,Qn)=>{on[0]=Pn,on[1]=Rn,on[2]=Qn,on[3]=1},dn=QD();Ot>0&&(Ot+=dn),Vt+=dn;for(const on of ot){const Pn=[],Rn=[];for(const Qn of on){const an=Qn.x+Dt.x,ci=Qn.y+Dt.y,ei=jt.projection.projectTilePoint(an,ci,hr),kn=jt.projection.upVector(hr,Qn.x,Qn.y);let Rr=Ot,ti=Vt;if(Ct){const hn=iR(an,ci,Ot,Vt,Ct,Yt,dr,Or);Rr+=hn.base,ti+=hn.top}Ot!==0?un(yr,ei.x+kn[0]*gr*Rr,ei.y+kn[1]*gr*Rr,ei.z+kn[2]*gr*Rr):un(yr,ei.x,ei.y,ei.z),un(nn,ei.x+kn[0]*gr*ti,ei.y+kn[1]*gr*ti,ei.z+kn[2]*gr*ti),Vn(yr,yr,ur),Vn(nn,nn,ur),Pn.push(new mp(yr[0],yr[1],yr[2])),Rn.push(new mp(nn[0],nn[1],nn[2]))}or.push(Pn),pn.push(Rn)}return[or,pn]}(Te,Me,Ne,Qe,Ke,st,_t,tt,dt,ht,yt):_t?function(jt,ot,Ot,Vt,Dt,ur,Ct,Yt,dr){const Or=[],hr=[],or=[0,0,0,1];for(const pn of jt){const gr=[],yr=[];for(const nn of pn){const un=nn.x+Vt.x,dn=nn.y+Vt.y,on=iR(un,dn,ot,Ot,ur,Ct,Yt,dr);or[0]=un,or[1]=dn,or[2]=on.base,or[3]=1,hh(or,or,Dt),or[3]=Math.max(or[3],1e-5);const Pn=new mp(or[0]/or[3],or[1]/or[3],or[2]/or[3]);or[0]=un,or[1]=dn,or[2]=on.top,or[3]=1,hh(or,or,Dt),or[3]=Math.max(or[3],1e-5);const Rn=new mp(or[0]/or[3],or[1]/or[3],or[2]/or[3]);gr.push(Pn),yr.push(Rn)}Or.push(gr),hr.push(yr)}return[Or,hr]}(Me,Ne,Qe,Ke,st,_t,tt,dt,ht):function(jt,ot,Ot,Vt,Dt){const ur=[],Ct=[],Yt=Dt[8]*ot,dr=Dt[9]*ot,Or=Dt[10]*ot,hr=Dt[11]*ot,or=Dt[8]*Ot,pn=Dt[9]*Ot,gr=Dt[10]*Ot,yr=Dt[11]*Ot;for(const nn of jt){const un=[],dn=[];for(const on of nn){const Pn=on.x+Vt.x,Rn=on.y+Vt.y,Qn=Dt[0]*Pn+Dt[4]*Rn+Dt[12],an=Dt[1]*Pn+Dt[5]*Rn+Dt[13],ci=Dt[2]*Pn+Dt[6]*Rn+Dt[14],ei=Dt[3]*Pn+Dt[7]*Rn+Dt[15],kn=Qn+Yt,Rr=an+dr,ti=ci+Or,hn=Math.max(ei+hr,1e-5),go=Qn+or,ri=an+pn,Ii=ci+gr,_i=Math.max(ei+yr,1e-5);un.push(new mp(kn/hn,Rr/hn,ti/hn)),dn.push(new mp(go/_i,ri/_i,Ii/_i))}ur.push(un),Ct.push(dn)}return[ur,Ct]}(Me,Ne,Qe,Ke,st)}(x,f,V,$,M,S,le,W,J,x.center.lat,l.tileID.canonical),ye=l.queryGeometry;return function(Te,Me,Ne){let Qe=1/0;PD(Ne,Me)&&(Qe=nR(Ne,Me[0]));for(let Ke=0;Ke<Me.length;Ke++){const st=Me[Ke],_t=Te[Ke];for(let tt=0;tt<st.length-1;tt++){const dt=st[tt],ht=[dt,st[tt+1],_t[tt+1],_t[tt],dt];CD(Ne,ht)&&(Qe=Math.min(Qe,nR(Ne,ht)))}}return Qe!==1/0&&Qe}(ge,Ae,ye.isPointQuery()?ye.screenBounds:ye.screenGeometry)}},line:class extends ws{constructor(l){super(l,oR),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const a=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=a._styleExpression&&a._styleExpression.expression instanceof Yg,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,a){super.recalculate(l,a),this.paint._values["line-floorwidth"]=aR.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new u_(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(l){return new yu(this,l)}queryRadius(l){const a=l,u=sR(hp("line-width",this,a),hp("line-gap-width",this,a)),f=hp("line-offset",this,a);return u/2+Math.abs(f)+e_(this.paint.get("line-translate"))}queryIntersectsFeature(l,a,u,f,g,x){if(l.queryGeometry.isAboveHorizon)return!1;const S=MD(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,l.pixelToTileUnitsFactor),j=l.pixelToTileUnitsFactor/2*sR(this.paint.get("line-width").evaluate(a,u),this.paint.get("line-gap-width").evaluate(a,u)),A=this.paint.get("line-offset").evaluate(a,u);return A&&(f=function(M,$){const V=[],W=new K(0,0);for(let Y=0;Y<M.length;Y++){const J=M[Y],re=[];for(let le=0;le<J.length;le++){const ge=J[le],Ae=J[le+1],ye=le===0?W:ge.sub(J[le-1])._unit()._perp(),Te=le===J.length-1?W:Ae.sub(ge)._unit()._perp(),Me=ye._add(Te)._unit();Me._mult(1/(Me.x*Te.x+Me.y*Te.y)),re.push(Me._mult($)._add(ge))}V.push(re)}return V}(f,A*l.pixelToTileUnitsFactor)),function(M,$,V){for(let W=0;W<$.length;W++){const Y=$[W];if(M.length>=3){for(let J=0;J<Y.length;J++)if(gh(M,Y[J]))return!0}if(yY(M,Y,V))return!0}return!1}(S,f,j)}isTileClipped(){return!0}},symbol:E_,background:class extends ws{constructor(l){super(l,aQ)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends ws{constructor(l){super(l,sQ)}getProgramIds(){return["raster"]}},sky:class extends ws{constructor(l){super(l,cQ),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=MT({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const a=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==a.azimuthal||this._lightPosition.polar!==a.polar}return!1}getCenter(l,a){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),g=!f,x=l.style.light,S=x.properties.get("position");return g&&x.properties.get("anchor")==="viewport"&&pt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?rj(S.azimuthal,90-S.polar,a):rj(f[0],90-f[1],a)}const u=this.paint.get("sky-gradient-center");return rj(u[0],90-u[1],a)}is3D(){return!1}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}}};class rv{constructor(a,u,f,g){this.context=a,this.format=f,this.texture=a.gl.createTexture(),this.update(u,g)}update(a,u,f){const{width:g,height:x}=a,{context:S}=this,{gl:j}=S,{HTMLImageElement:A,HTMLCanvasElement:M,HTMLVideoElement:$,ImageData:V,ImageBitmap:W}=p;if(j.bindTexture(j.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===j.RGBA&&(!u||u.premultiply!==!1)),f||this.size&&this.size[0]===g&&this.size[1]===x){const{x:Y,y:J}=f||{x:0,y:0};a instanceof A||a instanceof M||a instanceof $||a instanceof V||W&&a instanceof W?j.texSubImage2D(j.TEXTURE_2D,0,Y,J,j.RGBA,j.UNSIGNED_BYTE,a):j.texSubImage2D(j.TEXTURE_2D,0,Y,J,g,x,j.RGBA,j.UNSIGNED_BYTE,a.data)}else this.size=[g,x],a instanceof A||a instanceof M||a instanceof $||a instanceof V||W&&a instanceof W?j.texImage2D(j.TEXTURE_2D,0,this.format,this.format,j.UNSIGNED_BYTE,a):j.texImage2D(j.TEXTURE_2D,0,this.format,g,x,0,this.format,j.UNSIGNED_BYTE,a.data);this.useMipmap=!!(u&&u.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&j.generateMipmap(j.TEXTURE_2D)}bind(a,u){const{context:f}=this,{gl:g}=f;g.bindTexture(g.TEXTURE_2D,this.texture),a!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,a),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?a===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_NEAREST:a),this.filter=a),u!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,u),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class dQ{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class hQ{constructor(){this.tasks={},this.taskQueue=[],ft(["process"],this),this.invoker=new dQ(this.process),this.nextId=0}add(a,u){const f=this.nextId++,g=function({type:x,isSymbolTile:S,zoom:j}){return j=j||0,x==="message"?0:x!=="maybePrepare"||S?x!=="parseTile"||S?x==="parseTile"&&S?300-j:x==="maybePrepare"&&S?400-j:500:200-j:100-j}(u);if(g===0){Gr();try{a()}finally{}return{cancel:()=>{}}}return this.tasks[f]={fn:a,metadata:u,priority:g,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){Gr();try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const a=this.pick();if(a===null)return;const u=this.tasks[a];if(delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),!u)return;u.fn()}finally{}}pick(){let a=null,u=1/0;for(let g=0;g<this.taskQueue.length;g++){const x=this.tasks[this.taskQueue[g]];x.priority<u&&(u=x.priority,a=g)}if(a===null)return null;const f=this.taskQueue[a];return this.taskQueue.splice(a,1),f}remove(){this.invoker.remove()}}class WR{constructor(a){this._stringToNumber={},this._numberToString=[];for(let u=0;u<a.length;u++){const f=a[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(a){return this._stringToNumber[a]}decode(a){return this._numberToString[a]}}const fQ=["tile","layer","source","sourceLayer","state"];class GR{constructor(a,u,f,g,x){this.type="Feature",this._vectorTileFeature=a,this._z=u,this._x=f,this._y=g,this.properties=a.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(a.id=this.id);for(const u of fQ)this[u]!==void 0&&(a[u]=this[u]);return a}}const Va=32,hl=33,Su=new Uint16Array(8184);for(let l=0;l<2046;l++){let a=l+2,u=0,f=0,g=0,x=0,S=0,j=0;for(1&a?g=x=S=Va:u=f=j=Va;(a>>=1)>1;){const M=u+g>>1,$=f+x>>1;1&a?(g=u,x=f,u=S,f=j):(u=g,f=x,g=S,x=j),S=M,j=$}const A=4*l;Su[A+0]=u,Su[A+1]=f,Su[A+2]=g,Su[A+3]=x}const fl=new Uint16Array(2178),Eu=new Uint8Array(1089),T_=new Uint16Array(1089);function HR(l){return l===0?-.03125:l===32?.03125:0}var XR=Ue([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const ZR={type:2,extent:tr,loadGeometry:()=>[[new K(0,0),new K(tr+1,0),new K(tr+1,tr+1),new K(0,tr+1),new K(0,0)]]};class nj{constructor(a,u,f,g,x){this.tileID=a,this.uid=$t(),this.uses=0,this.tileSize=u,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=x,this.expiredRequestCount=0,this.state="loading",g&&g.transform&&(this.projection=g.transform.projection)}registerFadeDuration(a){const u=a+this.timeAdded;u<us.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=vh(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(a,u,f){if(this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(g,x){const S={};if(!x)return S;for(const j of g){const A=j.layerIds.map(M=>x.getLayer(M)).filter(Boolean);if(A.length!==0){j.layers=A,j.stateDependentLayerIds&&(j.stateDependentLayers=j.stateDependentLayerIds.map(M=>A.filter($=>$.id===M)[0]));for(const M of A)S[M.id]=j}}return S}(a.buckets,u.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const x=this.buckets[g];if(x instanceof wu){if(this.hasSymbolBuckets=!0,!f)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const x=this.buckets[g];if(x instanceof wu&&x.hasRTLText){this.hasRTLText=!0,z.isLoading()||z.isLoaded()||P()!=="deferred"||L();break}}this.queryPadding=0;for(const g in this.buckets){const x=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(g).queryRadius(x))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas)}else this.collisionBoxArray=new tn}unloadVectorData(){if(this.hasData()){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(a){return this.buckets[a.id]}upload(a){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(a)}const u=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new rv(a,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new rv(a,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new rv(a,this.lineAtlas.image,u.ALPHA),this.lineAtlas.uploaded=!0)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,u,f,g,x,S,j,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:g,pixelPosMatrix:j,transform:S,params:x,tileTransform:this.tileTransform},a,u,f):{}}querySourceFeatures(a,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),x=u?u.sourceLayer:"",S=g._geojsonTileLayer||g[x];if(!S)return;const j=ep(u&&u.filter),{z:A,x:M,y:$}=this.tileID.canonical,V={z:A,x:M,y:$};for(let W=0;W<S.length;W++){const Y=S.feature(W);if(j.needGeometry){const le=mh(Y,!0);if(!j.filter(new U(this.tileID.overscaledZ),le,this.tileID.canonical))continue}else if(!j.filter(new U(this.tileID.overscaledZ),Y))continue;const J=f.getId(Y,x),re=new GR(Y,A,M,$,J);re.tile=V,a.push(re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const u=this.expirationTime;if(a.cacheControl){const f=ln(a.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(u)if(this.expirationTime<u)g=!0;else{const x=this.expirationTime-u;x?this.expirationTime=f+Math.max(x,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(a,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(a).length===0||!u)return;const f=this.latestFeatureIndex.loadVTLayers(),g=u.style.listImages();for(const x in this.buckets){if(!u.style.hasLayer(x))continue;const S=this.buckets[x],j=S.layers[0].sourceLayer||"_geojsonTileLayer",A=f[j],M=a[j];if(!A||!M||Object.keys(M).length===0)continue;if(S.update(M,A,g,this.imageAtlas&&this.imageAtlas.patternPositions||{}),S instanceof u_||S instanceof o_){const V=u.style._getSourceCache(S.layers[0].source);u._terrain&&u._terrain.enabled&&V&&S.programConfigurations.needsUpload&&u._terrain._clearRenderCacheForTile(V.id,this.tileID)}const $=u&&u.style&&u.style.getLayer(x);$&&(this.queryPadding=Math.max(this.queryPadding,$.queryRadius(S)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<us.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=us.now()+a}setTexture(a,u){const f=u.context,g=f.gl;this.texture=this.texture||u.getTileTexture(a.width),this.texture?this.texture.update(a,{useMipmap:!0}):(this.texture=new rv(f,a,g.RGBA,{useMipmap:!0}),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE))}setDependencies(a,u){const f={};for(const g of u)f[g]=!0;this.dependencies[a]=f}hasDependency(a,u){for(const f of a){const g=this.dependencies[f];if(g){for(const x of u)if(g[x])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(a,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const f=rc(ZR,this.tileID.canonical,this.tileTransform)[0],g=new bt,x=new Go;for(let S=0;S<f.length;S++){const{x:j,y:A}=f[S];g.emplaceBack(j,A),x.emplaceBack(S)}x.emplaceBack(0),this._tileDebugIndexBuffer=a.createIndexBuffer(x),this._tileDebugBuffer=a.createVertexBuffer(g,Oy.members),this._tileDebugSegments=Yn.simpleSegment(0,0,g.length,x.length)}_makeTileBoundsBuffers(a,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const f=rc(ZR,this.tileID.canonical,this.tileTransform)[0];let g,x;if(this.isRaster){const S=function(j,A){const M=vh(j,A),$=Math.pow(2,j.z);for(let le=0;le<hl;le++)for(let ge=0;ge<hl;ge++){const Ae=ma((j.x+(ge+HR(ge))/Va)/$),ye=qi((j.y+(le+HR(le))/Va)/$),Te=A.project(Ae,ye),Me=le*hl+ge;fl[2*Me+0]=Math.round((Te.x*M.scale-M.x)*tr),fl[2*Me+1]=Math.round((Te.y*M.scale-M.y)*tr)}Eu.fill(0),T_.fill(0);for(let le=2045;le>=0;le--){const ge=4*le,Ae=Su[ge+0],ye=Su[ge+1],Te=Su[ge+2],Me=Su[ge+3],Ne=Ae+Te>>1,Qe=ye+Me>>1,Ke=Ne+Qe-ye,st=Qe+Ae-Ne,_t=ye*hl+Ae,tt=Me*hl+Te,dt=Qe*hl+Ne,ht=Math.hypot((fl[2*_t+0]+fl[2*tt+0])/2-fl[2*dt+0],(fl[2*_t+1]+fl[2*tt+1])/2-fl[2*dt+1])>=16;Eu[dt]=Eu[dt]||(ht?1:0),le<1022&&(Eu[dt]=Eu[dt]||Eu[(ye+st>>1)*hl+(Ae+Ke>>1)]||Eu[(Me+st>>1)*hl+(Te+Ke>>1)])}const V=new ut,W=new Zt;let Y=0;function J(le,ge){const Ae=ge*hl+le;return T_[Ae]===0&&(V.emplaceBack(fl[2*Ae+0],fl[2*Ae+1],le*tr/Va,ge*tr/Va),T_[Ae]=++Y),T_[Ae]-1}function re(le,ge,Ae,ye,Te,Me){const Ne=le+Ae>>1,Qe=ge+ye>>1;if(Math.abs(le-Te)+Math.abs(ge-Me)>1&&Eu[Qe*hl+Ne])re(Te,Me,le,ge,Ne,Qe),re(Ae,ye,Te,Me,Ne,Qe);else{const Ke=J(le,ge),st=J(Ae,ye),_t=J(Te,Me);W.emplaceBack(Ke,st,_t)}}return re(0,0,Va,Va,Va,0),re(Va,Va,0,0,0,Va),{vertices:V,indices:W}}(this.tileID.canonical,u);g=S.vertices,x=S.indices}else{g=new ut,x=new Zt;for(const{x:j,y:A}of f)g.emplaceBack(j,A,0,0);const S=LT(g.int16,void 0,4);for(let j=0;j<S.length;j+=3)x.emplaceBack(S[j],S[j+1],S[j+2])}this._tileBoundsBuffer=a.createVertexBuffer(g,XR.members),this._tileBoundsIndexBuffer=a.createIndexBuffer(x),this._tileBoundsSegments=Yn.simpleSegment(0,0,g.length,x.length)}_makeGlobeTileDebugBuffers(a,u){const f=u.projection;if(!f||f.name!=="globe"||u.freezeTileCoverage)return;const g=this.tileID.canonical,x=Ly(gD(g,u)),S=up(u.zoom);let j;S>0&&(j=dT(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(a,g,u,x,j,S),this._makeGlobeTileDebugTextBuffer(a,g,u,x,j,S)}_globePoint(a,u,f,g,x,S,j){let A=Ry(a,u,f);if(S){const M=1<<f.z,$=ul(g.center.lng),V=dl(g.center.lat),W=(f.x+.5)/M-$;let Y=0;W>.5?Y=-1:W<-.5&&(Y=1);let J=(a/tr+f.x)/M+Y,re=(u/tr+f.y)/M;J=(J-$)*g._pixelsPerMercatorPixel+$,re=(re-V)*g._pixelsPerMercatorPixel+V;const le=[J*g.worldSize,re*g.worldSize,0];Vn(le,le,S),A=ph(A,le,j)}return Vn(A,A,x)}_makeGlobeTileDebugBorderBuffer(a,u,f,g,x,S){const j=new bt,A=new Go,M=new Ze,$=(W,Y,J,re,le)=>{const ge=(J-W)/(le-1),Ae=(re-Y)/(le-1),ye=j.length;for(let Te=0;Te<le;Te++){const Me=W+Te*ge,Ne=Y+Te*Ae;j.emplaceBack(Me,Ne);const Qe=this._globePoint(Me,Ne,u,f,g,x,S);M.emplaceBack(Qe[0],Qe[1],Qe[2]),A.emplaceBack(ye+Te)}},V=tr;$(0,0,V,0,16),$(V,0,V,V,16),$(V,V,0,V,16),$(0,V,0,0,16),this._tileDebugIndexBuffer=a.createIndexBuffer(A),this._tileDebugBuffer=a.createVertexBuffer(j,Oy.members),this._globeTileDebugBorderBuffer=a.createVertexBuffer(M,fD.members),this._tileDebugSegments=Yn.simpleSegment(0,0,j.length,A.length)}_makeGlobeTileDebugTextBuffer(a,u,f,g,x,S){const j=tr/4,A=new bt,M=new Zt,$=new Ze,V=25;M.reserve(32),A.reserve(V),$.reserve(V);const W=(Y,J)=>V*Y+J;for(let Y=0;Y<V;Y++){const J=Y*j;for(let re=0;re<V;re++){const le=re*j;A.emplaceBack(le,J);const ge=this._globePoint(le,J,u,f,g,x,S);$.emplaceBack(ge[0],ge[1],ge[2])}}for(let Y=0;Y<4;Y++)for(let J=0;J<4;J++){const re=W(Y,J),le=W(Y,J+1),ge=W(Y+1,J),Ae=W(Y+1,J+1);M.emplaceBack(re,le,ge),M.emplaceBack(ge,le,Ae)}this._tileDebugTextIndexBuffer=a.createIndexBuffer(M),this._tileDebugTextBuffer=a.createVertexBuffer(A,Oy.members),this._globeTileDebugTextBuffer=a.createVertexBuffer($,fD.members),this._tileDebugTextSegments=Yn.simpleSegment(0,0,V,32)}}class pQ{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,u,f){const g=String(u);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][g]=this.stateChanges[a][g]||{},Ge(this.stateChanges[a][g],f),this.deletedStates[a]===null){this.deletedStates[a]={};for(const x in this.state[a])x!==g&&(this.deletedStates[a][x]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][g]===null){this.deletedStates[a][g]={};for(const x in this.state[a][g])f[x]||(this.deletedStates[a][g][x]=null)}else for(const x in f)this.deletedStates[a]&&this.deletedStates[a][g]&&this.deletedStates[a][g][x]===null&&delete this.deletedStates[a][g][x]}removeFeatureState(a,u,f){if(this.deletedStates[a]===null)return;const g=String(u);if(this.deletedStates[a]=this.deletedStates[a]||{},f&&u!==void 0)this.deletedStates[a][g]!==null&&(this.deletedStates[a][g]=this.deletedStates[a][g]||{},this.deletedStates[a][g][f]=null);else if(u!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][g])for(f in this.deletedStates[a][g]={},this.stateChanges[a][g])this.deletedStates[a][g][f]=null;else this.deletedStates[a][g]=null;else this.deletedStates[a]=null}getState(a,u){const f=String(u),g=Ge({},(this.state[a]||{})[f],(this.stateChanges[a]||{})[f]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){const x=this.deletedStates[a][u];if(x===null)return{};for(const S in x)delete g[S]}return g}initializeTileState(a,u){a.setFeatureState(this.state,u)}coalesceChanges(a,u){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const x={};for(const S in this.stateChanges[g])this.state[g][S]||(this.state[g][S]={}),Ge(this.state[g][S],this.stateChanges[g][S]),x[S]=this.state[g][S];f[g]=x}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const x={};if(this.deletedStates[g]===null)for(const S in this.state[g])x[S]={},this.state[g][S]={};else for(const S in this.deletedStates[g]){if(this.deletedStates[g][S]===null)this.state[g][S]={};else if(this.state[g][S])for(const j of Object.keys(this.deletedStates[g][S]))delete this.state[g][S][j];x[S]=this.state[g][S]}f[g]=f[g]||{},Ge(f[g],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in a)a[g].setFeatureState(f,u)}}class KR{constructor(a){this.size=a,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(a,u){const f=this.toIdx(a,u);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(a,u){return this.leaves[this.toIdx(a,u)]}toIdx(a,u){return u*this.size+a}}function YR(l,a,u,f){let g=0,x=Number.MAX_VALUE;for(let S=0;S<3;S++)if(Math.abs(f[S])<1e-15){if(u[S]<l[S]||u[S]>a[S])return null}else{const j=1/f[S];let A=(l[S]-u[S])*j,M=(a[S]-u[S])*j;if(A>M){const $=A;A=M,M=$}if(A>g&&(g=A),M<x&&(x=M),g>x)return null}return g}function JR(l,a,u,f,g,x,S,j,A,M,$){const V=f-l,W=g-a,Y=x-u,J=S-l,re=j-a,le=A-u,ge=$[1]*le-$[2]*re,Ae=$[2]*J-$[0]*le,ye=$[0]*re-$[1]*J,Te=V*ge+W*Ae+Y*ye;if(Math.abs(Te)<1e-15)return null;const Me=1/Te,Ne=M[0]-l,Qe=M[1]-a,Ke=M[2]-u,st=(Ne*ge+Qe*Ae+Ke*ye)*Me;if(st<0||st>1)return null;const _t=Qe*Y-Ke*W,tt=Ke*V-Ne*Y,dt=Ne*W-Qe*V,ht=($[0]*_t+$[1]*tt+$[2]*dt)*Me;return ht<0||st+ht>1?null:(J*_t+re*tt+le*dt)*Me}function QR(l,a,u){return(l-a)/(u-a)}function eL(l,a,u,f,g,x,S,j,A){const M=1<<u,$=x-f,V=S-g,W=(l+1)/M*$+f,Y=(a+0)/M*V+g,J=(a+1)/M*V+g;j[0]=(l+0)/M*$+f,j[1]=Y,A[0]=W,A[1]=J}class tL{constructor(a){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=a,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const u=function(x){const S=Math.ceil(Math.log2(x.dim/8)),j=[];let A=Math.ceil(Math.pow(2,S));const M=1/A,$=(Y,J,re,le,ge)=>{const Ae=le?1:0,ye=(Y+1)*re-Ae,Te=J*re,Me=(J+1)*re-Ae;ge[0]=Y*re,ge[1]=Te,ge[2]=ye,ge[3]=Me};let V=new KR(A);const W=[];for(let Y=0;Y<A*A;Y++){$(Y%A,Math.floor(Y/A),M,!1,W);const J=Tu(W[0],W[1],x),re=Tu(W[2],W[1],x),le=Tu(W[2],W[3],x),ge=Tu(W[0],W[3],x);V.minimums.push(Math.min(J,re,le,ge)),V.maximums.push(Math.max(J,re,le,ge)),V.leaves.push(1)}for(j.push(V),A/=2;A>=1;A/=2){const Y=j[j.length-1];V=new KR(A);for(let J=0;J<A*A;J++){$(J%A,Math.floor(J/A),2,!0,W);const re=Y.getElevation(W[0],W[1]),le=Y.getElevation(W[2],W[1]),ge=Y.getElevation(W[2],W[3]),Ae=Y.getElevation(W[0],W[3]),ye=Y.isLeaf(W[0],W[1]),Te=Y.isLeaf(W[2],W[1]),Me=Y.isLeaf(W[2],W[3]),Ne=Y.isLeaf(W[0],W[3]),Qe=Math.min(re.min,le.min,ge.min,Ae.min),Ke=Math.max(re.max,le.max,ge.max,Ae.max),st=ye&&Te&&Me&&Ne;V.maximums.push(Ke),V.minimums.push(Qe),V.leaves.push(Ke-Qe<=5&&st?1:0)}j.push(V)}return j}(this.dem),f=u.length-1,g=u[f];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(u,0,0,f,0)}raycastRoot(a,u,f,g,x,S,j=1){return YR([a,u,-100],[f,g,this.maximums[0]*j],x,S)}raycast(a,u,f,g,x,S,j=1){if(!this.nodeCount)return null;const A=this.raycastRoot(a,u,f,g,x,S,j);if(A==null)return null;const M=[],$=[],V=[],W=[],Y=[{idx:0,t:A,nodex:0,nodey:0,depth:0}];for(;Y.length>0;){const{idx:J,t:re,nodex:le,nodey:ge,depth:Ae}=Y.pop();if(this.leaves[J]){eL(le,ge,Ae,a,u,f,g,V,W);const Te=1<<Ae,Me=(le+0)/Te,Ne=(le+1)/Te,Qe=(ge+0)/Te,Ke=(ge+1)/Te,st=Tu(Me,Qe,this.dem)*j,_t=Tu(Ne,Qe,this.dem)*j,tt=Tu(Ne,Ke,this.dem)*j,dt=Tu(Me,Ke,this.dem)*j,ht=JR(V[0],V[1],st,W[0],V[1],_t,W[0],W[1],tt,x,S),yt=JR(W[0],W[1],tt,V[0],W[1],dt,V[0],V[1],st,x,S),jt=Math.min(ht!==null?ht:Number.MAX_VALUE,yt!==null?yt:Number.MAX_VALUE);if(jt!==Number.MAX_VALUE)return jt;{const ot=My([],x,S,re);if(rL(st,_t,dt,tt,QR(ot[0],V[0],W[0]),QR(ot[1],V[1],W[1]))>=ot[2])return re}continue}let ye=0;for(let Te=0;Te<this._siblingOffset.length;Te++){eL((le<<1)+this._siblingOffset[Te][0],(ge<<1)+this._siblingOffset[Te][1],Ae+1,a,u,f,g,V,W),V[2]=-100,W[2]=this.maximums[this.childOffsets[J]+Te]*j;const Me=YR(V,W,x,S);if(Me!=null){const Ne=Me;M[Te]=Ne;let Qe=!1;for(let Ke=0;Ke<ye&&!Qe;Ke++)Ne>=M[$[Ke]]&&($.splice(Ke,0,Te),Qe=!0);Qe||($[ye]=Te),ye++}}for(let Te=0;Te<ye;Te++){const Me=$[Te];Y.push({idx:this.childOffsets[J]+Me,t:M[Me],nodex:(le<<1)+this._siblingOffset[Me][0],nodey:(ge<<1)+this._siblingOffset[Me][1],depth:Ae+1})}}return null}_addNode(a,u,f){return this.minimums.push(a),this.maximums.push(u),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(a,u,f,g,x){if(a[g].isLeaf(u,f)===1)return;this.childOffsets[x]||(this.childOffsets[x]=this.nodeCount);const S=g-1,j=a[S];let A=0,M=0;for(let $=0;$<this._siblingOffset.length;$++){const V=2*u+this._siblingOffset[$][0],W=2*f+this._siblingOffset[$][1],Y=j.getElevation(V,W),J=j.isLeaf(V,W),re=this._addNode(Y.min,Y.max,J);J&&(A|=1<<$),M||(M=re)}for(let $=0;$<this._siblingOffset.length;$++)A&1<<$||this._construct(a,2*u+this._siblingOffset[$][0],2*f+this._siblingOffset[$][1],S,M+$)}}function rL(l,a,u,f,g,x){return kr(kr(l,u,x),kr(a,f,x),g)}function Tu(l,a,u){const f=u.dim,g=ve(l*f-.5,0,f-1),x=ve(a*f-.5,0,f-1),S=Math.floor(g),j=Math.floor(x),A=Math.min(S+1,f-1),M=Math.min(j+1,f-1);return rL(u.get(S,j),u.get(A,j),u.get(S,M),u.get(A,M),g-S,x-j)}const nL={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function mQ(l,a,u){return(256*l*256+256*a+u)/10-1e4}function gQ(l,a,u){return 256*l+a+u/256-32768}class j_{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(a,u,f,g=!1,x=!1){if(this.uid=a,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return pt(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const S=this.dim=u.height-2,j=new Uint32Array(u.data.buffer);if(this.pixels=new Uint8Array(u.data.buffer),this.encoding=f||"mapbox",this.borderReady=g,!g){for(let A=0;A<S;A++)j[this._idx(-1,A)]=j[this._idx(0,A)],j[this._idx(S,A)]=j[this._idx(S-1,A)],j[this._idx(A,-1)]=j[this._idx(A,0)],j[this._idx(A,S)]=j[this._idx(A,S-1)];j[this._idx(-1,-1)]=j[this._idx(0,0)],j[this._idx(S,-1)]=j[this._idx(S-1,0)],j[this._idx(-1,S)]=j[this._idx(0,S-1)],j[this._idx(S,S)]=j[this._idx(S-1,S-1)],x&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new tL(this)}get(a,u,f=!1){f&&(a=ve(a,-1,this.dim),u=ve(u,-1,this.dim));const g=4*this._idx(a,u);return(this.encoding==="terrarium"?gQ:mQ)(this.pixels[g],this.pixels[g+1],this.pixels[g+2])}static getUnpackVector(a){return nL[a]}get unpackVector(){return nL[this.encoding]}_idx(a,u){if(a<-1||a>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(a+1)}static pack(a,u){const f=[0,0,0,0],g=j_.getUnpackVector(u);let x=Math.floor((a+g[3])/g[2]);return f[2]=x%256,x=Math.floor(x/256),f[1]=x%256,x=Math.floor(x/256),f[0]=x,f}getPixels(){return new Xo({width:this.stride,height:this.stride},this.pixels)}backfillBorder(a,u,f){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let g=u*this.dim,x=u*this.dim+this.dim,S=f*this.dim,j=f*this.dim+this.dim;switch(u){case-1:g=x-1;break;case 1:x=g+1}switch(f){case-1:S=j-1;break;case 1:j=S+1}const A=-u*this.dim,M=-f*this.dim;for(let $=S;$<j;$++)for(let V=g;V<x;V++){const W=4*this._idx(V,$),Y=4*this._idx(V+A,$+M);this.pixels[W+0]=a.pixels[Y+0],this.pixels[W+1]=a.pixels[Y+1],this.pixels[W+2]=a.pixels[Y+2],this.pixels[W+3]=a.pixels[Y+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}zt(j_,"DEMData"),zt(tL,"DemMinMaxQuadTree",{omit:["dem"]});class yQ{constructor(a,u){this.max=a,this.onRemove=u,this.reset()}reset(){for(const a in this.data)for(const u of this.data[a])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(a,u,f){const g=a.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const x={value:u,timeout:void 0};if(f!==void 0&&(x.timeout=setTimeout(()=>{this.remove(a,x)},f)),this.data[g].push(x),this.order.push(g),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const u=this.data[a].shift();return u.timeout&&clearTimeout(u.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),u.value}getByKey(a){const u=this.data[a];return u?u[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,u){if(!this.has(a))return this;const f=a.wrapped().key,g=u===void 0?0:this.data[f].indexOf(u),x=this.data[f][g];return this.data[f].splice(g,1),x.timeout&&clearTimeout(x.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(x.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(a){const u=[];for(const f in this.data)for(const g of this.data[f])a(g.value)||u.push(g);for(const f of u)this.remove(f.value.tileID,f)}}class Tp{constructor(a,u,f){this.func=a,this.mask=u,this.range=f}}Tp.ReadOnly=!1,Tp.ReadWrite=!0,Tp.disabled=new Tp(519,Tp.ReadOnly,[0,1]);const ij=7680;class oj{constructor(a,u,f,g,x,S){this.test=a,this.ref=u,this.mask=f,this.fail=g,this.depthFail=x,this.pass=S}}oj.disabled=new oj({func:519,mask:0},0,0,ij,ij,ij);class pl{constructor(a,u,f){this.blendFunction=a,this.blendColor=u,this.mask=f}}pl.Replace=[1,0],pl.disabled=new pl(pl.Replace,Un.transparent,[!1,!1,!1,!1]),pl.unblended=new pl(pl.Replace,Un.transparent,[!0,!0,!0,!0]),pl.alphaBlended=new pl([1,771],Un.transparent,[!0,!0,!0,!0]);const aj=1029,sj=2305;class Ps{constructor(a,u,f){this.enable=a,this.mode=u,this.frontFace=f}}Ps.disabled=new Ps(!1,aj,sj),Ps.backCCW=new Ps(!0,aj,sj),Ps.backCW=new Ps(!0,aj,2304),Ps.frontCW=new Ps(!0,1028,2304),Ps.frontCCW=new Ps(!0,1028,sj);class xh extends Rd{constructor(a,u,f){super(),this.id=a,this._onlySymbols=f,u.on("data",g=>{g.dataType==="source"&&g.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&g.dataType==="source"&&g.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new yQ(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new pQ,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(a){this.map=a,this._minTileCacheSize=this._minTileCacheSize===void 0&&a?a._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&a?a._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles){const u=this._tiles[a];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,u){return a.isSymbolTile=this._onlySymbols,this._source.loadTile(a,u)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a,()=>{})}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(a),f.prepare(this.map.style.imageManager)}}getIds(){return Fe(this._tiles).map(a=>a.tileID).sort(iL).map(a=>a.key)}getRenderableIds(a){const u=[];for(const f in this._tiles)this._isIdRenderable(+f,a)&&u.push(this._tiles[f]);return a?u.sort((f,g)=>{const x=f.tileID,S=g.tileID,j=new K(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),A=new K(S.canonical.x,S.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-S.overscaledZ||A.y-j.y||A.x-j.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(iL).map(f=>f.key)}hasRenderableParent(a){const u=this.findLoadedParent(a,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(a,u){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(u||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(+a,"reloading")}}_reloadTile(a,u){const f=this._tiles[a];f&&(f.state!=="loading"&&(f.state=u),this._loadTile(f,this._tileLoaded.bind(this,f,a,u)))}_tileLoaded(a,u,f,g){if(g)if(a.state="errored",g.status!==404)this._source.fire(new ds(g,{tile:a}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const x=this.map.painter.terrain;this.update(this.transform,x.getScaledDemTileSize(),!0),x.resetTileLookupCache(this.id)}else this.update(this.transform);else a.timeAdded=us.now(),f==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(u,a),this._source.type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new Ul("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id}))}_backfillDEM(a){const u=this.getRenderableIds();for(let g=0;g<u.length;g++){const x=u[g];if(a.neighboringTiles&&a.neighboringTiles[x]){const S=this.getTileByID(x);f(a,S),f(S,a)}}function f(g,x){if(!g.dem||g.dem.borderReady)return;g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0;let S=x.tileID.canonical.x-g.tileID.canonical.x;const j=x.tileID.canonical.y-g.tileID.canonical.y,A=Math.pow(2,g.tileID.canonical.z),M=x.tileID.key;S===0&&j===0||Math.abs(j)>1||(Math.abs(S)>1&&(Math.abs(S+A)===1?S+=A:Math.abs(S-A)===1&&(S-=A)),x.dem&&g.dem&&(g.dem.backfillBorder(x.dem,S,j),g.neighboringTiles&&g.neighboringTiles[M]&&(g.neighboringTiles[M].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,u,f,g){for(const x in this._tiles){let S=this._tiles[x];if(g[x]||!S.hasData()||S.tileID.overscaledZ<=u||S.tileID.overscaledZ>f)continue;let j=S.tileID;for(;S&&S.tileID.overscaledZ>u+1;){const M=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[M.key],S&&S.hasData()&&(j=M)}let A=j;for(;A.overscaledZ>u;)if(A=A.scaledTo(A.overscaledZ-1),a[A.key]){g[j.key]=j;break}}}findLoadedParent(a,u){if(a.key in this._loadedParentTiles){const f=this._loadedParentTiles[a.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=a.overscaledZ-1;f>=u;f--){const g=a.scaledTo(f),x=this._getLoadedTile(g);if(x)return x}}_getLoadedTile(a){const u=this._tiles[a.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,u){u=u||this._source.tileSize;const f=Math.ceil(a.width/u)+1,g=Math.ceil(a.height/u)+1,x=Math.floor(f*g*5),S=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,x):x,j=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(j)}handleWrapJump(a){const u=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,u){const f={};for(const g in this._tiles){const x=this._tiles[g];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+u),f[x.tileID.key]=x}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(+g,this._tiles[g])}}update(a,u,f){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;let g;this.updateCacheSize(a,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new mo(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(g=a.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(g=g.filter(j=>this._source.hasTile(j)))):g=[];const x=this._updateRetainedTiles(g);if(oL(this._source.type)&&g.length!==0){const j={},A={},M=Object.keys(x);for(const V of M){const W=x[V],Y=this._tiles[V];if(!Y||Y.fadeEndTime&&Y.fadeEndTime<=us.now())continue;const J=this.findLoadedParent(W,Math.max(W.overscaledZ-xh.maxOverzooming,this._source.minzoom));J&&(this._addTile(J.tileID),j[J.tileID.key]=J.tileID),A[V]=W}const $=g[g.length-1].overscaledZ;for(const V in this._tiles){const W=this._tiles[V];if(x[V]||!W.hasData())continue;let Y=W.tileID;for(;Y.overscaledZ>$;){Y=Y.scaledTo(Y.overscaledZ-1);const J=this._tiles[Y.key];if(J&&J.hasData()&&A[Y.key]){x[V]=W.tileID;break}}}for(const V in j)x[V]||(this._coveredTiles[V]=!0,x[V]=j[V])}for(const j in x)this._tiles[j].clearFadeHold();const S=function(j,A){const M=[];for(const $ in j)$ in A||M.push($);return M}(this._tiles,x);for(const j of S){const A=this._tiles[j];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(+j)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){const u={};if(a.length===0)return u;const f={},g=a.reduce((M,$)=>Math.min(M,$.overscaledZ),1/0),x=a[0].overscaledZ,S=Math.max(x-xh.maxOverzooming,this._source.minzoom),j=Math.max(x+xh.maxUnderzooming,this._source.minzoom),A={};for(const M of a){const $=this._addTile(M);u[M.key]=M,$.hasData()||g<this._source.maxzoom&&(A[M.key]=M)}this._retainLoadedChildren(A,g,j,u);for(const M of a){let $=this._tiles[M.key];if($.hasData())continue;if(M.canonical.z>=this._source.maxzoom){const W=M.children(this._source.maxzoom)[0],Y=this.getTile(W);if(Y&&Y.hasData()){u[W.key]=W;continue}}else{const W=M.children(this._source.maxzoom);if(u[W[0].key]&&u[W[1].key]&&u[W[2].key]&&u[W[3].key])continue}let V=$.wasRequested();for(let W=M.overscaledZ-1;W>=S;--W){const Y=M.scaledTo(W);if(f[Y.key]||(f[Y.key]=!0,$=this.getTile(Y),!$&&V&&($=this._addTile(Y)),$&&(u[Y.key]=Y,V=$.wasRequested(),$.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const u=[];let f,g=this._tiles[a].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}u.push(g.key);const x=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(x),f)break;g=x}for(const x of u)this._loadedParentTiles[x]=f}}_addTile(a){let u=this._tiles[a.key];if(u)return u;u=this._cache.getAndRemove(a),u&&(this._setTileReloadTimer(a.key,u),u.tileID=a,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,u)));const f=!!u;if(!f){const g=this.map?this.map.painter:null;u=new nj(a,this._source.tileSize*a.overscaleFactor(),this.transform.tileZoom,g,this._isRaster),this._loadTile(u,this._tileLoaded.bind(this,u,a.key,u.state))}return u?(u.uses++,this._tiles[a.key]=u,f||this._source.fire(new Ul("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null}_setTileReloadTimer(a,u){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const f=u.getExpiryTimeout();f&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},f))}_removeTile(a){const u=this._tiles[a];u&&(u.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(+a);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(a,u,f){const g=[],x=this.transform;if(!x)return g;const S=x.projection.name==="globe",j=ul(x.center.lng);for(const A in this._tiles){const M=this._tiles[A];if(f&&M.clearQueryDebugViz(),M.holdingForFade())continue;let $;if(S){const V=M.tileID.canonical;if(V.z===0){const W=[Math.abs(ve(j,...nv(V,-1))-j),Math.abs(ve(j,...nv(V,1))-j)];$=[0,2*W.indexOf(Math.min(...W))-1]}else{const W=[Math.abs(ve(j,...nv(V,-1))-j),Math.abs(ve(j,...nv(V,0))-j),Math.abs(ve(j,...nv(V,1))-j)];$=[W.indexOf(Math.min(...W))-1]}}else $=[0];for(const V of $){const W=a.containsTile(M,x,u,V);W&&g.push(W)}}return g}getVisibleCoordinates(a){const u=this.getRenderableIds(a).map(f=>this._tiles[f].tileID);for(const f of u)f.projMatrix=this.transform.calculateProjMatrix(f.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(oL(this._source.type))for(const a in this._tiles){const u=this._tiles[a];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=us.now())return!0}return!1}setFeatureState(a,u,f){this._state.updateState(a=a||"_geojsonTileLayer",u,f)}removeFeatureState(a,u,f){this._state.removeFeatureState(a=a||"_geojsonTileLayer",u,f)}getFeatureState(a,u){return this._state.getState(a=a||"_geojsonTileLayer",u)}setDependencies(a,u,f){const g=this._tiles[a];g&&g.setDependencies(u,f)}reloadTilesForDependencies(a,u){for(const f in this._tiles)this._tiles[f].hasDependency(a,u)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(a,u))}_preloadTiles(a,u){if(!this._sourceLoaded){const j=()=>{this._sourceLoaded&&(this._source.off("data",j),this._preloadTiles(a,u))};return void this._source.on("data",j)}const f=new Map,g=Array.isArray(a)?a:[a],x=this.map.painter.terrain,S=this.usedForTerrain&&x?x.getScaledDemTileSize():this._source.tileSize;for(const j of g){const A=j.coveringTiles({tileSize:S,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const M of A)f.set(M.key,M);this.usedForTerrain&&j.updateElevation(!1)}Be(Array.from(f.values()),(j,A)=>{const M=new nj(j,this._source.tileSize*j.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(M,$=>{this._source.type==="raster-dem"&&M.dem&&this._backfillDEM(M),A($,M)})},u)}}function iL(l,a){const u=Math.abs(2*l.wrap)-+(l.wrap<0),f=Math.abs(2*a.wrap)-+(a.wrap<0);return l.overscaledZ-a.overscaledZ||f-u||a.canonical.y-l.canonical.y||a.canonical.x-l.canonical.x}function oL(l){return l==="raster"||l==="image"||l==="video"||l==="custom"}function nv(l,a){const u=1<<l.z;return[l.x/u+a,(l.x+1)/u+a]}xh.maxOverzooming=10,xh.maxUnderzooming=3;class C_{constructor(a,u,f){this._demTile=a,this._dem=this._demTile.dem,this._scale=u,this._offset=f}static create(a,u,f){const g=f||a.findDEMTileFor(u);if(!g||!g.dem)return;const x=g.dem,S=g.tileID,j=1<<u.canonical.z-S.canonical.z;return new C_(g,g.tileSize/tr/j,[(u.canonical.x/j-S.canonical.x)*x.dim,(u.canonical.y/j-S.canonical.y)*x.dim])}tileCoordToPixel(a,u){const f=u*this._scale+this._offset[1],g=Math.floor(a*this._scale+this._offset[0]),x=Math.floor(f);return new K(g,x)}getElevationAt(a,u,f,g){const x=a*this._scale+this._offset[0],S=u*this._scale+this._offset[1],j=Math.floor(x),A=Math.floor(S),M=this._dem;return g=!!g,f?kr(kr(M.get(j,A,g),M.get(j,A+1,g),S-A),kr(M.get(j+1,A,g),M.get(j+1,A+1,g),S-A),x-j):M.get(j,A,g)}getElevationAtPixel(a,u,f){return this._dem.get(a,u,!!f)}getMeterToDEM(a){return(1<<this._demTile.tileID.canonical.z)*Ts(1,a)*this._dem.stride}}class aL{constructor(a,u){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Zl(tr,16,0),this.featureIndexArray=new sh,this.promoteId=u}insert(a,u,f,g,x,S=0){const j=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,g,x,S);const A=this.grid;for(let M=0;M<u.length;M++){const $=u[M],V=[1/0,1/0,-1/0,-1/0];for(let W=0;W<$.length;W++){const Y=$[W];V[0]=Math.min(V[0],Y.x),V[1]=Math.min(V[1],Y.y),V[2]=Math.max(V[2],Y.x),V[3]=Math.max(V[3],Y.y)}V[0]<tr&&V[1]<tr&&V[2]>=0&&V[3]>=0&&A.insert(j,V[0],V[1],V[2],V[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new FT(new f_(this.rawTileData)).layers,this.sourceLayerCoder=new WR(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const a in this.vtLayers)this.vtFeatures[a]=[]}return this.vtLayers}query(a,u,f,g){this.loadVTLayers();const x=a.params||{},S=ep(x.filter),j=a.tileResult,A=a.transform,M=j.bufferedTilespaceBounds,$=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(J,re,le,ge)=>ND(j.bufferedTilespaceGeometry,J,re,le,ge));$.sort(vQ);let V=null;A.elevation&&$.length>0&&(V=C_.create(A.elevation,this.tileID));const W={};let Y;for(let J=0;J<$.length;J++){const re=$[J];if(re===Y)continue;Y=re;const le=this.featureIndexArray.get(re);let ge=null;this.loadMatchingFeature(W,le,S,x.layers,x.availableImages,u,f,g,(Ae,ye,Te,Me=0)=>(ge||(ge=rc(Ae,this.tileID.canonical,a.tileTransform)),ye.queryIntersectsFeature(j,Ae,Te,ge,this.z,a.transform,a.pixelPosMatrix,V,Me)))}return W}loadMatchingFeature(a,u,f,g,x,S,j,A,M){const{featureIndex:$,bucketIndex:V,sourceLayerIndex:W,layoutVertexArrayOffset:Y}=u,J=this.bucketLayerIDs[V];if(g&&!function(Ae,ye){for(let Te=0;Te<Ae.length;Te++)if(ye.indexOf(Ae[Te])>=0)return!0;return!1}(g,J))return;const re=this.sourceLayerCoder.decode(W),le=this.vtLayers[re].feature($);if(f.needGeometry){const Ae=mh(le,!0);if(!f.filter(new U(this.tileID.overscaledZ),Ae,this.tileID.canonical))return}else if(!f.filter(new U(this.tileID.overscaledZ),le))return;const ge=this.getId(le,re);for(let Ae=0;Ae<J.length;Ae++){const ye=J[Ae];if(g&&g.indexOf(ye)<0)continue;const Te=S[ye];if(!Te)continue;let Me={};ge!==void 0&&A&&(Me=A.getState(Te.sourceLayer||"_geojsonTileLayer",ge));const Ne=Ge({},j[ye]);Ne.paint=sL(Ne.paint,Te.paint,le,Me,x),Ne.layout=sL(Ne.layout,Te.layout,le,Me,x);const Qe=!M||M(le,Te,Me,Y);if(!Qe)continue;const Ke=new GR(le,this.z,this.x,this.y,ge);Ke.layer=Ne;let st=a[ye];st===void 0&&(st=a[ye]=[]),st.push({featureIndex:$,feature:Ke,intersectionZ:Qe})}}lookupSymbolFeatures(a,u,f,g,x,S,j,A){const M={};this.loadVTLayers();const $=ep(x);for(const V of a)this.loadMatchingFeature(M,{bucketIndex:f,sourceLayerIndex:g,featureIndex:V,layoutVertexArrayOffset:0},$,S,j,A,u);return M}loadFeature(a){const{featureIndex:u,sourceLayerIndex:f}=a;this.loadVTLayers();const g=this.sourceLayerCoder.decode(f),x=this.vtFeatures[g];if(x[u])return x[u];const S=this.vtLayers[g].feature(u);return x[u]=S,S}hasLayer(a){for(const u of this.bucketLayerIDs)for(const f of u)if(a===f)return!0;return!1}getId(a,u){let f=a.id;if(this.promoteId){const g=typeof this.promoteId=="string"?this.promoteId:this.promoteId[u];g!=null&&(f=a.properties[g]),typeof f=="boolean"&&(f=Number(f))}return f}}function sL(l,a,u,f,g){return lt(l,(x,S)=>{const j=a instanceof me?a.get(S):null;return j&&j.evaluate?j.evaluate(u,f,g):j})}function vQ(l,a){return a-l}zt(aL,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class lL{constructor(a,u){this.width=a,this.height=u,this.nextRow=0,this.image=new nc({width:a,height:u}),this.positions={},this.uploaded=!1}getDash(a,u){const f=this.getKey(a,u);return this.positions[f]}trim(){const a=this.width,u=this.height=Nt(this.nextRow);this.image.resize({width:a,height:u})}getKey(a,u){return a.join(",")+u}getDashRanges(a,u,f){const g=[];let x=a.length%2==1?-a[a.length-1]*f:0,S=a[0]*f,j=!0;g.push({left:x,right:S,isDash:j,zeroLength:a[0]===0});let A=a[0];for(let M=1;M<a.length;M++){j=!j;const $=a[M];x=A*f,A+=$,S=A*f,g.push({left:x,right:S,isDash:j,zeroLength:$===0})}return g}addRoundDash(a,u,f){const g=u/2;for(let x=-f;x<=f;x++){const S=this.width*(this.nextRow+f+x);let j=0,A=a[j];for(let M=0;M<this.width;M++){M/A.right>1&&(A=a[++j]);const $=Math.abs(M-A.left),V=Math.abs(M-A.right),W=Math.min($,V);let Y;const J=x/f*(g+1);if(A.isDash){const re=g-Math.abs(J);Y=Math.sqrt(W*W+re*re)}else Y=g-Math.sqrt(W*W+J*J);this.image.data[S+M]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(a,u){for(let A=a.length-1;A>=0;--A){const M=a[A],$=a[A+1];M.zeroLength?a.splice(A,1):$&&$.isDash===M.isDash&&($.left=M.left,a.splice(A,1))}const f=a[0],g=a[a.length-1];f.isDash===g.isDash&&(f.left=g.left-this.width,g.right=f.right+this.width);const x=this.width*this.nextRow;let S=0,j=a[S];for(let A=0;A<this.width;A++){A/j.right>1&&(j=a[++S]);const M=Math.abs(A-j.left),$=Math.abs(A-j.right),V=Math.min(M,$);this.image.data[x+A]=Math.max(0,Math.min(255,(j.isDash?V:-V)+u+128))}}addDash(a,u){const f=this.getKey(a,u);if(this.positions[f])return this.positions[f];const g=u==="round",x=g?7:0,S=2*x+1;if(this.nextRow+S>this.height)return pt("LineAtlas out of space"),null;a.length===0&&a.push(1);let j=0;for(let $=0;$<a.length;$++)a[$]<0&&(pt("Negative value is found in line dasharray, replacing values with 0"),a[$]=0),j+=a[$];if(j!==0){const $=this.width/j,V=this.getDashRanges(a,this.width,$);g?this.addRoundDash(V,$,x):this.addRegularDash(V,u==="square"?.5*$:0)}const A=this.nextRow+x;this.nextRow+=S;const M={tl:[A,x],br:[j,0]};return this.positions[f]=M,M}}zt(lL,"LineAtlas");const cL=1*Cs;class uL{constructor(a){const u={},f=[];for(const j in a){const A=a[j],M=u[j]={};for(const $ in A.glyphs){const V=A.glyphs[+$];if(!V||V.bitmap.width===0||V.bitmap.height===0)continue;const W=V.metrics.localGlyph?cL:1,Y={x:0,y:0,w:V.bitmap.width+2*W,h:V.bitmap.height+2*W};f.push(Y),M[$]=Y}}const{w:g,h:x}=WT(f),S=new nc({width:g||1,height:x||1});for(const j in a){const A=a[j];for(const M in A.glyphs){const $=A.glyphs[+M];if(!$||$.bitmap.width===0||$.bitmap.height===0)continue;const V=u[j][M],W=$.metrics.localGlyph?cL:1;nc.copy($.bitmap,S,{x:0,y:0},{x:V.x+W,y:V.y+W},$.bitmap)}}this.image=S,this.positions=u}}zt(uL,"GlyphAtlas");class xQ{constructor(a){this.tileID=new mo(a.tileID.overscaledZ,a.tileID.wrap,a.tileID.canonical.z,a.tileID.canonical.x,a.tileID.canonical.y),this.tileZoom=a.tileZoom,this.uid=a.uid,this.zoom=a.zoom,this.canonical=a.tileID.canonical,this.pixelRatio=a.pixelRatio,this.tileSize=a.tileSize,this.source=a.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=a.showCollisionBoxes,this.collectResourceTiming=!!a.collectResourceTiming,this.returnDependencies=!!a.returnDependencies,this.promoteId=a.promoteId,this.enableTerrain=!!a.enableTerrain,this.isSymbolTile=a.isSymbolTile,this.tileTransform=vh(a.tileID.canonical,a.projection),this.projection=a.projection}parse(a,u,f,g,x){this.status="parsing",this.data=a,this.collisionBoxArray=new tn;const S=new WR(Object.keys(a.layers).sort()),j=new aL(this.tileID,this.promoteId);j.bucketLayerIDs=[];const A={},M=new lL(256,256),$={featureIndex:j,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:M,availableImages:f},V=u.familiesBySource[this.source];for(const Me in V){const Ne=a.layers[Me];if(!Ne)continue;let Qe=!1,Ke=!1;for(const tt of V[Me])tt[0].type==="symbol"?Qe=!0:Ke=!0;if(this.isSymbolTile===!0&&!Qe||this.isSymbolTile===!1&&!Ke)continue;Ne.version===1&&pt(`Vector tile source "${this.source}" layer "${Me}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const st=S.encode(Me),_t=[];for(let tt=0;tt<Ne.length;tt++){const dt=Ne.feature(tt),ht=j.getId(dt,Me);_t.push({feature:dt,id:ht,index:tt,sourceLayerIndex:st})}for(const tt of V[Me]){const dt=tt[0];this.isSymbolTile!==void 0&&dt.type==="symbol"!==this.isSymbolTile||dt.minzoom&&this.zoom<Math.floor(dt.minzoom)||dt.maxzoom&&this.zoom>=dt.maxzoom||dt.visibility!=="none"&&(lj(tt,this.zoom,f),(A[dt.id]=dt.createBucket({index:j.bucketLayerIDs.length,layers:tt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:st,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:f})).populate(_t,$,this.tileID.canonical,this.tileTransform),j.bucketLayerIDs.push(tt.map(ht=>ht.id)))}}let W,Y,J,re;M.trim();const le={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ge=()=>{if(W)return x(W);if(Y&&J&&re){const Me=new uL(Y),Ne=new yR(J,re);for(const Qe in A){const Ke=A[Qe];Ke instanceof wu?(lj(Ke.layers,this.zoom,f),WJ(Ke,Y,Me.positions,J,Ne.iconPositions,this.showCollisionBoxes,f,this.tileID.canonical,this.tileZoom,this.projection)):Ke.hasPattern&&(Ke instanceof u_||Ke instanceof o_||Ke instanceof Wy)&&(lj(Ke.layers,this.zoom,f),Ke.addFeatures($,this.tileID.canonical,Ne.patternPositions,f,this.tileTransform))}this.status="done",x(null,{buckets:Fe(A).filter(Qe=>!Qe.isEmpty()),featureIndex:j,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Me.image,lineAtlas:M,imageAtlas:Ne,glyphMap:this.returnDependencies?Y:null,iconMap:this.returnDependencies?J:null,glyphPositions:this.returnDependencies?Me.positions:null})}},Ae=lt($.glyphDependencies,Me=>Object.keys(Me).map(Number));Object.keys(Ae).length?g.send("getGlyphs",{uid:this.uid,stacks:Ae},(Me,Ne)=>{W||(W=Me,Y=Ne,ge())},void 0,!1,le):Y={};const ye=Object.keys($.iconDependencies);ye.length?g.send("getImages",{icons:ye,source:this.source,tileID:this.tileID,type:"icons"},(Me,Ne)=>{W||(W=Me,J=Ne,ge())},void 0,!1,le):J={};const Te=Object.keys($.patternDependencies);Te.length?g.send("getImages",{icons:Te,source:this.source,tileID:this.tileID,type:"patterns"},(Me,Ne)=>{W||(W=Me,re=Ne,ge())},void 0,!1,le):re={},ge()}}function lj(l,a,u){const f=new U(a);for(const g of l)g.recalculate(f,u)}class dL{constructor(a){this.entries={},this.scheduler=a}request(a,u,f,g){const x=this.entries[a]=this.entries[a]||{callbacks:[]};if(x.result){const[S,j]=x.result;return this.scheduler?this.scheduler.add(()=>{g(S,j)},u):g(S,j),()=>{}}return x.callbacks.push(g),x.cancel||(x.cancel=f((S,j)=>{x.result=[S,j];for(const A of x.callbacks)this.scheduler?this.scheduler.add(()=>{A(S,j)},u):A(S,j);setTimeout(()=>delete this.entries[a],3e3)})),()=>{x.result||(x.callbacks=x.callbacks.filter(S=>S!==g),x.callbacks.length||(x.cancel(),delete this.entries[a]))}}}function hL(l,a,u){const f=JSON.stringify(l.request);return l.data&&(this.deduped.entries[f]={result:[null,l.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},g=>{const x=Kc(l.request,(S,j,A,M)=>{S?g(S):j&&g(null,{vectorTile:u?void 0:new FT(new f_(j)),rawData:j,cacheControl:A,expires:M})});return()=>{x.cancel(),g()}},a)}const fL=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class cj{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,f]=new Uint8Array(a,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=f>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const x=fL[15&f];if(!x)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(a,2,1),[j]=new Uint32Array(a,4,1);return new cj(j,S,x,a)}constructor(a,u=64,f=Float64Array,g){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=f,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;const x=fL.indexOf(this.ArrayType),S=2*a*this.ArrayType.BYTES_PER_ELEMENT,j=a*this.IndexArrayType.BYTES_PER_ELEMENT,A=(8-j%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${f}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+j+A,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+S+j+A),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+j+A,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=a)}add(a,u){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=a,this.coords[this._pos++]=u,f}finish(){const a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return uj(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,u,f,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:S,nodeSize:j}=this,A=[0,x.length-1,0],M=[];for(;A.length;){const $=A.pop()||0,V=A.pop()||0,W=A.pop()||0;if(V-W<=j){for(let le=W;le<=V;le++){const ge=S[2*le],Ae=S[2*le+1];ge>=a&&ge<=f&&Ae>=u&&Ae<=g&&M.push(x[le])}continue}const Y=W+V>>1,J=S[2*Y],re=S[2*Y+1];J>=a&&J<=f&&re>=u&&re<=g&&M.push(x[Y]),($===0?a<=J:u<=re)&&(A.push(W),A.push(Y-1),A.push(1-$)),($===0?f>=J:g>=re)&&(A.push(Y+1),A.push(V),A.push(1-$))}return M}within(a,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:x,nodeSize:S}=this,j=[0,g.length-1,0],A=[],M=f*f;for(;j.length;){const $=j.pop()||0,V=j.pop()||0,W=j.pop()||0;if(V-W<=S){for(let le=W;le<=V;le++)mL(x[2*le],x[2*le+1],a,u)<=M&&A.push(g[le]);continue}const Y=W+V>>1,J=x[2*Y],re=x[2*Y+1];mL(J,re,a,u)<=M&&A.push(g[Y]),($===0?a-f<=J:u-f<=re)&&(j.push(W),j.push(Y-1),j.push(1-$)),($===0?a+f>=J:u+f>=re)&&(j.push(Y+1),j.push(V),j.push(1-$))}return A}}function uj(l,a,u,f,g,x){if(g-f<=u)return;const S=f+g>>1;pL(l,a,S,f,g,x),uj(l,a,u,f,S-1,1-x),uj(l,a,u,S+1,g,1-x)}function pL(l,a,u,f,g,x){for(;g>f;){if(g-f>600){const M=g-f+1,$=u-f+1,V=Math.log(M),W=.5*Math.exp(2*V/3),Y=.5*Math.sqrt(V*W*(M-W)/M)*($-M/2<0?-1:1);pL(l,a,u,Math.max(f,Math.floor(u-$*W/M+Y)),Math.min(g,Math.floor(u+(M-$)*W/M+Y)),x)}const S=a[2*u+x];let j=f,A=g;for(iv(l,a,f,u),a[2*g+x]>S&&iv(l,a,f,g);j<A;){for(iv(l,a,j,A),j++,A--;a[2*j+x]<S;)j++;for(;a[2*A+x]>S;)A--}a[2*f+x]===S?iv(l,a,f,A):(A++,iv(l,a,A,g)),A<=u&&(f=A+1),u<=A&&(g=A-1)}}function iv(l,a,u,f){dj(l,u,f),dj(a,2*u,2*f),dj(a,2*u+1,2*f+1)}function dj(l,a,u){const f=l[a];l[a]=l[u],l[u]=f}function mL(l,a,u,f){const g=l-u,x=a-f;return g*g+x*x}i.ARRAY_TYPE=Ho,i.AUTH_ERR_MSG=Ie,i.Aabb=po,i.Actor=class{constructor(l,a,u){this.target=l,this.parent=a,this.mapId=u,this.callbacks={},this.cancelCallbacks={},ft(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Gr()?l:p,this.scheduler=new hQ}send(l,a,u,f,g=!1,x){const S=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=x,this.callbacks[S]=u);const j=ki(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:l,hasCallback:!!u,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:pu(a,j)},j),{cancel:()=>{u&&delete this.callbacks[S],this.target.postMessage({id:S,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(l){const a=l.data,u=a.id;if(u&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){const f=this.cancelCallbacks[u];delete this.cancelCallbacks[u],f&&f.cancel()}else if(a.mustQueue||Gr()){const f=this.callbacks[u];this.cancelCallbacks[u]=this.scheduler.add(()=>this.processTask(u,a),f&&f.metadata||{type:"message"})}else this.processTask(u,a)}processTask(l,a){if(a.type==="<response>"){const u=this.callbacks[l];delete this.callbacks[l],u&&(a.error?u(Kl(a.error)):u(null,Kl(a.data)))}else{const u=ki(this.globalScope)?void 0:[],f=a.hasCallback?(x,S)=>{delete this.cancelCallbacks[l],this.target.postMessage({id:l,type:"<response>",sourceMapId:this.mapId,error:x?pu(x):null,data:pu(S,u)},u)}:x=>{},g=Kl(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,g,f);else if(this.parent.getWorkerSource){const x=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,x[0],g.source)[x[1]](g,f)}else f(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},i.CanonicalTileID=c_,i.Color=Un,i.ColorMode=pl,i.CullFaceMode=Ps,i.DEMData=j_,i.DataConstantProperty=te,i.DedupedRequest=dL,i.DepthMode=Tp,i.EXTENT=tr,i.Elevation=class{isDataAvailableAtPoint(l){const a=this._source();if(this.isUsingMockSource()||!a||l.y<0||l.y>1)return!1;const u=a.getSource().maxzoom,f=1<<u,g=Math.floor(l.x),x=Math.floor((l.x-g)*f),S=Math.floor(l.y*f),j=this.findDEMTileFor(new mo(u,g,u,x,S));return!(!j||!j.dem)}getAtPointOrZero(l,a=0){return this.getAtPoint(l,a)||0}getAtPoint(l,a,u=!0){if(this.isUsingMockSource())return null;a==null&&(a=null);const f=this._source();if(!f||l.y<0||l.y>1)return a;const g=f.getSource().maxzoom,x=1<<g,S=Math.floor(l.x),j=l.x-S,A=new mo(g,S,g,Math.floor(j*x),Math.floor(l.y*x)),M=this.findDEMTileFor(A);if(!M||!M.dem)return a;const $=M.dem,V=1<<M.tileID.canonical.z,W=(j*V-M.tileID.canonical.x)*$.dim,Y=(l.y*V-M.tileID.canonical.y)*$.dim,J=Math.floor(W),re=Math.floor(Y);return(u?this.exaggeration():1)*kr(kr($.get(J,re),$.get(J,re+1),Y-re),kr($.get(J+1,re),$.get(J+1,re+1),Y-re),W-J)}getAtTileOffset(l,a,u){const f=1<<l.canonical.z;return this.getAtPointOrZero(new dp(l.wrap+(l.canonical.x+a/tr)/f,(l.canonical.y+u/tr)/f))}getAtTileOffsetFunc(l,a,u,f){return g=>{const x=this.getAtTileOffset(l,g.x,g.y),S=f.upVector(l.canonical,g.x,g.y);return pa(S,S,x*f.upVectorScale(l.canonical,a,u).metersToTile),S}}getForTilePoints(l,a,u,f){if(this.isUsingMockSource())return!1;const g=C_.create(this,l,f);return!!g&&(a.forEach(x=>{x[2]=this.exaggeration()*g.getElevationAt(x[0],x[1],u)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const a=this.findDEMTileFor(l);if(!a||!a.dem)return null;const u=a.dem.tree,f=a.tileID,g=1<<l.canonical.z-f.canonical.z;let x=l.canonical.x/g-f.canonical.x,S=l.canonical.y/g-f.canonical.y,j=0;for(let A=0;A<l.canonical.z-f.canonical.z&&!u.leaves[j];A++){x*=2,S*=2;const M=2*Math.floor(S)+Math.floor(x);j=u.childOffsets[j]+M,x%=1,S%=1}return{min:this.exaggeration()*u.minimums[j],max:this.exaggeration()*u.maximums[j]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,a,u){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},i.ErrorEvent=ds,i.EvaluationParameters=U,i.Event=Ul,i.Evented=Rd,i.FillExtrusionBucket=Wy,i.Frustum=vT,i.FrustumCorners=yT,i.GLOBE_RADIUS=ll,i.GLOBE_SCALE_MATCH_LATITUDE=45,i.GLOBE_ZOOM_THRESHOLD_MAX=pD,i.GLOBE_ZOOM_THRESHOLD_MIN=xT,i.GlobeSharedBuffers=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const l of this._wireframeSegments)l.destroy()}}_fillGridMeshWithLods(l,a){const u=new bt,f=new Zt,g=[],x=l+1+2,S=a[0]+1,j=a[0]+1+(1+a.length),A=(M,$,V)=>{let W=M===x-1?M-2:M===0?M:M-1;return W+=V?24575:0,[W,$]};for(let M=0;M<x;++M)u.emplaceBack(...A(M,0,!0));for(let M=0;M<S;++M)for(let $=0;$<x;++$)u.emplaceBack(...A($,M,($===0||$===x-1)&&!0));for(let M=0;M<a.length;++M){const $=a[M];for(let V=0;V<x;++V)u.emplaceBack(...A(V,$,!0))}for(let M=0;M<a.length;++M){const $=f.length,V=a[M]+1+2,W=new Zt;for(let re=0;re<V-1;re++){const le=re===V-2,ge=le?x*(j-a.length+M-re):x;for(let Ae=0;Ae<x-1;Ae++){const ye=re*x+Ae;re===0||le||Ae===0||Ae===x-2?(W.emplaceBack(ye+1,ye,ye+ge),W.emplaceBack(ye+ge,ye+ge+1,ye+1)):(f.emplaceBack(ye+1,ye,ye+ge),f.emplaceBack(ye+ge,ye+ge+1,ye+1))}}const Y=Yn.simpleSegment(0,$,u.length,f.length-$);for(let re=0;re<W.uint16.length;re+=3)f.emplaceBack(W.uint16[re],W.uint16[re+1],W.uint16[re+2]);const J=Yn.simpleSegment(0,$,u.length,f.length-$);g.push({withoutSkirts:Y,withSkirts:J})}return{vertices:u,indices:f,segments:g}}_createGrid(l){const a=this._fillGridMeshWithLods(fh,Dy);this._gridSegments=a.segments,this._gridBuffer=l.createVertexBuffer(a.vertices,Oy.members),this._gridIndexBuffer=l.createIndexBuffer(a.indices,!0)}_createPoles(l){const a=new Zt;for(let g=0;g<=fh;g++)a.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=l.createIndexBuffer(a,!0);const u=new en,f=new en;this._poleSegments=[];for(let g=0,x=0;g<xT;g++){const S=360/(1<<g);u.emplaceBack(0,-ll,0,.5,0),f.emplaceBack(0,-ll,0,.5,1);for(let j=0;j<=fh;j++){const A=j/fh,M=kr(0,S,A),[$,V,W]=lp(hY,fY,M,ll);u.emplaceBack($,V,W,A,0),f.emplaceBack($,V,W,A,1)}this._poleSegments.push(Yn.simpleSegment(x,0,66,64)),x+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(u,hD,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(f,hD,!1)}getGridBuffers(l,a){return[this._gridBuffer,this._gridIndexBuffer,a?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}getWirefameBuffers(l,a){if(!this._wireframeSegments){const u=new bi,f=fh,g=f+1+2,x=1;this._wireframeSegments=[];for(let S=0,j=0;S<Dy.length;S++){const A=Dy[S];for(let $=x;$<A+x;$++)for(let V=x;V<f+x;V++){const W=$*g+V;u.emplaceBack(W,W+1),u.emplaceBack(W,W+g),u.emplaceBack(W,W+g+1)}const M=A*f*3;this._wireframeSegments.push(Yn.simpleSegment(0,j,(A+1)*g,M)),j+=M}this._wireframeIndexBuffer=l.createIndexBuffer(u)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[a]]}},i.GlyphManager=bp,i.ImagePosition=GT,i.KDBush=cj,i.LivePerformanceUtils=zE,i.LngLat=rn,i.LngLatBounds=vu,i.LocalGlyphMode=ZT,i.MAX_MERCATOR_LATITUDE=Wi,i.MercatorCoordinate=dp,i.ONE_EM=Mi,i.OverscaledTileID=mo,i.PerformanceMarkers=Yc,i.Point=K,i.Properties=we,i.RGBAImage=Xo,i.Ray=gT,i.RequestManager=class{constructor(l,a,u){this._transformRequestFn=l,this._customAccessToken=a,this._silenceAuthErrors=!!u,this._createSkuToken()}_createSkuToken(){const l=function(){let a="";for(let u=0;u<10;u++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",O,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=l.token,this._skuTokenExpiresAt=l.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(l,a){return this._transformRequestFn&&this._transformRequestFn(l,a)||{url:l}}normalizeStyleURL(l,a){if(!$e(l))return l;const u=Mt(l);return u.path=`/styles/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeGlyphsURL(l,a){if(!$e(l))return l;const u=Mt(l);return u.path=`/fonts/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeSourceURL(l,a,u,f){if(!$e(l))return l;const g=Mt(l);return g.path=`/v4/${g.authority}.json`,g.params.push("secure"),u&&g.params.push(`language=${u}`),f&&g.params.push(`worldview=${f}`),this._makeAPIURL(g,this._customAccessToken||a)}normalizeSpriteURL(l,a,u,f){const g=Mt(l);return $e(l)?(g.path=`/styles/v1${g.path}/sprite${a}${u}`,this._makeAPIURL(g,this._customAccessToken||f)):(g.path+=`${a}${u}`,Tt(g))}normalizeTileURL(l,a,u){if(this._isSkuTokenExpired()&&this._createSkuToken(),l&&!$e(l))return l;const f=Mt(l);f.path=f.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${a||u&&f.authority!=="raster"&&u===512?"@2x":""}${E.supported?".webp":"$1"}`),f.authority==="raster"?f.path=`/${_.RASTER_URL_PREFIX}${f.path}`:(f.path=f.path.replace(/^.+\/v4\//,"/"),f.path=`/${_.TILE_URL_VERSION}${f.path}`);const g=this._customAccessToken||function(x){for(const S of x){const j=S.match(/^access_token=(.*)$/);if(j)return j[1]}return null}(f.params)||_.ACCESS_TOKEN;return _.REQUIRE_ACCESS_TOKEN&&g&&this._skuToken&&f.params.push(`sku=${this._skuToken}`),this._makeAPIURL(f,g)}canonicalizeTileURL(l,a){const u=Mt(l);if(!u.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!u.path.match(/\.[\w]+$/))return l;let f="mapbox://";u.path.match(/^\/raster\/v1\//)?f+=`raster/${u.path.replace(`/${_.RASTER_URL_PREFIX}/`,"")}`:f+=`tiles/${u.path.replace(`/${_.TILE_URL_VERSION}/`,"")}`;let g=u.params;return a&&(g=g.filter(x=>!x.match(/^access_token=/))),g.length&&(f+=`?${g.join("&")}`),f}canonicalizeTileset(l,a){const u=!!a&&$e(a),f=[];for(const g of l.tiles||[])Xe(g)?f.push(this.canonicalizeTileURL(g,u)):f.push(g);return f}_makeAPIURL(l,a){const u="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",f=Mt(_.API_URL);if(l.protocol=f.protocol,l.authority=f.authority,l.protocol==="http"){const g=l.params.indexOf("secure");g>=0&&l.params.splice(g,1)}if(f.path!=="/"&&(l.path=`${f.path}${l.path}`),!_.REQUIRE_ACCESS_TOKEN)return Tt(l);if(a=a||_.ACCESS_TOKEN,!this._silenceAuthErrors){if(!a)throw new Error(`An API access token is required to use Mapbox GL. ${u}`);if(a[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${u}`)}return l.params=l.params.filter(g=>g.indexOf("access_token")===-1),l.params.push(`access_token=${a||""}`),Tt(l)}},i.ResourceType=zl,i.SegmentVector=Yn,i.SourceCache=xh,i.StencilMode=oj,i.StructArrayLayout1ui2=Go,i.StructArrayLayout2f1f2i16=ir,i.StructArrayLayout2i4=bt,i.StructArrayLayout2ui4=bi,i.StructArrayLayout3f12=wr,i.StructArrayLayout3ui6=Zt,i.StructArrayLayout4i8=ut,i.StructArrayLayout5f20=en,i.Texture=rv,i.Tile=nj,i.Transitionable=Q,i.Uniform1f=G0,i.Uniform1i=class extends Ql{constructor(l){super(l),this.current=0}set(l,a,u){this.fetchUniformLocation(l,a)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},i.Uniform2f=class extends Ql{constructor(l){super(l),this.current=[0,0]}set(l,a,u){this.fetchUniformLocation(l,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}},i.Uniform3f=class extends Ql{constructor(l){super(l),this.current=[0,0,0]}set(l,a,u){this.fetchUniformLocation(l,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}},i.Uniform4f=ZO,i.UniformColor=KO,i.UniformMatrix2f=class extends Ql{constructor(l){super(l),this.current=KK}set(l,a,u){if(this.fetchUniformLocation(l,a)){for(let f=0;f<4;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}},i.UniformMatrix3f=class extends Ql{constructor(l){super(l),this.current=ZK}set(l,a,u){if(this.fetchUniformLocation(l,a)){for(let f=0;f<9;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix3fv(this.location,!1,u);break}}}},i.UniformMatrix4f=class extends Ql{constructor(l){super(l),this.current=XK}set(l,a,u){if(this.fetchUniformLocation(l,a)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let f=1;f<16;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}},i.UnwrappedTileID=rR,i.ValidationError=Bt,i.VectorTileFeature=s_,i.VectorTileWorkerSource=class extends Rd{constructor(l,a,u,f,g){super(),this.actor=l,this.layerIndex=a,this.availableImages=u,this.loadVectorData=g||hL,this.loading={},this.loaded={},this.deduped=new dL(l.scheduler),this.isSpriteLoaded=f,this.scheduler=l.scheduler}loadTile(l,a){const u=l.uid,f=l&&l.request,g=f&&f.collectResourceTiming,x=this.loading[u]=new xQ(l);x.abort=this.loadVectorData(l,(S,j)=>{const A=!this.loading[u];if(delete this.loading[u],A||S||!j)return x.status="done",A||(this.loaded[u]=x),a(S);const M=j.rawData,$={};j.expires&&($.expires=j.expires),j.cacheControl&&($.cacheControl=j.cacheControl),x.vectorTile=j.vectorTile||new FT(new f_(M));const V=()=>{x.parse(x.vectorTile,this.layerIndex,this.availableImages,this.actor,(W,Y)=>{if(W||!Y)return a(W);const J={};if(g){const re=Ng(f);re.length>0&&(J.resourceTiming=JSON.parse(JSON.stringify(re)))}a(null,Ge({rawTileData:M.slice(0)},Y,$,J))})};this.isSpriteLoaded?V():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(V,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom}):V()}),this.loaded=this.loaded||{},this.loaded[u]=x})}reloadTile(l,a){const u=this.loaded,f=l.uid,g=this;if(u&&u[f]){const x=u[f];x.showCollisionBoxes=l.showCollisionBoxes,x.enableTerrain=!!l.enableTerrain,x.projection=l.projection,x.tileTransform=vh(l.tileID.canonical,l.projection);const S=(j,A)=>{const M=x.reloadCallback;M&&(delete x.reloadCallback,x.parse(x.vectorTile,g.layerIndex,this.availableImages,g.actor,M)),a(j,A)};x.status==="parsing"?x.reloadCallback=S:x.status==="done"&&(x.vectorTile?x.parse(x.vectorTile,this.layerIndex,this.availableImages,this.actor,S):S())}}abortTile(l,a){const u=l.uid,f=this.loading[u];f&&(f.abort&&f.abort(),delete this.loading[u]),a()}removeTile(l,a){const u=this.loaded,f=l.uid;u&&u[f]&&delete u[f],a()}},i.WritingMode=ga,i.ZoomDependentExpression=eh,i.add=tc,i.addDynamicAttributes=S_,i.adjoint=function(l,a){var u=a[0],f=a[1],g=a[2],x=a[3],S=a[4],j=a[5],A=a[6],M=a[7],$=a[8];return l[0]=S*$-j*M,l[1]=g*M-f*$,l[2]=f*j-g*S,l[3]=j*A-x*$,l[4]=u*$-g*A,l[5]=g*x-u*j,l[6]=x*M-S*A,l[7]=f*A-u*M,l[8]=u*S-f*x,l},i.asyncAll=Be,i.bezier=ce,i.bindAll=ft,i.boundsAttributes=XR,i.bufferConvexPolygon=function(l,a){const u=[];for(let f=0;f<l.length;f++){const g=Re(f-1,-1,l.length-1),x=Re(f+1,-1,l.length-1),S=l[f],j=l[x],A=l[g].sub(S).unit(),M=j.sub(S).unit(),$=M.angleWithSep(A.x,A.y),V=A.add(M).unit().mult(-1*a/Math.sin($/2));u.push(S.add(V))}return u},i.cacheEntryPossiblyAdded=function(l){Od++,Od>Pf&&(l.getActor().send("enforceCacheSizeLimit",Ll),Od=0)},i.calculateGlobeLabelMatrix=function(l,a){const{x:u,y:f}=l.point,g=xD(u,f,l.worldSize/l._pixelsPerMercatorPixel,0,0);return uh(g,g,wT(cl(a)))},i.calculateGlobeMatrix=function(l){const{x:a,y:u}=l.point,{lng:f,lat:g}=l._center;return xD(a,u,l.worldSize,f,g)},i.calculateGlobeMercatorMatrix=function(l){const a=l.pixelsPerMeter,u=a/Ts(1,l.center.lat),f=Ss(new Float64Array(16));return Py(f,f,[l.point.x,l.point.y,0]),dh(f,f,[u,u,a]),Float32Array.from(f)},i.circumferenceAtLatitude=ET,i.clamp=ve,i.clearTileCache=function(l){if(!Id())return;const a=p.caches.delete(cs);l&&a.catch(l).then(()=>l())},i.clipLine=kR,i.clone=function(l){var a=new Ho(16);return a[0]=l[0],a[1]=l[1],a[2]=l[2],a[3]=l[3],a[4]=l[4],a[5]=l[5],a[6]=l[6],a[7]=l[7],a[8]=l[8],a[9]=l[9],a[10]=l[10],a[11]=l[11],a[12]=l[12],a[13]=l[13],a[14]=l[14],a[15]=l[15],a},i.clone$1=ar,i.collisionCircleLayout=yJ,i.config=_,i.conjugate=function(l,a){return l[0]=-a[0],l[1]=-a[1],l[2]=-a[2],l[3]=a[3],l},i.create=function(){var l=new Ho(16);return Ho!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},i.create$1=QO,i.createExpression=du,i.createLayout=Ue,i.createStyleLayer=function(l){return l.type==="custom"?new lQ(l):new uQ[l.type](l)},i.cross=mT,i.degToRad=ae,i.distance=function(l,a){return Math.hypot(a[0]-l[0],a[1]-l[1],a[2]-l[2])},i.div=function(l,a,u){return l[0]=a[0]/u[0],l[1]=a[1]/u[1],l[2]=a[2]/u[2],l},i.dot=$a,i.earthRadius=By,i.ease=ke,i.easeCubicInOut=xe,i.ecefToLatLng=function([l,a,u]){const f=Math.hypot(l,a,u),g=Math.atan2(l,u),x=.5*Math.PI-Math.acos(-a/f);return new rn(_e(g),_e(x))},i.emitValidationErrors=$0,i.endsWith=vt,i.enforceCacheSizeLimit=function(l){Bl(),Fo&&Fo.then(a=>{a.keys().then(u=>{for(let f=0;f<u.length-l;f++)a.delete(u[f])})})},i.evaluateSizeForFeature=d_,i.evaluateSizeForZoom=gp,i.evaluateVariableOffset=DR,i.evented=T,i.exactEquals=function(l,a){return l[0]===a[0]&&l[1]===a[1]&&l[2]===a[2]&&l[3]===a[3]},i.exactEquals$1=function(l,a){return l[0]===a[0]&&l[1]===a[1]&&l[2]===a[2]},i.exported=us,i.exported$1=E,i.extend=Ge,i.extend$1=hs,i.fillExtrusionHeightLift=QD,i.filterObject=it,i.fromMat4=function(l,a){return l[0]=a[0],l[1]=a[1],l[2]=a[2],l[3]=a[4],l[4]=a[5],l[5]=a[6],l[6]=a[8],l[7]=a[9],l[8]=a[10],l},i.fromQuat=function(l,a){var u=a[0],f=a[1],g=a[2],x=a[3],S=u+u,j=f+f,A=g+g,M=u*S,$=f*S,V=f*j,W=g*S,Y=g*j,J=g*A,re=x*S,le=x*j,ge=x*A;return l[0]=1-V-J,l[1]=$+ge,l[2]=W-le,l[3]=0,l[4]=$-ge,l[5]=1-M-J,l[6]=Y+re,l[7]=0,l[8]=W+le,l[9]=Y-re,l[10]=1-M-V,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},i.fromRotation=function(l,a){var u=Math.sin(a),f=Math.cos(a);return l[0]=f,l[1]=u,l[2]=0,l[3]=-u,l[4]=f,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},i.fromScaling=tD,i.furthestTileCorner=function(l){const a=Math.round((l+45+360)%360/90)%4;return Ee[a]},i.getAABBPointSquareDist=function(l,a,u){let f=0;for(let g=0;g<2;++g){const x=u?u[g]:0;l[g]>x&&(f+=(l[g]-x)*(l[g]-x)),a[g]<x&&(f+=(x-a[g])*(x-a[g]))}return f},i.getAnchorAlignment=XT,i.getAnchorJustification=YT,i.getBounds=function(l){let a=1/0,u=1/0,f=-1/0,g=-1/0;for(const x of l)a=Math.min(a,x.x),u=Math.min(u,x.y),f=Math.max(f,x.x),g=Math.max(g,x.y);return{min:new K(a,u),max:new K(f,g)}},i.getColumn=lo,i.getDefaultExportFromCjs=R,i.getGridMatrix=function(l,a,u,f){const g=a.getNorth(),x=a.getSouth(),S=a.getWest(),j=a.getEast(),A=1<<l.z,M=j-S,$=g-x,V=M/fh,W=-$/Dy[u],Y=[0,V,0,W,0,0,g,S,0];if(l.z>0){const J=180/f;eD(Y,Y,[J/M+1,0,0,0,J/$+1,0,-.5*J/V,.5*J/W,1])}return Y[2]=A,Y[5]=l.x,Y[8]=l.y,Y},i.getImage=Se,i.getJSON=function(l,a){return Fl(Ge(l,{type:"json"}),a)},i.getLatitudinalLod=function(l){const a=Wi-5;l=ve(l,-a,a)/a*90;const u=Math.pow(Math.abs(Math.sin(ae(l))),3);return Math.round(u*(Dy.length-1))},i.getMapSessionAPI=yi,i.getPerformanceMeasurement=Ng,i.getProjection=VR,i.getRTLTextPluginStatus=P,i.getReferrer=$l,i.getTilePoint=function(l,{x:a,y:u},f=0){return new K(((a-f)*l.scale-l.x)*tr,(u*l.scale-l.y)*tr)},i.getTileVec3=function(l,a,u=0){return sp(((a.x-u)*l.scale-l.x)*tr,(a.y*l.scale-l.y)*tr,SD(a.z,a.y))},i.getVideo=function(l,a){const u=p.document.createElement("video");u.muted=!0,u.onloadstart=function(){a(null,u)};for(let f=0;f<l.length;f++){const g=p.document.createElement("source");Af(l[f])||(u.crossOrigin="Anonymous"),g.src=l[f],u.appendChild(g)}return{cancel:()=>{}}},i.globeCenterToScreenPoint=function(l){const a=[0,0,0],u=Ss(new Float64Array(16));return uh(u,l.pixelMatrix,l.globeMatrix),Vn(a,a,u),new K(a[0],a[1])},i.globeDenormalizeECEF=wT,i.globeECEFOrigin=function(l,a){const u=[0,0,0];return Vn(u,u,Ly(cl(a.canonical))),Vn(u,u,l),u},i.globeMetersToEcef=Z0,i.globeNormalizeECEF=Ly,i.globePixelsToTileUnits=function(l,a){return tr/(512*Math.pow(2,l))*Y0(cl(a))},i.globePoleMatrixForTile=function(l,a,u){const f=Ss(new Float64Array(16)),g=(a/(1<<l)-.5)*Math.PI*2;return X0(f,u.globeMatrix,g),Float32Array.from(f)},i.globeTileBounds=cl,i.globeTiltAtLngLat=bD,i.globeToMercatorTransition=up,i.globeUseCustomAntiAliasing=function(l,a,u){const f=up(u.zoom),g=l.style.map._antialias,x=!!a.extStandardDerivatives,S=a.extStandardDerivativesForceOff||l.terrain&&l.terrain.exaggeration()>0;return f===0&&!g&&!S&&x},i.identity=Ss,i.identity$1=cD,i.invert=dT,i.isFullscreen=function(){return!!p.document.fullscreenElement||!!p.document.webkitFullscreenElement},i.isLngLatBehindGlobe=ST,i.isMapAuthenticated=function(l){return Yi.has(l)},i.isMapboxURL=$e,i.isSafariWithAntialiasingBug=function(l){const a=l.navigator?l.navigator.userAgent:null;return!!ki(l)&&a&&(a.match("Version/15.4")||a.match("Version/15.5")||a.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.latFromMercatorY=qi,i.latLngToECEF=cp,i.len=oY,i.length=Ay,i.length$1=function(l){return Math.hypot(l[0],l[1],l[2],l[3])},i.lngFromMercatorX=ma,i.loadVectorTile=hL,i.makeRequest=Fl,i.mapValue=function(l,a,u,f,g){return ve((l-a)/(u-a)*(g-f)+f,f,g)},i.mercatorScale=ED,i.mercatorXfromLng=ul,i.mercatorYfromLat=dl,i.mercatorZfromAltitude=Ts,i.mul=nY,i.mul$1=iY,i.multiply=uh,i.multiply$1=eD,i.multiply$2=iD,i.nextPowerOfTwo=Nt,i.normalize=fo,i.normalize$1=aY,i.normalize$2=sD,i.number=kr,i.ortho=function(l,a,u,f,g,x,S){var j=1/(a-u),A=1/(f-g),M=1/(x-S);return l[0]=-2*j,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*A,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*M,l[11]=0,l[12]=(a+u)*j,l[13]=(g+f)*A,l[14]=(S+x)*M,l[15]=1,l},i.pbf=cR,i.perspective=function(l,a,u,f,g){var x,S=1/Math.tan(a/2);return l[0]=S/u,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=S,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,g!=null&&g!==1/0?(l[10]=(g+f)*(x=1/(f-g)),l[14]=2*g*f*x):(l[10]=-1,l[14]=-2*f),l},i.pick=function(l,a){const u={};for(let f=0;f<a.length;f++){const g=a[f];g in l&&(u[g]=l[g])}return u},i.plugin=z,i.pointGeometry=G,i.polesInViewport=function(l){const a=Ss(new Float64Array(16));uh(a,l.pixelMatrix,l.globeMatrix);const u=[0,Fa,0],f=[0,Ua,0];return Vn(u,u,a),Vn(f,f,a),[u[0]>0&&u[0]<=l.width&&u[1]>0&&u[1]<=l.height&&!ST(l,new rn(l.center.lat,90)),f[0]>0&&f[0]<=l.width&&f[1]>0&&f[1]<=l.height&&!ST(l,new rn(l.center.lat,-90))]},i.polygonContainsPoint=gh,i.polygonIntersectsBox=ND,i.polygonIntersectsPolygon=CD,i.polygonizeBounds=function(l,a,u=0,f=!0){const g=new K(u,u),x=l.sub(g),S=a.add(g),j=[x,new K(S.x,x.y),S,new K(x.x,S.y)];return f&&j.push(x.clone()),j},i.posAttributes=Oy,i.postMapLoadEvent=Xn,i.postPerformanceEvent=li,i.postTurnstileEvent=Pr,i.potpack=WT,i.prevPowerOfTwo=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},i.radToDeg=_e,i.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.registerForPluginStateChange=function(l){return l({pluginStatus:v,pluginURL:d}),T.on("pluginStateChange",l),l},i.removeAuthState=function(l){Yi.delete(l)},i.renderColorRamp=MT,i.resample=TD,i.rotateX=hT,i.rotateX$1=uD,i.rotateY=X0,i.rotateY$1=dD,i.rotateZ=function(l,a,u){var f=Math.sin(u),g=Math.cos(u),x=a[0],S=a[1],j=a[2],A=a[3],M=a[4],$=a[5],V=a[6],W=a[7];return a!==l&&(l[8]=a[8],l[9]=a[9],l[10]=a[10],l[11]=a[11],l[12]=a[12],l[13]=a[13],l[14]=a[14],l[15]=a[15]),l[0]=x*g+M*f,l[1]=S*g+$*f,l[2]=j*g+V*f,l[3]=A*g+W*f,l[4]=M*g-x*f,l[5]=$*g-S*f,l[6]=V*g-j*f,l[7]=W*g-A*f,l},i.rotateZ$1=function(l,a,u){u*=.5;var f=a[0],g=a[1],x=a[2],S=a[3],j=Math.sin(u),A=Math.cos(u);return l[0]=f*A+g*j,l[1]=g*A-f*j,l[2]=x*A+S*j,l[3]=S*A-x*j,l},i.scale=dh,i.scale$1=aD,i.scale$2=pa,i.scaleAndAdd=My,i.set=function(l,a,u,f){return l[0]=a,l[1]=u,l[2]=f,l},i.setCacheLimits=function(l,a){Ll=l,Pf=a},i.setColumn=function(l,a,u){l[4*a+0]=u[0],l[4*a+1]=u[1],l[4*a+2]=u[2],l[4*a+3]=u[3]},i.setRTLTextPlugin=function(l,a,u=!1){if(v===Sy||v===Ey||v===Ty)throw new Error("setRTLTextPlugin cannot be called multiple times.");d=us.resolveURL(l),v=Sy,mu=a,w(),u||L()},i.smoothstep=Pe,i.spec=at,i.squaredLength=function(l){var a=l[0],u=l[1],f=l[2];return a*a+u*u+f*f},i.storeAuthState=function(l,a){a?Yi.add(l):Yi.delete(l)},i.sub=Es,i.subtract=pT,i.symbolSize=vJ,i.tileAABB=function(l,a,u,f,g,x,S,j,A){if(A.name==="globe")return dY(l,a,new c_(u,f,g));const M=vh({z:u,x:f,y:g},A);return new po([(x+M.x/M.scale)*a,a*(M.y/M.scale),S],[(x+M.x2/M.scale)*a,a*(M.y2/M.scale),j])},i.tileCornersToBounds=K0,i.tileTransform=vh,i.transformMat3=function(l,a,u){var f=a[0],g=a[1],x=a[2];return l[0]=f*u[0]+g*u[3]+x*u[6],l[1]=f*u[1]+g*u[4]+x*u[7],l[2]=f*u[2]+g*u[5]+x*u[8],l},i.transformMat4=Vn,i.transformMat4$1=hh,i.transformQuat=oD,i.transitionTileAABBinECEF=gD,i.translate=Py,i.transpose=function(l,a){if(l===a){var u=a[1],f=a[2],g=a[5];l[1]=a[3],l[2]=a[6],l[3]=u,l[5]=a[7],l[6]=f,l[7]=g}else l[0]=a[0],l[1]=a[3],l[2]=a[6],l[3]=a[1],l[4]=a[4],l[5]=a[7],l[6]=a[2],l[7]=a[5],l[8]=a[8];return l},i.triggerPluginCompletionEvent=m,i.uniqueId=$t,i.updateGlobeVertexNormal=function(l,a,u,f,g){const x=5*a+2;l.float32[x+0]=u,l.float32[x+1]=f,l.float32[x+2]=g},i.validateCustomStyleLayer=function(l){const a=[],u=l.id;return u===void 0&&a.push({message:`layers.${u}: missing required property "id"`}),l.render===void 0&&a.push({message:`layers.${u}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&a.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),a},i.validateFilter=l=>Wo(oh(l)),i.validateFog=l=>Wo(L0(l)),i.validateLayer=l=>Wo(I0(l)),i.validateLight=l=>Wo(R0(l)),i.validateSource=l=>Wo(D0(l)),i.validateStyle=z0,i.validateTerrain=l=>Wo(vy(l)),i.values=Fe,i.vectorTile=a_,i.version=y,i.warnOnce=pt,i.window=p,i.wrap=Re}),s(["./shared"],function(i){function p(Ce){if(typeof Ce=="number"||typeof Ce=="boolean"||typeof Ce=="string"||Ce==null)return JSON.stringify(Ce);if(Array.isArray(Ce)){let oe="[";for(const Se of Ce)oe+=`${p(Se)},`;return`${oe}]`}let ne="{";for(const oe of Object.keys(Ce).sort())ne+=`${oe}:${p(Ce[oe])},`;return`${ne}}`}function y(Ce){let ne="";for(const oe of i.refProperties)ne+=`/${p(Ce[oe])}`;return ne}class b{constructor(ne){this.keyCache={},ne&&this.replace(ne)}replace(ne){this._layerConfigs={},this._layers={},this.update(ne,[])}update(ne,oe){for(const Ie of ne)this._layerConfigs[Ie.id]=Ie,(this._layers[Ie.id]=i.createStyleLayer(Ie)).compileFilter(),this.keyCache[Ie.id]&&delete this.keyCache[Ie.id];for(const Ie of oe)delete this.keyCache[Ie],delete this._layerConfigs[Ie],delete this._layers[Ie];this.familiesBySource={};const Se=function(Ie,$e){const Xe={};for(let ze=0;ze<Ie.length;ze++){const rt=$e&&$e[Ie[ze].id]||y(Ie[ze]);$e&&($e[Ie[ze].id]=rt);let At=Xe[rt];At||(At=Xe[rt]=[]),At.push(Ie[ze])}const He=[];for(const ze in Xe)He.push(Xe[ze]);return He}(i.values(this._layerConfigs),this.keyCache);for(const Ie of Se){const $e=Ie.map(Mt=>this._layers[Mt.id]),Xe=$e[0];if(Xe.visibility==="none")continue;const He=Xe.source||"";let ze=this.familiesBySource[He];ze||(ze=this.familiesBySource[He]={});const rt=Xe.sourceLayer||"_geojsonTileLayer";let At=ze[rt];At||(At=ze[rt]=[]),At.push($e)}}}class _{loadTile(ne,oe){const{uid:Se,encoding:Ie,rawImageData:$e,padding:Xe,buildQuadTree:He}=ne,ze=i.window.ImageBitmap&&$e instanceof i.window.ImageBitmap?this.getImageData($e,Xe):$e;oe(null,new i.DEMData(Se,ze,Ie,Xe<1,He))}getImageData(ne,oe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ne.width,ne.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ne.width,this.offscreenCanvas.height=ne.height,this.offscreenCanvasContext.drawImage(ne,0,0,ne.width,ne.height);const Se=this.offscreenCanvasContext.getImageData(-oe,-oe,ne.width+2*oe,ne.height+2*oe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Se}}function E(Ce,ne){if(Ce.length!==0){C(Ce[0],ne);for(var oe=1;oe<Ce.length;oe++)C(Ce[oe],!ne)}}function C(Ce,ne){for(var oe=0,Se=0,Ie=0,$e=Ce.length,Xe=$e-1;Ie<$e;Xe=Ie++){var He=(Ce[Ie][0]-Ce[Xe][0])*(Ce[Xe][1]+Ce[Ie][1]),ze=oe+He;Se+=Math.abs(oe)>=Math.abs(He)?oe-ze+He:He-ze+oe,oe=ze}oe+Se>=0!=!!ne&&Ce.reverse()}var k=i.getDefaultExportFromCjs(function Ce(ne,oe){var Se,Ie=ne&&ne.type;if(Ie==="FeatureCollection")for(Se=0;Se<ne.features.length;Se++)Ce(ne.features[Se],oe);else if(Ie==="GeometryCollection")for(Se=0;Se<ne.geometries.length;Se++)Ce(ne.geometries[Se],oe);else if(Ie==="Feature")Ce(ne.geometry,oe);else if(Ie==="Polygon")E(ne.coordinates,oe);else if(Ie==="MultiPolygon")for(Se=0;Se<ne.coordinates.length;Se++)E(ne.coordinates[Se],oe);return ne});const N=i.VectorTileFeature.prototype.toGeoJSON;var I={exports:{}},B=i.pointGeometry,O=i.vectorTile.VectorTileFeature,R=q;function q(Ce,ne){this.options=ne||{},this.features=Ce,this.length=Ce.length}function F(Ce,ne){this.id=typeof Ce.id=="number"?Ce.id:void 0,this.type=Ce.type,this.rawGeometry=Ce.type===1?[Ce.geometry]:Ce.geometry,this.properties=Ce.tags,this.extent=ne||4096}q.prototype.feature=function(Ce){return new F(this.features[Ce],this.options.extent)},F.prototype.loadGeometry=function(){var Ce=this.rawGeometry;this.geometry=[];for(var ne=0;ne<Ce.length;ne++){for(var oe=Ce[ne],Se=[],Ie=0;Ie<oe.length;Ie++)Se.push(new B(oe[Ie][0],oe[Ie][1]));this.geometry.push(Se)}return this.geometry},F.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ce=this.geometry,ne=1/0,oe=-1/0,Se=1/0,Ie=-1/0,$e=0;$e<Ce.length;$e++)for(var Xe=Ce[$e],He=0;He<Xe.length;He++){var ze=Xe[He];ne=Math.min(ne,ze.x),oe=Math.max(oe,ze.x),Se=Math.min(Se,ze.y),Ie=Math.max(Ie,ze.y)}return[ne,Se,oe,Ie]},F.prototype.toGeoJSON=O.prototype.toGeoJSON;var X=i.pbf,G=R;function ee(Ce){var ne=new X;return function(oe,Se){for(var Ie in oe.layers)Se.writeMessage(3,K,oe.layers[Ie])}(Ce,ne),ne.finish()}function K(Ce,ne){var oe;ne.writeVarintField(15,Ce.version||1),ne.writeStringField(1,Ce.name||""),ne.writeVarintField(5,Ce.extent||4096);var Se={keys:[],values:[],keycache:{},valuecache:{}};for(oe=0;oe<Ce.length;oe++)Se.feature=Ce.feature(oe),ne.writeMessage(2,ie,Se);var Ie=Se.keys;for(oe=0;oe<Ie.length;oe++)ne.writeStringField(3,Ie[oe]);var $e=Se.values;for(oe=0;oe<$e.length;oe++)ne.writeMessage(4,xe,$e[oe])}function ie(Ce,ne){var oe=Ce.feature;oe.id!==void 0&&ne.writeVarintField(1,oe.id),ne.writeMessage(2,pe,Ce),ne.writeVarintField(3,oe.type),ne.writeMessage(4,Ee,oe)}function pe(Ce,ne){var oe=Ce.feature,Se=Ce.keys,Ie=Ce.values,$e=Ce.keycache,Xe=Ce.valuecache;for(var He in oe.properties){var ze=oe.properties[He],rt=$e[He];if(ze!==null){rt===void 0&&(Se.push(He),$e[He]=rt=Se.length-1),ne.writeVarint(rt);var At=typeof ze;At!=="string"&&At!=="boolean"&&At!=="number"&&(ze=JSON.stringify(ze));var Mt=At+":"+ze,Tt=Xe[Mt];Tt===void 0&&(Ie.push(ze),Xe[Mt]=Tt=Ie.length-1),ne.writeVarint(Tt)}}}function ae(Ce,ne){return(ne<<3)+(7&Ce)}function _e(Ce){return Ce<<1^Ce>>31}function Ee(Ce,ne){for(var oe=Ce.loadGeometry(),Se=Ce.type,Ie=0,$e=0,Xe=oe.length,He=0;He<Xe;He++){var ze=oe[He],rt=1;Se===1&&(rt=ze.length),ne.writeVarint(ae(1,rt));for(var At=Se===3?ze.length-1:ze.length,Mt=0;Mt<At;Mt++){Mt===1&&Se!==1&&ne.writeVarint(ae(2,At-1));var Tt=ze[Mt].x-Ie,pr=ze[Mt].y-$e;ne.writeVarint(_e(Tt)),ne.writeVarint(_e(pr)),Ie+=Tt,$e+=pr}Se===3&&ne.writeVarint(ae(7,1))}}function xe(Ce,ne){var oe=typeof Ce;oe==="string"?ne.writeStringField(1,Ce):oe==="boolean"?ne.writeBooleanField(7,Ce):oe==="number"&&(Ce%1!=0?ne.writeDoubleField(3,Ce):Ce<0?ne.writeSVarintField(6,Ce):ne.writeVarintField(5,Ce))}I.exports=ee,I.exports.fromVectorTileJs=ee,I.exports.fromGeojsonVt=function(Ce,ne){ne=ne||{};var oe={};for(var Se in Ce)oe[Se]=new G(Ce[Se].features,ne),oe[Se].name=Se,oe[Se].version=ne.version,oe[Se].extent=ne.extent;return ee({layers:oe})},I.exports.GeoJSONWrapper=G;var ce=i.getDefaultExportFromCjs(I.exports);const ke={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ce=>Ce},ve=Math.fround||(Pe=new Float32Array(1),Ce=>(Pe[0]=+Ce,Pe[0]));var Pe;const Re=3,Be=5,Fe=6;class Ge{constructor(ne){this.options=Object.assign(Object.create(ke),ne),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ne){const{log:oe,minZoom:Se,maxZoom:Ie}=this.options;oe&&console.time("total time");const $e=`prepare ${ne.length} points`;oe&&console.time($e),this.points=ne;const Xe=[];for(let ze=0;ze<ne.length;ze++){const rt=ne[ze];if(!rt.geometry)continue;const[At,Mt]=rt.geometry.coordinates,Tt=ve(nr(At)),pr=ve(Nt(Mt));Xe.push(Tt,pr,1/0,ze,-1,1),this.options.reduce&&Xe.push(0)}let He=this.trees[Ie+1]=this._createTree(Xe);oe&&console.timeEnd($e);for(let ze=Ie;ze>=Se;ze--){const rt=+Date.now();He=this.trees[ze]=this._createTree(this._cluster(He,ze)),oe&&console.log("z%d: %d clusters in %dms",ze,He.numItems,+Date.now()-rt)}return oe&&console.timeEnd("total time"),this}getClusters(ne,oe){let Se=((ne[0]+180)%360+360)%360-180;const Ie=Math.max(-90,Math.min(90,ne[1]));let $e=ne[2]===180?180:((ne[2]+180)%360+360)%360-180;const Xe=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)Se=-180,$e=180;else if(Se>$e){const Mt=this.getClusters([Se,Ie,180,Xe],oe),Tt=this.getClusters([-180,Ie,$e,Xe],oe);return Mt.concat(Tt)}const He=this.trees[this._limitZoom(oe)],ze=He.range(nr(Se),Nt(Xe),nr($e),Nt(Ie)),rt=He.data,At=[];for(const Mt of ze){const Tt=this.stride*Mt;At.push(rt[Tt+Be]>1?Pt(rt,Tt,this.clusterProps):this.points[rt[Tt+Re]])}return At}getChildren(ne){const oe=this._getOriginId(ne),Se=this._getOriginZoom(ne),Ie="No cluster with the specified id.",$e=this.trees[Se];if(!$e)throw new Error(Ie);const Xe=$e.data;if(oe*this.stride>=Xe.length)throw new Error(Ie);const He=this.options.radius/(this.options.extent*Math.pow(2,Se-1)),ze=$e.within(Xe[oe*this.stride],Xe[oe*this.stride+1],He),rt=[];for(const At of ze){const Mt=At*this.stride;Xe[Mt+4]===ne&&rt.push(Xe[Mt+Be]>1?Pt(Xe,Mt,this.clusterProps):this.points[Xe[Mt+Re]])}if(rt.length===0)throw new Error(Ie);return rt}getLeaves(ne,oe,Se){const Ie=[];return this._appendLeaves(Ie,ne,oe=oe||10,Se=Se||0,0),Ie}getTile(ne,oe,Se){const Ie=this.trees[this._limitZoom(ne)],$e=Math.pow(2,ne),{extent:Xe,radius:He}=this.options,ze=He/Xe,rt=(Se-ze)/$e,At=(Se+1+ze)/$e,Mt={features:[]};return this._addTileFeatures(Ie.range((oe-ze)/$e,rt,(oe+1+ze)/$e,At),Ie.data,oe,Se,$e,Mt),oe===0&&this._addTileFeatures(Ie.range(1-ze/$e,rt,1,At),Ie.data,$e,Se,$e,Mt),oe===$e-1&&this._addTileFeatures(Ie.range(0,rt,ze/$e,At),Ie.data,-1,Se,$e,Mt),Mt.features.length?Mt:null}getClusterExpansionZoom(ne){let oe=this._getOriginZoom(ne)-1;for(;oe<=this.options.maxZoom;){const Se=this.getChildren(ne);if(oe++,Se.length!==1)break;ne=Se[0].properties.cluster_id}return oe}_appendLeaves(ne,oe,Se,Ie,$e){const Xe=this.getChildren(oe);for(const He of Xe){const ze=He.properties;if(ze&&ze.cluster?$e+ze.point_count<=Ie?$e+=ze.point_count:$e=this._appendLeaves(ne,ze.cluster_id,Se,Ie,$e):$e<Ie?$e++:ne.push(He),ne.length===Se)break}return $e}_createTree(ne){const oe=new i.KDBush(ne.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Se=0;Se<ne.length;Se+=this.stride)oe.add(ne[Se],ne[Se+1]);return oe.finish(),oe.data=ne,oe}_addTileFeatures(ne,oe,Se,Ie,$e,Xe){for(const He of ne){const ze=He*this.stride,rt=oe[ze+Be]>1;let At,Mt,Tt;if(rt)At=$t(oe,ze,this.clusterProps),Mt=oe[ze],Tt=oe[ze+1];else{const mr=this.points[oe[ze+Re]];At=mr.properties;const[_r,Pr]=mr.geometry.coordinates;Mt=nr(_r),Tt=Nt(Pr)}const pr={type:1,geometry:[[Math.round(this.options.extent*(Mt*$e-Se)),Math.round(this.options.extent*(Tt*$e-Ie))]],tags:At};let br;br=rt||this.options.generateId?oe[ze+Re]:this.points[oe[ze+Re]].id,br!==void 0&&(pr.id=br),Xe.features.push(pr)}}_limitZoom(ne){return Math.max(this.options.minZoom,Math.min(Math.floor(+ne),this.options.maxZoom+1))}_cluster(ne,oe){const{radius:Se,extent:Ie,reduce:$e,minPoints:Xe}=this.options,He=Se/(Ie*Math.pow(2,oe)),ze=ne.data,rt=[],At=this.stride;for(let Mt=0;Mt<ze.length;Mt+=At){if(ze[Mt+2]<=oe)continue;ze[Mt+2]=oe;const Tt=ze[Mt],pr=ze[Mt+1],br=ne.within(ze[Mt],ze[Mt+1],He),mr=ze[Mt+Be];let _r=mr;for(const Pr of br){const Cn=Pr*At;ze[Cn+2]>oe&&(_r+=ze[Cn+Be])}if(_r>mr&&_r>=Xe){let Pr,Cn=Tt*mr,Xn=pr*mr,Fi=-1;const li=((Mt/At|0)<<5)+(oe+1)+this.points.length;for(const Ia of br){const yi=Ia*At;if(ze[yi+2]<=oe)continue;ze[yi+2]=oe;const Yi=ze[yi+Be];Cn+=ze[yi]*Yi,Xn+=ze[yi+1]*Yi,ze[yi+4]=li,$e&&(Pr||(Pr=this._map(ze,Mt,!0),Fi=this.clusterProps.length,this.clusterProps.push(Pr)),$e(Pr,this._map(ze,yi)))}ze[Mt+4]=li,rt.push(Cn/_r,Xn/_r,1/0,li,-1,_r),$e&&rt.push(Fi)}else{for(let Pr=0;Pr<At;Pr++)rt.push(ze[Mt+Pr]);if(_r>1)for(const Pr of br){const Cn=Pr*At;if(!(ze[Cn+2]<=oe)){ze[Cn+2]=oe;for(let Xn=0;Xn<At;Xn++)rt.push(ze[Cn+Xn])}}}}return rt}_getOriginId(ne){return ne-this.points.length>>5}_getOriginZoom(ne){return(ne-this.points.length)%32}_map(ne,oe,Se){if(ne[oe+Be]>1){const Xe=this.clusterProps[ne[oe+Fe]];return Se?Object.assign({},Xe):Xe}const Ie=this.points[ne[oe+Re]].properties,$e=this.options.map(Ie);return Se&&$e===Ie?Object.assign({},$e):$e}}function Pt(Ce,ne,oe){return{type:"Feature",id:Ce[ne+Re],properties:$t(Ce,ne,oe),geometry:{type:"Point",coordinates:[(Se=Ce[ne],360*(Se-.5)),Jt(Ce[ne+1])]}};var Se}function $t(Ce,ne,oe){const Se=Ce[ne+Be],Ie=Se>=1e4?`${Math.round(Se/1e3)}k`:Se>=1e3?Math.round(Se/100)/10+"k":Se,$e=Ce[ne+Fe],Xe=$e===-1?{}:Object.assign({},oe[$e]);return Object.assign(Xe,{cluster:!0,cluster_id:Ce[ne+Re],point_count:Se,point_count_abbreviated:Ie})}function nr(Ce){return Ce/360+.5}function Nt(Ce){const ne=Math.sin(Ce*Math.PI/180),oe=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return oe<0?0:oe>1?1:oe}function Jt(Ce){const ne=(180-360*Ce)*Math.PI/180;return 360*Math.atan(Math.exp(ne))/Math.PI-90}function ft(Ce,ne,oe,Se){for(var Ie,$e=Se,Xe=oe-ne>>1,He=oe-ne,ze=Ce[ne],rt=Ce[ne+1],At=Ce[oe],Mt=Ce[oe+1],Tt=ne+3;Tt<oe;Tt+=3){var pr=vt(Ce[Tt],Ce[Tt+1],ze,rt,At,Mt);if(pr>$e)Ie=Tt,$e=pr;else if(pr===$e){var br=Math.abs(Tt-Xe);br<He&&(Ie=Tt,He=br)}}$e>Se&&(Ie-ne>3&&ft(Ce,ne,Ie,Se),Ce[Ie+2]=$e,oe-Ie>3&&ft(Ce,Ie,oe,Se))}function vt(Ce,ne,oe,Se,Ie,$e){var Xe=Ie-oe,He=$e-Se;if(Xe!==0||He!==0){var ze=((Ce-oe)*Xe+(ne-Se)*He)/(Xe*Xe+He*He);ze>1?(oe=Ie,Se=$e):ze>0&&(oe+=Xe*ze,Se+=He*ze)}return(Xe=Ce-oe)*Xe+(He=ne-Se)*He}function lt(Ce,ne,oe,Se){var Ie={id:Ce===void 0?null:Ce,type:ne,geometry:oe,tags:Se,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function($e){var Xe=$e.geometry,He=$e.type;if(He==="Point"||He==="MultiPoint"||He==="LineString")it($e,Xe);else if(He==="Polygon"||He==="MultiLineString")for(var ze=0;ze<Xe.length;ze++)it($e,Xe[ze]);else if(He==="MultiPolygon")for(ze=0;ze<Xe.length;ze++)for(var rt=0;rt<Xe[ze].length;rt++)it($e,Xe[ze][rt])}(Ie),Ie}function it(Ce,ne){for(var oe=0;oe<ne.length;oe+=3)Ce.minX=Math.min(Ce.minX,ne[oe]),Ce.minY=Math.min(Ce.minY,ne[oe+1]),Ce.maxX=Math.max(Ce.maxX,ne[oe]),Ce.maxY=Math.max(Ce.maxY,ne[oe+1])}function ar(Ce,ne,oe,Se){if(ne.geometry){var Ie=ne.geometry.coordinates,$e=ne.geometry.type,Xe=Math.pow(oe.tolerance/((1<<oe.maxZoom)*oe.extent),2),He=[],ze=ne.id;if(oe.promoteId?ze=ne.properties[oe.promoteId]:oe.generateId&&(ze=Se||0),$e==="Point")We(Ie,He);else if($e==="MultiPoint")for(var rt=0;rt<Ie.length;rt++)We(Ie[rt],He);else if($e==="LineString")pt(Ie,He,Xe,!1);else if($e==="MultiLineString"){if(oe.lineMetrics){for(rt=0;rt<Ie.length;rt++)pt(Ie[rt],He=[],Xe,!1),Ce.push(lt(ze,"LineString",He,ne.properties));return}Wt(Ie,He,Xe,!1)}else if($e==="Polygon")Wt(Ie,He,Xe,!0);else{if($e!=="MultiPolygon"){if($e==="GeometryCollection"){for(rt=0;rt<ne.geometry.geometries.length;rt++)ar(Ce,{id:ze,geometry:ne.geometry.geometries[rt],properties:ne.properties},oe,Se);return}throw new Error("Input data is not a valid GeoJSON object.")}for(rt=0;rt<Ie.length;rt++){var At=[];Wt(Ie[rt],At,Xe,!0),He.push(At)}}Ce.push(lt(ze,$e,He,ne.properties))}}function We(Ce,ne){ne.push(cr(Ce[0])),ne.push(Gr(Ce[1])),ne.push(0)}function pt(Ce,ne,oe,Se){for(var Ie,$e,Xe=0,He=0;He<Ce.length;He++){var ze=cr(Ce[He][0]),rt=Gr(Ce[He][1]);ne.push(ze),ne.push(rt),ne.push(0),He>0&&(Xe+=Se?(Ie*rt-ze*$e)/2:Math.sqrt(Math.pow(ze-Ie,2)+Math.pow(rt-$e,2))),Ie=ze,$e=rt}var At=ne.length-3;ne[2]=1,ft(ne,0,At,oe),ne[At+2]=1,ne.size=Math.abs(Xe),ne.start=0,ne.end=ne.size}function Wt(Ce,ne,oe,Se){for(var Ie=0;Ie<Ce.length;Ie++){var $e=[];pt(Ce[Ie],$e,oe,Se),ne.push($e)}}function cr(Ce){return Ce/360+.5}function Gr(Ce){var ne=Math.sin(Ce*Math.PI/180),oe=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return oe<0?0:oe>1?1:oe}function ln(Ce,ne,oe,Se,Ie,$e,Xe,He){if(Se/=ne,$e>=(oe/=ne)&&Xe<Se)return Ce;if(Xe<oe||$e>=Se)return null;for(var ze=[],rt=0;rt<Ce.length;rt++){var At=Ce[rt],Mt=At.geometry,Tt=At.type,pr=Ie===0?At.minX:At.minY,br=Ie===0?At.maxX:At.maxY;if(pr>=oe&&br<Se)ze.push(At);else if(!(br<oe||pr>=Se)){var mr=[];if(Tt==="Point"||Tt==="MultiPoint")si(Mt,mr,oe,Se,Ie);else if(Tt==="LineString")ki(Mt,mr,oe,Se,Ie,!1,He.lineMetrics);else if(Tt==="MultiLineString")lo(Mt,mr,oe,Se,Ie,!1);else if(Tt==="Polygon")lo(Mt,mr,oe,Se,Ie,!0);else if(Tt==="MultiPolygon")for(var _r=0;_r<Mt.length;_r++){var Pr=[];lo(Mt[_r],Pr,oe,Se,Ie,!0),Pr.length&&mr.push(Pr)}if(mr.length){if(He.lineMetrics&&Tt==="LineString"){for(_r=0;_r<mr.length;_r++)ze.push(lt(At.id,Tt,mr[_r],At.tags));continue}Tt!=="LineString"&&Tt!=="MultiLineString"||(mr.length===1?(Tt="LineString",mr=mr[0]):Tt="MultiLineString"),Tt!=="Point"&&Tt!=="MultiPoint"||(Tt=mr.length===3?"Point":"MultiPoint"),ze.push(lt(At.id,Tt,mr,At.tags))}}}return ze.length?ze:null}function si(Ce,ne,oe,Se,Ie){for(var $e=0;$e<Ce.length;$e+=3){var Xe=Ce[$e+Ie];Xe>=oe&&Xe<=Se&&(ne.push(Ce[$e]),ne.push(Ce[$e+1]),ne.push(Ce[$e+2]))}}function ki(Ce,ne,oe,Se,Ie,$e,Xe){for(var He,ze,rt=Hn(Ce),At=Ie===0?Ll:Pf,Mt=Ce.start,Tt=0;Tt<Ce.length-3;Tt+=3){var pr=Ce[Tt],br=Ce[Tt+1],mr=Ce[Tt+2],_r=Ce[Tt+3],Pr=Ce[Tt+4],Cn=Ie===0?pr:br,Xn=Ie===0?_r:Pr,Fi=!1;Xe&&(He=Math.sqrt(Math.pow(pr-_r,2)+Math.pow(br-Pr,2))),Cn<oe?Xn>oe&&(ze=At(rt,pr,br,_r,Pr,oe),Xe&&(rt.start=Mt+He*ze)):Cn>Se?Xn<Se&&(ze=At(rt,pr,br,_r,Pr,Se),Xe&&(rt.start=Mt+He*ze)):cs(rt,pr,br,mr),Xn<oe&&Cn>=oe&&(ze=At(rt,pr,br,_r,Pr,oe),Fi=!0),Xn>Se&&Cn<=Se&&(ze=At(rt,pr,br,_r,Pr,Se),Fi=!0),!$e&&Fi&&(Xe&&(rt.end=Mt+He*ze),ne.push(rt),rt=Hn(Ce)),Xe&&(Mt+=He)}var li=Ce.length-3;pr=Ce[li],br=Ce[li+1],mr=Ce[li+2],(Cn=Ie===0?pr:br)>=oe&&Cn<=Se&&cs(rt,pr,br,mr),li=rt.length-3,$e&&li>=3&&(rt[li]!==rt[0]||rt[li+1]!==rt[1])&&cs(rt,rt[0],rt[1],rt[2]),rt.length&&ne.push(rt)}function Hn(Ce){var ne=[];return ne.size=Ce.size,ne.start=Ce.start,ne.end=Ce.end,ne}function lo(Ce,ne,oe,Se,Ie,$e){for(var Xe=0;Xe<Ce.length;Xe++)ki(Ce[Xe],ne,oe,Se,Ie,$e,!1)}function cs(Ce,ne,oe,Se){Ce.push(ne),Ce.push(oe),Ce.push(Se)}function Ll(Ce,ne,oe,Se,Ie,$e){var Xe=($e-ne)/(Se-ne);return Ce.push($e),Ce.push(oe+(Ie-oe)*Xe),Ce.push(1),Xe}function Pf(Ce,ne,oe,Se,Ie,$e){var Xe=($e-oe)/(Ie-oe);return Ce.push(ne+(Se-ne)*Xe),Ce.push($e),Ce.push(1),Xe}function Fo(Ce,ne){for(var oe=[],Se=0;Se<Ce.length;Se++){var Ie,$e=Ce[Se],Xe=$e.type;if(Xe==="Point"||Xe==="MultiPoint"||Xe==="LineString")Ie=nl($e.geometry,ne);else if(Xe==="MultiLineString"||Xe==="Polygon"){Ie=[];for(var He=0;He<$e.geometry.length;He++)Ie.push(nl($e.geometry[He],ne))}else if(Xe==="MultiPolygon")for(Ie=[],He=0;He<$e.geometry.length;He++){for(var ze=[],rt=0;rt<$e.geometry[He].length;rt++)ze.push(nl($e.geometry[He][rt],ne));Ie.push(ze)}oe.push(lt($e.id,Xe,Ie,$e.tags))}return oe}function nl(Ce,ne){var oe=[];oe.size=Ce.size,Ce.start!==void 0&&(oe.start=Ce.start,oe.end=Ce.end);for(var Se=0;Se<Ce.length;Se+=3)oe.push(Ce[Se]+ne,Ce[Se+1],Ce[Se+2]);return oe}function Id(Ce,ne){if(Ce.transformed)return Ce;var oe,Se,Ie,$e=1<<Ce.z,Xe=Ce.x,He=Ce.y;for(oe=0;oe<Ce.features.length;oe++){var ze=Ce.features[oe],rt=ze.geometry,At=ze.type;if(ze.geometry=[],At===1)for(Se=0;Se<rt.length;Se+=2)ze.geometry.push(Bl(rt[Se],rt[Se+1],ne,$e,Xe,He));else for(Se=0;Se<rt.length;Se++){var Mt=[];for(Ie=0;Ie<rt[Se].length;Ie+=2)Mt.push(Bl(rt[Se][Ie],rt[Se][Ie+1],ne,$e,Xe,He));ze.geometry.push(Mt)}}return Ce.transformed=!0,Ce}function Bl(Ce,ne,oe,Se,Ie,$e){return[Math.round(oe*(Ce*Se-Ie)),Math.round(oe*(ne*Se-$e))]}function Zc(Ce,ne,oe,Se,Ie){for(var $e=ne===Ie.maxZoom?0:Ie.tolerance/((1<<ne)*Ie.extent),Xe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:oe,y:Se,z:ne,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},He=0;He<Ce.length;He++){Xe.numFeatures++,Od(Xe,Ce[He],$e,Ie);var ze=Ce[He].minX,rt=Ce[He].minY,At=Ce[He].maxX,Mt=Ce[He].maxY;ze<Xe.minX&&(Xe.minX=ze),rt<Xe.minY&&(Xe.minY=rt),At>Xe.maxX&&(Xe.maxX=At),Mt>Xe.maxY&&(Xe.maxY=Mt)}return Xe}function Od(Ce,ne,oe,Se){var Ie=ne.geometry,$e=ne.type,Xe=[];if($e==="Point"||$e==="MultiPoint")for(var He=0;He<Ie.length;He+=3)Xe.push(Ie[He]),Xe.push(Ie[He+1]),Ce.numPoints++,Ce.numSimplified++;else if($e==="LineString")zl(Xe,Ie,Ce,oe,!1,!1);else if($e==="MultiLineString"||$e==="Polygon")for(He=0;He<Ie.length;He++)zl(Xe,Ie[He],Ce,oe,$e==="Polygon",He===0);else if($e==="MultiPolygon")for(var ze=0;ze<Ie.length;ze++){var rt=Ie[ze];for(He=0;He<rt.length;He++)zl(Xe,rt[He],Ce,oe,!0,He===0)}if(Xe.length){var At=ne.tags||null;if($e==="LineString"&&Se.lineMetrics){for(var Mt in At={},ne.tags)At[Mt]=ne.tags[Mt];At.mapbox_clip_start=Ie.start/Ie.size,At.mapbox_clip_end=Ie.end/Ie.size}var Tt={geometry:Xe,type:$e==="Polygon"||$e==="MultiPolygon"?3:$e==="LineString"||$e==="MultiLineString"?2:1,tags:At};ne.id!==null&&(Tt.id=ne.id),Ce.features.push(Tt)}}function zl(Ce,ne,oe,Se,Ie,$e){var Xe=Se*Se;if(Se>0&&ne.size<(Ie?Xe:Se))oe.numPoints+=ne.length/3;else{for(var He=[],ze=0;ze<ne.length;ze+=3)(Se===0||ne[ze+2]>Xe)&&(oe.numSimplified++,He.push(ne[ze]),He.push(ne[ze+1])),oe.numPoints++;Ie&&function(rt,At){for(var Mt=0,Tt=0,pr=rt.length,br=pr-2;Tt<pr;br=Tt,Tt+=2)Mt+=(rt[Tt]-rt[br])*(rt[Tt+1]+rt[br+1]);if(Mt>0===At)for(Tt=0,pr=rt.length;Tt<pr/2;Tt+=2){var mr=rt[Tt],_r=rt[Tt+1];rt[Tt]=rt[pr-2-Tt],rt[Tt+1]=rt[pr-1-Tt],rt[pr-2-Tt]=mr,rt[pr-1-Tt]=_r}}(He,$e),Ce.push(He)}}function il(Ce,ne){var oe=(ne=this.options=function(Ie,$e){for(var Xe in $e)Ie[Xe]=$e[Xe];return Ie}(Object.create(this.options),ne)).debug;if(oe&&console.time("preprocess data"),ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");var Se=function(Ie,$e){var Xe=[];if(Ie.type==="FeatureCollection")for(var He=0;He<Ie.features.length;He++)ar(Xe,Ie.features[He],$e,He);else ar(Xe,Ie.type==="Feature"?Ie:{geometry:Ie},$e);return Xe}(Ce,ne);this.tiles={},this.tileCoords=[],oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ne.indexMaxZoom,ne.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Se=function(Ie,$e){var Xe=$e.buffer/$e.extent,He=Ie,ze=ln(Ie,1,-1-Xe,Xe,0,-1,2,$e),rt=ln(Ie,1,1-Xe,2+Xe,0,-1,2,$e);return(ze||rt)&&(He=ln(Ie,1,-Xe,1+Xe,0,-1,2,$e)||[],ze&&(He=Fo(ze,1).concat(He)),rt&&(He=He.concat(Fo(rt,-1)))),He}(Se,ne),Se.length&&this.splitTile(Se,0,0,0),oe&&(Se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function $l(Ce,ne,oe){return 32*((1<<Ce)*oe+ne)+Ce}function Fl(Ce,ne){const oe=Ce.tileID.canonical;if(!this._geoJSONIndex)return ne(null,null);const Se=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);if(!Se)return ne(null,null);const Ie=new class{constructor(Xe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.EXTENT,this.length=Xe.length,this._features=Xe}feature(Xe){return new class{constructor(He){this._feature=He,this.extent=i.EXTENT,this.type=He.type,this.properties=He.tags,"id"in He&&!isNaN(He.id)&&(this.id=parseInt(He.id,10))}loadGeometry(){if(this._feature.type===1){const He=[];for(const ze of this._feature.geometry)He.push([new i.Point(ze[0],ze[1])]);return He}{const He=[];for(const ze of this._feature.geometry){const rt=[];for(const At of ze)rt.push(new i.Point(At[0],At[1]));He.push(rt)}return He}}toGeoJSON(He,ze,rt){return N.call(this,He,ze,rt)}}(this._features[Xe])}}(Se.features);let $e=ce(Ie);$e.byteOffset===0&&$e.byteLength===$e.buffer.byteLength||($e=new Uint8Array($e)),ne(null,{vectorTile:Ie,rawData:$e.buffer})}il.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},il.prototype.splitTile=function(Ce,ne,oe,Se,Ie,$e,Xe){for(var He=[Ce,ne,oe,Se],ze=this.options,rt=ze.debug;He.length;){Se=He.pop(),oe=He.pop(),ne=He.pop(),Ce=He.pop();var At=1<<ne,Mt=$l(ne,oe,Se),Tt=this.tiles[Mt];if(!Tt&&(rt>1&&console.time("creation"),Tt=this.tiles[Mt]=Zc(Ce,ne,oe,Se,ze),this.tileCoords.push({z:ne,x:oe,y:Se}),rt)){rt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ne,oe,Se,Tt.numFeatures,Tt.numPoints,Tt.numSimplified),console.timeEnd("creation"));var pr="z"+ne;this.stats[pr]=(this.stats[pr]||0)+1,this.total++}if(Tt.source=Ce,Ie){if(ne===ze.maxZoom||ne===Ie)continue;var br=1<<Ie-ne;if(oe!==Math.floor($e/br)||Se!==Math.floor(Xe/br))continue}else if(ne===ze.indexMaxZoom||Tt.numPoints<=ze.indexMaxPoints)continue;if(Tt.source=null,Ce.length!==0){rt>1&&console.time("clipping");var mr,_r,Pr,Cn,Xn,Fi,li=.5*ze.buffer/ze.extent,Ia=.5-li,yi=.5+li,Yi=1+li;mr=_r=Pr=Cn=null,Xn=ln(Ce,At,oe-li,oe+yi,0,Tt.minX,Tt.maxX,ze),Fi=ln(Ce,At,oe+Ia,oe+Yi,0,Tt.minX,Tt.maxX,ze),Ce=null,Xn&&(mr=ln(Xn,At,Se-li,Se+yi,1,Tt.minY,Tt.maxY,ze),_r=ln(Xn,At,Se+Ia,Se+Yi,1,Tt.minY,Tt.maxY,ze),Xn=null),Fi&&(Pr=ln(Fi,At,Se-li,Se+yi,1,Tt.minY,Tt.maxY,ze),Cn=ln(Fi,At,Se+Ia,Se+Yi,1,Tt.minY,Tt.maxY,ze),Fi=null),rt>1&&console.timeEnd("clipping"),He.push(mr||[],ne+1,2*oe,2*Se),He.push(_r||[],ne+1,2*oe,2*Se+1),He.push(Pr||[],ne+1,2*oe+1,2*Se),He.push(Cn||[],ne+1,2*oe+1,2*Se+1)}}},il.prototype.getTile=function(Ce,ne,oe){var Se=this.options,Ie=Se.extent,$e=Se.debug;if(Ce<0||Ce>24)return null;var Xe=1<<Ce,He=$l(Ce,ne=(ne%Xe+Xe)%Xe,oe);if(this.tiles[He])return Id(this.tiles[He],Ie);$e>1&&console.log("drilling down to z%d-%d-%d",Ce,ne,oe);for(var ze,rt=Ce,At=ne,Mt=oe;!ze&&rt>0;)rt--,At=Math.floor(At/2),Mt=Math.floor(Mt/2),ze=this.tiles[$l(rt,At,Mt)];return ze&&ze.source?($e>1&&console.log("found parent tile z%d-%d-%d",rt,At,Mt),$e>1&&console.time("drilling down"),this.splitTile(ze.source,rt,At,Mt,Ce,ne,oe),$e>1&&console.timeEnd("drilling down"),this.tiles[He]?Id(this.tiles[He],Ie):null):null};class Kc extends i.VectorTileWorkerSource{constructor(ne,oe,Se,Ie,$e){super(ne,oe,Se,Ie,Fl),$e&&(this.loadGeoJSON=$e)}loadData(ne,oe){const Se=ne&&ne.request,Ie=Se&&Se.collectResourceTiming;this.loadGeoJSON(ne,($e,Xe)=>{if($e||!Xe)return oe($e);if(typeof Xe!="object")return oe(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));{k(Xe,!0);try{if(ne.filter){const ze=i.createExpression(ne.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ze.result==="error")throw new Error(ze.value.map(At=>`${At.key}: ${At.message}`).join(", "));Xe={type:"FeatureCollection",features:Xe.features.filter(At=>ze.value.evaluate({zoom:0},At))}}this._geoJSONIndex=ne.cluster?new Ge(function({superclusterOptions:ze,clusterProperties:rt}){if(!rt||!ze)return ze;const At={},Mt={},Tt={accumulated:null,zoom:0},pr={properties:null},br=Object.keys(rt);for(const mr of br){const[_r,Pr]=rt[mr],Cn=i.createExpression(Pr),Xn=i.createExpression(typeof _r=="string"?[_r,["accumulated"],["get",mr]]:_r);At[mr]=Cn.value,Mt[mr]=Xn.value}return ze.map=mr=>{pr.properties=mr;const _r={};for(const Pr of br)_r[Pr]=At[Pr].evaluate(Tt,pr);return _r},ze.reduce=(mr,_r)=>{pr.properties=_r;for(const Pr of br)Tt.accumulated=mr[Pr],mr[Pr]=Mt[Pr].evaluate(Tt,pr)},ze}(ne)).load(Xe.features):function(ze,rt){return new il(ze,rt)}(Xe,ne.geojsonVtOptions)}catch(ze){return oe(ze)}this.loaded={};const He={};if(Ie){const ze=i.getPerformanceMeasurement(Se);ze&&(He.resourceTiming={},He.resourceTiming[ne.source]=JSON.parse(JSON.stringify(ze)))}oe(null,He)}})}reloadTile(ne,oe){const Se=this.loaded;return Se&&Se[ne.uid]?super.reloadTile(ne,oe):this.loadTile(ne,oe)}loadGeoJSON(ne,oe){if(ne.request)i.getJSON(ne.request,oe);else{if(typeof ne.data!="string")return oe(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));try{return oe(null,JSON.parse(ne.data))}catch{return oe(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ne,oe){try{oe(null,this._geoJSONIndex.getClusterExpansionZoom(ne.clusterId))}catch(Se){oe(Se)}}getClusterChildren(ne,oe){try{oe(null,this._geoJSONIndex.getChildren(ne.clusterId))}catch(Se){oe(Se)}}getClusterLeaves(ne,oe){try{oe(null,this._geoJSONIndex.getLeaves(ne.clusterId,ne.limit,ne.offset))}catch(Se){oe(Se)}}}class Af{constructor(ne){this.self=ne,this.actor=new i.Actor(ne,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=i.getProjection({name:"mercator"}),this.workerSourceTypes={vector:i.VectorTileWorkerSource,geojson:Kc},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(oe,Se)=>{if(this.workerSourceTypes[oe])throw new Error(`Worker source with name "${oe}" already registered.`);this.workerSourceTypes[oe]=Se},this.self.registerRTLTextPlugin=oe=>{if(i.plugin.isParsed())throw new Error("RTL text plugin already registered.");i.plugin.applyArabicShaping=oe.applyArabicShaping,i.plugin.processBidirectionalText=oe.processBidirectionalText,i.plugin.processStyledBidirectionalText=oe.processStyledBidirectionalText}}clearCaches(ne,oe,Se){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne],Se()}checkIfReady(ne,oe,Se){Se()}setReferrer(ne,oe){this.referrer=oe}spriteLoaded(ne,oe){this.isSpriteLoaded[ne]=oe;for(const Se in this.workerSources[ne]){const Ie=this.workerSources[ne][Se];for(const $e in Ie)Ie[$e]instanceof i.VectorTileWorkerSource&&(Ie[$e].isSpriteLoaded=oe,Ie[$e].fire(new i.Event("isSpriteLoaded")))}}setImages(ne,oe,Se){this.availableImages[ne]=oe;for(const Ie in this.workerSources[ne]){const $e=this.workerSources[ne][Ie];for(const Xe in $e)$e[Xe].availableImages=oe}Se()}enableTerrain(ne,oe,Se){this.terrain=oe,Se()}setProjection(ne,oe){this.projections[ne]=i.getProjection(oe)}setLayers(ne,oe,Se){this.getLayerIndex(ne).replace(oe),Se()}updateLayers(ne,oe,Se){this.getLayerIndex(ne).update(oe.layers,oe.removedIds),Se()}loadTile(ne,oe,Se){const Ie=this.enableTerrain?i.extend({enableTerrain:this.terrain},oe):oe;Ie.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,oe.type,oe.source).loadTile(Ie,Se)}loadDEMTile(ne,oe,Se){const Ie=this.enableTerrain?i.extend({buildQuadTree:this.terrain},oe):oe;this.getDEMWorkerSource(ne,oe.source).loadTile(Ie,Se)}reloadTile(ne,oe,Se){const Ie=this.enableTerrain?i.extend({enableTerrain:this.terrain},oe):oe;Ie.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,oe.type,oe.source).reloadTile(Ie,Se)}abortTile(ne,oe,Se){this.getWorkerSource(ne,oe.type,oe.source).abortTile(oe,Se)}removeTile(ne,oe,Se){this.getWorkerSource(ne,oe.type,oe.source).removeTile(oe,Se)}removeSource(ne,oe,Se){if(!this.workerSources[ne]||!this.workerSources[ne][oe.type]||!this.workerSources[ne][oe.type][oe.source])return;const Ie=this.workerSources[ne][oe.type][oe.source];delete this.workerSources[ne][oe.type][oe.source],Ie.removeSource!==void 0?Ie.removeSource(oe,Se):Se()}loadWorkerSource(ne,oe,Se){try{this.self.importScripts(oe.url),Se()}catch(Ie){Se(Ie.toString())}}syncRTLPluginState(ne,oe,Se){try{i.plugin.setState(oe);const Ie=i.plugin.getPluginURL();if(i.plugin.isLoaded()&&!i.plugin.isParsed()&&Ie!=null){this.self.importScripts(Ie);const $e=i.plugin.isParsed();Se($e?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ie}`),$e)}}catch(Ie){Se(Ie.toString())}}getAvailableImages(ne){let oe=this.availableImages[ne];return oe||(oe=[]),oe}getLayerIndex(ne){let oe=this.layerIndexes[ne];return oe||(oe=this.layerIndexes[ne]=new b),oe}getWorkerSource(ne,oe,Se){if(this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][oe]||(this.workerSources[ne][oe]={}),!this.workerSources[ne][oe][Se]){const Ie={send:($e,Xe,He,ze,rt,At)=>{this.actor.send($e,Xe,He,ne,rt,At)},scheduler:this.actor.scheduler};this.workerSources[ne][oe][Se]=new this.workerSourceTypes[oe](Ie,this.getLayerIndex(ne),this.getAvailableImages(ne),this.isSpriteLoaded[ne])}return this.workerSources[ne][oe][Se]}getDEMWorkerSource(ne,oe){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][oe]||(this.demWorkerSources[ne][oe]=new _),this.demWorkerSources[ne][oe]}enforceCacheSizeLimit(ne,oe){i.enforceCacheSizeLimit(oe)}getWorkerPerformanceMetrics(ne,oe,Se){Se(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Af(self)),Af}),s(["./shared"],function(i){function p(v,d){if(Array.isArray(v)){if(!Array.isArray(d)||v.length!==d.length)return!1;for(let m=0;m<v.length;m++)if(!p(v[m],d[m]))return!1;return!0}if(typeof v=="object"&&v!==null&&d!==null){if(typeof d!="object"||Object.keys(v).length!==Object.keys(d).length)return!1;for(const m in v)if(!p(v[m],d[m]))return!1;return!0}return v===d}var y=b;function b(v){return!function(d){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,T,P=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(P);try{T=new Worker(L),w=!0}catch{w=!1}return T&&T.terminate(),URL.revokeObjectURL(L),w}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var w=document.createElement("canvas");w.width=w.height=1;var T=w.getContext("2d");if(!T)return!1;var P=T.getImageData(0,0,1,1);return P&&P.width===w.width}()?(_[m=d&&d.failIfMajorPerformanceCaveat]===void 0&&(_[m]=function(w){var T,P=function(L){var z=document.createElement("canvas"),U=Object.create(b.webGLContextAttributes);return U.failIfMajorPerformanceCaveat=L,z.getContext("webgl",U)||z.getContext("experimental-webgl",U)}(w);if(!P)return!1;try{T=P.createShader(P.VERTEX_SHADER)}catch{return!1}return!(!T||P.isContextLost())&&(P.shaderSource(T,"void main() {}"),P.compileShader(T),P.getShaderParameter(T,P.COMPILE_STATUS)===!0)}(m)),_[m]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var m}(v)}var _={};function E(v,d,m){const w=i.window.document.createElement(v);return d!==void 0&&(w.className=d),m&&m.appendChild(w),w}function C(v,d,m){const w=i.window.document.createElementNS("http://www.w3.org/2000/svg",v);for(const T of Object.keys(d))w.setAttributeNS(null,T,d[T]);return m&&m.appendChild(w),w}b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const k=i.window.document&&i.window.document.documentElement.style,N=k&&k.userSelect!==void 0?"userSelect":"WebkitUserSelect";let I;function B(){k&&N&&(I=k[N],k[N]="none")}function O(){k&&N&&(k[N]=I)}function R(v){v.preventDefault(),v.stopPropagation(),i.window.removeEventListener("click",R,!0)}function q(){i.window.addEventListener("click",R,!0),i.window.setTimeout(()=>{i.window.removeEventListener("click",R,!0)},0)}function F(v,d){const m=v.getBoundingClientRect();return ee(v,m,d)}function X(v,d){const m=v.getBoundingClientRect(),w=[];for(let T=0;T<d.length;T++)w.push(ee(v,m,d[T]));return w}function G(v){return i.window.InstallTrigger!==void 0&&v.button===2&&v.ctrlKey&&i.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button}function ee(v,d,m){const w=v.offsetWidth===d.width?1:v.offsetWidth/d.width;return new i.Point((m.clientX-d.left)*w,(m.clientY-d.top)*w)}function K(v,d){var m=d[0],w=d[1],T=d[2],P=d[3],L=m*P-T*w;return L?(v[0]=P*(L=1/L),v[1]=-w*L,v[2]=-T*L,v[3]=m*L,v):null}function ie(v){const{userImage:d}=v;return!!(d&&d.render&&d.render())&&(v.data.replace(new Uint8Array(d.data.buffer)),!0)}class pe extends i.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new i.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(d){if(this.loaded!==d&&(this.loaded=d,d)){for(const{ids:m,callback:w}of this.requestors)this._notify(m,w);this.requestors=[]}}hasImage(d){return!!this.getImage(d)}getImage(d){return this.images[d]}addImage(d,m){this._validate(d,m)&&(this.images[d]=m)}_validate(d,m){let w=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new i.ErrorEvent(new Error(`Image "${d}" has invalid "stretchX" value`))),w=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new i.ErrorEvent(new Error(`Image "${d}" has invalid "stretchY" value`))),w=!1),this._validateContent(m.content,m)||(this.fire(new i.ErrorEvent(new Error(`Image "${d}" has invalid "content" value`))),w=!1),w}_validateStretch(d,m){if(!d)return!0;let w=0;for(const T of d){if(T[0]<w||T[1]<T[0]||m<T[1])return!1;w=T[1]}return!0}_validateContent(d,m){return!(d&&(d.length!==4||d[0]<0||m.data.width<d[0]||d[1]<0||m.data.height<d[1]||d[2]<0||m.data.width<d[2]||d[3]<0||m.data.height<d[3]||d[2]<d[0]||d[3]<d[1]))}updateImage(d,m){m.version=this.images[d].version+1,this.images[d]=m,this.updatedImages[d]=!0}removeImage(d){const m=this.images[d];delete this.images[d],delete this.patterns[d],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(d,m){let w=!0;if(!this.isLoaded())for(const T of d)this.images[T]||(w=!1);this.isLoaded()||w?this._notify(d,m):this.requestors.push({ids:d,callback:m})}_notify(d,m){const w={};for(const T of d){this.images[T]||this.fire(new i.Event("styleimagemissing",{id:T}));const P=this.images[T];P?w[T]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:i.warnOnce(`Image "${T}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,w)}getPixelSize(){const{width:d,height:m}=this.atlasImage;return{width:d,height:m}}getPattern(d){const m=this.patterns[d],w=this.getImage(d);if(!w)return null;if(m&&m.position.version===w.version)return m.position;if(m)m.position.version=w.version;else{const T={w:w.data.width+2,h:w.data.height+2,x:0,y:0},P=new i.ImagePosition(T,w);this.patterns[d]={bin:T,position:P}}return this._updatePatternAtlas(),this.patterns[d].position}bind(d){const m=d.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new i.Texture(d,this.atlasImage,m.RGBA),this.atlasTexture&&this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const d=[];for(const P in this.patterns)d.push(this.patterns[P].bin);const{w:m,h:w}=i.potpack(d),T=this.atlasImage;T.resize({width:m||1,height:w||1});for(const P in this.patterns){const{bin:L}=this.patterns[P],z=L.x+1,U=L.y+1,Z=this.images[P].data,H=Z.width,Q=Z.height;i.RGBAImage.copy(Z,T,{x:0,y:0},{x:z,y:U},{width:H,height:Q}),i.RGBAImage.copy(Z,T,{x:0,y:Q-1},{x:z,y:U-1},{width:H,height:1}),i.RGBAImage.copy(Z,T,{x:0,y:0},{x:z,y:U+Q},{width:H,height:1}),i.RGBAImage.copy(Z,T,{x:H-1,y:0},{x:z-1,y:U},{width:1,height:Q}),i.RGBAImage.copy(Z,T,{x:0,y:0},{x:z+H,y:U},{width:1,height:Q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(d){for(const m of d){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const w=this.images[m];ie(w)&&this.updateImage(m,w)}}}const ae=new i.Properties({anchor:new i.DataConstantProperty(i.spec.light.anchor),position:new class{constructor(){this.specification=i.spec.light.position}possiblyEvaluate(v,d){return function([m,w,T]){const P=i.degToRad(w+90),L=i.degToRad(T);return{x:m*Math.cos(P)*Math.sin(L),y:m*Math.sin(P)*Math.sin(L),z:m*Math.cos(L),azimuthal:w,polar:T}}(v.expression.evaluate(d))}interpolate(v,d,m){return{x:i.number(v.x,d.x,m),y:i.number(v.y,d.y,m),z:i.number(v.z,d.z,m),azimuthal:i.number(v.azimuthal,d.azimuthal,m),polar:i.number(v.polar,d.polar,m)}}},color:new i.DataConstantProperty(i.spec.light.color),intensity:new i.DataConstantProperty(i.spec.light.intensity)});class _e extends i.Evented{constructor(d){super(),this._transitionable=new i.Transitionable(ae),this.setLight(d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(d,m={}){if(!this._validate(i.validateLight,d,m))for(const w in d){const T=d[w];i.endsWith(w,"-transition")?this._transitionable.setTransition(w.slice(0,-11),T):this._transitionable.setValue(w,T)}}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,m,w){return(!w||w.validate!==!1)&&i.emitValidationErrors(this,d.call(i.validateStyle,i.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:i.spec})))}}const Ee=new i.Properties({source:new i.DataConstantProperty(i.spec.terrain.source),exaggeration:new i.DataConstantProperty(i.spec.terrain.exaggeration)});let xe=class extends i.Evented{constructor(v,d){super(),this._transitionable=new i.Transitionable(Ee),this.set(v),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=d}get(){return this._transitionable.serialize()}set(v){for(const d in v){const m=v[d];i.endsWith(d,"-transition")?this._transitionable.setTransition(d.slice(0,-11),m):this._transitionable.setValue(d,m)}}updateTransitions(v){this._transitioning=this._transitionable.transitioned(v,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(v){this.properties=this._transitioning.possiblyEvaluate(v)}};function ce(v,d,m,w){const T=i.smoothstep(45,65,m),[P,L]=ke(v,w),z=i.length(d);let U=1-Math.min(1,Math.exp((z-P)/(L-P)*-6));return U*=U*U,U=Math.min(1,1.00747*U),U*T*v.alpha}function ke(v,d){const m=.5/Math.tan(.5*d);return[v.range[0]+m,v.range[1]+m]}const ve=new i.Properties({range:new i.DataConstantProperty(i.spec.fog.range),color:new i.DataConstantProperty(i.spec.fog.color),"high-color":new i.DataConstantProperty(i.spec.fog["high-color"]),"space-color":new i.DataConstantProperty(i.spec.fog["space-color"]),"horizon-blend":new i.DataConstantProperty(i.spec.fog["horizon-blend"]),"star-intensity":new i.DataConstantProperty(i.spec.fog["star-intensity"])});class Pe extends i.Evented{constructor(d,m){super(),this._transitionable=new i.Transitionable(ve),this.set(d),this._transitioning=this._transitionable.untransitioned(),this._transform=m}get state(){const d=this._transform,m=d.projection.name==="globe",w=i.globeToMercatorTransition(d.zoom),T=this.properties.get("range"),P=[.5,3];return{range:m?[i.number(P[0],T[0],w),i.number(P[1],T[1],w)]:T,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(d,m={}){if(!this._validate(i.validateFog,d,m)){for(const w of Object.keys(i.spec.fog))d&&d[w]===void 0&&(d[w]=i.spec.fog[w].default);for(const w in d){const T=d[w];i.endsWith(w,"-transition")?this._transitionable.setTransition(w.slice(0,-11),T):this._transitionable.setValue(w,T)}}}getOpacity(d){if(!this._transform.projection.supportsFog)return 0;const m=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.smoothstep(45,65,d))*m.a}getOpacityAtLatLng(d,m){return this._transform.projection.supportsFog?function(w,T,P){const L=i.MercatorCoordinate.fromLngLat(T),z=P.elevation?P.elevation.getAtPointOrZero(L):0,U=[L.x,L.y,z];return i.transformMat4(U,U,P.mercatorFogMatrix),ce(w,U,P.pitch,P._fov)}(this.state,d,m):0}getFovAdjustedRange(d){return this._transform.projection.supportsFog?ke(this.state,d):[0,1]}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,m,w){return(!w||w.validate!==!1)&&i.emitValidationErrors(this,d.call(i.validateStyle,i.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:i.spec})))}}class Re{constructor(d,m){this.workerPool=d,this.actors=[],this.currentActor=0,this.id=i.uniqueId();const w=this.workerPool.acquire(this.id);for(let T=0;T<w.length;T++){const P=new Re.Actor(w[T],m,this.id);P.name=`Worker ${T}`,this.actors.push(P)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(d,m,w){i.asyncAll(this.actors,(T,P)=>{T.send(d,m,P)},w=w||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(d=>{d.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Be(v,d,m){return d*(i.EXTENT/(v.tileSize*Math.pow(2,m-v.tileID.overscaledZ)))}Re.Actor=i.Actor;class Fe{constructor(d,m,w,T){this.screenBounds=d,this.cameraPoint=m,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=w,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,T)}static createFromScreenPoints(d,m){let w,T;if(d instanceof i.Point||typeof d[0]=="number"){const P=i.Point.convert(d);w=[P],T=m.isPointAboveHorizon(P)}else{const P=i.Point.convert(d[0]),L=i.Point.convert(d[1]);w=[P,L],T=i.polygonizeBounds(P,L).every(z=>m.isPointAboveHorizon(z))}return new Fe(w,m.getCameraPoint(),T,m)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(d){return i.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],d)}bufferedCameraGeometry(d){const m=this.screenBounds[0],w=this.screenBounds.length===1?this.screenBounds[0].add(new i.Point(1,1)):this.screenBounds[1],T=i.polygonizeBounds(m,w,0,!1);return this.cameraPoint.y>w.y&&(this.cameraPoint.x>m.x&&this.cameraPoint.x<w.x?T.splice(3,0,this.cameraPoint):this.cameraPoint.x>=w.x?T[2]=this.cameraPoint:this.cameraPoint.x<=m.x&&(T[3]=this.cameraPoint)),i.bufferConvexPolygon(T,d)}bufferedCameraGeometryGlobe(d){const m=this.screenBounds[0],w=this.screenBounds.length===1?this.screenBounds[0].add(new i.Point(1,1)):this.screenBounds[1],T=i.polygonizeBounds(m,w,d),P=this.cameraPoint.clone();switch(3*((P.y>m.y)+(P.y>w.y))+((P.x>m.x)+(P.x>w.x))){case 0:T[0]=P,T[4]=P.clone();break;case 1:T.splice(1,0,P);break;case 2:T[1]=P;break;case 3:T.splice(4,0,P);break;case 5:T.splice(2,0,P);break;case 6:T[3]=P;break;case 7:T.splice(3,0,P);break;case 8:T[2]=P}return T}containsTile(d,m,w,T=0){const P=d.queryPadding/m._pixelsPerMercatorPixel+1,L=w?this._bufferedCameraMercator(P,m):this._bufferedScreenMercator(P,m);let z=d.tileID.wrap+(L.unwrapped?T:0);const U=L.polygon.map(me=>i.getTilePoint(d.tileTransform,me,z));if(!i.polygonIntersectsBox(U,0,0,i.EXTENT,i.EXTENT))return;z=d.tileID.wrap+(this.screenGeometryMercator.unwrapped?T:0);const Z=this.screenGeometryMercator.polygon.map(me=>i.getTileVec3(d.tileTransform,me,z)),H=Z.map(me=>new i.Point(me[0],me[1])),Q=m.getFreeCameraOptions().position||new i.MercatorCoordinate(0,0,0),se=i.getTileVec3(d.tileTransform,Q,z),de=Z.map(me=>{const te=i.sub(me,me,se);return i.normalize(te,te),new i.Ray(se,te)}),fe=Be(d,1,m.zoom)*m._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:H,tilespaceRays:de,bufferedTilespaceGeometry:U,bufferedTilespaceBounds:(he=i.getBounds(U),he.min.x=i.clamp(he.min.x,0,i.EXTENT),he.min.y=i.clamp(he.min.y,0,i.EXTENT),he.max.x=i.clamp(he.max.x,0,i.EXTENT),he.max.y=i.clamp(he.max.y,0,i.EXTENT),he),tile:d,tileID:d.tileID,pixelToTileUnitsFactor:fe};var he}_bufferedScreenMercator(d,m){const w=$t(d);if(this._screenRaycastCache[w])return this._screenRaycastCache[w];{let T;return T=m.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(d),m):{polygon:this.bufferedScreenGeometry(d).map(P=>m.pointCoordinate3D(P)),unwrapped:!0},this._screenRaycastCache[w]=T,T}}_bufferedCameraMercator(d,m){const w=$t(d);if(this._cameraRaycastCache[w])return this._cameraRaycastCache[w];{let T;return T=m.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(d),m):{polygon:this.bufferedCameraGeometry(d).map(P=>m.pointCoordinate3D(P)),unwrapped:!0},this._cameraRaycastCache[w]=T,T}}_projectAndResample(d,m){const w=function(P,L){const z=i.multiply([],L.pixelMatrix,L.globeMatrix),U=[0,-i.GLOBE_RADIUS,0,1],Z=[0,i.GLOBE_RADIUS,0,1],H=[0,0,0,1];i.transformMat4$1(U,U,z),i.transformMat4$1(Z,Z,z),i.transformMat4$1(H,H,z);const Q=new i.Point(U[0]/U[3],U[1]/U[3]),se=new i.Point(Z[0]/Z[3],Z[1]/Z[3]),de=i.polygonContainsPoint(P,Q)&&U[3]<H[3],fe=i.polygonContainsPoint(P,se)&&Z[3]<H[3];if(!de&&!fe)return null;const he=function(De,qe,Ue){for(let Je=1;Je<De.length;Je++){const bt=Pt(qe.pointCoordinate3D(De[Je-1]).x),Ze=Pt(qe.pointCoordinate3D(De[Je]).x);if(Ue<0){if(bt<Ze)return{idx:Je,t:-bt/(Ze-1-bt)}}else if(Ze<bt)return{idx:Je,t:(1-bt)/(Ze+1-bt)}}return null}(P,L,de?-1:1);if(!he)return null;const{idx:me,t:te}=he;let ue=me>1?Ge(P.slice(0,me),L):[],be=me<P.length?Ge(P.slice(me),L):[];ue=ue.map(De=>new i.Point(Pt(De.x),De.y)),be=be.map(De=>new i.Point(Pt(De.x),De.y));const we=[...ue];we.length===0&&we.push(be[be.length-1]);const Oe=i.number(we[we.length-1].y,(be.length===0?ue[0]:be[0]).y,te);let Le;return Le=de?[new i.Point(0,Oe),new i.Point(0,0),new i.Point(1,0),new i.Point(1,Oe)]:[new i.Point(1,Oe),new i.Point(1,1),new i.Point(0,1),new i.Point(0,Oe)],we.push(...Le),be.length===0?we.push(ue[0]):we.push(...be),{polygon:we.map(De=>new i.MercatorCoordinate(De.x,De.y)),unwrapped:!1}}(d,m);if(w)return w;const T=function(P,L){let z=!1,U=-1/0,Z=0;for(let Q=0;Q<P.length-1;Q++)P[Q].x>U&&(U=P[Q].x,Z=Q);for(let Q=0;Q<P.length-1;Q++){const se=(Z+Q)%(P.length-1),de=P[se],fe=P[se+1];Math.abs(de.x-fe.x)>.5&&(de.x<fe.x?(de.x+=1,se===0&&(P[P.length-1].x+=1)):(fe.x+=1,se+1===P.length-1&&(P[0].x+=1)),z=!0)}const H=i.mercatorXfromLng(L.center.lng);return z&&H<Math.abs(H-1)&&P.forEach(Q=>{Q.x-=1}),{polygon:P,unwrapped:z}}(Ge(d,m).map(P=>new i.Point(Pt(P.x),P.y)),m);return{polygon:T.polygon.map(P=>new i.MercatorCoordinate(P.x,P.y)),unwrapped:T.unwrapped}}}function Ge(v,d){return i.resample(v,m=>{const w=d.pointCoordinate3D(m);m.x=w.x,m.y=w.y},1/256)}function Pt(v){return v<0?1+v%1:v%1}function $t(v){return 100*v|0}function nr(v,d,m,w,T){const P=function(L,z){if(L)return T(L);if(z){v.url&&z.tiles&&v.tiles&&delete v.tiles;const U=i.pick(i.extend(z,v),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);z.vector_layers&&(U.vectorLayers=z.vector_layers,U.vectorLayerIds=U.vectorLayers.map(Z=>Z.id)),U.tiles=d.canonicalizeTileset(U,v.url),T(null,U)}};return v.url?i.getJSON(d.transformRequest(d.normalizeSourceURL(v.url,null,m,w),i.ResourceType.Source),P):i.exported.frame(()=>P(null,v))}class Nt{constructor(d,m,w){this.bounds=i.LngLatBounds.convert(this.validateBounds(d)),this.minzoom=m||0,this.maxzoom=w||24}validateBounds(d){return Array.isArray(d)&&d.length===4?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]}contains(d){const m=Math.pow(2,d.z),w=Math.floor(i.mercatorXfromLng(this.bounds.getWest())*m),T=Math.floor(i.mercatorYfromLat(this.bounds.getNorth())*m),P=Math.ceil(i.mercatorXfromLng(this.bounds.getEast())*m),L=Math.ceil(i.mercatorYfromLat(this.bounds.getSouth())*m);return d.x>=w&&d.x<P&&d.y>=T&&d.y<L}}class Jt{constructor(d,m,w){this.context=d;const T=d.gl;this.buffer=T.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(d){const m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ft={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class vt{constructor(d,m,w,T){this.length=m.length,this.attributes=w,this.itemSize=m.bytesPerElement,this.dynamicDraw=T,this.context=d;const P=d.gl;this.buffer=P.createBuffer(),d.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(d){const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,d.arrayBuffer)}enableAttributes(d,m){for(let w=0;w<this.attributes.length;w++){const T=m.attributes[this.attributes[w].name];T!==void 0&&d.enableVertexAttribArray(T)}}setVertexAttribPointers(d,m,w){for(let T=0;T<this.attributes.length;T++){const P=this.attributes[T],L=m.attributes[P.name];L!==void 0&&d.vertexAttribPointer(L,P.components,d[ft[P.type]],!1,this.itemSize,P.offset+this.itemSize*(w||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class lt{constructor(d){this.gl=d.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(d){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class it extends lt{getDefault(){return i.Color.transparent}set(d){const m=this.current;(d.r!==m.r||d.g!==m.g||d.b!==m.b||d.a!==m.a||this.dirty)&&(this.gl.clearColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class ar extends lt{getDefault(){return 1}set(d){(d!==this.current||this.dirty)&&(this.gl.clearDepth(d),this.current=d,this.dirty=!1)}}class We extends lt{getDefault(){return 0}set(d){(d!==this.current||this.dirty)&&(this.gl.clearStencil(d),this.current=d,this.dirty=!1)}}class pt extends lt{getDefault(){return[!0,!0,!0,!0]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||d[2]!==m[2]||d[3]!==m[3]||this.dirty)&&(this.gl.colorMask(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class Wt extends lt{getDefault(){return!0}set(d){(d!==this.current||this.dirty)&&(this.gl.depthMask(d),this.current=d,this.dirty=!1)}}class cr extends lt{getDefault(){return 255}set(d){(d!==this.current||this.dirty)&&(this.gl.stencilMask(d),this.current=d,this.dirty=!1)}}class Gr extends lt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(d){const m=this.current;(d.func!==m.func||d.ref!==m.ref||d.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(d.func,d.ref,d.mask),this.current=d,this.dirty=!1)}}class ln extends lt{getDefault(){const d=this.gl;return[d.KEEP,d.KEEP,d.KEEP]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||d[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(d[0],d[1],d[2]),this.current=d,this.dirty=!1)}}class si extends lt{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=d,this.dirty=!1}}class ki extends lt{getDefault(){return[0,1]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||this.dirty)&&(this.gl.depthRange(d[0],d[1]),this.current=d,this.dirty=!1)}}class Hn extends lt{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=d,this.dirty=!1}}class lo extends lt{getDefault(){return this.gl.LESS}set(d){(d!==this.current||this.dirty)&&(this.gl.depthFunc(d),this.current=d,this.dirty=!1)}}class cs extends lt{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.BLEND):m.disable(m.BLEND),this.current=d,this.dirty=!1}}class Ll extends lt{getDefault(){const d=this.gl;return[d.ONE,d.ZERO]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(d[0],d[1]),this.current=d,this.dirty=!1)}}class Pf extends lt{getDefault(){return i.Color.transparent}set(d){const m=this.current;(d.r!==m.r||d.g!==m.g||d.b!==m.b||d.a!==m.a||this.dirty)&&(this.gl.blendColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class Fo extends lt{getDefault(){return this.gl.FUNC_ADD}set(d){(d!==this.current||this.dirty)&&(this.gl.blendEquation(d),this.current=d,this.dirty=!1)}}class nl extends lt{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=d,this.dirty=!1}}class Id extends lt{getDefault(){return this.gl.BACK}set(d){(d!==this.current||this.dirty)&&(this.gl.cullFace(d),this.current=d,this.dirty=!1)}}class Bl extends lt{getDefault(){return this.gl.CCW}set(d){(d!==this.current||this.dirty)&&(this.gl.frontFace(d),this.current=d,this.dirty=!1)}}let Zc,Od=class extends lt{getDefault(){return null}set(v){(v!==this.current||this.dirty)&&(this.gl.useProgram(v),this.current=v,this.dirty=!1)}};class zl extends lt{getDefault(){return this.gl.TEXTURE0}set(d){(d!==this.current||this.dirty)&&(this.gl.activeTexture(d),this.current=d,this.dirty=!1)}}class il extends lt{getDefault(){const d=this.gl;return[0,0,d.drawingBufferWidth,d.drawingBufferHeight]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||d[2]!==m[2]||d[3]!==m[3]||this.dirty)&&(this.gl.viewport(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class $l extends lt{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,d),this.current=d,this.dirty=!1}}class Fl extends lt{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class Kc extends lt{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,d),this.current=d,this.dirty=!1}}class Af extends lt{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class Ce extends lt{getDefault(){return null}set(d){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class ne extends lt{constructor(d){super(d),this.vao=d.extVertexArrayObject}getDefault(){return null}set(d){this.vao&&(d!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(d),this.current=d,this.dirty=!1)}}class oe extends lt{getDefault(){return 4}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,d),this.current=d,this.dirty=!1}}class Se extends lt{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),this.current=d,this.dirty=!1}}class Ie extends lt{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,d),this.current=d,this.dirty=!1}}class $e extends lt{constructor(d,m){super(d),this.context=d,this.parent=m}getDefault(){return null}}class Xe extends $e{setDirty(){this.dirty=!0}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,d,0),this.current=d,this.dirty=!1}}class He extends $e{attachment(){return this.gl.DEPTH_ATTACHMENT}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,this.attachment(),m.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class ze extends He{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class rt{constructor(d,m,w,T){this.context=d,this.width=m,this.height=w;const P=this.framebuffer=d.gl.createFramebuffer();this.colorAttachment=new Xe(d,P),T&&(this.depthAttachment=new He(d,P))}destroy(){const d=this.context.gl,m=this.colorAttachment.get();if(m&&d.deleteTexture(m),this.depthAttachment){const w=this.depthAttachment.get();w&&d.deleteRenderbuffer(w)}d.deleteFramebuffer(this.framebuffer)}}class At{constructor(d,m=!1){if(this.gl=d,this.isWebGL2=m,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),m){const w=d;this.extVertexArrayObject={createVertexArrayOES:w.createVertexArray.bind(d),deleteVertexArrayOES:w.deleteVertexArray.bind(d),bindVertexArrayOES:w.bindVertexArray.bind(d)}}this.clearColor=new it(this),this.clearDepth=new ar(this),this.clearStencil=new We(this),this.colorMask=new pt(this),this.depthMask=new Wt(this),this.stencilMask=new cr(this),this.stencilFunc=new Gr(this),this.stencilOp=new ln(this),this.stencilTest=new si(this),this.depthRange=new ki(this),this.depthTest=new Hn(this),this.depthFunc=new lo(this),this.blend=new cs(this),this.blendFunc=new Ll(this),this.blendColor=new Pf(this),this.blendEquation=new Fo(this),this.cullFace=new nl(this),this.cullFaceSide=new Id(this),this.frontFace=new Bl(this),this.program=new Od(this),this.activeTexture=new zl(this),this.viewport=new il(this),this.bindFramebuffer=new $l(this),this.bindRenderbuffer=new Fl(this),this.bindTexture=new Kc(this),this.bindVertexBuffer=new Af(this),this.bindElementBuffer=new Ce(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ne(this),this.pixelStoreUnpack=new oe(this),this.pixelStoreUnpackPremultiplyAlpha=new Se(this),this.pixelStoreUnpackFlipY=new Ie(this),this.extTextureFilterAnisotropic=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=d.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=d.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=d.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=d.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),m||(this.extTextureHalfFloat=d.getExtension("OES_texture_half_float")),(m||this.extTextureHalfFloat&&d.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=d.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=m||d.getExtension("OES_standard_derivatives"),this.extTimerQuery=d.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(d,m){return new Jt(this,d,m)}createVertexBuffer(d,m,w){return new vt(this,d,m,w)}createRenderbuffer(d,m,w){const T=this.gl,P=T.createRenderbuffer();return this.bindRenderbuffer.set(P),T.renderbufferStorage(T.RENDERBUFFER,d,m,w),this.bindRenderbuffer.set(null),P}createFramebuffer(d,m,w){return new rt(this,d,m,w)}clear({color:d,depth:m,stencil:w}){const T=this.gl;let P=0;d&&(P|=T.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(P|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),w!==void 0&&(P|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),T.clear(P)}setCullFace(d){d.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))}setDepthMode(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)}setStencilMode(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)}setColorMode(d){p(d.blendFunction,i.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Mt extends i.Evented{constructor(d,m,w,T){if(super(),this.id=d,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.extend(this,i.pick(m,["url","scheme","tileSize","promoteId"])),this._options=i.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(T),this._tileWorkers={},this._deduped=new i.DedupedRequest}load(d){this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"}));const m=Array.isArray(this.map._language)?this.map._language.join():this.map._language,w=this.map._worldview;this._tileJSONRequest=nr(this._options,this.map._requestManager,m,w,(T,P)=>{this._tileJSONRequest=null,this._loaded=!0,T?(m&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${m}`),w&&w.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${w}`),this.fire(new i.ErrorEvent(T))):P&&(i.extend(this,P),P.bounds&&(this.tileBounds=new Nt(P.bounds,this.minzoom,this.maxzoom)),i.postTurnstileEvent(P.tiles,this.map._requestManager._customAccessToken),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(T)})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return i.extend({},this._options)}loadTile(d,m){const w=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),T={request:this.map._requestManager.transformRequest(w,i.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:i.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(T.request.collectResourceTiming=this._collectResourceTiming,d.actor&&d.state!=="expired")d.state==="loading"?d.reloadCallback=m:d.request=d.actor.send("reloadTile",T,P.bind(this));else if(d.actor=this._tileWorkers[w]=this._tileWorkers[w]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",T,P.bind(this),void 0,!0);else{const L=i.loadVectorTile.call({deduped:this._deduped},T,(z,U)=>{z||!U?P.call(this,z):(T.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},d.actor&&d.actor.send("loadTile",T,P.bind(this),void 0,!0))},!0);d.request={cancel:L}}function P(L,z){return delete d.request,d.aborted?m(null):L&&L.status!==404?m(L):(z&&z.resourceTiming&&(d.resourceTiming=z.resourceTiming),this.map._refreshExpiredTiles&&z&&d.setExpiryData(z),d.loadVectorData(z,this.map.painter),i.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Tt extends i.Evented{constructor(d,m,w,T){super(),this.id=d,this.dispatcher=w,this.setEventedParent(T),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.extend({type:"raster"},m),i.extend(this,i.pick(m,["url","scheme","tileSize"]))}load(d){this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=nr(this._options,this.map._requestManager,null,null,(m,w)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new i.ErrorEvent(m)):w&&(i.extend(this,w),w.bounds&&(this.tileBounds=new Nt(w.bounds,this.minzoom,this.maxzoom)),i.postTurnstileEvent(w.tiles),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(m)})}loaded(){return this._loaded}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return i.extend({},this._options)}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,m){const w=i.exported.devicePixelRatio>=2,T=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),w,this.tileSize);d.request=i.getImage(this.map._requestManager.transformRequest(T,i.ResourceType.Tile),(P,L,z,U)=>(delete d.request,d.aborted?(d.state="unloaded",m(null)):P?(d.state="errored",m(P)):L?(this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:z,expires:U}),d.setTexture(L,this.map.painter),d.state="loaded",i.cacheEntryPossiblyAdded(this.dispatcher),void m(null)):m(null)))}static loadTileData(d,m,w){d.setTexture(m,w)}static unloadTileData(d,m){d.texture&&m.saveTileTexture(d.texture)}abortTile(d,m){d.request&&(d.request.cancel(),delete d.request),m()}unloadTile(d,m){d.texture&&this.map.painter.saveTileTexture(d.texture),m()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function pr(v,d,m,w,T,P,L,z){const U=[v,m,T,d,w,P,1,1,1],Z=[L,z,1],H=i.adjoint([],U),[Q,se,de]=i.transformMat3(Z,Z,i.transpose(H,H));return i.multiply$1(U,[Q,0,0,0,se,0,0,0,de],U)}class br extends i.Evented{constructor(d,m,w,T){super(),this.id=d,this.dispatcher=w,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(T),this.options=m,this._dirty=!1}load(d,m){this._loaded=m||!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=i.getImage(this.map._requestManager.transformRequest(this.url,i.ResourceType.Image),(w,T)=>{if(this._imageRequest=null,this._loaded=!0,w)this.fire(new i.ErrorEvent(w));else if(T){const{HTMLImageElement:P}=i.window;this.image=T instanceof P?i.exported.getImageData(T):T,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,d&&(this.coordinates=d),this._finishLoading()}})}loaded(){return this._loaded}updateImage(d){return this.image&&d.url?(this._imageRequest&&d.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=d.url,this.load(d.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(d){this.map=d,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(d){this.coordinates=d,this._boundsArray=void 0;const m=d.map(i.MercatorCoordinate.fromLngLat);return this.tileID=function(w){let T=1/0,P=1/0,L=-1/0,z=-1/0;for(const Q of w)T=Math.min(T,Q.x),P=Math.min(P,Q.y),L=Math.max(L,Q.x),z=Math.max(z,Q.y);const U=Math.max(L-T,z-P),Z=Math.max(0,Math.floor(-Math.log(U)/Math.LN2)),H=Math.pow(2,Z);return new i.CanonicalTileID(Z,Math.floor((T+L)/2*H),Math.floor((P+z)/2*H))}(m),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(d){for(const U in this.tiles){const Z=this.tiles[U];Z.state!=="loaded"&&(Z.state="loaded",Z.texture=this.texture)}if(this._boundsArray)return;const m=i.tileTransform(this.tileID,this.map.transform.projection),[w,T,P,L]=this.coordinates.map(U=>{const Z=m.projection.project(U[0],U[1]);return i.getTilePoint(m,Z)._round()});this.perspectiveTransform=function(U,Z,H,Q,se,de,fe,he,me,te){const ue=pr(0,0,U,0,0,Z,U,Z),be=pr(H,Q,se,de,fe,he,me,te);return i.multiply$1(be,i.adjoint(ue,ue),be),[be[6]/be[8]*U/i.EXTENT,be[7]/be[8]*Z/i.EXTENT]}(this.width,this.height,w.x,w.y,T.x,T.y,L.x,L.y,P.x,P.y);const z=this._boundsArray=new i.StructArrayLayout4i8;z.emplaceBack(w.x,w.y,0,0),z.emplaceBack(T.x,T.y,i.EXTENT,0),z.emplaceBack(L.x,L.y,0,i.EXTENT),z.emplaceBack(P.x,P.y,i.EXTENT,i.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=d.createVertexBuffer(z,i.boundsAttributes.members),this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const d=this.map.painter.context,m=d.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new i.Texture(d,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(d)}loadTile(d,m){this.tileID&&this.tileID.equals(d.tileID.canonical)?(this.tiles[String(d.tileID.wrap)]=d,d.buckets={},m(null)):(d.state="errored",m(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const mr={vector:Mt,raster:Tt,"raster-dem":class extends Tt{constructor(v,d,m,w){super(v,d,m,w),this.type="raster-dem",this.maxzoom=22,this._options=i.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}loadTile(v,d){const m=this.map._requestManager.normalizeTileURL(v.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function w(T,P){T&&(v.state="errored",d(T)),P&&(v.dem=P,v.dem.onDeserialize(),v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0,v.state="loaded",d(null))}v.request=i.getImage(this.map._requestManager.transformRequest(m,i.ResourceType.Tile),(function(T,P,L,z){if(delete v.request,v.aborted)v.state="unloaded",d(null);else if(T)v.state="errored",d(T);else if(P){this.map._refreshExpiredTiles&&v.setExpiryData({cacheControl:L,expires:z});const U=i.window.ImageBitmap&&P instanceof i.window.ImageBitmap&&(Zc==null&&(Zc=i.window.OffscreenCanvas&&new i.window.OffscreenCanvas(1,1).getContext("2d")&&typeof i.window.createImageBitmap=="function"),Zc),Z=1-(P.width-i.prevPowerOfTwo(P.width))/2;Z<1||v.neighboringTiles||(v.neighboringTiles=this._getNeighboringTiles(v.tileID));const H=U?P:i.exported.getImageData(P,Z),Q={uid:v.uid,coord:v.tileID,source:this.id,rawImageData:H,encoding:this.encoding,padding:Z};v.actor&&v.state!=="expired"||(v.actor=this.dispatcher.getActor(),v.actor.send("loadDEMTile",Q,w.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(v){const d=v.canonical,m=Math.pow(2,d.z),w=(d.x-1+m)%m,T=d.x===0?v.wrap-1:v.wrap,P=(d.x+1+m)%m,L=d.x+1===m?v.wrap+1:v.wrap,z={};return z[new i.OverscaledTileID(v.overscaledZ,T,d.z,w,d.y).key]={backfilled:!1},z[new i.OverscaledTileID(v.overscaledZ,L,d.z,P,d.y).key]={backfilled:!1},d.y>0&&(z[new i.OverscaledTileID(v.overscaledZ,T,d.z,w,d.y-1).key]={backfilled:!1},z[new i.OverscaledTileID(v.overscaledZ,v.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},z[new i.OverscaledTileID(v.overscaledZ,L,d.z,P,d.y-1).key]={backfilled:!1}),d.y+1<m&&(z[new i.OverscaledTileID(v.overscaledZ,T,d.z,w,d.y+1).key]={backfilled:!1},z[new i.OverscaledTileID(v.overscaledZ,v.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},z[new i.OverscaledTileID(v.overscaledZ,L,d.z,P,d.y+1).key]={backfilled:!1}),z}unloadTile(v){v.demTexture&&this.map.painter.saveTileTexture(v.demTexture),v.fbo&&(v.fbo.destroy(),delete v.fbo),v.dem&&delete v.dem,delete v.neighboringTiles,v.state="unloaded"}},geojson:class extends i.Evented{constructor(v,d,m,w){super(),this.id=v,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(w),this._data=d.data,this._options=i.extend({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const T=i.EXTENT/this.tileSize;this.workerOptions=i.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*T,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*T,extent:i.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:i.EXTENT,radius:(d.clusterRadius!==void 0?d.clusterRadius:50)*T,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions)}onAdd(v){this.map=v,this.setData(this._data)}setData(v){return this._data=v,this._updateWorkerData(),this}getClusterExpansionZoom(v,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:v,source:this.id},d),this}getClusterChildren(v,d){return this.actor.send("geojson.getClusterChildren",{clusterId:v,source:this.id},d),this}getClusterLeaves(v,d,m,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:v,limit:d,offset:m},w),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.Event("dataloading",{dataType:"source"})),this._loaded=!1;const v=i.extend({},this.workerOptions),d=this._data;typeof d=="string"?(v.request=this.map._requestManager.transformRequest(i.exported.resolveURL(d),i.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,v,(m,w)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new i.ErrorEvent(m));else{const T={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&w&&w.resourceTiming&&w.resourceTiming[this.id]&&(T.resourceTiming=w.resourceTiming[this.id]),this.fire(new i.Event("data",T)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(v,d){const m=v.actor?"reloadTile":"loadTile";v.actor=this.actor,v.request=this.actor.send(m,{type:this.type,uid:v.uid,tileID:v.tileID,tileZoom:v.tileZoom,zoom:v.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:i.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(w,T)=>(delete v.request,v.unloadVectorData(),v.aborted?d(null):w?d(w):(v.loadVectorData(T,this.map.painter,m==="reloadTile"),d(null))),void 0,m==="loadTile")}abortTile(v){v.request&&(v.request.cancel(),delete v.request),v.aborted=!0}unloadTile(v){v.unloadVectorData(),this.actor.send("removeTile",{uid:v.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends br{constructor(v,d,m,w){super(v,d,m,w),this.roundZoom=!0,this.type="video",this.options=d}load(){this._loaded=!1;const v=this.options;this.urls=[];for(const d of v.urls)this.urls.push(this.map._requestManager.transformRequest(d,i.ResourceType.Source).url);i.getVideo(this.urls,(d,m)=>{this._loaded=!0,d?this.fire(new i.ErrorEvent(d)):m&&(this.video=m,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(v){if(this.video){const d=this.video.seekable;v<d.start(0)||v>d.end(0)?this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=v}}getVideo(){return this.video}onAdd(v){this.map||(this.map=v,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const v=this.map.painter.context,d=v.gl;this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new i.Texture(v,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(v)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:br,canvas:class extends br{constructor(v,d,m,w){super(v,d,m,w),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(T=>!Array.isArray(T)||T.length!==2||T.some(P=>typeof P!="number"))||this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${v}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${v}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${v}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof i.window.HTMLCanvasElement||this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${v}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${v}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof i.window.HTMLCanvasElement?this.options.canvas:i.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(v){this.map=v,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const d=this.map.painter.context;this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.Texture(d,this.canvas,d.gl.RGBA,{premultiply:!0}),this._prepareData(d)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const v of[this.canvas.width,this.canvas.height])if(isNaN(v)||v<=0)return!0;return!1}},custom:class extends i.Evented{constructor(v,d,m,w){super(),this.id=v,this.type="custom",this._dataType="raster",this._dispatcher=m,this._implementation=d,this.setEventedParent(w),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Nt(this._implementation.bounds,this.minzoom,this.maxzoom)),d.update=this._update.bind(this),d.clearTiles=this._clearTiles.bind(this),d.coveringTiles=this._coveringTiles.bind(this),i.extend(this,i.pick(d,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(v){this._map=v,this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(v),this.load()}onRemove(v){this._implementation.onRemove&&this._implementation.onRemove(v)}hasTile(v){if(this._implementation.hasTile){const{x:d,y:m,z:w}=v.canonical;return this._implementation.hasTile({x:d,y:m,z:w})}return!this.tileBounds||this.tileBounds.contains(v.canonical)}loadTile(v,d){const{x:m,y:w,z:T}=v.tileID.canonical,P=new i.window.AbortController;v.request=Promise.resolve(this._implementation.loadTile({x:m,y:w,z:T},{signal:P.signal})).then((function(L){return delete v.request,v.aborted?(v.state="unloaded",d(null)):L===void 0?(v.state="errored",d(null)):L===null?(this.loadTileData(v,{width:this.tileSize,height:this.tileSize,data:null}),v.state="loaded",d(null)):function(z){return z instanceof i.window.ImageData||z instanceof i.window.HTMLCanvasElement||z instanceof i.window.ImageBitmap||z instanceof i.window.HTMLImageElement}(L)?(this.loadTileData(v,L),v.state="loaded",void d(null)):(v.state="errored",d(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(L=>{L.code!==20&&(v.state="errored",d(L))}),v.request.cancel=()=>P.abort()}loadTileData(v,d){Tt.loadTileData(v,d,this._map.painter)}unloadTileData(v){Tt.unloadTileData(v,this._map.painter)}unloadTile(v,d){if(this.unloadTileData(v),this._implementation.unloadTile){const{x:m,y:w,z:T}=v.tileID.canonical;this._implementation.unloadTile({x:m,y:w,z:T})}d()}abortTile(v,d){v.request&&v.request.cancel&&(v.request.cancel(),delete v.request),d()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(v=>({x:v.canonical.x,y:v.canonical.y,z:v.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"}))}}},_r=function(v,d,m,w){const T=new mr[d.type](v,d,m,w);if(T.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${T.id}`);return i.bindAll(["load","abort","unload","serialize","prepare"],T),T};function Pr(v,d){const m=i.identity([]);return i.scale(m,m,[.5*v.width,.5*-v.height,1]),i.translate(m,m,[1,-1,0]),i.multiply(m,m,v.calculateProjMatrix(d.toUnwrapped())),Float32Array.from(m)}function Cn(v,d,m,w,T,P,L,z=!1){const U=v.tilesIn(w,L,z);U.sort(Fi);const Z=[];for(const Q of U)Z.push({wrappedTileID:Q.tile.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(d,m,v._state,Q,T,P,Pr(v.transform,Q.tile.tileID),z)});const H=function(Q){const se={},de={};for(const fe of Q){const he=fe.queryResults,me=fe.wrappedTileID,te=de[me]=de[me]||{};for(const ue in he){const be=he[ue],we=te[ue]=te[ue]||{},Oe=se[ue]=se[ue]||[];for(const Le of be)we[Le.featureIndex]||(we[Le.featureIndex]=!0,Oe.push(Le))}}return se}(Z);for(const Q in H)H[Q].forEach(se=>{const de=se.feature,fe=de.layer;fe&&fe.type!=="background"&&fe.type!=="sky"&&(de.source=fe.source,fe["source-layer"]&&(de.sourceLayer=fe["source-layer"]),de.state=de.id!==void 0?v.getFeatureState(fe["source-layer"],de.id):{})});return H}function Xn(v,d){const m=v.getRenderableIds().map(P=>v.getTileByID(P)),w=[],T={};for(let P=0;P<m.length;P++){const L=m[P],z=L.tileID.canonical.key;T[z]||(T[z]=!0,L.querySourceFeatures(w,d))}return w}function Fi(v,d){const m=v.tileID,w=d.tileID;return m.overscaledZ-w.overscaledZ||m.canonical.y-w.canonical.y||m.wrap-w.wrap||m.canonical.x-w.canonical.x}function li(){return mu.workerClass!=null?new mu.workerClass:new i.window.Worker(mu.workerUrl)}const Ia="mapboxgl_preloaded_worker_pool";class yi{constructor(){this.active={}}acquire(d){if(!this.workers)for(this.workers=[];this.workers.length<yi.workerCount;)this.workers.push(new li);return this.active[d]=!0,this.workers.slice()}release(d){delete this.active[d],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ia]}numActive(){return Object.keys(this.active).length}}let Yi;function Yc(){return Yi||(Yi=new yi),Yi}function zE(v,d){const m={};for(const w in v)w!=="ref"&&(m[w]=v[w]);return i.refProperties.forEach(w=>{w in d&&(m[w]=d[w])}),m}function n0(v){v=v.slice();const d=Object.create(null);for(let m=0;m<v.length;m++)d[v[m].id]=v[m];for(let m=0;m<v.length;m++)"ref"in v[m]&&(v[m]=zE(v[m],d[v[m].ref]));return v}yi.workerCount=2;const Ur={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ng(v,d,m){m.push({command:Ur.addSource,args:[v,d[v]]})}function Dd(v,d,m){d.push({command:Ur.removeSource,args:[v]}),m[v]=!0}function Mg(v,d,m,w){Dd(v,m,w),Ng(v,d,m)}function kf(v,d,m){let w;for(w in v[m])if(v[m].hasOwnProperty(w)&&w!=="data"&&!p(v[m][w],d[m][w]))return!1;for(w in d[m])if(d[m].hasOwnProperty(w)&&w!=="data"&&!p(v[m][w],d[m][w]))return!1;return!0}function Oa(v,d,m,w,T,P){let L;for(L in d=d||{},v=v||{})v.hasOwnProperty(L)&&(p(v[L],d[L])||m.push({command:P,args:[w,L,d[L],T]}));for(L in d)d.hasOwnProperty(L)&&!v.hasOwnProperty(L)&&(p(v[L],d[L])||m.push({command:P,args:[w,L,d[L],T]}))}function us(v){return v.id}function Ig(v,d){return v[d.id]=d,v}class Og{constructor(d,m){this.reset(d,m)}reset(d,m){this.points=d||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(d){if(this.points.length===1)return this.points[0];d=i.clamp(d,0,1);let m=1,w=this._distances[m];const T=d*this.paddedLength+this.padding;for(;w<T&&m<this._distances.length;)w=this._distances[++m];const P=m-1,L=this._distances[P],z=w-L,U=z>0?(T-L)/z:0;return this.points[P].mult(1-U).add(this.points[m].mult(U))}}class Ul{constructor(d,m,w){const T=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(d/w),this.yCellCount=Math.ceil(m/w);for(let L=0;L<this.xCellCount*this.yCellCount;L++)T.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=d,this.height=m,this.xScale=this.xCellCount/d,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(d,m,w,T,P){this._forEachCell(m,w,T,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(m),this.bboxes.push(w),this.bboxes.push(T),this.bboxes.push(P)}insertCircle(d,m,w,T){this._forEachCell(m-T,w-T,m+T,w+T,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(m),this.circles.push(w),this.circles.push(T)}_insertBoxCell(d,m,w,T,P,L){this.boxCells[P].push(L)}_insertCircleCell(d,m,w,T,P,L){this.circleCells[P].push(L)}_query(d,m,w,T,P,L){if(w<0||d>this.width||T<0||m>this.height)return!P&&[];const z=[];if(d<=0&&m<=0&&this.width<=w&&this.height<=T){if(P)return!0;for(let U=0;U<this.boxKeys.length;U++)z.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const Z=this.circles[3*U],H=this.circles[3*U+1],Q=this.circles[3*U+2];z.push({key:this.circleKeys[U],x1:Z-Q,y1:H-Q,x2:Z+Q,y2:H+Q})}return L?z.filter(L):z}return this._forEachCell(d,m,w,T,this._queryCell,z,{hitTest:P,seenUids:{box:{},circle:{}}},L),P?z.length>0:z}_queryCircle(d,m,w,T,P){const L=d-w,z=d+w,U=m-w,Z=m+w;if(z<0||L>this.width||Z<0||U>this.height)return!T&&[];const H=[];return this._forEachCell(L,U,z,Z,this._queryCellCircle,H,{hitTest:T,circle:{x:d,y:m,radius:w},seenUids:{box:{},circle:{}}},P),T?H.length>0:H}query(d,m,w,T,P){return this._query(d,m,w,T,!1,P)}hitTest(d,m,w,T,P){return this._query(d,m,w,T,!0,P)}hitTestCircle(d,m,w,T){return this._queryCircle(d,m,w,!0,T)}_queryCell(d,m,w,T,P,L,z,U){const Z=z.seenUids,H=this.boxCells[P];if(H!==null){const se=this.bboxes;for(const de of H)if(!Z.box[de]){Z.box[de]=!0;const fe=4*de;if(d<=se[fe+2]&&m<=se[fe+3]&&w>=se[fe+0]&&T>=se[fe+1]&&(!U||U(this.boxKeys[de]))){if(z.hitTest)return L.push(!0),!0;L.push({key:this.boxKeys[de],x1:se[fe],y1:se[fe+1],x2:se[fe+2],y2:se[fe+3]})}}}const Q=this.circleCells[P];if(Q!==null){const se=this.circles;for(const de of Q)if(!Z.circle[de]){Z.circle[de]=!0;const fe=3*de;if(this._circleAndRectCollide(se[fe],se[fe+1],se[fe+2],d,m,w,T)&&(!U||U(this.circleKeys[de]))){if(z.hitTest)return L.push(!0),!0;{const he=se[fe],me=se[fe+1],te=se[fe+2];L.push({key:this.circleKeys[de],x1:he-te,y1:me-te,x2:he+te,y2:me+te})}}}}}_queryCellCircle(d,m,w,T,P,L,z,U){const Z=z.circle,H=z.seenUids,Q=this.boxCells[P];if(Q!==null){const de=this.bboxes;for(const fe of Q)if(!H.box[fe]){H.box[fe]=!0;const he=4*fe;if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,de[he+0],de[he+1],de[he+2],de[he+3])&&(!U||U(this.boxKeys[fe])))return L.push(!0),!0}}const se=this.circleCells[P];if(se!==null){const de=this.circles;for(const fe of se)if(!H.circle[fe]){H.circle[fe]=!0;const he=3*fe;if(this._circlesCollide(de[he],de[he+1],de[he+2],Z.x,Z.y,Z.radius)&&(!U||U(this.circleKeys[fe])))return L.push(!0),!0}}}_forEachCell(d,m,w,T,P,L,z,U){const Z=this._convertToXCellCoord(d),H=this._convertToYCellCoord(m),Q=this._convertToXCellCoord(w),se=this._convertToYCellCoord(T);for(let de=Z;de<=Q;de++)for(let fe=H;fe<=se;fe++)if(P.call(this,d,m,w,T,this.xCellCount*fe+de,L,z,U))return}_convertToXCellCoord(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))}_convertToYCellCoord(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))}_circlesCollide(d,m,w,T,P,L){const z=T-d,U=P-m,Z=w+L;return Z*Z>z*z+U*U}_circleAndRectCollide(d,m,w,T,P,L,z){const U=(L-T)/2,Z=Math.abs(d-(T+U));if(Z>U+w)return!1;const H=(z-P)/2,Q=Math.abs(m-(P+H));if(Q>H+w)return!1;if(Z<=U||Q<=H)return!0;const se=Z-U,de=Q-H;return se*se+de*de<=w*w}}const ds={unknown:0,flipRequired:1,flipNotRequired:2},Rd=Math.tan(85*Math.PI/180);function at(v,d,m,w,T,P,L){const z=i.create();if(m)if(P.name==="globe"){const U=i.calculateGlobeLabelMatrix(T,d);i.multiply(z,z,U)}else{const U=K([],L);z[0]=U[0],z[1]=U[1],z[4]=U[2],z[5]=U[3],w||i.rotateZ(z,z,T.angle)}else i.multiply(z,T.labelPlaneMatrix,v);return z}function hs(v,d,m,w,T,P,L){const z=at(v,d,m,w,T,P,L);return P.name==="globe"&&m||(z[2]=z[6]=z[10]=z[14]=0),z}function Zn(v,d,m,w,T,P,L){if(m){if(P.name==="globe"){const z=at(v,d,m,w,T,P,L);return i.invert(z,z),i.multiply(z,v,z),z}{const z=i.clone(v),U=i.identity([]);return U[0]=L[0],U[1]=L[1],U[4]=L[2],U[5]=L[3],i.multiply(z,z,U),w||i.rotateZ(z,z,-T.angle),z}}return T.glCoordMatrix}function vi(v,d,m,w){const T=[v,d,m,1];m?i.transformMat4$1(T,T,w):Er(T,T,w);const P=T[3];return T[0]/=P,T[1]/=P,T[2]/=P,T}function i0(v,d){return Math.min(.5+v/d*.5,1.5)}function Da(v,d){const m=v[0]/v[3],w=v[1]/v[3];return m>=-d[0]&&m<=d[0]&&w>=-d[1]&&w<=d[1]}function Dg(v,d,m,w,T,P,L,z,U,Z){const H=m.transform,Q=w?v.textSizeData:v.iconSizeData,se=i.evaluateSizeForZoom(Q,m.transform.zoom),de=H.projection.name==="globe",fe=[256/m.width*2+1,256/m.height*2+1],he=w?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;he.clear();let me=null;de&&(me=w?v.text.globeExtVertexArray:v.icon.globeExtVertexArray);const te=v.lineVertexArray,ue=w?v.text.placedSymbolArray:v.icon.placedSymbolArray,be=m.transform.width/m.transform.height;let we,Oe=!1;for(let Le=0;Le<ue.length;Le++){const De=ue.get(Le),{numGlyphs:qe,writingMode:Ue}=De;if(Ue!==i.WritingMode.vertical||Oe||we===i.WritingMode.horizontal||(Oe=!0),we=Ue,(De.hidden||Ue===i.WritingMode.vertical)&&!Oe){da(qe,he);continue}Oe=!1;const Je=new i.Point(De.tileAnchorX,De.tileAnchorY);let{x:bt,y:Ze,z:ut}=H.projection.projectTilePoint(Je.x,Je.y,Z.canonical);if(U){const[sr,Ut,ir]=U(Je);bt+=sr,Ze+=Ut,ut+=ir}const et=[bt,Ze,ut,1];if(i.transformMat4$1(et,et,d),!Da(et,fe)){da(qe,he);continue}const xt=i0(m.transform.cameraToCenterDistance,et[3]),Ye=i.evaluateSizeForFeature(Q,se,De),ct=L?Ye/xt:Ye*xt,wt=vi(bt,Ze,ut,T);if(wt[3]<=0){da(qe,he);continue}let mt={};const St=L?null:U,Kt=Lt(De,ct,!1,z,d,T,P,v.glyphOffsetArray,te,he,me,wt,Je,mt,be,St,H.projection,Z,L);Oe=Kt.useVertical,St&&Kt.needsFlipping&&(mt={}),(Kt.notEnoughRoom||Oe||Kt.needsFlipping&&Lt(De,ct,!0,z,d,T,P,v.glyphOffsetArray,te,he,me,wt,Je,mt,be,St,H.projection,Z,L).notEnoughRoom)&&da(qe,he)}w?(v.text.dynamicLayoutVertexBuffer.updateData(he),me&&v.text.globeExtVertexBuffer.updateData(me)):(v.icon.dynamicLayoutVertexBuffer.updateData(he),me&&v.icon.globeExtVertexBuffer.updateData(me))}function o0(v,d,m,w,T,P,L,z,U,Z,H,Q,se,de,fe,he){const{lineStartIndex:me,glyphStartIndex:te,segment:ue}=z,be=te+z.numGlyphs,we=me+z.lineLength,Oe=d.getoffsetX(te),Le=d.getoffsetX(be-1),De=Po(v*Oe,m,w,T,P,L,ue,me,we,U,Z,H,Q,se,!0,de,fe,he);if(!De)return null;const qe=Po(v*Le,m,w,T,P,L,ue,me,we,U,Z,H,Q,se,!0,de,fe,he);return qe?{first:De,last:qe}:null}function Jc(v,d,m,w){return v===i.WritingMode.horizontal&&Math.abs(w)>Math.abs(m)?{useVertical:!0}:v===i.WritingMode.vertical?w>0?{needsFlipping:!0}:null:d!==ds.unknown&&function(T,P){return T===0||Math.abs(P/T)>Rd}(m,w)?d===ds.flipRequired?{needsFlipping:!0}:null:m<0?{needsFlipping:!0}:null}function Lt(v,d,m,w,T,P,L,z,U,Z,H,Q,se,de,fe,he,me,te,ue){const be=d/24,we=v.lineOffsetX*be,Oe=v.lineOffsetY*be,{lineStartIndex:Le,glyphStartIndex:De,numGlyphs:qe,segment:Ue,writingMode:Je,flipState:bt}=v,Ze=Le+v.lineLength,ut=et=>{if(H){const[wt,mt,St]=et.up,Kt=Z.length;i.updateGlobeVertexNormal(H,Kt+0,wt,mt,St),i.updateGlobeVertexNormal(H,Kt+1,wt,mt,St),i.updateGlobeVertexNormal(H,Kt+2,wt,mt,St),i.updateGlobeVertexNormal(H,Kt+3,wt,mt,St)}const[xt,Ye,ct]=et.point;i.addDynamicAttributes(Z,xt,Ye,ct,et.angle)};if(qe>1){const et=o0(be,z,we,Oe,m,Q,se,v,U,P,de,he,!1,me,te,ue);if(!et)return{notEnoughRoom:!0};if(w&&!m){let[xt,Ye,ct]=et.first.point,[wt,mt,St]=et.last.point;[xt,Ye]=vi(xt,Ye,ct,L),[wt,mt]=vi(wt,mt,St,L);const Kt=Jc(Je,bt,(wt-xt)*fe,mt-Ye);if(v.flipState=Kt&&Kt.needsFlipping?ds.flipRequired:ds.flipNotRequired,Kt)return Kt}ut(et.first);for(let xt=De+1;xt<De+qe-1;xt++){const Ye=Po(be*z.getoffsetX(xt),we,Oe,m,Q,se,Ue,Le,Ze,U,P,de,he,!1,!1,me,te,ue);if(!Ye)return Z.length-=4*(xt-De),{notEnoughRoom:!0};ut(Ye)}ut(et.last)}else{if(w&&!m){const xt=vi(se.x,se.y,0,T),Ye=Le+Ue+1,ct=new i.Point(U.getx(Ye),U.gety(Ye)),wt=vi(ct.x,ct.y,0,T),mt=wt[3]>0?wt:Sr(se,ct,xt,1,T,void 0,me,te.canonical),St=Jc(Je,bt,(mt[0]-xt[0])*fe,mt[1]-xt[1]);if(v.flipState=St&&St.needsFlipping?ds.flipRequired:ds.flipNotRequired,St)return St}const et=Po(be*z.getoffsetX(De),we,Oe,m,Q,se,Ue,Le,Ze,U,P,de,he,!1,!1,me,te,ue);if(!et)return{notEnoughRoom:!0};ut(et)}return{}}function jr(v,d,m,w,T){const{x:P,y:L,z}=w.projectTilePoint(v.x,v.y,d);if(!T)return vi(P,L,z,m);const[U,Z,H]=T(v);return vi(P+U,L+Z,z+H,m)}function Sr(v,d,m,w,T,P,L,z){const U=jr(v.sub(d)._unit()._add(v),z,T,L,P);return i.sub(U,m,U),i.normalize(U,U),i.scaleAndAdd(U,m,U,w)}function Po(v,d,m,w,T,P,L,z,U,Z,H,Q,se,de,fe,he,me,te){const ue=w?v-d:v+d;let be=ue>0?1:-1,we=0;w&&(be*=-1,we=Math.PI),be<0&&(we+=Math.PI);let Oe=z+L+(be>0?0:1)|0,Le=T,De=T,qe=0,Ue=0;const Je=Math.abs(ue),bt=[],Ze=[];let ut=P,et=ut;const xt=()=>Sr(et,ut,De,Je-qe+1,H,se,he,me.canonical);for(;qe+Ue<=Je;){if(Oe+=be,Oe<z||Oe>=U)return null;if(De=Le,et=ut,bt.push(De),de&&Ze.push(et),ut=new i.Point(Z.getx(Oe),Z.gety(Oe)),Le=Q[Oe],!Le){const ir=jr(ut,me.canonical,H,he,se);Le=ir[3]>0?Q[Oe]=ir:xt()}qe+=Ue,Ue=i.distance(De,Le)}fe&&se&&(Q[Oe]&&(Le=xt(),Ue=i.distance(De,Le)),Q[Oe]=Le);const Ye=(Je-qe)/Ue,ct=ut.sub(et)._mult(Ye)._add(et),wt=i.sub([],Le,De),mt=i.scaleAndAdd([],De,wt,Ye);let St=[0,0,1],Kt=wt[0],sr=wt[1];if(te&&(St=he.upVector(me.canonical,ct.x,ct.y),St[0]!==0||St[1]!==0||St[2]!==1)){const ir=[St[2],0,-St[0]],Tr=i.cross([],St,ir);i.normalize(ir,ir),i.normalize(Tr,Tr),Kt=i.dot(wt,ir),sr=i.dot(wt,Tr)}if(m){const ir=i.cross([],St,wt);i.normalize(ir,ir),i.scaleAndAdd(mt,mt,ir,m*be)}const Ut=we+Math.atan2(sr,Kt);return bt.push(mt),de&&Ze.push(ct),{point:mt,angle:Ut,path:bt,tilePath:Ze,up:St}}function da(v,d){const m=d.length,w=m+4*v;d.resize(w),d.float32.fill(-1/0,4*m,4*w)}function Er(v,d,m){const w=d[0],T=d[1];return v[0]=m[0]*w+m[4]*T+m[12],v[1]=m[1]*w+m[5]*T+m[13],v[3]=m[3]*w+m[7]*T+m[15],v}const Ao=100;class Ld{constructor(d,m,w=new Ul(d.width+200,d.height+200,25),T=new Ul(d.width+200,d.height+200,25)){this.transform=d,this.grid=w,this.ignoredGrid=T,this.pitchfactor=Math.cos(d._pitch)*d.cameraToCenterDistance,this.screenRightBoundary=d.width+Ao,this.screenBottomBoundary=d.height+Ao,this.gridRightBoundary=d.width+200,this.gridBottomBoundary=d.height+200,this.fogState=m}placeCollisionBox(d,m,w,T,P,L,z,U){let Z=w.projectedAnchorX,H=w.projectedAnchorY,Q=w.projectedAnchorZ;const se=w.elevation,de=w.tileID,fe=d.getProjection();if(se&&de){const[Le,De,qe]=fe.upVector(de.canonical,w.tileAnchorX,w.tileAnchorY),Ue=fe.upVectorScale(de.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;Z+=Le*se*Ue,H+=De*se*Ue,Q+=qe*se*Ue}const he=this.projectAndGetPerspectiveRatio(z,Z,H,Q,w.tileID,fe.name==="globe"||!!se||this.transform.pitch>0,fe),me=L*he.perspectiveRatio,te=(w.x1*m+T.x-w.padding)*me+he.point.x,ue=(w.y1*m+T.y-w.padding)*me+he.point.y,be=(w.x2*m+T.x+w.padding)*me+he.point.x,we=(w.y2*m+T.y+w.padding)*me+he.point.y,Oe=he.perspectiveRatio<=.55||he.occluded;return!this.isInsideGrid(te,ue,be,we)||!P&&this.grid.hitTest(te,ue,be,we,U)||Oe?{box:[],offscreen:!1,occluded:he.occluded}:{box:[te,ue,be,we],offscreen:this.isOffscreen(te,ue,be,we),occluded:!1}}placeCollisionCircles(d,m,w,T,P,L,z,U,Z,H,Q,se,de,fe,he){const me=[],te=this.transform.elevation,ue=d.getProjection(),be=te?te.getAtTileOffsetFunc(he,this.transform.center.lat,this.transform.worldSize,ue):null,we=new i.Point(w.tileAnchorX,w.tileAnchorY);let{x:Oe,y:Le,z:De}=ue.projectTilePoint(we.x,we.y,he.canonical);if(be){const[ct,wt,mt]=be(we);Oe+=ct,Le+=wt,De+=mt}const qe=ue.name==="globe",Ue=this.projectAndGetPerspectiveRatio(z,Oe,Le,De,he,qe||!!te||this.transform.pitch>0,ue),{perspectiveRatio:Je}=Ue,bt=(Q?L/Je:L*Je)/i.ONE_EM,Ze=vi(Oe,Le,De,U),ut=Ue.signedDistanceFromCamera>0?o0(bt,P,w.lineOffsetX*bt,w.lineOffsetY*bt,!1,Ze,we,w,T,U,{},te&&!Q?be:null,Q&&!!te,ue,he,Q):null;let et=!1,xt=!1,Ye=!0;if(ut&&!Ue.occluded){const ct=.5*de*Je+fe,wt=new i.Point(-100,-100),mt=new i.Point(this.screenRightBoundary,this.screenBottomBoundary),St=new Og,{first:Kt,last:sr}=ut,Ut=Kt.path.length;let ir=[];for(let Zt=Ut-1;Zt>=1;Zt--)ir.push(Kt.path[Zt]);for(let Zt=1;Zt<sr.path.length;Zt++)ir.push(sr.path[Zt]);const Tr=2.5*ct;Z&&(ir=ir.map(([Zt,Hr,Jr],Qr)=>(be&&!qe&&(Jr=be(Qr<Ut-1?Kt.tilePath[Ut-1-Qr]:sr.tilePath[Qr-Ut+2])[2]),vi(Zt,Hr,Jr,Z))),ir.some(Zt=>Zt[3]<=0)&&(ir=[]));let wr=[];if(ir.length>0){let Zt=1/0,Hr=-1/0,Jr=1/0,Qr=-1/0;for(const en of ir)Zt=Math.min(Zt,en[0]),Jr=Math.min(Jr,en[1]),Hr=Math.max(Hr,en[0]),Qr=Math.max(Qr,en[1]);Hr>=wt.x&&Zt<=mt.x&&Qr>=wt.y&&Jr<=mt.y&&(wr=[ir.map(en=>new i.Point(en[0],en[1]))],(Zt<wt.x||Hr>mt.x||Jr<wt.y||Qr>mt.y)&&(wr=i.clipLine(wr,wt.x,wt.y,mt.x,mt.y)))}for(const Zt of wr){St.reset(Zt,.25*ct);let Hr=0;Hr=St.length<=.5*ct?1:Math.ceil(St.paddedLength/Tr)+1;for(let Jr=0;Jr<Hr;Jr++){const Qr=Jr/Math.max(Hr-1,1),en=St.lerp(Qr),Vi=en.x+Ao,bi=en.y+Ao;me.push(Vi,bi,ct,0);const Go=Vi-ct,za=bi-ct,Tn=Vi+ct,tn=bi+ct;if(Ye=Ye&&this.isOffscreen(Go,za,Tn,tn),xt=xt||this.isInsideGrid(Go,za,Tn,tn),!m&&this.grid.hitTestCircle(Vi,bi,ct,se)&&(et=!0,!H))return{circles:[],offscreen:!1,collisionDetected:et,occluded:!1}}}}return{circles:!H&&et||!xt?[]:me,offscreen:Ye,collisionDetected:et,occluded:Ue.occluded}}queryRenderedSymbols(d){if(d.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[];let w=1/0,T=1/0,P=-1/0,L=-1/0;for(const H of d){const Q=new i.Point(H.x+Ao,H.y+Ao);w=Math.min(w,Q.x),T=Math.min(T,Q.y),P=Math.max(P,Q.x),L=Math.max(L,Q.y),m.push(Q)}const z=this.grid.query(w,T,P,L).concat(this.ignoredGrid.query(w,T,P,L)),U={},Z={};for(const H of z){const Q=H.key;if(U[Q.bucketInstanceId]===void 0&&(U[Q.bucketInstanceId]={}),U[Q.bucketInstanceId][Q.featureIndex])continue;const se=[new i.Point(H.x1,H.y1),new i.Point(H.x2,H.y1),new i.Point(H.x2,H.y2),new i.Point(H.x1,H.y2)];i.polygonIntersectsPolygon(m,se)&&(U[Q.bucketInstanceId][Q.featureIndex]=!0,Z[Q.bucketInstanceId]===void 0&&(Z[Q.bucketInstanceId]=[]),Z[Q.bucketInstanceId].push(Q.featureIndex))}return Z}insertCollisionBox(d,m,w,T,P){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:w,featureIndex:T,collisionGroupID:P},d[0],d[1],d[2],d[3])}insertCollisionCircles(d,m,w,T,P){const L=m?this.ignoredGrid:this.grid,z={bucketInstanceId:w,featureIndex:T,collisionGroupID:P};for(let U=0;U<d.length;U+=4)L.insertCircle(z,d[U],d[U+1],d[U+2])}projectAndGetPerspectiveRatio(d,m,w,T,P,L,z){const U=[m,w,T,1];let Z=!1;T||this.transform.pitch>0?(i.transformMat4$1(U,U,d),this.fogState&&P&&z.name!=="globe"&&(Z=function(se,de,fe,he,me,te){const ue=te.calculateFogTileMatrix(me),be=[de,fe,he];return i.transformMat4(be,be,ue),ce(se,be,te.pitch,te._fov)}(this.fogState,m,w,T,P.toUnwrapped(),this.transform)>.9)):Er(U,U,d);const H=U[3];return{point:new i.Point((U[0]/H+1)/2*this.transform.width+Ao,(-U[1]/H+1)/2*this.transform.height+Ao),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(z)/H*.5,1.5),signedDistanceFromCamera:H,occluded:L&&U[2]>H||Z}}isOffscreen(d,m,w,T){return w<Ao||d>=this.screenRightBoundary||T<Ao||m>this.screenBottomBoundary}isInsideGrid(d,m,w,T){return w>=0&&d<this.gridRightBoundary&&T>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const d=i.identity([]);return i.translate(d,d,[-100,-100,0]),d}}function Vl(v,d,m){const w=d.createTileMatrix(v,v.worldSize,m.toUnwrapped());return i.multiply(new Float32Array(16),v.projMatrix,w)}function Uo(v,d,m){if(d.projection.name===m.projection.name)return v.projMatrix;const w=m.clone();return w.setProjection(d.projection),Vl(w,d.getProjection(),v)}function En(v,d,m){return d.name===m.projection.name?v.projMatrix:Vl(m,d,v)}class a0{constructor(d,m,w,T){this.opacity=d?Math.max(0,Math.min(1,d.opacity+(d.placed?m:-m))):T&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class fs{constructor(d,m,w,T,P,L=!1){this.text=new a0(d?d.text:null,m,w,P),this.icon=new a0(d?d.icon:null,m,T,P),this.clipped=L}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Bd{constructor(d,m,w,T=!1){this.text=d,this.icon=m,this.skipFade=w,this.clipped=T}}class zd{constructor(){this.invProjMatrix=i.create(),this.viewportMatrix=i.create(),this.circles=[]}}class Rg{constructor(d,m,w,T,P){this.bucketInstanceId=d,this.featureIndex=m,this.sourceLayerIndex=w,this.bucketIndex=T,this.tileID=P}}class s0{constructor(d){this.crossSourceCollisions=d,this.maxGroupID=0,this.collisionGroups={}}get(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){const m=++this.maxGroupID;this.collisionGroups[d]={ID:m,predicate:w=>w.collisionGroupID===m}}return this.collisionGroups[d]}}function $d(v,d,m,w,T){const{horizontalAlign:P,verticalAlign:L}=i.getAnchorAlignment(v),z=-(P-.5)*d,U=-(L-.5)*m,Z=i.evaluateVariableOffset(v,w);return new i.Point(z+Z[0]*T,U+Z[1]*T)}function Fd(v,d,m,w,T){const P=new i.Point(v,d);return m&&P._rotate(w?T:-T),P}class Nf{constructor(d,m,w,T,P){this.transform=d.clone(),this.projection=d.projection.name,this.collisionIndex=new Ld(this.transform,P),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new s0(w),this.collisionCircleArrays={},this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(d,m,w,T){const P=w.getBucket(m),L=w.latestFeatureIndex;if(!P||!L||m.id!==P.layerIds[0])return;const z=P.layers[0].layout,U=w.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),H=w.tileSize/i.EXTENT,Q=w.tileID.toUnwrapped();this.transform.setProjection(P.projection);const se=(de=w.tileID,fe=P.getProjection(),he=this.transform,fe.name===this.projection?he.calculateProjMatrix(de.toUnwrapped()):Vl(he,fe,de));var de,fe,he;const me=z.get("text-pitch-alignment")==="map",te=z.get("text-rotation-alignment")==="map";m.compileFilter();const ue=m.dynamicFilter(),be=m.dynamicFilterNeedsFeature(),we=this.transform.calculatePixelsToTileUnitsMatrix(w),Oe=hs(se,w.tileID.canonical,me,te,this.transform,P.getProjection(),we);let Le=null;if(me){const Ue=Zn(se,w.tileID.canonical,me,te,this.transform,P.getProjection(),we);Le=i.multiply([],this.transform.labelPlaneMatrix,Ue)}let De=null;ue&&w.latestFeatureIndex&&(De={unwrappedTileID:Q,dynamicFilter:ue,dynamicFilterNeedsFeature:be,featureIndex:w.latestFeatureIndex}),this.retainedQueryData[P.bucketInstanceId]=new Rg(P.bucketInstanceId,L,P.sourceLayerIndex,P.index,w.tileID);const qe={bucket:P,layout:z,posMatrix:se,textLabelPlaneMatrix:Oe,labelToScreenMatrix:Le,clippingData:De,scale:Z,textPixelRatio:H,holdingForFade:w.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:i.evaluateSizeForZoom(P.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:i.evaluateSizeForZoom(P.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(T)for(const Ue of P.sortKeyRanges){const{sortKey:Je,symbolInstanceStart:bt,symbolInstanceEnd:Ze}=Ue;d.push({sortKey:Je,symbolInstanceStart:bt,symbolInstanceEnd:Ze,parameters:qe})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:qe})}attemptAnchorPlacement(d,m,w,T,P,L,z,U,Z,H,Q,se,de,fe,he,me,te,ue){const{textOffset0:be,textOffset1:we,crossTileID:Oe}=se,Le=[be,we],De=$d(d,w,T,Le,P),qe=this.collisionIndex.placeCollisionBox(fe,P,m,Fd(De.x,De.y,L,z,this.transform.angle),Q,U,Z,H.predicate);if(me){const Ue=fe.getSymbolInstanceIconSize(ue,this.transform.zoom,se.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(fe,Ue,me,Fd(De.x,De.y,L,z,this.transform.angle),Q,U,Z,H.predicate).box.length===0)return}if(qe.box.length>0){let Ue;return this.prevPlacement&&this.prevPlacement.variableOffsets[Oe]&&this.prevPlacement.placements[Oe]&&this.prevPlacement.placements[Oe].text&&(Ue=this.prevPlacement.variableOffsets[Oe].anchor),this.variableOffsets[Oe]={textOffset:Le,width:w,height:T,anchor:d,textScale:P,prevAnchor:Ue},this.markUsedJustification(fe,d,se,he),fe.allowVerticalPlacement&&(this.markUsedOrientation(fe,he,se),this.placedOrientations[Oe]=he),{shift:De,placedGlyphBoxes:qe}}}placeLayerBucketPart(d,m,w,T){const{bucket:P,layout:L,posMatrix:z,textLabelPlaneMatrix:U,labelToScreenMatrix:Z,clippingData:H,textPixelRatio:Q,holdingForFade:se,collisionBoxArray:de,partiallyEvaluatedTextSize:fe,partiallyEvaluatedIconSize:he,collisionGroup:me}=d.parameters,te=L.get("text-optional"),ue=L.get("icon-optional"),be=L.get("text-allow-overlap"),we=L.get("icon-allow-overlap"),Oe=L.get("text-rotation-alignment")==="map",Le=L.get("text-pitch-alignment")==="map",De=L.get("icon-text-fit")!=="none",qe=L.get("symbol-z-order")==="viewport-y";this.transform.setProjection(P.projection);let Ue=be&&(we||!P.hasIconData()||ue),Je=we&&(be||!P.hasTextData()||te);!P.collisionArrays&&de&&P.deserializeCollisionBoxes(de),w&&T&&P.updateCollisionDebugBuffers(this.transform.zoom,de);const bt=(Ze,ut,et)=>{const{crossTileID:xt,numVerticalGlyphVertices:Ye}=Ze;if(H){const Tn={zoom:this.transform.zoom,pitch:this.transform.pitch};let tn=null;if(H.dynamicFilterNeedsFeature){const Dr=this.retainedQueryData[P.bucketInstanceId];tn=H.featureIndex.loadFeature({featureIndex:Ze.featureIndex,bucketIndex:Dr.bucketIndex,sourceLayerIndex:Dr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,H.dynamicFilter)(Tn,tn,this.retainedQueryData[P.bucketInstanceId].tileID.canonical,new i.Point(Ze.tileAnchorX,Ze.tileAnchorY),this.transform.calculateDistanceTileData(H.unwrappedTileID)))return this.placements[xt]=new Bd(!1,!1,!1,!0),void m.add(xt)}if(m.has(xt))return;if(se)return void(this.placements[xt]=new Bd(!1,!1,!1));let ct=!1,wt=!1,mt=!0,St=!1,Kt=!1,sr=null,Ut={box:null,offscreen:null,occluded:null},ir={box:null,offscreen:null,occluded:null},Tr=null,wr=null,Zt=null,Hr=0,Jr=0,Qr=0;et.textFeatureIndex?Hr=et.textFeatureIndex:Ze.useRuntimeCollisionCircles&&(Hr=Ze.featureIndex),et.verticalTextFeatureIndex&&(Jr=et.verticalTextFeatureIndex);const en=Tn=>{Tn.tileID=this.retainedQueryData[P.bucketInstanceId].tileID;const tn=this.transform.elevation;(tn||Tn.elevation)&&(Tn.elevation=tn?tn.getAtTileOffset(Tn.tileID,Tn.tileAnchorX,Tn.tileAnchorY):0)},Vi=et.textBox;if(Vi){en(Vi);const Tn=Dr=>{let Kn=i.WritingMode.horizontal;if(P.allowVerticalPlacement&&!Dr&&this.prevPlacement){const Ji=this.prevPlacement.placedOrientations[xt];Ji&&(this.placedOrientations[xt]=Ji,Kn=Ji,this.markUsedOrientation(P,Kn,Ze))}return Kn},tn=(Dr,Kn)=>{if(P.allowVerticalPlacement&&Ye>0&&et.verticalTextBox){for(const Ji of P.writingModes)if(Ji===i.WritingMode.vertical?(Ut=Kn(),ir=Ut):Ut=Dr(),Ut&&Ut.box&&Ut.box.length)break}else Ut=Dr()};if(L.get("text-variable-anchor")){let Dr=L.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[xt]){const mn=this.prevPlacement.variableOffsets[xt];Dr.indexOf(mn.anchor)>0&&(Dr=Dr.filter(ho=>ho!==mn.anchor),Dr.unshift(mn.anchor))}const Kn=(mn,ho,ip)=>{const Yl=P.getSymbolInstanceTextSize(fe,Ze,this.transform.zoom,ut),sh=(mn.x2-mn.x1)*Yl+2*mn.padding,bs=(mn.y2-mn.y1)*Yl+2*mn.padding,sl=De&&!we?ho:null;sl&&en(sl);let Jl={box:[],offscreen:!1,occluded:!1};const op=be?2*Dr.length:Dr.length;for(let lh=0;lh<op;++lh){const jy=this.attemptAnchorPlacement(Dr[lh%Dr.length],mn,sh,bs,Yl,Oe,Le,Q,z,me,lh>=Dr.length,Ze,ut,P,ip,sl,fe,he);if(jy&&(Jl=jy.placedGlyphBoxes,Jl&&Jl.box&&Jl.box.length)){ct=!0,sr=jy.shift;break}}return Jl};tn(()=>Kn(Vi,et.iconBox,i.WritingMode.horizontal),()=>{const mn=et.verticalTextBox;return mn&&en(mn),P.allowVerticalPlacement&&!(Ut&&Ut.box&&Ut.box.length)&&Ye>0&&mn?Kn(mn,et.verticalIconBox,i.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Ut&&(ct=Ut.box,mt=Ut.offscreen,St=Ut.occluded);const Ji=Tn(!(!Ut||!Ut.box));if(!ct&&this.prevPlacement){const mn=this.prevPlacement.variableOffsets[xt];mn&&(this.variableOffsets[xt]=mn,this.markUsedJustification(P,mn.anchor,Ze,Ji))}}else{const Dr=(Kn,Ji)=>{const mn=P.getSymbolInstanceTextSize(fe,Ze,this.transform.zoom,ut),ho=this.collisionIndex.placeCollisionBox(P,mn,Kn,new i.Point(0,0),be,Q,z,me.predicate);return ho&&ho.box&&ho.box.length&&(this.markUsedOrientation(P,Ji,Ze),this.placedOrientations[xt]=Ji),ho};tn(()=>Dr(Vi,i.WritingMode.horizontal),()=>{const Kn=et.verticalTextBox;return P.allowVerticalPlacement&&Ye>0&&Kn?(en(Kn),Dr(Kn,i.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Tn(!!(Ut&&Ut.box&&Ut.box.length))}}if(Tr=Ut,ct=Tr&&Tr.box&&Tr.box.length>0,mt=Tr&&Tr.offscreen,St=Tr&&Tr.occluded,Ze.useRuntimeCollisionCircles){const Tn=P.text.placedSymbolArray.get(Ze.centerJustifiedTextSymbolIndex>=0?Ze.centerJustifiedTextSymbolIndex:Ze.verticalPlacedTextSymbolIndex),tn=i.evaluateSizeForFeature(P.textSizeData,fe,Tn),Dr=L.get("text-padding");wr=this.collisionIndex.placeCollisionCircles(P,be,Tn,P.lineVertexArray,P.glyphOffsetArray,tn,z,U,Z,w,Le,me.predicate,Ze.collisionCircleDiameter*tn/i.ONE_EM,Dr,this.retainedQueryData[P.bucketInstanceId].tileID),ct=be||wr.circles.length>0&&!wr.collisionDetected,mt=mt&&wr.offscreen,St=wr.occluded}if(et.iconFeatureIndex&&(Qr=et.iconFeatureIndex),et.iconBox){const Tn=tn=>{en(tn);const Dr=De&&sr?Fd(sr.x,sr.y,Oe,Le,this.transform.angle):new i.Point(0,0),Kn=P.getSymbolInstanceIconSize(he,this.transform.zoom,Ze.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(P,Kn,tn,Dr,we,Q,z,me.predicate)};ir&&ir.box&&ir.box.length&&et.verticalIconBox?(Zt=Tn(et.verticalIconBox),wt=Zt.box.length>0):(Zt=Tn(et.iconBox),wt=Zt.box.length>0),mt=mt&&Zt.offscreen,Kt=Zt.occluded}const bi=te||Ze.numHorizontalGlyphVertices===0&&Ye===0,Go=ue||Ze.numIconVertices===0;if(bi||Go?Go?bi||(wt=wt&&ct):ct=wt&&ct:wt=ct=wt&&ct,ct&&Tr&&Tr.box&&this.collisionIndex.insertCollisionBox(Tr.box,L.get("text-ignore-placement"),P.bucketInstanceId,ir&&ir.box&&Jr?Jr:Hr,me.ID),wt&&Zt&&this.collisionIndex.insertCollisionBox(Zt.box,L.get("icon-ignore-placement"),P.bucketInstanceId,Qr,me.ID),wr&&(ct&&this.collisionIndex.insertCollisionCircles(wr.circles,L.get("text-ignore-placement"),P.bucketInstanceId,Hr,me.ID),w)){const Tn=P.bucketInstanceId;let tn=this.collisionCircleArrays[Tn];tn===void 0&&(tn=this.collisionCircleArrays[Tn]=new zd);for(let Dr=0;Dr<wr.circles.length;Dr+=4)tn.circles.push(wr.circles[Dr+0]),tn.circles.push(wr.circles[Dr+1]),tn.circles.push(wr.circles[Dr+2]),tn.circles.push(wr.collisionDetected?1:0)}const za=P.projection.name!=="globe";Ue=Ue&&(za||!St),Je=Je&&(za||!Kt),this.placements[xt]=new Bd(ct||Ue,wt||Je,mt||P.justReloaded),m.add(xt)};if(qe){const Ze=P.getSortedSymbolIndexes(this.transform.angle);for(let ut=Ze.length-1;ut>=0;--ut){const et=Ze[ut];bt(P.symbolInstances.get(et),et,P.collisionArrays[et])}}else for(let Ze=d.symbolInstanceStart;Ze<d.symbolInstanceEnd;Ze++)bt(P.symbolInstances.get(Ze),Ze,P.collisionArrays[Ze]);if(w&&P.bucketInstanceId in this.collisionCircleArrays){const Ze=this.collisionCircleArrays[P.bucketInstanceId];i.invert(Ze.invProjMatrix,z),Ze.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1}markUsedJustification(d,m,w,T){const{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:U,crossTileID:Z}=w,H=i.getAnchorJustification(m),Q=T===i.WritingMode.vertical?U:H==="left"?P:H==="center"?L:H==="right"?z:-1;P>=0&&(d.text.placedSymbolArray.get(P).crossTileID=Q>=0&&P!==Q?0:Z),L>=0&&(d.text.placedSymbolArray.get(L).crossTileID=Q>=0&&L!==Q?0:Z),z>=0&&(d.text.placedSymbolArray.get(z).crossTileID=Q>=0&&z!==Q?0:Z),U>=0&&(d.text.placedSymbolArray.get(U).crossTileID=Q>=0&&U!==Q?0:Z)}markUsedOrientation(d,m,w){const T=m===i.WritingMode.horizontal||m===i.WritingMode.horizontalOnly?m:0,P=m===i.WritingMode.vertical?m:0,{leftJustifiedTextSymbolIndex:L,centerJustifiedTextSymbolIndex:z,rightJustifiedTextSymbolIndex:U,verticalPlacedTextSymbolIndex:Z}=w,H=d.text.placedSymbolArray;L>=0&&(H.get(L).placedOrientation=T),z>=0&&(H.get(z).placedOrientation=T),U>=0&&(H.get(U).placedOrientation=T),Z>=0&&(H.get(Z).placedOrientation=P)}commit(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let w=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const T=m?m.symbolFadeChange(d):1,P=m?m.opacities:{},L=m?m.variableOffsets:{},z=m?m.placedOrientations:{};for(const U in this.placements){const Z=this.placements[U],H=P[U];H?(this.opacities[U]=new fs(H,T,Z.text,Z.icon,null,Z.clipped),w=w||Z.text!==H.text.placed||Z.icon!==H.icon.placed):(this.opacities[U]=new fs(null,T,Z.text,Z.icon,Z.skipFade,Z.clipped),w=w||Z.text||Z.icon)}for(const U in P){const Z=P[U];if(!this.opacities[U]){const H=new fs(Z,T,!1,!1);H.isHidden()||(this.opacities[U]=H,w=w||Z.text.placed||Z.icon.placed)}}for(const U in L)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=L[U]);for(const U in z)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=z[U]);w?this.lastPlacementChangeTime=d:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:d)}updateLayerOpacities(d,m){const w=new Set;for(const T of m){const P=T.getBucket(d);P&&T.latestFeatureIndex&&d.id===P.layerIds[0]&&this.updateBucketOpacities(P,w,T.collisionBoxArray)}}updateBucketOpacities(d,m,w){d.hasTextData()&&d.text.opacityVertexArray.clear(),d.hasIconData()&&d.icon.opacityVertexArray.clear(),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();const T=d.layers[0].layout,P=!!d.layers[0].dynamicFilter(),L=new fs(null,0,!1,!1,!0),z=T.get("text-allow-overlap"),U=T.get("icon-allow-overlap"),Z=T.get("text-variable-anchor"),H=T.get("text-rotation-alignment")==="map",Q=T.get("text-pitch-alignment")==="map",se=T.get("icon-text-fit")!=="none",de=new fs(null,0,z&&(U||!d.hasIconData()||T.get("icon-optional")),U&&(z||!d.hasTextData()||T.get("text-optional")),!0);!d.collisionArrays&&w&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(w);const fe=(me,te,ue)=>{for(let be=0;be<te/4;be++)me.opacityVertexArray.emplaceBack(ue)};let he=0;for(let me=0;me<d.symbolInstances.length;me++){const te=d.symbolInstances.get(me),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:be,crossTileID:we,numIconVertices:Oe}=te,Le=m.has(we);let De=this.opacities[we];Le?De=L:De||(De=de,this.opacities[we]=De),m.add(we);const qe=ue>0||be>0,Ue=Oe>0,Je=this.placedOrientations[we],bt=Je===i.WritingMode.vertical,Ze=Je===i.WritingMode.horizontal||Je===i.WritingMode.horizontalOnly;if(!qe&&!Ue||De.isHidden()||he++,qe){const ut=Ud(De.text);fe(d.text,ue,bt?Dn:ut),fe(d.text,be,Ze?Dn:ut);const et=De.text.isHidden(),{leftJustifiedTextSymbolIndex:xt,centerJustifiedTextSymbolIndex:Ye,rightJustifiedTextSymbolIndex:ct,verticalPlacedTextSymbolIndex:wt}=te,mt=d.text.placedSymbolArray,St=et||bt?1:0;xt>=0&&(mt.get(xt).hidden=St),Ye>=0&&(mt.get(Ye).hidden=St),ct>=0&&(mt.get(ct).hidden=St),wt>=0&&(mt.get(wt).hidden=et||Ze?1:0);const Kt=this.variableOffsets[we];Kt&&this.markUsedJustification(d,Kt.anchor,te,Je);const sr=this.placedOrientations[we];sr&&(this.markUsedJustification(d,"left",te,sr),this.markUsedOrientation(d,sr,te))}if(Ue){const ut=Ud(De.icon),{placedIconSymbolIndex:et,verticalPlacedIconSymbolIndex:xt}=te,Ye=d.icon.placedSymbolArray,ct=De.icon.isHidden()?1:0;et>=0&&(fe(d.icon,Oe,bt?Dn:ut),Ye.get(et).hidden=ct),xt>=0&&(fe(d.icon,te.numVerticalIconVertices,Ze?Dn:ut),Ye.get(xt).hidden=ct)}if(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData()){const ut=d.collisionArrays[me];if(ut){let et=new i.Point(0,0),xt=!0;if(ut.textBox||ut.verticalTextBox){if(Z){const ct=this.variableOffsets[we];ct?(et=$d(ct.anchor,ct.width,ct.height,ct.textOffset,ct.textScale),H&&et._rotate(Q?this.transform.angle:-this.transform.angle)):xt=!1}P&&(xt=!De.clipped),ut.textBox&&Qc(d.textCollisionBox.collisionVertexArray,De.text.placed,!xt||bt,et.x,et.y),ut.verticalTextBox&&Qc(d.textCollisionBox.collisionVertexArray,De.text.placed,!xt||Ze,et.x,et.y)}const Ye=xt&&!!(!Ze&&ut.verticalIconBox);ut.iconBox&&Qc(d.iconCollisionBox.collisionVertexArray,De.icon.placed,Ye,se?et.x:0,se?et.y:0),ut.verticalIconBox&&Qc(d.iconCollisionBox.collisionVertexArray,De.icon.placed,!Ye,se?et.x:0,se?et.y:0)}}}if(d.fullyClipped=he===0,d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.bucketInstanceId in this.collisionCircleArrays){const me=this.collisionCircleArrays[d.bucketInstanceId];d.placementInvProjMatrix=me.invProjMatrix,d.placementViewportMatrix=me.viewportMatrix,d.collisionCircleArray=me.circles,delete this.collisionCircleArrays[d.bucketInstanceId]}}symbolFadeChange(d){return this.fadeDuration===0?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(d){return Math.max(0,(this.transform.zoom-d)/1.5)}hasTransitions(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(d,m){const w=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*w>d}setStale(){this.stale=!0}}function Qc(v,d,m,w,T){v.emplaceBack(d?1:0,m?1:0,w||0,T||0),v.emplaceBack(d?1:0,m?1:0,w||0,T||0),v.emplaceBack(d?1:0,m?1:0,w||0,T||0),v.emplaceBack(d?1:0,m?1:0,w||0,T||0)}const co=Math.pow(2,25),Un=Math.pow(2,24),Lg=Math.pow(2,17),Bg=Math.pow(2,16),uo=Math.pow(2,9),Vo=Math.pow(2,8),l0=Math.pow(2,1);function Ud(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const d=v.placed?1:0,m=Math.floor(127*v.opacity);return m*co+d*Un+m*Lg+d*Bg+m*uo+d*Vo+m*l0+d}const Dn=0;class Vd{constructor(d){this._sortAcrossTiles=d.layout.get("symbol-z-order")!=="viewport-y"&&d.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(d,m,w,T,P){const L=this._bucketParts;for(;this._currentTileIndex<d.length;)if(m.getBucketParts(L,T,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((z,U)=>z.sortKey-U.sortKey));this._currentPartIndex<L.length;){const z=L[this._currentPartIndex];if(m.placeLayerBucketPart(z,this._seenCrossTileIDs,w,z.symbolInstanceStart===0),this._currentPartIndex++,P())return!0}return!1}}class zg{constructor(d,m,w,T,P,L,z,U){this.placement=new Nf(d,P,L,z,U),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=w,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(d,m,w){const T=i.exported.now(),P=()=>{const L=i.exported.now()-T;return!this._forceFullPlacement&&L>2};for(;this._currentPlacementIndex>=0;){const L=m[d[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=z)&&(!L.maxzoom||L.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new Vd(L)),this._inProgressLayer.continuePlacement(w[L.source],this.placement,this._showCollisionBoxes,L,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(d){return this.placement.commit(d),this.placement}}const ql=512/i.EXTENT/2;class Ni{constructor(d,m,w){this.tileID=d,this.bucketInstanceId=w,this.index=new i.KDBush(m.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const T=d.canonical.x*i.EXTENT,P=d.canonical.y*i.EXTENT;for(let L=0;L<m.length;L++){const{key:z,crossTileID:U,tileAnchorX:Z,tileAnchorY:H}=m.get(L),Q=Math.floor((T+Z)*ql),se=Math.floor((P+H)*ql);this.index.add(Q,se),this.keys.push(z),this.crossTileIDs.push(U)}this.index.finish()}findMatches(d,m,w){const T=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z),P=ql/Math.pow(2,m.canonical.z-this.tileID.canonical.z),L=m.canonical.x*i.EXTENT,z=m.canonical.y*i.EXTENT;for(let U=0;U<d.length;U++){const Z=d.get(U);if(Z.crossTileID)continue;const{key:H,tileAnchorX:Q,tileAnchorY:se}=Z,de=Math.floor((L+Q)*P),fe=Math.floor((z+se)*P),he=this.index.range(de-T,fe-T,de+T,fe+T);for(const me of he){const te=this.crossTileIDs[me];if(this.keys[me]===H&&!w.has(te)){w.add(te),Z.crossTileID=te;break}}}}}class $g{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Fg{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(d){const m=Math.round((d-this.lng)/360);if(m!==0)for(const w in this.indexes){const T=this.indexes[w],P={};for(const L in T){const z=T[L];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+m),P[z.tileID.key]=z}this.indexes[w]=P}this.lng=d}addBucket(d,m,w){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(let P=0;P<m.symbolInstances.length;P++)m.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]=new Set);const T=this.usedCrossTileIDs[d.overscaledZ];for(const P in this.indexes){const L=this.indexes[P];if(Number(P)>d.overscaledZ)for(const z in L){const U=L[z];U.tileID.isChildOf(d)&&U.findMatches(m.symbolInstances,d,T)}else{const z=L[d.scaledTo(Number(P)).key];z&&z.findMatches(m.symbolInstances,d,T)}}for(let P=0;P<m.symbolInstances.length;P++){const L=m.symbolInstances.get(P);L.crossTileID||(L.crossTileID=w.generate(),T.add(L.crossTileID))}return this.indexes[d.overscaledZ]===void 0&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new Ni(d,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(d,m){for(const w of m.crossTileIDs)this.usedCrossTileIDs[d].delete(w)}removeStaleBuckets(d){let m=!1;for(const w in this.indexes){const T=this.indexes[w];for(const P in T)d[T[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,T[P]),delete T[P],m=!0)}return m}}class ps{constructor(){this.layerIndexes={},this.crossTileIDs=new $g,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(d,m,w,T){let P=this.layerIndexes[d.id];P===void 0&&(P=this.layerIndexes[d.id]=new Fg);let L=!1;const z={};T.name!=="globe"&&P.handleWrapJump(w);for(const U of m){const Z=U.getBucket(d);Z&&d.id===Z.layerIds[0]&&(Z.bucketInstanceId||(Z.bucketInstanceId=++this.maxBucketInstanceId),P.addBucket(U.tileID,Z,this.crossTileIDs)&&(L=!0),z[Z.bucketInstanceId]=!0)}return P.removeStaleBuckets(z)&&(L=!0),L}pruneUnusedLayers(d){const m={};d.forEach(w=>{m[w]=!0});for(const w in this.layerIndexes)m[w]||delete this.layerIndexes[w]}}const ol=(v,d)=>i.emitValidationErrors(v,d&&d.filter(m=>m.identifier!=="source.canvas")),Mf=i.pick(Ur,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),$E=i.pick(Ur,["setCenter","setZoom","setBearing","setPitch"]),Ug={version:8,layers:[],sources:{}},eu={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ra extends i.Evented{constructor(d,m={}){super(),this.map=d,this.dispatcher=new Re(Yc(),this),this.imageManager=new pe,this.imageManager.setEventedParent(this),this.glyphManager=new i.GlyphManager(d._requestManager,m.localFontFamily?i.LocalGlyphMode.all:m.localIdeographFontFamily?i.LocalGlyphMode.ideographs:i.LocalGlyphMode.none,m.localFontFamily||m.localIdeographFontFamily),this.crossTileSymbolIndex=new ps,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",i.getReferrer());const w=this;this._rtlTextPluginCallback=Ra.registerForPluginStateChange(T=>{w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},(P,L)=>{if(i.triggerPluginCompletionEvent(P),L&&L.every(z=>z))for(const z in w._sourceCaches){const U=w._sourceCaches[z],Z=U.getSource().type;Z!=="vector"&&Z!=="geojson"||U.reload()}})}),this.on("data",T=>{if(T.dataType!=="source"||T.sourceDataType!=="metadata")return;const P=this.getSource(T.sourceId);if(P&&P.vectorLayerIds)for(const L in this._layers){const z=this._layers[L];z.source===P.id&&this._validateLayer(z)}})}loadURL(d,m={}){this.fire(new i.Event("dataloading",{dataType:"style"}));const w=typeof m.validate=="boolean"?m.validate:!i.isMapboxURL(d);d=this.map._requestManager.normalizeStyleURL(d,m.accessToken);const T=this.map._requestManager.transformRequest(d,i.ResourceType.Style);this._request=i.getJSON(T,(P,L)=>{this._request=null,P?this.fire(new i.ErrorEvent(P)):L&&this._load(L,w)})}loadJSON(d,m={}){this.fire(new i.Event("dataloading",{dataType:"style"})),this._request=i.exported.frame(()=>{this._request=null,this._load(d,m.validate!==!1)})}loadEmpty(){this.fire(new i.Event("dataloading",{dataType:"style"})),this._load(Ug,!1)}_updateLayerCount(d,m){const w=m?1:-1;d.is3D()&&(this._num3DLayers+=w),d.type==="circle"&&(this._numCircleLayers+=w),d.type==="symbol"&&(this._numSymbolLayers+=w)}_load(d,m){if(m&&ol(this,i.validateStyle(d)))return;this._loaded=!0,this.stylesheet=i.clone$1(d),this._updateMapProjection();for(const T in d.sources)this.addSource(T,d.sources[T],{validate:!1});this._changed=!1,d.sprite?this._loadSprite(d.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(d.glyphs);const w=n0(this.stylesheet.layers);this._order=w.map(T=>T.id),this._layers={},this._serializedLayers={};for(const T of w){const P=i.createStyleLayer(T);P.setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize(),this._updateLayerCount(P,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new _e(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new i.Event("data",{dataType:"style"})),this.fire(new i.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(d){d?this.stylesheet.projection=d:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(d){this._spriteRequest=function(m,w,T){let P,L,z;const U=i.exported.devicePixelRatio>1?"@2x":"";let Z=i.getJSON(w.transformRequest(w.normalizeSpriteURL(m,U,".json"),i.ResourceType.SpriteJSON),(se,de)=>{Z=null,z||(z=se,P=de,Q())}),H=i.getImage(w.transformRequest(w.normalizeSpriteURL(m,U,".png"),i.ResourceType.SpriteImage),(se,de)=>{H=null,z||(z=se,L=de,Q())});function Q(){if(z)T(z);else if(P&&L){const se=i.exported.getImageData(L),de={};for(const fe in P){const{width:he,height:me,x:te,y:ue,sdf:be,pixelRatio:we,stretchX:Oe,stretchY:Le,content:De}=P[fe],qe=new i.RGBAImage({width:he,height:me});i.RGBAImage.copy(se,qe,{x:te,y:ue},{x:0,y:0},{width:he,height:me}),de[fe]={data:qe,pixelRatio:we,sdf:be,stretchX:Oe,stretchY:Le,content:De}}T(null,de)}}return{cancel(){Z&&(Z.cancel(),Z=null),H&&(H.cancel(),H=null)}}}(d,this.map._requestManager,(m,w)=>{if(this._spriteRequest=null,m)this.fire(new i.ErrorEvent(m));else if(w)for(const T in w)this.imageManager.addImage(T,w[T]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new i.Event("data",{dataType:"style"}))})}_validateLayer(d){const m=this.getSource(d.source);if(!m)return;const w=d.sourceLayer;w&&(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(w)===-1)&&this.fire(new i.ErrorEvent(new Error(`Source layer "${w}" does not exist on source "${m.id}" as specified by style layer "${d.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const d in this._sourceCaches)if(!this._sourceCaches[d].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(d){const m=[];for(const w of d){const T=this._layers[w];T.type!=="custom"&&m.push(T.serialize())}return m}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const d in this._sourceCaches)if(this._sourceCaches[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(d){return!!this.terrain&&(typeof d.isLayerDraped=="function"?d.isLayerDraped():eu[d.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(d){if(!this._loaded)return;const m=this._changed;if(this._changed){const T=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);(T.length||P.length)&&this._updateWorkerLayers(T,P);for(const L in this._updatedSources){const z=this._updatedSources[L];z==="reload"?this._reloadSource(L):z==="clear"&&this._clearSource(L)}this._updateTilesForChangedImages();for(const L in this._updatedPaintProps)this._layers[L].updateTransitions(d);this.light.updateTransitions(d),this.fog&&this.fog.updateTransitions(d),this._resetUpdates()}const w={};for(const T in this._sourceCaches){const P=this._sourceCaches[T];w[T]=P.used,P.used=!1}for(const T of this._order){const P=this._layers[T];if(P.recalculate(d,this._availableImages),!P.isHidden(d.zoom)){const z=this._getLayerSourceCache(P);z&&(z.used=!0)}const L=this.map.painter;if(L){const z=P.getProgramIds();if(!z)continue;const U=P.getProgramConfiguration(d.zoom);for(const Z of z)L.useProgram(Z,U)}}for(const T in w){const P=this._sourceCaches[T];w[T]!==P.used&&P.getSource().fire(new i.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:P.getSource().id}))}this.light.recalculate(d),this.terrain&&this.terrain.recalculate(d),this.fog&&this.fog.recalculate(d),this.z=d.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new i.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const d=Object.keys(this._changedImages);if(d.length){for(const m in this._sourceCaches)this._sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],d);this._changedImages={}}}_updateWorkerLayers(d,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(d),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(d){if(this._checkLoaded(),ol(this,i.validateStyle(d)))return!1;(d=i.clone$1(d)).layers=n0(d.layers);const m=function(T,P){if(!T)return[{command:Ur.setStyle,args:[P]}];let L=[];try{if(!p(T.version,P.version))return[{command:Ur.setStyle,args:[P]}];p(T.center,P.center)||L.push({command:Ur.setCenter,args:[P.center]}),p(T.zoom,P.zoom)||L.push({command:Ur.setZoom,args:[P.zoom]}),p(T.bearing,P.bearing)||L.push({command:Ur.setBearing,args:[P.bearing]}),p(T.pitch,P.pitch)||L.push({command:Ur.setPitch,args:[P.pitch]}),p(T.sprite,P.sprite)||L.push({command:Ur.setSprite,args:[P.sprite]}),p(T.glyphs,P.glyphs)||L.push({command:Ur.setGlyphs,args:[P.glyphs]}),p(T.transition,P.transition)||L.push({command:Ur.setTransition,args:[P.transition]}),p(T.light,P.light)||L.push({command:Ur.setLight,args:[P.light]}),p(T.fog,P.fog)||L.push({command:Ur.setFog,args:[P.fog]}),p(T.projection,P.projection)||L.push({command:Ur.setProjection,args:[P.projection]});const z={},U=[];(function(Q,se,de,fe){let he;for(he in se=se||{},Q=Q||{})Q.hasOwnProperty(he)&&(se.hasOwnProperty(he)||Dd(he,de,fe));for(he in se){if(!se.hasOwnProperty(he))continue;const me=se[he];Q.hasOwnProperty(he)?p(Q[he],me)||(Q[he].type==="geojson"&&me.type==="geojson"&&kf(Q,se,he)?de.push({command:Ur.setGeoJSONSourceData,args:[he,me.data]}):Mg(he,se,de,fe)):Ng(he,se,de)}})(T.sources,P.sources,U,z);const Z=[];T.layers&&T.layers.forEach(Q=>{Q.source&&z[Q.source]?L.push({command:Ur.removeLayer,args:[Q.id]}):Z.push(Q)});let H=T.terrain;H&&z[H.source]&&(L.push({command:Ur.setTerrain,args:[void 0]}),H=void 0),L=L.concat(U),p(H,P.terrain)||L.push({command:Ur.setTerrain,args:[P.terrain]}),function(Q,se,de){se=se||[];const fe=(Q=Q||[]).map(us),he=se.map(us),me=Q.reduce(Ig,{}),te=se.reduce(Ig,{}),ue=fe.slice(),be=Object.create(null);let we,Oe,Le,De,qe,Ue,Je;for(we=0,Oe=0;we<fe.length;we++)Le=fe[we],te.hasOwnProperty(Le)?Oe++:(de.push({command:Ur.removeLayer,args:[Le]}),ue.splice(ue.indexOf(Le,Oe),1));for(we=0,Oe=0;we<he.length;we++)Le=he[he.length-1-we],ue[ue.length-1-we]!==Le&&(me.hasOwnProperty(Le)?(de.push({command:Ur.removeLayer,args:[Le]}),ue.splice(ue.lastIndexOf(Le,ue.length-Oe),1)):Oe++,Ue=ue[ue.length-we],de.push({command:Ur.addLayer,args:[te[Le],Ue]}),ue.splice(ue.length-we,0,Le),be[Le]=!0);for(we=0;we<he.length;we++)if(Le=he[we],De=me[Le],qe=te[Le],!be[Le]&&!p(De,qe))if(p(De.source,qe.source)&&p(De["source-layer"],qe["source-layer"])&&p(De.type,qe.type)){for(Je in Oa(De.layout,qe.layout,de,Le,null,Ur.setLayoutProperty),Oa(De.paint,qe.paint,de,Le,null,Ur.setPaintProperty),p(De.filter,qe.filter)||de.push({command:Ur.setFilter,args:[Le,qe.filter]}),p(De.minzoom,qe.minzoom)&&p(De.maxzoom,qe.maxzoom)||de.push({command:Ur.setLayerZoomRange,args:[Le,qe.minzoom,qe.maxzoom]}),De)De.hasOwnProperty(Je)&&Je!=="layout"&&Je!=="paint"&&Je!=="filter"&&Je!=="metadata"&&Je!=="minzoom"&&Je!=="maxzoom"&&(Je.indexOf("paint.")===0?Oa(De[Je],qe[Je],de,Le,Je.slice(6),Ur.setPaintProperty):p(De[Je],qe[Je])||de.push({command:Ur.setLayerProperty,args:[Le,Je,qe[Je]]}));for(Je in qe)qe.hasOwnProperty(Je)&&!De.hasOwnProperty(Je)&&Je!=="layout"&&Je!=="paint"&&Je!=="filter"&&Je!=="metadata"&&Je!=="minzoom"&&Je!=="maxzoom"&&(Je.indexOf("paint.")===0?Oa(De[Je],qe[Je],de,Le,Je.slice(6),Ur.setPaintProperty):p(De[Je],qe[Je])||de.push({command:Ur.setLayerProperty,args:[Le,Je,qe[Je]]}))}else de.push({command:Ur.removeLayer,args:[Le]}),Ue=ue[ue.lastIndexOf(Le)+1],de.push({command:Ur.addLayer,args:[qe,Ue]})}(Z,P.layers,L)}catch(z){console.warn("Unable to compute style diff:",z),L=[{command:Ur.setStyle,args:[P]}]}return L}(this.serialize(),d).filter(T=>!(T.command in $E));if(m.length===0)return!1;const w=m.filter(T=>!(T.command in Mf));if(w.length>0)throw new Error(`Unimplemented: ${w.map(T=>T.command).join(", ")}.`);return m.forEach(T=>{T.command!=="setTransition"&&T.command!=="setProjection"&&this[T.command].apply(this,T.args)}),this.stylesheet=d,this._updateMapProjection(),!0}addImage(d,m){return this.getImage(d)?this.fire(new i.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(d,m),this._afterImageUpdated(d),this)}updateImage(d,m){this.imageManager.updateImage(d,m)}getImage(d){return this.imageManager.getImage(d)}removeImage(d){return this.getImage(d)?(this.imageManager.removeImage(d),this._afterImageUpdated(d),this):this.fire(new i.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(d){this._availableImages=this.imageManager.listImages(),this._changedImages[d]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new i.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(d,m,w={}){if(this._checkLoaded(),this.getSource(d)!==void 0)throw new Error("There is already a source with this ID");if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(i.validateSource,`sources.${d}`,m,null,w))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const T=_r(d,m,this.dispatcher,this);T.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(d),source:T.serialize(),sourceId:d}));const P=L=>{const z=(L?"symbol:":"other:")+d,U=this._sourceCaches[z]=new i.SourceCache(z,T,L);(L?this._symbolSourceCaches:this._otherSourceCaches)[d]=U,U.style=this,U.onAdd(this.map)};P(!1),m.type!=="vector"&&m.type!=="geojson"||P(!0),T.onAdd&&T.onAdd(this.map),this._changed=!0}removeSource(d){this._checkLoaded();const m=this.getSource(d);if(!m)throw new Error("There is no source with this ID");for(const T in this._layers)if(this._layers[T].source===d)return this.fire(new i.ErrorEvent(new Error(`Source "${d}" cannot be removed while layer "${T}" is using it.`)));if(this.terrain&&this.terrain.get().source===d)return this.fire(new i.ErrorEvent(new Error(`Source "${d}" cannot be removed while terrain is using it.`)));const w=this._getSourceCaches(d);for(const T of w)delete this._sourceCaches[T.id],delete this._updatedSources[T.id],T.fire(new i.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:T.getSource().id})),T.setEventedParent(null),T.clearTiles();return delete this._otherSourceCaches[d],delete this._symbolSourceCaches[d],m.setEventedParent(null),m.onRemove&&m.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(d,m){this._checkLoaded(),this.getSource(d).setData(m),this._changed=!0}getSource(d){const m=this._getSourceCache(d);return m&&m.getSource()}_getSources(){const d=[];for(const m in this._otherSourceCaches){const w=this._getSourceCache(m);w&&d.push(w.getSource())}return d}addLayer(d,m,w={}){this._checkLoaded();const T=d.id;if(this.getLayer(T))return void this.fire(new i.ErrorEvent(new Error(`Layer with id "${T}" already exists on this map`)));let P;if(d.type==="custom"){if(ol(this,i.validateCustomStyleLayer(d)))return;P=i.createStyleLayer(d)}else{if(typeof d.source=="object"&&(this.addSource(T,d.source),d=i.clone$1(d),d=i.extend(d,{source:T})),this._validate(i.validateLayer,`layers.${T}`,d,{arrayIndex:-1},w))return;P=i.createStyleLayer(d),this._validateLayer(P),P.setEventedParent(this,{layer:{id:T}}),this._serializedLayers[P.id]=P.serialize(),this._updateLayerCount(P,!0)}const L=m?this._order.indexOf(m):this._order.length;if(m&&L===-1)return void this.fire(new i.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`)));this._order.splice(L,0,T),this._layerOrderChanged=!0,this._layers[T]=P;const z=this._getLayerSourceCache(P);if(this._removedLayers[T]&&P.source&&z&&P.type!=="custom"){const U=this._removedLayers[T];delete this._removedLayers[T],U.type!==P.type?this._updatedSources[P.source]="clear":(this._updatedSources[P.source]="reload",z.pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(d,m){if(this._checkLoaded(),this._changed=!0,!this._layers[d])return void this.fire(new i.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be moved.`)));if(d===m)return;const w=this._order.indexOf(d);this._order.splice(w,1);const T=m?this._order.indexOf(m):this._order.length;m&&T===-1?this.fire(new i.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`))):(this._order.splice(T,0,d),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(d){this._checkLoaded();const m=this._layers[d];if(!m)return void this.fire(new i.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be removed.`)));m.setEventedParent(null),this._updateLayerCount(m,!1);const w=this._order.indexOf(d);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[d]=m,delete this._layers[d],delete this._serializedLayers[d],delete this._updatedLayers[d],delete this._updatedPaintProps[d],m.onRemove&&m.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(d){return this._layers[d]}hasLayer(d){return d in this._layers}hasLayerType(d){for(const m in this._layers)if(this._layers[m].type===d)return!0;return!1}setLayerZoomRange(d,m,w){this._checkLoaded();const T=this.getLayer(d);T?T.minzoom===m&&T.maxzoom===w||(m!=null&&(T.minzoom=m),w!=null&&(T.maxzoom=w),this._updateLayer(T)):this.fire(new i.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(d,m,w={}){this._checkLoaded();const T=this.getLayer(d);if(T){if(!p(T.filter,m))return m==null?(T.filter=void 0,void this._updateLayer(T)):void(this._validate(i.validateFilter,`layers.${T.id}.filter`,m,{layerType:T.type},w)||(T.filter=i.clone$1(m),this._updateLayer(T)))}else this.fire(new i.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be filtered.`)))}getFilter(d){const m=this.getLayer(d);return m&&i.clone$1(m.filter)}setLayoutProperty(d,m,w,T={}){this._checkLoaded();const P=this.getLayer(d);P?p(P.getLayoutProperty(m),w)||(P.setLayoutProperty(m,w,T),this._updateLayer(P)):this.fire(new i.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(d,m){const w=this.getLayer(d);if(w)return w.getLayoutProperty(m);this.fire(new i.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style.`)))}setPaintProperty(d,m,w,T={}){this._checkLoaded();const P=this.getLayer(d);P?p(P.getPaintProperty(m),w)||(P.setPaintProperty(m,w,T)&&this._updateLayer(P),this._changed=!0,this._updatedPaintProps[d]=!0):this.fire(new i.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(d,m){const w=this.getLayer(d);return w&&w.getPaintProperty(m)}setFeatureState(d,m){this._checkLoaded();const w=d.source,T=d.sourceLayer,P=this.getSource(w);if(!P)return void this.fire(new i.ErrorEvent(new Error(`The source '${w}' does not exist in the map's style.`)));const L=P.type;if(L==="geojson"&&T)return void this.fire(new i.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(L==="vector"&&!T)return void this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));d.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided.")));const z=this._getSourceCaches(w);for(const U of z)U.setFeatureState(T,d.id,m)}removeFeatureState(d,m){this._checkLoaded();const w=d.source,T=this.getSource(w);if(!T)return void this.fire(new i.ErrorEvent(new Error(`The source '${w}' does not exist in the map's style.`)));const P=T.type,L=P==="vector"?d.sourceLayer:void 0;if(P==="vector"&&!L)return void this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(m&&typeof d.id!="string"&&typeof d.id!="number")return void this.fire(new i.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const z=this._getSourceCaches(w);for(const U of z)U.removeFeatureState(L,d.id,m)}getFeatureState(d){this._checkLoaded();const m=d.source,w=d.sourceLayer,T=this.getSource(m);if(T){if(T.type!=="vector"||w)return d.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(m)[0].getFeatureState(w,d.id);this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return i.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const d={};for(const m in this._sourceCaches){const w=this._sourceCaches[m].getSource();d[w.id]||(d[w.id]=w.serialize())}return i.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:d,layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateLayer(d){this._updatedLayers[d.id]=!0;const m=this._getLayerSourceCache(d);d.source&&!this._updatedSources[d.source]&&m&&m.getSource().type!=="raster"&&(this._updatedSources[d.source]="reload",m.pause()),this._changed=!0,d.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(d){const m=L=>this._layers[L].type==="fill-extrusion",w={},T=[];for(let L=this._order.length-1;L>=0;L--){const z=this._order[L];if(m(z)){w[z]=L;for(const U of d){const Z=U[z];if(Z)for(const H of Z)T.push(H)}}}T.sort((L,z)=>z.intersectionZ-L.intersectionZ);const P=[];for(let L=this._order.length-1;L>=0;L--){const z=this._order[L];if(m(z))for(let U=T.length-1;U>=0;U--){const Z=T[U].feature;if(w[Z.layer.id]<L)break;P.push(Z),T.pop()}else for(const U of d){const Z=U[z];if(Z)for(const H of Z)P.push(H.feature)}}return P}queryRenderedFeatures(d,m,w){m&&m.filter&&this._validate(i.validateFilter,"queryRenderedFeatures.filter",m.filter,null,m);const T={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new i.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const U of m.layers){const Z=this._layers[U];if(!Z)return this.fire(new i.ErrorEvent(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];T[Z.source]=!0}}const P=[];m.availableImages=this._availableImages;const L=m&&m.layers?m.layers.some(U=>{const Z=this.getLayer(U);return Z&&Z.is3D()}):this.has3DLayers(),z=Fe.createFromScreenPoints(d,w);for(const U in this._sourceCaches){const Z=this._sourceCaches[U].getSource().id;m.layers&&!T[Z]||P.push(Cn(this._sourceCaches[U],this._layers,this._serializedLayers,z,m,w,L,!!this.map._showQueryGeometry))}return this.placement&&P.push(function(U,Z,H,Q,se,de,fe){const he={},me=de.queryRenderedSymbols(Q),te=[];for(const ue of Object.keys(me).map(Number))te.push(fe[ue]);te.sort(Fi);for(const ue of te){const be=ue.featureIndex.lookupSymbolFeatures(me[ue.bucketInstanceId],Z,ue.bucketIndex,ue.sourceLayerIndex,se.filter,se.layers,se.availableImages,U);for(const we in be){const Oe=he[we]=he[we]||[],Le=be[we];Le.sort((De,qe)=>{const Ue=ue.featureSortOrder;if(Ue){const Je=Ue.indexOf(De.featureIndex);return Ue.indexOf(qe.featureIndex)-Je}return qe.featureIndex-De.featureIndex});for(const De of Le)Oe.push(De)}}for(const ue in he)he[ue].forEach(be=>{const we=be.feature,Oe=H(U[ue]);if(!Oe)return;const Le=Oe.getFeatureState(we.layer["source-layer"],we.id);we.source=we.layer.source,we.layer["source-layer"]&&(we.sourceLayer=we.layer["source-layer"]),we.state=Le});return he}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),z.screenGeometry,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(d,m){m&&m.filter&&this._validate(i.validateFilter,"querySourceFeatures.filter",m.filter,null,m);const w=this._getSourceCaches(d);let T=[];for(const P of w)T=T.concat(Xn(P,m));return T}addSourceType(d,m,w){return Ra.getSourceType(d)?w(new Error(`A source type called "${d}" already exists.`)):(Ra.setSourceType(d,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:d,url:m.workerSourceURL},w):w(null,null))}getLight(){return this.light.getLight()}setLight(d,m={}){this._checkLoaded();const w=this.light.getLight();let T=!1;for(const L in d)if(!p(d[L],w[L])){T=!0;break}if(!T)return;const P=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(d,m),this.light.updateTransitions(P)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(d,m=1){if(this._checkLoaded(),!d)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let w=d;if(m===1){if(typeof w.source=="object"){const T="terrain-dem-src";this.addSource(T,w.source),w=i.clone$1(w),w=i.extend(w,{source:T})}if(this._validate(i.validateTerrain,"terrain",w))return}if(!this.terrain||this.terrain&&m!==this.terrain.drapeRenderMode){if(!w)return;this._createTerrain(w,m)}else{const T=this.terrain,P=T.get();for(const L of Object.keys(i.spec.terrain))!w.hasOwnProperty(L)&&i.spec.terrain[L].default&&(w[L]=i.spec.terrain[L].default);for(const L in w)if(!p(w[L],P[L])){T.set(w),this.stylesheet.terrain=w;const z=this._setTransitionParameters({duration:0});T.updateTransitions(z);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(d){const m=this.fog=new Pe(d,this.map.transform);this.stylesheet.fog=d;const w=this._setTransitionParameters({duration:0});m.updateTransitions(w)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const d of this.map._markers)d._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(d){if(this._checkLoaded(),!d)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const m=this.fog,w=m.get();Object.keys(d).length===0&&m.set(d);for(const T in d)if(!p(d[T],w[T])){m.set(d),this.stylesheet.fog=d;const P=this._setTransitionParameters({duration:0});m.updateTransitions(P);break}}else this._createFog(d);this._markersNeedUpdate=!0}_setTransitionParameters(d){return{now:i.exported.now(),transition:i.extend(d,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const d=this._order.filter(w=>this.isLayerDraped(this._layers[w])),m=this._order.filter(w=>!this.isLayerDraped(this._layers[w]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...d),this._drapedFirstOrder.push(...m)}_createTerrain(d,m){const w=this.terrain=new xe(d,m);this.stylesheet.terrain=d,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const T=this._setTransitionParameters({duration:0});w.updateTransitions(T)}_force3DLayerUpdate(){for(const d in this._layers){const m=this._layers[d];m.type==="fill-extrusion"&&this._updateLayer(m)}}_forceSymbolLayerUpdate(){for(const d in this._layers){const m=this._layers[d];m.type==="symbol"&&this._updateLayer(m)}}_validate(d,m,w,T,P={}){return(!P||P.validate!==!1)&&ol(this,d.call(i.validateStyle,i.extend({key:m,style:this.serialize(),value:w,styleSpec:i.spec},T)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this._sourceCaches)this._sourceCaches[d].clearTiles(),this._sourceCaches[d].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(d){const m=this._getSourceCaches(d);for(const w of m)w.clearTiles()}_reloadSource(d){const m=this._getSourceCaches(d);for(const w of m)w.resume(),w.reload()}_reloadSources(){for(const d of this._getSources())d.reload&&d.reload()}_updateSources(d){for(const m in this._sourceCaches)this._sourceCaches[m].update(d)}_generateCollisionBoxes(){for(const d in this._sourceCaches){const m=this._sourceCaches[d];m.resume(),m.reload()}}_updatePlacement(d,m,w,T,P=!1){let L=!1,z=!1;const U={};for(const Z of this._order){const H=this._layers[Z];if(H.type!=="symbol")continue;if(!U[H.source]){const se=this._getLayerSourceCache(H);if(!se)continue;U[H.source]=se.getRenderableIds(!0).map(de=>se.getTileByID(de)).sort((de,fe)=>fe.tileID.overscaledZ-de.tileID.overscaledZ||(de.tileID.isLessThan(fe.tileID)?-1:1))}const Q=this.crossTileSymbolIndex.addLayer(H,U[H.source],d.center.lng,d.projection);L=L||Q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),P=P||this._layerOrderChanged||w===0,this._layerOrderChanged&&this.fire(new i.Event("neworder")),(P||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.exported.now(),d.zoom))&&(this.pauseablePlacement=new zg(d,this._order,P,m,w,T,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.exported.now()),z=!0),L&&this.pauseablePlacement.placement.setStale()),z||L)for(const Z of this._order){const H=this._layers[Z];H.type==="symbol"&&this.placement.updateLayerOpacities(H,U[H.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.exported.now())}_releaseSymbolFadeTiles(){for(const d in this._sourceCaches)this._sourceCaches[d].releaseSymbolFadeTiles()}getImages(d,m,w){this.imageManager.getImages(m.icons,w),this._updateTilesForChangedImages();const T=P=>{P&&P.setDependencies(m.tileID.key,m.type,m.icons)};T(this._otherSourceCaches[m.source]),T(this._symbolSourceCaches[m.source])}getGlyphs(d,m,w){this.glyphManager.getGlyphs(m.stacks,w)}getResource(d,m,w){return i.makeRequest(m,w)}_getSourceCache(d){return this._otherSourceCaches[d]}_getLayerSourceCache(d){return d.type==="symbol"?this._symbolSourceCaches[d.source]:this._otherSourceCaches[d.source]}_getSourceCaches(d){const m=[];return this._otherSourceCaches[d]&&m.push(this._otherSourceCaches[d]),this._symbolSourceCaches[d]&&m.push(this._symbolSourceCaches[d]),m}_isSourceCacheLoaded(d){const m=this._getSourceCaches(d);return m.length===0?(this.fire(new i.ErrorEvent(new Error(`There is no source with ID '${d}'`))),!1):m.every(w=>w.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ra.getSourceType=function(v){return mr[v]},Ra.setSourceType=function(v,d){mr[v]=d},Ra.registerForPluginStateChange=i.registerForPluginStateChange;var Vg=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Wl="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ms=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,qd=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,gs=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let If={},tu={};const Wd=[];ru(Vg,Wd),ru(ms,Wd),ru(qd,Wd),ru(gs,Wd),If=Vr("",ms),tu=Vr(gs,qd);const c0=Vr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Of=Vg,qg=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Wg={background:Vr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Vr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Vr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Vr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Vr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Vr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Vr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Vr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Vr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Vr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Vr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Vr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Vr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Vr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Vr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Vr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Vr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Vr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Vr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Vr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Vr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Vr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Vr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Vr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Vr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Vr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Wl),skyboxGradient:Vr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Wl),skyboxCapture:Vr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Vr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Vr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function ru(v,d){const m=v.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let w of m)if(w=w.trim(),w[0]==="#"&&w.includes("if")&&!w.includes("endif")){w=w.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const T=w.split(" ");for(const P of T)d.includes(P)||d.push(P)}}function Vr(v,d){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=d.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),T={},P=[...Wd];return ru(v,P),ru(d,P),{fragmentSource:v=v.replace(m,(L,z,U,Z,H)=>(T[H]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${H}
varying ${U} ${Z} ${H};
#else
uniform ${U} ${Z} u_${H};
#endif
`:`
#ifdef HAS_UNIFORM_u_${H}
    ${U} ${Z} ${H} = u_${H};
#endif
`)),vertexSource:d=d.replace(m,(L,z,U,Z,H)=>{const Q=Z==="float"?"vec2":"vec4",se=H.match(/color/)?"color":Q;return T[H]?z==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${U} ${Q} a_${H};
varying ${U} ${Z} ${H};
#else
uniform ${U} ${Z} u_${H};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${U} ${Z} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${se}(a_${H}, u_${H}_t);
#else
    ${U} ${Z} ${H} = u_${H};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${U} ${Q} a_${H};
#else
uniform ${U} ${Z} u_${H};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${U} ${Z} ${H} = a_${H};
#else
    ${U} ${Z} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${U} ${Z} ${H} = unpack_mix_${se}(a_${H}, u_${H}_t);
#else
    ${U} ${Z} ${H} = u_${H};
#endif
`}),staticAttributes:w,usedDefines:P}}class FE{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(d,m,w,T,P,L,z){this.context=d;let U=this.boundPaintVertexBuffers.length!==T.length;for(let H=0;!U&&H<T.length;H++)this.boundPaintVertexBuffers[H]!==T[H]&&(U=!0);let Z=this.boundDynamicVertexBuffers.length!==z.length;for(let H=0;!Z&&H<z.length;H++)this.boundDynamicVertexBuffers[H]!==z[H]&&(Z=!0);if(!d.extVertexArrayObject||!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==w||U||Z||this.boundIndexBuffer!==P||this.boundVertexOffset!==L)this.freshBind(m,w,T,P,L,z);else{d.bindVertexArrayOES.set(this.vao);for(const H of z)H&&H.bind();P&&P.dynamicDraw&&P.bind()}}freshBind(d,m,w,T,P,L){let z;const U=d.numAttributes,Z=this.context,H=Z.gl;if(Z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Z.extVertexArrayObject.createVertexArrayOES(),Z.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=d,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=T,this.boundVertexOffset=P,this.boundDynamicVertexBuffers=L;else{z=Z.currentNumAttributes||0;for(let Q=U;Q<z;Q++)H.disableVertexAttribArray(Q)}m.enableAttributes(H,d),m.bind(),m.setVertexAttribPointers(H,d,P);for(const Q of w)Q.enableAttributes(H,d),Q.bind(),Q.setVertexAttribPointers(H,d,P);for(const Q of L)Q&&(Q.enableAttributes(H,d),Q.bind(),Q.setVertexAttribPointers(H,d,P));T&&T.bind(),Z.currentNumAttributes=U}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Gg(v,d){const m=Math.pow(2,d.canonical.z),w=d.canonical.y;return[new i.MercatorCoordinate(0,w/m).toLngLat().lat,new i.MercatorCoordinate(0,(w+1)/m).toLngLat().lat]}function u0(v,d,m,w,T,P,L){const z=v.context,U=z.gl,Z=m.fbo;if(!Z)return;v.prepareDrawTile();const H=v.useProgram("hillshade");z.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,Z.colorAttachment.get());const Q=((he,me,te,ue)=>{const be=te.paint.get("hillshade-shadow-color"),we=te.paint.get("hillshade-highlight-color"),Oe=te.paint.get("hillshade-accent-color");let Le=te.paint.get("hillshade-illumination-direction")*(Math.PI/180);te.paint.get("hillshade-illumination-anchor")==="viewport"&&(Le-=he.transform.angle);const De=!he.options.moving;return{u_matrix:ue||he.transform.calculateProjMatrix(me.tileID.toUnwrapped(),De),u_image:0,u_latrange:Gg(0,me.tileID),u_light:[te.paint.get("hillshade-exaggeration"),Le],u_shadow:be,u_highlight:we,u_accent:Oe}})(v,m,w,v.terrain?d.projMatrix:null);v.prepareDrawProgram(z,H,d.toUnwrapped());const{tileBoundsBuffer:se,tileBoundsIndexBuffer:de,tileBoundsSegments:fe}=v.getTileBoundsBuffers(m);H.draw(z,U.TRIANGLES,T,P,L,i.CullFaceMode.disabled,Q,w.id,se,de,fe)}function Hg(v,d,m){if(!d.needsDEMTextureUpload)return;const w=v.context,T=w.gl;w.pixelStoreUnpackPremultiplyAlpha.set(!1),d.demTexture=d.demTexture||v.getTileTexture(m.stride);const P=m.getPixels();d.demTexture?d.demTexture.update(P,{premultiply:!1}):d.demTexture=new i.Texture(w,P,T.RGBA,{premultiply:!1}),d.needsDEMTextureUpload=!1}function d0(v,d,m,w,T,P){const L=v.context,z=L.gl;if(!d.dem)return;const U=d.dem;if(L.activeTexture.set(z.TEXTURE1),Hg(v,d,U),!d.demTexture)return;d.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);const Z=U.dim;L.activeTexture.set(z.TEXTURE0);let H=d.fbo;if(!H){const fe=new i.Texture(L,{width:Z,height:Z,data:null},z.RGBA);fe.bind(z.LINEAR,z.CLAMP_TO_EDGE),H=d.fbo=L.createFramebuffer(Z,Z,!0),H.colorAttachment.set(fe.texture)}L.bindFramebuffer.set(H.framebuffer),L.viewport.set([0,0,Z,Z]);const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:se,tileBoundsSegments:de}=v.getMercatorTileBoundsBuffers();v.useProgram("hillshadePrepare").draw(L,z.TRIANGLES,w,T,P,i.CullFaceMode.disabled,((fe,he)=>{const me=he.stride,te=i.create();return i.ortho(te,0,i.EXTENT,-i.EXTENT,0,0,1),i.translate(te,te,[0,-i.EXTENT,0]),{u_matrix:te,u_image:1,u_dimension:[me,me],u_zoom:fe.overscaledZ,u_unpack:he.unpackVector}})(d.tileID,U),m.id,Q,se,de),d.needsHillshadePrepare=!1}const Xg=v=>({u_matrix:new i.UniformMatrix4f(v),u_image0:new i.Uniform1i(v),u_skirt_height:new i.Uniform1f(v)}),nu=(v,d)=>({u_matrix:v,u_image0:0,u_skirt_height:d}),Df=(v,d,m,w,T,P,L,z,U,Z,H,Q,se,de,fe)=>({u_proj_matrix:Float32Array.from(v),u_globe_matrix:d,u_normalize_matrix:Float32Array.from(w),u_merc_matrix:m,u_zoom_transition:T,u_merc_center:P,u_image0:0,u_frustum_tl:L,u_frustum_tr:z,u_frustum_br:U,u_frustum_bl:Z,u_globe_pos:H,u_globe_radius:Q,u_viewport:se,u_grid_matrix:fe?Float32Array.from(fe):new Float32Array(9),u_skirt_height:de});function iu(v,d){return v!=null&&d!=null&&!(!v.hasData()||!d.hasData())&&v.demTexture!=null&&d.demTexture!=null&&v.tileID.key!==d.tileID.key}const ys=new class{constructor(){this.operations={}}newMorphing(v,d,m,w,T){if(v in this.operations){const P=this.operations[v];P.to.tileID.key!==m.tileID.key&&(P.queued=m)}else this.operations[v]={startTime:w,phase:0,duration:T,from:d,to:m,queued:null}}getMorphValuesForProxy(v){if(!(v in this.operations))return null;const d=this.operations[v];return{from:d.from,to:d.to,phase:d.phase}}update(v){for(const d in this.operations){const m=this.operations[d];for(m.phase=(v-m.startTime)/m.duration;m.phase>=1||!this._validOp(m);)if(!this._nextOp(m,v)){delete this.operations[d];break}}}_nextOp(v,d){return!!v.queued&&(v.from=v.to,v.to=v.queued,v.queued=null,v.phase=0,v.startTime=d,!0)}_validOp(v){return v.from.hasData()&&v.to.hasData()}},Gl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Rf(v){return 6*Math.pow(1.5,22-v)}function h0(v,d){const m=1<<v.z;return!d&&(v.x===0||v.x===m-1)||v.y===0||v.y===m-1}const Gd=v=>({u_matrix:v});function Zg(v,d,m,w,T){if(T>0){const P=i.exported.now(),L=(P-v.timeAdded)/T,z=d?(P-d.timeAdded)/T:-1,U=m.getSource(),Z=w.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),H=!d||Math.abs(d.tileID.overscaledZ-Z)>Math.abs(v.tileID.overscaledZ-Z),Q=H&&v.refreshedUponExpiration?1:i.clamp(H?L:1-z,0,1);return v.refreshedUponExpiration&&L>=1&&(v.refreshedUponExpiration=!1),d?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}class Kg extends i.SourceCache{constructor(d){const m={type:"raster-dem",maxzoom:d.transform.maxZoom},w=new Re(Yc(),null),T=_r("mock-dem",m,w,d.style);super("mock-dem",T,!1),T.setEventedParent(this),this._sourceLoaded=!0}_loadTile(d,m){d.state="loaded",m(null)}}class Lf extends i.SourceCache{constructor(d){const m=_r("proxy",{type:"geojson",maxzoom:d.transform.maxZoom},new Re(Yc(),null),d.style);super("proxy",m,!1),m.setEventedParent(this),this.map=this.getSource().map=d,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(d,m,w){if(d.freezeTileCoverage)return;this.transform=d;const T=d.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((P,L)=>{if(P[L.key]="",!this._tiles[L.key]){const z=new i.Tile(L,this._source.tileSize*L.overscaleFactor(),d.tileZoom);z.state="loaded",this._tiles[L.key]=z}return P},{});for(const P in this._tiles)P in T||(this.freeFBO(P),this._tiles[P].unloadVectorData(),delete this._tiles[P])}freeFBO(d){const m=this.proxyCachedFBO[d];if(m!==void 0){const w=Object.values(m);this.renderCachePool.push(...w),delete this.proxyCachedFBO[d]}}deallocRenderCache(){this.renderCache.forEach(d=>d.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Bf extends i.OverscaledTileID{constructor(d,m,w){super(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y),this.proxyTileKey=m,this.projMatrix=w}}class Yg extends i.Elevation{constructor(d,m){super(),this.painter=d,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[w,T,P]=function(U){const Z=new i.StructArrayLayout2i4,H=new i.StructArrayLayout3ui6,Q=131;Z.reserve(17161),H.reserve(33800);const se=i.EXTENT/128,de=i.EXTENT+se/2,fe=de+se;for(let me=-se;me<fe;me+=se)for(let te=-se;te<fe;te+=se){const ue=te<0||te>de||me<0||me>de?24575:0,be=i.clamp(Math.round(te),0,i.EXTENT),we=i.clamp(Math.round(me),0,i.EXTENT);Z.emplaceBack(be+ue,we)}const he=(me,te)=>{const ue=te*Q+me;H.emplaceBack(ue+1,ue,ue+Q),H.emplaceBack(ue+Q,ue+Q+1,ue+1)};for(let me=1;me<129;me++)for(let te=1;te<129;te++)he(te,me);return[0,129].forEach(me=>{for(let te=0;te<130;te++)he(te,me),he(me,te)}),[Z,H,32768]}(),L=d.context;this.gridBuffer=L.createVertexBuffer(w,i.posAttributes.members),this.gridIndexBuffer=L.createIndexBuffer(T),this.gridSegments=i.SegmentVector.simpleSegment(0,0,w.length,T.length),this.gridNoSkirtSegments=i.SegmentVector.simpleSegment(0,0,w.length,P),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Lf(m.map),this.orthoMatrix=i.create(),i.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.EXTENT,0,i.EXTENT,0,1);const z=L.gl;this._overlapStencilMode=new i.StencilMode({func:z.GEQUAL,mask:255},0,255,z.KEEP,z.KEEP,z.REPLACE),this._previousZoom=d.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=m,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Kg(m.map)}set style(d){d.on("data",this._onStyleDataEvent.bind(this)),d.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=d,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(d,m,w){if(d&&d.terrain){this._style!==d&&(this.style=d),this.enabled=!0;const T=d.terrain.properties;this.sourceCache=d.terrain.drapeRenderMode===0?this._mockSourceCache:d._getSourceCache(T.get("source")),this._exaggeration=T.get("exaggeration");const P=()=>{this.sourceCache.used&&i.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const L=this.getScaledDemTileSize();this.sourceCache.update(m,L,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,P(),this._initializing=!0),P(),m.updateElevation(!0,w),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(m),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(d){this._findCoveringTileCache[d]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const d=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||d.efficiency!==100&&i.warnOnce(`Terrain render cache efficiency is not optimal (${d.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${d.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(d){d.coord&&d.dataType==="source"?this._clearRenderCacheForTile(d.sourceCacheId,d.coord):d.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const d in this._style._sourceCaches)this._style._sourceCaches[d].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(d=>d.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const d=2*this.proxySourceCache.getSource().tileSize;return[d,d]}set useVertexMorphing(d){this._useVertexMorphing=d}updateTileBinding(d){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const m=this.proxySourceCache,w=this.painter.transform;this._initializing&&(this._initializing=w._centerAltitude===0&&this.getAtPointOrZero(i.MercatorCoordinate.fromLngLat(w.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const T=this.proxyCoords=m.getIds().map(U=>{const Z=m.getTileByID(U).tileID;return Z.projMatrix=w.calculateProjMatrix(Z.toUnwrapped()),Z});(function(U,Z){const H=Z.transform.pointCoordinate(Z.transform.getCameraPoint()),Q=new i.Point(H.x,H.y);U.sort((se,de)=>{if(de.overscaledZ-se.overscaledZ)return de.overscaledZ-se.overscaledZ;const fe=new i.Point(se.canonical.x+(1<<se.canonical.z)*se.wrap,se.canonical.y),he=new i.Point(de.canonical.x+(1<<de.canonical.z)*de.wrap,de.canonical.y),me=Q.mult(1<<se.canonical.z);return me.x-=.5,me.y-=.5,me.distSqr(fe)-me.distSqr(he)})})(T,this.painter),this._previousZoom=w.zoom;const P=this.proxyToSource||{};this.proxyToSource={},T.forEach(U=>{this.proxyToSource[U.key]={}}),this.terrainTileForTile={};const L=this._style._sourceCaches;for(const U in L){const Z=L[U];if(!Z.used||(Z!==this.sourceCache&&this.resetTileLookupCache(Z.id),this._setupProxiedCoordsForOrtho(Z,d[U],P),Z.usedForTerrain))continue;const H=d[U];Z.getSource().reparseOverscaled&&this._assignTerrainTiles(H)}this.proxiedCoords[m.id]=T.map(U=>new Bf(U,U.key,this.orthoMatrix)),this._assignTerrainTiles(T),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(P),this.renderingToTexture=!1,this._updateTimestamp=i.exported.now();const z={};this._visibleDemTiles=[];for(const U of this.proxyCoords){const Z=this.terrainTileForTile[U.key];if(!Z)continue;const H=Z.tileID.key;H in z||(this._visibleDemTiles.push(Z),z[H]=H)}}_assignTerrainTiles(d){this._initializing||d.forEach(m=>{if(this.terrainTileForTile[m.key])return;const w=this._findTileCoveringTileID(m,this.sourceCache);w&&(this.terrainTileForTile[m.key]=w)})}_prepareDEMTextures(){const d=this.painter.context,m=d.gl;for(const w in this.terrainTileForTile){const T=this.terrainTileForTile[w],P=T.dem;!P||T.demTexture&&!T.needsDEMTextureUpload||(d.activeTexture.set(m.TEXTURE1),Hg(this.painter,T,P))}}_prepareDemTileUniforms(d,m,w,T){if(!m||m.demTexture==null)return!1;const P=d.tileID.canonical,L=Math.pow(2,m.tileID.canonical.z-P.z),z=T||"";return w[`u_dem_tl${z}`]=[P.x*L%1,P.y*L%1],w[`u_dem_scale${z}`]=L,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const d=this.painter.context,m=d.gl;if(!this._emptyDepthBufferTexture){const w=new i.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new i.Texture(d,w,m.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let d=0;const m=this._visibleDemTiles.reduce((w,T)=>{if(!T.dem)return w;const P=T.dem.tree.minimums[0];return P>0&&d++,w+P},0);return d?m/d:0}_updateEmptyDEMTexture(){const d=this.painter.context,m=d.gl;d.activeTexture.set(m.TEXTURE2);const w=this._getLoadedAreaMinimum(),T=new i.RGBAImage({width:1,height:1},new Uint8Array(i.DEMData.pack(w,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let P=this._emptyDEMTexture;return P?P.update(T,{premultiply:!1}):P=this._emptyDEMTexture=new i.Texture(d,T,m.RGBA,{premultiply:!1}),P}setupElevationDraw(d,m,w){const T=this.painter.context,P=T.gl,L=(z=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:i.DEMData.getUnpackVector(z),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var z;L.u_dem_size=this.sourceCache.getSource().tileSize,L.u_exaggeration=this.exaggeration();let U=null,Z=null,H=1;if(w&&w.morphing&&this._useVertexMorphing){const Q=w.morphing.srcDemTile,se=w.morphing.dstDemTile;H=w.morphing.phase,Q&&se&&(this._prepareDemTileUniforms(d,Q,L,"_prev")&&(Z=Q),this._prepareDemTileUniforms(d,se,L)&&(U=se))}if(Z&&U?(T.activeTexture.set(P.TEXTURE2),U.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE,P.NEAREST),T.activeTexture.set(P.TEXTURE4),Z.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE,P.NEAREST),L.u_dem_lerp=H):(U=this.terrainTileForTile[d.tileID.key],T.activeTexture.set(P.TEXTURE2),(this._prepareDemTileUniforms(d,U,L)?U.demTexture:this.emptyDEMTexture).bind(P.NEAREST,P.CLAMP_TO_EDGE)),T.activeTexture.set(P.TEXTURE3),w&&w.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),this._depthFBO&&(L.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),L.u_depth_size_inv=[1,1]),w&&w.useMeterToDem&&U){const Q=(1<<U.tileID.canonical.z)*i.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;L.u_meter_to_dem=Q}if(w&&w.labelPlaneMatrixInv&&(L.u_label_plane_matrix_inv=w.labelPlaneMatrixInv),m.setTerrainUniformValues(T,L),this.painter.transform.projection.name==="globe"){const Q=this.globeUniformValues(this.painter.transform,d.tileID.canonical,w&&w.useDenormalizedUpVectorScale);m.setGlobeUniformValues(T,Q)}}globeUniformValues(d,m,w){const T=d.projection;return{u_tile_tl_up:T.upVector(m,0,0),u_tile_tr_up:T.upVector(m,i.EXTENT,0),u_tile_br_up:T.upVector(m,i.EXTENT,i.EXTENT),u_tile_bl_up:T.upVector(m,0,i.EXTENT),u_tile_up_scale:w?i.globeMetersToEcef(1):T.upVectorScale(m,d.center.lat,d.worldSize).metersToTile}}renderToBackBuffer(d){const m=this.painter,w=this.painter.context;d.length!==0&&(w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height]),m.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(T,P,L,z,U){if(T.transform.projection.name==="globe")(function(Z,H,Q,se,de){const fe=Z.context,he=fe.gl;let me,te;const ue=Z.options.showTerrainWireframe?2:0,be=Z.transform,we=i.globeUseCustomAntiAliasing(Z,fe,be),Oe=(xt,Ye)=>{if(te===xt)return;const ct=[Gl[xt],"PROJECTION_GLOBE_VIEW"];we&&ct.push("CUSTOM_ANTIALIASING"),Ye&&ct.push(Gl[ue]),me=Z.useProgram("globeRaster",null,ct),te=xt},Le=Z.colorModeForRenderPass(),De=new i.DepthMode(he.LEQUAL,i.DepthMode.ReadWrite,Z.depthRangeFor3D);ys.update(de);const qe=i.calculateGlobeMercatorMatrix(be),Ue=[i.mercatorXfromLng(be.center.lng),i.mercatorYfromLat(be.center.lat)],Je=ue?[!1,!0]:[!1],bt=Z.globeSharedBuffers,Ze=[be.width*i.exported.devicePixelRatio,be.height*i.exported.devicePixelRatio],ut=Float32Array.from(be.globeMatrix),et={useDenormalizedUpVectorScale:!0};if(Je.forEach(xt=>{const Ye=Z.transform,ct=Rf(Ye.zoom)*H.exaggeration();te=-1;const wt=xt?he.LINES:he.TRIANGLES;for(const mt of se){const St=Q.getTile(mt),Kt=i.StencilMode.disabled,sr=H.prevTerrainTileForTile[mt.key],Ut=H.terrainTileForTile[mt.key];iu(sr,Ut)&&ys.newMorphing(mt.key,sr,Ut,de,250),fe.activeTexture.set(he.TEXTURE0),St.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);const ir=ys.getMorphValuesForProxy(mt.key),Tr=ir?1:0;ir&&i.extend$1(et,{morphing:{srcDemTile:ir.from,dstDemTile:ir.to,phase:i.easeCubicInOut(ir.phase)}});const wr=i.tileCornersToBounds(mt.canonical),Zt=i.getLatitudinalLod(wr.getCenter().lat),Hr=i.getGridMatrix(mt.canonical,wr,Zt,Ye.worldSize/Ye._pixelsPerMercatorPixel),Jr=i.globeNormalizeECEF(i.globeTileBounds(mt.canonical)),Qr=Df(Ye.projMatrix,ut,qe,Jr,i.globeToMercatorTransition(Ye.zoom),Ue,Ye.frustumCorners.TL,Ye.frustumCorners.TR,Ye.frustumCorners.BR,Ye.frustumCorners.BL,Ye.globeCenterInViewSpace,Ye.globeRadius,Ze,ct,Hr);if(Oe(Tr,xt),H.setupElevationDraw(St,me,et),Z.prepareDrawProgram(fe,me,mt.toUnwrapped()),bt){const[en,Vi,bi]=xt?bt.getWirefameBuffers(Z.context,Zt):bt.getGridBuffers(Zt,ct!==0);me.draw(fe,wt,De,Kt,Le,i.CullFaceMode.backCCW,Qr,"globe_raster",en,Vi,bi)}}}),bt){const xt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];we&&xt.push("CUSTOM_ANTIALIASING"),me=Z.useProgram("globeRaster",null,xt);for(const Ye of se){const{x:ct,y:wt,z:mt}=Ye.canonical,St=wt===0,Kt=wt===(1<<mt)-1,[sr,Ut,ir,Tr]=bt.getPoleBuffers(mt);if(Tr&&(St||Kt)){const wr=Q.getTile(Ye);fe.activeTexture.set(he.TEXTURE0),wr.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);let Zt=i.globePoleMatrixForTile(mt,ct,be);const Hr=i.globeNormalizeECEF(i.globeTileBounds(Ye.canonical)),Jr=(Qr,en)=>Qr.draw(fe,he.TRIANGLES,De,i.StencilMode.disabled,Le,i.CullFaceMode.disabled,Df(be.projMatrix,Zt,Zt,Hr,0,Ue,be.frustumCorners.TL,be.frustumCorners.TR,be.frustumCorners.BR,be.frustumCorners.BL,be.globeCenterInViewSpace,be.globeRadius,Ze,0),"globe_pole_raster",en,ir,Tr);H.setupElevationDraw(wr,me,et),Z.prepareDrawProgram(fe,me,Ye.toUnwrapped()),St&&Jr(me,sr),Kt&&(Zt=i.scale(i.create(),Zt,[1,-1,1]),Jr(me,Ut))}}}})(T,P,L,z,U);else{const Z=T.context,H=Z.gl;let Q,se;const de=T.options.showTerrainWireframe?2:0,fe=(be,we)=>{if(se===be)return;const Oe=[Gl[be]];we&&Oe.push(Gl[de]),Q=T.useProgram("terrainRaster",null,Oe),se=be},he=T.colorModeForRenderPass(),me=new i.DepthMode(H.LEQUAL,i.DepthMode.ReadWrite,T.depthRangeFor3D);ys.update(U);const te=T.transform,ue=Rf(te.zoom)*P.exaggeration();(de?[!1,!0]:[!1]).forEach(be=>{se=-1;const we=be?H.LINES:H.TRIANGLES,[Oe,Le]=be?P.getWirefameBuffer():[P.gridIndexBuffer,P.gridSegments];for(const De of z){const qe=L.getTile(De),Ue=i.StencilMode.disabled,Je=P.prevTerrainTileForTile[De.key],bt=P.terrainTileForTile[De.key];iu(Je,bt)&&ys.newMorphing(De.key,Je,bt,U,250),Z.activeTexture.set(H.TEXTURE0),qe.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST);const Ze=ys.getMorphValuesForProxy(De.key),ut=Ze?1:0;let et;Ze&&(et={morphing:{srcDemTile:Ze.from,dstDemTile:Ze.to,phase:i.easeCubicInOut(Ze.phase)}});const xt=nu(De.projMatrix,h0(De.canonical,te.renderWorldCopies)?ue/10:ue);fe(ut,be),P.setupElevationDraw(qe,Q,et),T.prepareDrawProgram(Z,Q,De.toUnwrapped()),Q.draw(Z,we,me,Ue,he,i.CullFaceMode.backCCW,xt,"terrain_raster",P.gridBuffer,Oe,Le)}})}}(m,this,this.proxySourceCache,d,this._updateTimestamp),this.renderingToTexture=!0,m.gpuTimingDeferredRenderEnd(),d.splice(0,d.length))}renderBatch(d){if(this._drapedRenderBatches.length===0)return d+1;this.renderingToTexture=!0;const m=this.painter,w=this.painter.context,T=this.proxySourceCache,P=this.proxiedCoords[T.id],L=this._drapedRenderBatches.shift(),z=[],U=m.style.order;let Z=0;for(const H of P){const Q=T.getTileByID(H.proxyTileKey),se=T.proxyCachedFBO[H.key]?T.proxyCachedFBO[H.key][d]:void 0,de=se!==void 0?T.renderCache[se]:this.pool[Z++],fe=se!==void 0;if(Q.texture=de.tex,fe&&!de.dirty){z.push(Q.tileID);continue}let he;w.bindFramebuffer.set(de.fb.framebuffer),this.renderedToTile=!1,de.dirty&&(w.clear({color:i.Color.transparent,stencil:0}),de.dirty=!1);for(let me=L.start;me<=L.end;++me){const te=m.style._layers[U[me]];if(te.isHidden(m.transform.zoom))continue;const ue=m.style._getLayerSourceCache(te),be=ue?this.proxyToSource[H.key][ue.id]:[H];if(!be)continue;const we=be;w.viewport.set([0,0,de.fb.width,de.fb.height]),he!==(ue?ue.id:null)&&(this._setupStencil(de,be,te,ue),he=ue?ue.id:null),m.renderLayer(m,ue,te,we)}this.renderedToTile?(de.dirty=!0,z.push(Q.tileID)):fe||--Z,Z===5&&(Z=0,this.renderToBackBuffer(z))}return this.renderToBackBuffer(z),this.renderingToTexture=!1,w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height]),L.end+1}postRender(){}renderCacheEfficiency(d){const m=d.order.length;if(m===0)return{efficiency:100};let w,T=0,P=0,L=!1;for(let z=0;z<m;++z){const U=d._layers[d.order[z]];this._style.isLayerDraped(U)?(L&&++T,++P):L||(L=!0,w=U.id)}return P===0?{efficiency:100}:{efficiency:100*(1-T/P),firstUndrapedLayer:w}}getMinElevationBelowMSL(){let d=0;return this._visibleDemTiles.filter(m=>m.dem).forEach(m=>{d=Math.min(d,m.dem.tree.minimums[0])}),d===0?d:(d-30)*this._exaggeration}raycast(d,m,w){if(!this._visibleDemTiles)return null;const T=this._visibleDemTiles.filter(P=>P.dem).map(P=>{const L=P.tileID,z=1<<L.overscaledZ,{x:U,y:Z}=L.canonical,H=U/z,Q=(U+1)/z,se=Z/z,de=(Z+1)/z;return{minx:H,miny:se,maxx:Q,maxy:de,t:P.dem.tree.raycastRoot(H,se,Q,de,d,m,w),tile:P}});T.sort((P,L)=>(P.t!==null?P.t:Number.MAX_VALUE)-(L.t!==null?L.t:Number.MAX_VALUE));for(const P of T){if(P.t==null)return null;const L=P.tile.dem.tree.raycast(P.minx,P.miny,P.maxx,P.maxy,d,m,w);if(L!=null)return L}return null}_createFBO(){const d=this.painter.context,m=d.gl,w=this.drapeBufferSize;d.activeTexture.set(m.TEXTURE0);const T=new i.Texture(d,{width:w[0],height:w[1],data:null},m.RGBA);T.bind(m.LINEAR,m.CLAMP_TO_EDGE);const P=d.createFramebuffer(w[0],w[1],!1);return P.colorAttachment.set(T.texture),P.depthAttachment=new ze(d,P.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=d.createRenderbuffer(d.gl.DEPTH_STENCIL,w[0],w[1]),this._stencilRef=0,P.depthAttachment.set(this._sharedDepthStencil),d.clear({stencil:0})):P.depthAttachment.set(this._sharedDepthStencil),d.extTextureFilterAnisotropic&&!d.extTextureFilterAnisotropicForceOff&&m.texParameterf(m.TEXTURE_2D,d.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,d.extTextureFilterAnisotropicMax),{fb:P,tex:T,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const d in this._style._sourceCaches)if(this._style._sourceCaches[d].hasTransition())return!0;return this._style.order.some(d=>{const m=this._style._layers[d],w=m.isHidden(this.painter.transform.zoom);return m.type==="custom"?!w&&m.shouldRedrape():!w&&m.hasTransition()})}_clearLineLayersFromRenderCache(){let d=!1;for(const w of this._style._getSources())if(w instanceof Mt){d=!0;break}if(!d)return;const m={};for(let w=0;w<this._style.order.length;++w){const T=this._style._layers[this._style.order[w]],P=this._style._getLayerSourceCache(T);if(P&&!m[P.id]&&!T.isHidden(this.painter.transform.zoom)&&T.type==="line"&&T.widthExpression()instanceof i.ZoomDependentExpression){m[P.id]=!0;for(const L of this.proxyCoords){const z=this.proxyToSource[L.key][P.id];if(z)for(const U of z)this._clearRenderCacheForTile(P.id,U)}}}}_clearRasterLayersFromRenderCache(){let d=!1;for(const w in this._style._sourceCaches)if(this._style._sourceCaches[w]._source instanceof Tt){d=!0;break}if(!d)return;const m={};for(let w=0;w<this._style.order.length;++w){const T=this._style._layers[this._style.order[w]],P=this._style._getLayerSourceCache(T);if(!P||m[P.id]||T.isHidden(this.painter.transform.zoom)||T.type!=="raster")continue;const L=T.paint.get("raster-fade-duration");for(const z of this.proxyCoords){const U=this.proxyToSource[z.key][P.id];if(U)for(const Z of U){const H=Zg(P.getTile(Z),P.findLoadedParent(Z,0),P,this.painter.transform,L);(H.opacity!==1||H.mix!==0)&&this._clearRenderCacheForTile(P.id,Z)}}}}_setupDrapedRenderBatches(){const d=this._style.order,m=d.length;if(m===0)return;const w=[];let T,P=0,L=this._style._layers[d[P]];for(;!this._style.isLayerDraped(L)&&L.isHidden(this.painter.transform.zoom)&&++P<m;)L=this._style._layers[d[P]];for(;P<m;++P){const z=this._style._layers[d[P]];z.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(z)?T===void 0&&(T=P):T!==void 0&&(w.push({start:T,end:P-1}),T=void 0))}T!==void 0&&w.push({start:T,end:P-1}),this._drapedRenderBatches=w}_setupRenderCache(d){const m=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,m.renderCache.length>m.renderCachePool.length){const L=Object.values(m.proxyCachedFBO);m.proxyCachedFBO={};for(let z=0;z<L.length;++z){const U=Object.values(L[z]);m.renderCachePool.push(...U)}}return}this._clearRasterLayersFromRenderCache();const w=this.proxyCoords,T=this._tilesDirty;for(let L=w.length-1;L>=0;L--){const z=w[L];if(m.getTileByID(z.key),m.proxyCachedFBO[z.key]!==void 0){const U=d[z.key],Z=this.proxyToSource[z.key];let H=0;for(const Q in Z){const se=Z[Q],de=U[Q];if(!de||de.length!==se.length||se.some((fe,he)=>fe!==de[he]||T[Q]&&T[Q].hasOwnProperty(fe.key))){H=-1;break}++H}for(const Q in m.proxyCachedFBO[z.key])m.renderCache[m.proxyCachedFBO[z.key][Q]].dirty=H<0||H!==Object.values(U).length}}const P=[...this._drapedRenderBatches];P.sort((L,z)=>z.end-z.start-(L.end-L.start));for(const L of P)for(const z of w){if(m.proxyCachedFBO[z.key])continue;let U=m.renderCachePool.pop();U===void 0&&m.renderCache.length<50&&(U=m.renderCache.length,m.renderCache.push(this._createFBO())),U!==void 0&&(m.proxyCachedFBO[z.key]={},m.proxyCachedFBO[z.key][L.start]=U,m.renderCache[U].dirty=!0)}this._tilesDirty={}}_setupStencil(d,m,w,T){if(!T||!this._sourceTilesOverlap[T.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const P=this.painter.context,L=P.gl;if(m.length<=1)return void(this._overlapStencilType=!1);let z;if(w.isTileClipped())z=m.length,this._overlapStencilMode.test={func:L.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(m[0].overscaledZ>m[m.length-1].overscaledZ))return void(this._overlapStencilType=!1);z=1,this._overlapStencilMode.test={func:L.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+z>255&&(P.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=z,this._overlapStencilMode.ref=this._stencilRef,w.isTileClipped()&&this._renderTileClippingMasks(m,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(d){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[d.key]),this._overlapStencilMode):i.StencilMode.disabled}_renderTileClippingMasks(d,m){const w=this.painter,T=this.painter.context,P=T.gl;w._tileClippingMaskIDs={},T.setColorMode(i.ColorMode.disabled),T.setDepthMode(i.DepthMode.disabled);const L=w.useProgram("clippingMask");for(const z of d){const U=w._tileClippingMaskIDs[z.key]=--m;L.draw(T,P.TRIANGLES,i.DepthMode.disabled,new i.StencilMode({func:P.ALWAYS,mask:0},U,255,P.KEEP,P.KEEP,P.REPLACE),i.ColorMode.disabled,i.CullFaceMode.disabled,Gd(z.projMatrix),"$clipping",w.tileExtentBuffer,w.quadTriangleIndexBuffer,w.tileExtentSegments)}}pointCoordinate(d){const m=this.painter.transform;if(d.x<0||d.x>m.width||d.y<0||d.y>m.height)return null;const w=[d.x,d.y,1,1];i.transformMat4$1(w,w,m.pixelMatrixInverse),i.scale$1(w,w,1/w[3]),w[0]/=m.worldSize,w[1]/=m.worldSize;const T=m._camera.position,P=i.mercatorZfromAltitude(1,m.center.lat),L=[T[0],T[1],T[2]/P,0],z=i.subtract([],w.slice(0,3),L);i.normalize(z,z);const U=this.raycast(L,z,this._exaggeration);return U!==null&&U?(i.scaleAndAdd(L,L,z,U),L[3]=L[2],L[2]*=P,L):null}drawDepth(){const d=this.painter,m=d.context,w=this.proxySourceCache,T=Math.ceil(d.width),P=Math.ceil(d.height);if(!this._depthFBO||this._depthFBO.width===T&&this._depthFBO.height===P||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const L=m.gl,z=m.createFramebuffer(T,P,!0);m.activeTexture.set(L.TEXTURE0);const U=new i.Texture(m,{width:T,height:P,data:null},L.RGBA);U.bind(L.NEAREST,L.CLAMP_TO_EDGE),z.colorAttachment.set(U.texture);const Z=m.createRenderbuffer(m.gl.DEPTH_COMPONENT16,T,P);z.depthAttachment.set(Z),this._depthFBO=z,this._depthTexture=U}m.bindFramebuffer.set(this._depthFBO.framebuffer),m.viewport.set([0,0,T,P]),function(L,z,U,Z){if(L.transform.projection.name==="globe")return;const H=L.context,Q=H.gl;H.clear({depth:1});const se=L.useProgram("terrainDepth"),de=new i.DepthMode(Q.LESS,i.DepthMode.ReadWrite,L.depthRangeFor3D);for(const fe of Z){const he=U.getTile(fe),me=nu(fe.projMatrix,0);z.setupElevationDraw(he,se),se.draw(H,Q.TRIANGLES,de,i.StencilMode.disabled,i.ColorMode.unblended,i.CullFaceMode.backCCW,me,"terrain_depth",z.gridBuffer,z.gridIndexBuffer,z.gridNoSkirtSegments)}}(d,this,w,this.proxyCoords)}_setupProxiedCoordsForOrtho(d,m,w){if(d.getSource()instanceof br)return this._setupProxiedCoordsForImageSource(d,m,w);this._findCoveringTileCache[d.id]=this._findCoveringTileCache[d.id]||{};const T=this.proxiedCoords[d.id]=[],P=this.proxyCoords;for(let z=0;z<P.length;z++){const U=P[z],Z=this._findTileCoveringTileID(U,d);if(Z){const H=this._createProxiedId(U,Z,w[U.key]&&w[U.key][d.id]);T.push(H),this.proxyToSource[U.key][d.id]=[H]}}let L=!1;for(let z=0;z<m.length;z++){const U=d.getTile(m[z]);if(!U||!U.hasData())continue;const Z=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if(Z&&Z.tileID.canonical.z!==U.tileID.canonical.z){const H=this.proxyToSource[Z.tileID.key][d.id],Q=this._createProxiedId(Z.tileID,U,w[Z.tileID.key]&&w[Z.tileID.key][d.id]);H?H.splice(H.length-1,0,Q):this.proxyToSource[Z.tileID.key][d.id]=[Q],T.push(Q),L=!0}}this._sourceTilesOverlap[d.id]=L}_setupProxiedCoordsForImageSource(d,m,w){if(!d.getSource().loaded())return;const T=this.proxiedCoords[d.id]=[],P=this.proxyCoords,L=d.getSource(),z=new i.Point(L.tileID.x,L.tileID.y)._div(1<<L.tileID.z),U=L.coordinates.map(i.MercatorCoordinate.fromLngLat).reduce((H,Q)=>(H.min.x=Math.min(H.min.x,Q.x-z.x),H.min.y=Math.min(H.min.y,Q.y-z.y),H.max.x=Math.max(H.max.x,Q.x-z.x),H.max.y=Math.max(H.max.y,Q.y-z.y),H),{min:new i.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Z=(H,Q)=>{const se=H.wrap+H.canonical.x/(1<<H.canonical.z),de=H.canonical.y/(1<<H.canonical.z),fe=i.EXTENT/(1<<H.canonical.z),he=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),me=Q.canonical.y/(1<<Q.canonical.z);return se+fe<he+U.min.x||se>he+U.max.x||de+fe<me+U.min.y||de>me+U.max.y};for(let H=0;H<P.length;H++){const Q=P[H];for(let se=0;se<m.length;se++){const de=d.getTile(m[se]);if(!de||!de.hasData()||Z(Q,de.tileID))continue;const fe=this._createProxiedId(Q,de,w[Q.key]&&w[Q.key][d.id]),he=this.proxyToSource[Q.key][d.id];he?he.push(fe):this.proxyToSource[Q.key][d.id]=[fe],T.push(fe)}}}_createProxiedId(d,m,w){let T=this.orthoMatrix;if(w){const P=w.find(L=>L.key===m.tileID.key);if(P)return P}if(m.tileID.key!==d.key){const P=d.canonical.z-m.tileID.canonical.z;let L,z,U;T=i.create();const Z=m.tileID.wrap-d.wrap<<d.overscaledZ;P>0?(L=i.EXTENT>>P,z=L*((m.tileID.canonical.x<<P)-d.canonical.x+Z),U=L*((m.tileID.canonical.y<<P)-d.canonical.y)):(L=i.EXTENT<<-P,z=i.EXTENT*(m.tileID.canonical.x-(d.canonical.x+Z<<-P)),U=i.EXTENT*(m.tileID.canonical.y-(d.canonical.y<<-P))),i.ortho(T,0,L,0,L,0,1),i.translate(T,T,[z,U,0])}return new Bf(m.tileID,d.key,T)}_findTileCoveringTileID(d,m){let w=m.getTile(d);if(w&&w.hasData())return w;const T=this._findCoveringTileCache[m.id],P=T[d.key];if(w=P?m.getTileByID(P):null,w&&w.hasData()||P===null)return w;let L=w?w.tileID:d,z=L.overscaledZ;const U=m.getSource().minzoom,Z=[];if(!P){const Q=m.getSource().maxzoom;if(d.canonical.z>=Q){const se=d.canonical.z-Q;m.getSource().reparseOverscaled?(z=Math.max(d.canonical.z+2,m.transform.tileZoom),L=new i.OverscaledTileID(z,d.wrap,Q,d.canonical.x>>se,d.canonical.y>>se)):se!==0&&(z=Q,L=new i.OverscaledTileID(z,d.wrap,Q,d.canonical.x>>se,d.canonical.y>>se))}L.key!==d.key&&(Z.push(L.key),w=m.getTile(L))}const H=Q=>{Z.forEach(se=>{T[se]=Q}),Z.length=0};for(z-=1;z>=U&&(!w||!w.hasData());z--){w&&H(w.tileID.key);const Q=L.calculateScaledKey(z);if(w=m.getTileByID(Q),w&&w.hasData())break;const se=T[Q];if(se===null)break;se===void 0?Z.push(Q):w=m.getTileByID(se)}return H(w?w.tileID.key:null),w&&w.hasData()?w:null}findDEMTileFor(d){return this.enabled?this._findTileCoveringTileID(d,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(d,m){let w=this._tilesDirty[d];w||(w=this._tilesDirty[d]={}),w[m.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const d=function(m){let w=0;const T=new i.StructArrayLayout2ui4,P=131;for(let L=1;L<129;L++){for(let z=1;z<129;z++)w=L*P+z,T.emplaceBack(w,w+1),T.emplaceBack(w,w+P),T.emplaceBack(w+1,w+P),L===128&&T.emplaceBack(w+P,w+P+1);T.emplaceBack(w+1,w+1+P)}return T}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(d),this.wireframeSegments=i.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,d.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class kr{static cacheKey(d,m,w,T){let P=`${m}${T?T.cacheKey:""}`;for(const L of w)d.usedDefines.includes(L)&&(P+=`/${L}`);return P}constructor(d,m,w,T,P,L){const z=d.gl;this.program=z.createProgram();const U=function(te){const ue=[];for(let be=0;be<te.length;be++){if(te[be]===null)continue;const we=te[be].split(" ");ue.push(we.pop())}return ue}(w.staticAttributes),Z=T?T.getBinderAttributes():[],H=U.concat(Z);let Q=T?T.defines():[];Q=Q.concat(L.map(te=>`#define ${te}`));const se=d.isWebGL2?`#version 300 es
`:"",de=se+Q.concat(d.extStandardDerivatives&&se.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(qg):qg,qg,Of,c0.fragmentSource,tu.fragmentSource,w.fragmentSource).join(`
`),fe=se+Q.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Of,c0.vertexSource,tu.vertexSource,If.vertexSource,w.vertexSource).join(`
`),he=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);z.shaderSource(he,de),z.compileShader(he),z.attachShader(this.program,he);const me=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())this.failedToCreate=!0;else{z.shaderSource(me,fe),z.compileShader(me),z.attachShader(this.program,me),this.attributes={},this.numAttributes=H.length;for(let te=0;te<this.numAttributes;te++)H[te]&&(z.bindAttribLocation(this.program,te,H[te]),this.attributes[H[te]]=te);z.linkProgram(this.program),z.deleteShader(me),z.deleteShader(he),this.fixedUniforms=P(d),this.binderUniforms=T?T.getUniforms(d):[],L.includes("TERRAIN")&&(this.terrainUniforms=(te=>({u_dem:new i.Uniform1i(te),u_dem_prev:new i.Uniform1i(te),u_dem_unpack:new i.Uniform4f(te),u_dem_tl:new i.Uniform2f(te),u_dem_scale:new i.Uniform1f(te),u_dem_tl_prev:new i.Uniform2f(te),u_dem_scale_prev:new i.Uniform1f(te),u_dem_size:new i.Uniform1f(te),u_dem_lerp:new i.Uniform1f(te),u_exaggeration:new i.Uniform1f(te),u_depth:new i.Uniform1i(te),u_depth_size_inv:new i.Uniform2f(te),u_meter_to_dem:new i.Uniform1f(te),u_label_plane_matrix_inv:new i.UniformMatrix4f(te)}))(d)),L.includes("GLOBE")&&(this.globeUniforms=(te=>({u_tile_tl_up:new i.Uniform3f(te),u_tile_tr_up:new i.Uniform3f(te),u_tile_br_up:new i.Uniform3f(te),u_tile_bl_up:new i.Uniform3f(te),u_tile_up_scale:new i.Uniform1f(te)}))(d)),L.includes("FOG")&&(this.fogUniforms=(te=>({u_fog_matrix:new i.UniformMatrix4f(te),u_fog_range:new i.Uniform2f(te),u_fog_color:new i.Uniform4f(te),u_fog_horizon_blend:new i.Uniform1f(te),u_fog_temporal_offset:new i.Uniform1f(te),u_frustum_tl:new i.Uniform3f(te),u_frustum_tr:new i.Uniform3f(te),u_frustum_br:new i.Uniform3f(te),u_frustum_bl:new i.Uniform3f(te),u_globe_pos:new i.Uniform3f(te),u_globe_radius:new i.Uniform1f(te),u_globe_transition:new i.Uniform1f(te),u_is_globe:new i.Uniform1i(te),u_viewport:new i.Uniform2f(te)}))(d))}}setTerrainUniformValues(d,m){if(!this.terrainUniforms)return;const w=this.terrainUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const T in m)w[T]&&w[T].set(this.program,T,m[T])}}setGlobeUniformValues(d,m){if(!this.globeUniforms)return;const w=this.globeUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const T in m)w[T]&&w[T].set(this.program,T,m[T])}}setFogUniformValues(d,m){if(!this.fogUniforms)return;const w=this.fogUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const T in m)w[T].set(this.program,T,m[T])}}draw(d,m,w,T,P,L,z,U,Z,H,Q,se,de,fe,he){const me=d.gl;if(this.failedToCreate)return;d.program.set(this.program),d.setDepthMode(w),d.setStencilMode(T),d.setColorMode(P),d.setCullFace(L);for(const ue of Object.keys(this.fixedUniforms))this.fixedUniforms[ue].set(this.program,ue,z[ue]);fe&&fe.setUniforms(this.program,d,this.binderUniforms,se,{zoom:de});const te={[me.LINES]:2,[me.TRIANGLES]:3,[me.LINE_STRIP]:1}[m];for(const ue of Q.get()){const be=ue.vaos||(ue.vaos={});(be[U]||(be[U]=new FE)).bind(d,this,Z,fe?fe.getPaintVertexBuffers():[],H,ue.vertexOffset,he||[]),me.drawElements(m,ue.primitiveLength*te,me.UNSIGNED_SHORT,ue.primitiveOffset*te*2)}}}function Hd(v,d){const m=Math.pow(2,d.tileID.overscaledZ),w=d.tileSize*Math.pow(2,v.transform.tileZoom)/m,T=w*(d.tileID.canonical.x+d.tileID.wrap*m),P=w*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_tile_units_to_pixels:1/Be(d,1,v.transform.tileZoom),u_pixel_coord_upper:[T>>16,P>>16],u_pixel_coord_lower:[65535&T,65535&P]}}const f0=i.create(),Jg=(v,d,m,w,T,P,L,z,U,Z,H)=>{const Q=d.style.light,se=Q.properties.get("position"),de=[se.x,se.y,se.z],fe=i.create$1();Q.properties.get("anchor")==="viewport"&&(i.fromRotation(fe,-d.transform.angle),i.transformMat3(de,de,fe));const he=Q.properties.get("color"),me=d.transform,te={u_matrix:v,u_lightpos:de,u_lightintensity:Q.properties.get("intensity"),u_lightcolor:[he.r,he.g,he.b],u_vertical_gradient:+m,u_opacity:w,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:f0,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:T,u_edge_radius:P};return me.projection.name==="globe"&&(te.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],te.u_zoom_transition=U,te.u_inv_rot_matrix=H,te.u_merc_center=Z,te.u_up_dir=me.projection.upVector(new i.CanonicalTileID(0,0,0),Z[0]*i.EXTENT,Z[1]*i.EXTENT),te.u_height_lift=z),te},p0=(v,d,m,w,T,P,L,z,U,Z,H,Q)=>{const se=Jg(v,d,m,w,T,P,L,U,Z,H,Q),de={u_height_factor:-Math.pow(2,L.overscaledZ)/z.tileSize/8};return i.extend(se,Hd(d,z),de)},Hl=v=>({u_matrix:v}),Qg=(v,d,m)=>i.extend(Hl(v),Hd(d,m)),UE=(v,d)=>({u_matrix:v,u_world:d}),VE=(v,d,m,w)=>i.extend(Qg(v,d,m),{u_world:w}),qE=i.create(),ey=(v,d,m,w,T,P)=>{const L=v.transform,z=L.projection.name==="globe";let U;if(P.paint.get("circle-pitch-alignment")==="map")if(z){const H=i.globePixelsToTileUnits(L.zoom,d.canonical)*L._pixelsPerMercatorPixel;U=Float32Array.from([H,0,0,H])}else U=L.calculatePixelsToTileUnitsMatrix(m);else U=new Float32Array([L.pixelsToGLUnits[0],0,0,L.pixelsToGLUnits[1]]);const Z={u_camera_to_center_distance:L.cameraToCenterDistance,u_matrix:v.translatePosMatrix(d.projMatrix,m,P.paint.get("circle-translate"),P.paint.get("circle-translate-anchor")),u_device_pixel_ratio:i.exported.devicePixelRatio,u_extrude_scale:U,u_inv_rot_matrix:qE,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){Z.u_inv_rot_matrix=w,Z.u_merc_center=T,Z.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],Z.u_zoom_transition=i.globeToMercatorTransition(L.zoom);const H=T[0]*i.EXTENT,Q=T[1]*i.EXTENT;Z.u_up_dir=L.projection.upVector(new i.CanonicalTileID(0,0,0),H,Q)}return Z},ty=v=>{const d=[];return v.paint.get("circle-pitch-alignment")==="map"&&d.push("PITCH_WITH_MAP"),v.paint.get("circle-pitch-scale")==="map"&&d.push("SCALE_WITH_MAP"),d},ry=(v,d,m,w)=>{const T=i.EXTENT/m.tileSize;return{u_matrix:v,u_camera_to_center_distance:d.getCameraToCenterDistance(w),u_extrude_scale:[d.pixelsToGLUnits[0]/T,d.pixelsToGLUnits[1]/T]}},zf=(v,d,m=1)=>({u_matrix:v,u_color:d,u_overlay:0,u_overlay_scale:m}),m0=i.create(),g0=(v,d,m,w,T,P,L)=>{const z=v.transform,U=z.projection.name==="globe",Z=U?i.globePixelsToTileUnits(z.zoom,d.canonical)*z._pixelsPerMercatorPixel:Be(m,1,P),H={u_matrix:d.projMatrix,u_extrude_scale:Z,u_intensity:L,u_inv_rot_matrix:m0,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(U){H.u_inv_rot_matrix=w,H.u_merc_center=T,H.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],H.u_zoom_transition=i.globeToMercatorTransition(z.zoom);const Q=T[0]*i.EXTENT,se=T[1]*i.EXTENT;H.u_up_dir=z.projection.upVector(new i.CanonicalTileID(0,0,0),Q,se)}return H},WE=(v,d,m,w,T,P,L)=>{const z=v.transform,U=z.calculatePixelsToTileUnitsMatrix(d);return{u_matrix:ny(v,d,m,w),u_pixels_to_tile_units:U,u_device_pixel_ratio:P,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:T,u_texsize:Zd(m)?d.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:ou(d,v.transform),u_alpha_discard_threshold:0,u_trim_offset:L}},Xd=(v,d,m,w,T)=>{const P=v.transform;return{u_matrix:ny(v,d,m,w),u_texsize:d.imageAtlasTexture.size,u_pixels_to_tile_units:P.calculatePixelsToTileUnitsMatrix(d),u_device_pixel_ratio:T,u_image:0,u_tile_units_to_pixels:ou(d,P),u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ou(v,d){return 1/Be(v,1,d.tileZoom)}function ny(v,d,m,w){return v.translatePosMatrix(w||d.tileID.projMatrix,d,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}function Zd(v){const d=v.paint.get("line-dasharray").value;return d.value||d.kind!=="constant"}const iy=(v,d,m,w,T,P)=>{return{u_matrix:v,u_tl_parent:d,u_scale_parent:m,u_fade_t:w.mix,u_opacity:w.opacity*T.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:T.paint.get("raster-brightness-min"),u_brightness_high:T.paint.get("raster-brightness-max"),u_saturation_factor:(z=T.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(L=T.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:La(T.paint.get("raster-hue-rotate")),u_perspective_transform:P};var L,z};function La(v){v*=Math.PI/180;const d=Math.sin(v),m=Math.cos(v);return[(2*m+1)/3,(-Math.sqrt(3)*d-m+1)/3,(Math.sqrt(3)*d-m+1)/3]}const $f=i.create(),oy=(v,d,m,w,T,P,L,z,U,Z,H,Q,se,de,fe,he)=>{const me=T.transform,te={u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:d?d.uSizeT:0,u_size:d?d.uSize:0,u_camera_to_center_distance:me.cameraToCenterDistance,u_rotate_symbol:+m,u_aspect_ratio:me.width/me.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:L,u_coord_matrix:z,u_is_text:+U,u_pitch_with_map:+w,u_texsize:Z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:$f,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:$f,u_up_vector:[0,-1,0]};return he.name==="globe"&&(te.u_tile_id=[H.canonical.x,H.canonical.y,1<<H.canonical.z],te.u_zoom_transition=Q,te.u_inv_rot_matrix=de,te.u_merc_center=se,te.u_camera_forward=me._camera.forward(),te.u_ecef_origin=i.globeECEFOrigin(me.globeMatrix,H.toUnwrapped()),te.u_tile_matrix=Float32Array.from(me.globeMatrix),te.u_up_vector=fe),te},Ff=(v,d,m,w,T,P,L,z,U,Z,H,Q,se,de,fe,he,me)=>i.extend(oy(v,d,m,w,T,P,L,z,U,Z,Q,se,de,fe,he,me),{u_gamma_scale:w?T.transform.cameraToCenterDistance*Math.cos(T.terrain?0:T.transform._pitch):1,u_device_pixel_ratio:i.exported.devicePixelRatio,u_is_halo:+H}),y0=(v,d,m,w,T,P,L,z,U,Z,H,Q,se,de,fe,he)=>i.extend(Ff(v,d,m,w,T,P,L,z,!0,U,!0,H,Q,se,de,fe,he),{u_texsize_icon:Z,u_texture_icon:1}),ay=(v,d,m)=>({u_matrix:v,u_opacity:d,u_color:m}),GE=(v,d,m,w,T)=>i.extend(function(P,L,z){const U=L.imageManager.getPattern(P.toString()),{width:Z,height:H}=L.imageManager.getPixelSize(),Q=Math.pow(2,z.tileID.overscaledZ),se=z.tileSize*Math.pow(2,L.transform.tileZoom)/Q,de=se*(z.tileID.canonical.x+z.tileID.wrap*Q),fe=se*z.tileID.canonical.y;return{u_image:0,u_pattern_tl:U.tl,u_pattern_br:U.br,u_texsize:[Z,H],u_pattern_size:U.displaySize,u_tile_units_to_pixels:1/Be(z,1,L.transform.tileZoom),u_pixel_coord_upper:[de>>16,fe>>16],u_pixel_coord_lower:[65535&de,65535&fe]}}(w,m,T),{u_matrix:v,u_opacity:d}),sy={fillExtrusion:v=>({u_matrix:new i.UniformMatrix4f(v),u_lightpos:new i.Uniform3f(v),u_lightintensity:new i.Uniform1f(v),u_lightcolor:new i.Uniform3f(v),u_vertical_gradient:new i.Uniform1f(v),u_opacity:new i.Uniform1f(v),u_edge_radius:new i.Uniform1f(v),u_ao:new i.Uniform2f(v),u_tile_id:new i.Uniform3f(v),u_zoom_transition:new i.Uniform1f(v),u_inv_rot_matrix:new i.UniformMatrix4f(v),u_merc_center:new i.Uniform2f(v),u_up_dir:new i.Uniform3f(v),u_height_lift:new i.Uniform1f(v)}),fillExtrusionPattern:v=>({u_matrix:new i.UniformMatrix4f(v),u_lightpos:new i.Uniform3f(v),u_lightintensity:new i.Uniform1f(v),u_lightcolor:new i.Uniform3f(v),u_vertical_gradient:new i.Uniform1f(v),u_height_factor:new i.Uniform1f(v),u_edge_radius:new i.Uniform1f(v),u_ao:new i.Uniform2f(v),u_tile_id:new i.Uniform3f(v),u_zoom_transition:new i.Uniform1f(v),u_inv_rot_matrix:new i.UniformMatrix4f(v),u_merc_center:new i.Uniform2f(v),u_up_dir:new i.Uniform3f(v),u_height_lift:new i.Uniform1f(v),u_image:new i.Uniform1i(v),u_texsize:new i.Uniform2f(v),u_pixel_coord_upper:new i.Uniform2f(v),u_pixel_coord_lower:new i.Uniform2f(v),u_tile_units_to_pixels:new i.Uniform1f(v),u_opacity:new i.Uniform1f(v)}),fill:v=>({u_matrix:new i.UniformMatrix4f(v)}),fillPattern:v=>({u_matrix:new i.UniformMatrix4f(v),u_image:new i.Uniform1i(v),u_texsize:new i.Uniform2f(v),u_pixel_coord_upper:new i.Uniform2f(v),u_pixel_coord_lower:new i.Uniform2f(v),u_tile_units_to_pixels:new i.Uniform1f(v)}),fillOutline:v=>({u_matrix:new i.UniformMatrix4f(v),u_world:new i.Uniform2f(v)}),fillOutlinePattern:v=>({u_matrix:new i.UniformMatrix4f(v),u_world:new i.Uniform2f(v),u_image:new i.Uniform1i(v),u_texsize:new i.Uniform2f(v),u_pixel_coord_upper:new i.Uniform2f(v),u_pixel_coord_lower:new i.Uniform2f(v),u_tile_units_to_pixels:new i.Uniform1f(v)}),circle:v=>({u_camera_to_center_distance:new i.Uniform1f(v),u_extrude_scale:new i.UniformMatrix2f(v),u_device_pixel_ratio:new i.Uniform1f(v),u_matrix:new i.UniformMatrix4f(v),u_inv_rot_matrix:new i.UniformMatrix4f(v),u_merc_center:new i.Uniform2f(v),u_tile_id:new i.Uniform3f(v),u_zoom_transition:new i.Uniform1f(v),u_up_dir:new i.Uniform3f(v)}),collisionBox:v=>({u_matrix:new i.UniformMatrix4f(v),u_camera_to_center_distance:new i.Uniform1f(v),u_extrude_scale:new i.Uniform2f(v)}),collisionCircle:v=>({u_matrix:new i.UniformMatrix4f(v),u_inv_matrix:new i.UniformMatrix4f(v),u_camera_to_center_distance:new i.Uniform1f(v),u_viewport_size:new i.Uniform2f(v)}),debug:v=>({u_color:new i.UniformColor(v),u_matrix:new i.UniformMatrix4f(v),u_overlay:new i.Uniform1i(v),u_overlay_scale:new i.Uniform1f(v)}),clippingMask:v=>({u_matrix:new i.UniformMatrix4f(v)}),heatmap:v=>({u_extrude_scale:new i.Uniform1f(v),u_intensity:new i.Uniform1f(v),u_matrix:new i.UniformMatrix4f(v),u_inv_rot_matrix:new i.UniformMatrix4f(v),u_merc_center:new i.Uniform2f(v),u_tile_id:new i.Uniform3f(v),u_zoom_transition:new i.Uniform1f(v),u_up_dir:new i.Uniform3f(v)}),heatmapTexture:v=>({u_image:new i.Uniform1i(v),u_color_ramp:new i.Uniform1i(v),u_opacity:new i.Uniform1f(v)}),hillshade:v=>({u_matrix:new i.UniformMatrix4f(v),u_image:new i.Uniform1i(v),u_latrange:new i.Uniform2f(v),u_light:new i.Uniform2f(v),u_shadow:new i.UniformColor(v),u_highlight:new i.UniformColor(v),u_accent:new i.UniformColor(v)}),hillshadePrepare:v=>({u_matrix:new i.UniformMatrix4f(v),u_image:new i.Uniform1i(v),u_dimension:new i.Uniform2f(v),u_zoom:new i.Uniform1f(v),u_unpack:new i.Uniform4f(v)}),line:v=>({u_matrix:new i.UniformMatrix4f(v),u_pixels_to_tile_units:new i.UniformMatrix2f(v),u_device_pixel_ratio:new i.Uniform1f(v),u_units_to_pixels:new i.Uniform2f(v),u_dash_image:new i.Uniform1i(v),u_gradient_image:new i.Uniform1i(v),u_image_height:new i.Uniform1f(v),u_texsize:new i.Uniform2f(v),u_tile_units_to_pixels:new i.Uniform1f(v),u_alpha_discard_threshold:new i.Uniform1f(v),u_trim_offset:new i.Uniform2f(v)}),linePattern:v=>({u_matrix:new i.UniformMatrix4f(v),u_texsize:new i.Uniform2f(v),u_pixels_to_tile_units:new i.UniformMatrix2f(v),u_device_pixel_ratio:new i.Uniform1f(v),u_image:new i.Uniform1i(v),u_units_to_pixels:new i.Uniform2f(v),u_tile_units_to_pixels:new i.Uniform1f(v),u_alpha_discard_threshold:new i.Uniform1f(v)}),raster:v=>({u_matrix:new i.UniformMatrix4f(v),u_tl_parent:new i.Uniform2f(v),u_scale_parent:new i.Uniform1f(v),u_fade_t:new i.Uniform1f(v),u_opacity:new i.Uniform1f(v),u_image0:new i.Uniform1i(v),u_image1:new i.Uniform1i(v),u_brightness_low:new i.Uniform1f(v),u_brightness_high:new i.Uniform1f(v),u_saturation_factor:new i.Uniform1f(v),u_contrast_factor:new i.Uniform1f(v),u_spin_weights:new i.Uniform3f(v),u_perspective_transform:new i.Uniform2f(v)}),symbolIcon:v=>({u_is_size_zoom_constant:new i.Uniform1i(v),u_is_size_feature_constant:new i.Uniform1i(v),u_size_t:new i.Uniform1f(v),u_size:new i.Uniform1f(v),u_camera_to_center_distance:new i.Uniform1f(v),u_rotate_symbol:new i.Uniform1i(v),u_aspect_ratio:new i.Uniform1f(v),u_fade_change:new i.Uniform1f(v),u_matrix:new i.UniformMatrix4f(v),u_label_plane_matrix:new i.UniformMatrix4f(v),u_coord_matrix:new i.UniformMatrix4f(v),u_is_text:new i.Uniform1i(v),u_pitch_with_map:new i.Uniform1i(v),u_texsize:new i.Uniform2f(v),u_tile_id:new i.Uniform3f(v),u_zoom_transition:new i.Uniform1f(v),u_inv_rot_matrix:new i.UniformMatrix4f(v),u_merc_center:new i.Uniform2f(v),u_camera_forward:new i.Uniform3f(v),u_tile_matrix:new i.UniformMatrix4f(v),u_up_vector:new i.Uniform3f(v),u_ecef_origin:new i.Uniform3f(v),u_texture:new i.Uniform1i(v)}),symbolSDF:v=>({u_is_size_zoom_constant:new i.Uniform1i(v),u_is_size_feature_constant:new i.Uniform1i(v),u_size_t:new i.Uniform1f(v),u_size:new i.Uniform1f(v),u_camera_to_center_distance:new i.Uniform1f(v),u_rotate_symbol:new i.Uniform1i(v),u_aspect_ratio:new i.Uniform1f(v),u_fade_change:new i.Uniform1f(v),u_matrix:new i.UniformMatrix4f(v),u_label_plane_matrix:new i.UniformMatrix4f(v),u_coord_matrix:new i.UniformMatrix4f(v),u_is_text:new i.Uniform1i(v),u_pitch_with_map:new i.Uniform1i(v),u_texsize:new i.Uniform2f(v),u_texture:new i.Uniform1i(v),u_gamma_scale:new i.Uniform1f(v),u_device_pixel_ratio:new i.Uniform1f(v),u_tile_id:new i.Uniform3f(v),u_zoom_transition:new i.Uniform1f(v),u_inv_rot_matrix:new i.UniformMatrix4f(v),u_merc_center:new i.Uniform2f(v),u_camera_forward:new i.Uniform3f(v),u_tile_matrix:new i.UniformMatrix4f(v),u_up_vector:new i.Uniform3f(v),u_ecef_origin:new i.Uniform3f(v),u_is_halo:new i.Uniform1i(v)}),symbolTextAndIcon:v=>({u_is_size_zoom_constant:new i.Uniform1i(v),u_is_size_feature_constant:new i.Uniform1i(v),u_size_t:new i.Uniform1f(v),u_size:new i.Uniform1f(v),u_camera_to_center_distance:new i.Uniform1f(v),u_rotate_symbol:new i.Uniform1i(v),u_aspect_ratio:new i.Uniform1f(v),u_fade_change:new i.Uniform1f(v),u_matrix:new i.UniformMatrix4f(v),u_label_plane_matrix:new i.UniformMatrix4f(v),u_coord_matrix:new i.UniformMatrix4f(v),u_is_text:new i.Uniform1i(v),u_pitch_with_map:new i.Uniform1i(v),u_texsize:new i.Uniform2f(v),u_texsize_icon:new i.Uniform2f(v),u_texture:new i.Uniform1i(v),u_texture_icon:new i.Uniform1i(v),u_gamma_scale:new i.Uniform1f(v),u_device_pixel_ratio:new i.Uniform1f(v),u_is_halo:new i.Uniform1i(v)}),background:v=>({u_matrix:new i.UniformMatrix4f(v),u_opacity:new i.Uniform1f(v),u_color:new i.UniformColor(v)}),backgroundPattern:v=>({u_matrix:new i.UniformMatrix4f(v),u_opacity:new i.Uniform1f(v),u_image:new i.Uniform1i(v),u_pattern_tl:new i.Uniform2f(v),u_pattern_br:new i.Uniform2f(v),u_texsize:new i.Uniform2f(v),u_pattern_size:new i.Uniform2f(v),u_pixel_coord_upper:new i.Uniform2f(v),u_pixel_coord_lower:new i.Uniform2f(v),u_tile_units_to_pixels:new i.Uniform1f(v)}),terrainRaster:Xg,terrainDepth:Xg,skybox:v=>({u_matrix:new i.UniformMatrix4f(v),u_sun_direction:new i.Uniform3f(v),u_cubemap:new i.Uniform1i(v),u_opacity:new i.Uniform1f(v),u_temporal_offset:new i.Uniform1f(v)}),skyboxGradient:v=>({u_matrix:new i.UniformMatrix4f(v),u_color_ramp:new i.Uniform1i(v),u_center_direction:new i.Uniform3f(v),u_radius:new i.Uniform1f(v),u_opacity:new i.Uniform1f(v),u_temporal_offset:new i.Uniform1f(v)}),skyboxCapture:v=>({u_matrix_3f:new i.UniformMatrix3f(v),u_sun_direction:new i.Uniform3f(v),u_sun_intensity:new i.Uniform1f(v),u_color_tint_r:new i.Uniform4f(v),u_color_tint_m:new i.Uniform4f(v),u_luminance:new i.Uniform1f(v)}),globeRaster:v=>({u_proj_matrix:new i.UniformMatrix4f(v),u_globe_matrix:new i.UniformMatrix4f(v),u_normalize_matrix:new i.UniformMatrix4f(v),u_merc_matrix:new i.UniformMatrix4f(v),u_zoom_transition:new i.Uniform1f(v),u_merc_center:new i.Uniform2f(v),u_image0:new i.Uniform1i(v),u_grid_matrix:new i.UniformMatrix3f(v),u_skirt_height:new i.Uniform1f(v),u_frustum_tl:new i.Uniform3f(v),u_frustum_tr:new i.Uniform3f(v),u_frustum_br:new i.Uniform3f(v),u_frustum_bl:new i.Uniform3f(v),u_globe_pos:new i.Uniform3f(v),u_globe_radius:new i.Uniform1f(v),u_viewport:new i.Uniform2f(v)}),globeAtmosphere:v=>({u_frustum_tl:new i.Uniform3f(v),u_frustum_tr:new i.Uniform3f(v),u_frustum_br:new i.Uniform3f(v),u_frustum_bl:new i.Uniform3f(v),u_horizon:new i.Uniform1f(v),u_transition:new i.Uniform1f(v),u_fadeout_range:new i.Uniform1f(v),u_color:new i.Uniform4f(v),u_high_color:new i.Uniform4f(v),u_space_color:new i.Uniform4f(v),u_star_intensity:new i.Uniform1f(v),u_star_density:new i.Uniform1f(v),u_star_size:new i.Uniform1f(v),u_temporal_offset:new i.Uniform1f(v),u_horizon_angle:new i.Uniform1f(v),u_rotation_matrix:new i.UniformMatrix4f(v)})};let Uf;function Kd(v,d,m,w,T,P,L){const z=v.context,U=z.gl,Z=v.transform,H=v.useProgram("collisionBox"),Q=[];let se=0,de=0;for(let we=0;we<w.length;we++){const Oe=w[we],Le=d.getTile(Oe),De=Le.getBucket(m);if(!De)continue;const qe=Uo(Oe,De,Z);let Ue=qe;T[0]===0&&T[1]===0||(Ue=v.translatePosMatrix(qe,Le,T,P));const Je=L?De.textCollisionBox:De.iconCollisionBox,bt=De.collisionCircleArray;if(bt.length>0){const Ze=i.create(),ut=Ue;i.mul(Ze,De.placementInvProjMatrix,Z.glCoordMatrix),i.mul(Ze,Ze,De.placementViewportMatrix),Q.push({circleArray:bt,circleOffset:de,transform:ut,invTransform:Ze,projection:De.getProjection()}),se+=bt.length/4,de=se}Je&&(v.terrain&&v.terrain.setupElevationDraw(Le,H),H.draw(z,U.LINES,i.DepthMode.disabled,i.StencilMode.disabled,v.colorModeForRenderPass(),i.CullFaceMode.disabled,ry(Ue,Z,Le,De.getProjection()),m.id,Je.layoutVertexBuffer,Je.indexBuffer,Je.segments,null,Z.zoom,null,[Je.collisionVertexBuffer,Je.collisionVertexBufferExt]))}if(!L||!Q.length)return;const fe=v.useProgram("collisionCircle"),he=new i.StructArrayLayout2f1f2i16;he.resize(4*se),he._trim();let me=0;for(const we of Q)for(let Oe=0;Oe<we.circleArray.length/4;Oe++){const Le=4*Oe,De=we.circleArray[Le+0],qe=we.circleArray[Le+1],Ue=we.circleArray[Le+2],Je=we.circleArray[Le+3];he.emplace(me++,De,qe,Ue,Je,0),he.emplace(me++,De,qe,Ue,Je,1),he.emplace(me++,De,qe,Ue,Je,2),he.emplace(me++,De,qe,Ue,Je,3)}(!Uf||Uf.length<2*se)&&(Uf=function(we){const Oe=2*we,Le=new i.StructArrayLayout3ui6;Le.resize(Oe),Le._trim();for(let De=0;De<Oe;De++){const qe=6*De;Le.uint16[qe+0]=4*De+0,Le.uint16[qe+1]=4*De+1,Le.uint16[qe+2]=4*De+2,Le.uint16[qe+3]=4*De+2,Le.uint16[qe+4]=4*De+3,Le.uint16[qe+5]=4*De+0}return Le}(se));const te=z.createIndexBuffer(Uf,!0),ue=z.createVertexBuffer(he,i.collisionCircleLayout.members,!0);for(const we of Q){const Oe={u_matrix:we.transform,u_inv_matrix:we.invTransform,u_camera_to_center_distance:(be=Z).getCameraToCenterDistance(we.projection),u_viewport_size:[be.width,be.height]};fe.draw(z,U.TRIANGLES,i.DepthMode.disabled,i.StencilMode.disabled,v.colorModeForRenderPass(),i.CullFaceMode.disabled,Oe,m.id,ue,te,i.SegmentVector.simpleSegment(0,2*we.circleOffset,we.circleArray.length,we.circleArray.length/2),null,Z.zoom)}var be;ue.destroy(),te.destroy()}const v0=i.create();function ly({width:v,height:d,anchor:m,textOffset:w,textScale:T},P){const{horizontalAlign:L,verticalAlign:z}=i.getAnchorAlignment(m),U=-(L-.5)*v,Z=-(z-.5)*d,H=i.evaluateVariableOffset(m,w);return new i.Point((U/T+H[0])*P,(Z/T+H[1])*P)}function HE(v,d,m,w,T,P,L,z,U,Z,H){const Q=v.text.placedSymbolArray,se=v.text.dynamicLayoutVertexArray,de=v.icon.dynamicLayoutVertexArray,fe={},he=v.getProjection(),me=En(z,he,P),te=P.elevation,ue=he.upVectorScale(z.canonical,P.center.lat,P.worldSize).metersToTile;se.clear();for(let be=0;be<Q.length;be++){const we=Q.get(be),{tileAnchorX:Oe,tileAnchorY:Le,numGlyphs:De}=we,qe=we.hidden||!we.crossTileID||v.allowVerticalPlacement&&!we.placedOrientation?null:w[we.crossTileID];if(qe){let Ue=0,Je=0,bt=0;if(te){const St=te?te.getAtTileOffset(z,Oe,Le):0,[Kt,sr,Ut]=he.upVector(z.canonical,Oe,Le);Ue=St*Kt*ue,Je=St*sr*ue,bt=St*Ut*ue}let[Ze,ut,et,xt]=vi(we.projectedAnchorX+Ue,we.projectedAnchorY+Je,we.projectedAnchorZ+bt,m?me:L);const Ye=i0(P.getCameraToCenterDistance(he),xt);let ct=T.evaluateSizeForFeature(v.textSizeData,Z,we)*Ye/i.ONE_EM;m&&(ct*=v.tilePixelRatio/U);const wt=ly(qe,ct);m?({x:Ze,y:ut,z:et}=he.projectTilePoint(Oe+wt.x,Le+wt.y,z.canonical),[Ze,ut,et]=vi(Ze+Ue,ut+Je,et+bt,L)):(d&&wt._rotate(-P.angle),Ze+=wt.x,ut+=wt.y,et=0);const mt=v.allowVerticalPlacement&&we.placedOrientation===i.WritingMode.vertical?Math.PI/2:0;for(let St=0;St<De;St++)i.addDynamicAttributes(se,Ze,ut,et,mt);H&&we.associatedIconIndex>=0&&(fe[we.associatedIconIndex]={x:Ze,y:ut,z:et,angle:mt})}else da(De,se)}if(H){de.clear();const be=v.icon.placedSymbolArray;for(let we=0;we<be.length;we++){const Oe=be.get(we),{numGlyphs:Le}=Oe,De=fe[we];if(Oe.hidden||!De)da(Le,de);else{const{x:qe,y:Ue,z:Je,angle:bt}=De;for(let Ze=0;Ze<Le;Ze++)i.addDynamicAttributes(de,qe,Ue,Je,bt)}}v.icon.dynamicLayoutVertexBuffer.updateData(de)}v.text.dynamicLayoutVertexBuffer.updateData(se)}function cy(v,d,m){return m.iconsInText&&d?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function x0(v,d,m,w,T,P,L,z,U,Z,H,Q){const se=v.context,de=se.gl,fe=v.transform,he=z==="map",me=U==="map",te=he&&m.layout.get("symbol-placement")!=="point",ue=he&&!me&&!te,be=m.layout.get("symbol-sort-key").constantOr(1)!==void 0;let we=!1;const Oe=v.depthModeForSublayer(0,i.DepthMode.ReadOnly),Le=[i.mercatorXfromLng(fe.center.lng),i.mercatorYfromLat(fe.center.lat)],De=m.layout.get("text-variable-anchor"),qe=fe.projection.name==="globe",Ue=[],Je=[0,-1,0];let bt=Je;!qe&&!fe.mercatorFromTransition||he||(bt=function(Ze){const ut=Ze._camera.getWorldToCamera(Ze.worldSize,1),et=i.multiply([],ut,Ze.globeMatrix);i.invert(et,et);const xt=[0,0,0],Ye=[0,1,0,0];return i.transformMat4$1(Ye,Ye,et),xt[0]=Ye[0],xt[1]=Ye[1],xt[2]=Ye[2],i.normalize(xt,xt),xt}(fe));for(const Ze of w){const ut=d.getTile(Ze),et=ut.getBucket(m);if(!et||et.projection.name==="mercator"&&qe)continue;const xt=T?et.text:et.icon;if(!xt||et.fullyClipped||!xt.segments.get().length)continue;const Ye=xt.programConfigurations.get(m.id),ct=T||et.sdfIcons,wt=T?et.textSizeData:et.iconSizeData,mt=me||fe.pitch!==0,St=i.evaluateSizeForZoom(wt,fe.zoom);let Kt,sr,Ut,ir,Tr=[0,0],wr=null;if(T)sr=ut.glyphAtlasTexture,Ut=de.LINEAR,Kt=ut.glyphAtlasTexture.size,et.iconsInText&&(Tr=ut.imageAtlasTexture.size,wr=ut.imageAtlasTexture,ir=mt||v.options.rotating||v.options.zooming||wt.kind==="composite"||wt.kind==="camera"?de.LINEAR:de.NEAREST);else{const bs=m.layout.get("icon-size").constantOr(0)!==1||et.iconsNeedLinear;sr=ut.imageAtlasTexture,Ut=ct||v.options.rotating||v.options.zooming||bs||mt?de.LINEAR:de.NEAREST,Kt=ut.imageAtlasTexture.size}const Zt=et.projection.name==="globe",Hr=Zt?bt:Je,Jr=Zt?i.globeToMercatorTransition(fe.zoom):0,Qr=En(Ze,et.getProjection(),fe),en=fe.calculatePixelsToTileUnitsMatrix(ut),Vi=at(Qr,ut.tileID.canonical,me,he,fe,et.getProjection(),en),bi=v.terrain&&me&&te?i.invert(i.create(),Vi):v0,Go=Zn(Qr,ut.tileID.canonical,me,he,fe,et.getProjection(),en),za=De&&et.hasTextData(),Tn=m.layout.get("icon-text-fit")!=="none"&&za&&et.hasIconData();if(te){const bs=fe.elevation,sl=bs?bs.getAtTileOffsetFunc(Ze,fe.center.lat,fe.worldSize,et.getProjection()):null,Jl=hs(Qr,ut.tileID.canonical,me,he,fe,et.getProjection(),en);Dg(et,Qr,v,T,Jl,Go,me,Z,sl,Ze)}const tn=te||T&&De||Tn,Dr=v.translatePosMatrix(Qr,ut,P,L),Kn=tn?v0:Vi,Ji=v.translatePosMatrix(Go,ut,P,L,!0),mn=et.getProjection().createInversionMatrix(fe,Ze.canonical),ho=[];v.terrainRenderModeElevated()&&me&&ho.push("PITCH_WITH_MAP_TERRAIN"),Zt&&ho.push("PROJECTION_GLOBE_VIEW"),tn&&ho.push("PROJECTED_POS_ON_VIEWPORT");const ip=ct&&m.paint.get(T?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Yl;Yl=ct?et.iconsInText?y0(wt.kind,St,ue,me,v,Dr,Kn,Ji,Kt,Tr,Ze,Jr,Le,mn,Hr,et.getProjection()):Ff(wt.kind,St,ue,me,v,Dr,Kn,Ji,T,Kt,!0,Ze,Jr,Le,mn,Hr,et.getProjection()):oy(wt.kind,St,ue,me,v,Dr,Kn,Ji,T,Kt,Ze,Jr,Le,mn,Hr,et.getProjection());const sh={program:v.useProgram(cy(ct,T,et),Ye,ho),buffers:xt,uniformValues:Yl,atlasTexture:sr,atlasTextureIcon:wr,atlasInterpolation:Ut,atlasInterpolationIcon:ir,isSDF:ct,hasHalo:ip,tile:ut,labelPlaneMatrixInv:bi};if(be&&et.canOverlap){we=!0;const bs=xt.segments.get();for(const sl of bs)Ue.push({segments:new i.SegmentVector([sl]),sortKey:sl.sortKey,state:sh})}else Ue.push({segments:xt.segments,sortKey:0,state:sh})}we&&Ue.sort((Ze,ut)=>Ze.sortKey-ut.sortKey);for(const Ze of Ue){const ut=Ze.state;if(v.terrain&&v.terrain.setupElevationDraw(ut.tile,ut.program,{useDepthForOcclusion:!qe,labelPlaneMatrixInv:ut.labelPlaneMatrixInv}),se.activeTexture.set(de.TEXTURE0),ut.atlasTexture.bind(ut.atlasInterpolation,de.CLAMP_TO_EDGE),ut.atlasTextureIcon&&(se.activeTexture.set(de.TEXTURE1),ut.atlasTextureIcon&&ut.atlasTextureIcon.bind(ut.atlasInterpolationIcon,de.CLAMP_TO_EDGE)),ut.isSDF){const et=ut.uniformValues;ut.hasHalo&&(et.u_is_halo=1,Yd(ut.buffers,Ze.segments,m,v,ut.program,Oe,H,Q,et)),et.u_is_halo=0}Yd(ut.buffers,Ze.segments,m,v,ut.program,Oe,H,Q,ut.uniformValues)}}function Yd(v,d,m,w,T,P,L,z,U){const Z=w.context,H=[v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer,v.globeExtVertexBuffer];T.draw(Z,Z.gl.TRIANGLES,P,L,z,i.CullFaceMode.disabled,U,m.id,v.layoutVertexBuffer,v.indexBuffer,d,m.paint,w.transform.zoom,v.programConfigurations.get(m.id),H)}function b0(v,d,m,w,T,P,L){const z=v.context.gl,U=m.paint.get("fill-pattern"),Z=U&&U.constantOr(1);let H,Q,se,de,fe;L?(Q=Z&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",H=z.LINES):(Q=Z?"fillPattern":"fill",H=z.TRIANGLES);for(const he of w){const me=d.getTile(he);if(Z&&!me.patternsLoaded())continue;const te=me.getBucket(m);if(!te)continue;v.prepareDrawTile();const ue=te.programConfigurations.get(m.id),be=v.useProgram(Q,ue);Z&&(v.context.activeTexture.set(z.TEXTURE0),me.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),ue.updatePaintBuffers());const we=U.constantOr(null);if(we&&me.imageAtlas){const Le=me.imageAtlas.patternPositions[we.toString()];Le&&ue.setConstantPatternPositions(Le)}const Oe=v.translatePosMatrix(he.projMatrix,me,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(L){de=te.indexBuffer2,fe=te.segments2;const Le=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[z.drawingBufferWidth,z.drawingBufferHeight];se=Q==="fillOutlinePattern"&&Z?VE(Oe,v,me,Le):UE(Oe,Le)}else de=te.indexBuffer,fe=te.segments,se=Z?Qg(Oe,v,me):Hl(Oe);v.prepareDrawProgram(v.context,be,he.toUnwrapped()),be.draw(v.context,H,T,v.stencilModeForClipping(he),P,i.CullFaceMode.disabled,se,m.id,te.layoutVertexBuffer,de,fe,m.paint,v.transform.zoom,ue)}}function Vf(v,d,m,w,T,P,L){const z=v.context,U=z.gl,Z=v.transform,H=m.paint.get("fill-extrusion-pattern"),Q=H.constantOr(1),se=m.paint.get("fill-extrusion-opacity"),de=[m.paint.get("fill-extrusion-ambient-occlusion-intensity"),m.paint.get("fill-extrusion-ambient-occlusion-radius")],fe=m.layout.get("fill-extrusion-edge-radius"),he=fe>0&&!m.paint.get("fill-extrusion-rounded-roof"),me=he?0:fe,te=Z.projection.name==="globe"?i.fillExtrusionHeightLift():0,ue=Z.projection.name==="globe",be=ue?i.globeToMercatorTransition(Z.zoom):0,we=[i.mercatorXfromLng(Z.center.lng),i.mercatorYfromLat(Z.center.lat)],Oe=[];ue&&Oe.push("PROJECTION_GLOBE_VIEW"),de[0]>0&&Oe.push("FAUX_AO"),he&&Oe.push("ZERO_ROOF_RADIUS");for(const Le of w){const De=d.getTile(Le),qe=De.getBucket(m);if(!qe||qe.projection.name!==Z.projection.name)continue;const Ue=qe.programConfigurations.get(m.id),Je=v.useProgram(Q?"fillExtrusionPattern":"fillExtrusion",Ue,Oe);if(v.terrain){const ct=v.terrain;if(v.style.terrainSetForDrapingOnly())ct.setupElevationDraw(De,Je,{useMeterToDem:!0});else{if(!qe.enableTerrain)continue;if(ct.setupElevationDraw(De,Je,{useMeterToDem:!0}),_0(z,d,Le,qe,m,ct),!qe.centroidVertexBuffer){const wt=Je.attributes.a_centroid_pos;wt!==void 0&&U.vertexAttrib2f(wt,0,0)}}}Q&&(v.context.activeTexture.set(U.TEXTURE0),De.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Ue.updatePaintBuffers());const bt=H.constantOr(null);if(bt&&De.imageAtlas){const ct=De.imageAtlas.patternPositions[bt.toString()];ct&&Ue.setConstantPatternPositions(ct)}const Ze=v.translatePosMatrix(Le.projMatrix,De,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),ut=Z.projection.createInversionMatrix(Z,Le.canonical),et=m.paint.get("fill-extrusion-vertical-gradient"),xt=Q?p0(Ze,v,et,se,de,me,Le,De,te,be,we,ut):Jg(Ze,v,et,se,de,me,Le,te,be,we,ut);v.prepareDrawProgram(z,Je,Le.toUnwrapped());const Ye=[];v.terrain&&Ye.push(qe.centroidVertexBuffer),ue&&Ye.push(qe.layoutVertexExtBuffer),Je.draw(z,z.gl.TRIANGLES,T,P,L,i.CullFaceMode.backCCW,xt,m.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,m.paint,v.transform.zoom,Ue,Ye)}}function _0(v,d,m,w,T,P){const L=[te=>{let ue=te.canonical.x-1,be=te.wrap;return ue<0&&(ue=(1<<te.canonical.z)-1,be--),new i.OverscaledTileID(te.overscaledZ,be,te.canonical.z,ue,te.canonical.y)},te=>{let ue=te.canonical.x+1,be=te.wrap;return ue===1<<te.canonical.z&&(ue=0,be++),new i.OverscaledTileID(te.overscaledZ,be,te.canonical.z,ue,te.canonical.y)},te=>new i.OverscaledTileID(te.overscaledZ,te.wrap,te.canonical.z,te.canonical.x,(te.canonical.y===0?1<<te.canonical.z:te.canonical.y)-1),te=>new i.OverscaledTileID(te.overscaledZ,te.wrap,te.canonical.z,te.canonical.x,te.canonical.y===(1<<te.canonical.z)-1?0:te.canonical.y+1)],z=te=>{const ue=d.getSource().minzoom,be=Oe=>{const Le=d.getTileByID(Oe);if(Le&&Le.hasData())return Le.getBucket(T)},we=[0,-1,1];for(const Oe of we){if(te.overscaledZ+Oe<ue)continue;const Le=be(te.calculateScaledKey(te.overscaledZ+Oe));if(Le)return Le}},U=[0,0,0],Z=(te,ue)=>(U[0]=Math.min(te.min.y,ue.min.y),U[1]=Math.max(te.max.y,ue.max.y),U[2]=i.EXTENT-ue.min.x>te.max.x?ue.min.x-i.EXTENT:te.max.x,U),H=(te,ue)=>(U[0]=Math.min(te.min.x,ue.min.x),U[1]=Math.max(te.max.x,ue.max.x),U[2]=i.EXTENT-ue.min.y>te.max.y?ue.min.y-i.EXTENT:te.max.y,U),Q=[(te,ue)=>Z(te,ue),(te,ue)=>Z(ue,te),(te,ue)=>H(te,ue),(te,ue)=>H(ue,te)],se=new i.Point(0,0);let de,fe,he;const me=(te,ue,be,we,Oe)=>{const Le=[[we?be:te,we?te:be,0],[we?be:ue,we?ue:be,0]],De=Oe<0?i.EXTENT+Oe:Oe,qe=[we?De:(te+ue)/2,we?(te+ue)/2:De,0];return be===0&&Oe<0||be!==0&&Oe>0?P.getForTilePoints(he,[qe],!0,fe):Le.push(qe),P.getForTilePoints(m,Le,!0,de),Math.max(Le[0][2],Le[1][2],qe[2])/P.exaggeration()};for(let te=0;te<4;te++){const ue=(te<2?1:5)-te,be=w.borders[te];if(be.length===0)continue;const we=he=L[te](m),Oe=z(we);if(!(Oe&&Oe instanceof i.FillExtrusionBucket&&Oe.enableTerrain)||w.borderDoneWithNeighborZ[te]===Oe.canonical.z&&Oe.borderDoneWithNeighborZ[ue]===w.canonical.z||(fe=P.findDEMTileFor(we),!fe||!fe.dem))continue;if(!de){const Ue=P.findDEMTileFor(m);if(!Ue||!Ue.dem)return;de=Ue}const Le=Oe.borders[ue];let De=0;const qe=Oe.borderDoneWithNeighborZ[ue]!==w.canonical.z;if(w.canonical.z===Oe.canonical.z){for(let Ue=0;Ue<be.length;Ue++){const Je=w.featuresOnBorder[be[Ue]],bt=Je.borders[te];let Ze;for(;De<Le.length&&(Ze=Oe.featuresOnBorder[Le[De]],!(Ze.borders[ue][1]>bt[0]+3));)qe&&Oe.encodeCentroid(void 0,Ze,!1),De++;if(Ze&&De<Le.length){const ut=De;let et=0;for(;!(Ze.borders[ue][0]>bt[1]-3)&&(et++,++De!==Le.length);)Ze=Oe.featuresOnBorder[Le[De]];if(Ze=Oe.featuresOnBorder[Le[ut]],Je.intersectsCount()>1||Ze.intersectsCount()>1||et!==1){et!==1&&(De=ut),w.encodeCentroid(void 0,Je,!1),qe&&Oe.encodeCentroid(void 0,Ze,!1);continue}const xt=Q[te](Je,Ze),Ye=te%2?i.EXTENT-1:0;se.x=me(xt[0],Math.min(i.EXTENT-1,xt[1]),Ye,te<2,xt[2]),se.y=0,w.encodeCentroid(se,Je,!1),qe&&Oe.encodeCentroid(se,Ze,!1)}else w.encodeCentroid(void 0,Je,!1)}w.borderDoneWithNeighborZ[te]=Oe.canonical.z,w.needsCentroidUpdate=!0,qe&&(Oe.borderDoneWithNeighborZ[ue]=w.canonical.z,Oe.needsCentroidUpdate=!0)}else{for(const Ue of be)w.encodeCentroid(void 0,w.featuresOnBorder[Ue],!1);if(qe){for(const Ue of Le)Oe.encodeCentroid(void 0,Oe.featuresOnBorder[Ue],!1);Oe.borderDoneWithNeighborZ[ue]=w.canonical.z,Oe.needsCentroidUpdate=!0}w.borderDoneWithNeighborZ[te]=Oe.canonical.z,w.needsCentroidUpdate=!0}}(w.needsCentroidUpdate||!w.centroidVertexBuffer&&w.centroidVertexArray.length!==0)&&w.uploadCentroid(v)}const au=new i.Color(1,0,0,1),XE=new i.Color(0,1,0,1),ZE=new i.Color(0,0,1,1),KE=new i.Color(1,0,1,1),YE=new i.Color(0,1,1,1);function JE(v,d,m){const w=v.context,T=v.transform,P=w.gl,L=T.projection.name==="globe",z=L?["PROJECTION_GLOBE_VIEW"]:null;let U=m.projMatrix;if(L&&i.globeToMercatorTransition(T.zoom)>0){const Je=i.transitionTileAABBinECEF(m.canonical,T),bt=i.globeDenormalizeECEF(Je);U=i.multiply(new Float32Array(16),T.globeMatrix,bt),i.multiply(U,T.projMatrix,U)}const Z=v.useProgram("debug",null,z),H=d.getTileByID(m.key);v.terrain&&v.terrain.setupElevationDraw(H,Z);const Q=i.DepthMode.disabled,se=i.StencilMode.disabled,de=v.colorModeForRenderPass(),fe="$debug";w.activeTexture.set(P.TEXTURE0),v.emptyTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),L?H._makeGlobeTileDebugBuffers(v.context,T):H._makeDebugTileBoundsBuffers(v.context,T.projection);const he=H._tileDebugBuffer||v.debugBuffer,me=H._tileDebugIndexBuffer||v.debugIndexBuffer,te=H._tileDebugSegments||v.debugSegments;Z.draw(w,P.LINE_STRIP,Q,se,de,i.CullFaceMode.disabled,zf(U,i.Color.red),fe,he,me,te,null,null,null,[H._globeTileDebugBorderBuffer]);const ue=H.latestRawTileData,be=Math.floor((ue&&ue.byteLength||0)/1024),we=d.getTile(m).tileSize,Oe=512/Math.min(we,512)*(m.overscaledZ/T.zoom)*.5;let Le=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(Le+=` => ${m.overscaledZ}`),Le+=` ${be}kb`,function(Je,bt){Je.initDebugOverlayCanvas();const Ze=Je.debugOverlayCanvas,ut=Je.context.gl,et=Je.debugOverlayCanvas.getContext("2d");et.clearRect(0,0,Ze.width,Ze.height),et.shadowColor="white",et.shadowBlur=2,et.lineWidth=1.5,et.strokeStyle="white",et.textBaseline="top",et.font="bold 36px Open Sans, sans-serif",et.fillText(bt,5,5),et.strokeText(bt,5,5),Je.debugOverlayTexture.update(Ze),Je.debugOverlayTexture.bind(ut.LINEAR,ut.CLAMP_TO_EDGE)}(v,Le);const De=H._tileDebugTextBuffer||v.debugBuffer,qe=H._tileDebugTextIndexBuffer||v.quadTriangleIndexBuffer,Ue=H._tileDebugTextSegments||v.debugSegments;Z.draw(w,P.TRIANGLES,Q,se,i.ColorMode.alphaBlended,i.CullFaceMode.disabled,zf(U,i.Color.transparent,Oe),fe,De,qe,Ue,null,null,null,[H._globeTileDebugTextBuffer])}function w0(v,d,m,w){su(v,0,d+m/2,v.transform.width,m,w)}function qf(v,d,m,w){su(v,d-m/2,0,m,v.transform.height,w)}function su(v,d,m,w,T,P){const L=v.context,z=L.gl;z.enable(z.SCISSOR_TEST),z.scissor(d*i.exported.devicePixelRatio,m*i.exported.devicePixelRatio,w*i.exported.devicePixelRatio,T*i.exported.devicePixelRatio),L.clear({color:P}),z.disable(z.SCISSOR_TEST)}const S0=i.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:E0}=S0;function vs(v,d,m,w){v.emplaceBack(d,m,w)}class Wf{constructor(d){this.vertexArray=new i.StructArrayLayout3f12,this.indices=new i.StructArrayLayout3ui6,vs(this.vertexArray,-1,-1,1),vs(this.vertexArray,1,-1,1),vs(this.vertexArray,-1,1,1),vs(this.vertexArray,1,1,1),vs(this.vertexArray,-1,-1,-1),vs(this.vertexArray,1,-1,-1),vs(this.vertexArray,-1,1,-1),vs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=d.createVertexBuffer(this.vertexArray,E0),this.indexBuffer=d.createIndexBuffer(this.indices),this.segment=i.SegmentVector.simpleSegment(0,0,36,12)}}function qo(v,d,m,w,T,P){const L=v.gl,z=d.paint.get("sky-atmosphere-color"),U=d.paint.get("sky-atmosphere-halo-color"),Z=d.paint.get("sky-atmosphere-sun-intensity"),H=((Q,se,de,fe,he)=>({u_matrix_3f:Q,u_sun_direction:se,u_sun_intensity:de,u_color_tint_r:[fe.r,fe.g,fe.b,fe.a],u_color_tint_m:[he.r,he.g,he.b,he.a],u_luminance:5e-5}))(i.fromMat4(i.create$1(),w),T,Z,z,U);L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_CUBE_MAP_POSITIVE_X+P,d.skyboxTexture,0),m.draw(v,L.TRIANGLES,i.DepthMode.disabled,i.StencilMode.disabled,i.ColorMode.unblended,i.CullFaceMode.frontCW,H,"skyboxCapture",d.skyboxGeometry.vertexBuffer,d.skyboxGeometry.indexBuffer,d.skyboxGeometry.segment)}const Jd=i.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class T0{constructor(d){const m=new i.StructArrayLayout5f20;m.emplaceBack(-1,1,1,0,0),m.emplaceBack(1,1,1,1,0),m.emplaceBack(1,-1,1,1,1),m.emplaceBack(-1,-1,1,0,1);const w=new i.StructArrayLayout3ui6;w.emplaceBack(0,1,2),w.emplaceBack(2,3,0),this.vertexBuffer=d.createVertexBuffer(m,Jd.members),this.indexBuffer=d.createIndexBuffer(w),this.segments=i.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Xl={symbol:function(v,d,m,w,T){if(v.renderPass!=="translucent")return;const P=i.StencilMode.disabled,L=v.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(z,U,Z,H,Q,se,de){const fe=U.transform,he=Q==="map",me=se==="map";for(const te of z){const ue=H.getTile(te),be=ue.getBucket(Z);if(!be||!be.text||!be.text.segments.get().length)continue;const we=i.evaluateSizeForZoom(be.textSizeData,fe.zoom),Oe=En(te,be.getProjection(),fe),Le=fe.calculatePixelsToTileUnitsMatrix(ue),De=at(Oe,ue.tileID.canonical,me,he,fe,be.getProjection(),Le),qe=Z.layout.get("icon-text-fit")!=="none"&&be.hasIconData();if(we){const Ue=Math.pow(2,fe.zoom-ue.tileID.overscaledZ);HE(be,he,me,de,i.symbolSize,fe,De,te,Ue,we,qe)}}}(w,v,m,d,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),T),m.paint.get("icon-opacity").constantOr(1)!==0&&x0(v,d,m,w,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),P,L),m.paint.get("text-opacity").constantOr(1)!==0&&x0(v,d,m,w,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),P,L),d.map.showCollisionBoxes&&(Kd(v,d,m,w,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),Kd(v,d,m,w,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))},circle:function(v,d,m,w){if(v.renderPass!=="translucent")return;const T=m.paint.get("circle-opacity"),P=m.paint.get("circle-stroke-width"),L=m.paint.get("circle-stroke-opacity"),z=m.layout.get("circle-sort-key").constantOr(1)!==void 0;if(T.constantOr(1)===0&&(P.constantOr(1)===0||L.constantOr(1)===0))return;const U=v.context,Z=U.gl,H=v.transform,Q=v.depthModeForSublayer(0,i.DepthMode.ReadOnly),se=i.StencilMode.disabled,de=v.colorModeForRenderPass(),fe=H.projection.name==="globe",he=[i.mercatorXfromLng(H.center.lng),i.mercatorYfromLat(H.center.lat)],me=[];for(let ue=0;ue<w.length;ue++){const be=w[ue],we=d.getTile(be),Oe=we.getBucket(m);if(!Oe||Oe.projection.name!==H.projection.name)continue;const Le=Oe.programConfigurations.get(m.id),De=ty(m);fe&&De.push("PROJECTION_GLOBE_VIEW");const qe=v.useProgram("circle",Le,De),Ue=Oe.layoutVertexBuffer,Je=Oe.globeExtVertexBuffer,bt=Oe.indexBuffer,Ze=H.projection.createInversionMatrix(H,be.canonical),ut={programConfiguration:Le,program:qe,layoutVertexBuffer:Ue,globeExtVertexBuffer:Je,indexBuffer:bt,uniformValues:ey(v,be,we,Ze,he,m),tile:we};if(z){const et=Oe.segments.get();for(const xt of et)me.push({segments:new i.SegmentVector([xt]),sortKey:xt.sortKey,state:ut})}else me.push({segments:Oe.segments,sortKey:0,state:ut})}z&&me.sort((ue,be)=>ue.sortKey-be.sortKey);const te={useDepthForOcclusion:!fe};for(const ue of me){const{programConfiguration:be,program:we,layoutVertexBuffer:Oe,globeExtVertexBuffer:Le,indexBuffer:De,uniformValues:qe,tile:Ue}=ue.state,Je=ue.segments;v.terrain&&v.terrain.setupElevationDraw(Ue,we,te),v.prepareDrawProgram(U,we,Ue.tileID.toUnwrapped()),we.draw(U,Z.TRIANGLES,Q,se,de,i.CullFaceMode.disabled,qe,m.id,Oe,De,Je,m.paint,H.zoom,be,[Le])}},heatmap:function(v,d,m,w){if(m.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const T=v.context,P=T.gl,L=i.StencilMode.disabled,z=new i.ColorMode([P.ONE,P.ONE],i.Color.transparent,[!0,!0,!0,!0]);(function(de,fe,he,me){const te=de.gl,ue=fe.width*me,be=fe.height*me;de.activeTexture.set(te.TEXTURE1),de.viewport.set([0,0,ue,be]);let we=he.heatmapFbo;if(!we||we&&(we.width!==ue||we.height!==be)){we&&we.destroy();const Oe=te.createTexture();te.bindTexture(te.TEXTURE_2D,Oe),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_S,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_T,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MIN_FILTER,te.LINEAR),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MAG_FILTER,te.LINEAR),we=he.heatmapFbo=de.createFramebuffer(ue,be,!1),function(Le,De,qe,Ue,Je,bt){const Ze=Le.gl;Ze.texImage2D(Ze.TEXTURE_2D,0,Le.isWebGL2&&Le.extRenderToTextureHalfFloat?Ze.RGBA16F:Ze.RGBA,Je,bt,0,Ze.RGBA,Le.extRenderToTextureHalfFloat?Le.isWebGL2?Ze.HALF_FLOAT:Le.extTextureHalfFloat.HALF_FLOAT_OES:Ze.UNSIGNED_BYTE,null),Ue.colorAttachment.set(qe)}(de,0,Oe,we,ue,be)}else te.bindTexture(te.TEXTURE_2D,we.colorAttachment.get()),de.bindFramebuffer.set(we.framebuffer)})(T,v,m,v.transform.projection.name==="globe"?.5:.25),T.clear({color:i.Color.transparent});const U=v.transform,Z=U.projection.name==="globe",H=Z?["PROJECTION_GLOBE_VIEW"]:null,Q=Z?i.CullFaceMode.frontCCW:i.CullFaceMode.disabled,se=[i.mercatorXfromLng(U.center.lng),i.mercatorYfromLat(U.center.lat)];for(let de=0;de<w.length;de++){const fe=w[de];if(d.hasRenderableParent(fe))continue;const he=d.getTile(fe),me=he.getBucket(m);if(!me||me.projection.name!==U.projection.name)continue;const te=me.programConfigurations.get(m.id),ue=v.useProgram("heatmap",te,H),{zoom:be}=v.transform;v.terrain&&v.terrain.setupElevationDraw(he,ue),v.prepareDrawProgram(T,ue,fe.toUnwrapped());const we=U.projection.createInversionMatrix(U,fe.canonical);ue.draw(T,P.TRIANGLES,i.DepthMode.disabled,L,z,Q,g0(v,fe,he,we,se,be,m.paint.get("heatmap-intensity")),m.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,m.paint,v.transform.zoom,te,Z?[me.globeExtVertexBuffer]:null)}T.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(T,P){const L=T.context,z=L.gl,U=P.heatmapFbo;if(!U)return;L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,U.colorAttachment.get()),L.activeTexture.set(z.TEXTURE1);let Z=P.colorRampTexture;Z||(Z=P.colorRampTexture=new i.Texture(L,P.colorRamp,z.RGBA)),Z.bind(z.LINEAR,z.CLAMP_TO_EDGE),T.useProgram("heatmapTexture").draw(L,z.TRIANGLES,i.DepthMode.disabled,i.StencilMode.disabled,T.colorModeForRenderPass(),i.CullFaceMode.disabled,((H,Q,se,de)=>({u_image:0,u_color_ramp:1,u_opacity:Q.paint.get("heatmap-opacity")}))(0,P),P.id,T.viewportBuffer,T.quadTriangleIndexBuffer,T.viewportSegments,P.paint,T.transform.zoom)}(v,m))},line:function(v,d,m,w){if(v.renderPass!=="translucent")return;const T=m.paint.get("line-opacity"),P=m.paint.get("line-width");if(T.constantOr(1)===0||P.constantOr(1)===0)return;const L=v.depthModeForSublayer(0,i.DepthMode.ReadOnly),z=v.colorModeForRenderPass(),U=v.terrain&&v.terrain.renderingToTexture?1:i.exported.devicePixelRatio,Z=m.paint.get("line-dasharray"),H=Z.constantOr(1),Q=m.layout.get("line-cap"),se=m.paint.get("line-pattern"),de=se.constantOr(1),fe=m.paint.get("line-gradient"),he=de?"linePattern":"line",me=v.context,te=me.gl,ue=(we=>{const Oe=[];Zd(we)&&Oe.push("RENDER_LINE_DASH"),we.paint.get("line-gradient")&&Oe.push("RENDER_LINE_GRADIENT");const Le=we.paint.get("line-trim-offset");Le[0]===0&&Le[1]===0||Oe.push("RENDER_LINE_TRIM_OFFSET");const De=we.paint.get("line-pattern").constantOr(1),qe=we.paint.get("line-opacity").constantOr(1)!==1;return!De&&qe&&Oe.push("RENDER_LINE_ALPHA_DISCARD"),Oe})(m);let be=ue.includes("RENDER_LINE_ALPHA_DISCARD");v.terrain&&v.terrain.clipOrMaskOverlapStencilType()&&(be=!1);for(const we of w){const Oe=d.getTile(we);if(de&&!Oe.patternsLoaded())continue;const Le=Oe.getBucket(m);if(!Le)continue;v.prepareDrawTile();const De=Le.programConfigurations.get(m.id),qe=v.useProgram(he,De,ue),Ue=se.constantOr(null);if(Ue&&Oe.imageAtlas){const ct=Oe.imageAtlas.patternPositions[Ue.toString()];ct&&De.setConstantPatternPositions(ct)}const Je=Z.constantOr(null),bt=Q.constantOr(null);if(!de&&Je&&bt&&Oe.lineAtlas){const ct=Oe.lineAtlas.getDash(Je,bt);ct&&De.setConstantPatternPositions(ct)}let[Ze,ut]=m.paint.get("line-trim-offset");(bt==="round"||bt==="square")&&Ze!==ut&&(Ze===0&&(Ze-=1),ut===1&&(ut+=1));const et=v.terrain?we.projMatrix:null,xt=de?Xd(v,Oe,m,et,U):WE(v,Oe,m,et,Le.lineClipsArray.length,U,[Ze,ut]);if(fe){const ct=Le.gradients[m.id];let wt=ct.texture;if(m.gradientVersion!==ct.version){let mt=256;if(m.stepInterpolant){const St=d.getSource().maxzoom,Kt=we.canonical.z===St?Math.ceil(1<<v.transform.maxZoom-we.canonical.z):1;mt=i.clamp(i.nextPowerOfTwo(Le.maxLineLength/i.EXTENT*1024*Kt),256,me.maxTextureSize)}ct.gradient=i.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:mt,image:ct.gradient||void 0,clips:Le.lineClipsArray}),ct.texture?ct.texture.update(ct.gradient):ct.texture=new i.Texture(me,ct.gradient,te.RGBA),ct.version=m.gradientVersion,wt=ct.texture}me.activeTexture.set(te.TEXTURE1),wt.bind(m.stepInterpolant?te.NEAREST:te.LINEAR,te.CLAMP_TO_EDGE)}H&&(me.activeTexture.set(te.TEXTURE0),Oe.lineAtlasTexture.bind(te.LINEAR,te.REPEAT),De.updatePaintBuffers()),de&&(me.activeTexture.set(te.TEXTURE0),Oe.imageAtlasTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),De.updatePaintBuffers()),v.prepareDrawProgram(me,qe,we.toUnwrapped());const Ye=ct=>{qe.draw(me,te.TRIANGLES,L,ct,z,i.CullFaceMode.disabled,xt,m.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,m.paint,v.transform.zoom,De,[Le.layoutVertexBuffer2])};if(be){const ct=v.stencilModeForClipping(we).ref;ct===0&&v.terrain&&me.clear({stencil:0});const wt={func:te.EQUAL,mask:255};xt.u_alpha_discard_threshold=.8,Ye(new i.StencilMode(wt,ct,255,te.KEEP,te.KEEP,te.INVERT)),xt.u_alpha_discard_threshold=0,Ye(new i.StencilMode(wt,ct,255,te.KEEP,te.KEEP,te.KEEP))}else Ye(v.stencilModeForClipping(we))}be&&(v.resetStencilClippingMasks(),v.terrain&&me.clear({stencil:0}))},fill:function(v,d,m,w){const T=m.paint.get("fill-color"),P=m.paint.get("fill-opacity");if(P.constantOr(1)===0)return;const L=v.colorModeForRenderPass(),z=m.paint.get("fill-pattern"),U=v.opaquePassEnabledForLayer()&&!z.constantOr(1)&&T.constantOr(i.Color.transparent).a===1&&P.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===U){const Z=v.depthModeForSublayer(1,v.renderPass==="opaque"?i.DepthMode.ReadWrite:i.DepthMode.ReadOnly);b0(v,d,m,w,Z,L,!1)}if(v.renderPass==="translucent"&&m.paint.get("fill-antialias")){const Z=v.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,i.DepthMode.ReadOnly);b0(v,d,m,w,Z,L,!0)}},"fill-extrusion":function(v,d,m,w){const T=m.paint.get("fill-extrusion-opacity");if(T!==0&&v.renderPass==="translucent"){const P=new i.DepthMode(v.context.gl.LEQUAL,i.DepthMode.ReadWrite,v.depthRangeFor3D);if(T!==1||m.paint.get("fill-extrusion-pattern").constantOr(1))Vf(v,d,m,w,P,i.StencilMode.disabled,i.ColorMode.disabled),Vf(v,d,m,w,P,v.stencilModeFor3D(),v.colorModeForRenderPass()),v.resetStencilClippingMasks();else{const L=v.colorModeForRenderPass();Vf(v,d,m,w,P,i.StencilMode.disabled,L)}}},hillshade:function(v,d,m,w){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const T=v.context,P=v.depthModeForSublayer(0,i.DepthMode.ReadOnly),L=v.colorModeForRenderPass(),z=v.terrain&&v.terrain.renderingToTexture,[U,Z]=v.renderPass!=="translucent"||z?[{},w]:v.stencilConfigForOverlap(w);for(const H of Z){const Q=d.getTile(H);if(Q.needsHillshadePrepare&&v.renderPass==="offscreen")d0(v,Q,m,P,i.StencilMode.disabled,L);else if(v.renderPass==="translucent"){const se=z&&v.terrain?v.terrain.stencilModeForRTTOverlap(H):U[H.overscaledZ];u0(v,H,Q,m,P,se,L)}}T.viewport.set([0,0,v.width,v.height]),v.resetStencilClippingMasks()},raster:function(v,d,m,w,T,P){if(v.renderPass!=="translucent"||m.paint.get("raster-opacity")===0||!w.length)return;const L=v.context,z=L.gl,U=d.getSource(),Z=v.useProgram("raster"),H=v.colorModeForRenderPass(),Q=v.terrain&&v.terrain.renderingToTexture,[se,de]=U instanceof br||Q?[{},w]:v.stencilConfigForOverlap(w),fe=de[de.length-1].overscaledZ,he=!v.options.moving;for(const me of de){const te=Q?i.DepthMode.disabled:v.depthModeForSublayer(me.overscaledZ-fe,m.paint.get("raster-opacity")===1?i.DepthMode.ReadWrite:i.DepthMode.ReadOnly,z.LESS),ue=me.toUnwrapped(),be=d.getTile(me);if(Q&&(!be||!be.hasData()))continue;const we=Q?me.projMatrix:v.transform.calculateProjMatrix(ue,he),Oe=v.terrain&&Q?v.terrain.stencilModeForRTTOverlap(me):se[me.overscaledZ],Le=P?0:m.paint.get("raster-fade-duration");be.registerFadeDuration(Le);const De=d.findLoadedParent(me,0),qe=Zg(be,De,d,v.transform,Le);let Ue,Je;v.terrain&&v.terrain.prepareDrawTile();const bt=m.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;L.activeTexture.set(z.TEXTURE0),be.texture.bind(bt,z.CLAMP_TO_EDGE),L.activeTexture.set(z.TEXTURE1),De?(De.texture.bind(bt,z.CLAMP_TO_EDGE),Ue=Math.pow(2,De.tileID.overscaledZ-be.tileID.overscaledZ),Je=[be.tileID.canonical.x*Ue%1,be.tileID.canonical.y*Ue%1]):be.texture.bind(bt,z.CLAMP_TO_EDGE),be.texture.useMipmap&&L.extTextureFilterAnisotropic&&v.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax);const Ze=iy(we,Je||[0,0],Ue||1,qe,m,U instanceof br?U.perspectiveTransform:[0,0]);if(v.prepareDrawProgram(L,Z,ue),U instanceof br)U.boundsBuffer&&U.boundsSegments&&Z.draw(L,z.TRIANGLES,te,i.StencilMode.disabled,H,i.CullFaceMode.disabled,Ze,m.id,U.boundsBuffer,v.quadTriangleIndexBuffer,U.boundsSegments);else{const{tileBoundsBuffer:ut,tileBoundsIndexBuffer:et,tileBoundsSegments:xt}=v.getTileBoundsBuffers(be);Z.draw(L,z.TRIANGLES,te,Oe,H,i.CullFaceMode.disabled,Ze,m.id,ut,et,xt)}}v.resetStencilClippingMasks()},background:function(v,d,m,w){const T=m.paint.get("background-color"),P=m.paint.get("background-opacity");if(P===0)return;const L=v.context,z=L.gl,U=v.transform,Z=U.tileSize,H=m.paint.get("background-pattern");if(v.isPatternMissing(H))return;const Q=!H&&T.a===1&&P===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==Q)return;const se=i.StencilMode.disabled,de=v.depthModeForSublayer(0,Q==="opaque"?i.DepthMode.ReadWrite:i.DepthMode.ReadOnly),fe=v.colorModeForRenderPass(),he=v.useProgram(H?"backgroundPattern":"background");let me,te=w;te||(me=v.getBackgroundTiles(),te=Object.values(me).map(ue=>ue.tileID)),H&&(L.activeTexture.set(z.TEXTURE0),v.imageManager.bind(v.context));for(const ue of te){const be=ue.toUnwrapped(),we=w?ue.projMatrix:v.transform.calculateProjMatrix(be);v.prepareDrawTile();const Oe=d?d.getTile(ue):me?me[ue.key]:new i.Tile(ue,Z,U.zoom,v),Le=H?GE(we,P,v,H,{tileID:ue,tileSize:Z}):ay(we,P,T);v.prepareDrawProgram(L,he,be);const{tileBoundsBuffer:De,tileBoundsIndexBuffer:qe,tileBoundsSegments:Ue}=v.getTileBoundsBuffers(Oe);he.draw(L,z.TRIANGLES,de,se,fe,i.CullFaceMode.disabled,Le,m.id,De,qe,Ue)}},sky:function(v,d,m){const w=v.transform,T=w.projection.name==="mercator"||w.projection.name==="globe"?1:i.smoothstep(7,8,w.zoom),P=m.paint.get("sky-opacity")*T;if(P===0)return;const L=v.context,z=m.paint.get("sky-type"),U=new i.DepthMode(L.gl.LEQUAL,i.DepthMode.ReadOnly,[0,1]),Z=v.frameCounter/1e3%1;z==="atmosphere"?v.renderPass==="offscreen"?m.needsSkyboxCapture(v)&&(function(H,Q,se,de){const fe=H.context,he=fe.gl;let me=Q.skyboxFbo;if(!me){me=Q.skyboxFbo=fe.createFramebuffer(32,32,!1),Q.skyboxGeometry=new Wf(fe),Q.skyboxTexture=fe.gl.createTexture(),he.bindTexture(he.TEXTURE_CUBE_MAP,Q.skyboxTexture),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_MIN_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_MAG_FILTER,he.LINEAR);for(let we=0;we<6;++we)he.texImage2D(he.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,he.RGBA,32,32,0,he.RGBA,he.UNSIGNED_BYTE,null)}fe.bindFramebuffer.set(me.framebuffer),fe.viewport.set([0,0,32,32]);const te=Q.getCenter(H,!0),ue=H.useProgram("skyboxCapture"),be=new Float64Array(16);i.identity(be),i.rotateY(be,be,.5*-Math.PI),qo(fe,Q,ue,be,te,0),i.identity(be),i.rotateY(be,be,.5*Math.PI),qo(fe,Q,ue,be,te,1),i.identity(be),i.rotateX(be,be,.5*-Math.PI),qo(fe,Q,ue,be,te,2),i.identity(be),i.rotateX(be,be,.5*Math.PI),qo(fe,Q,ue,be,te,3),i.identity(be),qo(fe,Q,ue,be,te,4),i.identity(be),i.rotateY(be,be,Math.PI),qo(fe,Q,ue,be,te,5),fe.viewport.set([0,0,H.width,H.height])}(v,m),m.markSkyboxValid(v)):v.renderPass==="sky"&&function(H,Q,se,de,fe){const he=H.context,me=he.gl,te=H.transform,ue=H.useProgram("skybox");he.activeTexture.set(me.TEXTURE0),me.bindTexture(me.TEXTURE_CUBE_MAP,Q.skyboxTexture);const be=((we,Oe,Le,De,qe)=>({u_matrix:we,u_sun_direction:Oe,u_cubemap:0,u_opacity:De,u_temporal_offset:qe}))(te.skyboxMatrix,Q.getCenter(H,!1),0,de,fe);H.prepareDrawProgram(he,ue),ue.draw(he,me.TRIANGLES,se,i.StencilMode.disabled,H.colorModeForRenderPass(),i.CullFaceMode.backCW,be,"skybox",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(v,m,U,P,Z):z==="gradient"&&v.renderPass==="sky"&&function(H,Q,se,de,fe){const he=H.context,me=he.gl,te=H.transform,ue=H.useProgram("skyboxGradient");Q.skyboxGeometry||(Q.skyboxGeometry=new Wf(he)),he.activeTexture.set(me.TEXTURE0);let be=Q.colorRampTexture;be||(be=Q.colorRampTexture=new i.Texture(he,Q.colorRamp,me.RGBA)),be.bind(me.LINEAR,me.CLAMP_TO_EDGE);const we=((Oe,Le,De,qe,Ue)=>({u_matrix:Oe,u_color_ramp:0,u_center_direction:Le,u_radius:i.degToRad(De),u_opacity:qe,u_temporal_offset:Ue}))(te.skyboxMatrix,Q.getCenter(H,!1),Q.paint.get("sky-gradient-radius"),de,fe);H.prepareDrawProgram(he,ue),ue.draw(he,me.TRIANGLES,se,i.StencilMode.disabled,H.colorModeForRenderPass(),i.CullFaceMode.backCW,we,"skyboxGradient",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(v,m,U,P,Z)},debug:function(v,d,m){for(let w=0;w<m.length;w++)JE(v,d,m[w])},custom:function(v,d,m,w){const T=v.context,P=m.implementation;if(!v.transform.projection.unsupportedLayers||!v.transform.projection.unsupportedLayers.includes("custom")||v.terrain&&(v.terrain.renderingToTexture||v.renderPass==="offscreen")&&m.isLayerDraped()){if(v.renderPass==="offscreen"){const L=P.prerender;if(L){if(v.setCustomLayerDefaults(),T.setColorMode(v.colorModeForRenderPass()),v.transform.projection.name==="globe"){const z=v.transform.pointMerc;L.call(P,T.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),i.globeToMercatorTransition(v.transform.zoom),[z.x,z.y],v.transform.pixelsPerMeterRatio)}else L.call(P,T.gl,v.transform.customLayerMatrix());T.setDirty(),v.setBaseState()}}else if(v.renderPass==="translucent"){if(v.terrain&&v.terrain.renderingToTexture){const z=P.renderToTile;if(z){const U=w[0].canonical,Z=new i.MercatorCoordinate(U.x+w[0].wrap*(1<<U.z),U.y,U.z);T.setDepthMode(i.DepthMode.disabled),T.setStencilMode(i.StencilMode.disabled),T.setColorMode(v.colorModeForRenderPass()),v.setCustomLayerDefaults(),z.call(P,T.gl,Z),T.setDirty(),v.setBaseState()}return}v.setCustomLayerDefaults(),T.setColorMode(v.colorModeForRenderPass()),T.setStencilMode(i.StencilMode.disabled);const L=P.renderingMode==="3d"?new i.DepthMode(v.context.gl.LEQUAL,i.DepthMode.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,i.DepthMode.ReadOnly);if(T.setDepthMode(L),v.transform.projection.name==="globe"){const z=v.transform.pointMerc;P.render(T.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),i.globeToMercatorTransition(v.transform.zoom),[z.x,z.y],v.transform.pixelsPerMeterRatio)}else P.render(T.gl,v.transform.customLayerMatrix());T.setDirty(),v.setBaseState(),T.bindFramebuffer.set(null)}}else i.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class lu{constructor(d,m,w=!1){this.context=new At(d,w),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=i.SourceCache.maxUnderzooming+i.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(d,m){const w=!!d&&!!d.terrain&&this.transform.projection.supportsTerrain;if(!(w||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Yg(this,d));const T=this._terrain;this.transform.elevation=w?T:null,T.update(d,this.transform,m)}_updateFog(d){const m=d.fog;if(!m||this.transform.projection.name==="globe"||m.getOpacity(this.transform.pitch)<1||m.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[w,T]=m.getFovAdjustedRange(this.transform._fov);if(w>T)return void(this.transform.fogCullDistSq=null);const P=w+.78*(T-w);this.transform.fogCullDistSq=P*P}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(d,m){if(this.width=d*i.exported.devicePixelRatio,this.height=m*i.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const w of this.style.order)this.style._layers[w].resize()}setup(){const d=this.context,m=new i.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(i.EXTENT,0),m.emplaceBack(0,i.EXTENT),m.emplaceBack(i.EXTENT,i.EXTENT),this.tileExtentBuffer=d.createVertexBuffer(m,i.posAttributes.members),this.tileExtentSegments=i.SegmentVector.simpleSegment(0,0,4,2);const w=new i.StructArrayLayout2i4;w.emplaceBack(0,0),w.emplaceBack(i.EXTENT,0),w.emplaceBack(0,i.EXTENT),w.emplaceBack(i.EXTENT,i.EXTENT),this.debugBuffer=d.createVertexBuffer(w,i.posAttributes.members),this.debugSegments=i.SegmentVector.simpleSegment(0,0,4,5);const T=new i.StructArrayLayout2i4;T.emplaceBack(-1,-1),T.emplaceBack(1,-1),T.emplaceBack(-1,1),T.emplaceBack(1,1),this.viewportBuffer=d.createVertexBuffer(T,i.posAttributes.members),this.viewportSegments=i.SegmentVector.simpleSegment(0,0,4,2);const P=new i.StructArrayLayout4i8;P.emplaceBack(0,0,0,0),P.emplaceBack(i.EXTENT,0,i.EXTENT,0),P.emplaceBack(0,i.EXTENT,0,i.EXTENT),P.emplaceBack(i.EXTENT,i.EXTENT,i.EXTENT,i.EXTENT),this.mercatorBoundsBuffer=d.createVertexBuffer(P,i.boundsAttributes.members),this.mercatorBoundsSegments=i.SegmentVector.simpleSegment(0,0,4,2);const L=new i.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=d.createIndexBuffer(L);const z=new i.StructArrayLayout1ui2;for(const Z of[0,1,3,2,0])z.emplaceBack(Z);this.debugIndexBuffer=d.createIndexBuffer(z),this.emptyTexture=new i.Texture(d,new i.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),d.gl.RGBA),this.identityMat=i.create();const U=this.context.gl;this.stencilClearMode=new i.StencilMode({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.loadTimeStamps.push(i.window.performance.now()),this.atmosphereBuffer=new T0(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(d){return d._makeTileBoundsBuffers(this.context,this.transform.projection),d._tileBoundsBuffer?{tileBoundsBuffer:d._tileBoundsBuffer,tileBoundsIndexBuffer:d._tileBoundsIndexBuffer,tileBoundsSegments:d._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const d=this.context,m=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(d,m.TRIANGLES,i.DepthMode.disabled,this.stencilClearMode,i.ColorMode.disabled,i.CullFaceMode.disabled,Gd(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(d,m,w){if(!m||this.currentStencilSource===m.id||!d.isTileClipped()||!w||w.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let z=!1;for(const U of w)if(this._tileClippingMaskIDs[U.key]===void 0){z=!0;break}if(!z)return}this.currentStencilSource=m.id;const T=this.context,P=T.gl;this.nextStencilID+w.length>256&&this.clearStencil(),T.setColorMode(i.ColorMode.disabled),T.setDepthMode(i.DepthMode.disabled);const L=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of w){const U=m.getTile(z),Z=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,{tileBoundsBuffer:H,tileBoundsIndexBuffer:Q,tileBoundsSegments:se}=this.getTileBoundsBuffers(U);L.draw(T,P.TRIANGLES,i.DepthMode.disabled,new i.StencilMode({func:P.ALWAYS,mask:0},Z,255,P.KEEP,P.KEEP,P.REPLACE),i.ColorMode.disabled,i.CullFaceMode.disabled,Gd(z.projMatrix),"$clipping",H,Q,se)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const d=this.nextStencilID++,m=this.context.gl;return new i.StencilMode({func:m.NOTEQUAL,mask:255},d,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(d){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(d);const m=this.context.gl;return new i.StencilMode({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(d){const m=this.context.gl,w=d.sort((L,z)=>z.overscaledZ-L.overscaledZ),T=w[w.length-1].overscaledZ,P=w[0].overscaledZ-T+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const L={};for(let z=0;z<P;z++)L[z+T]=new i.StencilMode({func:m.GEQUAL,mask:255},z+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=P,[L,w]}return[{[T]:i.StencilMode.disabled},w]}colorModeForRenderPass(){const d=this.context.gl;return this._showOverdrawInspector?new i.ColorMode([d.CONSTANT_COLOR,d.ONE],new i.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?i.ColorMode.unblended:i.ColorMode.alphaBlended}depthModeForSublayer(d,m,w){if(!this.opaquePassEnabledForLayer())return i.DepthMode.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon;return new i.DepthMode(w||this.context.gl.LEQUAL,m,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(d,m){this.style=d,this.options=m,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(i.exported.now()),this.imageManager.beginFrame();const w=this.style.order,T=this.style._sourceCaches;for(const Z in T){const H=T[Z];H.used&&H.prepare(this.context)}const P={},L={},z={};for(const Z in T){const H=T[Z];P[Z]=H.getVisibleCoordinates(),L[Z]=P[Z].slice().reverse(),z[Z]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Z=0;Z<w.length;Z++)if(this.style._layers[w[Z]].is3D()){this.opaquePassCutoff=Z;break}if(this.terrain&&(this.terrain.updateTileBinding(z),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.GlobeSharedBuffers(this.context)),!i.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const Z of w){const H=this.style._layers[Z],Q=d._getLayerSourceCache(H);if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const se=Q?L[Q.id]:void 0;(H.type==="custom"||H.isSky()||se&&se.length)&&this.renderLayer(this,Q,H,se)}this.depthRangeFor3D=[0,1-(d.order.length+2)*this.numSublayers*this.depthEpsilon];const U=this.terrain;if(U&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&U.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:m.showOverdrawInspector?i.Color.black:i.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const Z=this.style._layers[w[this.currentLayer]],H=d._getLayerSourceCache(Z);if(Z.isSky())continue;const Q=H?L[H.id]:void 0;this._renderTileClippingMasks(Z,H,Q),this.renderLayer(this,H,Z,Q)}if(this.style.fog&&this.transform.projection.supportsFog&&function(Z,H){const Q=Z.context,se=Q.gl,de=Z.transform,fe=new i.DepthMode(se.LEQUAL,i.DepthMode.ReadOnly,[0,1]),he=Z.useProgram("globeAtmosphere",null,de.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),me=i.globeToMercatorTransition(de.zoom),te=H.properties.get("color").toArray01(),ue=H.properties.get("high-color").toArray01(),be=H.properties.get("space-color").toArray01PremultipliedAlpha(),we=i.identity$1([]);i.rotateY$1(we,we,-i.degToRad(de._center.lng)),i.rotateX$1(we,we,i.degToRad(de._center.lat)),i.rotateZ$1(we,we,de.angle),i.rotateX$1(we,we,-de._pitch);const Oe=i.fromQuat(new Float32Array(16),we),Le=i.mapValue(H.properties.get("star-intensity"),0,1,0,.25),De=5e-4,qe=i.mapValue(H.properties.get("horizon-blend"),0,1,De,.25),Ue=i.globeUseCustomAntiAliasing(Z,Q,de)&&qe===De?de.worldSize/(2*Math.PI*1.025)-1:de.globeRadius,Je=Z.frameCounter/1e3%1,bt=i.length(de.globeCenterInViewSpace),Ze=Math.sqrt(Math.pow(bt,2)-Math.pow(Ue,2)),ut=Math.acos(Ze/bt),et=((Ye,ct,wt,mt,St,Kt,sr,Ut,ir,Tr,wr,Zt,Hr,Jr)=>({u_frustum_tl:Ye,u_frustum_tr:ct,u_frustum_br:wt,u_frustum_bl:mt,u_horizon:St,u_transition:Kt,u_fadeout_range:sr,u_color:Ut,u_high_color:ir,u_space_color:Tr,u_star_intensity:wr,u_star_size:5*i.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Zt,u_horizon_angle:Hr,u_rotation_matrix:Jr}))(de.frustumCorners.TL,de.frustumCorners.TR,de.frustumCorners.BR,de.frustumCorners.BL,de.frustumCorners.horizon,me,qe,te,ue,be,Le,Je,ut,Oe);Z.prepareDrawProgram(Q,he);const xt=Z.atmosphereBuffer;xt&&he.draw(Q,se.TRIANGLES,fe,i.StencilMode.disabled,i.ColorMode.alphaBlended,i.CullFaceMode.backCW,et,"skybox",xt.vertexBuffer,xt.indexBuffer,xt.segments)}(this,this.style.fog),this.renderPass="sky",(i.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const Z=this.style._layers[w[this.currentLayer]],H=d._getLayerSourceCache(Z);Z.isSky()&&this.renderLayer(this,H,Z,H?L[H.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<w.length;){const Z=this.style._layers[w[this.currentLayer]],H=d._getLayerSourceCache(Z);if(Z.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(Z)){if(Z.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Q=H?(Z.type==="symbol"?z:L)[H.id]:void 0;this._renderTileClippingMasks(Z,H,H?P[H.id]:void 0),this.renderLayer(this,H,Z,Q),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Z=null;i.values(this.style._layers).forEach(H=>{const Q=d._getLayerSourceCache(H);Q&&!H.isHidden(this.transform.zoom)&&(!Z||Z.getSource().maxzoom<Q.getSource().maxzoom)&&(Z=Q)}),Z&&this.options.showTileBoundaries&&Xl.debug(this,Z,Z.getVisibleCoordinates())}this.options.showPadding&&function(Z){const H=Z.transform.padding;w0(Z,Z.transform.height-(H.top||0),3,au),w0(Z,H.bottom||0,3,XE),qf(Z,H.left||0,3,ZE),qf(Z,Z.transform.width-(H.right||0),3,KE);const Q=Z.transform.centerPoint;(function(se,de,fe,he){su(se,de-1,fe-10,2,20,he),su(se,de-10,fe-1,20,2,he)})(Z,Q.x,Z.transform.height-Q.y,YE)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(i.window.performance.now()),this.saveCanvasCopy())}renderLayer(d,m,w,T){w.isHidden(this.transform.zoom)||(w.type==="background"||w.type==="sky"||w.type==="custom"||T&&T.length)&&(this.id=w.id,this.gpuTimingStart(w),(!d.transform.projection.unsupportedLayers||!d.transform.projection.unsupportedLayers.includes(w.type)||d.terrain&&w.type==="custom")&&Xl[w.type](d,m,w,T,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(d){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery;let w=this.gpuTimers[d.id];w||(w=this.gpuTimers[d.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),w.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,w.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const d=this.context.extTimerQuery,m=d.createQueryEXT();this.deferredRenderGpuTimeQueries.push(m),d.beginQueryEXT(d.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}collectGpuTimers(){const d=this.gpuTimers;return this.gpuTimers={},d}collectDeferredRenderGpuQueries(){const d=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],d}queryGpuTimers(d){const m={};for(const w in d){const T=d[w],P=this.context.extTimerQuery,L=P.getQueryObjectEXT(T.query,P.QUERY_RESULT_EXT)/1e6;P.deleteQueryEXT(T.query),m[w]=L}return m}queryGpuTimeDeferredRender(d){if(!this.options.gpuTimingDeferredRender)return 0;const m=this.context.extTimerQuery;let w=0;for(const T of d)w+=m.getQueryObjectEXT(T,m.QUERY_RESULT_EXT)/1e6,m.deleteQueryEXT(T);return w}translatePosMatrix(d,m,w,T,P){if(!w[0]&&!w[1])return d;const L=P?T==="map"?this.transform.angle:0:T==="viewport"?-this.transform.angle:0;if(L){const Z=Math.sin(L),H=Math.cos(L);w=[w[0]*H-w[1]*Z,w[0]*Z+w[1]*H]}const z=[P?w[0]:Be(m,w[0],this.transform.zoom),P?w[1]:Be(m,w[1],this.transform.zoom),0],U=new Float32Array(16);return i.translate(U,d,z),U}saveTileTexture(d){const m=this._tileTextures[d.size[0]];m?m.push(d):this._tileTextures[d.size[0]]=[d]}getTileTexture(d){const m=this._tileTextures[d];return m&&m.length>0?m.pop():null}isPatternMissing(d){return d===null||d!==void 0&&!this.imageManager.getPattern(d.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const d=this.terrain&&this.terrain.renderingToTexture,m=this.terrain&&this.terrain.exaggeration()===0,w=this.style&&this.style.fog,T=[];return this.terrainRenderModeElevated()&&T.push("TERRAIN"),this.transform.projection.name==="globe"&&T.push("GLOBE"),m&&T.push("ZERO_EXAGGERATION"),w&&!d&&w.getOpacity(this.transform.pitch)!==0&&T.push("FOG"),d&&T.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&T.push("OVERDRAW_INSPECTOR"),T}useProgram(d,m,w){this.cache=this.cache||{};const T=w||[],P=this.currentGlobalDefines().concat(T),L=kr.cacheKey(Wg[d],d,P,m);return this.cache[L]||(this.cache[L]=new kr(this.context,d,Wg[d],m,sy[d],P)),this.cache[L]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=i.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(d,m,w){if(this.terrain&&this.terrain.renderingToTexture)return;const T=this.style.fog;if(T){const P=T.getOpacity(this.transform.pitch),L=((z,U,Z,H,Q,se,de,fe,he,me,te)=>{const ue=z.transform,be=U.properties.get("color").toArray01();be[3]=H;const we=z.frameCounter/1e3%1;return{u_fog_matrix:Z?ue.calculateFogTileMatrix(Z):z.identityMat,u_fog_range:U.getFovAdjustedRange(ue._fov),u_fog_color:be,u_fog_horizon_blend:U.properties.get("horizon-blend"),u_fog_temporal_offset:we,u_frustum_tl:Q,u_frustum_tr:se,u_frustum_br:de,u_frustum_bl:fe,u_globe_pos:he,u_globe_radius:me,u_viewport:te,u_globe_transition:i.globeToMercatorTransition(ue.zoom),u_is_globe:+(ue.projection.name==="globe")}})(this,T,w,P,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.exported.devicePixelRatio,this.transform.height*i.exported.devicePixelRatio]);m.setFogUniformValues(d,L)}}setTileLoadedFlag(d){this.tileLoaded=d}saveCanvasCopy(){const d=this.canvasCopy();d&&(this.frameCopies.push(d),this.tileLoaded=!1)}canvasCopy(){const d=this.context.gl,m=d.createTexture();return d.bindTexture(d.TEXTURE_2D,m),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGBA,0,0,d.drawingBufferWidth,d.drawingBufferHeight,0),m}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const d=this.style&&this.style.fog;return!!d&&d.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const d=this._backgroundTiles,m=this._backgroundTiles={},w=this.transform.coveringTiles({tileSize:512});for(const T of w)m[T.key]=d[T.key]||new i.Tile(T,512,this.transform.tileZoom,this);return m}clearBackgroundTiles(){this._backgroundTiles={}}}class Gf{constructor(d=0,m=0,w=0,T=0){if(isNaN(d)||d<0||isNaN(m)||m<0||isNaN(w)||w<0||isNaN(T)||T<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=m,this.left=w,this.right=T}interpolate(d,m,w){return m.top!=null&&d.top!=null&&(this.top=i.number(d.top,m.top,w)),m.bottom!=null&&d.bottom!=null&&(this.bottom=i.number(d.bottom,m.bottom,w)),m.left!=null&&d.left!=null&&(this.left=i.number(d.left,m.left,w)),m.right!=null&&d.right!=null&&(this.right=i.number(d.right,m.right,w)),this}getCenter(d,m){const w=i.clamp((this.left+d-this.right)/2,0,d),T=i.clamp((this.top+m-this.bottom)/2,0,m);return new i.Point(w,T)}equals(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right}clone(){return new Gf(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Hf(v,d){const m=i.getColumn(v,3);i.fromQuat(v,d),i.setColumn(v,3,m)}function Ir(v,d){const m=i.identity$1([]);return i.rotateZ$1(m,m,-d),i.rotateX$1(m,m,-v),m}function Qd(v,d){const m=[v[0],v[1],0],w=[d[0],d[1],0];if(i.length(m)>=1e-15){const L=i.normalize([],m);i.scale$2(w,L,i.dot(w,L)),d[0]=w[0],d[1]=w[1]}const T=i.cross([],d,v);if(i.len(T)<1e-15)return null;const P=Math.atan2(-T[1],T[0]);return Ir(Math.atan2(Math.sqrt(v[0]*v[0]+v[1]*v[1]),-v[2]),P)}class j0{constructor(d,m){this.position=d,this.orientation=m}get position(){return this._position}set position(d){if(d){const m=d instanceof i.MercatorCoordinate?d:new i.MercatorCoordinate(d[0],d[1],d[2]);this._renderWorldCopies&&(m.x=i.wrap(m.x,0,1)),this._position=m}else this._position=null}lookAtPoint(d,m){if(this.orientation=null,!this.position)return;const w=this.position,T=this._elevation?this._elevation.getAtPointOrZero(i.MercatorCoordinate.fromLngLat(d)):0,P=i.MercatorCoordinate.fromLngLat(d,T),L=[P.x-w.x,P.y-w.y,P.z-w.z];m||(m=[0,0,1]),m[2]=Math.abs(m[2]),this.orientation=Qd(L,m)}setPitchBearing(d,m){this.orientation=Ir(i.degToRad(d),i.degToRad(-m))}}class Xf{constructor(d,m){this._transform=i.identity([]),this.orientation=m,this.position=d}get mercatorPosition(){const d=this.position;return new i.MercatorCoordinate(d[0],d[1],d[2])}get position(){const d=i.getColumn(this._transform,3);return[d[0],d[1],d[2]]}set position(d){var m;d&&i.setColumn(this._transform,3,[(m=d)[0],m[1],m[2],1])}get orientation(){return this._orientation}set orientation(d){this._orientation=d||i.identity$1([]),d&&Hf(this._transform,this._orientation)}getPitchBearing(){const d=this.forward(),m=this.right();return{bearing:Math.atan2(-m[1],m[0]),pitch:Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2])}}setPitchBearing(d,m){this._orientation=Ir(d,m),Hf(this._transform,this._orientation)}forward(){const d=i.getColumn(this._transform,2);return[-d[0],-d[1],-d[2]]}up(){const d=i.getColumn(this._transform,1);return[-d[0],-d[1],-d[2]]}right(){const d=i.getColumn(this._transform,0);return[d[0],d[1],d[2]]}getCameraToWorld(d,m){const w=new Float64Array(16);return i.invert(w,this.getWorldToCamera(d,m)),w}getWorldToCameraPosition(d,m,w){const T=this.position;i.scale$2(T,T,-d);const P=new Float64Array(16);return i.fromScaling(P,[w,w,w]),i.translate(P,P,T),P[10]*=m,P}getWorldToCamera(d,m){const w=new Float64Array(16),T=new Float64Array(4),P=this.position;return i.conjugate(T,this._orientation),i.scale$2(P,P,-d),i.fromQuat(w,T),i.translate(w,w,P),w[1]*=-1,w[5]*=-1,w[9]*=-1,w[13]*=-1,w[8]*=m,w[9]*=m,w[10]*=m,w[11]*=m,w}getCameraToClipPerspective(d,m,w,T){const P=new Float64Array(16);return i.perspective(P,d,m,w,T),P}getDistanceToElevation(d,m=!1){const w=d===0?0:i.mercatorZfromAltitude(d,m?i.latFromMercatorY(this.position[1]):this.position[1]),T=this.forward();return(w-this.position[2])/T[2]}clone(){return new Xf([...this.position],[...this.orientation])}}function cu(v,d){const m=Zf(v.projection,v.zoom,v.width,v.height),w=function(P,L,z,U,Z){const H=new i.LngLat(z.lng-180*xs,z.lat),Q=new i.LngLat(z.lng+180*xs,z.lat),se=P.project(H.lng,H.lat),de=P.project(Q.lng,Q.lat),fe=-Math.atan2(de.y-se.y,de.x-se.x),he=i.MercatorCoordinate.fromLngLat(z);he.y=i.clamp(he.y,-1+xs,1-xs);const me=he.toLngLat(),te=P.project(me.lng,me.lat),ue=i.MercatorCoordinate.fromLngLat(me);ue.x+=xs;const be=ue.toLngLat(),we=P.project(be.lng,be.lat),Oe=Kf(we.x-te.x,we.y-te.y,fe),Le=i.MercatorCoordinate.fromLngLat(me);Le.y+=xs;const De=Le.toLngLat(),qe=P.project(De.lng,De.lat),Ue=Kf(qe.x-te.x,qe.y-te.y,fe),Je=Math.abs(Oe.x)/Math.abs(Ue.y),bt=i.identity([]);i.rotateZ(bt,bt,-fe*(1-(Z?0:U)));const Ze=i.identity([]);return i.scale(Ze,Ze,[1,1-(1-Je)*U,1]),Ze[4]=-Ue.x/Ue.y*U,i.rotateZ(Ze,Ze,fe),i.multiply(Ze,bt,Ze),Ze}(v.projection,0,v.center,m,d),T=C0(v);return i.scale(w,w,[T,T,1]),w}function C0(v){const d=v.projection,m=Zf(v.projection,v.zoom,v.width,v.height),w=P0(d,v.center),T=P0(d,i.LngLat.convert(d.center));return Math.pow(2,w*m+(1-m)*T)}function Zf(v,d,m,w,T=1/0){const P=v.range;if(!P)return 0;const L=Math.min(T,Math.max(m,w)),z=Math.log(L/1024)/Math.LN2;return i.smoothstep(P[0]+z,P[1]+z,d)}const xs=1/4e4;function P0(v,d){const m=i.clamp(d.lat,-i.MAX_MERCATOR_LATITUDE,i.MAX_MERCATOR_LATITUDE),w=new i.LngLat(d.lng-180*xs,m),T=new i.LngLat(d.lng+180*xs,m),P=v.project(w.lng,m),L=v.project(T.lng,m),z=i.MercatorCoordinate.fromLngLat(w),U=i.MercatorCoordinate.fromLngLat(T),Z=L.x-P.x,H=L.y-P.y,Q=U.x-z.x,se=U.y-z.y,de=Math.sqrt((Q*Q+se*se)/(Z*Z+H*H));return Math.log(de)/Math.LN2}function Kf(v,d,m){const w=Math.cos(m),T=Math.sin(m);return{x:v*w-d*T,y:v*T+d*w}}class uu{constructor(d,m,w,T,P,L,z){this.tileSize=512,this._renderWorldCopies=P===void 0||P,this._minZoom=d||0,this._maxZoom=m||22,this._minPitch=w??0,this._maxPitch=T??60,this.setProjection(L),this.setMaxBounds(z),this.width=0,this.height=0,this._center=new i.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Gf,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Xf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const d=new uu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return d._elevation=this._elevation,d._centerAltitude=this._centerAltitude,d._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,d.tileSize=this.tileSize,d.mercatorFromTransition=this.mercatorFromTransition,d.width=this.width,d.height=this.height,d.cameraElevationReference=this.cameraElevationReference,d._center=this._center,d._setZoom(this.zoom),d._seaLevelZoom=this._seaLevelZoom,d.angle=this.angle,d._fov=this._fov,d._pitch=this._pitch,d._nearZ=this._nearZ,d._farZ=this._farZ,d._averageElevation=this._averageElevation,d._unmodified=this._unmodified,d._edgeInsets=this._edgeInsets.clone(),d._camera=this._camera.clone(),d._calcMatrices(),d.freezeTileCoverage=this.freezeTileCoverage,d.frustumCorners=this.frustumCorners,d}get elevation(){return this._elevation}set elevation(d){this._elevation!==d&&(this._elevation=d,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(d,m=!1){const w=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||w)&&this._updateCameraOnTerrain(),(d||w)&&this._constrainCamera(m),this._calcMatrices()}getProjection(){return i.pick(this.projection,["name","center","parallels"])}setProjection(d){this.projectionOptions=d||{name:"mercator"};const m=this.projection?this.getProjection():void 0;this.projection=i.getProjection(this.projectionOptions);const w=!p(m,this.getProjection());return w&&this._calcMatrices(),this.mercatorFromTransition=!1,w}setMercatorFromTransition(){const d=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.getProjection({name:"mercator"});const m=d!==this.projection.name;return m&&this._calcMatrices(),m}get minZoom(){return this._minZoom}set minZoom(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))}get maxZoom(){return this._maxZoom}set maxZoom(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))}get minPitch(){return this._minPitch}set minPitch(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))}get maxPitch(){return this._maxPitch}set maxPitch(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(d){d===void 0?d=!0:d===null&&(d=!1),this._renderWorldCopies=d}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get cameraWorldSize(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.Point(this.width,this.height)}get bearing(){return i.wrap(this.rotation,-180,180)}set bearing(d){this.rotation=d}get rotation(){return-this.angle/Math.PI*180}set rotation(d){const m=-d*Math.PI/180;var w;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=(w=new i.ARRAY_TYPE(4),i.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w),function(T,P,L){var z=P[0],U=P[1],Z=P[2],H=P[3],Q=Math.sin(L),se=Math.cos(L);T[0]=z*se+Z*Q,T[1]=U*se+H*Q,T[2]=z*-Q+Z*se,T[3]=U*-Q+H*se}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(d){const m=i.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const d=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/d)}set fov(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=i.degToRad(d),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(d){this._averageElevation=d,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(d){const m=Math.min(Math.max(d,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._setZoom(m),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(d){this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const d=this._elevation;this._centerAltitude=d.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=d.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const d=this._elevation,m=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],w=this.horizonLineFromTop();let T=0,P=0;for(let L=0;L<m.length;L++){const z=new i.Point(m[L][0]*this.width,w+m[L][1]*(this.height-w)),U=d.pointCoordinate(z);if(!U)continue;const Z=1/Math.hypot(U[0]-this._camera.position[0],U[1]-this._camera.position[1]);T+=U[3]*Z,P+=Z}return P===0?NaN:T/P}get center(){return this._center}set center(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const d=this._seaLevelZoom,m=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),w=this.pixelsPerMeter/this.worldSize*m,T=this._mercatorZfromZoom(d),P=this._mercatorZfromZoom(this._maxZoom),L=Math.max(T-w,P);this._setZoom(this._zoomFromMercatorZ(L))}get padding(){return this._edgeInsets.toJSON()}set padding(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())}computeZoomRelativeTo(d){const m=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,d.toAltitude()));let w;w=d.z<this._camera.position[2]?[m.x,m.y,m.z]:[d.x,d.y,d.z];const T=i.length(i.sub([],this._camera.position,w));return i.clamp(this._zoomFromMercatorZ(T),this._minZoom,this._maxZoom)}setFreeCameraOptions(d){if(!this.height||!d.position&&!d.orientation)return;this._updateCameraState();let m=!1;if(d.orientation&&!i.exactEquals(d.orientation,this._camera.orientation)&&(m=this._setCameraOrientation(d.orientation)),d.position){const w=[d.position.x,d.position.y,d.position.z];i.exactEquals$1(w,this._camera.position)||(this._setCameraPosition(w),m=!0)}m&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const d=this._camera.position,m=new j0;return m.position=new i.MercatorCoordinate(d[0],d[1],d[2]),m.orientation=this._camera.orientation,m._elevation=this.elevation,m._renderWorldCopies=this.renderWorldCopies,m}_setCameraOrientation(d){if(!i.length$1(d))return!1;i.normalize$1(d,d);const m=i.transformQuat([],[0,0,-1],d),w=i.transformQuat([],[0,-1,0],d);if(w[2]<0)return!1;const T=Qd(m,w);return!!T&&(this._camera.orientation=T,!0)}_setCameraPosition(d){const m=this.zoomScale(this.minZoom)*this.tileSize,w=this.zoomScale(this.maxZoom)*this.tileSize,T=this.cameraToCenterDistance;d[2]=i.clamp(d[2],T/w,T/m),this._camera.position=d}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(d){return this._edgeInsets.equals(d)}interpolatePadding(d,m,w){this._unmodified=!1,this._edgeInsets.interpolate(d,m,w),this._constrain(),this._calcMatrices()}coveringZoomLevel(d){const m=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(d){const m=[new i.UnwrappedTileID(0,d)];if(this.renderWorldCopies){const w=this.pointCoordinate(new i.Point(0,0)),T=this.pointCoordinate(new i.Point(this.width,0)),P=this.pointCoordinate(new i.Point(this.width,this.height)),L=this.pointCoordinate(new i.Point(0,this.height)),z=Math.floor(Math.min(w.x,T.x,P.x,L.x)),U=Math.floor(Math.max(w.x,T.x,P.x,L.x)),Z=1;for(let H=z-Z;H<=U+Z;H++)H!==0&&m.push(new i.UnwrappedTileID(H,d))}return m}coveringTiles(d){let m=this.coveringZoomLevel(d);const w=m,T=this.elevation&&!d.isTerrainDEM,P=this.projection.name==="mercator";if(d.minzoom!==void 0&&m<d.minzoom)return[];d.maxzoom!==void 0&&m>d.maxzoom&&(m=d.maxzoom);const L=this.locationCoordinate(this.center),z=this.center.lat,U=1<<m,Z=[U*L.x,U*L.y,0],H=this.projection.name==="globe",Q=!H,se=i.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m,Q),de=H?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),fe=U*i.mercatorZfromAltitude(1,this.center.lat),he=this._camera.position[2]/i.mercatorZfromAltitude(1,this.center.lat),me=[U*de.x,U*de.y,he*(Q?1:fe)],te=this.cameraToCenterDistance/d.tileSize*(d.roundZoom?1:.502),ue=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?m:0,be=d.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,we=d.isTerrainDEM?-be:this._elevation?this._elevation.getMinElevationBelowMSL():0,Oe=this.projection.isReprojectedInTileSpace?C0(this):1,Le=Ye=>{const wt=new i.MercatorCoordinate(Ye.x+25e-6,Ye.y,Ye.z),mt=new i.MercatorCoordinate(Ye.x,Ye.y+25e-6,Ye.z),St=Ye.toLngLat(),Kt=wt.toLngLat(),sr=mt.toLngLat(),Ut=this.locationCoordinate(St),ir=this.locationCoordinate(Kt),Tr=this.locationCoordinate(sr),wr=Math.hypot(ir.x-Ut.x,ir.y-Ut.y),Zt=Math.hypot(Tr.x-Ut.x,Tr.y-Ut.y);return Math.sqrt(wr*Zt)*Oe/25e-6},De=Ye=>{const ct=be,wt=we;return{aabb:i.tileAABB(this,U,0,0,0,Ye,wt,ct,this.projection),zoom:0,x:0,y:0,minZ:wt,maxZ:ct,wrap:Ye,fullyVisible:!1}},qe=[];let Ue=[];const Je=m,bt=d.reparseOverscaled?w:m,Ze=Ye=>Ye*Ye,ut=Ze((he-this._centerAltitude)*fe),et=Ye=>{if(!this._elevation||!Ye.tileID||!P)return;const ct=this._elevation.getMinMaxForTile(Ye.tileID),wt=Ye.aabb;ct?(wt.min[2]=ct.min,wt.max[2]=ct.max,wt.center[2]=(wt.min[2]+wt.max[2])/2):(Ye.shouldSplit=xt(Ye),Ye.shouldSplit||(wt.min[2]=wt.max[2]=wt.center[2]=this._centerAltitude))},xt=Ye=>{if(Ye.zoom<ue)return!0;if(Ye.zoom===Je)return!1;if(Ye.shouldSplit!=null)return Ye.shouldSplit;const ct=Ye.aabb.distanceX(me),wt=Ye.aabb.distanceY(me);let mt=ut,St=1;if(H){mt=Ze(Ye.aabb.distanceZ(me));const Ut=Math.pow(2,Ye.zoom),ir=i.latFromMercatorY((Ye.y+1)/Ut),Tr=i.latFromMercatorY(Ye.y/Ut),wr=Math.min(Math.max(z,ir),Tr),Zt=i.circumferenceAtLatitude(wr)/i.circumferenceAtLatitude(z);if(St=wr===z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Zt/this._mercatorScaleRatio),this.zoom<=i.GLOBE_ZOOM_THRESHOLD_MIN&&Ye.zoom===Je-1&&Zt>=.9)return!0}else if(T&&(mt=Ze(Ye.aabb.distanceZ(me)*fe)),this.projection.isReprojectedInTileSpace&&w<=5){const Ut=Math.pow(2,Ye.zoom),ir=Le(new i.MercatorCoordinate((Ye.x+.5)/Ut,(Ye.y+.5)/Ut));St=ir>.85?1:ir}const Kt=ct*ct+wt*wt+mt,sr=Ze((1<<Je-Ye.zoom)*te*St*((Ut,ir)=>{if(ir*Ze(.707)<Ut)return 1;const Tr=Math.sqrt(ir/Ut);return Tr/(1.4144271570014144+(Math.pow(1.1,Tr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(mt,ut),Kt));return Kt<sr};if(this.renderWorldCopies)for(let Ye=1;Ye<=3;Ye++)qe.push(De(-Ye)),qe.push(De(Ye));for(qe.push(De(0));qe.length>0;){const Ye=qe.pop(),ct=Ye.x,wt=Ye.y;let mt=Ye.fullyVisible;if(!mt){const St=Ye.aabb.intersects(se);if(St===0)continue;mt=St===2}if(Ye.zoom!==Je&&xt(Ye))for(let St=0;St<4;St++){const Kt=(ct<<1)+St%2,sr=(wt<<1)+(St>>1),Ut={aabb:P?Ye.aabb.quadrant(St):i.tileAABB(this,U,Ye.zoom+1,Kt,sr,Ye.wrap,Ye.minZ,Ye.maxZ,this.projection),zoom:Ye.zoom+1,x:Kt,y:sr,wrap:Ye.wrap,fullyVisible:mt,tileID:void 0,shouldSplit:void 0,minZ:Ye.minZ,maxZ:Ye.maxZ};T&&!H&&(Ut.tileID=new i.OverscaledTileID(Ye.zoom+1===Je?bt:Ye.zoom+1,Ye.wrap,Ye.zoom+1,Kt,sr),et(Ut)),qe.push(Ut)}else{const St=Ye.zoom===Je?bt:Ye.zoom;if(d.minzoom&&d.minzoom>St)continue;const Kt=Z[0]-(.5+ct+(Ye.wrap<<Ye.zoom))*(1<<m-Ye.zoom),sr=Z[1]-.5-wt,Ut=Ye.tileID?Ye.tileID:new i.OverscaledTileID(St,Ye.wrap,Ye.zoom,ct,wt);Ue.push({tileID:Ut,distanceSq:Kt*Kt+sr*sr})}}if(this.fogCullDistSq){const Ye=this.fogCullDistSq,ct=this.horizonLineFromTop();Ue=Ue.filter(wt=>{const mt=[0,0,0,1],St=[i.EXTENT,i.EXTENT,0,1],Kt=this.calculateFogTileMatrix(wt.tileID.toUnwrapped());i.transformMat4$1(mt,mt,Kt),i.transformMat4$1(St,St,Kt);const sr=i.getAABBPointSquareDist(mt,St);if(sr===0)return!0;let Ut=!1;const ir=this._elevation;if(ir&&sr>Ye&&ct!==0){const Tr=this.calculateProjMatrix(wt.tileID.toUnwrapped());let wr;d.isTerrainDEM||(wr=ir.getMinMaxForTile(wt.tileID)),wr||(wr={min:we,max:be});const Zt=i.furthestTileCorner(this.rotation),Hr=[Zt[0]*i.EXTENT,Zt[1]*i.EXTENT,wr.max];i.transformMat4(Hr,Hr,Tr),Ut=(1-Hr[1])*this.height*.5<ct}return sr<Ye||Ut})}return Ue.sort((Ye,ct)=>Ye.distanceSq-ct.distanceSq).map(Ye=>Ye.tileID)}resize(d,m){this.width=d,this.height=m,this.pixelsToGLUnits=[2/d,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(d){return Math.pow(2,d)}scaleZoom(d){return Math.log(d)/Math.LN2}project(d){const m=i.clamp(d.lat,-i.MAX_MERCATOR_LATITUDE,i.MAX_MERCATOR_LATITUDE),w=this.projection.project(d.lng,m);return new i.Point(w.x*this.worldSize,w.y*this.worldSize)}unproject(d){return this.projection.unproject(d.x/this.worldSize,d.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(d,m){let w,T;const P=this.centerPoint;if(this.projection.name==="globe"){const z=this.worldSize;w=(m.x-P.x)/z,T=(m.y-P.y)/z}else{const z=this.pointCoordinate(m),U=this.pointCoordinate(P);w=z.x-U.x,T=z.y-U.y}const L=this.locationCoordinate(d);this.setLocation(new i.MercatorCoordinate(L.x-w,L.y-T))}setLocation(d){this.center=this.coordinateLocation(d),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(d){return this.projection.locationPoint(this,d)}locationPoint3D(d){return this.projection.locationPoint(this,d,!0)}pointLocation(d){return this.coordinateLocation(this.pointCoordinate(d))}pointLocation3D(d){return this.coordinateLocation(this.pointCoordinate3D(d))}locationCoordinate(d,m){const w=m?i.mercatorZfromAltitude(m,d.lat):void 0,T=this.projection.project(d.lng,d.lat);return new i.MercatorCoordinate(T.x,T.y,w)}coordinateLocation(d){return this.projection.unproject(d.x,d.y)}pointRayIntersection(d,m){const w=m??this._centerAltitude,T=[d.x,d.y,0,1],P=[d.x,d.y,1,1];i.transformMat4$1(T,T,this.pixelMatrixInverse),i.transformMat4$1(P,P,this.pixelMatrixInverse);const L=P[3];i.scale$1(T,T,1/T[3]),i.scale$1(P,P,1/L);const z=T[2],U=P[2];return{p0:T,p1:P,t:z===U?0:(w-z)/(U-z)}}screenPointToMercatorRay(d){const m=[d.x,d.y,0,1],w=[d.x,d.y,1,1];return i.transformMat4$1(m,m,this.pixelMatrixInverse),i.transformMat4$1(w,w,this.pixelMatrixInverse),i.scale$1(m,m,1/m[3]),i.scale$1(w,w,1/w[3]),m[2]=i.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,w[2]=i.mercatorZfromAltitude(w[2],this._center.lat)*this.worldSize,i.scale$1(m,m,1/this.worldSize),i.scale$1(w,w,1/this.worldSize),new i.Ray([m[0],m[1],m[2]],i.normalize([],i.sub([],w,m)))}rayIntersectionCoordinate(d){const{p0:m,p1:w,t:T}=d,P=i.mercatorZfromAltitude(m[2],this._center.lat),L=i.mercatorZfromAltitude(w[2],this._center.lat);return new i.MercatorCoordinate(i.number(m[0],w[0],T)/this.worldSize,i.number(m[1],w[1],T)/this.worldSize,i.number(P,L,T))}pointCoordinate(d,m=this._centerAltitude){return this.projection.pointCoordinate(this,d.x,d.y,m)}pointCoordinate3D(d){if(!this.elevation)return this.pointCoordinate(d);let m=this.projection.pointCoordinate3D(this,d.x,d.y);if(m)return new i.MercatorCoordinate(m[0],m[1],m[2]);let w=0,T=this.horizonLineFromTop();if(d.y>T)return this.pointCoordinate(d);const P=.02*T,L=d.clone();for(let z=0;z<10&&T-w>P;z++){L.y=i.number(w,T,.66);const U=this.projection.pointCoordinate3D(this,L.x,L.y);U?(T=L.y,m=U):w=L.y}return m?new i.MercatorCoordinate(m[0],m[1],m[2]):this.pointCoordinate(d)}isPointAboveHorizon(d){return this.projection.isPointAboveHorizon(this,d)}isPointOnSurface(d){if(d.y<0||d.y>this.height||d.x<0||d.x>this.width)return!1;if(this.elevation||this.zoom>=i.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(d);const m=this.pointCoordinate(d);return m.y>=0&&m.y<=1}_coordinatePoint(d,m){const w=m&&this.elevation?this.elevation.getAtPointOrZero(d,this._centerAltitude):this._centerAltitude,T=[d.x*this.worldSize,d.y*this.worldSize,w+d.toAltitude(),1];return i.transformMat4$1(T,T,this.pixelMatrix),T[3]>0?new i.Point(T[0]/T[3],T[1]/T[3]):new i.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:d,left:m}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,T=this.width-this._edgeInsets.right,P=this.pointLocation3D(new i.Point(m,d)),L=this.pointLocation3D(new i.Point(T,d)),z=this.pointLocation3D(new i.Point(T,w)),U=this.pointLocation3D(new i.Point(m,w));let Z=Math.min(P.lng,L.lng,z.lng,U.lng),H=Math.max(P.lng,L.lng,z.lng,U.lng),Q=Math.min(P.lat,L.lat,z.lat,U.lat),se=Math.max(P.lat,L.lat,z.lat,U.lat);const de=Math.pow(2,-this.zoom)/16*270,fe=this.projection.name==="globe"?1:4,he=(me,te,ue,be,we)=>{const Oe=(me+ue)/2,Le=(te+be)/2,De=new i.Point(Oe,Le),{lng:qe,lat:Ue}=this.pointLocation3D(De),Je=Math.max(0,Z-qe,Q-Ue,qe-H,Ue-se);Z=Math.min(Z,qe),H=Math.max(H,qe),Q=Math.min(Q,Ue),se=Math.max(se,Ue),(we<fe||Je>de)&&(he(me,te,Oe,Le,we+1),he(Oe,Le,ue,be,we+1))};if(he(m,d,T,d,1),he(T,d,T,w,1),he(T,w,m,w,1),he(m,w,m,d,1),this.projection.name==="globe"){const[me,te]=i.polesInViewport(this);me?(se=90,H=180,Z=-180):te&&(Q=-90,H=180,Z=-180)}return new i.LngLatBounds(new i.LngLat(Z,Q),new i.LngLat(H,se))}_getBoundsRectangular(d,m){const{top:w,left:T}=this._edgeInsets,P=this.height-this._edgeInsets.bottom,L=this.width-this._edgeInsets.right,z=new i.Point(T,w),U=new i.Point(L,w),Z=new i.Point(L,P),H=new i.Point(T,P);let Q=this.pointCoordinate(z,d),se=this.pointCoordinate(U,d);const de=this.pointCoordinate(Z,m),fe=this.pointCoordinate(H,m),he=(me,te)=>(te.y-me.y)/(te.x-me.x);return Q.y>1&&se.y>=0?Q=new i.MercatorCoordinate((1-fe.y)/he(fe,Q)+fe.x,1):Q.y<0&&se.y<=1&&(Q=new i.MercatorCoordinate(-fe.y/he(fe,Q)+fe.x,0)),se.y>1&&Q.y>=0?se=new i.MercatorCoordinate((1-de.y)/he(de,se)+de.x,1):se.y<0&&Q.y<=1&&(se=new i.MercatorCoordinate(-de.y/he(de,se)+de.x,0)),new i.LngLatBounds().extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(se)).extend(this.coordinateLocation(fe)).extend(this.coordinateLocation(de))}_getBoundsRectangularTerrain(){const d=this.elevation;if(!d.visibleDemTiles.length||d.isUsingMockSource())return this._getBoundsRectangular(0,0);const m=d.visibleDemTiles.reduce((w,T)=>{if(T.dem){const P=T.dem.tree;w.min=Math.min(w.min,P.minimums[0]),w.max=Math.max(w.max,P.maximums[0])}return w},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(m.min*d.exaggeration(),m.max*d.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(d=!0){const m=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,w=this.height/2-m*(1-this._horizonShift);return d?Math.max(0,w):w}getMaxBounds(){return this.maxBounds}setMaxBounds(d){this.maxBounds=d,this.minLat=-i.MAX_MERCATOR_LATITUDE,this.maxLat=i.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,d&&(this.minLat=d.getSouth(),this.maxLat=d.getNorth(),this.minLng=d.getWest(),this.maxLng=d.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=i.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=i.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=i.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(d,m){return this.projection.createTileMatrix(this,m,d)}calculateDistanceTileData(d){const m=d.key,w=this._distanceTileDataCache;if(w[m])return w[m];const T=d.canonical,P=1/this.height,L=this.cameraWorldSize,z=L/this.zoomScale(T.z),U=(T.x+Math.pow(2,T.z)*d.wrap)*z,Z=T.y*z,H=this.point;H.x*=L/this.worldSize,H.y*=L/this.worldSize;const Q=this.angle,se=Math.sin(-Q),de=-Math.cos(-Q);return w[m]={bearing:[se,de],center:[(H.x-U)*P,(H.y-Z)*P],scale:z/i.EXTENT*P},w[m]}calculateFogTileMatrix(d){const m=d.key,w=this._fogTileMatrixCache;if(w[m])return w[m];const T=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,d);return i.multiply(T,this.worldToFogMatrix,T),w[m]=new Float32Array(T),w[m]}calculateProjMatrix(d,m=!1){const w=d.key,T=m?this._alignedProjMatrixCache:this._projMatrixCache;if(T[w])return T[w];const P=this.calculatePosMatrix(d,this.worldSize);return i.multiply(P,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.alignedProjMatrix:this.projMatrix,P),T[w]=new Float32Array(P),T[w]}calculatePixelsToTileUnitsMatrix(d){const m=d.tileID.key,w=this._pixelsToTileUnitsCache;if(w[m])return w[m];const T=function(P,L){const{scale:z}=P.tileTransform,U=z*i.EXTENT/(P.tileSize*Math.pow(2,L.zoom-P.tileID.overscaledZ+P.tileID.canonical.z));return Z=new Float32Array(4),se=(H=L.inverseAdjustmentMatrix)[1],de=H[2],fe=H[3],me=(Q=[U,U])[1],Z[0]=H[0]*(he=Q[0]),Z[1]=se*he,Z[2]=de*me,Z[3]=fe*me,Z;var Z,H,Q,se,de,fe,he,me}(d,this);return w[m]=T,w[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const d=1/this.worldSize,m=i.fromScaling([],[d,d,d]);return i.multiply(m,m,this.globeMatrix),m}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const d=this._elevation;this._updateCameraState();const m=i.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(m),T=this._camera.forward(),P=i.mercatorZfromAltitude(1,this._center.lat);w[2]/=P,T[2]/=P,i.normalize(T,T);const L=d.raycast(w,T,d.exaggeration());if(L){const z=i.scaleAndAdd([],w,T,L),U=new i.MercatorCoordinate(z[0],z[1],i.mercatorZfromAltitude(z[2],i.latFromMercatorY(z[1]))),Z=(U.z+i.length([U.x-w[0],U.y-w[1],U.z-w[2]*P]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(Z),this._centerAltitude=U.toAltitude(),this._center=this.coordinateLocation(U),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(d=!1){if(!this._elevation)return;const m=this._elevation,w=i.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,T=this._computeCameraPosition(w),P=m.getAtPointOrZero(new i.MercatorCoordinate(...T)),L=this.pixelsPerMeter/this.worldSize*P,z=this._minimumHeightOverTerrain(),U=T[2]-L;if(U<=z)if(U<0||d){const Z=this.locationCoordinate(this._center,this._centerAltitude),H=[T[0],T[1],Z.z-T[2]],Q=i.length(H);H[2]-=(z-U)/this._pixelsPerMercatorPixel;const se=i.length(H);if(se===0)return;i.scale$2(H,H,Q/se*this._pixelsPerMercatorPixel),this._camera.position=[T[0],T[1],Z.z*this._pixelsPerMercatorPixel-H[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const d=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||d){const se=this.center;return se.lat=i.clamp(se.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!d)&&(se.lng=i.clamp(se.lng,this.minLng,this.maxLng)),this.center=se,void(this._constraining=!1)}const m=this._unmodified,{x:w,y:T}=this.point;let P=0,L=w,z=T;const U=this.width/2,Z=this.height/2,H=this.worldMinY*this.scale,Q=this.worldMaxY*this.scale;if(T-Z<H&&(z=H+Z),T+Z>Q&&(z=Q-Z),Q-H<this.height&&(P=Math.max(P,this.height/(Q-H)),z=(Q+H)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const se=this.worldMinX*this.scale,de=this.worldMaxX*this.scale,fe=this.worldSize/2-(se+de)/2;L=(w+fe+this.worldSize)%this.worldSize-fe,L-U<se&&(L=se+U),L+U>de&&(L=de-U),de-se<this.width&&(P=Math.max(P,this.width/(de-se)),L=(de+se)/2)}L===w&&z===T||(this.center=this.unproject(new i.Point(L,z))),P&&(this.zoom+=this.scaleZoom(P)),this._constrainCamera(),this._unmodified=m,this._constraining=!1}_minZoomForBounds(){let d=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(d=Math.max(d,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),d}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const d=this.centerOffset,m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.mercatorZfromAltitude(1,this.center.lat)/i.mercatorZfromAltitude(1,i.GLOBE_SCALE_MATCH_LATITUDE));const w=Zf(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,w),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const T=this.projection.zAxisUnit==="meters"?m:1,P=this._camera.getWorldToCamera(this.worldSize,T),L=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);L[8]=2*-d.x/this.width,L[9]=2*d.y/this.height;let z=i.mul([],L,P);if(this.projection.isReprojectedInTileSpace){const Le=this.locationCoordinate(this.center),De=i.identity([]);i.translate(De,De,[Le.x*this.worldSize,Le.y*this.worldSize,0]),i.multiply(De,De,cu(this)),i.translate(De,De,[-Le.x*this.worldSize,-Le.y*this.worldSize,0]),i.multiply(z,z,De),this.inverseAdjustmentMatrix=function(qe){const Ue=cu(qe,!0);return K([],[Ue[0],Ue[1],Ue[4],Ue[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=i.scale([],z,[this.worldSize,this.worldSize,this.worldSize/T,1]),this.projMatrix=z,this.invProjMatrix=i.invert(new Float64Array(16),this.projMatrix);const U=i.invert([],L);this.frustumCorners=i.FrustumCorners.fromInvProjectionMatrix(U,this.horizonLineFromTop(),this.height);const Z=new Float32Array(16);i.identity(Z),i.scale(Z,Z,[1,-1,1]),i.rotateX(Z,Z,this._pitch),i.rotateZ(Z,Z,this.angle);const H=i.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Q=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;H[8]=2*-d.x/this.width,H[9]=2*(d.y+Q)/this.height,this.skyboxMatrix=i.multiply(Z,H,Z);const se=this.point,de=se.x,fe=se.y,he=this.width%2/2,me=this.height%2/2,te=Math.cos(this.angle),ue=Math.sin(this.angle),be=de-Math.round(de)+te*he+ue*me,we=fe-Math.round(fe)+te*me+ue*he,Oe=new Float64Array(z);if(i.translate(Oe,Oe,[be>.5?be-1:be,we>.5?we-1:we,0]),this.alignedProjMatrix=Oe,z=i.create(),i.scale(z,z,[this.width/2,-this.height/2,1]),i.translate(z,z,[1,-1,0]),this.labelPlaneMatrix=z,z=i.create(),i.scale(z,z,[1,-1,1]),i.translate(z,z,[-1,-1,0]),i.scale(z,z,[2/this.width,2/this.height,1]),this.glCoordMatrix=z,this.pixelMatrix=i.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},z=i.invert(new Float64Array(16),this.pixelMatrix),!z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=z,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.calculateGlobeMatrix(this);const Le=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.transformMat4(Le,Le,P),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const d=this.cameraWorldSizeForFog,m=this.cameraPixelsPerMeter,w=this._camera.position,T=1/this.height/this._pixelsPerMercatorPixel,P=[d,d,m];i.scale$2(P,P,T),i.scale$2(w,w,-1),i.multiply$2(w,w,P);const L=i.create();i.translate(L,L,w),i.scale(L,L,P),this.mercatorFogMatrix=L,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(d,m,T)}_computeCameraPosition(d){const m=(d=d||this.pixelsPerMeter)/this.pixelsPerMeter,w=this._camera.forward(),T=this.point,P=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*m-d/this.worldSize*this._centerAltitude;return[T.x/this.worldSize-w[0]*P,T.y/this.worldSize-w[1]*P,d/this.worldSize*this._centerAltitude-w[2]*P]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(d){const m=this._maxCameraBoundsDistance()*Math.cos(this._pitch),w=this._camera.position[2],T=d[2];let P=1;this.projection.wrap&&(this.center=this.center.wrap()),T>0&&(P=Math.min((m-w)/T,1)),this._camera.position=i.scaleAndAdd([],this._camera.position,d,P),this._updateStateFromCamera()}_updateStateFromCamera(){const d=this._camera.position,m=this._camera.forward(),{pitch:w,bearing:T}=this._camera.getPitchBearing(),P=i.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,L=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.degToRad(this._maxPitch)),z=Math.max((d[2]-P)/Math.cos(w),L),U=this._zoomFromMercatorZ(z);i.scaleAndAdd(d,d,m,z),this._pitch=i.clamp(w,i.degToRad(this.minPitch),i.degToRad(this.maxPitch)),this.angle=i.wrap(T,-Math.PI,Math.PI),this._setZoom(i.clamp(U,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.MercatorCoordinate(d[0],d[1],d[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(d){return Math.pow(2,d)*this.tileSize}_mercatorZfromZoom(d){return this.cameraToCenterDistance/this._worldSizeFromZoom(d)}_minimumHeightOverTerrain(){const d=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(d)}_zoomFromMercatorZ(d){return this.scaleZoom(this.cameraToCenterDistance/(d*this.tileSize))}zoomFromMercatorZAdjusted(d){let m=0,w=i.GLOBE_ZOOM_THRESHOLD_MAX,T=0,P=1/0;for(;w-m>1e-6&&w>m;){const L=m+.5*(w-m),z=this.tileSize*Math.pow(2,L),U=this.getCameraToCenterDistance(this.projection,L,z),Z=this.scaleZoom(U/(d*this.tileSize)),H=Math.abs(L-Z);H<P&&(P=H,T=L),L<Z?m=L:w=L}return T}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(d,m){const w=Math.min(d.x,m.x),T=Math.max(d.x,m.x),P=Math.min(d.y,m.y),L=Math.max(d.y,m.y);if(P<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const z=[new i.Point(w,P),new i.Point(T,L),new i.Point(w,L),new i.Point(T,P)],U=this.renderWorldCopies?-3:0,Z=this.renderWorldCopies?4:1;for(const H of z){const Q=this.pointRayIntersection(H);if(Q.t<0)return!0;const se=this.rayIntersectionCoordinate(Q);if(se.x<U||se.y<0||se.x>Z||se.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.Point(0,0),new i.Point(this.width,this.height))}zoomDeltaToMovement(d,m){const w=i.length(i.sub([],this._camera.position,d)),T=this._zoomFromMercatorZ(w)+m;return w-this._mercatorZfromZoom(T)}getCameraPoint(){if(this.projection.name==="globe"){const d=function([m,w,T],P){const L=[m,w,T,1];i.transformMat4$1(L,L,P);const z=L[3]=Math.max(L[3],1e-6);return L[0]/=z,L[1]/=z,L[2]/=z,L}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.Point(d[0],d[1])}{const d=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.Point(0,d))}}getCameraToCenterDistance(d,m=this.zoom,w=this.worldSize){const T=Zf(d,m,this.width,this.height,1024),P=d.pixelSpaceConversion(this.center.lat,w,T);return .5/Math.tan(.5*this._fov)*this.height*P}getWorldToCameraMatrix(){const d=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.multiply(d,d,this.globeMatrix),d}}function du(v,d){let m=!1,w=null;const T=()=>{w=null,m&&(v(),w=setTimeout(T,d),m=!1)};return()=>(m=!0,w||T(),w)}class uy{constructor(d){this._hashName=d&&encodeURIComponent(d),i.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=du(this._updateHashUnthrottled.bind(this),300)}addTo(d){return this._map=d,i.window.addEventListener("hashchange",this._onHashChange,!1),d.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),i.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const d=this._map;if(!d)return"";const m=eh(d);if(this._hashName){const w=this._hashName;let T=!1;const P=i.window.location.hash.slice(1).split("&").map(L=>{const z=L.split("=")[0];return z===w?(T=!0,`${z}=${m}`):L}).filter(L=>L);return T||P.push(`${w}=${m}`),`#${P.join("&")}`}return`#${m}`}_getCurrentHash(){const d=i.window.location.hash.replace("#","");if(this._hashName){let m;return d.split("&").map(w=>w.split("=")).forEach(w=>{w[0]===this._hashName&&(m=w)}),(m&&m[1]||"").split("/")}return d.split("/")}_onHashChange(){const d=this._map;if(!d)return!1;const m=this._getCurrentHash();if(m.length>=3&&!m.some(w=>isNaN(w))){const w=d.dragRotate.isEnabled()&&d.touchZoomRotate.isEnabled()?+(m[3]||0):d.getBearing();return d.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:w,pitch:+(m[4]||0)}),!0}return!1}_updateHashUnthrottled(){const d=i.window.location.href.replace(/(#.+)?$/,this.getHashString());i.window.history.replaceState(i.window.history.state,null,d)}}function eh(v,d){const m=v.getCenter(),w=Math.round(100*v.getZoom())/100,T=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,T),L=Math.round(m.lng*P)/P,z=Math.round(m.lat*P)/P,U=v.getBearing(),Z=v.getPitch();let H=d?`/${L}/${z}/${w}`:`${w}/${z}/${L}`;return(U||Z)&&(H+="/"+Math.round(10*U)/10),Z&&(H+=`/${Math.round(Z)}`),H}const th={linearity:.3,easing:i.bezier(0,0,.3,1)},Yf=i.extend({deceleration:2500,maxSpeed:1400},th),Jf=i.extend({deceleration:20,maxSpeed:1400},th),Bt=i.extend({deceleration:1e3,maxSpeed:360},th),ha=i.extend({deceleration:1e3,maxSpeed:90},th);class A0{constructor(d){this._map=d,this.clear()}clear(){this._inertiaBuffer=[]}record(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.exported.now(),settings:d})}_drainInertiaBuffer(){const d=this._inertiaBuffer,m=i.exported.now();for(;d.length>0&&m-d[0].time>160;)d.shift()}_onMoveEnd(d){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const m={zoom:0,bearing:0,pitch:0,pan:new i.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)m.zoom+=P.zoomDelta||0,m.bearing+=P.bearingDelta||0,m.pitch+=P.pitchDelta||0,P.panDelta&&m.pan._add(P.panDelta),P.around&&(m.around=P.around),P.pinchAround&&(m.pinchAround=P.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(m.pan.mag()){const P=nh(m.pan.mag(),w,i.extend({},Yf,d||{}));T.offset=m.pan.mult(P.amount/m.pan.mag()),T.center=this._map.transform.center,rh(T,P)}if(m.zoom){const P=nh(m.zoom,w,Jf);T.zoom=this._map.transform.zoom+P.amount,rh(T,P)}if(m.bearing){const P=nh(m.bearing,w,Bt);T.bearing=this._map.transform.bearing+i.clamp(P.amount,-179,179),rh(T,P)}if(m.pitch){const P=nh(m.pitch,w,ha);T.pitch=this._map.transform.pitch+P.amount,rh(T,P)}if(T.zoom||T.bearing){const P=m.pinchAround===void 0?m.around:m.pinchAround;T.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),T.noMoveStart=!0,T}}function rh(v,d){(!v.duration||v.duration<d.duration)&&(v.duration=d.duration,v.easing=d.easing)}function nh(v,d,m){const{maxSpeed:w,linearity:T,deceleration:P}=m,L=i.clamp(v*T/(d/1e3),-w,w),z=Math.abs(L)/(P*T);return{easing:m.easing,duration:1e3*z,amount:L*(z/2)}}class xi extends i.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,m,w,T={}){const P=F(m.getCanvasContainer(),w),L=m.unproject(P);super(d,i.extend({point:P,lngLat:L,originalEvent:w},T)),this._defaultPrevented=!1,this.target=m}}class ih extends i.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,m,w){const T=d==="touchend"?w.changedTouches:w.touches,P=X(m.getCanvasContainer(),T),L=P.map(U=>m.unproject(U)),z=P.reduce((U,Z,H,Q)=>U.add(Z.div(Q.length)),new i.Point(0,0));super(d,{points:P,point:z,lngLats:L,lngLat:m.unproject(z),originalEvent:w}),this._defaultPrevented=!1}}class Qf extends i.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,m,w){super(d,{originalEvent:w}),this._defaultPrevented=!1}}class dy{constructor(d,m){this._map=d,this._clickTolerance=m.clickTolerance}reset(){this._mousedownPos=void 0}wheel(d){return this._firePreventable(new Qf(d.type,this._map,d))}mousedown(d,m){return this._mousedownPos=m,this._firePreventable(new xi(d.type,this._map,d))}mouseup(d){this._map.fire(new xi(d.type,this._map,d))}preclick(d){const m=i.extend({},d);m.type="preclick",this._map.fire(new xi(m.type,this._map,m))}click(d,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||(this.preclick(d),this._map.fire(new xi(d.type,this._map,d)))}dblclick(d){return this._firePreventable(new xi(d.type,this._map,d))}mouseover(d){this._map.fire(new xi(d.type,this._map,d))}mouseout(d){this._map.fire(new xi(d.type,this._map,d))}touchstart(d){return this._firePreventable(new ih(d.type,this._map,d))}touchmove(d){this._map.fire(new ih(d.type,this._map,d))}touchend(d){this._map.fire(new ih(d.type,this._map,d))}touchcancel(d){this._map.fire(new ih(d.type,this._map,d))}_firePreventable(d){if(this._map.fire(d),d.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ep{constructor(d){this._map=d}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(d){this._map.fire(new xi(d.type,this._map,d))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(d){this._delayContextMenu?this._contextMenuEvent=d:this._map.fire(new xi(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class k0{constructor(d,m){this._map=d,this._el=d.getCanvasContainer(),this._container=d.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(d,m){this.isEnabled()&&d.shiftKey&&d.button===0&&(B(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(d,m){if(!this._active)return;const w=m,T=this._startPos,P=this._lastPos;if(!T||!P||P.equals(w)||!this._box&&w.dist(T)<this._clickTolerance)return;this._lastPos=w,this._box||(this._box=E("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",d));const L=Math.min(T.x,w.x),z=Math.max(T.x,w.x),U=Math.min(T.y,w.y),Z=Math.max(T.y,w.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${L}px,${U}px)`,this._box.style.width=z-L+"px",this._box.style.height=Z-U+"px")})}mouseupWindow(d,m){if(!this._active)return;const w=this._startPos,T=m;if(w&&d.button===0){if(this.reset(),q(),w.x!==T.x||w.y!==T.y)return this._map.fire(new i.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:P=>P.fitScreenCoordinates(w,T,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",d)}}keydown(d){this._active&&d.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",d))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),O(),delete this._startPos,delete this._lastPos}_fireEvent(d,m){return this._map.fire(new i.Event(d,{originalEvent:m}))}}function tp(v,d){const m={};for(let w=0;w<v.length;w++)m[v[w].identifier]=d[w];return m}class hu{constructor(d){this.reset(),this.numTouches=d.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(d,m,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=d.timeStamp),w.length===this.numTouches&&(this.centroid=function(T){const P=new i.Point(0,0);for(const L of T)P._add(L);return P.div(T.length)}(m),this.touches=tp(w,m)))}touchmove(d,m,w){if(this.aborted||!this.centroid)return;const T=tp(w,m);for(const P in this.touches){const L=T[P];(!L||L.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(d,m,w){if((!this.centroid||d.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){const T=!this.aborted&&this.centroid;if(this.reset(),T)return T}}}class hy{constructor(d){this.singleTap=new hu(d),this.numTaps=d.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(d,m,w){this.singleTap.touchstart(d,m,w)}touchmove(d,m,w){this.singleTap.touchmove(d,m,w)}touchend(d,m,w){const T=this.singleTap.touchend(d,m,w);if(T){const P=d.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(T)<30;if(P&&L||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=T,this.count===this.numTaps)return this.reset(),T}}}class QE{constructor(){this._zoomIn=new hy({numTouches:1,numTaps:2}),this._zoomOut=new hy({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(d,m,w){this._zoomIn.touchstart(d,m,w),this._zoomOut.touchstart(d,m,w)}touchmove(d,m,w){this._zoomIn.touchmove(d,m,w),this._zoomOut.touchmove(d,m,w)}touchend(d,m,w){const T=this._zoomIn.touchend(d,m,w),P=this._zoomOut.touchend(d,m,w);return T?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(T)},{originalEvent:d})}):P?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(P)},{originalEvent:d})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const N0={0:1,2:2};class fu{constructor(d){this.reset(),this._clickTolerance=d.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(d,m){return!1}_move(d,m){return{}}mousedown(d,m){if(this._lastPoint)return;const w=G(d);this._correctButton(d,w)&&(this._lastPoint=m,this._eventButton=w)}mousemoveWindow(d,m){const w=this._lastPoint;if(w){if(d.preventDefault(),this._eventButton!=null&&function(T,P){const L=N0[P];return T.buttons===void 0||(T.buttons&L)!==L}(d,this._eventButton))this.reset();else if(this._moved||!(m.dist(w)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(w,m)}}mouseupWindow(d){this._lastPoint&&G(d)===this._eventButton&&(this._moved&&q(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fy extends fu{mousedown(d,m){super.mousedown(d,m),this._lastPoint&&(this._active=!0)}_correctButton(d,m){return m===0&&!d.ctrlKey}_move(d,m){return{around:m,panDelta:m.sub(d)}}}class py extends fu{_correctButton(d,m){return m===0&&d.ctrlKey||m===2}_move(d,m){const w=.8*(m.x-d.x);if(w)return this._active=!0,{bearingDelta:w}}contextmenu(d){d.preventDefault()}}class my extends fu{_correctButton(d,m){return m===0&&d.ctrlKey||m===2}_move(d,m){const w=-.5*(m.y-d.y);if(w)return this._active=!0,{pitchDelta:w}}contextmenu(d){d.preventDefault()}}class rp{constructor(d,m){this._map=d,this._el=d.getCanvasContainer(),this._minTouches=1,this._clickTolerance=m.clickTolerance||1,this.reset(),i.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.Point(0,0)}touchstart(d,m,w){return this._calculateTransform(d,m,w)}touchmove(d,m,w){if(this._active&&!(w.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(w.length===1&&!i.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return d.cancelable&&d.preventDefault(),this._calculateTransform(d,m,w)}}touchend(d,m,w){this._calculateTransform(d,m,w),this._active&&w.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(d,m,w){w.length>0&&(this._active=!0);const T=tp(w,m),P=new i.Point(0,0),L=new i.Point(0,0);let z=0;for(const Z in T){const H=T[Z],Q=this._touches[Z];Q&&(P._add(H),L._add(H.sub(Q)),z++,T[Z]=H)}if(this._touches=T,z<this._minTouches||!L.mag())return;const U=L.div(z);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(z),panDelta:U}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class oh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(d){}_move(d,m,w){return{}}touchstart(d,m,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([m[0],m[1]]))}touchmove(d,m,w){const T=this._firstTwoTouches;if(!T)return;d.preventDefault();const[P,L]=T,z=ah(w,m,P),U=ah(w,m,L);if(!z||!U)return;const Z=this._aroundCenter?null:z.add(U).div(2);return this._move([z,U],Z,d)}touchend(d,m,w){if(!this._firstTwoTouches)return;const[T,P]=this._firstTwoTouches,L=ah(w,m,T),z=ah(w,m,P);L&&z||(this._active&&q(),this.reset())}touchcancel(){this.reset()}enable(d){this._enabled=!0,this._aroundCenter=!!d&&d.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ah(v,d,m){for(let w=0;w<v.length;w++)if(v[w].identifier===m)return d[w]}function gy(v,d){return Math.log(v/d)/Math.LN2}class M0 extends oh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(d){this._startDistance=this._distance=d[0].dist(d[1])}_move(d,m){const w=this._distance;if(this._distance=d[0].dist(d[1]),this._active||!(Math.abs(gy(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:gy(this._distance,w),pinchAround:m}}}function yy(v,d){return 180*v.angleWith(d)/Math.PI}class I0 extends oh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(d){this._startVector=this._vector=d[0].sub(d[1]),this._minDiameter=d[0].dist(d[1])}_move(d,m){const w=this._vector;if(this._vector=d[0].sub(d[1]),w&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:yy(this._vector,w),pinchAround:m}}_isBelowThreshold(d){this._minDiameter=Math.min(this._minDiameter,d.mag());const m=25/(Math.PI*this._minDiameter)*360,w=this._startVector;if(!w)return!1;const T=yy(d,w);return Math.abs(T)<m}}function al(v){return Math.abs(v.y)>Math.abs(v.x)}class O0 extends oh{constructor(d){super(),this._map=d}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(d){this._lastPoints=d,al(d[0].sub(d[1]))&&(this._valid=!1)}_move(d,m,w){const T=this._lastPoints;if(!T)return;const P=d[0].sub(T[0]),L=d[1].sub(T[1]);return this._map._cooperativeGestures&&!i.isFullscreen()&&w.touches.length<3||(this._valid=this.gestureBeginsVertically(P,L,w.timeStamp),!this._valid)?void 0:(this._lastPoints=d,this._active=!0,{pitchDelta:(P.y+L.y)/2*-.5})}gestureBeginsVertically(d,m,w){if(this._valid!==void 0)return this._valid;const T=d.mag()>=2,P=m.mag()>=2;if(!T&&!P)return;if(!T||!P)return this._firstMove==null&&(this._firstMove=w),w-this._firstMove<100&&void 0;const L=d.y>0==m.y>0;return al(d)&&al(m)&&L}}const D0={panStep:100,bearingStep:15,pitchStep:10};class eT{constructor(){const d=D0;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(d){if(d.altKey||d.ctrlKey||d.metaKey)return;let m=0,w=0,T=0,P=0,L=0;switch(d.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:d.shiftKey?w=-1:(d.preventDefault(),P=-1);break;case 39:d.shiftKey?w=1:(d.preventDefault(),P=1);break;case 38:d.shiftKey?T=1:(d.preventDefault(),L=-1);break;case 40:d.shiftKey?T=-1:(d.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(w=0,T=0),{cameraAnimation:z=>{const U=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:R0,zoom:m?Math.round(U)+m*(d.shiftKey?2:1):U,bearing:z.getBearing()+w*this._bearingStep,pitch:z.getPitch()+T*this._pitchStep,offset:[-P*this._panStep,-L*this._panStep],center:z.getCenter()},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function R0(v){return v*(2-v)}const vy=4.000244140625;class L0{constructor(d,m){this._map=d,this._el=d.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,i.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(d){this._defaultZoomRate=d}setWheelZoomRate(d){this._wheelZoomRate=d}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!d&&d.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(d){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(d.ctrlKey||d.metaKey||this.isZooming()||i.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let m=d.deltaMode===i.window.WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY;const w=i.exported.now(),T=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,m!==0&&m%vy==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":T>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(T*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),d.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=d,this._delta-=m,this._active||this._start(d)),d.preventDefault()}_onTimeout(d){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)}_start(d){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=F(this._el,d);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:m,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const d=this._map.transform;this._type==="wheel"&&d.projection.wrap&&(d._center.lng>=180||d._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const m=()=>d._terrainEnabled()&&this._aroundCoord?d.computeZoomRelativeTo(this._aroundCoord):d.zoom;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>vy?this._wheelZoomRate:this._defaultZoomRate;let Z=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&Z!==0&&(Z=1/Z);const H=m(),Q=Math.pow(2,H),se=typeof this._targetZoom=="number"?d.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(d.maxZoom,Math.max(d.minZoom,d.scaleZoom(se*Z))),this._type==="wheel"&&(this._startZoom=H,this._easing=this._smoothOutEasing(200)),this._delta=0}const w=typeof this._targetZoom=="number"?this._targetZoom:m(),T=this._startZoom,P=this._easing;let L,z=!1;if(this._type==="wheel"&&T&&P){const U=Math.min((i.exported.now()-this._lastWheelEventTime)/200,1),Z=P(U);L=i.number(T,w,Z),U<1?this._frameId||(this._frameId=!0):z=!0}else L=w,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:L-m(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(d){let m=i.ease;if(this._prevEase){const w=this._prevEase,T=(i.exported.now()-w.start)/w.duration,P=w.easing(T+.01)-w.easing(T),L=.27/Math.sqrt(P*P+1e-4)*.01,z=Math.sqrt(.0729-L*L);m=i.bezier(L,z,.25,1)}return this._prevEase={start:i.exported.now(),duration:d,easing:m},m}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(i.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class B0{constructor(d,m){this._clickZoom=d,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ui{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(d,m){return d.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:w.getZoom()+(d.shiftKey?-1:1),around:w.unproject(m)},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tT{constructor(){this._tap=new hy({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(d,m,w){this._swipePoint||(this._tapTime&&d.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?w.length>0&&(this._swipePoint=m[0],this._swipeTouch=w[0].identifier):this._tap.touchstart(d,m,w))}touchmove(d,m,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const T=m[0],P=T.y-this._swipePoint.y;return this._swipePoint=T,d.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(d,m,w)}touchend(d,m,w){this._tapTime?this._swipePoint&&w.length===0&&this.reset():this._tap.touchend(d,m,w)&&(this._tapTime=d.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class z0{constructor(d,m,w){this._el=d,this._mousePan=m,this._touchPan=w}enable(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class rT{constructor(d,m,w){this._pitchWithRotate=d.pitchWithRotate,this._mouseRotate=m,this._mousePitch=w}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class nT{constructor(d,m,w,T){this._el=d,this._touchZoom=m,this._touchRotate=w,this._tapDragZoom=T,this._rotationDisabled=!1,this._enabled=!0}enable(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Wo=v=>v.zoom||v.drag||v.pitch||v.rotate;class $0 extends i.Event{}class iT{constructor(){this.constants=[1,1,.01],this.radius=0}setup(d,m){const w=i.sub([],m,d);this.radius=i.length(w[2]<0?i.div([],w,this.constants):[w[0],w[1],0])}projectRay(d){i.div(d,d,this.constants),i.normalize(d,d),i.mul$1(d,d,this.constants);const m=i.scale$2([],d,this.radius);if(m[2]>0){const w=i.scale$2([],[0,0,1],i.dot(m,[0,0,1])),T=i.scale$2([],i.normalize([],[m[0],m[1],0]),this.radius),P=i.add([],m,i.scale$2([],i.sub([],i.add([],T,w),m),2));m[0]=P[0],m[1]=P[1]}return m}}function fa(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class Ba{constructor(d,m){this._map=d,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new A0(d),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new iT,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(m),i.bindAll(["handleEvent","handleWindowEvent"],this);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[i.window.document,"mousemove",{capture:!0}],[i.window.document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[i.window,"blur",void 0]];for(const[T,P,L]of this._listeners)T.addEventListener(P,T===i.window.document?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(const[d,m,w]of this._listeners)d.removeEventListener(m,d===i.window.document?this.handleWindowEvent:this.handleEvent,w)}_addDefaultHandlers(d){const m=this._map,w=m.getCanvasContainer();this._add("mapEvent",new dy(m,d));const T=m.boxZoom=new k0(m,d);this._add("boxZoom",T);const P=new QE,L=new Ui;m.doubleClickZoom=new B0(L,P),this._add("tapZoom",P),this._add("clickZoom",L);const z=new tT;this._add("tapDragZoom",z);const U=m.touchPitch=new O0(m);this._add("touchPitch",U);const Z=new py(d),H=new my(d);m.dragRotate=new rT(d,Z,H),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);const Q=new fy(d),se=new rp(m,d);m.dragPan=new z0(w,Q,se),this._add("mousePan",Q),this._add("touchPan",se,["touchZoom","touchRotate"]);const de=new I0,fe=new M0;m.touchZoomRotate=new nT(w,fe,de,z),this._add("touchRotate",de,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ep(m));const he=m.scrollZoom=new L0(m,this);this._add("scrollZoom",he,["mousePan"]);const me=m.keyboard=new eT;this._add("keyboard",me);for(const te of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])d.interactive&&d[te]&&m[te].enable(d[te])}_add(d,m,w){this._handlers.push({handlerName:d,handler:m,allowed:w}),this._handlersById[d]=m}stop(d){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}}isActive(){for(const{handler:d}of this._handlers)if(d.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Wo(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(d,m,w){for(const T in d)if(T!==w&&(!m||m.indexOf(T)<0))return!0;return!1}handleWindowEvent(d){this.handleEvent(d,`${d.type}Window`)}_getMapTouches(d){const m=[];for(const w of d)this._el.contains(w.target)&&m.push(w);return m}handleEvent(d,m){this._updatingCamera=!0;const w=d.type==="renderFrame",T=w?void 0:d,P={needsRenderFrame:!1},L={},z={},U=d.touches?this._getMapTouches(d.touches):void 0,Z=U?X(this._el,U):w?void 0:F(this._el,d);for(const{handlerName:se,handler:de,allowed:fe}of this._handlers){if(!de.isEnabled())continue;let he;this._blockedByActive(z,fe,se)?de.reset():de[m||d.type]&&(he=de[m||d.type](d,Z,U),this.mergeHandlerResult(P,L,he,se,T),he&&he.needsRenderFrame&&this._triggerRenderFrame()),(he||de.isActive())&&(z[se]=de)}const H={};for(const se in this._previousActiveHandlers)z[se]||(H[se]=T);this._previousActiveHandlers=z,(Object.keys(H).length||fa(P))&&(this._changes.push([P,L,H]),this._triggerRenderFrame()),(Object.keys(z).length||fa(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=P;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))}mergeHandlerResult(d,m,w,T,P){if(!w)return;i.extend(d,w);const L={handlerName:T,originalEvent:w.originalEvent||P};w.zoomDelta!==void 0&&(m.zoom=L),w.panDelta!==void 0&&(m.drag=L),w.pitchDelta!==void 0&&(m.pitch=L),w.bearingDelta!==void 0&&(m.rotate=L)}_applyChanges(){const d={},m={},w={};for(const[T,P,L]of this._changes)T.panDelta&&(d.panDelta=(d.panDelta||new i.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(d.zoomDelta=(d.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(d.bearingDelta=(d.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(d.pitchDelta=(d.pitchDelta||0)+T.pitchDelta),T.around!==void 0&&(d.around=T.around),T.aroundCoord!==void 0&&(d.aroundCoord=T.aroundCoord),T.pinchAround!==void 0&&(d.pinchAround=T.pinchAround),T.noInertia&&(d.noInertia=T.noInertia),i.extend(m,P),i.extend(w,L);this._updateMapTransform(d,m,w),this._changes=[]}_updateMapTransform(d,m,w){const T=this._map,P=T.transform,L=ue=>[ue.x,ue.y,ue.z];if((ue=>{const be=this._eventsInProgress.drag;return be&&!this._handlersById[be.handlerName].isActive()})()&&!fa(d)){const ue=P.zoom;P.cameraElevationReference="sea",P.recenterOnTerrain(),P.cameraElevationReference="ground",ue!==P.zoom&&this._map._update(!0)}if(P._isCameraConstrained&&T._stop(!0),!fa(d))return void this._fireEvents(m,w,!0);let{panDelta:z,zoomDelta:U,bearingDelta:Z,pitchDelta:H,around:Q,aroundCoord:se,pinchAround:de}=d;P._isCameraConstrained&&(U>0&&(U=0),P._isCameraConstrained=!1),de!==void 0&&(Q=de),(U||(ue=>m[ue]&&!this._eventsInProgress[ue])("drag"))&&Q&&(this._dragOrigin=L(P.pointCoordinate3D(Q)),this._trackingEllipsoid.setup(P._camera.position,this._dragOrigin)),P.cameraElevationReference="sea",T._stop(!0),Q=Q||T.transform.centerPoint,Z&&(P.bearing+=Z),H&&(P.pitch+=H),P._updateCameraState();const fe=[0,0,0];if(z)if(P.projection.name==="mercator"){const ue=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(Q).dir),be=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(Q.sub(z)).dir);fe[0]=be[0]-ue[0],fe[1]=be[1]-ue[1]}else{const ue=P.pointCoordinate(Q);if(P.projection.name==="globe"){z=z.rotate(-P.angle);const be=P._pixelsPerMercatorPixel/P.worldSize;fe[0]=-z.x*i.mercatorScale(i.latFromMercatorY(ue.y))*be,fe[1]=-z.y*i.mercatorScale(P.center.lat)*be}else{const be=P.pointCoordinate(Q.sub(z));ue&&be&&(fe[0]=be.x-ue.x,fe[1]=be.y-ue.y)}}const he=P.zoom,me=[0,0,0];if(U){const ue=L(se||P.pointCoordinate3D(Q)),be={dir:i.normalize([],i.sub([],ue,P._camera.position))};if(be.dir[2]<0){const we=P.zoomDeltaToMovement(ue,U);i.scale$2(me,be.dir,we)}}const te=i.add(fe,fe,me);P._translateCameraConstrained(te),U&&Math.abs(P.zoom-he)>1e-4&&P.recenterOnTerrain(),P.cameraElevationReference="ground",this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(m,w,!0)}_fireEvents(d,m,w){const T=Wo(this._eventsInProgress),P=Wo(d),L={};for(const H in d){const{originalEvent:Q}=d[H];this._eventsInProgress[H]||(L[`${H}start`]=Q),this._eventsInProgress[H]=d[H]}!T&&P&&this._fireEvent("movestart",P.originalEvent);for(const H in L)this._fireEvent(H,L[H]);P&&this._fireEvent("move",P.originalEvent);for(const H in d){const{originalEvent:Q}=d[H];this._fireEvent(H,Q)}const z={};let U;for(const H in this._eventsInProgress){const{handlerName:Q,originalEvent:se}=this._eventsInProgress[H];this._handlersById[Q].isActive()||(delete this._eventsInProgress[H],U=m[Q]||se,z[`${H}end`]=U)}for(const H in z)this._fireEvent(H,z[H]);const Z=Wo(this._eventsInProgress);if(w&&(T||P)&&!Z){this._updatingCamera=!0;const H=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Q=se=>se!==0&&-this._bearingSnap<se&&se<this._bearingSnap;H?(Q(H.bearing||this._map.getBearing())&&(H.bearing=0),this._map.easeTo(H,{originalEvent:U})):(this._map.fire(new i.Event("moveend",{originalEvent:U})),Q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(d,m){this._map.fire(new i.Event(d,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(d=>{this._frameId=void 0,this.handleEvent(new $0("renderFrame",{timeStamp:d})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Zl="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class np extends i.Evented{constructor(d,m){super(),this._moving=!1,this._zooming=!1,this.transform=d,this._bearingSnap=m.bearingSnap,this._respectPrefersReducedMotion=m.respectPrefersReducedMotion!==!1,i.bindAll(["_renderFrameCallback"],this)}getCenter(){return new i.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(d,m){return this.jumpTo({center:d},m)}panBy(d,m,w){return d=i.Point.convert(d).mult(-1),this.panTo(this.transform.center,i.extend({offset:d},m),w)}panTo(d,m,w){return this.easeTo(i.extend({center:d},m),w)}getZoom(){return this.transform.zoom}setZoom(d,m){return this.jumpTo({zoom:d},m),this}zoomTo(d,m,w){return this.easeTo(i.extend({zoom:d},m),w)}zoomIn(d,m){return this.zoomTo(this.getZoom()+1,d,m),this}zoomOut(d,m){return this.zoomTo(this.getZoom()-1,d,m),this}getBearing(){return this.transform.bearing}setBearing(d,m){return this.jumpTo({bearing:d},m),this}getPadding(){return this.transform.padding}setPadding(d,m){return this.jumpTo({padding:d},m),this}rotateTo(d,m,w){return this.easeTo(i.extend({bearing:d},m),w)}resetNorth(d,m){return this.rotateTo(0,i.extend({duration:1e3},d),m),this}resetNorthPitch(d,m){return this.easeTo(i.extend({bearing:0,pitch:0,duration:1e3},d),m),this}snapToNorth(d,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(d,m):this}getPitch(){return this.transform.pitch}setPitch(d,m){return this.jumpTo({pitch:d},m),this}cameraForBounds(d,m){d=i.LngLatBounds.convert(d);const w=m&&m.bearing||0,T=m&&m.pitch||0,P=d.getNorthWest(),L=d.getSouthEast();return this._cameraForBounds(this.transform,P,L,w,T,m)}_extendCameraOptions(d){const m={top:0,bottom:0,right:0,left:0};if(typeof(d=i.extend({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const w=d.padding;d.padding={top:w,bottom:w,right:w,left:w}}return d.padding=i.extend(m,d.padding),d}_minimumAABBFrustumDistance(d,m){const w=m.max[0]-m.min[0],T=m.max[1]-m.min[1];return w/T>d.aspect?w/(2*Math.tan(.5*d.fovX)*d.aspect):T/(2*Math.tan(.5*d.fovY)*d.aspect)}_cameraForBoundsOnGlobe(d,m,w,T,P,L){const z=d.clone(),U=this._extendCameraOptions(L);z.bearing=T,z.pitch=P;const Z=i.LngLat.convert(m),H=i.LngLat.convert(w),Q=.5*(Z.lat+H.lat),se=.5*(Z.lng+H.lng),de=i.latLngToECEF(Q,se),fe=i.normalize([],de),he=i.normalize([],i.cross([],fe,[0,1,0])),me=i.cross([],he,fe),te=[he[0],he[1],he[2],0,me[0],me[1],me[2],0,fe[0],fe[1],fe[2],0,0,0,0,1],ue=[de,i.latLngToECEF(Z.lat,Z.lng),i.latLngToECEF(H.lat,Z.lng),i.latLngToECEF(H.lat,H.lng),i.latLngToECEF(Z.lat,H.lng),i.latLngToECEF(Q,Z.lng),i.latLngToECEF(Q,H.lng),i.latLngToECEF(Z.lat,se),i.latLngToECEF(H.lat,se)];let be=i.Aabb.fromPoints(ue.map(mt=>[i.dot(he,mt),i.dot(me,mt),i.dot(fe,mt)]));const we=i.transformMat4([],be.center,te);i.squaredLength(we)===0&&i.set(we,0,0,1),i.normalize(we,we),i.scale$2(we,we,i.GLOBE_RADIUS),z.center=i.ecefToLatLng(we);const Oe=z.getWorldToCameraMatrix(),Le=i.invert(new Float64Array(16),Oe);be=i.Aabb.applyTransform(be,i.multiply([],Oe,te)),i.transformMat4(we,we,Oe);const De=.5*(be.max[2]-be.min[2]),qe=this._minimumAABBFrustumDistance(z,be),Ue=i.scale$2([],[0,0,1],De),Je=i.add(Ue,we,Ue),bt=qe+(z.pitch===0?0:i.distance(we,Je)),Ze=z.globeCenterInViewSpace,ut=i.sub([],we,[Ze[0],Ze[1],Ze[2]]);i.normalize(ut,ut),i.scale$2(ut,ut,bt);const et=i.add([],we,ut);i.transformMat4(et,et,Le);const xt=i.earthRadius/i.GLOBE_RADIUS,Ye=i.length(et),ct=i.mercatorZfromAltitude(Math.max(Ye*xt-i.earthRadius,Number.EPSILON),0),wt=Math.min(z.zoomFromMercatorZAdjusted(ct),U.maxZoom);return wt>.5*(i.GLOBE_ZOOM_THRESHOLD_MIN+i.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"mercator"}),z.zoom=wt,this._cameraForBounds(z,m,w,T,P,L)):{center:z.center,zoom:wt,bearing:T,pitch:P}}queryTerrainElevation(d,m){const w=this.transform.elevation;return w?(m=i.extend({},{exaggerated:!0},m),w.getAtPoint(i.MercatorCoordinate.fromLngLat(d),null,m.exaggerated)):null}_cameraForBounds(d,m,w,T,P,L){if(d.projection.name==="globe")return this._cameraForBoundsOnGlobe(d,m,w,T,P,L);const z=d.clone(),U=this._extendCameraOptions(L),Z=z.padding;z.bearing=T,z.pitch=P;const H=i.LngLat.convert(m),Q=i.LngLat.convert(w),se=new i.LngLat(H.lng,Q.lat),de=new i.LngLat(Q.lng,H.lat),fe=z.project(H),he=z.project(Q),me=this.queryTerrainElevation(H),te=this.queryTerrainElevation(Q),ue=this.queryTerrainElevation(se),be=this.queryTerrainElevation(de),we=[[fe.x,fe.y,Math.min(me||0,te||0,ue||0,be||0)],[he.x,he.y,Math.max(me||0,te||0,ue||0,be||0)]];let Oe=i.Aabb.fromPoints(we);const Le=z.getWorldToCameraMatrix(),De=i.invert(new Float64Array(16),Le);Oe=i.Aabb.applyTransform(Oe,Le);const qe=i.sub([],Oe.max,Oe.min),Ue=Z.left||0,Je=Z.right||0,bt=Z.bottom||0,Ze=Z.top||0,{left:ut,right:et,top:xt,bottom:Ye}=U.padding,ct=.5*(Ue+Je),wt=.5*(Ze+bt),mt=Math.min(z.scaleZoom(z.scale*Math.min((z.width-(Ue+Je+ut+et))/qe[0],(z.height-(bt+Ze+Ye+xt))/qe[1])),U.maxZoom),St=z.scale/z.zoomScale(mt);Oe=new i.Aabb([Oe.min[0]-(ut+ct)*St,Oe.min[1]-(Ye+wt)*St,Oe.min[2]],[Oe.max[0]+(et+ct)*St,Oe.max[1]+(xt+wt)*St,Oe.max[2]]);const Kt=.5*qe[2],sr=this._minimumAABBFrustumDistance(z,Oe),Ut=[0,0,1,0];i.transformMat4$1(Ut,Ut,Le),i.normalize$2(Ut,Ut);const ir=i.scale$2([],Ut,sr+Kt),Tr=i.add([],Oe.center,ir),wr=(typeof U.offset.x=="number"&&typeof U.offset.y=="number"?new i.Point(U.offset.x,U.offset.y):i.Point.convert(U.offset)).rotate(-i.degToRad(T));Oe.center[0]-=wr.x*St,Oe.center[1]+=wr.y*St,i.transformMat4(Oe.center,Oe.center,De),i.transformMat4(Tr,Tr,De);const Zt=[Oe.center[0],Oe.center[1],Tr[2]*z.pixelsPerMeter];i.scale$2(Zt,Zt,1/z.worldSize);const Hr=i.lngFromMercatorX(Zt[0]),Jr=i.latFromMercatorY(Zt[1]),Qr=Math.min(z._zoomFromMercatorZ(Zt[2]),U.maxZoom),en=new i.LngLat(Hr,Jr);return z.mercatorFromTransition&&Qr<.5*(i.GLOBE_ZOOM_THRESHOLD_MIN+i.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"globe"}),z.zoom=Qr,this._cameraForBounds(z,m,w,T,P,L)):{center:en,zoom:Qr,bearing:T,pitch:P}}fitBounds(d,m,w){const T=this.cameraForBounds(d,m);return this._fitInternal(T,m,w)}fitScreenCoordinates(d,m,w,T,P){const L=i.Point.convert(d),z=i.Point.convert(m),U=new i.Point(Math.min(L.x,z.x),Math.min(L.y,z.y)),Z=new i.Point(Math.max(L.x,z.x),Math.max(L.y,z.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(L,z))return this;const H=this.transform.pointLocation3D(U),Q=this.transform.pointLocation3D(Z),se=this.transform.pointLocation3D(new i.Point(U.x,Z.y)),de=this.transform.pointLocation3D(new i.Point(Z.x,U.y)),fe=[Math.min(H.lng,Q.lng,se.lng,de.lng),Math.min(H.lat,Q.lat,se.lat,de.lat)],he=[Math.max(H.lng,Q.lng,se.lng,de.lng),Math.max(H.lat,Q.lat,se.lat,de.lat)],me=T&&T.pitch?T.pitch:this.getPitch(),te=this._cameraForBounds(this.transform,fe,he,w,me,T);return this._fitInternal(te,T,P)}_fitInternal(d,m,w){return d?(delete(m=i.extend(d,m)).padding,m.linear?this.easeTo(m,w):this.flyTo(m,w)):this}jumpTo(d,m){this.stop();const w=d.preloadOnly?this.transform.clone():this.transform;let T=!1,P=!1,L=!1;return"zoom"in d&&w.zoom!==+d.zoom&&(T=!0,w.zoom=+d.zoom),d.center!==void 0&&(w.center=i.LngLat.convert(d.center)),"bearing"in d&&w.bearing!==+d.bearing&&(P=!0,w.bearing=+d.bearing),"pitch"in d&&w.pitch!==+d.pitch&&(L=!0,w.pitch=+d.pitch),d.padding==null||w.isPaddingEqual(d.padding)||(w.padding=d.padding),d.preloadOnly?(this._preloadTiles(w),this):(this.fire(new i.Event("movestart",m)).fire(new i.Event("move",m)),T&&this.fire(new i.Event("zoomstart",m)).fire(new i.Event("zoom",m)).fire(new i.Event("zoomend",m)),P&&this.fire(new i.Event("rotatestart",m)).fire(new i.Event("rotate",m)).fire(new i.Event("rotateend",m)),L&&this.fire(new i.Event("pitchstart",m)).fire(new i.Event("pitch",m)).fire(new i.Event("pitchend",m)),this.fire(new i.Event("moveend",m)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.warnOnce(Zl),this.transform.getFreeCameraOptions()}setFreeCameraOptions(d,m){const w=this.transform;if(!w.projection.supportsFreeCamera)return i.warnOnce(Zl),this;this.stop();const T=w.zoom,P=w.pitch,L=w.bearing;w.setFreeCameraOptions(d);const z=T!==w.zoom,U=P!==w.pitch,Z=L!==w.bearing;return this.fire(new i.Event("movestart",m)).fire(new i.Event("move",m)),z&&this.fire(new i.Event("zoomstart",m)).fire(new i.Event("zoom",m)).fire(new i.Event("zoomend",m)),Z&&this.fire(new i.Event("rotatestart",m)).fire(new i.Event("rotate",m)).fire(new i.Event("rotateend",m)),U&&this.fire(new i.Event("pitchstart",m)).fire(new i.Event("pitch",m)).fire(new i.Event("pitchend",m)),this.fire(new i.Event("moveend",m)),this}easeTo(d,m){this._stop(!1,d.easeId),((d=i.extend({offset:[0,0],duration:500,easing:i.ease},d)).animate===!1||this._prefersReducedMotion(d))&&(d.duration=0);const w=this.transform,T=this.getZoom(),P=this.getBearing(),L=this.getPitch(),z=this.getPadding(),U="zoom"in d?+d.zoom:T,Z="bearing"in d?this._normalizeBearing(d.bearing,P):P,H="pitch"in d?+d.pitch:L,Q="padding"in d?d.padding:w.padding,se=i.Point.convert(d.offset);let de,fe,he;if(w.projection.name==="globe"){const Ue=i.MercatorCoordinate.fromLngLat(w.center),Je=se.rotate(-w.angle);Ue.x+=Je.x/w.worldSize,Ue.y+=Je.y/w.worldSize;const bt=Ue.toLngLat(),Ze=i.LngLat.convert(d.center||bt);this._normalizeCenter(Ze),de=w.centerPoint.add(Je),fe=new i.Point(Ue.x,Ue.y).mult(w.worldSize),he=new i.Point(i.mercatorXfromLng(Ze.lng),i.mercatorYfromLat(Ze.lat)).mult(w.worldSize).sub(fe)}else{de=w.centerPoint.add(se);const Ue=w.pointLocation(de),Je=i.LngLat.convert(d.center||Ue);this._normalizeCenter(Je),fe=w.project(Ue),he=w.project(Je).sub(fe)}const me=w.zoomScale(U-T);let te,ue;d.around&&(te=i.LngLat.convert(d.around),ue=w.locationPoint(te));const be=this._zooming||U!==T,we=this._rotating||P!==Z,Oe=this._pitching||H!==L,Le=!w.isPaddingEqual(Q),De=Ue=>Je=>{if(be&&(Ue.zoom=i.number(T,U,Je)),we&&(Ue.bearing=i.number(P,Z,Je)),Oe&&(Ue.pitch=i.number(L,H,Je)),Le&&(Ue.interpolatePadding(z,Q,Je),de=Ue.centerPoint.add(se)),te)Ue.setLocationAtPoint(te,ue);else{const bt=Ue.zoomScale(Ue.zoom-T),Ze=U>T?Math.min(2,me):Math.max(.5,me),ut=Math.pow(Ze,1-Je),et=Ue.unproject(fe.add(he.mult(Je*ut)).mult(bt));Ue.setLocationAtPoint(Ue.renderWorldCopies?et.wrap():et,de)}return d.preloadOnly||this._fireMoveEvents(m),Ue};if(d.preloadOnly){const Ue=this._emulate(De,d.duration,w);return this._preloadTiles(Ue),this}const qe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=be,this._rotating=we,this._pitching=Oe,this._padding=Le,this._easeId=d.easeId,this._prepareEase(m,d.noMoveStart,qe),this._ease(De(w),Ue=>{w.recenterOnTerrain(),this._afterEase(m,Ue)},d),this}_prepareEase(d,m,w={}){this._moving=!0,this.transform.cameraElevationReference="sea",m||w.moving||this.fire(new i.Event("movestart",d)),this._zooming&&!w.zooming&&this.fire(new i.Event("zoomstart",d)),this._rotating&&!w.rotating&&this.fire(new i.Event("rotatestart",d)),this._pitching&&!w.pitching&&this.fire(new i.Event("pitchstart",d))}_fireMoveEvents(d){this.fire(new i.Event("move",d)),this._zooming&&this.fire(new i.Event("zoom",d)),this._rotating&&this.fire(new i.Event("rotate",d)),this._pitching&&this.fire(new i.Event("pitch",d))}_afterEase(d,m){if(this._easeId&&m&&this._easeId===m)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const w=this._zooming,T=this._rotating,P=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new i.Event("zoomend",d)),T&&this.fire(new i.Event("rotateend",d)),P&&this.fire(new i.Event("pitchend",d)),this.fire(new i.Event("moveend",d))}flyTo(d,m){if(this._prefersReducedMotion(d)){const mt=i.pick(d,["center","zoom","bearing","pitch","around"]);return this.jumpTo(mt,m)}this.stop(),d=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},d);const w=this.transform,T=this.getZoom(),P=this.getBearing(),L=this.getPitch(),z=this.getPadding(),U="zoom"in d?i.clamp(+d.zoom,w.minZoom,w.maxZoom):T,Z="bearing"in d?this._normalizeBearing(d.bearing,P):P,H="pitch"in d?+d.pitch:L,Q="padding"in d?d.padding:w.padding,se=w.zoomScale(U-T),de=i.Point.convert(d.offset);let fe=w.centerPoint.add(de);const he=w.pointLocation(fe),me=i.LngLat.convert(d.center||he);this._normalizeCenter(me);const te=w.project(he),ue=w.project(me).sub(te);let be=d.curve;const we=Math.max(w.width,w.height),Oe=we/se,Le=ue.mag();if("minZoom"in d){const mt=i.clamp(Math.min(d.minZoom,T,U),w.minZoom,w.maxZoom),St=we/w.zoomScale(mt-T);be=Math.sqrt(St/Le*2)}const De=be*be;function qe(mt){const St=(Oe*Oe-we*we+(mt?-1:1)*De*De*Le*Le)/(2*(mt?Oe:we)*De*Le);return Math.log(Math.sqrt(St*St+1)-St)}function Ue(mt){return(Math.exp(mt)-Math.exp(-mt))/2}function Je(mt){return(Math.exp(mt)+Math.exp(-mt))/2}const bt=qe(0);let Ze=function(mt){return Je(bt)/Je(bt+be*mt)},ut=function(mt){return we*((Je(bt)*(Ue(St=bt+be*mt)/Je(St))-Ue(bt))/De)/Le;var St},et=(qe(1)-bt)/be;if(Math.abs(Le)<1e-6||!isFinite(et)){if(Math.abs(we-Oe)<1e-6)return this.easeTo(d,m);const mt=Oe<we?-1:1;et=Math.abs(Math.log(Oe/we))/be,ut=function(){return 0},Ze=function(St){return Math.exp(mt*be*St)}}d.duration="duration"in d?+d.duration:1e3*et/("screenSpeed"in d?+d.screenSpeed/be:+d.speed),d.maxDuration&&d.duration>d.maxDuration&&(d.duration=0);const xt=P!==Z,Ye=H!==L,ct=!w.isPaddingEqual(Q),wt=mt=>St=>{const Kt=St*et,sr=1/Ze(Kt);mt.zoom=St===1?U:T+mt.scaleZoom(sr),xt&&(mt.bearing=i.number(P,Z,St)),Ye&&(mt.pitch=i.number(L,H,St)),ct&&(mt.interpolatePadding(z,Q,St),fe=mt.centerPoint.add(de));const Ut=St===1?me:mt.unproject(te.add(ue.mult(ut(Kt))).mult(sr));return mt.setLocationAtPoint(mt.renderWorldCopies?Ut.wrap():Ut,fe),mt._updateCameraOnTerrain(),d.preloadOnly||this._fireMoveEvents(m),mt};if(d.preloadOnly){const mt=this._emulate(wt,d.duration,w);return this._preloadTiles(mt),this}return this._zooming=!0,this._rotating=xt,this._pitching=Ye,this._padding=ct,this._prepareEase(m,!1),this._ease(wt(w),()=>this._afterEase(m),d),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(d,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const w=this._onEaseEnd;this._onEaseEnd=void 0,w.call(this,m)}if(!d){const w=this.handlers;w&&w.stop(!1)}return this}_ease(d,m,w){w.animate===!1||w.duration===0?(d(1),m()):(this._easeStart=i.exported.now(),this._easeOptions=w,this._onEaseFrame=d,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const d=Math.min((i.exported.now()-this._easeStart)/this._easeOptions.duration,1),m=this._onEaseFrame;m&&m(this._easeOptions.easing(d)),d<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(d,m){d=i.wrap(d,-180,180);const w=Math.abs(d-m);return Math.abs(d-360-m)<w&&(d-=360),Math.abs(d+360-m)<w&&(d+=360),d}_normalizeCenter(d){const m=this.transform;if(!m.renderWorldCopies||m.maxBounds)return;const w=d.lng-m.center.lng;d.lng+=w>180?-360:w<-180?360:0}_prefersReducedMotion(d){return this._respectPrefersReducedMotion&&i.exported.prefersReducedMotion&&!(d&&d.essential)}_emulate(d,m,w){const T=Math.ceil(15*m/1e3),P=[],L=d(w.clone());for(let z=0;z<=T;z++){const U=L(z/T);P.push(U.clone())}return P}}class zt{constructor(d={}){this.options=d,i.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(d){const m=this.options&&this.options.compact;return this._map=d,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=E("button","mapboxgl-ctrl-attrib-button",this._container),E("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=E("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(d,m){const w=this._map._getUIString(`AttributionControl.${m}`);d.setAttribute("aria-label",w),d.removeAttribute("title"),d.firstElementChild&&d.firstElementChild.setAttribute("title",w)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let d=this._editLink;d||(d=this._editLink=this._container.querySelector(".mapbox-improve-map"));const m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.config.ACCESS_TOKEN}];if(d){const w=m.reduce((T,P,L)=>(P.value&&(T+=`${P.key}=${P.value}${L<m.length-1?"&":""}`),T),"?");d.href=`${i.config.FEEDBACK_URL}/${w}#${eh(this._map,!0)}`,d.rel="noopener nofollow",this._setElementTitle(d,"MapFeedback")}}_updateData(d){!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let d=[];if(this._map.style.stylesheet){const T=this._map.style.stylesheet;this.styleOwner=T.owner,this.styleId=T.id}const m=this._map.style._sourceCaches;for(const T in m){const P=m[T];if(P.used){const L=P.getSource();L.attribution&&d.indexOf(L.attribution)<0&&d.push(L.attribution)}}d.sort((T,P)=>T.length-P.length),d=d.filter((T,P)=>{for(let L=P+1;L<d.length;L++)if(d[L].indexOf(T)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?d=[...this.options.customAttribution,...d]:d.unshift(this.options.customAttribution));const w=d.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,d.length?(this._innerContainer.innerHTML=w,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class xy{constructor(){i.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(d){this._map=d,this._container=E("div","mapboxgl-ctrl");const m=E("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(d){d&&d.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const d=this._map.style._sourceCaches;if(Object.entries(d).length===0)return!0;for(const m in d){const w=d[m].getSource();if(w.hasOwnProperty("mapbox_logo")&&!w.mapbox_logo)return!1}return!0}_updateCompact(){const d=this._container.children;if(d.length){const m=d[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}}}class by{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(d){const m=++this._id;return this._queue.push({callback:d,id:m,cancelled:!1}),m}remove(d){const m=this._currentlyRunning,w=m?this._queue.concat(m):this._queue;for(const T of w)if(T.id===d)return void(T.cancelled=!0)}run(d=0){const m=this._currentlyRunning=this._queue;this._queue=[];for(const w of m)if(!w.cancelled&&(w.callback(d),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function pu(v,d,m){if(v=new i.LngLat(v.lng,v.lat),d){const w=new i.LngLat(v.lng-360,v.lat),T=new i.LngLat(v.lng+360,v.lat),P=360*Math.ceil(Math.abs(v.lng-m.center.lng)/360),L=m.locationPoint(v).distSqr(d),z=d.x<0||d.y<0||d.x>m.width||d.y>m.height;m.locationPoint(w).distSqr(d)<L&&(z||Math.abs(w.lng-m.center.lng)<P)?v=w:m.locationPoint(T).distSqr(d)<L&&(z||Math.abs(T.lng-m.center.lng)<P)&&(v=T)}for(;Math.abs(v.lng-m.center.lng)>180;){const w=m.locationPoint(v);if(w.x>=0&&w.y>=0&&w.x<=m.width&&w.y<=m.height)break;v.lng>m.center.lng?v.lng-=360:v.lng+=360}return v}const Kl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Rt extends i.Evented{constructor(d,m){if(super(),(d instanceof i.window.HTMLElement||m)&&(d=i.extend({element:d},m)),i.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=d&&d.anchor||"center",this._color=d&&d.color||"#3FB1CE",this._scale=d&&d.scale||1,this._draggable=d&&d.draggable||!1,this._clickTolerance=d&&d.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=d&&d.rotation||0,this._rotationAlignment=d&&d.rotationAlignment||"auto",this._pitchAlignment=d&&d.pitchAlignment&&d.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=d&&d.occludedOpacity||.2,d&&d.element)this._element=d.element,this._offset=i.Point.convert(d&&d.offset||[0,0]);else{this._defaultMarker=!0,this._element=E("div");const T=41,P=27,L=C("svg",{display:"block",height:T*this._scale+"px",width:P*this._scale+"px",viewBox:`0 0 ${P} ${T}`},this._element),z=C("radialGradient",{id:"shadowGradient"},C("defs",{},L));C("stop",{offset:"10%","stop-opacity":.4},z),C("stop",{offset:"100%","stop-opacity":.05},z),C("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},L),C("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},L),C("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},L),C("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},L),this._offset=i.Point.convert(d&&d.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",T=>{T.preventDefault()}),this._element.addEventListener("mousedown",T=>{T.preventDefault()});const w=this._element.classList;for(const T in Kl)w.remove(`mapboxgl-marker-anchor-${T}`);w.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(d){return d===this._map||(this.remove(),this._map=d,d.getCanvasContainer().appendChild(this._element),d.on("move",this._updateMoving),d.on("moveend",this._update),d.on("remove",this._clearFadeTimer),d._addMarker(this),this.setDraggable(this._draggable),this._update(),d.on("click",this._onMapClick)),this}remove(){const d=this._map;return d&&(d.off("click",this._onMapClick),d.off("move",this._updateMoving),d.off("moveend",this._update),d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler),d.off("mouseup",this._onUp),d.off("touchend",this._onUp),d.off("mousemove",this._onMove),d.off("touchmove",this._onMove),d.off("remove",this._clearFadeTimer),d._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=i.LngLat.convert(d),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(d){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),d){if(!("offset"in d.options)){const T=Math.sqrt(Math.pow(13.5,2)/2);d.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[T,-1*(38.1-13.5+T)],"bottom-right":[-T,-1*(38.1-13.5+T)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=d,d._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(d){const m=d.code,w=d.charCode||d.keyCode;m!=="Space"&&m!=="Enter"&&w!==32&&w!==13||this.togglePopup()}_onMapClick(d){const m=d.originalEvent.target,w=this._element;this._popup&&(m===w||w.contains(m))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const d=this._popup;return d?(d.isOpen()?(d.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(d.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const d=this._map,m=this._pos;if(!d||!m)return!1;const w=d.unproject(m),T=d.getFreeCameraOptions();if(!T.position)return!1;const P=T.position.toLngLat();return P.distanceTo(w)<.9*P.distanceTo(this._lngLat)}_evaluateOpacity(){const d=this._map;if(!d)return;const m=this._pos;if(!m||m.x<0||m.x>d.transform.width||m.y<0||m.y>d.transform.height)return void this._clearFadeTimer();const w=d.unproject(m);let T;d._showingGlobe()&&i.isLngLatBehindGlobe(d.transform,this._lngLat)?T=0:(T=1-d._queryFogOpacity(w),d.transform._terrainEnabled()&&d.getTerrain()&&this._behindTerrain()&&(T*=this._occludedOpacity)),this._element.style.opacity=`${T}`,this._element.style.pointerEvents=T>0?"auto":"none",this._popup&&this._popup._setOpacity(T),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const d=this._pos;if(!d||!this._map)return;const m=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${d.x}px,${d.y}px)
            ${Kl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${m.x}px,${m.y}px)
        `}_calculateXYTransform(){const d=this._pos,m=this._map,w=this.getPitchAlignment();if(!m||!d||w!=="map")return"";if(!m._showingGlobe()){const U=m.getPitch();return U?`rotateX(${U}deg)`:""}const T=i.radToDeg(i.globeTiltAtLngLat(m.transform,this._lngLat)),P=d.sub(i.globeCenterToScreenPoint(m.transform)),L=Math.abs(P.x)+Math.abs(P.y);if(L===0)return"";const z=T/L;return`rotateX(${-P.y*z}deg) rotateY(${P.x*z}deg)`}_calculateZTransform(){const d=this._pos,m=this._map;if(!m||!d)return"";let w=0;const T=this.getRotationAlignment();if(T==="map")if(m._showingGlobe()){const P=m.project(new i.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),L=m.project(new i.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(P);w=i.radToDeg(Math.atan2(L.y,L.x))-90}else w=-m.getBearing();else if(T==="horizon"){const P=i.smoothstep(4,6,m.getZoom()),L=i.globeCenterToScreenPoint(m.transform);L.y+=P*m.transform.height;const z=d.sub(L),U=i.radToDeg(Math.atan2(z.y,z.x));w=(U>90?U-270:U+90)*(1-P)}return w+=this._rotation,w?`rotateZ(${w}deg)`:""}_update(d){i.window.cancelAnimationFrame(this._updateFrameId);const m=this._map;m&&(m.transform.renderWorldCopies&&(this._lngLat=pu(this._lngLat,this._pos,m.transform)),this._pos=m.project(this._lngLat),d===!0?this._updateFrameId=i.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),m._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(m._showingGlobe()||m.getTerrain()||m.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(d){return this._offset=i.Point.convert(d),this._update(),this}_onMove(d){const m=this._map;if(!m)return;const w=this._pointerdownPos,T=this._positionDelta;if(w&&T){if(!this._isDragging){const P=this._clickTolerance||m._clickTolerance;if(d.point.dist(w)<P)return;this._isDragging=!0}this._pos=d.point.sub(T),this._lngLat=m.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.Event("dragstart"))),this.fire(new i.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const d=this._map;d&&(d.off("mousemove",this._onMove),d.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.Event("dragend")),this._state="inactive"}_addDragHandler(d){const m=this._map,w=this._pos;m&&w&&this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(w),this._pointerdownPos=d.point,this._state="pending",m.on("mousemove",this._onMove),m.on("touchmove",this._onMove),m.once("mouseup",this._onUp),m.once("touchend",this._onUp))}setDraggable(d){this._draggable=!!d;const m=this._map;return m&&(d?(m.on("mousedown",this._addDragHandler),m.on("touchstart",this._addDragHandler)):(m.off("mousedown",this._addDragHandler),m.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(d){return this._rotation=d||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(d){return this._rotationAlignment=d||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(d){return this._pitchAlignment=d||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(d){return this._occludedOpacity=d||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const _y={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},oT=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function F0(v=new i.Point(0,0),d="bottom"){if(typeof v=="number"){const m=Math.round(Math.sqrt(.5*Math.pow(v,2)));switch(d){case"top":return new i.Point(0,v);case"top-left":return new i.Point(m,m);case"top-right":return new i.Point(-m,m);case"bottom":return new i.Point(0,-v);case"bottom-left":return new i.Point(m,-m);case"bottom-right":return new i.Point(-m,-m);case"left":return new i.Point(v,0);case"right":return new i.Point(-v,0)}return new i.Point(0,0)}return v instanceof i.Point||Array.isArray(v)?i.Point.convert(v):i.Point.convert(v[d]||[0,0])}class wy{constructor(d){this.jumpTo(d)}getValue(d){if(d<=this._startTime)return this._start;if(d>=this._endTime)return this._end;const m=i.easeCubicInOut((d-this._startTime)/(this._endTime-this._startTime));return this._start*(1-m)+this._end*m}isEasing(d){return d>=this._startTime&&d<=this._endTime}jumpTo(d){this._startTime=-1/0,this._endTime=-1/0,this._start=d,this._end=d}easeTo(d,m,w){this._start=this.getValue(m),this._end=d,this._startTime=m,this._endTime=m+w}}const U0={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},V0={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},aT={showCompass:!0,showZoom:!0,visualizePitch:!1};class sT{constructor(d,m,w=!1){this._clickTolerance=10,this.element=m,this.mouseRotate=new py({clickTolerance:d.dragRotate._mouseRotate._clickTolerance}),this.map=d,w&&(this.mousePitch=new my({clickTolerance:d.dragRotate._mousePitch._clickTolerance})),i.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),m.addEventListener("mousedown",this.mousedown),m.addEventListener("touchstart",this.touchstart,{passive:!1}),m.addEventListener("touchmove",this.touchmove),m.addEventListener("touchend",this.touchend),m.addEventListener("touchcancel",this.reset)}down(d,m){this.mouseRotate.mousedown(d,m),this.mousePitch&&this.mousePitch.mousedown(d,m),B()}move(d,m){const w=this.map,T=this.mouseRotate.mousemoveWindow(d,m),P=T&&T.bearingDelta;if(P&&w.setBearing(w.getBearing()+P),this.mousePitch){const L=this.mousePitch.mousemoveWindow(d,m),z=L&&L.pitchDelta;z&&w.setPitch(w.getPitch()+z)}}off(){const d=this.element;d.removeEventListener("mousedown",this.mousedown),d.removeEventListener("touchstart",this.touchstart,{passive:!1}),d.removeEventListener("touchmove",this.touchmove),d.removeEventListener("touchend",this.touchend),d.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){O(),i.window.removeEventListener("mousemove",this.mousemove),i.window.removeEventListener("mouseup",this.mouseup)}mousedown(d){this.down(i.extend({},d,{ctrlKey:!0,preventDefault:()=>d.preventDefault()}),F(this.element,d)),i.window.addEventListener("mousemove",this.mousemove),i.window.addEventListener("mouseup",this.mouseup)}mousemove(d){this.move(d,F(this.element,d))}mouseup(d){this.mouseRotate.mouseupWindow(d),this.mousePitch&&this.mousePitch.mouseupWindow(d),this.offTemp()}touchstart(d){d.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=X(this.element,d.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>d.preventDefault()},this._startPos))}touchmove(d){d.targetTouches.length!==1?this.reset():(this._lastPos=X(this.element,d.targetTouches)[0],this.move({preventDefault:()=>d.preventDefault()},this._lastPos))}touchend(d){d.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Sy={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ey={maxWidth:100,unit:"metric"},Ty={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},mu={version:i.version,supported:y,setRTLTextPlugin:i.setRTLTextPlugin,getRTLTextPluginStatus:i.getRTLTextPluginStatus,Map:class extends np{constructor(v){if(i.LivePerformanceUtils.mark(i.PerformanceMarkers.create),(v=i.extend({},V0,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(v.antialias&&i.isSafariWithAntialiasingBug(i.window)&&(v.antialias=!1,i.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new uu(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),v),this._interactive=v.interactive,this._minTileCacheSize=v.minTileCacheSize,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._useWebGL2=v.useWebGL2,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=v.crossSourceCollisions,this._collectResourceTiming=v.collectResourceTiming,this._optimizeForTerrain=v.optimizeForTerrain,this._language=this._parseLanguage(v.language),this._worldview=v.worldview,this._renderTaskQueue=new by,this._domRenderTaskQueue=new by,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.uniqueId(),this._locale=i.extend({},U0,v.locale),this._clickTolerance=v.clickTolerance,this._cooperativeGestures=v.cooperativeGestures,this._performanceMetricsCollection=v.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new wy(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new i.RequestManager(v.transformRequest,v.accessToken,v.testMode),this._silenceAuthErrors=!!v.testMode,typeof v.container=="string"){if(this._container=i.window.document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof i.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(this._container.childNodes.length>0&&i.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),v.maxBounds&&this.setMaxBounds(v.maxBounds),i.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),i.window!==void 0&&(i.window.addEventListener("online",this._onWindowOnline,!1),i.window.addEventListener("resize",this._onWindowResize,!1),i.window.addEventListener("orientationchange",this._onWindowResize,!1),i.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),i.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Ba(this,v),this._localFontFamily=v.localFontFamily,this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),v.projection&&this.setProjection(v.projection),this._hash=v.hash&&new uy(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,i.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),v.attributionControl&&this.addControl(new zt({customAttribution:v.customAttribution})),this._logoControl=new xy,this.addControl(this._logoControl,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",d=>{this._update(d.dataType==="style"),this.fire(new i.Event(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new i.Event(`${d.dataType}dataloading`,d))})}_getMapId(){return this._mapId}addControl(v,d){if(d===void 0&&(d=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=v.onAdd(this);this._controls.push(v);const w=this._controlPositions[d];return d.indexOf("bottom")!==-1?w.insertBefore(m,w.firstChild):w.appendChild(m),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const d=this._controls.indexOf(v);return d>-1&&this._controls.splice(d,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(v){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const d=!this._moving;return d&&this.fire(new i.Event("movestart",v)).fire(new i.Event("move",v)),this.fire(new i.Event("resize",v)),d&&this.fire(new i.Event("moveend",v)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(v){return this.transform.setMaxBounds(i.LngLatBounds.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v?this.setZoom(v):this.fire(new i.Event("zoomstart")).fire(new i.Event("zoom")).fire(new i.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v?this.setZoom(v):this.fire(new i.Event("zoomstart")).fire(new i.Event("zoom")).fire(new i.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v?this.setPitch(v):this.fire(new i.Event("pitchstart")).fire(new i.Event("pitch")).fire(new i.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v?this.setPitch(v):this.fire(new i.Event("pitchstart")).fire(new i.Event("pitch")).fire(new i.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(v){return v==="auto"?i.window.navigator.language:Array.isArray(v)?v.length===0?void 0:v.map(d=>d==="auto"?i.window.navigator.language:d):v}setLanguage(v){const d=this._parseLanguage(v);if(!this.style||d===this._language)return this;this._language=d,this.style._reloadSources();for(const m of this._controls)m._setLanguage&&m._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(v){return this.style&&v!==this._worldview?(this._worldview=v,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(v){return this._lazyInitEmptyStyle(),v?typeof v=="string"&&(v={name:v}):v=null,this._useExplicitProjection=!!v,this._prioritizeAndUpdateProjection(v,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const v=this.transform,d=v.projection.name;let m;d==="globe"&&v.zoom>=i.GLOBE_ZOOM_THRESHOLD_MAX?(v.setMercatorFromTransition(),m=!0):d==="mercator"&&v.zoom<i.GLOBE_ZOOM_THRESHOLD_MAX&&(v.setProjection({name:"globe"}),m=!0),m&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(v,d){return this._updateProjection(v||d||{name:"mercator"})}_updateProjection(v){let d;if(d=v.name==="globe"&&this.transform.zoom>=i.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(v),this.style.applyProjectionUpdate(),d){this.painter.clearBackgroundTiles();for(const m in this.style._sourceCaches)this.style._sourceCaches[m].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(v){return this.transform.locationPoint3D(i.LngLat.convert(v))}unproject(v){return this.transform.pointLocation3D(i.Point.convert(v))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(v,d,m){if(v==="mouseenter"||v==="mouseover"){let w=!1;const T=L=>{const z=d.filter(Z=>this.getLayer(Z)),U=z.length?this.queryRenderedFeatures(L.point,{layers:z}):[];U.length?w||(w=!0,m.call(this,new xi(v,this,L.originalEvent,{features:U}))):w=!1},P=()=>{w=!1};return{layers:new Set(d),listener:m,delegates:{mousemove:T,mouseout:P}}}if(v==="mouseleave"||v==="mouseout"){let w=!1;const T=L=>{const z=d.filter(U=>this.getLayer(U));(z.length?this.queryRenderedFeatures(L.point,{layers:z}):[]).length?w=!0:w&&(w=!1,m.call(this,new xi(v,this,L.originalEvent)))},P=L=>{w&&(w=!1,m.call(this,new xi(v,this,L.originalEvent)))};return{layers:new Set(d),listener:m,delegates:{mousemove:T,mouseout:P}}}{const w=T=>{const P=d.filter(z=>this.getLayer(z)),L=P.length?this.queryRenderedFeatures(T.point,{layers:P}):[];L.length&&(T.features=L,m.call(this,T),delete T.features)};return{layers:new Set(d),listener:m,delegates:{[v]:w}}}}on(v,d,m){if(m===void 0)return super.on(v,d);Array.isArray(d)||(d=[d]);const w=this._createDelegatedListener(v,d,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(w);for(const T in w.delegates)this.on(T,w.delegates[T]);return this}once(v,d,m){if(m===void 0)return super.once(v,d);Array.isArray(d)||(d=[d]);const w=this._createDelegatedListener(v,d,m);for(const T in w.delegates)this.once(T,w.delegates[T]);return this}off(v,d,m){if(m===void 0)return super.off(v,d);d=new Set(Array.isArray(d)?d:[d]);const w=(P,L)=>{if(P.size!==L.size)return!1;for(const z of P)if(!L.has(z))return!1;return!0},T=this._delegatedListeners?this._delegatedListeners[v]:void 0;return T&&(P=>{for(let L=0;L<P.length;L++){const z=P[L];if(z.listener===m&&w(z.layers,d)){for(const U in z.delegates)this.off(U,z.delegates[U]);return P.splice(L,1),this}}})(T),this}queryRenderedFeatures(v,d){return this.style?(d!==void 0||v===void 0||v instanceof i.Point||Array.isArray(v)||(d=v,v=void 0),this.style.queryRenderedFeatures(v=v||[[0,0],[this.transform.width,this.transform.height]],d=d||{},this.transform)):[]}querySourceFeatures(v,d){return this.style.querySourceFeatures(v,d)}isPointOnSurface(v){const{name:d}=this.transform.projection;return d!=="globe"&&d!=="mercator"&&i.warnOnce(`${d} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.Point.convert(v))}setStyle(v,d){return(d=i.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},d)).diff!==!1&&d.localIdeographFontFamily===this._localIdeographFontFamily&&d.localFontFamily===this._localFontFamily&&this.style&&v?(this._diffStyle(v,d),this):(this._localIdeographFontFamily=d.localIdeographFontFamily,this._localFontFamily=d.localFontFamily,this._updateStyle(v,d))}_getUIString(v){const d=this._locale[v];if(d==null)throw new Error(`Missing UI string '${v}'`);return d}_updateStyle(v,d){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),v&&(this.style=new Ra(this,d||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v):this.style.loadJSON(v)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ra(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,d){if(typeof v=="string"){const m=this._requestManager.normalizeStyleURL(v),w=this._requestManager.transformRequest(m,i.ResourceType.Style);i.getJSON(w,(T,P)=>{T?this.fire(new i.ErrorEvent(T)):P&&this._updateDiff(P,d)})}else typeof v=="object"&&this._updateDiff(v,d)}_updateDiff(v,d){try{this.style.setState(v)&&this._update(!0)}catch(m){i.warnOnce(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(v,d)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.warnOnce("There is no style added to the map."),!1)}addSource(v,d){return this._lazyInitEmptyStyle(),this.style.addSource(v,d),this._update(!0)}isSourceLoaded(v){return!!this.style&&this.style._isSourceCacheLoaded(v)}areTilesLoaded(){const v=this.style&&this.style._sourceCaches;for(const d in v){const m=v[d]._tiles;for(const w in m){const T=m[w];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}addSourceType(v,d,m){this._lazyInitEmptyStyle(),this.style.addSourceType(v,d,m)}removeSource(v){return this.style.removeSource(v),this._updateTerrain(),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,d,{pixelRatio:m=1,sdf:w=!1,stretchX:T,stretchY:P,content:L}={}){if(this._lazyInitEmptyStyle(),d instanceof i.window.HTMLImageElement||i.window.ImageBitmap&&d instanceof i.window.ImageBitmap){const{width:z,height:U,data:Z}=i.exported.getImageData(d);this.style.addImage(v,{data:new i.RGBAImage({width:z,height:U},Z),pixelRatio:m,stretchX:T,stretchY:P,content:L,sdf:w,version:0})}else if(d.width===void 0||d.height===void 0)this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:z,height:U}=d,Z=d;this.style.addImage(v,{data:new i.RGBAImage({width:z,height:U},new Uint8Array(Z.data)),pixelRatio:m,stretchX:T,stretchY:P,content:L,sdf:w,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,v)}}updateImage(v,d){const m=this.style.getImage(v);if(!m)return void this.fire(new i.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=d instanceof i.window.HTMLImageElement||i.window.ImageBitmap&&d instanceof i.window.ImageBitmap?i.exported.getImageData(d):d,{width:T,height:P}=w;T!==void 0&&P!==void 0?T===m.data.width&&P===m.data.height?(m.data.replace(w.data,!(d instanceof i.window.HTMLImageElement||i.window.ImageBitmap&&d instanceof i.window.ImageBitmap)),this.style.updateImage(v,m)):this.fire(new i.ErrorEvent(new Error(`The width and height of the updated image (${T}, ${P})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`))):this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new i.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,d){i.getImage(this._requestManager.transformRequest(v,i.ResourceType.Image),(m,w)=>{d(m,w instanceof i.window.HTMLImageElement?i.exported.getImageData(w):w)})}listImages(){return this.style.listImages()}addLayer(v,d){return this._lazyInitEmptyStyle(),this.style.addLayer(v,d),this._update(!0)}moveLayer(v,d){return this.style.moveLayer(v,d),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,d,m){return this.style.setLayerZoomRange(v,d,m),this._update(!0)}setFilter(v,d,m={}){return this.style.setFilter(v,d,m),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,d,m,w={}){return this.style.setPaintProperty(v,d,m,w),this._update(!0)}getPaintProperty(v,d){return this.style.getPaintProperty(v,d)}setLayoutProperty(v,d,m,w={}){return this.style.setLayoutProperty(v,d,m,w),this._update(!0)}getLayoutProperty(v,d){return this.style.getLayoutProperty(v,d)}setLight(v,d={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,d),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(v){return this._lazyInitEmptyStyle(),!v&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(v),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(v){return this._lazyInitEmptyStyle(),this.style.setFog(v),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(v){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.LngLat.convert(v),this.transform):0}setFeatureState(v,d){return this.style.setFeatureState(v,d),this._update()}removeFeatureState(v,d){return this.style.removeFeatureState(v,d),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}_updateContainerDimensions(){if(!this._container)return;const v=this._container.getBoundingClientRect().width||400,d=this._container.getBoundingClientRect().height||300;let m,w,T,P=this._container;for(;P&&(!w||!T);){const L=i.window.getComputedStyle(P).transform;L&&L!=="none"&&(m=L.match(/matrix.*\((.+)\)/)[1].split(", "),m[0]&&m[0]!=="0"&&m[0]!=="1"&&(w=m[0]),m[3]&&m[3]!=="0"&&m[3]!=="1"&&(T=m[3])),P=P.parentElement}this._containerWidth=w?Math.abs(v/w):v,this._containerHeight=T?Math.abs(d/T):d}_detectMissingCSS(){i.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=E("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();const d=this._canvasContainer=E("div","mapboxgl-canvas-container",v);this._interactive&&d.classList.add("mapboxgl-interactive"),this._canvas=E("canvas","mapboxgl-canvas",d),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const m=this._controlContainer=E("div","mapboxgl-control-container",v),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(T=>{w[T]=E("div",`mapboxgl-ctrl-${T}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,d){const m=i.exported.devicePixelRatio||1;this._canvas.width=m*Math.ceil(v),this._canvas.height=m*Math.ceil(d),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${d}px`}_addMarker(v){this._markers.push(v)}_removeMarker(v){const d=this._markers.indexOf(v);d!==-1&&this._markers.splice(d,1)}_addPopup(v){this._popups.push(v)}_removePopup(v){const d=this._popups.indexOf(v);d!==-1&&this._popups.splice(d,1)}_setupPainter(){const v=i.extend({},y.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),d=this._useWebGL2&&this._canvas.getContext("webgl2",v),m=d||this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);m?(this._useWebGL2&&!d&&i.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),i.storeAuthState(m,!0),this.painter=new lu(m,this.transform,!!d),this.on("data",w=>{w.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.exported$1.testSupport(m)):this.fire(new i.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.Event("webglcontextlost",{originalEvent:v}))}_contextRestored(v){this._setupPainter(),this.resize(),this._update(),this.fire(new i.Event("webglcontextrestored",{originalEvent:v}))}_onMapScroll(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_requestDomTask(v){!this.loaded()||this.loaded()&&!this.isMoving()?v():this._domRenderTaskQueue.add(v)}_render(v){let d;const m=this.painter.context.extTimerQuery,w=i.exported.now();if(this.listens("gpu-timing-frame")&&(d=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,d)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],i.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],i.window.performance.now())),this._renderTaskQueue.run(v),this._domRenderTaskQueue.run(v),this._removed)return;this._updateProjectionTransition();const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,U=this.transform.pitch,Z=i.exported.now(),H=new i.EvaluationParameters(z,{now:Z,fadeDuration:T,pitch:U,transition:this.style.getTransition()});this.style.update(H)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let P=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),P=this._updateAverageElevation(w),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):P=this._updateAverageElevation(w),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new i.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),d){const z=i.exported.now()-w;m.endQueryEXT(m.TIME_ELAPSED_EXT,d),setTimeout(()=>{const U=m.getQueryObjectEXT(d,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(d),this.fire(new i.Event("gpu-timing-frame",{cpuTime:z,gpuTime:U})),i.window.performance.mark("frame-gpu",{startTime:w,detail:{gpuTime:U}})},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const U=this.painter.queryGpuTimers(z);this.fire(new i.Event("gpu-timing-layer",{layerTimes:U}))},50)}if(this.listens("gpu-timing-deferred-render")){const z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const U=this.painter.queryGpuTimeDeferredRender(z);this.fire(new i.Event("gpu-timing-deferred-render",{gpuTime:U}))},50)}const L=this._sourcesDirty||this._styleDirty||this._placementDirty||P;if(L||this._repaint)this.triggerRepaint();else{const z=!this.isMoving()&&this.loaded();if(z&&(P=this._updateAverageElevation(w,!0)),P)this.triggerRepaint();else if(this._triggerFrame(!1),z&&(this.fire(new i.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const U=this._calculateSpeedIndex();this.fire(new i.Event("speedindexcompleted",{speedIndex:U})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||L||(this._fullyLoaded=!0,i.LivePerformanceUtils.mark(i.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&i.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(v){for(const d of this._markers)v&&!this.getRenderWorldCopies()&&(d._lngLat=d._lngLat.wrap()),d._update();for(const d of this._popups)!v||this.getRenderWorldCopies()||d._trackPointer||(d._lngLat=d._lngLat.wrap()),d._update()}_updateAverageElevation(v,d=!1){const m=w=>(this.transform.averageElevation=w,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&m(0);if((d||v-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(v)){const w=this.transform.averageElevation;let T=this.transform.sampleAverageElevation(),P=!1;this.transform.elevation&&(P=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(T)?T=0:this._averageElevationLastSampledAt=v;const L=Math.abs(w-T);if(L>1){if(this._isInitialLoad||P)return this._averageElevation.jumpTo(T),m(T);this._averageElevation.easeTo(T,v,300)}else if(L>1e-4)return this._averageElevation.jumpTo(T),m(T)}return!!this._averageElevation.isEasing(v)&&m(this._averageElevation.getValue(v))}_authenticate(){i.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,v=>{if(v&&(v.message===i.AUTH_ERR_MSG||v.status===401)){const d=this.painter.context.gl;i.storeAuthState(d,!1),this._logoControl instanceof xy&&this._logoControl._updateLogo(),d&&d.clear(d.DEPTH_BUFFER_BIT|d.COLOR_BUFFER_BIT|d.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),i.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const v=this._isDragging();this.painter.updateTerrain(this.style,v)}_calculateSpeedIndex(){const v=this.painter.canvasCopy(),d=this.painter.getCanvasCopiesAndTimestamps();d.timeStamps.push(performance.now());const m=this.painter.context.gl,w=m.createFramebuffer();function T(P){m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,P,0);const L=new Uint8Array(m.drawingBufferWidth*m.drawingBufferHeight*4);return m.readPixels(0,0,m.drawingBufferWidth,m.drawingBufferHeight,m.RGBA,m.UNSIGNED_BYTE,L),L}return m.bindFramebuffer(m.FRAMEBUFFER,w),this._canvasPixelComparison(T(v),d.canvasCopies.map(T),d.timeStamps)}_canvasPixelComparison(v,d,m){let w=m[1]-m[0];const T=v.length/4;for(let P=0;P<d.length;P++){const L=d[P];let z=0;for(let U=0;U<L.length;U+=4)L[U]===v[U]&&L[U+1]===v[U+1]&&L[U+2]===v[U+2]&&L[U+3]===v[U+3]&&(z+=1);w+=(m[P+2]-m[P+1])*(1-z/T)}return w}remove(){this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),i.window!==void 0&&(i.window.removeEventListener("resize",this._onWindowResize,!1),i.window.removeEventListener("orientationchange",this._onWindowResize,!1),i.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),i.window.removeEventListener("online",this._onWindowOnline,!1),i.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const v=this.painter.context.gl.getExtension("WEBGL_lose_context");v&&v.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),i.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new i.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(v){this._renderNextFrame=this._renderNextFrame||v,this.style&&!this._frame&&(this._frame=i.exported.frame(d=>{const m=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,m&&this._render(d)}))}_preloadTiles(v){const d=this.style?Object.values(this.style._sourceCaches):[];return i.asyncAll(d,(m,w)=>m._preloadTiles(v,w),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(v){this._trackResize&&this.resize({originalEvent:v})._update()}_onVisibilityChange(){i.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(v){this._showTerrainWireframe!==v&&(this._showTerrainWireframe=v,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(v){this._speedIndexTiming!==v&&(this._speedIndexTiming=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(v){this._showTileAABBs!==v&&(this._showTileAABBs=v,v&&this._update())}_setCacheLimits(v,d){i.setCacheLimits(v,d)}get version(){return i.version}},NavigationControl:class{constructor(v){this.options=i.extend({},aT,v),this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",d=>d.preventDefault()),this.options.showZoom&&(i.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",d=>{this._map&&this._map.zoomIn({},{originalEvent:d})}),E("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",d=>{this._map&&this._map.zoomOut({},{originalEvent:d})}),E("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",d=>{const m=this._map;m&&(this.options.visualizePitch?m.resetNorthPitch({},{originalEvent:d}):m.resetNorth({},{originalEvent:d}))}),this._compassIcon=E("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const v=this._map;if(!v)return;const d=v.getZoom(),m=d===v.getMaxZoom(),w=d===v.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())}_rotateCompassArrow(){const v=this._map;if(!v)return;const d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(v.transform.pitch*(Math.PI/180)),.5)}) rotateX(${v.transform.pitch}deg) rotateZ(${v.transform.angle*(180/Math.PI)}deg)`:`rotate(${v.transform.angle*(180/Math.PI)}deg)`;v._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=d)})}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),v.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&v.on("pitch",this._rotateCompassArrow),v.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new sT(v,this._compass,this.options.visualizePitch)),this._container}onRemove(){const v=this._map;v&&(this._container.remove(),this.options.showZoom&&v.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&v.off("pitch",this._rotateCompassArrow),v.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(v,d){const m=E("button",v,this._container);return m.type="button",m.addEventListener("click",d),m}_setButtonTitle(v,d){if(!this._map)return;const m=this._map._getUIString(`NavigationControl.${d}`);v.setAttribute("aria-label",m),v.firstElementChild&&v.firstElementChild.setAttribute("title",m)}},GeolocateControl:class extends i.Evented{constructor(v){super(),this.options=i.extend({geolocation:i.window.navigator.geolocation},Sy,v),i.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=du(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(v){return this._map=v,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(v){const d=(m=!!this.options.geolocation)=>{this._supportsGeolocation=m,v(m)};this._supportsGeolocation!==void 0?v(this._supportsGeolocation):i.window.navigator.permissions!==void 0?i.window.navigator.permissions.query({name:"geolocation"}).then(m=>d(m.state!=="denied")).catch(()=>d()):d()}_isOutOfMapMaxBounds(v){const d=this._map.getMaxBounds(),m=v.coords;return!!d&&(m.longitude<d.getWest()||m.longitude>d.getEast()||m.latitude<d.getSouth()||m.latitude>d.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(v){if(this._map){if(this._isOutOfMapMaxBounds(v))return this._setErrorState(),this.fire(new i.Event("outofmaxbounds",v)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=v,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(v),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(v),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("geolocate",v)),this._finish()}}_updateCamera(v){const d=new i.LngLat(v.coords.longitude,v.coords.latitude),m=v.coords.accuracy,w=this._map.getBearing(),T=i.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(d.toBounds(m),T,{geolocateSource:!0})}_updateMarker(v){if(v){const d=new i.LngLat(v.coords.longitude,v.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=v.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const v=this._map.transform,d=i.mercatorZfromAltitude(1,v._center.lat)*v.worldSize,m=Math.ceil(2*this._accuracy*d);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(v){if(this._map){if(this.options.trackUserLocation)if(v.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(v.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("error",v)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(v){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=E("button","mapboxgl-ctrl-geolocate",this._container),E("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",v===!1){i.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=E("div","mapboxgl-user-location"),this._dotElement.appendChild(E("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(E("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Rt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=E("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Rt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.Event("trackuserlocationend")))})}}_onDeviceOrientation(v){this._userLocationDotMarker&&(v.webkitCompassHeading?this._heading=v.webkitCompassHeading:v.absolute===!0&&(this._heading=-1*v.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(v={maximumAge:6e5,timeout:0},this._noTimeout=!0):(v=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,v),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const v=()=>{i.window.addEventListener("ondeviceorientationabsolute"in i.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};i.window.DeviceMotionEvent!==void 0&&typeof i.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(d=>{d==="granted"&&v()}).catch(console.error):v()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),i.window.removeEventListener("deviceorientation",this._onDeviceOrientation),i.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:zt,ScaleControl:class{constructor(v){this.options=i.extend({},Ey,v),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const v=this.options.maxWidth||100,d=this._map,m=d._containerHeight/2,w=d._containerWidth/2-v/2,T=d.unproject([w,m]),P=d.unproject([w+v,m]),L=T.distanceTo(P);if(this.options.unit==="imperial"){const z=3.2808*L;z>5280?this._setScale(v,z/5280,"mile"):this._setScale(v,z,"foot")}else this.options.unit==="nautical"?this._setScale(v,L/1852,"nautical-mile"):L>=1e3?this._setScale(v,L/1e3,"kilometer"):this._setScale(v,L,"meter")}_setScale(v,d,m){this._map._requestDomTask(()=>{const w=function(P){const L=Math.pow(10,`${Math.floor(P)}`.length-1);let z=P/L;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(U){const Z=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*Z)/Z}(z),L*z}(d),T=w/d;this._container.innerHTML=this._isNumberFormatSupported&&m!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:m}).format(w):`${w}&nbsp;${Ty[m]}`,this._container.style.width=v*T+"px"})}onAdd(v){return this._map=v,this._language=v.getLanguage(),this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-scale",v.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(v){this._language=v,this._update()}setUnit(v){this.options.unit=v,this._update()}},FullscreenControl:class{constructor(v){this._fullscreen=!1,v&&v.container&&(v.container instanceof i.window.HTMLElement?this._container=v.container:i.warnOnce("Full screen control 'container' must be a DOM element.")),i.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in i.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in i.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,i.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!i.window.document.fullscreenEnabled&&!i.window.document.webkitFullscreenEnabled)}_setupUI(){const v=this._fullscreenButton=E("button","mapboxgl-ctrl-fullscreen",this._controlContainer);E("span","mapboxgl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),i.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",v)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(i.window.document.fullscreenElement||i.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?i.window.document.exitFullscreen?i.window.document.exitFullscreen():i.window.document.webkitCancelFullScreen&&i.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.Evented{constructor(v){super(),this.options=i.extend(Object.create(_y),v),i.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(v&&v.className?v.className.trim().split(/\s+/):[])}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&v.on("preclick",this._onClose),this.options.closeOnMove&&v.on("move",this._onClose),v.on("remove",this.remove),this._update(),v._addPopup(this),this._focusFirstElement(),this._trackPointer?(v.on("mousemove",this._onMouseEvent),v.on("mouseup",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")):v.on("move",this._update),this.fire(new i.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const v=this._map;return v&&(v.off("move",this._update),v.off("move",this._onClose),v.off("preclick",this._onClose),v.off("click",this._onClose),v.off("remove",this.remove),v.off("mousemove",this._onMouseEvent),v.off("mouseup",this._onMouseEvent),v.off("drag",this._onMouseEvent),v._canvasContainer&&v._canvasContainer.classList.remove("mapboxgl-track-pointer"),v._removePopup(this),this._map=void 0),this.fire(new i.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(v){this._lngLat=i.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update();const d=this._map;return d&&(d.on("move",this._update),d.off("mousemove",this._onMouseEvent),d._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const v=this._map;return v&&(v.off("move",this._update),v.on("mousemove",this._onMouseEvent),v.on("drag",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(i.window.document.createTextNode(v))}setHTML(v){const d=i.window.document.createDocumentFragment(),m=i.window.document.createElement("body");let w;for(m.innerHTML=v;w=m.firstChild,w;)d.appendChild(w);return this.setDOMContent(d)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){let d=this._content;if(d)for(;d.hasChildNodes();)d.firstChild&&d.removeChild(d.firstChild);else d=this._content=E("div","mapboxgl-popup-content",this._container||void 0);if(d.appendChild(v),this.options.closeButton){const m=this._closeButton=E("button","mapboxgl-popup-close-button",d);m.type="button",m.setAttribute("aria-label","Close popup"),m.setAttribute("aria-hidden","true"),m.innerHTML="&#215;",m.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(v){return this._classList.add(v),this._updateClassList(),this}removeClassName(v){return this._classList.delete(v),this._updateClassList(),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){let d;return this._classList.delete(v)?d=!1:(this._classList.add(v),d=!0),this._updateClassList(),d}_onMouseEvent(v){this._update(v.point)}_getAnchor(v){if(this.options.anchor)return this.options.anchor;const d=this._map,m=this._container,w=this._pos;if(!d||!m||!w)return"bottom";const T=m.offsetWidth,P=m.offsetHeight,L=w.x<T/2,z=w.x>d.transform.width-T/2;if(w.y+v<P)return L?"top-left":z?"top-right":"top";if(w.y>d.transform.height-P){if(L)return"bottom-left";if(z)return"bottom-right"}return L?"left":z?"right":"bottom"}_updateClassList(){const v=this._container;if(!v)return;const d=[...this._classList];d.push("mapboxgl-popup"),this._anchor&&d.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&d.push("mapboxgl-popup-track-pointer"),v.className=d.join(" ")}_update(v){const d=this._map,m=this._content;if(!d||!this._lngLat&&!this._trackPointer||!m)return;let w=this._container;if(w||(w=this._container=E("div","mapboxgl-popup",d.getContainer()),this._tip=E("div","mapboxgl-popup-tip",w),w.appendChild(m)),this.options.maxWidth&&w.style.maxWidth!==this.options.maxWidth&&(w.style.maxWidth=this.options.maxWidth),d.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=pu(this._lngLat,this._pos,d.transform)),!this._trackPointer||v){const T=this._pos=this._trackPointer&&v?v:d.project(this._lngLat),P=F0(this.options.offset),L=this._anchor=this._getAnchor(P.y),z=F0(this.options.offset,L),U=T.add(z).round();d._requestDomTask(()=>{this._container&&L&&(this._container.style.transform=`${Kl[L]} translate(${U.x}px,${U.y}px)`)})}if(!this._marker&&d._showingGlobe()){const T=i.isLngLatBehindGlobe(d.transform,this._lngLat)?0:1;this._setOpacity(T)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(oT);v&&v.focus()}_onClose(){this.remove()}_setOpacity(v){this._container&&(this._container.style.opacity=`${v}`),this._content&&(this._content.style.pointerEvents=v?"auto":"none")}},Marker:Rt,Style:Ra,LngLat:i.LngLat,LngLatBounds:i.LngLatBounds,Point:i.Point,MercatorCoordinate:i.MercatorCoordinate,FreeCameraOptions:j0,Evented:i.Evented,config:i.config,prewarm:function(){Yc().acquire(Ia)},clearPrewarmedResources:function(){const v=Yi;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(Ia),Yi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return i.config.ACCESS_TOKEN},set accessToken(v){i.config.ACCESS_TOKEN=v},get baseApiUrl(){return i.config.API_URL},set baseApiUrl(v){i.config.API_URL=v},get workerCount(){return yi.workerCount},set workerCount(v){yi.workerCount=v},get maxParallelImageRequests(){return i.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(v){i.config.MAX_PARALLEL_IMAGE_REQUESTS=v},clearStorage(v){i.clearTileCache(v)},workerUrl:"",workerClass:null,setNow:i.exported.setNow,restoreNow:i.exported.restoreNow};return mu});var h=o;return h})})(qK);var GK=qK.exports;const yUe=wn(GK),vUe=AU({__proto__:null,default:yUe},[GK]);function xUe(){const e="pk.eyJ1IjoiemFrbWVhZG93czE2IiwiYSI6ImNtYzFtanRxajA1NnMyaXM5NGpicGFwdXIifQ.rE6eaOez5Q6U6t-y58gzpQ";return c.jsxs("div",{className:"p-4",children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"Mapbox Token Test"}),c.jsxs("div",{className:"bg-gray-100 p-4 rounded",children:[c.jsxs("p",{children:["Token exists: ","Yes"]}),c.jsxs("p",{children:["Token starts with 'pk.': ",e!=null&&e.startsWith("pk.")?"Yes":"No"]}),c.jsxs("p",{children:["Token length: ",(e==null?void 0:e.length)||0]}),c.jsxs("p",{children:["First 10 characters: ",e==null?void 0:e.substring(0,10),"..."]})]})]})}const bUe=()=>{var R,q;const{bookingId:e,requestId:t}=l2(),r=zi(),{toast:n}=Co(),[o,s]=D.useState(null),[h,i]=D.useState(null),[p,y]=D.useState(null),[b,_]=D.useState(!0),[E,C]=D.useState(!1),[k,N]=D.useState({cardNumber:"",expiryDate:"",cvv:"",cardholderName:""});D.useEffect(()=>{I()},[e,t]);const I=async()=>{try{_(!0);const{data:F,error:X}=await Ve.from("split_payment_requests").select(`
          *,
          bookings (
            *,
            venues (
              name,
              address,
              city
            ),
            user_profiles!bookings_user_id_fkey (
              first_name,
              last_name
            )
          )
        `).eq("id",t).eq("booking_id",e).single();if(X)throw X;if(F.status==="paid"){n({title:"Already Paid",description:"This payment request has already been completed.",variant:"destructive"}),r("/");return}if(F.status==="expired"){n({title:"Payment Expired",description:"This payment request has expired.",variant:"destructive"}),r("/");return}s(F),i(F.bookings),y(F.bookings.venues)}catch(F){console.error("Error fetching payment request:",F),n({title:"Error",description:"Failed to load payment request. Please check the link.",variant:"destructive"}),r("/")}finally{_(!1)}},B=F=>{const{name:X,value:G}=F.target;N(ee=>({...ee,[X]:G}))},O=async F=>{if(F.preventDefault(),!k.cardNumber||!k.expiryDate||!k.cvv||!k.cardholderName){n({title:"Missing Information",description:"Please fill in all payment details.",variant:"destructive"});return}C(!0);try{const{error:X}=await Ve.from("split_payment_requests").update({status:"paid",paid_at:new Date().toISOString()}).eq("id",o.id);if(X)throw X;const{error:G}=await Ve.from("payment_notifications").insert([{user_id:o.requester_id,split_payment_id:o.id,type:"payment_received",title:"Payment Received",message:`Your split payment request of ${o.amount.toLocaleString()} has been paid.`}]);G&&console.error("Error creating notification:",G),n({title:"Payment Successful!",description:"Your payment has been processed successfully.",className:"bg-green-500 text-white"}),setTimeout(()=>{r("/")},2e3)}catch(X){console.error("Error processing payment:",X),n({title:"Payment Failed",description:"There was an error processing your payment. Please try again.",variant:"destructive"})}finally{C(!1)}};return b?c.jsx("div",{className:"container py-20 text-center",children:c.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[c.jsx("div",{className:"h-8 w-64 bg-secondary rounded mb-4"}),c.jsx("div",{className:"h-4 w-48 bg-secondary rounded"})]})}):o?c.jsxs("div",{className:"container py-10 max-w-2xl mx-auto",children:[c.jsxs(Et,{variant:"ghost",onClick:()=>r("/"),className:"mb-6",children:[c.jsx(TM,{className:"h-4 w-4 mr-2"}),"Back to Home"]}),c.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[c.jsxs(kt,{className:"mb-6",children:[c.jsx(zr,{children:c.jsxs($r,{className:"flex items-center gap-2",children:[c.jsx(rf,{className:"h-6 w-6"}),"Split Payment Request"]})}),c.jsx(rr,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-brand-cream/30 border border-brand-gold/20 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-lg",children:p==null?void 0:p.name}),c.jsxs("p",{className:"text-sm text-muted-foreground",children:[p==null?void 0:p.address,", ",p==null?void 0:p.city]})]}),c.jsx(bn,{variant:"outline",children:"Split Payment"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx(qt,{className:"text-muted-foreground",children:"Requested by"}),c.jsxs("p",{className:"font-medium",children:[(R=h==null?void 0:h.user_profiles)==null?void 0:R.first_name," ",(q=h==null?void 0:h.user_profiles)==null?void 0:q.last_name]})]}),c.jsxs("div",{children:[c.jsx(qt,{className:"text-muted-foreground",children:"Booking Date"}),c.jsx("p",{className:"font-medium",children:new Date(h==null?void 0:h.booking_date).toLocaleDateString()})]})]})]}),c.jsxs("div",{className:"text-center py-6",children:[c.jsxs("div",{className:"text-3xl font-bold text-brand-burgundy mb-2",children:["",o.amount.toLocaleString()]}),c.jsx("p",{className:"text-muted-foreground",children:"Your portion of the booking"})]})]})})]}),c.jsxs(kt,{children:[c.jsx(zr,{children:c.jsx($r,{children:"Payment Details"})}),c.jsx(rr,{children:c.jsxs("form",{onSubmit:O,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"cardholderName",children:"Cardholder Name"}),c.jsx(Xt,{id:"cardholderName",name:"cardholderName",value:k.cardholderName,onChange:B,placeholder:"John Doe",required:!0})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"cardNumber",children:"Card Number"}),c.jsx(Xt,{id:"cardNumber",name:"cardNumber",value:k.cardNumber,onChange:B,placeholder:"1234 5678 9012 3456",required:!0})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"expiryDate",children:"Expiry Date"}),c.jsx(Xt,{id:"expiryDate",name:"expiryDate",value:k.expiryDate,onChange:B,placeholder:"MM/YY",required:!0})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"cvv",children:"CVV"}),c.jsx(Xt,{id:"cvv",name:"cvv",value:k.cvv,onChange:B,placeholder:"123",required:!0})]})]}),c.jsx(Et,{type:"submit",className:"w-full bg-brand-burgundy text-brand-cream hover:bg-brand-burgundy/90",disabled:E,children:E?c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-brand-cream mr-2"}),"Processing Payment..."]}):c.jsxs(c.Fragment,{children:[c.jsx(rf,{className:"h-4 w-4 mr-2"}),"Pay ",o.amount.toLocaleString()]})})]})})]})]})]}):c.jsxs("div",{className:"container py-20 text-center",children:[c.jsx(EM,{className:"h-16 w-16 mx-auto text-destructive mb-4"}),c.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Payment Request Not Found"}),c.jsx("p",{className:"text-muted-foreground mb-6",children:"The payment link may be invalid or expired."}),c.jsx(Et,{onClick:()=>r("/"),children:"Go Home"})]})},_Ue=()=>{const e=Array.from({length:30},(t,r)=>({id:r,x:Math.random()*100,y:Math.random()*100,delay:Math.random()*5,duration:4+Math.random()*3,size:2+Math.random()*4}));return c.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.map(t=>c.jsx(nt.div,{className:"absolute rounded-full bg-gradient-to-r from-brand-gold/20 to-brand-burgundy/10",style:{left:`${t.x}%`,top:`${t.y}%`,width:`${t.size}px`,height:`${t.size}px`},animate:{y:[0,-50,0],x:[0,20,0],opacity:[.3,.8,.3],scale:[.8,1.2,.8]},transition:{duration:t.duration,repeat:1/0,delay:t.delay,ease:"easeInOut"}},t.id))})},wUe=({children:e})=>{const{scrollY:t}=Ome(),r=HB(t,[0,500],[0,-150]),n=HB(t,[0,300],[1,.3]);return c.jsx(nt.div,{style:{y:r,opacity:n},className:"relative",children:e})},SUe=({end:e,duration:t=2,suffix:r=""})=>{const[n,o]=D.useState(0),s=D.useRef(),h=$me(s,{once:!0});return D.useEffect(()=>{if(h){let i;const p=y=>{i||(i=y);const b=Math.min((y-i)/(t*1e3),1);o(Math.floor(b*e)),b<1&&requestAnimationFrame(p)};requestAnimationFrame(p)}},[h,e,t]),c.jsxs("span",{ref:s,children:[n,r]})},EUe=()=>{const[e,t]=D.useState({location:"",date:"",guests:"2",venueType:"all"}),[r,n]=D.useState([]),[o,s]=D.useState(["all"]);D.useState(["all","Restaurant","Club","Lounge"]);const[h,i]=D.useState(!0),[p,y]=D.useState(!1),b=D.useRef(),_=D.useRef(),E=D.useRef(),C=D.useRef();D.useEffect(()=>{k()},[]);const k=async()=>{try{i(!0);const{data:F,error:X}=await Ve.from("venues").select(`
          *,
          venue_images (
            image_url,
            is_primary
          )
        `).eq("status","approved").eq("is_active",!0).limit(6);if(X){console.error("Error fetching venues:",X);return}const G=(F==null?void 0:F.map(K=>{var ae,_e,Ee,xe,ce;const ie=((_e=(ae=K.venue_images)==null?void 0:ae.find(ke=>ke.is_primary))==null?void 0:_e.image_url)||((xe=(Ee=K.venue_images)==null?void 0:Ee[0])==null?void 0:xe.image_url),pe=((ce=K.venue_images)==null?void 0:ce.map(ke=>ke.image_url))||[];return{id:K.id,name:K.name,description:K.description,rating:K.rating||4.5,location:K.city,venueType:K.type,type:K.type,images:ie?[ie,...pe.filter(ke=>ke!==ie)]:pe,address:K.address,city:K.city,price_range:K.price_range,vibe:K.vibe,isFeatured:!0}}))||[];n(G);const ee=["all",...new Set((F==null?void 0:F.map(K=>K.city))||[])];s(ee)}catch(F){console.error("Error in fetchVenuesData:",F)}finally{i(!1)}},N=[{id:1,venueName:"Club DNA",location:"Victoria Island",deal:"50% off bottle service",validUntil:"2024-03-24",image:"https://images.unsplash.com/photo-1575429198097-0414ec08e8cd",originalPrice:"150,000",dealPrice:"75,000",remainingSpots:3,badge:"Hot Deal",badgeColor:"bg-red-500"},{id:2,venueName:"RSVP Lagos",location:"Lekki",deal:"Free entry for ladies",validUntil:"2024-03-24",image:"https://images.unsplash.com/photo-1575429198097-0414ec08e8cd",originalPrice:"10,000",dealPrice:"0",remainingSpots:15,badge:"Limited",badgeColor:"bg-orange-500"},{id:3,venueName:"Quilox",location:"Victoria Island",deal:"2-for-1 cocktails",validUntil:"2024-03-24",image:"https://images.unsplash.com/photo-1575429198097-0414ec08e8cd",originalPrice:"8,000",dealPrice:"4,000",remainingSpots:8,badge:"Popular",badgeColor:"bg-green-500"}],I=[{number:100,suffix:"+",label:"Premium Venues",icon:K3},{number:5e4,suffix:"+",label:"Happy Customers",icon:Bi},{number:4.9,suffix:"/5",label:"Average Rating",icon:sa},{number:24,suffix:"/7",label:"Support Available",icon:cA}],B=[{icon:M8,title:"Instant Booking",description:"Book your table in seconds with our lightning-fast booking system",color:"from-brand-burgundy to-brand-burgundy/90"},{icon:cA,title:"Secure Payments",description:"Your payments are protected with bank-level security encryption",color:"from-brand-burgundy/90 to-brand-burgundy/80"},{icon:K3,title:"VIP Treatment",description:"Enjoy exclusive perks and priority service at all partner venues",color:"from-brand-burgundy/80 to-brand-burgundy/70"},{icon:p2,title:"Best Prices",description:"Get the best deals and exclusive discounts on premium venues",color:"from-brand-burgundy/70 to-brand-burgundy/60"}],O=()=>{const F=Object.entries(e).filter(([G,ee])=>ee&&ee!=="all"&&ee!=="").reduce((G,[ee,K])=>({...G,[ee]:K}),{}),X=new URLSearchParams(F).toString();window.location.href=`/venues${X?`?${X}`:""}`},R={hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.3,staggerChildren:.1}}},q={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}};return c.jsxs("div",{className:"bg-brand-cream text-brand-burgundy",children:[c.jsxs("section",{ref:b,className:"relative overflow-hidden py-20 md:py-32 min-h-screen flex items-center",children:[c.jsxs("div",{className:"absolute inset-0 z-0",children:[c.jsx(wUe,{children:c.jsx("img",{className:"w-full h-full object-cover",alt:"Elegant Lagos nightlife scene with city lights",src:"https://images.unsplash.com/photo-1504487857078-a29d3990e6aa"})}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-brand-cream/20 via-brand-cream/60 to-brand-cream/90"}),c.jsx(_Ue,{})]}),c.jsx("div",{className:"container relative z-10",children:c.jsxs("div",{className:"max-w-6xl mx-auto",children:[c.jsxs(nt.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:1,ease:"easeOut"},className:"text-center mb-12",children:[c.jsxs(nt.h1,{className:"text-5xl md:text-7xl lg:text-8xl font-heading mb-8 text-brand-burgundy",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:1.2,ease:"easeOut"},children:["Find Your Perfect"," ",c.jsx(nt.span,{className:"bg-gradient-to-r from-brand-gold via-yellow-400 to-brand-gold bg-clip-text text-transparent",animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},style:{backgroundSize:"200% 200%"},children:"VIP"})," ","Experience"]}),c.jsx(nt.p,{className:"text-xl md:text-2xl text-brand-burgundy/80 font-medium max-w-3xl mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.3},children:"Book exclusive tables at Lagos' most prestigious venues with instant confirmation"})]}),c.jsx(nt.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.5},className:`bg-white p-8 rounded-3xl shadow-2xl border-2 transition-all duration-300 ${p?"border-brand-gold shadow-3xl scale-105":"border-brand-burgundy/10"}`,onFocus:()=>y(!0),onBlur:()=>y(!1),children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[c.jsxs(nt.div,{className:"relative",whileHover:{scale:1.02},transition:{type:"spring",stiffness:400,damping:10},children:[c.jsx(oa,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-brand-burgundy/50"}),c.jsxs(dc,{value:e.location,onValueChange:F=>t(X=>({...X,location:F})),children:[c.jsx(bl,{className:"pl-12 h-14 bg-white border-2 border-brand-burgundy/20 hover:border-brand-gold focus:border-brand-gold rounded-xl text-base",children:c.jsx(hc,{placeholder:"Where in Lagos?"})}),c.jsx(_l,{children:o.map(F=>c.jsx(qn,{value:F,children:F},F))})]})]}),c.jsxs(nt.div,{className:"relative",whileHover:{scale:1.02},transition:{type:"spring",stiffness:400,damping:10},children:[c.jsx(Lo,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-brand-burgundy/50"}),c.jsx(Xt,{type:"date",className:"pl-12 h-14 bg-white border-2 border-brand-burgundy/20 hover:border-brand-gold focus:border-brand-gold rounded-xl text-base",value:e.date,onChange:F=>t(X=>({...X,date:F.target.value})),min:new Date().toISOString().split("T")[0]})]}),c.jsxs(nt.div,{className:"relative",whileHover:{scale:1.02},transition:{type:"spring",stiffness:400,damping:10},children:[c.jsx(Bi,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-brand-burgundy/50"}),c.jsxs(dc,{value:e.guests,onValueChange:F=>t(X=>({...X,guests:F})),children:[c.jsx(bl,{className:"pl-12 h-14 bg-white border-2 border-brand-burgundy/20 hover:border-brand-gold focus:border-brand-gold rounded-xl text-base",children:c.jsx(hc,{placeholder:"Guests"})}),c.jsx(_l,{children:[1,2,3,4,5,6,7,8,9,10].map(F=>c.jsxs(qn,{value:F.toString(),children:[F," Guest",F>1?"s":""]},F))})]})]}),c.jsx(nt.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:c.jsxs(Et,{onClick:O,className:"w-full h-14 bg-gradient-to-r from-brand-burgundy to-brand-burgundy-light hover:from-brand-gold hover:to-yellow-500 text-white font-semibold text-base rounded-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[c.jsx(Tm,{className:"mr-2 h-5 w-5"}),"Find Venues"]})})]})})]})})]}),c.jsx("section",{ref:C,className:"py-20 bg-gradient-to-r from-brand-burgundy via-brand-burgundy-light to-brand-burgundy",children:c.jsx("div",{className:"container",children:c.jsx(nt.div,{variants:R,initial:"hidden",whileInView:"visible",viewport:{once:!0},className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:I.map((F,X)=>c.jsxs(nt.div,{variants:q,className:"text-center text-white",whileHover:{scale:1.05,y:-5},children:[c.jsx(nt.div,{className:"inline-flex items-center justify-center w-16 h-16 bg-brand-gold rounded-full mb-4",animate:{rotate:[0,360]},transition:{duration:20,repeat:1/0,ease:"linear"},children:c.jsx(F.icon,{className:"w-8 h-8 text-brand-burgundy"})}),c.jsx("div",{className:"text-4xl md:text-5xl font-bold mb-2",children:c.jsx(SUe,{end:F.number,suffix:F.suffix})}),c.jsx("p",{className:"text-white/80 font-medium",children:F.label})]},X))})})}),c.jsx("section",{ref:_,className:"py-20 bg-white",children:c.jsxs("div",{className:"container",children:[c.jsxs(nt.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"text-center mb-16",children:[c.jsx("h2",{className:"text-4xl md:text-6xl font-heading text-brand-burgundy mb-6 font-bold",children:"Why Choose VIP Club?"}),c.jsx("p",{className:"text-xl text-brand-burgundy/70 max-w-3xl mx-auto",children:"Experience the difference with our premium booking platform designed for discerning customers"})]}),c.jsx(nt.div,{variants:R,initial:"hidden",whileInView:"visible",viewport:{once:!0},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:B.map((F,X)=>c.jsxs(nt.div,{variants:q,whileHover:{y:-10,scale:1.02},className:"group relative overflow-hidden bg-white rounded-2xl p-8 shadow-lg hover:shadow-2xl transition-all duration-300 border border-brand-burgundy/10",children:[c.jsx(nt.div,{className:`absolute inset-0 bg-gradient-to-br ${F.color} opacity-0 group-hover:opacity-10 transition-opacity duration-300`}),c.jsx(nt.div,{className:`inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br ${F.color} rounded-xl mb-6`,whileHover:{rotate:5,scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:c.jsx(F.icon,{className:"w-8 h-8 text-white"})}),c.jsx("h3",{className:"text-xl font-bold text-brand-burgundy mb-4 group-hover:text-brand-gold transition-colors duration-300",children:F.title}),c.jsx("p",{className:"text-brand-burgundy/70 leading-relaxed",children:F.description})]},X))})]})}),c.jsx("section",{className:"py-20 bg-gradient-to-br from-brand-cream to-brand-cream/50",children:c.jsxs("div",{className:"container",children:[c.jsxs(nt.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"text-center mb-16",children:[c.jsxs("h2",{className:"text-4xl md:text-6xl font-heading text-brand-burgundy mb-6 font-bold",children:["This Weekend's ",c.jsx("span",{className:"text-brand-gold",children:"Hot Deals"})]}),c.jsx("p",{className:"text-xl text-brand-burgundy/70 max-w-3xl mx-auto",children:"Limited time offers on the hottest venues in Lagos. Book now before they're gone!"})]}),c.jsx(nt.div,{variants:R,initial:"hidden",whileInView:"visible",viewport:{once:!0},className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:N.map((F,X)=>c.jsxs(nt.div,{variants:q,whileHover:{y:-8,scale:1.02},className:"group relative overflow-hidden bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300",children:[c.jsxs("div",{className:"relative h-48 overflow-hidden",children:[c.jsx("img",{src:F.image,alt:F.venueName,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"}),c.jsx(nt.div,{className:`absolute top-4 left-4 ${F.badgeColor} text-white px-3 py-1 rounded-full text-sm font-semibold`,animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:F.badge}),c.jsxs("div",{className:"absolute bottom-4 left-4 text-white",children:[c.jsx("h3",{className:"text-xl font-bold",children:F.venueName}),c.jsxs("p",{className:"text-white/80 flex items-center",children:[c.jsx(oa,{className:"w-4 h-4 mr-1"}),F.location]})]})]}),c.jsxs("div",{className:"p-6",children:[c.jsx("p",{className:"text-lg font-semibold text-brand-burgundy mb-4",children:F.deal}),c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-brand-burgundy/60 line-through",children:F.originalPrice}),c.jsx("span",{className:"text-2xl font-bold text-brand-gold ml-2",children:F.dealPrice})]}),c.jsxs("span",{className:"text-sm text-brand-burgundy/60",children:[F.remainingSpots," spots left"]})]}),c.jsx(nt.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-gradient-to-r from-brand-burgundy to-brand-burgundy-light text-white py-3 rounded-xl font-semibold hover:from-brand-gold hover:to-yellow-500 transition-all duration-300",children:"Book This Deal"})]})]},F.id))})]})}),c.jsx("section",{ref:E,className:"py-20 bg-white",children:c.jsxs("div",{className:"container",children:[c.jsxs(nt.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"text-center mb-16",children:[c.jsx("h2",{className:"text-4xl md:text-6xl font-heading text-brand-burgundy mb-6 font-bold",children:"Featured Venues"}),c.jsx("p",{className:"text-xl text-brand-burgundy/70 max-w-3xl mx-auto",children:"Handpicked premium venues offering the finest experiences in Lagos"})]}),h?c.jsx(nt.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",variants:R,initial:"hidden",animate:"visible",children:[...Array(6)].map((F,X)=>c.jsx(nt.div,{variants:q,className:"bg-gray-200 rounded-2xl h-96 animate-pulse"},X))}):c.jsx(nt.div,{variants:R,initial:"hidden",whileInView:"visible",viewport:{once:!0},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:r.map((F,X)=>c.jsx(nt.div,{variants:q,custom:X,children:c.jsx(A7,{venue:F})},F.id))}),c.jsx(nt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6,delay:.8},className:"text-center mt-12",children:c.jsx(nt.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},onClick:()=>window.location.href="/venues",className:"bg-gradient-to-r from-brand-burgundy to-brand-burgundy-light hover:from-brand-gold hover:to-yellow-500 text-white px-8 py-4 rounded-xl font-semibold text-lg shadow-lg hover:shadow-xl transition-all duration-300",children:"View All Venues"})})]})})]})},TUe=()=>{const[e,t]=D.useState(""),[r,n]=D.useState(""),[o,s]=D.useState(!1),[h,i]=D.useState(""),[p,y]=D.useState(""),[b,_]=D.useState(""),E=async C=>{C.preventDefault(),s(!0),i(""),y(""),_("");const{error:k}=await Ve.auth.signUp({email:e,password:r});if(s(!1),k)i(k.message);else{y("Registration successful! Please check your email to confirm your account.");const N=`${"https://agydpkzfucicraedllgl.supabase.co".replace(".supabase.co",".functions.supabase.co")}/send-email`;fetch(N,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,subject:"Welcome to VIPClub!",template:"welcome",data:{email:e}})}).then(I=>I.json()).then(I=>{I.success?_("Welcome email sent!"):_("Registered, but failed to send welcome email.")}).catch(()=>{_("Registered, but failed to send welcome email.")})}};return c.jsxs("form",{onSubmit:E,className:"max-w-md mx-auto p-6 bg-white rounded shadow",children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"Register"}),c.jsx("input",{type:"email",placeholder:"Email",className:"w-full mb-2 p-2 border rounded",value:e,onChange:C=>t(C.target.value),required:!0}),c.jsx("input",{type:"password",placeholder:"Password",className:"w-full mb-2 p-2 border rounded",value:r,onChange:C=>n(C.target.value),required:!0}),c.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700",disabled:o,children:o?"Registering...":"Register"}),h&&c.jsx("div",{className:"text-red-500 mt-2",children:h}),p&&c.jsx("div",{className:"text-green-600 mt-2",children:p}),b&&c.jsx("div",{className:"text-yellow-600 mt-2",children:b})]})},jUe=()=>c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:c.jsx(TUe,{})}),CUe=()=>c.jsx("div",{className:"bg-brand-cream/50 min-h-screen py-12",children:c.jsxs("div",{className:"container mx-auto px-4",children:[c.jsxs("div",{className:"text-center mb-12",children:[c.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"About VIP Club"}),c.jsx("p",{className:"text-brand-burgundy/70 text-lg max-w-3xl mx-auto",children:"Built in honor of our friend Eddy - your gateway to Nigeria's most exclusive venue experiences. We connect you with premium venues and unforgettable moments across Lagos and beyond."})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center mb-16",children:[c.jsxs("div",{children:[c.jsx("img",{src:"/images/logos/callum.jpg",alt:"Eddy - Our beloved friend who inspired VIP Club",className:"rounded-lg shadow-xl object-cover w-full h-auto aspect-[4/3] border-4 border-brand-gold"}),c.jsx("p",{className:"text-center text-brand-burgundy/60 text-sm mt-2 italic",children:"Eddy - The inspiration behind VIP Club"})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsx("h2",{className:"text-3xl font-heading font-bold text-brand-burgundy",children:"Our Story"}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"VIP Club was born from a deeply personal place - a promise to honor the memory of our dear friend Eddy, who believed that life's most precious moments happen when people come together. Eddy always said that everyone deserves to feel like a VIP, to experience the joy of being celebrated and surrounded by good company."}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:`After we lost Eddy, we realized how important it is to create spaces and opportunities for people to connect, celebrate, and make lasting memories. We named it "VIP Club" in his honor - because to Eddy, VIP wasn't just about exclusive venues, it was about making every person feel valued, important, and part of something special.`}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"This platform is our way of ensuring that Eddy's vision lives on - connecting people with amazing venues where they can create the kind of memories he would have loved to be part of."}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsx(bn,{className:"bg-brand-gold text-brand-burgundy",children:"Founded 2024"}),c.jsx(bn,{className:"bg-brand-burgundy text-white",children:"Lagos Based"}),c.jsx(bn,{className:"bg-brand-cream text-brand-burgundy border border-brand-burgundy",children:"Built with "})]})]})]}),c.jsx("div",{className:"mb-16",children:c.jsx(kt,{className:"bg-gradient-to-r from-brand-burgundy/5 to-brand-gold/5 border-brand-gold/30",children:c.jsxs(rr,{className:"p-8 text-center",children:[c.jsx("div",{className:"flex justify-center mb-6",children:c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:"/images/logos/callum.jpg",alt:"Eddy - Forever in our hearts",className:"w-24 h-24 rounded-full object-cover border-4 border-brand-gold shadow-lg"}),c.jsx("div",{className:"absolute -bottom-2 -right-2 bg-brand-burgundy rounded-full p-2",children:c.jsx(Rx,{className:"h-4 w-4 text-white fill-current"})})]})}),c.jsx("h3",{className:"text-2xl font-heading font-bold text-brand-burgundy mb-4",children:"In Loving Memory of Eddy"}),c.jsx("p",{className:"text-brand-burgundy/80 max-w-2xl mx-auto leading-relaxed",children:`"Everyone deserves their VIP moment" - these words from our beloved friend Eddy inspire everything we do. Though he's no longer with us, his spirit of bringing people together and making everyone feel special lives on through every booking, every celebration, and every connection made on our platform.`}),c.jsx("p",{className:"text-brand-burgundy/70 mt-4 italic",children:"This one's for you, Eddy. Thank you for showing us that the real VIP experience is about the people we share it with."})]})})}),c.jsxs("div",{className:"mb-16",children:[c.jsx("h2",{className:"text-3xl font-heading font-bold text-center mb-12 text-brand-burgundy",children:"What We Offer"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[{icon:c.jsx(Cie,{className:"h-10 w-10 text-brand-burgundy"}),title:"Exclusive Access",description:"Unlock doors to premium venues, VIP sections, and exclusive events across Lagos and Nigeria."},{icon:c.jsx(Bie,{className:"h-10 w-10 text-brand-burgundy"}),title:"Curated Venues",description:"Handpicked selection of top-tier restaurants, lounges, and clubs known for exceptional service and ambiance."},{icon:c.jsx(M8,{className:"h-10 w-10 text-brand-burgundy"}),title:"Seamless Booking",description:"Effortless table reservations and event bookings through our intuitive platform with instant confirmation."}].map((e,t)=>c.jsx(kt,{className:"bg-white border-brand-burgundy/10 hover:shadow-lg transition-shadow",children:c.jsxs(rr,{className:"p-6 text-center",children:[c.jsx("div",{className:"flex justify-center mb-4 p-3 bg-brand-gold/20 rounded-full w-fit mx-auto",children:e.icon}),c.jsx("h3",{className:"text-xl font-heading font-semibold mb-3 text-brand-burgundy",children:e.title}),c.jsx("p",{className:"text-brand-burgundy/70",children:e.description})]})},t))})]}),c.jsxs("div",{className:"mb-16",children:[c.jsx("h2",{className:"text-3xl font-heading font-bold text-center mb-12 text-brand-burgundy",children:"Our Values"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{icon:c.jsx(Rx,{className:"h-8 w-8"}),title:"Honor & Memory",description:"Every experience honors Eddy's belief that everyone deserves their VIP moment."},{icon:c.jsx(sa,{className:"h-8 w-8"}),title:"Excellence",description:"We strive for perfection in every booking and experience, just as Eddy would have wanted."},{icon:c.jsx(cA,{className:"h-8 w-8"}),title:"Trust",description:"Secure payments and reliable service you can count on, built on a foundation of integrity."},{icon:c.jsx(Bi,{className:"h-8 w-8"}),title:"Community",description:"Building connections and bringing people together, celebrating life and friendship."}].map((e,t)=>c.jsx(kt,{className:"bg-white border-brand-burgundy/10 text-center",children:c.jsxs(rr,{className:"p-6",children:[c.jsx("div",{className:"text-brand-burgundy mb-3 flex justify-center",children:e.icon}),c.jsx("h4",{className:"font-semibold text-brand-burgundy mb-2",children:e.title}),c.jsx("p",{className:"text-brand-burgundy/70 text-sm",children:e.description})]})},t))})]}),c.jsx("div",{className:"mb-16",children:c.jsx(kt,{className:"bg-brand-burgundy text-white",children:c.jsx(rr,{className:"p-8",children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 text-center",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-bold text-brand-gold mb-2",children:"50+"}),c.jsx("div",{className:"text-brand-cream/80",children:"Partner Venues"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-bold text-brand-gold mb-2",children:"1000+"}),c.jsxs("div",{className:"text-brand-cream/80",children:["VIP Moments Created",c.jsx("br",{}),c.jsx("span",{className:"text-xs",children:"In Eddy's Honor"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-bold text-brand-gold mb-2",children:"24/7"}),c.jsx("div",{className:"text-brand-cream/80",children:"Customer Support"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-bold text-brand-gold mb-2",children:"5"}),c.jsx("div",{className:"text-brand-cream/80",children:"Average Rating"})]})]})})})}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs(rr,{className:"p-6",children:[c.jsxs("h3",{className:"text-xl font-semibold text-brand-burgundy mb-4 flex items-center",children:[c.jsx(oa,{className:"h-5 w-5 mr-2"}),"Our Location"]}),c.jsxs("div",{className:"space-y-2 text-brand-burgundy/80",children:[c.jsx("p",{children:"VIP Club Headquarters"}),c.jsx("p",{children:"(Founded in Memory of Eddy)"}),c.jsx("p",{children:"123 Victoria Island"}),c.jsx("p",{children:"Lagos, Nigeria"}),c.jsxs("p",{className:"pt-2",children:[c.jsx("strong",{children:"Phone:"})," +234 (0) 123 456 7890",c.jsx("br",{}),c.jsx("strong",{children:"Email:"})," info@vipclub.ng",c.jsx("br",{}),c.jsx("em",{className:"text-sm",children:"Continuing Eddy's legacy"})]})]})]})}),c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs(rr,{className:"p-6",children:[c.jsxs("h3",{className:"text-xl font-semibold text-brand-burgundy mb-4 flex items-center",children:[c.jsx(wd,{className:"h-5 w-5 mr-2"}),"Business Hours"]}),c.jsxs("div",{className:"space-y-2 text-brand-burgundy/80",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Monday - Friday"}),c.jsx("span",{children:"9:00 AM - 6:00 PM"})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Saturday"}),c.jsx("span",{children:"10:00 AM - 4:00 PM"})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Sunday"}),c.jsx("span",{children:"Closed"})]}),c.jsx("p",{className:"text-sm pt-2 border-t border-brand-burgundy/10",children:"Our booking platform is available 24/7 for your convenience."})]})]})})]}),c.jsx("div",{className:"text-center mt-16",children:c.jsx(kt,{className:"bg-brand-gold/20 border-brand-gold/30",children:c.jsxs(rr,{className:"p-8",children:[c.jsx("h3",{className:"text-2xl font-heading font-bold text-brand-burgundy mb-4",children:"Ready to Create Your VIP Moment?"}),c.jsx("p",{className:"text-brand-burgundy/80 mb-6 max-w-2xl mx-auto",children:"Join thousands of people who have discovered their perfect venue through VIP Club - Eddy's legacy of bringing people together. Every booking helps us carry forward Eddy's mission of making everyone feel special and creating unforgettable memories."}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[c.jsx("a",{href:"/venues",className:"inline-flex items-center justify-center px-8 py-3 bg-brand-burgundy text-white rounded-lg hover:bg-brand-burgundy/90 transition-colors font-semibold",children:"Explore Venues"}),c.jsx("a",{href:"/contact",className:"inline-flex items-center justify-center px-8 py-3 border border-brand-burgundy text-brand-burgundy rounded-lg hover:bg-brand-burgundy/10 transition-colors font-semibold",children:"Share Your Story"})]})]})})})]})}),PUe=()=>{const{toast:e}=Co(),[t,r]=D.useState({name:"",email:"",subject:"",message:""}),[n,o]=D.useState(!1),s=i=>{const{name:p,value:y}=i.target;r(b=>({...b,[p]:y}))},h=async i=>{i.preventDefault(),o(!0),setTimeout(()=>{e({title:"Message Sent!",description:"Thank you for contacting us. We'll get back to you within 24 hours.",className:"bg-green-500 text-white"}),r({name:"",email:"",subject:"",message:""}),o(!1)},1e3)};return c.jsx("div",{className:"bg-brand-cream/50 min-h-screen py-12",children:c.jsxs("div",{className:"container mx-auto px-4",children:[c.jsxs("div",{className:"text-center mb-12",children:[c.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"Contact Us"}),c.jsx("p",{className:"text-brand-burgundy/70 text-lg max-w-2xl mx-auto",children:"Get in touch with our team. We're here to help with bookings, partnerships, or any questions you may have."})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"lg:col-span-1",children:[c.jsxs(kt,{className:"bg-white border-brand-burgundy/10 h-fit",children:[c.jsx(zr,{children:c.jsx($r,{className:"text-brand-burgundy",children:"Get in Touch"})}),c.jsxs(rr,{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsx("div",{className:"p-2 bg-brand-gold/20 rounded-full",children:c.jsx(nf,{className:"h-5 w-5 text-brand-burgundy"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-brand-burgundy",children:"Email"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"info@vipclub.ng"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"support@vipclub.ng"})]})]}),c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsx("div",{className:"p-2 bg-brand-gold/20 rounded-full",children:c.jsx(of,{className:"h-5 w-5 text-brand-burgundy"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-brand-burgundy",children:"Phone"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"+234 (0) 123 456 7890"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"+234 (0) 987 654 3210"})]})]}),c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsx("div",{className:"p-2 bg-brand-gold/20 rounded-full",children:c.jsx(oa,{className:"h-5 w-5 text-brand-burgundy"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-brand-burgundy",children:"Address"}),c.jsxs("p",{className:"text-brand-burgundy/70",children:["VIP Club HQ",c.jsx("br",{}),"123 Victoria Island",c.jsx("br",{}),"Lagos, Nigeria"]})]})]}),c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsx("div",{className:"p-2 bg-brand-gold/20 rounded-full",children:c.jsx(wd,{className:"h-5 w-5 text-brand-burgundy"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-brand-burgundy",children:"Business Hours"}),c.jsxs("p",{className:"text-brand-burgundy/70",children:["Monday - Friday: 9:00 AM - 6:00 PM",c.jsx("br",{}),"Saturday: 10:00 AM - 4:00 PM",c.jsx("br",{}),"Sunday: Closed"]})]})]})]})]}),c.jsxs(kt,{className:"bg-white border-brand-burgundy/10 mt-6",children:[c.jsx(zr,{children:c.jsx($r,{className:"text-brand-burgundy",children:"Quick Links"})}),c.jsxs(rr,{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy mb-2",children:"For Customers"}),c.jsxs("ul",{className:"space-y-1 text-brand-burgundy/70",children:[c.jsx("li",{children:" Booking Help & Support"}),c.jsx("li",{children:" Payment Issues"}),c.jsx("li",{children:" Account Management"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy mb-2",children:"For Venue Owners"}),c.jsxs("ul",{className:"space-y-1 text-brand-burgundy/70",children:[c.jsx("li",{children:" Partnership Inquiries"}),c.jsx("li",{children:" Technical Support"}),c.jsx("li",{children:" Account Setup"})]})]})]})]})]}),c.jsxs("div",{className:"lg:col-span-2",children:[c.jsxs(kt,{className:"bg-white border-brand-burgundy/10",children:[c.jsxs(zr,{children:[c.jsx($r,{className:"text-brand-burgundy",children:"Send us a Message"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Fill out the form below and we'll get back to you as soon as possible."})]}),c.jsx(rr,{children:c.jsxs("form",{onSubmit:h,className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"name",className:"text-brand-burgundy",children:"Full Name"}),c.jsx(Xt,{id:"name",name:"name",type:"text",required:!0,value:t.name,onChange:s,className:"mt-1 border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your full name"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"email",className:"text-brand-burgundy",children:"Email Address"}),c.jsx(Xt,{id:"email",name:"email",type:"email",required:!0,value:t.email,onChange:s,className:"mt-1 border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Enter your email"})]})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"subject",className:"text-brand-burgundy",children:"Subject"}),c.jsx(Xt,{id:"subject",name:"subject",type:"text",required:!0,value:t.subject,onChange:s,className:"mt-1 border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"What is this regarding?"})]}),c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"message",className:"text-brand-burgundy",children:"Message"}),c.jsx(Tb,{id:"message",name:"message",required:!0,value:t.message,onChange:s,className:"mt-1 border-brand-burgundy/20 focus:border-brand-burgundy",placeholder:"Tell us more about your inquiry...",rows:6})]}),c.jsx(Et,{type:"submit",disabled:n,className:"w-full bg-brand-burgundy text-white hover:bg-brand-burgundy/90",children:n?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):c.jsxs(c.Fragment,{children:[c.jsx(ex,{className:"h-4 w-4 mr-2"}),"Send Message"]})})]})})]}),c.jsxs(kt,{className:"bg-white border-brand-burgundy/10 mt-6",children:[c.jsx(zr,{children:c.jsx($r,{className:"text-brand-burgundy",children:"Frequently Asked Questions"})}),c.jsxs(rr,{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy mb-2",children:"How do I make a booking?"}),c.jsx("p",{className:"text-brand-burgundy/70 text-sm",children:"Simply browse our venues, select your preferred date and time, choose your table or ticket, and complete the payment process."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy mb-2",children:"Can I cancel my booking?"}),c.jsx("p",{className:"text-brand-burgundy/70 text-sm",children:"Yes, cancellations are allowed based on each venue's policy. Check your booking confirmation for specific cancellation terms."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-brand-burgundy mb-2",children:"How do I become a venue partner?"}),c.jsx("p",{className:"text-brand-burgundy/70 text-sm",children:"Visit our venue owner registration page or contact us directly to discuss partnership opportunities."})]})]})]})]})]})]})})},AUe=()=>c.jsx("div",{className:"bg-brand-cream/50 min-h-screen py-12",children:c.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"Terms of Service"}),c.jsxs("p",{className:"text-brand-burgundy/70",children:["Last updated: ",new Date().toLocaleDateString()]})]}),c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs(rr,{className:"p-8 space-y-8",children:[c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"1. Acceptance of Terms"}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"By accessing and using VIP Club's services, you accept and agree to be bound by the terms and provision of this agreement. If you do not agree to abide by the above, please do not use this service."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"2. Use License"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[c.jsx("p",{children:"Permission is granted to temporarily download one copy of VIP Club's materials for personal, non-commercial transitory viewing only. This is the grant of a license, not a transfer of title, and under this license you may not:"}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[c.jsx("li",{children:"modify or copy the materials"}),c.jsx("li",{children:"use the materials for any commercial purpose or for any public display"}),c.jsx("li",{children:"attempt to decompile or reverse engineer any software contained on the website"}),c.jsx("li",{children:"remove any copyright or other proprietary notations from the materials"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"3. Booking and Payments"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[c.jsx("p",{children:c.jsx("strong",{children:"Booking Policy:"})}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[c.jsx("li",{children:"All bookings are subject to venue availability and confirmation"}),c.jsx("li",{children:"Bookings must be made by individuals 18 years or older"}),c.jsx("li",{children:"False information provided during booking may result in cancellation"}),c.jsx("li",{children:"VIP Club reserves the right to refuse service to anyone"})]}),c.jsx("p",{children:c.jsx("strong",{children:"Payment Terms:"})}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[c.jsx("li",{children:"Payment is required at the time of booking unless otherwise specified"}),c.jsx("li",{children:"All prices are in Nigerian Naira () and include applicable taxes"}),c.jsx("li",{children:"Service fees and processing charges may apply"}),c.jsx("li",{children:"Refunds are subject to the cancellation policy of each venue"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"4. Cancellation and Refund Policy"}),c.jsx("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:c.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[c.jsx("li",{children:"Cancellations made 24+ hours before the booking date are eligible for a full refund"}),c.jsx("li",{children:"Cancellations made 12-24 hours before the booking date are eligible for a 50% refund"}),c.jsx("li",{children:"Cancellations made less than 12 hours before the booking date are non-refundable"}),c.jsx("li",{children:"Venue-initiated cancellations will result in a full refund"}),c.jsx("li",{children:"Refund processing may take 5-10 business days"})]})})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"5. User Conduct"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[c.jsx("p",{children:"Users agree to:"}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[c.jsx("li",{children:"Provide accurate and truthful information"}),c.jsx("li",{children:"Respect venue rules and regulations"}),c.jsx("li",{children:"Behave appropriately and not disturb other guests"}),c.jsx("li",{children:"Not engage in illegal activities on the premises"}),c.jsx("li",{children:"Follow dress codes and entry requirements as specified by venues"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"6. Venue Owner Responsibilities"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[c.jsx("p",{children:"Venue owners using our platform agree to:"}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[c.jsx("li",{children:"Provide accurate venue information and availability"}),c.jsx("li",{children:"Honor confirmed bookings unless extraordinary circumstances arise"}),c.jsx("li",{children:"Maintain venue standards as advertised"}),c.jsx("li",{children:"Process refunds according to stated policies"}),c.jsx("li",{children:"Comply with all local laws and regulations"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"7. Disclaimer"}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"The materials on VIP Club's website are provided on an 'as is' basis. VIP Club makes no warranties, expressed or implied, and hereby disclaims and negates all other warranties including without limitation, implied warranties or conditions of merchantability, fitness for a particular purpose, or non-infringement of intellectual property or other violation of rights."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"8. Limitations"}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"In no event shall VIP Club or its suppliers be liable for any damages (including, without limitation, damages for loss of data or profit, or due to business interruption) arising out of the use or inability to use the materials on VIP Club's website, even if VIP Club or a VIP Club authorized representative has been notified orally or in writing of the possibility of such damage."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"9. Privacy Policy"}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"Your privacy is important to us. Please review our Privacy Policy, which also governs your use of the Service, to understand our practices."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"10. Modifications"}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"VIP Club may revise these terms of service at any time without notice. By using this website, you are agreeing to be bound by the then current version of these terms of service."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"11. Contact Information"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed",children:[c.jsx("p",{children:"If you have any questions about these Terms of Service, please contact us at:"}),c.jsxs("div",{className:"mt-3 p-4 bg-brand-cream/30 rounded-lg",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Email:"})," legal@vipclub.ng"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Phone:"})," +234 (0) 123 456 7890"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Address:"})," VIP Club Legal Department, Lagos, Nigeria"]})]})]})]})]})})]})}),kUe=()=>c.jsx("div",{className:"bg-brand-cream/50 min-h-screen py-12",children:c.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"Privacy Policy"}),c.jsxs("p",{className:"text-brand-burgundy/70",children:["Last updated: ",new Date().toLocaleDateString()]})]}),c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs(rr,{className:"p-8 space-y-8",children:[c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"1. Information We Collect"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[c.jsx("p",{children:c.jsx("strong",{children:"Personal Information:"})}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[c.jsx("li",{children:"Name, email address, and phone number"}),c.jsx("li",{children:"Payment information (processed securely by third-party providers)"}),c.jsx("li",{children:"Booking preferences and history"}),c.jsx("li",{children:"Location data (when you allow it)"})]}),c.jsx("p",{children:c.jsx("strong",{children:"Automatically Collected Information:"})}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[c.jsx("li",{children:"IP address and device information"}),c.jsx("li",{children:"Browser type and version"}),c.jsx("li",{children:"Usage patterns and preferences"}),c.jsx("li",{children:"Cookies and similar tracking technologies"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"2. How We Use Your Information"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed",children:[c.jsx("p",{children:"We use your information to:"}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2 mt-3",children:[c.jsx("li",{children:"Process and manage your bookings"}),c.jsx("li",{children:"Send booking confirmations and updates"}),c.jsx("li",{children:"Provide customer support"}),c.jsx("li",{children:"Improve our services and user experience"}),c.jsx("li",{children:"Send promotional offers (with your consent)"}),c.jsx("li",{children:"Prevent fraud and ensure platform security"}),c.jsx("li",{children:"Comply with legal obligations"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"3. Information Sharing"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[c.jsx("p",{children:"We may share your information with:"}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Venues:"})," Name, contact details, and booking information"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Payment Processors:"})," Necessary payment information"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Service Providers:"})," Trusted partners who help operate our platform"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Legal Authorities:"})," When required by law or to protect our rights"]})]}),c.jsx("p",{className:"mt-3",children:c.jsx("strong",{children:"We never sell your personal information to third parties."})})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"4. Data Security"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[c.jsx("p",{children:"We protect your information through:"}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[c.jsx("li",{children:"SSL encryption for all data transmission"}),c.jsx("li",{children:"Secure servers with regular security updates"}),c.jsx("li",{children:"Limited access to personal information by employees"}),c.jsx("li",{children:"Regular security audits and monitoring"}),c.jsx("li",{children:"Compliance with industry security standards"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"5. Your Rights and Choices"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[c.jsx("p",{children:"You have the right to:"}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[c.jsx("li",{children:"Access and review your personal information"}),c.jsx("li",{children:"Update or correct your information"}),c.jsx("li",{children:"Delete your account and associated data"}),c.jsx("li",{children:"Opt-out of marketing communications"}),c.jsx("li",{children:"Request data portability"}),c.jsx("li",{children:"Object to certain types of processing"})]}),c.jsx("p",{className:"mt-3",children:"To exercise these rights, contact us at privacy@vipclub.ng"})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"6. Cookies and Tracking"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed space-y-3",children:[c.jsx("p",{children:"We use cookies to:"}),c.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[c.jsx("li",{children:"Remember your preferences and settings"}),c.jsx("li",{children:"Analyze site usage and performance"}),c.jsx("li",{children:"Provide personalized content"}),c.jsx("li",{children:"Enable social media features"})]}),c.jsx("p",{className:"mt-3",children:"You can control cookies through your browser settings, but some features may not work properly if disabled."})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"7. Data Retention"}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"We retain your personal information for as long as necessary to provide our services, comply with legal obligations, resolve disputes, and enforce our agreements. Booking history may be retained for up to 7 years for business and legal purposes."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"8. International Data Transfers"}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"Your information may be transferred to and processed in countries other than Nigeria. We ensure appropriate safeguards are in place to protect your information in accordance with this privacy policy."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"9. Children's Privacy"}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:"Our services are not intended for children under 18. We do not knowingly collect personal information from children. If you believe we have collected information from a child, please contact us immediately."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"10. Changes to This Policy"}),c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed",children:'We may update this privacy policy from time to time. We will notify you of any material changes by posting the new policy on this page and updating the "Last updated" date. Your continued use of our services constitutes acceptance of the updated policy.'})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-brand-burgundy mb-4",children:"11. Contact Us"}),c.jsxs("div",{className:"text-brand-burgundy/80 leading-relaxed",children:[c.jsx("p",{children:"If you have questions about this privacy policy or your personal information, contact us:"}),c.jsxs("div",{className:"mt-3 p-4 bg-brand-cream/30 rounded-lg",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Email:"})," privacy@vipclub.ng"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Phone:"})," +234 (0) 123 456 7890"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Address:"})," VIP Club Privacy Team, Lagos, Nigeria"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Data Protection Officer:"})," dpo@vipclub.ng"]})]})]})]})]})})]})}),NUe=()=>{const[e,t]=D.useState(""),[r,n]=D.useState("all"),[o,s]=D.useState(null),h=[{id:"all",name:"All Questions",icon:e4},{id:"booking",name:"Booking",icon:Bi},{id:"payment",name:"Payment",icon:rf},{id:"venues",name:"Venues",icon:vie}],p=[{id:1,category:"booking",question:"How do I make a reservation?",answer:"To make a reservation, browse our available venues, select your preferred date and time, choose the number of guests, select a table or ticket type, and complete the payment process. You'll receive a confirmation email with all the details."},{id:2,category:"booking",question:"Can I modify or cancel my booking?",answer:`Yes, you can modify or cancel your booking through your account dashboard. Cancellation policies vary by venue:
 24+ hours before: Full refund
 12-24 hours before: 50% refund
 Less than 12 hours: No refund

Modifications are subject to availability.`},{id:3,category:"booking",question:"What happens if the venue cancels my booking?",answer:"If a venue cancels your booking, you will receive a full refund automatically. We will also help you find alternative venues with similar offerings and may provide additional compensation for the inconvenience."},{id:4,category:"booking",question:"Can I book for someone else?",answer:"Yes, you can make a booking for someone else. However, the person attending must have valid identification that matches the booking details. You can add guest information during the booking process."},{id:5,category:"payment",question:"What payment methods do you accept?",answer:`We accept various payment methods including:
 Credit/Debit cards (Visa, Mastercard)
 Bank transfers
 Mobile money (depending on location)
 Cryptocurrency (Bitcoin, Ethereum)

All payments are processed securely through our encrypted payment system.`},{id:6,category:"payment",question:"When will I be charged?",answer:"Payment is typically processed immediately upon booking confirmation. For some premium venues, a deposit may be required at booking with the remaining balance due closer to your visit date."},{id:7,category:"payment",question:"How long do refunds take?",answer:"Refunds are processed within 5-10 business days to your original payment method. The exact timing depends on your bank or payment provider. You'll receive an email confirmation when the refund is initiated."},{id:8,category:"payment",question:"Are there any additional fees?",answer:"A small service fee may apply to cover payment processing and platform maintenance. This fee is clearly displayed before you complete your booking. There are no hidden charges."},{id:9,category:"venues",question:"How do I find venues near me?",answer:"Use our location-based search feature on the venues page. You can filter by distance, type of venue, price range, and amenities. Enable location services for the most accurate results."},{id:10,category:"venues",question:"What information is provided about each venue?",answer:`Each venue listing includes:
 Photos and virtual tours
 Location and contact details
 Capacity and table layouts
 Menu and pricing information
 Dress code and entry requirements
 Customer reviews and ratings
 Available dates and times`},{id:11,category:"venues",question:"Can I visit a venue before booking?",answer:"Many venues welcome visits during their operating hours. Contact the venue directly through our platform to arrange a viewing. Some venues also offer virtual tours on their listing page."},{id:12,category:"venues",question:"How do I list my venue on VIP Club?",answer:`Venue owners can register through our venue owner portal. The process includes:
 Account creation and verification
 Venue information submission
 Photo uploads and virtual tour setup
 Pricing and availability configuration
 Approval process (typically 2-3 business days)`},{id:13,category:"booking",question:"What should I bring to my reservation?",answer:`Please bring:
 Valid photo ID matching the booking name
 Booking confirmation (digital or printed)
 Payment method for any additional purchases
 Any special requirements documentation if applicable`},{id:14,category:"booking",question:"What if I arrive late?",answer:"Please contact the venue directly if you're running late. Most venues hold reservations for 15-30 minutes past the booking time. After this period, your table may be released to other guests."},{id:15,category:"payment",question:"Can I split the payment with friends?",answer:`Yes! Our split payment feature allows you to divide the cost among multiple people. During checkout, select "Split Payment" and enter your friends' details. They'll receive payment links via email or SMS.`}].filter(b=>{const _=b.question.toLowerCase().includes(e.toLowerCase())||b.answer.toLowerCase().includes(e.toLowerCase()),E=r==="all"||b.category===r;return _&&E}),y=b=>{s(o===b?null:b)};return c.jsx("div",{className:"bg-brand-cream/50 min-h-screen py-12",children:c.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[c.jsxs("div",{className:"text-center mb-12",children:[c.jsx("h1",{className:"text-4xl font-heading text-brand-burgundy mb-4",children:"Frequently Asked Questions"}),c.jsx("p",{className:"text-brand-burgundy/70 text-lg",children:"Find answers to common questions about VIP Club bookings, payments, and venues."})]}),c.jsx(kt,{className:"bg-white border-brand-burgundy/10 mb-8",children:c.jsx(rr,{className:"p-6",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx(Tm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-brand-burgundy/50 h-4 w-4"}),c.jsx(Xt,{type:"text",placeholder:"Search questions...",value:e,onChange:b=>t(b.target.value),className:"pl-10 border-brand-burgundy/20 focus:border-brand-burgundy"})]}),c.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(b=>{const _=b.icon;return c.jsxs("button",{onClick:()=>n(b.id),className:`flex items-center space-x-2 px-4 py-2 rounded-full transition-colors ${r===b.id?"bg-brand-burgundy text-white":"bg-brand-cream/50 text-brand-burgundy hover:bg-brand-burgundy/10"}`,children:[c.jsx(_,{className:"h-4 w-4"}),c.jsx("span",{children:b.name})]},b.id)})})]})})}),c.jsx("div",{className:"space-y-4",children:p.length===0?c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs(rr,{className:"p-8 text-center",children:[c.jsx(e4,{className:"h-12 w-12 text-brand-burgundy/30 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"No questions found"}),c.jsx("p",{className:"text-brand-burgundy/70",children:"Try adjusting your search terms or selecting a different category."})]})}):p.map(b=>c.jsx(kt,{className:"bg-white border-brand-burgundy/10",children:c.jsxs(rr,{className:"p-0",children:[c.jsxs("button",{onClick:()=>y(b.id),className:"w-full px-6 py-4 text-left flex items-center justify-between hover:bg-brand-cream/30 transition-colors",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(bn,{variant:"outline",className:"border-brand-gold text-brand-burgundy bg-brand-gold/10",children:b.category}),c.jsx("h3",{className:"font-semibold text-brand-burgundy",children:b.question})]}),o===b.id?c.jsx(bie,{className:"h-5 w-5 text-brand-burgundy/50"}):c.jsx(C8,{className:"h-5 w-5 text-brand-burgundy/50"})]}),o===b.id&&c.jsx("div",{className:"px-6 pb-4",children:c.jsx("div",{className:"pt-2 border-t border-brand-burgundy/10",children:c.jsx("p",{className:"text-brand-burgundy/80 leading-relaxed whitespace-pre-line",children:b.answer})})})]})},b.id))}),c.jsx(kt,{className:"bg-white border-brand-burgundy/10 mt-8",children:c.jsxs(rr,{className:"p-6 text-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-burgundy mb-2",children:"Still have questions?"}),c.jsx("p",{className:"text-brand-burgundy/70 mb-4",children:"Can't find what you're looking for? Our support team is here to help."}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[c.jsx("a",{href:"/contact",className:"inline-flex items-center justify-center px-6 py-2 bg-brand-burgundy text-white rounded-lg hover:bg-brand-burgundy/90 transition-colors",children:"Contact Support"}),c.jsx("a",{href:"mailto:support@vipclub.ng",className:"inline-flex items-center justify-center px-6 py-2 border border-brand-burgundy text-brand-burgundy rounded-lg hover:bg-brand-burgundy/10 transition-colors",children:"Email Us"})]})]})})]})})},MUe=()=>{const[e,t]=D.useState("test@example.com"),[r,n]=D.useState(null),[o,s]=D.useState("booking"),[h,i]=D.useState(!1),{toast:p}=Co(),y={id:"BOOK123456",booking_date:new Date().toISOString(),booking_time:"20:00:00",guest_count:4,table_number:"VIP-001",total_amount:"25000",status:"confirmed"},b={name:"The Golden Lounge",address:"123 Victoria Island, Lagos, Nigeria",contact_phone:"+234 801 234 5678",contact_email:"info@goldenlounge.com",images:["/images/sample-venue.jpg"],dress_code:"Smart casual"},_={full_name:"John Doe",email:e,phone:"+234 803 456 7890"},E={full_name:"Venue Manager",email:"owner@goldenlounge.com"},C=async B=>{try{i(!0);const{bookingConfirmationTemplate:O,venueOwnerNotificationTemplate:R,cancellationTemplate:q,generateEmailData:F}=await Js(()=>Promise.resolve().then(()=>Tye),void 0),X=F(y,b,_);let G="";switch(B){case"booking":G=O(X);break;case"owner":G=R(X,E);break;case"cancellation":X.refundAmount="20000",G=q(X);break;default:G="<p>No template selected</p>"}n(G)}catch(O){console.error("Error generating preview:",O),p({title:"Preview Error",description:`Failed to generate preview: ${O.message}`,variant:"destructive"})}finally{i(!1)}},k=async()=>{try{i(!0),console.log(" [V2] Testing admin notification system...",Date.now());const{notifyAdminOfVenueSubmission:B}=await Js(()=>Promise.resolve().then(()=>sFe),void 0),O={id:"test-venue-123",name:"V2 TEST - Admin Notification Venue",type:"restaurant",address:"123 V2 Test Street, Lagos, Nigeria",city:"Lagos",description:"Version 2 cache test venue for admin notifications"},R={id:"test-user-123",first_name:"Version",last_name:"Two",phone:"+234 803 456 7890",email:e},q={id:"test-user-123",email:e};console.log(" [V2] Sending admin notification - should show NEW template..."),await B(O,R,q),console.log(" [V2] Admin notification test successful"),p({title:"Admin Notification Test Successful!",description:"V2 notification sent to sales@oneeddy.com"})}catch(B){console.error(" Admin notification test failed:",B),p({title:"Admin Notification Test Failed",description:B.message||"Failed to send admin notification",variant:"destructive"})}finally{i(!1)}},N=async()=>{try{i(!0),console.log(" Testing basic email service..."),p({title:"Basic Email Test",description:"Email service test completed. Check console for details."})}catch(B){console.error("Email test error:",B),p({title:"Email Test Error",description:`Error: ${B.message}`,variant:"destructive"})}finally{i(!1)}},I=async()=>{try{i(!0),console.log(" Testing EmailJS connectivity...");const B=await NK();B.success?(p({title:"EmailJS Connection Test Successful!",description:`EmailJS is working with: ${B.workingFields}`}),console.log(" Working field configuration:",B.workingData),console.log(" Use these fields in your admin notification function")):p({title:"EmailJS Connection Test Failed",description:B.error||"All field variations failed",variant:"destructive"})}catch(B){console.error(" EmailJS connection test failed:",B),p({title:"EmailJS Connection Test Failed",description:B.message||"Failed to test EmailJS connection",variant:"destructive"})}finally{i(!1)}};return c.jsxs("div",{className:"container py-8",children:[c.jsx("h1",{className:"text-3xl font-heading text-brand-burgundy mb-6",children:"Email Template Testing"}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[c.jsxs(kt,{children:[c.jsx(zr,{children:c.jsx($r,{children:"Template Controls"})}),c.jsxs(rr,{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(qt,{htmlFor:"test-email",children:"Test Email Address"}),c.jsx(Xt,{id:"test-email",type:"email",value:e,onChange:B=>t(B.target.value),placeholder:"Enter your email to test"})]}),c.jsxs(Cd,{value:o,onValueChange:s,children:[c.jsxs(Wc,{className:"grid w-full grid-cols-3",children:[c.jsx(vn,{value:"booking",children:"Customer"}),c.jsx(vn,{value:"owner",children:"Venue Owner"}),c.jsx(vn,{value:"cancellation",children:"Cancellation"})]}),c.jsx(xn,{value:"booking",className:"mt-4",children:c.jsx("p",{className:"text-sm text-muted-foreground",children:"Preview the booking confirmation email sent to customers."})}),c.jsx(xn,{value:"owner",className:"mt-4",children:c.jsx("p",{className:"text-sm text-muted-foreground",children:"Preview the new booking notification sent to venue owners."})}),c.jsx(xn,{value:"cancellation",className:"mt-4",children:c.jsx("p",{className:"text-sm text-muted-foreground",children:"Preview the cancellation email with refund information."})})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Et,{onClick:()=>C(o),className:"w-full",disabled:h,children:h?"Loading...":"Generate Preview"}),c.jsx(Et,{onClick:I,variant:"outline",className:"w-full bg-blue-50 hover:bg-blue-100 text-blue-800",disabled:h,children:h?"Testing...":"Test EmailJS Connection"}),c.jsx(Et,{onClick:N,variant:"outline",className:"w-full",disabled:h,children:h?"Testing...":"Test Basic Email"}),c.jsx(Et,{onClick:k,variant:"outline",className:"w-full bg-orange-50 hover:bg-orange-100 text-orange-800",disabled:h,children:h?"Testing...":"Test Admin Notification"})]}),c.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[c.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Template Testing:"}),c.jsx("p",{className:"text-sm text-blue-700",children:'Use the "Generate Preview" button to see how the email templates look. The preview uses sample data from a test venue booking.'})]}),c.jsxs("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[c.jsx("h4",{className:"font-semibold text-orange-800 mb-2",children:"Admin Notification Test:"}),c.jsxs("p",{className:"text-sm text-orange-700",children:["This tests the admin notification system that sends emails to ",c.jsx("strong",{children:"sales@oneeddy.com"})," when venue owners register. Now using the proper Supabase function invocation method."]})]}),c.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[c.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:" Fixed Connection Issue:"}),c.jsxs("p",{className:"text-sm text-green-700",children:["Updated to use ",c.jsx("code",{children:"supabase.functions.invoke()"})," instead of direct fetch calls for better reliability."]})]})]})]}),c.jsxs(kt,{children:[c.jsx(zr,{children:c.jsx($r,{children:"Email Preview"})}),c.jsx(rr,{children:h?c.jsx("div",{className:"text-center py-8 text-muted-foreground",children:c.jsx("p",{children:"Loading preview..."})}):r?c.jsx("div",{className:"border rounded-lg p-4 bg-white max-h-96 overflow-y-auto",children:c.jsx("div",{dangerouslySetInnerHTML:{__html:r},className:"email-preview"})}):c.jsx("div",{className:"text-center py-8 text-muted-foreground",children:c.jsx("p",{children:'Click "Generate Preview" to see the email template'})})})]})]}),c.jsx("style",{jsx:!0,children:`
        .email-preview img {
          max-width: 100%;
          height: auto;
        }
        
        .email-preview table {
          max-width: 100%;
        }
        
        .email-preview {
          font-size: 12px;
        }
      `})]})},IUe=()=>c.jsx(Uue,{children:c.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[c.jsx(Gue,{}),c.jsx(Vue,{}),c.jsx("main",{className:"flex-grow",children:c.jsxs(Bre,{children:[c.jsx(Lr,{path:"/",element:c.jsx(qme,{})}),c.jsx(Lr,{path:"/home",element:c.jsx(EUe,{})}),c.jsx(Lr,{path:"/venues",element:c.jsx(Lge,{})}),c.jsx(Lr,{path:"/venues/:id",element:c.jsx(V7,{})}),c.jsx(Lr,{path:"/checkout",element:c.jsx(EC,{})}),c.jsx(Lr,{path:"/checkout/:id",element:c.jsx(EC,{})}),c.jsx(Lr,{path:"/checkout/deposit",element:c.jsx(EC,{})}),c.jsx(Lr,{path:"/split-payment/:bookingId/:requestId",element:c.jsx(bUe,{})}),c.jsx(Lr,{path:"/explore",element:c.jsx(lUe,{})}),c.jsx(Lr,{path:"/profile",element:c.jsx(PFe,{})}),c.jsx(Lr,{path:"/bookings",element:c.jsx(AFe,{})}),c.jsx(Lr,{path:"/settings",element:c.jsx(NFe,{})}),c.jsx(Lr,{path:"/reset-password",element:c.jsx(gU,{})}),c.jsx(Lr,{path:"/about",element:c.jsx(CUe,{})}),c.jsx(Lr,{path:"/contact",element:c.jsx(PUe,{})}),c.jsx(Lr,{path:"/terms",element:c.jsx(AUe,{})}),c.jsx(Lr,{path:"/privacy",element:c.jsx(kUe,{})}),c.jsx(Lr,{path:"/faq",element:c.jsx(NUe,{})}),c.jsx(Lr,{path:"/venue-owner/login",element:c.jsx(k5e,{})}),c.jsx(Lr,{path:"/venue-owner/register",element:c.jsx(dFe,{})}),c.jsx(Lr,{path:"/venue-owner/reset-password",element:c.jsx(gU,{})}),c.jsx(Lr,{path:"/venue-owner/pending",element:c.jsx(hFe,{})}),c.jsx(Lr,{path:"/venue-owner/dashboard",element:c.jsx(A5e,{})}),c.jsx(Lr,{path:"/venue-owner/bookings",element:c.jsx(fFe,{})}),c.jsx(Lr,{path:"/venue-owner/tables",element:c.jsx(pFe,{})}),c.jsx(Lr,{path:"/venue-owner/analytics",element:c.jsx(mFe,{})}),c.jsx(Lr,{path:"/venue-owner/settings",element:c.jsx(_Fe,{})}),c.jsx(Lr,{path:"/admin/venue-approvals",element:c.jsx(wFe,{})}),c.jsx(Lr,{path:"/test",element:c.jsx(cUe,{})}),c.jsx(Lr,{path:"/auth-test",element:c.jsx(dUe,{})}),c.jsx(Lr,{path:"/email-test",element:c.jsx(mUe,{})}),c.jsx(Lr,{path:"/email-debug",element:c.jsx(gUe,{})}),c.jsx(Lr,{path:"/email-templates",element:c.jsx(MUe,{})}),c.jsx(Lr,{path:"/map-test",element:c.jsx(xUe,{})}),c.jsx(Lr,{path:"/register",element:c.jsx(jUe,{})}),c.jsx(Lr,{path:"*",element:c.jsx(Rre,{to:"/",replace:!0})})]})}),c.jsx(Wue,{}),c.jsx(Hie,{})]})});iP.createRoot(document.getElementById("root")).render(c.jsx(je.StrictMode,{children:c.jsx(Gre,{children:c.jsx(IUe,{})})}));
//# sourceMappingURL=index-ca2ab4db.js.map
